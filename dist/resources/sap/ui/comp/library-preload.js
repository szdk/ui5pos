//@ui5-bundle sap/ui/comp/library-preload.js
/*!
 * SAPUI5
 * (c) Copyright 2009-2023 SAP SE. All rights reserved.
 */
sap.ui.predefine("sap/ui/comp/config/condition/DateRangeType", ["sap/ui/core/date/UI5Date","sap/ui/thirdparty/jquery","sap/ui/comp/config/condition/Type","sap/ui/Device","sap/ui/core/library","sap/ui/comp/library","sap/m/library","sap/m/Input","sap/m/Text","sap/ui/core/ListItem","sap/m/Label","sap/ui/core/date/UniversalDate","sap/ui/core/format/DateFormat","sap/ui/comp/config/condition/NullableInteger","sap/base/Log","sap/ui/core/date/UniversalDateUtils","sap/m/DynamicDateRange","sap/m/DynamicDateUtil","sap/m/DynamicDateFormat","sap/m/DynamicDateOption","sap/m/DynamicDateValueHelpUIType","sap/m/StandardDynamicDateOption","sap/ui/comp/util/DateTimeUtil","sap/ui/dom/jquery/cursorPos"],function(e,jQuery,t,a,n,i,r,o,s,l,u,p,g,f,T,d,c,v,y,E,h,D,m){"use strict";var I=n.ValueState,A=Object.keys(r.StandardDynamicDateRangeKeys).concat(["LAST2WEEKS","LAST3WEEKS","LAST4WEEKS","LAST5WEEKS","NEXT2WEEKS","NEXT3WEEKS","NEXT4WEEKS","NEXT5WEEKS"]);var S=t.extend("sap.ui.comp.config.condition.DateRangeType",{constructor:function(e,a,n){t.apply(this,[e,a,n]);this.oDateFormat=a&&a._oDateFormatSettings?a._oDateFormatSettings:{UTC:true};this._bIgnoreTime=false;this._maxIntValue=1e4;this.bMandatory=this.oFieldMetadata?this.oFieldMetadata.isMandatory:false;var r=this.oFieldMetadata&&this.oFieldMetadata.name,o=a&&a._oAdditionalConfiguration&&a._oAdditionalConfiguration.getControlConfigurationByKey(e)||r&&a._oAdditionalConfiguration.getControlConfigurationByKey(r);this._bSingleFilterRestriction=n&&n.filterRestriction===i.smartfilterbar.FilterType.single&&(a._bUseDateRangeType||o&&(o.conditionType===this.getName()||typeof o.conditionType==="object"&&o.conditionType.module===this.getName()));this._bDTOffset=n&&n.filterRestriction===i.smartfilterbar.FilterType.interval&&n.type==="Edm.DateTimeOffset";this._customSemanticOperation=null}});S.prototype.applySettings=function(e){t.prototype.applySettings.apply(this,arguments);if(e&&e.ignoreTime){this._bIgnoreTime=e.ignoreTime}};S.setStartTime=function(e){e=S.toUniversalDate(e);return d.resetStartTime(e)};S.setEndTime=function(e,t){e=S.toUniversalDate(e);if(!t){return d.resetEndTime(e)}else{return d.resetStartTime(e)}};S.toUniversalDate=function(t){if(t instanceof Date){return p.getInstance(t)}if(!t){return p.getInstance()}if(!(t instanceof p)){return S.toUniversalDate(e.getInstance(t))}return t};S.getWeekStartDate=function(e){return d.getWeekStartDate(e)};S.getMonthStartDate=function(e){return d.getMonthStartDate(e)};S.getQuarterStartDate=function(e){return d.getQuarterStartDate(e)};S.getYearStartDate=function(e){return d.getYearStartDate(e)};S.getDateRange=function(e,t,a,n,i){if(a===true){n=true;a=null}if(!a){a=new p}else{a=new p(a)}if(n){switch(t){case"DAY":break;case"WEEK":a=d.getWeekStartDate(a);break;case"MONTH":a=d.getMonthStartDate(a);break;case"QUARTER":a=d.getQuarterStartDate(a);break;case"YEAR":a=d.getYearStartDate(a);break}}if(!i&&e>0){if(e!==0&&!isNaN(e)){var r=-1;switch(t){case"DAY":a.setDate(a.getDate()+r);break;case"WEEK":a.setDate(a.getDate()+r*7);break;case"MONTH":a.setMonth(a.getMonth()+r);break;case"QUARTER":a.setMonth(a.getMonth()+r*3);break;case"YEAR":a.setFullYear(a.getFullYear()+r);break}}}return d.getRange(e,t,a,false)};S.getTextField=function(e,a){var n=t._createStableId(e,"text");if(a){return new s(n,{text:"{path: '$smartEntityFilter>value1', type:'sap.ui.model.type.Date', formatOptions:"+JSON.stringify({style:e.oDateFormat.style,pattern:e.oDateFormat.pattern})+"} - {path: '$smartEntityFilter>value2', type:'sap.ui.model.type.Date', formatOptions:"+JSON.stringify({style:e.oDateFormat.style,pattern:e.oDateFormat.pattern})+"}"})}else{return new s(n,{text:{path:"$smartEntityFilter>value1",type:"sap.ui.model.type.Date",formatOptions:{style:e.oDateFormat.style,pattern:e.oDateFormat.pattern}}})}};S.getIntField=function(e){return new o(t._createStableId(e,"field"),{value:{path:"$smartEntityFilter>value1",type:new f({},{minimum:0,maximum:e._maxIntValue})},textAlign:"End",width:"100%"})};S.getIntFromToField=function(e,a,n){var i=new u({text:t.getTranslatedText("CONDITION_DATERANGETYPE_DATERANGE_LABELFROM")});i.addStyleClass("sapUiCompFilterBarCTPaddingTop");a.push(i);var r=e._createIntFromToControl(e,"fieldFrom","value1");i.setLabelFor(r);a.push(r);i=new u({text:t.getTranslatedText("CONDITION_DATERANGETYPE_DATERANGE_LABELTO")});i.addStyleClass("sapUiCompFilterBarCTPaddingTop");a.push(i);var o=e._createIntFromToControl(e,"fieldTo","value2");i.setLabelFor(o);a.push(o);e._setIntControlBinding(r,n,"value1");e._setIntControlBinding(o,n,"value2")};S.ControlFactory=function(e,a,n){if(n.type==="range"){var i=S.getTextField(e,n.display!=="start");i.addStyleClass("sapUiCompFilterBarCTPaddingTop");a.push(i);return}if(n.type==="int"){var i=S.getIntField(e);a.push(i);if(n.descriptionTextKeys){i.setFieldWidth("auto");i.bindProperty("description",{path:"$smartEntityFilter>value1",type:"sap.ui.model.type.Integer",formatter:function(){var e=n.descriptionTextKeys[0];var a=n.descriptionTextKeys[1];if(this.getBinding("description").getValue()===1){return t.getTranslatedText(e)}else{return t.getTranslatedText(a||e)}}})}}if(n.type==="[int,int]"){S.getIntFromToField(e,a,n)}};S._defaultOnChangeHandler=function(e,t){if(e.toLowerCase()===this.languageText.toLowerCase()){t.oModel.setProperty("/condition/operation",this.key);t.oModel.setProperty("inputstate","NONE",t.getContext());if(this.category.indexOf("FIXED")!==0){t.oModel.setProperty("inputstate","ERROR",t.getContext())}return true}return false};S._IntOnChangeHandler=function(e,t){if(this.basicLanguageText.indexOf("{0}")>=0){var a=new RegExp(this.basicLanguageText.replace("+","\\+").replace("{0}","([a-zA-Z0-9_]+)")+"$","i");if(e.match(a)){var e=e.match(a)[1];if(e){var n=parseInt(e);if(!isNaN(n)&&n<=t._maxIntValue){t.oModel.setProperty("/condition/operation",this.key);t.oModel.setProperty("/condition/value1",n);t.oModel.setProperty("inputstate","NONE",t.getContext())}else{t.oModel.setProperty("inputstate","ERROR",t.getContext())}return true}}}return false};S._DefaultFilterSuggestItem=function(e,t,a){var n=false;if(this.languageText.toLowerCase().startsWith(e.toLowerCase())){n=true}else{var i=this.languageText.split(" ");for(var r=0;r<i.length;r++){var o=i[r];if(o.toLowerCase().startsWith(e.toLowerCase())){n=true}}}t.setAdditionalText(this.textValue);t.setText(this.languageText);return n};S._HideFilterSuggestItem=function(e,t,a){return false};S._IntFilterSuggestItem=function(e,a,n){if(!this.basicLanguageText){this.basicLanguageText=n.basicLanguageText}if(!this.basicLanguageText){this.basicLanguageText=this.languageText||t.getTranslatedText(this.textKey)}var i=this.basicLanguageText.indexOf("{0}");var r;var o;if(i>=0){r=this.basicLanguageText.slice(0,i).trim();o=this.basicLanguageText.slice(i+3).trim()}var s=e.split(" ");if(s.length<1||s.length>3){return false}var l=false;var u;var p=function(e){return!!e.match(/(^[0-9]+$)/)&&parseInt(e)>=0};if(r.toLowerCase().startsWith(s[0].toLowerCase())){if(s[1]){if(p(s[1])){u=s[1];if(s[2]){if(o.toLowerCase().startsWith(s[2].toLowerCase())){l=true}}else{l=true}}}else{l=true}}else if(p(s[0])&&s.length<3){u=s[0];if(s[1]){if(o.toLowerCase().startsWith(s[1].toLowerCase())){l=true}}else{l=true}}else if(o.toLowerCase().startsWith(s[0].toLowerCase())&&s.length==1){l=true}if(l&&u){var g;switch(this.category){case"DYNAMIC.DATE.INT":g="DAY";break;case"DYNAMIC.WEEK.INT":g="WEEK";break;case"DYNAMIC.MONTH.INT":g="MONTH";break;case"DYNAMIC.QUARTER.INT":g="QUARTER";break;case"DYNAMIC.YEAR.INT":g="YEAR";break;default:g="DAY";break}var f=parseInt(u),T=true;if(!n._maxIntValue){n._maxIntValue=n.getControls(n.key)[0].getBindingInfo("value").type.oConstraints.maximum}if(f>n._maxIntValue){l=false}if(this.key.startsWith("LAST")){f=f*-1;T=false}var d;if(this.getDateRange){var c=this.getDateRange({operation:this.key,value1:f});d=[c.value1,c.value2]}else{d=S.getDateRange(f,g,true,T,T)}var v=n._getDateFormatter(true);if(Math.abs(f)===1&&this.singulareBasicLanguageText){a.setText(this.singulareBasicLanguageText);if(g!=="DAY"){a.setAdditionalText(v.format(d[0])+" - "+v.format(d[1]))}else{a.setAdditionalText(v.format(d[0]))}}else{a.setText(n._fillNumberToText(this.basicLanguageText,u));a.setAdditionalText(v.format(d[0])+" - "+v.format(d[1]))}a._value1=parseInt(u)}else{a.setAdditionalText(null);a.setText(this.languageText);a._value1=null}return l};S._DefaultOnItemSelected=function(e,t,a){a.oModel.setProperty("/condition/operation",this.key);if("value1"in this){a.oModel.setProperty("/condition/value1",t._value1)}if("value2"in this){a.oModel.setProperty("/condition/value2",t._value2)}a.oModel.setProperty("inputstate","NONE",a.getContext());a._bSuggestItemSelected=true};S._IntOnItemSelected=function(e,t,a){var n=t._value1;a.oModel.setProperty("/condition/operation",this.key);a.oModel.setProperty("/condition/value1",n);a.oModel.setProperty("inputstate","NONE",a.getContext());a._bSuggestItemSelected=true};S.getFixedRangeOperation=function(e,t,a,n,i,r){return Object.assign({textKey:t,filterSuggestItem:i||S._DefaultFilterSuggestItem,onItemSelected:S._DefaultOnItemSelected,getControls:S.ControlFactory},S._getFixedRangeOperation(e,a,n,r))};S._getFixedRangeOperation=function(e,t,a,n){return{key:e,category:t,order:n||100,defaultValues:a||null,type:"range",display:"range"}};S.createSingleIntRangeOperation=function(e,t,a,n,i,r,o,s){return Object.assign({textKey:t,singularTextKey:a,zeroNumberTextKey:s,descriptionTextKeys:r,onChange:S._IntOnChangeHandler,filterSuggestItem:S._IntFilterSuggestItem,onItemSelected:S._IntOnItemSelected,getControls:S.ControlFactory},S._createSingleIntRangeOperation(e,n,i,o))};S._createSingleIntRangeOperation=function(e,t,a,n){return{key:e,category:t,order:n,defaultValues:[a],value1:null,type:"int",_getInitialValues:function(e){return[e.value1,e.value2]}}};S.Operations={DATERANGE:{key:"DATERANGE",category:"DYNAMIC.DATERANGE",order:2,defaultOperation:true,defaultValues:[null,null],value1:null,value2:null},DATE:{key:"DATE",category:"DYNAMIC.DATE",order:0,defaultValues:[null],value1:null},FROM:{key:"FROM",category:"DYNAMIC.DATE",order:0,defaultValues:[null],value1:null},TO:{key:"TO",category:"DYNAMIC.DATE",order:1,defaultValues:[null],value1:null},LASTDAYS:S._createSingleIntRangeOperation("LASTDAYS","DYNAMIC.DATE.INT",1,4),LASTWEEKS:S._createSingleIntRangeOperation("LASTWEEKS","DYNAMIC.WEEK.INT",1,8),LASTMONTHS:{key:"LASTMONTHS",category:"DYNAMIC.MONTH.INT",order:14,defaultValues:[1],value1:null,type:"int"},LASTQUARTERS:{key:"LASTQUARTERS",category:"DYNAMIC.QUARTER.INT",order:19,defaultValues:[1],value1:null,type:"int"},LASTYEARS:{key:"LASTYEARS",category:"DYNAMIC.YEAR.INT",order:28,defaultValues:[1],value1:null,type:"int"},NEXTDAYS:{key:"NEXTDAYS",category:"DYNAMIC.DATE.INT",order:5,defaultValues:[1],value1:null,type:"int"},NEXTWEEKS:{key:"NEXTWEEKS",category:"DYNAMIC.WEEK.INT",order:10,defaultValues:[1],value1:null,type:"int"},NEXTMONTHS:{key:"NEXTMONTHS",category:"DYNAMIC.MONTH.INT",order:16,defaultValues:[1],value1:null,type:"int"},NEXTQUARTERS:{key:"NEXTQUARTERS",category:"DYNAMIC.QUARTER.INT",order:21,defaultValues:[1],value1:null,type:"int"},NEXTYEARS:{key:"NEXTYEARS",category:"DYNAMIC.YEAR.INT",order:30,defaultValues:[1],value1:null,type:"int"},SPECIFICMONTH:{key:"SPECIFICMONTH",category:"DYNAMIC.MONTH",order:11,defaultValues:function(){var e=new p;return[e.getMonth()]},value1:null},YESTERDAY:{key:"YESTERDAY",category:"FIXED.DATE",order:3.1,defaultValues:function(){return d.ranges.yesterday()},type:"range",display:"start"},TODAY:{key:"TODAY",category:"FIXED.DATE",order:3,defaultValues:function(){return d.ranges.today()},type:"range",display:"start"},TOMORROW:{key:"TOMORROW",category:"FIXED.DATE",order:3.2,defaultValues:function(){var e=d.ranges.tomorrow();return e},type:"range",display:"start"},THISWEEK:S._getFixedRangeOperation("THISWEEK","FIXED.WEEK",function(){return d.ranges.currentWeek()},6),LASTWEEK:S._getFixedRangeOperation("LASTWEEK","FIXED.WEEK",function(){return d.ranges.lastWeek()},7),LAST2WEEKS:S._getFixedRangeOperation("LAST2WEEKS","FIXED.WEEK",function(){return d.ranges.lastWeeks(-2)},-1),LAST3WEEKS:S._getFixedRangeOperation("LAST3WEEKS","FIXED.WEEK",function(){return d.ranges.lastWeeks(-3)},-1),LAST4WEEKS:S._getFixedRangeOperation("LAST4WEEKS","FIXED.WEEK",function(){return d.ranges.lastWeeks(-4)},-1),LAST5WEEKS:S._getFixedRangeOperation("LAST5WEEKS","FIXED.WEEK",function(){return d.ranges.lastWeeks(-5)},-1),NEXTWEEK:S._getFixedRangeOperation("NEXTWEEK","FIXED.WEEK",function(){return d.ranges.nextWeek()},9),NEXT2WEEKS:S._getFixedRangeOperation("NEXT2WEEKS","FIXED.WEEK",function(){return d.ranges.nextWeeks(2)},-1),NEXT3WEEKS:S._getFixedRangeOperation("NEXT3WEEKS","FIXED.WEEK",function(){return d.ranges.nextWeeks(3)},-1),NEXT4WEEKS:S._getFixedRangeOperation("NEXT4WEEKS","FIXED.WEEK",function(){return d.ranges.nextWeeks(4)},-1),NEXT5WEEKS:S._getFixedRangeOperation("NEXT5WEEKS","FIXED.WEEK",function(){return d.ranges.nextWeeks(5)},-1),THISMONTH:S._getFixedRangeOperation("THISMONTH","FIXED.MONTH",function(){return d.ranges.currentMonth()},12),LASTMONTH:S._getFixedRangeOperation("LASTMONTH","FIXED.MONTH",function(){return d.ranges.lastMonth()},13),NEXTMONTH:S._getFixedRangeOperation("NEXTMONTH","FIXED.MONTH",function(){return d.ranges.nextMonth()},15),THISQUARTER:S._getFixedRangeOperation("THISQUARTER","FIXED.QUARTER",function(){return d.ranges.currentQuarter()},17),LASTQUARTER:S._getFixedRangeOperation("LASTQUARTER","FIXED.QUARTER",function(){return d.ranges.lastQuarter()},18),NEXTQUARTER:S._getFixedRangeOperation("NEXTQUARTER","FIXED.QUARTER",function(){return d.ranges.nextQuarter()},20),YEARTODATE:S._getFixedRangeOperation("YEARTODATE","FIXED.YEAR",function(){return d.ranges.yearToDate()},31),THISYEAR:S._getFixedRangeOperation("THISYEAR","FIXED.YEAR",function(){return d.ranges.currentYear()},26),LASTYEAR:S._getFixedRangeOperation("LASTYEAR","FIXED.YEAR",function(){return d.ranges.lastYear()},27),NEXTYEAR:S._getFixedRangeOperation("NEXTYEAR","FIXED.YEAR",function(){return d.ranges.nextYear()},29),QUARTER1:S._getFixedRangeOperation("QUARTER1","FIXED.QUARTER",function(){return d.ranges.quarter(1)},22),QUARTER2:S._getFixedRangeOperation("QUARTER2","FIXED.QUARTER",function(){return d.ranges.quarter(2)},23),QUARTER3:S._getFixedRangeOperation("QUARTER3","FIXED.QUARTER",function(){return d.ranges.quarter(3)},24),QUARTER4:S._getFixedRangeOperation("QUARTER4","FIXED.QUARTER",function(){return d.ranges.quarter(4)},25),TODAYFROMTO:{key:"TODAYFROMTO",category:"DYNAMIC.DATE.INT",order:3.3,defaultValues:[1,1],type:"[int,int]",display:"int",value1:null,value2:null}};S.SingleOperations={DATE:Object.assign({},S.Operations.DATE,{defaultOperation:true}),YESTERDAY:S.Operations.YESTERDAY,TODAY:S.Operations.TODAY,TOMORROW:S.Operations.TOMORROW,FIRSTDAYWEEK:{key:"FIRSTDAYWEEK",category:"FIXED.DATE",type:"range",display:"start",defaultValues:function(){return(new D).toDates({operator:"FIRSTDAYWEEK",values:[]})}},LASTDAYWEEK:{key:"LASTDAYWEEK",category:"FIXED.DATE",type:"range",display:"start",defaultValues:function(){return(new D).toDates({operator:"LASTDAYWEEK",values:[]})}},FIRSTDAYMONTH:{key:"FIRSTDAYMONTH",category:"FIXED.DATE",type:"range",display:"start",defaultValues:function(){return(new D).toDates({operator:"FIRSTDAYMONTH",values:[]})}},LASTDAYMONTH:{key:"LASTDAYMONTH",category:"FIXED.DATE",type:"range",display:"start",defaultValues:function(){return(new D).toDates({operator:"LASTDAYMONTH",values:[]})}},FIRSTDAYQUARTER:{key:"FIRSTDAYQUARTER",category:"FIXED.DATE",type:"range",display:"start",defaultValues:function(){return(new D).toDates({operator:"FIRSTDAYQUARTER",values:[]})}},LASTDAYQUARTER:{key:"LASTDAYQUARTER",category:"FIXED.DATE",type:"range",display:"start",defaultValues:function(){return(new D).toDates({operator:"LASTDAYQUARTER",values:[]})}},FIRSTDAYYEAR:{key:"FIRSTDAYYEAR",category:"FIXED.DATE",type:"range",display:"start",defaultValues:function(){return(new D).toDates({operator:"FIRSTDAYYEAR",values:[]})}},LASTDAYYEAR:{key:"LASTDAYYEAR",category:"FIXED.DATE",type:"range",display:"start",defaultValues:function(){return(new D).toDates({operator:"LASTDAYYEAR",values:[]})}}};S.NewDynamicDateRangeOperations={DATETOYEAR:{key:"DATETOYEAR",category:"FIXED.YEAR",type:"range",display:"range",defaultValues:function(){return(new D).toDates({operator:"DATETOYEAR",values:[]})}}};S.DTOffsetOperations=Object.assign({NEXTMINUTES:{key:"NEXTMINUTES",category:"DYNAMIC.MINUTE.INT",type:"int",value1:null,defaultValues:[null]},NEXTHOURS:{key:"NEXTHOURS",category:"DYNAMIC.HOUR.INT",type:"int",value1:null,defaultValues:[null]},LASTMINUTES:{key:"LASTMINUTES",category:"DYNAMIC.MINUTE.INT",type:"int",value1:null,defaultValues:[null]},LASTHOURS:{key:"LASTHOURS",category:"DYNAMIC.HOUR.INT",type:"int",value1:null,defaultValues:[null]}},S.Operations,S.NewDynamicDateRangeOperations,{DATERANGE:Object.assign({},S.Operations.DATERANGE,{defaultOperation:false}),DATETIME:{key:"DATETIME",category:"DYNAMIC.DATETIME",type:"range",display:"range",value1:null,defaultValues:[null]},DATETIMERANGE:{key:"DATETIMERANGE",category:"DYNAMIC.DATETIMERANGE",type:"range",display:"range",defaultOperation:true,value1:null,value2:null,defaultValues:[null,null]}});S.prototype.getControls=function(e){var t=[];if(!e){return}if(!e.getControls){e.getControls=S.ControlFactory}e.getControls(this,t,e);return t};S.prototype.setIgnoreTime=function(e){this._bIgnoreTime=e};t.prototype.getIgnoreTime=function(e){return this._bIgnoreTime};S.prototype.getDefaultValues=function(e){if(!e){return[]}var t=e.defaultValues||[];if(typeof t==="function"){t=e.defaultValues()}var a=this.getCondition(),n=t[0]||null,i=t[1]||null;if(e.key==="DATERANGE"&&a&&a.value1&&a.value2&&(a.value1 instanceof Date&&a.value2 instanceof Date||a.value1.oDate&&a.value2.oDate)){n=a.value1.oDate||a.value1;i=a.value2.oDate||a.value2}else{if(n instanceof Date){n=new p(n)}if(i instanceof Date){i=new p(i)}}return[n,i]};S.prototype.getOperations=function(){if(this._bSingleFilterRestriction){return this.getSingleOperations()}if(this._bDTOffset){return this.getDTOffsetOperations()}var e=[];var t=Object.assign({},S.Operations,S.NewDynamicDateRangeOperations);for(var a in t){var n=t[a];if(this._filterOperation(n)){e.push(n)}}return e};S.prototype.getSingleOperations=function(){var e=[];for(var t in S.SingleOperations){var a=S.SingleOperations[t];if(this._filterOperation(a)){e.push(a)}}return e};S.prototype.getDTOffsetOperations=function(){var e=[];for(var t in S.DTOffsetOperations){var a=S.DTOffsetOperations[t];if(this._filterOperation(a)){e.push(a)}}return e};S.prototype._updateOperation=function(e){t.prototype._updateOperation.apply(this,[e]);if(e.languageText&&!e.basicLanguageText){e.basicLanguageText=e.languageText;if(!e.singulareBasicLanguageText&&e.singularTextKey){e.singulareBasicLanguageText=this.getTranslatedText(e.singularTextKey)}if(!e.zeroNumberLanguageText&&e.zeroNumberTextKey){e.zeroNumberLanguageText=this.getTranslatedText(e.zeroNumberTextKey)}e.languageText=this._fillNumberToText(e.languageText)}if(e.display){var a=this.getDefaultValues(e);var n=this._getDateFormatter(false);if(e.display==="start"&&a[0]!==null){e.textValue=n.format(a[0].oDate)}else if(e.display==="range"&&a&&a[0]&&a[1]){e.textValue=n.format(a[0].oDate)+" - "+n.format(a[1].oDate)}}e.suggestText=e.languageText};S.prototype.isValidCondition=function(){var e=this.getCondition(),t=this.getOperation(e.operation);if(t&&e&&e.key&&e.operation){if("value1"in t&&"value2"in t){return"value1"in e&&e.value1!==null&&"value2"in e&&e.value2!==null}else if("value1"in t){return"value1"in e&&e.value1!==null}else if("value2"in t){return"value2"in e&&e.value2!==null}else if(!("value1"in t)&&!("value2"in t)){return true}}return false};S.prototype.hasSemanticDate=function(e){var t=this.getOperations();if(e.ranges[0].semantic&&e.ranges[0].semantic.operation){var a=0;for(a=0;a<t.length;a++){if(t[a].key.indexOf(e.ranges[0].semantic.operation)!==-1){return true}}return false}};S.prototype.hasCustomSemanticDate=function(e){return e.ranges[0]&&e.ranges[0].semantic&&e.ranges[0].semantic.operation&&e.ranges[0].semantic.operation!==this.getDefaultOperation().key};S.prototype.providerDataUpdated=function(e,t){};S.prototype.initialize=function(a){t.prototype.initialize.apply(this,[a]);this.oModel.suspend();var n=Object.assign({},a,true),i,r;var o=(new p).getCalendarType();if(!a.conditionTypeInfo){if(a.ranges&&a.ranges.length==1){var s;if(this.hasSemanticDate(a)&&!this._bSingleFilterRestriction){s=a.ranges[0].semantic.operation;if(a.ranges[0].semantic.value1||a.ranges[0].semantic.value1==0){i=a.ranges[0].semantic.value1}if(a.ranges[0].semantic.value2||a.ranges[0].semantic.value2==0){r=a.ranges[0].semantic.value2}if(this.getDefaultOperation().key===s){var l=this.getOperation(s),u=l&&l._getInitialValues?l._getInitialValues(a):null;if(!u){u=this.getDefaultValues(l)}if(u[0]&&u[0].oDate&&u[0].oDate.toISOString()!==a.ranges[0].value1||u[1]&&u[1].oDate&&u[1].oDate.toISOString()!==a.ranges[0].value2){s="DATERANGE"}}}else if(this.hasSemanticDate(a)&&this._bSingleFilterRestriction){s=a.ranges[0].semantic.operation;if(a.ranges[0].semantic.value1||a.ranges[0].semantic.value1==0){i=a.ranges[0].semantic.value1}a.ranges[0].value2=null;if(a.ranges[0].semantic.value2||a.ranges[0].semantic.value2==0){r=null}if(this.getDefaultOperation().key===s){var l=this.getOperation(s),u=l&&l._getInitialValues?l._getInitialValues(a):null;if(!u){u=this.getDefaultValues(l)}if(u[0]&&u[0].oDate&&u[0].oDate.toISOString()!==a.ranges[0].value1||u[1]&&u[1].oDate&&u[1].oDate.toISOString()!==a.ranges[0].value2){s="DATE"}if(u[0]&&u[0].oDate&&u[0].oDate.toISOString()===i){i=a.ranges[0].value1?a.ranges[0].value1:a.ranges[0].semantic.value1}}}else if(this.hasCustomSemanticDate(a)){this._customSemanticOperation=a.ranges[0].semantic.operation;if(this._bSingleFilterRestriction){s="DATE"}else{s="DATERANGE"}}else if(this._bSingleFilterRestriction){s="DATE"}else{s="DATERANGE"}if(a.ranges[0].operation==="GE"){s="FROM"}if(a.ranges[0].operation==="LE"){s="TO"}a.conditionTypeInfo={name:this.getName(),data:{key:this.sFieldName,operation:s,value1:i||i==0?i:a.ranges[0].value1,value2:r||r==0?r:a.ranges[0].value2,calendarType:o}}}else{var l=this.getDefaultOperation(),g=l?l.key:"";if(a.value1){var f=a.value1}if(a.value2){var c=a.value2}a.conditionTypeInfo={name:this.getName(),data:{key:this.sFieldName,operation:g,calendarType:o}};if(f){a.conditionTypeInfo.data.value1=f}if(c){a.conditionTypeInfo.data.value2=c}else if(a.conditionTypeInfo.data.operation==="DATERANGE"){a.conditionTypeInfo.data.operation="DATE"}}}if(a.conditionTypeInfo){a=a.conditionTypeInfo}if(a.name&&a.data){if(a.name!==this.getName()){T.debug("ConditionType "+this.getName()+" tries to deserialize data from "+a.name)}a=a.data}if(!a.operation){return}if(this.getOperation(a.operation)&&this.getOperation(a.operation).order<0){var v=["LAST2WEEKS","LAST3WEEKS","LAST4WEEKS","LAST5WEEKS"].indexOf(a.operation);if(v>=0){a.operation="LASTWEEKS";a.value1=v+2}v=["NEXT2WEEKS","NEXT3WEEKS","NEXT4WEEKS","NEXT5WEEKS"].indexOf(a.operation);if(v>=0){a.operation="NEXTWEEKS";a.value1=v+2}}var y=this.getOperation(a.operation);if(!y){if(this.getAsync()){this.setPending(true);var E=this,h=function(e){if(e.getParameter("pending")===false){E.oFilterProvider.detachPendingChange(h);E.initialize(n)}};this.oFilterProvider.attachPendingChange(h);this.oModel.resume();return}}var D;if(o!==a.calendarType&&(a.calendarType==="Islamic"||o==="Islamic")&&a.operation==="SPECIFICMONTH"){a.operation="DATERANGE";var m=parseInt(a.value1),I=p.getInstance(e.getInstance(),a.calendarType);I.setMonth(m);I=d.getMonthStartDate(I);D=d.getRange(0,"MONTH",I);a.value1=D[0].oDate.toISOString();a.value2=D[1].oDate.toISOString()}var A=this.getConditionContext().getObject();A.operation=a.operation;A.key=a.key;A.value1=null;A.value2=null;var S,R=this.oFieldMetadata&&this.oFieldMetadata.ui5Type;if(R&&R.isA("sap.ui.model.odata.type.String")){S=this.oFilterProvider._getType(Object.assign({},this.oFieldMetadata,{isCalendarDate:true,ui5Type:null}));R=S}if(a.operation==="DATERANGE"){if(typeof a.value1==="string"){if(this.oFieldMetadata&&this.oFieldMetadata.type==="Edm.String"){a.value1=R.formatValue(a.value1)}else{a.value1=a.value1===""?null:new p(a.value1).oDate}}if(typeof a.value2==="string"){if(this.oFieldMetadata&&this.oFieldMetadata.type==="Edm.String"){a.value2=R.formatValue(a.value2)}else{a.value2=a.value2===""?null:new p(a.value2).oDate}}A.value1=a.value1;A.value2=a.value2}else if(["DATE","FROM","TO"].indexOf(a.operation)!==-1){if(typeof a.value1==="string"){if(this.oFieldMetadata&&this.oFieldMetadata.type==="Edm.String"){a.value1=R.formatValue(a.value1)}else{a.value1=a.value1===""?null:new p(a.value1).oDate}}A.value1=a.value1}else if(["DATETIME","DATETIMERANGE"].indexOf(a.operation)!==-1){if(typeof a.value1==="string"){a.value1=a.value1===""?null:new p(a.value1).oDate}A.value1=a.value1;if(typeof a.value2==="string"){a.value2=a.value2===""?null:new p(a.value2).oDate}A.value2=a.value2}else if(["LASTMINUTES","LASTHOURS","LASTDAYS","LASTWEEKS","LASTMONTHS","LASTQUARTERS","LASTYEARS","NEXTMINUTES","NEXTHOURS","NEXTDAYS","NEXTWEEKS","NEXTMONTHS","NEXTQUARTERS","NEXTYEARS"].indexOf(a.operation)>-1){A.value1=a.value1}else if(a.operation==="SPECIFICMONTH"){A.value1=a.value1+""}else if(a.operation==="TODAYFROMTO"){A.value1=a.value1;A.value2=a.value2}else{y=this.getOperation(a.operation);D=y&&y._getInitialValues?y._getInitialValues(a):null;if(!D){D=this._getValuesFromCurrentOperation(a)}if(!D){D=this.getDefaultValues(y)}A.value1=D[0];A.value2=D[1]}this.bIgnoreBindingChange=true;this.oModel.resume();delete this.bIgnoreBindingChange;this.serialize(true,false);this._setDDROperation.call(this,a);if(S){S.destroy()}};S.prototype._getValuesFromCurrentOperation=function(e){var t=[];if(Number.isInteger(e.value1)){t.push(e.value1)}if(Number.isInteger(e.value2)){t.push(e.value2)}if(t.length>0){return t}return null};S.prototype.serialize=function(e,t){var a={},n=this.getCondition();if(!n.operation){return null}var i=this.getOperation(n.operation);if(!i||!("value1"in i)){n.value1=null}if(!i||!("value2"in i)){n.value2=null}n.calendarType=(new p).getCalendarType();a.conditionTypeInfo={name:this.getName(),data:n};if(this.iChangeTimer){clearTimeout(this.iChangeTimer);delete this.iChangeTimer}if(e){this._updateProvider(a,true,t)}else{this.iChangeTimer=setTimeout(this._updateProvider.bind(this,a,false,t),0)}return a};S.prototype._updateProvider=function(e,t,a){e.ranges=this.getFilterRanges();e.items=[];var n=false;var i=0;var r=0;var o=0;var s=this.oModel.getData(),l=s.currentoperation;if(this.oFieldMetadata&&this.oFieldMetadata.type==="Edm.String"&&e.ranges[0]){var u,p=this.oFieldMetadata.ui5Type;if(p.isA("sap.ui.model.odata.type.String")){u=this.oFilterProvider._getType(Object.assign({},this.oFieldMetadata,{isCalendarDate:true,ui5Type:null}));p=u}if(!l.type||!l.type.includes("int")){e.conditionTypeInfo.data.value1=p.parseValue(e.conditionTypeInfo.data.value1);e.conditionTypeInfo.data.value2=p.parseValue(e.conditionTypeInfo.data.value2)}e.ranges[0].value1=p.parseValue(e.ranges[0].value1);if(e.ranges[0].value2){e.ranges[0].value2=p.parseValue(e.ranges[0].value2)}if(u){u.destroy()}}if(l&&l.languageText){var g=l.languageText;if(this._isIntIntInterval(l)){if(e.conditionTypeInfo.data.value1!=null&&e.conditionTypeInfo.data.value1!==""&&e.conditionTypeInfo.data.value2!=null&&e.conditionTypeInfo.data.value2!==""){g=this._formatIntIntInterval(l,e)}}else if(this._isIntInterval(l)){if(e.conditionTypeInfo.data.value1!==null&&e.conditionTypeInfo.data.value1!==""){g=this._formatIntInterval(l,e)}else if(this._bSuggestItemSelected){g=this._fillNumberToText(l.basicLanguageText);var f=l.basicLanguageText.indexOf("{0}");i=f+1;r=f;o=f+1;n=true}else{g=""}}else if(this._isFixedRange(l)){g=this._formatFixedRange(l,l.textValue)}else{if(e.conditionTypeInfo.data.value1!==null&&e.conditionTypeInfo.data.value1!==""){var T=this._calculateDateRangeValueText(l,e);var d=T.value;n=T.bSetCursor;if(d){g=this._formatFixedRange(l,d);i=g.length-1}else{g=""}}else{g=""}}this._bSuggestItemSelected=false;this.oModel.setProperty("/formattedText",g);if(n&&this._oInput){this._oInput.$("inner").cursorPos(i);if(r<o){this._oInput.selectText(r,o)}this._oInput._lastValue=""}}if(this.oFilterProvider){this.oFilterProvider.oModel.setProperty("/"+this.sFieldName,e);this.oFilterProvider.setFilterData({},false,this.sFieldName,true);if(a&&this.oFilterProvider._oSmartFilter){this.oFilterProvider._oSmartFilter.fireFilterChange()}}};S.prototype.getFilterRanges=function(){var e,t=this.getCondition(),a=[],n;if(this._bSingleFilterRestriction){t.operation="EQ";delete t.value2}else if(t.operation==="LASTMINUTES"){if(!isNaN(t.value1)){a=d.ranges.lastMinutes(t.value1)}t.value1=a[0];t.value2=a[1]}else if(t.operation==="LASTHOURS"){if(!isNaN(t.value1)){a=d.ranges.lastHours(t.value1)}t.value1=a[0];t.value2=a[1]}else if(t.operation==="LASTDAYS"){if(!isNaN(t.value1)){a=d.ranges.lastDays(t.value1)}t.value1=a[0];t.value2=a[1]}else if(t.operation==="LASTWEEKS"){if(!isNaN(t.value1)){a=d.ranges.lastWeeks(t.value1)}t.value1=a[0];t.value2=a[1]}else if(t.operation==="LASTMONTHS"){if(!isNaN(t.value1)){a=d.ranges.lastMonths(t.value1)}t.value1=a[0];t.value2=a[1]}else if(t.operation==="LASTQUARTERS"){if(!isNaN(t.value1)){a=d.ranges.lastQuarters(t.value1)}t.value1=a[0];t.value2=a[1]}else if(t.operation==="LASTYEARS"){if(!isNaN(t.value1)){a=d.ranges.lastYears(t.value1)}t.value1=a[0];t.value2=a[1]}else if(t.operation==="NEXTMINUTES"){if(!isNaN(t.value1)){a=d.ranges.nextMinutes(t.value1)}t.value1=a[0];t.value2=a[1]}else if(t.operation==="NEXTHOURS"){if(!isNaN(t.value1)){a=d.ranges.nextHours(t.value1)}t.value1=a[0];t.value2=a[1]}else if(t.operation==="NEXTDAYS"){if(!isNaN(t.value1)){a=d.ranges.nextDays(t.value1)}t.value1=a[0];t.value2=a[1]}else if(t.operation==="NEXTWEEKS"){if(!isNaN(t.value1)){a=d.ranges.nextWeeks(t.value1)}t.value1=a[0];t.value2=a[1]}else if(t.operation==="NEXTMONTHS"){if(!isNaN(t.value1)){a=d.ranges.nextMonths(t.value1)}t.value1=a[0];t.value2=a[1]}else if(t.operation==="NEXTQUARTERS"){if(!isNaN(t.value1)){a=d.ranges.nextQuarters(t.value1)}t.value1=a[0];t.value2=a[1]}else if(t.operation==="NEXTYEARS"){if(!isNaN(t.value1)){a=d.ranges.nextYears(t.value1)}t.value1=a[0];t.value2=a[1]}else if(t.operation==="SPECIFICMONTH"){var i=parseInt(t.value1),r=new p;if(Number.isFinite(i)){r.setDate(1);r.setMonth(i);r=d.getMonthStartDate(r);a=d.getRange(0,"MONTH",r);t.value1=a[0];t.value2=a[1]}}else if(t.operation==="TODAYFROMTO"){if(!isNaN(parseInt(t.value1))){t.value1=this._getTodayFromToValueFrom(t.value1)}if(!isNaN(parseInt(t.value2))){t.value2=this._getTodayFromToValueTo(t.value2)}}else{var o=this.getOperation(t.operation);if(o&&o.getDateRange){n=o.getDateRange(t);if(!n){return[]}t.value1=n&&n.value1?n.value1:null;t.value2=n&&n.value2?n.value2:null}}if(t.value1 instanceof p){t.value1=t.value1.oDate}if(t.value2 instanceof p){t.value2=t.value2.oDate}if(t.operation==="DATE"){if(!(this.isValidCondition()&&t.value1)){return[]}t.operation="BT";t.value2=t.value1;t.value1=S.setStartTime(t.value1).oDate;t.value2=S.setEndTime(t.value2,this._bIgnoreTime,this._Precision).oDate}else if(t.operation==="FROM"){if(!(this.isValidCondition()&&t.value1)){return[]}t.operation="GE";delete t.value2;t.value1=S.setStartTime(t.value1,this._bIgnoreTime).oDate}else if(t.operation==="TO"){if(!(this.isValidCondition()&&t.value1)){return[]}t.operation="LE";delete t.value2;t.value1=S.setEndTime(t.value1,this._bIgnoreTime).oDate}else if(this._bSingleFilterRestriction){if(!(this.isValidCondition()&&t.value1)){return[]}}else if(t.operation==="DATETIME"){if(!(this.isValidCondition()&&t.value1)){return[]}t.operation="EQ";delete t.value2}else if(t.operation==="DATETIMERANGE"||t.operation==="LASTMINUTES"||t.operation==="LASTHOURS"||t.operation==="NEXTHOURS"||t.operation==="NEXTMINUTES"){if(!(this.isValidCondition()&&t.value1&&t.value2)){return[]}t.operation="BT"}else{if(n){t.operation=n.operation;t.value1=t.value1?S.setStartTime(t.value1).oDate:null;t.value2=t.value2?S.setEndTime(t.value2,this._bIgnoreTime).oDate:null}else{if(!(this.isValidCondition()&&t.value1&&t.value2)){return[]}t.operation="BT";t.value1=S.setStartTime(t.value1).oDate;t.value2=S.setEndTime(t.value2,this._bIgnoreTime).oDate}}t.exclude=false;t.keyField=t.key;delete t.key;if(t.value2){if(typeof t.value1.getTime==="function"&&typeof t.value2.getTime==="function"&&t.value1.getTime()>t.value2.getTime()){e=t.value2;t.value2=t.value1;t.value1=e}}return[t]};S.prototype.getTokenText=function(){return""};S.prototype.getName=function(){return this.getMetadata().getName()};S.prototype.getType=function(){return"Edm.Date"};S.prototype._bindValueState=function(e){e.bindProperty("valueState",{path:"$smartEntityFilter>inputstate",formatter:function(){if(this.getBinding("valueState").getValue()==="ERROR"){return I.Error}else{return I.None}}})};S.prototype.initializeFilterItem=function(){return this._initializeFilterItemNew.apply(this,arguments)};S.prototype._getDateFormatter=function(e){var t={style:this.oDateFormat.style,pattern:this.oDateFormat.pattern,strictParsing:e};if(JSON.stringify(t)!==this._sFormatSettings){this._sFormatSettings=JSON.stringify(t);this._oDateFormatter=g.getInstance(t)}return this._oDateFormatter};S.prototype._fillNumberToText=function(e,t,a){var n="X",i="Y";if(t||t===0){n=String(t)}if(a||a===0){i=String(a);if(t<0){n="("+n+")"}if(a<0){i="("+i+")"}}e=e.replace("{0}",n);e=e.replace("{1}",i);return e};S.prototype._setIntControlBinding=function(e,a,n){e.setFieldWidth("auto");e.bindProperty("description",{path:"$smartEntityFilter>"+n,type:"sap.ui.model.type.Integer",formatter:function(){var e=a.descriptionTextKeys[0];var n=a.descriptionTextKeys[1];if(this.getBinding("description").getValue()===1){return t.getTranslatedText(e)}else{return t.getTranslatedText(n||e)}}})};S.prototype._createIntFromToControl=function(e,a,n){return new o(t._createStableId(e,a),{value:{path:"$smartEntityFilter>"+n,type:new f({},{minimum:-e._maxIntValue,maximum:e._maxIntValue})},textAlign:"End",width:"100%"})};S.prototype._isValidFromToPeriod=function(e,t){if(!e&&e!==0||isNaN(e)){return false}if(!t&&t!==0||isNaN(t)){return false}if(e<-this._maxIntValue||e>this._maxIntValue){return false}if(t<-this._maxIntValue||t>this._maxIntValue){return false}if(e<0&&Math.abs(e)>Math.abs(t)||e===0&&t<0||t<0&&Math.abs(t)>Math.abs(e)||t===0&&e<0||e<0&&t<0){return false}return true};S.prototype._getTodayFromToValueFrom=function(e){if(e<0){var t=d.getRange(-1*e,"DAY")[1];t.setHours(0,0,0);return t}return d.getRange(-e,"DAY")[0]};S.prototype._getTodayFromToValueTo=function(e){if(e<0){var t=d.getRange(e,"DAY")[0];t.setHours(23,59,59);return t}return d.getRange(e,"DAY")[1]};S.prototype._getInputValueState=function(){if(this._oInput){return this._oInput.getValueState()}};S.prototype.destroy=function(){if(this.iChangeTimer){clearTimeout(this.iChangeTimer);delete this.iChangeTimer}t.prototype.destroy.apply(this,arguments)};S.prototype._initializeFilterItemNew=function(){var e={style:this.oDateFormat.style,pattern:this.oDateFormat.pattern,strictParsing:false};this._oInput=new c(t._createStableId(this),{name:this.sFieldName,formatter:y.getInstance({date:e}),enableGroupHeaders:!this._bSingleFilterRestriction,calendarWeekNumbering:this.oFilterProvider&&this.oFilterProvider._oCalendarWeekSettings?this.oFilterProvider._oCalendarWeekSettings:undefined,standardOptions:{path:"$smartEntityFilter>/operations",formatter:function(e){return e.reduce(function(e,t){if(A.includes(t.key)){e.push(t.key)}return e},[])}},change:this._onDDRChange.bind(this)});this._createCustomDDOptions(this.getOperations());this._oInput.setValue(this._getDefaultValueDDR());this._bindValueState(this._oInput);this._oInput.setBindingContext(this.getContext(),"$smartEntityFilter");this._oInput.setModel(this.getModel(),"$smartEntityFilter");this.bFireFilterChange=false;this.getModel().checkUpdate(true);this.bFireFilterChange=true;return this._oInput};S.prototype.updateOperations=function(){var e=this.getOperations();for(var t=0;t<e.length;t++){this._updateOperation(e[t])}this._createCustomDDOptions(e);this.oModel.setProperty("operations",e,this.getContext(),true);if(this._customSemanticOperation){var a=e.find(function(e){return e.key===this._customSemanticOperation}.bind(this));if(a){this.setOperation(this._customSemanticOperation);this._customSemanticOperation=null}}return};S.prototype.setCondition=function(e){t.prototype.setCondition.apply(this,arguments);this._setDDROperation.call(this,e);return this};S.prototype._onDDRChange=function(e){var t,a,n=e.getParameter("value"),i=e.getParameter("valid");if(i&&n){var r=this._getOptionName(n.operator);t=this.getOperation(r);a=this._prepareDDRValues(t,n,r);this.oModel.setProperty("/currentoperation",t);this.oModel.setProperty("/condition/operation",r);this.oModel.setProperty("/condition/value1",a[0]);this.oModel.setProperty("/condition/value2",a[1])}else if(i){t=this.getOperation("DATERANGE");this.oModel.setProperty("/currentoperation",t);this.oModel.setProperty("/condition/operation","DATERANGE");this.oModel.setProperty("/condition/value1",null);this.oModel.setProperty("/condition/value2",null)}e.getSource().setValueStateText("");this.oModel.setProperty("inputstate",i?"NONE":"ERROR",this.getContext())};S.prototype._getDefaultValueDDR=function(){var e=this.getDefaultOperation(),t=e&&e.key;if(!this._getDDROption(t)){return null}var a=typeof e.defaultValues==="function"?e.defaultValues():e.defaultValues;if(!A.includes(t)){t=this._getCustomDDOptionName(t)}if(Array.isArray(a)&&a.length>0&&a[0]!==null){return{operator:t,values:a}}return null};S.prototype._getDDROption=function(e){if(!this._oInput){return null}if(A.includes(e)){return this._oInput.getOption(e)}return this._oInput.getOption(this._getCustomDDOptionName(e))};S.prototype._getCustomDDOptionName=function(e){return this.sFieldName+"__custom__"+e};S.prototype._getOptionName=function(e){var t=e.split("__custom__");if(t.length>1){return t[1]}return t[0]};S.prototype._createCustomDDOptions=function(e){if(!this._oInput){return}var t=this._oInput.getValue();this._oInput.destroyAggregation("customOptions");e.forEach(this._createCustomDDOption,this);if(t&&!this._getDDROption(this._getOptionName(t.operator))){this._oInput.setValue(null);this._oInput._oInput.setValue(null);this.oModel.setProperty("/currentoperation",null);this.oModel.setProperty("/condition/value1",null);this.oModel.setProperty("/condition/value2",null)}};S.prototype._createCustomDDOption=function(e){if(A.includes(e.key)){return}var t;var a=typeof e.category==="object"?e.category.key:e.category;if(a.toLowerCase().startsWith("fixed")||e.type==="range"){t=this._createCustomFixedDDOption(e)}else{t=this._createCustomDynamicDDOption(e)}t.getGroupHeader=function(){if(typeof e.category==="object"){var t=e.category.bundle;var a=e.category.key;if(sap.ui.getCore().getLibraryResourceBundle(t).hasText(a)){return sap.ui.getCore().getLibraryResourceBundle(t).getText(a)}}if(sap.ui.getCore().getLibraryResourceBundle("sap.ui.comp").hasText(e.category)){return sap.ui.getCore().getLibraryResourceBundle("sap.ui.comp").getText(e.category)}if(sap.ui.getCore().getLibraryResourceBundle("sap.m").hasText(e.category)){return sap.ui.getCore().getLibraryResourceBundle("sap.m").getText(e.category)}return sap.ui.getCore().getLibraryResourceBundle("sap.m").getText("DDR_OPTIONS_GROUP_0")};t.getGroup=function(){return e.order};this._oInput.addAggregation("customOptions",t)};S.prototype._createCustomFixedDDOption=function(e){var a=this._getCustomDDOptionName(e.key);var n=this;var i=E.extend(a,{metadata:{library:"sap.ui.comp"},getText:function(){return e.languageText||t.getTranslatedText(e.textKey)},getValueHelpUITypes:function(){return[]},enhanceFormattedValue:function(){if(!n.getOperation(n._getOptionName(e.key))){return false}var t=typeof e.category==="object"?e.category.key:e.category;if(t.toUpperCase().startsWith("FIXED.")&&e.type==="int"){return false}return true},format:this._customDDOptionFormatter.bind(this),toDates:function(t){var a=e.defaultValues;if(typeof a==="function"){a=a()}if(t&&a.length>0&&!(a[0]instanceof Date)){var i=n.oModel.getProperty("",n.oConditionContext),r=i.operation,o=a[0],s=a[1];i.operation=n._getOptionName(t.operator);i.value1=!isNaN(a[0])?parseInt(a[0]):a[0];i.value2=!isNaN(a[1])?parseInt(a[1]):a[1];var l=n.getFilterRanges();i.operation=r;i.value1=o;i.value2=s;if(l.length===0){return[]}return[l[0].value1]}return a},parse:function(a){var n=e.basicLanguageText||e.languageText||t.getTranslatedText(e.textKey);if(a&&n&&n.toLowerCase().startsWith(a.toLowerCase())){return{operator:this.getKey(),values:this.toDates()}}return null}});return new i({key:a})};S.prototype._createCustomDynamicDDOption=function(e){var a=this._getCustomDDOptionName(e.key);var n=this;var i=E.extend(a,{metadata:{library:"sap.ui.comp"},getText:function(){var a=e.languageText||t.getTranslatedText(e.textKey);if(a.indexOf("{0}")>=0){return n._fillNumberToText(a)}return a},getValueHelpUITypes:function(){if(e.type==="int"){return[new h({type:"int"})]}else if(e.type==="[int,int]"){return[new h({type:"int"}),new h({type:"int"})]}},createValueHelpUI:function(t,a){t.aControlsByParameters={};t.aControlsByParameters[this.getKey()]=[];n.setControls([]);var i=n.getControls(e),r=e.defaultValues.length,o=e.defaultValues;if(typeof o==="function"){o=o()}i.forEach(function(e){if(!e.getValue()&&o&&o[0]){if(typeof o==="function"){o=o()}e.setValue(o[0]);o.shift();n.oModel.setProperty("/condition/value"+(r-o.length),e.getValue())}if(typeof a==="function"){e.attachChange(function(){a(this)},this)}t.aControlsByParameters[this.getKey()].push(e)},this);n.setControls(i);return i},format:this._customDDOptionFormatter.bind(this),toDates:function(e){var t=n.oModel.getProperty("",n.oConditionContext),a=t.operation,i=t.value1,r=t.value2;t.operation=n._getOptionName(e.operator);t.value1=!isNaN(e.values[0])?parseInt(e.values[0]):e.values[0];t.value2=!isNaN(e.values[1])?parseInt(e.values[1]):e.values[1];var o=n.getFilterRanges();t.operation=a;t.value1=i;t.value2=r;if(o.length===0){return[]}return[o[0].value1,o[0].value2]},parse:function(t){var a=new l({key:e.key}),i=e.filterSuggestItem.call(e,t,a,n);if(i){return{operator:this.getKey(),values:[a._value1,a._value2||null]}}return null},validateValueHelpUI:function(e){var t=function(e){var t=e.getValue(),a=this._maxIntValue,n=-this._maxIntValue;if(!t&&t!==0||isNaN(t)){return false}if(r&&r.getBindingInfo("value")&&r.getBindingInfo("value").type&&r.getBindingInfo("value").type.oConstraints){if(r.getBindingInfo("value").type.oConstraints.hasOwnProperty("minimum")){n=r.getBindingInfo("value").type.oConstraints.minimum}if(r.getBindingInfo("value").type.oConstraints.hasOwnProperty("maximum")){a=r.getBindingInfo("value").type.oConstraints.maximum}}if(t<n||t>a){return false}return true};var a=this.getValueHelpUITypes();for(var i=0;i<a.length;i++){var r=e.aControlsByParameters[this.getKey()][i];switch(a[i].getType()){case"int":return t.call(n,r);case"month":case"date":case"daterange":if(!r.getSelectedDates()||r.getSelectedDates().length==0){return false}break;case"options":if(r.getSelectedIndex()<0){return false}break}}return true}});return new i({key:a})};S.prototype._customDDOptionFormatter=function(e){var t=this._getOptionName(e.operator),a=this.getOperation(t);if(!a){this._oInput.setValue(null);this._oInput._oInput.setValue(null);this.oModel.setProperty("/currentoperation",null);this.oModel.setProperty("/condition/value1",null);this.oModel.setProperty("/condition/value2",null);return""}var n=this._prepareDDRValues(a,e,t);var i={conditionTypeInfo:{data:{value1:n[0],value2:n[1]}}};if(a.languageText){var r=a.languageText;if(this._isIntIntInterval(a)){if(i.conditionTypeInfo.data.value1!=null&&i.conditionTypeInfo.data.value1!==""&&i.conditionTypeInfo.data.value2!=null&&i.conditionTypeInfo.data.value2!==""){r=this._formatIntIntInterval(a,i)}}else if(this._isIntInterval(a)){if(i.conditionTypeInfo.data.value1!==null&&i.conditionTypeInfo.data.value1!==""){r=this._formatIntInterval(a,i)}else{r=""}}else if(this._isFixedRange(a)){r=this._formatFixedRange(a,a.textValue)}else{if(i.conditionTypeInfo.data.value1!==null&&i.conditionTypeInfo.data.value1!==""){var o=this._calculateDateRangeValueText(a,i);var s=o.value;if(s){r=this._formatFixedRange(a,s)}else{r=""}}else{r=""}}}return r};S.prototype._isIntInterval=function(e){return e.basicLanguageText.indexOf("{0}")>=0};S.prototype._formatIntInterval=function(e,t){if(t.conditionTypeInfo.data.value1===0&&e.zeroNumberTextKey){return e.zeroNumberLanguageText}if(t.conditionTypeInfo.data.value1===1&&e.singulareBasicLanguageText){return e.singulareBasicLanguageText}return this._fillNumberToText(e.basicLanguageText,t.conditionTypeInfo.data.value1)};S.prototype._isIntIntInterval=function(e){return e.basicLanguageText.indexOf("{0}")>=0&&e.basicLanguageText.indexOf("{1}")>=0};S.prototype._formatIntIntInterval=function(e,t){return this._fillNumberToText(e.basicLanguageText,t.conditionTypeInfo.data.value1,t.conditionTypeInfo.data.value2)};S.prototype._isFixedRange=function(e){return e.textValue};S.prototype._formatFixedRange=function(e,t){return e.languageText};S.prototype._calculateDateRangeValueText=function(e,t){var a=t.conditionTypeInfo.data.value1;var n=t.conditionTypeInfo.data.value2;var i;var r=false;if((typeof a==="number"||typeof a==="string"&&!isNaN(parseInt(a)))&&e.valueList){i=e.valueList[a].text}else if(a instanceof Date){var o=this._getDateFormatter(false);if(t.conditionTypeInfo.data.operation!=="DATERANGE"&&(a&&!n)){i=o.format(a)}else if(t.conditionTypeInfo.data.operation==="DATERANGE"&&a&&n){i=o.format(a)+" - "+o.format(n)}else if(t.conditionTypeInfo.data.operation==="DATERANGE"&&a&&!n){i=o.format(a)+" - ";r=true}else{i=""}}else{i=t.conditionTypeInfo.data.value1}return{value:i,bSetCursor:r}};S.prototype._convertUniversalDateToDate=function(e){return e.map(function(e){if(e.getJSDate){return e.getJSDate()}return e})};S.prototype._prepareDDRValues=function(e,t,a){if(a==="SPECIFICMONTH"){return[].concat(t.values)}var n=typeof e.category==="object"?e.category.key:e.category;if(e.type==="int"&&!n.toUpperCase().startsWith("FIXED.")){return[parseInt(t.values[0]),null]}if(e.type==="[int,int]"){return[parseInt(t.values[0]),parseInt(t.values[1])]}var i=this._oInput.toDates(t);if(this._bDTOffset&&(a==="DATETIME"||a==="DATETIMERANGE")){if(i[0]){i[0]=m.localToUiTimezone(i[0].oDate)}if(i[1]){i[1]=m.localToUiTimezone(i[1].oDate)}}return this._convertUniversalDateToDate(i)};S.prototype._setDDROperation=function(e){if(this._oInput&&e.key&&e.operation){var t=[];if(e.value1||e.value1===0){t[0]=e.value1;if(e.value2||e.value2===0){t[1]=e.value2}}var a=this._getDDROption(e.operation),n=this.getOperation(e.operation),i=function(e,t){if(!e){return false}if(e.hasOwnProperty("value1")&&!t[0]&&t[0]!==0){return false}if(e.hasOwnProperty("value2")&&!t[1]&&t[1]!==0){return false}return true};if(this._bDTOffset&&(a.getKey()==="DATETIME"||a.getKey()==="DATETIMERANGE")){if(t[0]){t[0]=m.uiTimezoneToLocal(t[0])}if(t[1]){t[1]=m.uiTimezoneToLocal(t[1])}}if(i(n,t)){this._oInput.setValue({key:e.key,operator:a.getKey(),values:t})}else{this._oInput.setValue(null);this._oInput._oInput.setValue(null)}}};return S});
/*!
 * SAPUI5
 * (c) Copyright 2009-2023 SAP SE. All rights reserved.
 */
sap.ui.predefine("sap/ui/comp/config/condition/NullableInteger", ["sap/ui/model/type/Integer"],function(e){"use strict";var t=e.extend("sap.ui.model.type.NullableInteger",{parseValue:function(t,i){if(this.getPrimitiveType(i)=="string"){if(t===""){return null}}return e.prototype.parseValue.apply(this,arguments)}});return t});
/*!
 * SAPUI5
 * (c) Copyright 2009-2023 SAP SE. All rights reserved.
 */
sap.ui.predefine("sap/ui/comp/config/condition/Type", ["sap/ui/core/date/UI5Date","sap/ui/base/EventProvider","sap/ui/model/json/JSONModel","sap/ui/core/date/UniversalDate"],function(t,e,o,i){"use strict";var n=e.extend("sap.ui.comp.config.condition.Type",{constructor:function(t,i,n){e.call(this);this.oFilterProvider=i;var r={condition:{operation:"",value1:null,value2:null,key:t},operations:[],controls:[],currentoperation:{},pending:false};this.oModel=new o(r);var a=this.oModel.checkUpdate;this.oModel.suspend=function(){this.bSuspended=true;this.checkUpdate=function(){}};this.oModel.resume=function(){this.bSuspended=false;this.checkUpdate=a;this.checkUpdate()};this.oContext=this.oModel.getContext("/");this.oConditionContext=this.oModel.getContext("/condition");this.sFieldName=t;var s=this.oModel.bindProperty("operation",this.oConditionContext),l=this;s.attachChange(function(){var t=l.oModel.getProperty("operation",l.getConditionContext()),e=l.getOperation(t);if(e){e=Object.assign({},e);if(!l.bIgnoreBindingChange){var o=l.getDefaultValues(e);if(l._bSingleFilterRestriction&&o[0]){l.setDefaultValues(o[0].oDate,o[1])}else{l.setDefaultValues(o[0],o[1])}}}l.setControls([]);l.setControls(l.getControls(e));if(e){if(e.getValueList){e.valueList=e.getValueList()}l.oModel.setProperty("/currentoperation",e)}if(!l.bIgnoreBindingChange){l.serialize(false,l.bFireFilterChange)}});var u=this.oModel.bindProperty("value1",this.oConditionContext);u.attachChange(function(){if(!l.bIgnoreBindingChange){l.serialize(false,l.bFireFilterChange)}});var p=this.oModel.bindProperty("value2",this.oConditionContext);p.attachChange(function(){if(!l.bIgnoreBindingChange){l.serialize(false,l.bFireFilterChange)}});var d=this.oModel.bindProperty("pending",this.oContext);d.attachChange(function(){if(l.bAsync){if(l._iPendingTimer){clearTimeout(l._iPendingTimer)}l._iPendingTimer=setTimeout(l["fireEvent"].bind(l,"PendingChange",{oSource:l,pending:l.oModel.getProperty("/pending")}),10)}});this.oFieldMetadata=n;this.oOperationFilter=null;this.bAsync=false}});n._createStableId=function(t,e){if(t&&t.oFilterProvider&&t.oFieldMetadata){return t.oFilterProvider._createFilterControlId(t.oFieldMetadata)+(e?e:"")}else{return undefined}};n.getTranslatedText=function(t,e,o){if(typeof t==="object"){e=t.bundle;t=t.key}if(!e){e="sap.ui.comp"}return sap.ui.getCore().getLibraryResourceBundle(e).getText(t,o)||t};n.prototype.getTranslatedText=n.getTranslatedText;n.prototype.applySettings=function(e){if(e&&e.defaultOperation){this._sSettingsDefaultOperation=e.defaultOperation}if(e&&e.defaultDate&&!e.defaultOperation){var o=t.getInstance(e.defaultDate);if(o instanceof Date){this._sSettingsDefaultOperation="DATE";this._defaultDate=e.defaultDate}}if(e&&e.operations&&e.operations.filter){this.oOperationFilter=e.operations.filter}else{this.oOperationFilter=null}};n.prototype.getParent=function(){return this.oFilterProvider._oSmartFilter};n.prototype.getModel=function(){return this.oModel};n.prototype.getConditionContext=function(){return this.oConditionContext};n.prototype.setDefaultValues=function(t,e){this.oModel.setProperty("value1",t,this.getConditionContext(),true);this.oModel.setProperty("value2",e,this.getConditionContext(),true)};n.prototype.getContext=function(){return this.oContext};n.prototype.getControls=function(t){return[]};n.prototype.getOperations=function(){return[]};n.prototype.isPending=function(){return this.getModel().getProperty("pending",this.getContext())};n.prototype.attachPendingChange=function(t){this.attachEvent("PendingChange",t)};n.prototype.detachPendingChange=function(t){this.detachEvent("PendingChange",t)};n.prototype.setPending=function(t){if(this.bAsync){this.getModel().setProperty("pending",t,this.getContext())}};n.prototype._filterOperation=function(t){if(!this.oOperationFilter){return true}var e=Array.isArray(this.oOperationFilter)?this.oOperationFilter:[this.oOperationFilter],o;e.some(function(e){if(!e.path){return false}var i=t[e.path];var n=e.exclude||false;var r;if(e.contains&&i){r=typeof e.contains==="string"?e.contains.split(","):e.contains;o=n;for(var a=0;a<r.length;a++){if(n&&i.indexOf(r[a])>-1){o=false;return true}else if(!n&&i.indexOf(r[a])>-1){o=true;return true}}}if(e.equals&&i){r=typeof e.equals==="string"?e.equals.split(","):e.equals;o=n;for(var a=0;a<r.length;a++){if(n&&i===r[a]){o=false;return true}else if(!n&&i===r[a]){o=true;return true}}}return false});return o};n.prototype._updateOperation=function(t){if(!t.textValue){t.textValue=""}if(!t.languageText&&t.textKey){t.languageText=this.getTranslatedText(t.textKey)}};n.prototype.updateOperations=function(){this.oModel.setProperty("operations",[],this.getContext())};n.prototype.getOperation=function(t){var e=this.oModel.getProperty("operations",this.getContext())||[];for(var o=0;o<e.length;o++){if(t===e[o].key){return e[o]}}return null};n.prototype.getDefaultOperation=function(){var t=this.getOperations();if(!t||t.length===0){return null}for(var e=0;e<t.length;e++){if(this._sSettingsDefaultOperation===t[e].key){if(this._defaultDate&&t[e].key==="DATE"){t[e].defaultValues=[new i(this._defaultDate).oDate];this._defaultDate=null}return t[e]}if(!this._sSettingsDefaultOperation&&t[e].defaultOperation){if(!this._defaultDate&&t[e].key==="DATE"&&t[e].defaultValues&&t[e].defaultValues[0]){t[e].defaultValues=[null]}return t[e]}}return t[0]};n.prototype.setControls=function(t){var e=this.oModel.getProperty("controls",this.getContext());var o;if(e){for(o=0;o<e.length;o++){e[o].destroy()}}this.oModel.setProperty("controls",t,this.getContext());if(t){for(o=0;o<t.length;o++){t[o].setBindingContext(this.getConditionContext(),"$smartEntityFilter")}}};n.prototype.setOperation=function(t){var e=this.getOperation(t);if(e){this.setCondition({operation:e.key,key:this.sFieldName,value1:e.defaultValues[0]||null,value2:e.defaultValues[1]||null});this.getModel().checkUpdate(true)}else{}};n.prototype.isValidCondition=function(){return false};n.prototype.setCondition=function(t){this.oModel.setProperty("key",t.key,this.oConditionContext);this.oModel.setProperty("operation",t.operation,this.oConditionContext);this.oModel.setProperty("value1",t.value1,this.oConditionContext);this.oModel.setProperty("value2",t.value2,this.oConditionContext);this.oModel.setProperty("tokenText",this.getTokenText(t),this.oConditionContext);return this};n.prototype.setAsync=function(t){this.bAsync=t};n.prototype.getAsync=function(t){return this.bAsync};n.prototype.initialize=function(t){this.updateOperations()};n.prototype.serialize=function(){};n.prototype.validate=function(t){this._bForceError=t!==false;var e,o=this.getModel().getProperty("inputstate",this.getContext())||"NONE";if(!this.isPending()&&this.oFieldMetadata&&this.oFieldMetadata.isMandatory&&(!this.isValidCondition()||o!=="NONE")&&this._bForceError){e=this.oFieldMetadata.control;if(e&&e.setValueStateText){e.setValueStateText(this.getTranslatedText("MANDATORY_FIELD_WITH_LABEL_ERROR","sap.ui.comp",[this.oFieldMetadata.label]))}this.getModel().setProperty("inputstate","ERROR",this.getContext());return false}this.getModel().setProperty("inputstate","NONE",this.getContext());return true};n.prototype.getCondition=function(){var t=Object.assign({},this.oModel.getProperty("",this.oConditionContext));return t};n.prototype.providerDataUpdated=function(t,e){};n.prototype.getFilter=function(t){return null};n.prototype.getFilterRanges=function(t){return null};n.prototype.getTokenText=function(t){return""};n.prototype.getName=function(){return this.getMetadata().getName()};n.prototype.getType=function(){return"Edm"};n.prototype.destroy=function(){this.setControls([]);e.prototype.destroy.apply(this,arguments)};return n});
/*!
 * SAPUI5
 * (c) Copyright 2009-2023 SAP SE. All rights reserved.
 */
sap.ui.predefine("sap/ui/comp/filterbar/FilterBar", ["sap/ui/core/library","sap/m/Button","sap/m/Label","sap/m/Panel","sap/m/Text","sap/m/OverflowToolbar","sap/m/ToolbarSpacer","sap/ui/Device","sap/ui/comp/state/UIState","./VariantConverterFrom","./VariantConverterTo","sap/ui/comp/smartvariants/PersonalizableInfo","sap/ui/comp/smartvariants/SmartVariantManagementUi2","sap/ui/core/InvisibleText","sap/ui/layout/Grid","sap/ui/layout/GridRenderer","sap/ui/layout/GridData","sap/ui/layout/HorizontalLayout","sap/ui/layout/VerticalLayout","sap/ui/layout/AlignedFlowLayout","sap/m/library","sap/ui/model/json/JSONModel","./FilterGroupItem","sap/base/Log","sap/base/util/merge","sap/ui/core/ShortcutHintsMixin","sap/base/util/Deferred","sap/m/delegate/ValueStateMessage","sap/m/ToolbarSeparator","sap/ui/layout/form/Form","sap/ui/core/Configuration"],function(t,e,i,r,a,n,s,o,l,h,d,u,f,_,c,p,g,m,F,A,y,v,I,b,V,B,S,C,T,M,R){"use strict";var D=t.ValueState;var E=sap.ui.getCore().getLibraryResourceBundle("sap.ui.comp").getText("SEARCH_FIELD_VALIDATION_WARNING_MESSAGE");var L=t.TextAlign;var N=y.ButtonType;var T;var M;var x;var P;var w;var O=c.extend("sap.ui.comp.filterbar.FilterBar",{metadata:{library:"sap.ui.comp",designtime:"sap/ui/comp/designtime/filterbar/FilterBar.designtime",properties:{persistencyKey:{type:"string",group:"Misc",defaultValue:""},advancedMode:{type:"boolean",group:"Misc",defaultValue:false},expandAdvancedArea:{type:"boolean",group:"Misc",defaultValue:false,deprecated:true},searchEnabled:{type:"boolean",group:"Misc",defaultValue:true,deprecated:true},filterBarExpanded:{type:"boolean",group:"Misc",defaultValue:true},considerGroupTitle:{type:"boolean",group:"Misc",defaultValue:false},showAllFilters:{type:"boolean",group:"Misc",defaultValue:false},showClearButton:{type:"boolean",group:"Misc",defaultValue:false,deprecated:true},showRestoreButton:{type:"boolean",group:"Misc",defaultValue:true},showGoOnFB:{type:"boolean",group:"Misc",defaultValue:true},showRestoreOnFB:{type:"boolean",group:"Misc",defaultValue:false},showClearOnFB:{type:"boolean",group:"Misc",defaultValue:false},showGoButton:{type:"boolean",group:"Misc",defaultValue:null,deprecated:true},deltaVariantMode:{type:"boolean",group:"Misc",defaultValue:true},filterContainerWidth:{type:"string",group:"Misc",defaultValue:"12rem"},useToolbar:{type:"boolean",group:"Misc",defaultValue:true},header:{type:"string",group:"Misc",defaultValue:""},showFilterConfiguration:{type:"boolean",group:"Misc",defaultValue:true},useSnapshot:{type:"boolean",group:"Misc"},isRunningInValueHelpDialog:{type:"boolean",group:"Misc",defaultValue:false},disableSearchMatchesPatternWarning:{type:"boolean",group:"Misc",defaultValue:false}},aggregations:{filterItems:{type:"sap.ui.comp.filterbar.FilterItem",multiple:true,singularName:"filterItem"},filterGroupItems:{type:"sap.ui.comp.filterbar.FilterGroupItem",multiple:true,singularName:"filterGroupItem"},_parameters:{type:"sap.ui.comp.filterbar.FilterGroupItem",multiple:true,singularName:"_parameter",visibility:"hidden"}},associations:{basicSearch:{type:"sap.m.SearchField",multiple:false}},events:{cancel:{},reset:{parameters:{selectionSet:{type:"sap.ui.core.Control[]"}}},search:{parameters:{selectionSet:{type:"sap.ui.core.Control[]"},firedFromFilterBar:{type:"boolean"}}},beforeVariantSave:{parameters:{context:{type:"string"}}},beforeVariantFetch:{},afterVariantLoad:{parameters:{context:{type:"string"},executeOnSelect:{type:"boolean"}}},filterChange:{parameters:{added:{type:"sap.ui.core.Control"},deleted:{type:"sap.ui.core.Control"},filterItem:{type:"sap.ui.comp.filterbar.FilterGroupItem"}}},clear:{parameters:{selectionSet:{type:"sap.ui.core.Control[]"}}},initialise:{},initialized:{},afterVariantSave:{},filtersDialogClosed:{parameters:{context:{type:"string"}}},filtersDialogBeforeOpen:{},filtersDialogSearch:{},filtersDialogCancel:{},filtersDialogSearchForFilters:{parameters:{newValue:{type:"string"}}},assignedFiltersChanged:{}}},renderer:{apiVersion:2}});O.INTERNAL_GROUP="__$INTERNAL$";O.prototype._hasAnyVisibleText=function(t){var e=t.getContent()[0],i=e&&e.getVisible()&&e.getText()!=="";return!!i};O.prototype._hasAnyVisibleButtons=function(){var t=this.getShowGoOnFB()||this.getShowClearOnFB()||this.getShowRestoreOnFB()||this.getShowFilterConfiguration();return!!t};O.prototype._toggleEndContentVisibility=function(){var t=this._oBasicAreaLayout&&this._oBasicAreaLayout.getEndContent()[0],e;if(t){e=this._hasAnyVisibleButtons()||this._hasAnyVisibleText(t);t.setVisible(e)}};O.prototype.init=function(){var t=this.getFilterContainerWidth();c.prototype.init.apply(this,arguments);this._filterGroupItemChange=this._filterGroupItemChange.bind(this);this._filterItemChange=this._filterItemChange.bind(this,null);this._oBasicAreaLayout=null;this._oVariantManagement=null;this._oCollectiveSearch=null;this._aBasicAreaSelection=null;this._mAdvancedAreaFilter=null;this._mAdvancedAreaFilterFlat=[];this._aOrderedFilterItems=[];this._aAdaptFilterItems=[];this._mAdvancedAreaHiddenFilters=[];this._mAdaptFiltersDialogInitialItemsOrder=[];this._fRegisteredFetchData=null;this._fRegisteredApplyData=null;this._fRegisterGetFiltersWithValues=null;this._oHideShowButton=null;this._oShowAllFiltersButton=null;this._oSearchButton=null;this._oFiltersButton=null;this._oClearButtonOnFB=null;this._oRestoreButtonOnFB=null;this._bIsInitialized=false;this._bSearchFiredFromFilterBar=false;this._bMoveTriggered=false;this._bDelegateAdded=false;this._oInitializedDeferred=new S;this._aFields=null;this._oBasicSearchField=null;this._oVariant={};this._oSelectedVariantBase=null;this._filterChangeSemaphore=true;this._triggerFilterChangeState=true;this._fRegisteredFilterChangeHandlers=null;this._fInitialiseVariants=null;this._bHostedVariantManagement=false;this._nMaxFiltersByDefault=8;this._bResetFiltersDialogTriggered=false;this._oRb=sap.ui.getCore().getLibraryResourceBundle("sap.ui.comp");this.setHSpacing(0);this.addStyleClass("sapUiCompFilterBar sapUiCompFilterBarMarginBottom sapUiCompFilterBarPaddingPanel sapContrastPlus");this.addStyleClass(this._isPhone()?"sapUiCompFilterBarPhone":"sapUiCompFilterBarNonPhone");this._oToolbar=this._createToolbar();this.addContent(this._oToolbar);this._bDelayRendering=true;this._oBasicAreaLayout=new A;this._oBasicAreaLayout.setVisible(false);this._oBasicAreaLayout.setLayoutData(new g({span:"L12 M12 S12"}));this._oBasicAreaLayout.setMinItemWidth(t);this._oBasicAreaLayout.setMaxItemWidth(t);this.addContent(this._oBasicAreaLayout);this._oAdvancedPanel=new r;this._oAdvancedPanel.setLayoutData(new g({span:"L12 M12 S12"}));this._oAdvancedPanel.setVisible(false);this.addContent(this._oAdvancedPanel);this.oModel=new v({});this.setModel(this.oModel,"FilterBar");this._oHintText=new a({text:this._oRb.getText("FILTER_BAR_NO_FILTERS_ON_FB"),textAlign:L.Center});this._oHintText.setVisible(false);this._oHintText.addStyleClass("sapUiCompFilterBarHint");if(this._isTablet()||this._isPhone()){this.setFilterBarExpanded(false)}this.getMetadata().addPublicMethods("getInitializedPromise")};O.prototype.onBeforeRendering=function(){if(c.prototype.onBeforeRendering){c.prototype.onBeforeRendering.apply(this,arguments)}if(this.getIsRunningInValueHelpDialog()){if(this._isTablet()){this.addStyleClass("compFilterBarTablet")}this.iAddedContentLength=4-this._oBasicAreaLayout.getContent().length;var t=this.iAddedContentLength;if(t<4&&t>0&&!this._bLayoutAdded){while(t>0){this._oBasicAreaLayout.addContent((new F).data("blankLayout",true));t--}this._bLayoutAdded=true}if(this._oShowAllFiltersButton===null){this.initShowAllFiltersButton()}if(this._oBasicSearchField&&this._oBasicSearchField.isA("sap.m.SearchField")){this._oBasicSearchField.setWidth("100%")}this._oBasicAreaLayout.setMaxItemWidth(null);this._oAdvancedPanel.setVisible(false);this._rerenderFilters()}else if(this._oShowAllFiltersButton){this._oBasicAreaLayout.removeEndContent(this._oShowAllFiltersButton);this._oShowAllFiltersButton=null}else{this._oHideShowButton&&this._oHideShowButton.addStyleClass("sapUiCompFilterBarPaddingRightBtn")}if(!this.getIsRunningInValueHelpDialog()&&this._isNewFilterBarDesign()){this._toggleEndContentVisibility()}};O.prototype.getShowAllFiltersButton=function(){return this._oShowAllFiltersButton};O.prototype.setFilterContainerWidth=function(t){this._oBasicAreaLayout.setMinItemWidth(t);if(this.getUseToolbar()){this._oBasicAreaLayout.setMaxItemWidth(this._oBasicAreaLayout.getMinItemWidth())}else{this._setMaxItemWidth2()}this.setProperty("filterContainerWidth",t);return this};O.prototype._setMaxItemWidth2=function(){var t,e,i=this._oBasicAreaLayout.getMinItemWidth();["rem","%","px","em"].some(function(e){var r=i.indexOf(e);if(r>0){i=i.substring(0,r);t=e;return true}return false});if(t){e=parseInt(i);if(!isNaN(e)){e*=2;this._oBasicAreaLayout.setMaxItemWidth(e+t)}}};O.prototype._hasAnyVisibleFiltersOnFB=function(){var t=this._retrieveVisibleAdvancedItems();for(var e=0;e<t.length;e++){if(t[e].filterItem.getVisibleInFilterBar()){return true}}return false};O.prototype._showHintText=function(){var t=0;if(!this._oHintText){return}if(this._isNewFilterBarDesign()){return}if(!this.getAdvancedMode()&&!this._isPhone()){var e=!this._hasAnyVisibleFiltersOnFB();if(e){t=this._oAdvancedPanel.indexOfContent(this._oHintText);if(t<0){this._oAdvancedPanel.insertContent(this._oHintText,0)}}this._oHintText.setVisible(e);this._oAdvancedPanel.setVisible(e);if(!this._bDelayRendering){this._oBasicAreaLayout.setVisible(!e&&this.getFilterBarExpanded())}}};O.prototype._hasRelevantFilters=function(){var t,e=null,i;if(!this._mAdvancedAreaFilter||Object.keys(this._mAdvancedAreaFilter)<1){return false}if(this.getAdvancedMode()){for(e in this._mAdvancedAreaFilter){var r=this._mAdvancedAreaFilter[e];if(r&&r.items){for(t=0;t<r.items.length;t++){i=r.items[t];if(i){if(this._determineVisibility(i.filterItem)){return true}}}}}return false}return true};O.prototype._adaptButtonsEnablement=function(){var t=!!this._mAdvancedAreaFilter;if(this._oHideShowButton){this._oHideShowButton.setEnabled(t);if(this.getAdvancedMode()&&!this._isPhone()){this._oHideShowButton.setVisible(this._hasRelevantFilters())}}this._oClearButtonOnFB.setEnabled(t);this._oRestoreButtonOnFB.setEnabled(t);this._oFiltersButton.setEnabled(t);var e=true;if(this._isPhone()&&this.getUseToolbar()){e=false}if(t&&this.getFilterBarExpanded()&&e&&!this.getAdvancedMode()){this._oBasicAreaLayout.setVisible(true)}};O.prototype.getVariantManagement=function(){return this._oVariantManagement};O.prototype.setShowClearOnFB=function(t){this.setProperty("showClearOnFB",t);this._oClearButtonOnFB.setVisible(t);return this};O.prototype.setShowRestoreOnFB=function(t){this.setProperty("showRestoreOnFB",t);this._oRestoreButtonOnFB.setVisible(t);return this};O.prototype.setShowGoOnFB=function(t){this.setProperty("showGoOnFB",t);this._calcVisibilityGoButton();return this};O.prototype._calcVisibilityGoButton=function(){var t=this.getShowGoOnFB();if(t&&!this._isPhone()&&this.isLiveMode&&this.isLiveMode()){t=false}this._oSearchButton.setVisible(t)};O.prototype.setShowGoButton=function(t){this.setShowGoOnFB(t);return this};O.prototype.getShowGoButton=function(){return this.getShowGoOnFB()};O.prototype.hideGoButton=function(){this._oSearchButton.setVisible(false)};O.prototype.restoreGoButton=function(){this._oSearchButton.setVisible(this.getShowGoOnFB())};O.prototype.setShowFilterConfiguration=function(t){this.setProperty("showFilterConfiguration",t);if(this._oFiltersButton){this._oFiltersButton.setVisible(t)}return this};O.prototype.isCurrentVariantStandard=function(){var t;if(this._oVariantManagement){t=this._oVariantManagement.getCurrentVariantId();if(t===""){return true}return t===this._oVariantManagement.getStandardVariantKey()}return undefined};O.prototype.setCurrentVariantId=function(t,e){if(this._oVariantManagement){this._oVariantManagement.setCurrentVariantId(t,e)}};O.prototype.getCurrentVariantId=function(){var t="";if(this._oVariantManagement){t=this._oVariantManagement.getCurrentVariantId()}return t};O.prototype.getDataSuiteFormat=function(t){return this._getDataSuiteFormat(t,null)};O.prototype._getDataSuiteFormat=function(t,e){var i=null,r,a,n,s,o;if(this._oVariantManagement){r=this.getCurrentVariantId();if(this.getFilterDataAsString){n=this._determineVariantFiltersInfo(t,true);if(this.getFilterContextUrl){o=this.getFilterContextUrl()}if(this.getParameterContextUrl){s=this.getParameterContextUrl()}a=this.getFilterDataAsString(t);if(a){var l=new d;i=l.convert(r,n,a,this,e,s,o)}}}return i};O.prototype.getBasicSearchName=function(){var t=null;if(this._oBasicSearchField&&this.getEntitySet){t="$"+this.getEntitySet()+".basicSearch"}return t};O.prototype.getBasicSearchValue=function(){return this._getBasicSearchValue()};O.prototype.setUiStateAsVariant=function(t,e){var i={replace:true,strictMode:true};this.setUiState(t,i);this.fireAfterVariantLoad(e,false);this._applyVisibility(t.getSelectionVariant())};O.prototype._applyVisibility=function(t){var e=function(t){if(t&&t.getVisible()&&!t.getHiddenFilter()){if(!t.getVisibleInFilterBar()){t.setVisibleInFilterBar(true)}if(!t.getPartOfCurrentVariant()){t.setPartOfCurrentVariant(true)}}};if(this._bIsInitialized){for(var i in this._mAdvancedAreaFilter){if(i){this._mAdvancedAreaFilter[i].items.forEach(function(t){if(t&&t.filterItem&&t.filterItem.getMandatory()){e(t.filterItem)}else if(t&&t.filterItem){if(t.filterItem.getVisibleInFilterBar()){t.filterItem.setVisibleInFilterBar(false)}(function(){if(t.filterItem.getPartOfCurrentVariant()){if(i===O.INTERNAL_GROUP){t.filterItem.setPartOfCurrentVariant(true)}else{t.filterItem.setPartOfCurrentVariant(false)}}})()}})}}if(t&&t.Parameters){t.Parameters.forEach(function(t){var i=this.determineFilterItemByName(t.PropertyName);e(i)}.bind(this))}if(t&&t.SelectOptions){t.SelectOptions.forEach(function(t){var i=this.determineFilterItemByName(t.PropertyName);e(i)}.bind(this))}}};O.prototype.getUiState=function(t){var e,i,r=false,a=null,n,s;if(t){r=t.allFilters===true}i=this._getDataSuiteFormat(r,"13.0");e=new l;e.selectionVariant=JSON.parse(i);e.setSelectionVariant(e.selectionVariant);var o=e.getSelectionVariant();if(o){if(this.getModelData&&this.getModelData()){a=this.getModelData()}s=l.calcSemanticDates(o,a);e.setSemanticDates(s);n=l.calculateValueTexts(o,a);e.setValueTexts(n);window.sessionStorage.setItem(this.getId(),JSON.stringify(n));window.sessionStorage.setItem("semanticDates",JSON.stringify(s))}return e};O.prototype.setUiState=function(t,e){var i,r,a=null,n=false,s=true,o;if(e&&typeof e.replace==="boolean"){n=e.replace}if(e&&typeof e.strictMode==="boolean"){s=e.strictMode}if(t){a=t.getSelectionVariant();if(a){r=JSON.stringify(a)}i=t.getValueTexts();o=t.getSemanticDates()}if(!i){i=JSON.parse(window.sessionStorage.getItem(this.getId()))}if(!o){o=JSON.parse(window.sessionStorage.getItem("semanticDates"))}this._setDataSuiteFormat(r,n,s,i,o);this._enhanceFilterItemsWithTextValue(i,a)};O.prototype.getDescriptionForKeys=function(t){};O.prototype._enhanceFilterItemsWithTextValue=function(t,e){var i=l.determineFiltersWithOnlyKeyValues(t,e,[this.getBasicSearchName()]);this.getDescriptionForKeys(i)};O.prototype.setDataSuiteFormat=function(t,e){this._setDataSuiteFormat(t,e,true)};O.prototype._setDataSuiteFormat=function(t,e,i,r,a){var n,s,o;if(t){n=new h;s=n.convert(t,this,i);if(s){this._clearErrorState();if(s.variantId&&this._oVariantManagement){if(this._bIsInitialized){if(this._oVariantManagement.isPageVariant()){this._oVariantManagement._selectVariant(s.variantId,"DATA_SUITE")}else{this._setFilterVisibility(s.variantId)}}this._oVariantManagement.setInitialSelectionKey(s.variantId)}if(s.payload&&(e||Object.keys(JSON.parse(s.payload)).length>0)&&this.setFilterDataAsString){o=s.payload;if(r){o=l.enrichWithValueTexts(o,r)}if(a){o=l.enrichWithSemanticDates(o,a)}this.setFilterDataAsString(o,e)}if(s.basicSearch&&this._oBasicSearchField&&this._oBasicSearchField.setValue){this._oBasicSearchField.setValue(s.basicSearch);this._updateToolbarText()}}}};O.prototype._setFilterVisibility=function(t){if(this._oVariantManagement.getSelectionKey()!==t){this._oVariantManagement.setInitialSelectionKey(t);var e=this._getStandardVariant();if(e){var i=this._oVariantManagement.getVariantContent(this,t);if(i&&i.filterbar){if(i.hasOwnProperty("version")){i=this.mergeVariant(e,i)}this._reapplyVisibility(i.filterbar)}}}};O.prototype.applySettings=function(t){if(this._possibleToChangeVariantManagement()){if(t&&t.customData){for(var e=0;e<t.customData.length;e++){var i=t.customData[e];if(i&&i.mProperties&&i.mProperties.key==="pageVariantPersistencyKey"){this._oVariantManagement.setPersistencyKey(i.mProperties.value);this._oVariantManagement.setVisible(true);this._bHostedVariantManagement=true}}}}if(t&&t.persistencyKey){this._bHostedVariantManagement=true}c.prototype.applySettings.apply(this,arguments);if(!this.getUseToolbar()&&!this.getFilterBarExpanded()){this.setFilterBarExpanded(true)}this._afterVariantsLoad()};O.prototype.setPersistencyKey=function(t){this.setProperty("persistencyKey",t);if(this._possibleToChangeVariantManagement()){this._oVariantManagement.setVisible(true)}return this};O.prototype._possibleToChangeVariantManagement=function(){if(this._oVariantManagement&&!this._oVariantManagement.isPageVariant()){return true}return false};O.prototype.clearVariantSelection=function(){if(this._oVariantManagement){this._oVariantManagement.clearVariantSelection()}};O.prototype.setSearchEnabled=function(t){this.setProperty("searchEnabled",t);if(this._oSearchButton){this._oSearchButton.setEnabled(t)}return this};O.prototype.setSearchButtonEmphType=function(t){};O.prototype.setSimplifiedMode=function(t){};O.prototype.getSimplifiedMode=function(){if(this.getAdvancedMode()){return false}return true};O.prototype.setExpandAdvancedArea=function(t){this.setFilterBarExpanded(t);return this};O.prototype.getExpandAdvancedArea=function(){return this.getFilterBarExpanded()};O.prototype.setAdvancedMode=function(t){this.setProperty("advancedMode",t);this.toggleStyleClass("sapContrastPlus",!t);if(t){if(!this._oAdvancedAreaForm){this._oAdvancedAreaForm=this._createAdvancedAreaForm()}if(this._possibleToChangeVariantManagement()){this._oVariantManagement.setVisible(false)}if(this._oToolbar){this._oToolbar.addStyleClass("sapUiCompFilterBarToolbarBasicSearchNoVariant");if(this._oBasicSearchField){if(this._oToolbar.indexOfContent(this._oBasicSearchField)<0){this._oToolbar.insertContent(this._oBasicSearchField,1)}}}}else{if(this.getPersistencyKey()&&this._possibleToChangeVariantManagement()){if(this._oVariantManagement){this._oVariantManagement.setVisible(true)}if(this._oToolbar){this._oToolbar.removeStyleClass("sapUiCompFilterBarToolbarBasicSearchNoVariant")}}}this._oFiltersButton.setVisible(!t);if(this._oHideShowButton){this._oHideShowButton.setVisible(t&&this._isPhone()?false:true);if(this._oHideShowButton.getVisible()){if(this.getFilterBarExpanded()){this._oHideShowButton.setText(this._oRb.getText("FILTER_BAR_VH_HIDE_FILTERS"))}else{this._oHideShowButton.setText(this._oRb.getText("FILTER_BAR_VH_SHOW_FILTERS"))}}}if(!this._bDelayRendering){this._oBasicAreaLayout.setVisible(!t&&this.getFilterBarExpanded())}this._oAdvancedPanel.setVisible(t&&this.getFilterBarExpanded());this._adaptButtonsEnablement();return this};O.prototype.setUseToolbar=function(t){this.setProperty("useToolbar",t);if(!t){this._adaptNewFilterBarDesign();this._oAdvancedPanel&&this._oAdvancedPanel.setVisible(false)}else{this._recreateToolbar()}return this};O.prototype._recreateToolbar=function(){if(!this._oToolbar){this._bButtonaAdded=false;if(this._oButtonsVLayout){this._oBasicAreaLayout.removeContent(this._oButtonsVLayout);this._oButtonsVLayout.destroy();this._oButtonsVLayout=null}this._oToolbar=this._createToolbar(true);this.insertContent(this._oToolbar,0);if(this._oVariantManagement){if(this._oVariantManagement instanceof f||this._oVariantManagement.getId()===this.getId()+"-variant"){this._oToolbar.insertContent(this._oVariantManagement,0)}}this._adaptButtonsEnablement();if(this._oBasicSearchFieldContainer){this._oBasicAreaLayout.removeContent(this._oBasicSearchFieldContainer);this._cleanBasicSearchContainer();this.setBasicSearch(this._oBasicSearchField)}this._oHintText=new a({text:this._oRb.getText("FILTER_BAR_NO_FILTERS_ON_FB"),textAlign:L.Center});this._oHintText.setVisible(false);this._oHintText.addStyleClass("sapUiCompFilterBarHint");if(!this._hasAnyVisibleFiltersOnFB()){this._oAdvancedPanel.addContent(this._oHintText);if(!this.getUseToolbar()){this._oBasicAreaLayout.addContent(this._oHintText)}}this._oBasicAreaLayout.setMaxItemWidth(this._oBasicAreaLayout.getMinItemWidth());this._updateToolbarText()}};O.prototype._cleanBasicSearchContainer=function(){if(this._oBasicSearchFieldContainer){var t=this._oBasicSearchFieldContainer.removeAllContent();if(t){for(var e=0;e<t.length;e++){if(t[e]!==this._oBasicSearchField){t[e].destroy()}}}this._oBasicSearchFieldContainer.destroy();this._oBasicSearchFieldContainer=null}};O.prototype.setHeader=function(t){this.setProperty("header",t);if(this.getUseToolbar()){this._addHeaderToToolbar(t)}return this};O.prototype._addHeaderToToolbar=function(t){if(this._oToolbar){if(t){if(this._oVariantManagement&&(this._oVariantManagement.getVisible()||this._bHostedVariantManagement)&&this._oToolbar.indexOfContent(this._oVariantManagement)>-1){if(!this._oSeparator){if(!T&&!this._bToolbarSeparatorRequested){T=sap.ui.require("sap/m/ToolbarSeparator");if(!T){sap.ui.require(["sap/m/ToolbarSeparator"],G.bind(this));this._bToolbarSeparatorRequested=true}}if(T){this._oSeparator=new T(this.getId()+"-HeadSep")}}this._oToolbar.removeContent(this._oSeparator);this._oToolbar.insertContent(this._oSeparator,0);this._oToolbar.setHeight("3rem")}if(!this._oText){this._oText=new a(this.getId()+"-HeadText");this._oText.addStyleClass("sapMH4Style");this._oText.addStyleClass("sapUiCompSmartChartHeader")}this._oText.setText(t);this._oToolbar.removeContent(this._oText);this._oToolbar.insertContent(this._oText,0)}else{if(this._oSeparator){this._oToolbar.removeContent(this._oSeparator);this._oSeparator.destroy();delete this._oSeparator;this._oToolbar.setHeight()}if(this._oText){this._oToolbar.removeContent(this._oText);this._oText.destroy();delete this._oText}}}};function G(t){T=t;this._bToolbarSeparatorRequested=false;if(!this._bIsBeingDestroyed){this._addHeaderToToolbar(this.getHeader())}}O.prototype._isNewFilterBarDesign=function(){if(this.getAdvancedMode()){return false}if(!this.getUseToolbar()){return true}return false};O.prototype._adaptNewFilterBarDesign=function(){if(this._isNewFilterBarDesign()){this.setFilterBarExpanded(true);if(!this._bDelayRendering){this._oBasicAreaLayout.setVisible(this.getFilterBarExpanded())}if(this._oToolbar){var t=this._oToolbar.getContent();for(var e=0;e<t.length;e++){this._oToolbar.removeContent(t[e]);if(t[e].isA("sap.m.ToolbarSpacer")){t[e].destroy()}}if(!this.getUseToolbar()){this.removeContent(this._oToolbar);this._oToolbar.destroy();this._oToolbar=null}}if(this._oHintText){this._oBasicAreaLayout.removeContent(this._oHintText);this._oHintText.destroy();this._oHintText=null}if(this._oHideShowButton){this._oHideShowButton.destroy();this._oHideShowButton=null}if(!this._bButtonaAdded){this._bButtonaAdded=true;this._addButtonsToBasicArea()}if(this._oBasicSearchField){this.setBasicSearch(this._oBasicSearchField)}this._oBasicAreaLayout.setMinItemWidth(this.getFilterContainerWidth());this._setMaxItemWidth2()}};O.prototype._addButtonsToBasicArea=function(){var t=new F;if(R.getRTL()){t.addStyleClass("sapUiCompFilterBarFloatLeft")}else{t.addStyleClass("sapUiCompFilterBarFloatRight")}var e=new m;t.addContent(new a);t.addContent(e);e.addContent(this._oSearchButton);e.addContent(this._oClearButtonOnFB);e.addContent(this._oRestoreButtonOnFB);e.addContent(this._oFiltersButton);this._updateToolbarText();this._oBasicAreaLayout.addEndContent(t);this._oButtonsVLayout=t};O.prototype._addBasicSearchToBasicArea=function(t){if(this._oBasicSearchFieldContainer){this._cleanBasicSearchContainer()}if(t){var e=new i({text:""});e.addStyleClass("sapBasicSearchFilter");var r=this._addControlToBasicAreaContainer(null,t,e);if(r){r.setVisible(true);this._oBasicAreaLayout.insertContent(r,0);this._oBasicSearchFieldContainer=r;this._oBasicSearchFieldContainer.setWidth("100%")}}};O.prototype._setCollectiveSearch=function(t){if(this.getAdvancedMode()){if(this._oToolbar){if(this._oVariantManagement){this._oToolbar.removeContent(this._oVariantManagement);this._unregisterVariantManagement(this._oVariantManagement);this._oVariantManagement=null}if(this._oCollectiveSearch){this._oToolbar.removeContent(this._oCollectiveSearch)}this._oCollectiveSearch=t;this._oToolbar.insertContent(this._oCollectiveSearch,0);this._oToolbar.removeStyleClass("sapUiCompFilterBarToolbarBasicSearchNoVariant")}}};O.prototype.setBasicSearch=function(t){var e=this;this.setAssociation("basicSearch",t,true);if(typeof t==="string"){t=sap.ui.getCore().byId(t)}if(t&&t.getParent()){if(this._isUi2Mode()){t.attachLiveChange(function(t){e.fireFilterChange(t)})}this._oBasicSearchField=t;return}if(this._oBasicSearchField&&this._oToolbar){this._oToolbar.removeContent(this._oBasicSearchField)}if(t&&this._isNewFilterBarDesign()){this._addBasicSearchToBasicArea(t)}else{if(t&&this._oToolbar&&(!this._isPhone()||this.getAdvancedMode())){var i=this._indexOfSpacerOnToolbar();this._oToolbar.insertContent(t,i);if(this._isUi2Mode()){t.attachLiveChange(function(t){e.fireFilterChange(t)})}}}this._oBasicSearchField=t;return this};O.prototype._getBasicSearchValue=function(){if(this._oBasicSearchField&&this._oBasicSearchField.getValue){return this._oBasicSearchField.getValue()}return null};O.prototype._indexOfSpacerOnToolbar=function(){var t=this._oToolbar.getContent(),e;if(t){for(e=0;e<t.length;e++){if(t[e]instanceof s){return e}}}return 0};O.prototype.addFilterItem=function(t){var e,i,r,a;if(!t){throw new Error("sap.ui.comp.filterbar.FilterBar.prototype.addFilterItem()"+" Expected argument 'oFilterItem' may not be null nor empty")}e=t.getName();if(!e){throw new Error("sap.ui.comp.filterbar.FilterBar.prototype.addFilterItem()"+" Expected argument 'oFilterItem.name' may not be null nor empty")}i=t._getControl();if(!i){throw new Error("sap.ui.comp.filterbar.FilterBar.prototype.addFilterItem()"+" Expected argument 'oFilterItem.control' may not be null nor empty")}this.addAggregation("filterItems",t,true);if(!this._aBasicAreaSelection){this._aBasicAreaSelection=[]}var n={control:t._getControl(),filterItem:t};this._aBasicAreaSelection.push(n);a=t.getId()+"__filterGroupItem";r=sap.ui.getCore().byId(a);if(!r){r=new I(t.getId()+"__filterGroupItem",{label:t.getLabel(),controlTooltip:t.getControlTooltip(),name:t.getName(),mandatory:t.getMandatory(),visible:t.getVisible(),visibleInFilterBar:t.getVisibleInFilterBar(),partOfCurrentVariant:true,control:t._getControl(),groupName:O.INTERNAL_GROUP,groupTitle:"",hiddenFilter:t.getHiddenFilter(),entitySetName:t.getEntitySetName(),entityTypeName:t.getEntityTypeName()})}if(t.data("isCustomField")){r.data("isCustomField",true)}t.attachChange(this._filterItemChange);this.addFilterGroupItem(r);return this};O.prototype.addFilterGroupItem=function(t){var e,i,r,a;if(!t){throw new Error("sap.ui.comp.filterbar.FilterBar.prototype.addFilterGroupItem()"+" Expected argument 'oFilterGroupItem' may not be null nor empty")}this.addAggregation("filterGroupItems",t,true);i=t.getGroupName();if(!i){throw new Error("sap.ui.comp.filterbar.FilterBar.prototype.addFilterGroupItems()"+" GroupName may not be null nor empty")}e=t.getName();if(!e){throw new Error("sap.ui.comp.filterbar.FilterBar.prototype.addFilterGroupItems()"+" Name may not be null nor empty")}if(!this._mAdvancedAreaFilter){this._mAdvancedAreaFilter={}}if(!this._mAdvancedAreaFilter[i]){this._mAdvancedAreaFilter[i]={};this._mAdvancedAreaFilter[i].filterItem=null;this._mAdvancedAreaFilter[i].items=[]}if(!this._mAdvancedAreaFilter[i].items){this._mAdvancedAreaFilter[i].items=[]}if(!this._mAdvancedAreaFilter[i].filterItem){this._mAdvancedAreaFilter[i].filterItem=t}r={control:t._getControl(),filterItem:t};if(this.getAdvancedMode()||t.getVisibleInFilterBar()){t.setVisibleInFilterBar(true)}else{t.setVisibleInFilterBar(false)}this._mAdvancedAreaFilter[i].items.push(r);if(!t.getHiddenFilter()){a=this._addControlToBasicAreaFormContainer(t);if(a){r.container=a;a.setVisible(t.getVisible()&&t.getVisibleInFilterBar());if(t.getVisibleInFilterBar()){t.setPartOfCurrentVariant(t.getVisibleInFilterBar())}t.attachChange(this._filterGroupItemChange)}if(this.getAdvancedMode()&&!this.getIsRunningInValueHelpDialog()){this._rerenderAA()}else{this._showHintText()}}this._adaptButtonsEnablement();return this};O.prototype.removeFilterItem=function(t){var e,i,r,a,n=this.getFilterItems(),s=this.getFilterGroupItems();if(!n||!n.length){return null}i=this._getRemovedItemAsObject(t,n);if(!i){return null}i.detachChange(this._filterItemChange);for(e=0;e<this._aBasicAreaSelection.length;e++){if(this._aBasicAreaSelection[e].filterItem.getId()===i.getId()){this._aBasicAreaSelection.splice(e,1);if(this._aBasicAreaSelection.length===0){this._aBasicAreaSelection=null}break}}this.removeAggregation("filterItems",i,true);r=i.getId()+"__filterGroupItem";a=this._getRemovedItemAsObject(r,s);this._removeFilterGroupItem(a);return i};O.prototype.removeFilterGroupItem=function(t){var e,i=this.getFilterGroupItems();if(!i||!i.length){return null}e=this._getRemovedItemAsObject(t,i);if(!e){return null}return this._removeFilterGroupItem(e)};O.prototype._getRemovedItemAsObject=function(t,e){var i,r;if(typeof t==="string"){for(i=0;i<e.length;i++){if(e[i].getId()===t){r=e[i];break}}}if(typeof t==="number"){if(t<0||t>=e.length){b.warning("sap.ui.comp.filterbar.FilterBar.prototype.removeFilterGroupItems() is called with invalid index "+t)}else{r=e[t]}}if(typeof t==="object"){r=t}return r};O.prototype._removeFilterGroupItem=function(t){var e,i,r,a=t.getGroupName();t.detachChange(this._filterGroupItemChange);this.removeAggregation("filterGroupItems",t,true);if(this._mAdvancedAreaFilter&&this._mAdvancedAreaFilter[a]&&this._mAdvancedAreaFilter[a].items){i=this._mAdvancedAreaFilter[a];for(e=0;e<i.items.length;e++){r=i.items[e];if(r.filterItem.getId()===t.getId()){r.container.removeAllContent();r.container.destroy();i.items.splice(e,1);if(i.filterItem.getId()===t.getId()){if(i.items.length){i.filterItem=i.items[0].filterItem}else{delete this._mAdvancedAreaFilter[a]}}break}}if(this.getFilterGroupItems().length===0){this._mAdvancedAreaFilter=null;this._adaptButtonsEnablement()}}return t};O.prototype._addParameter=function(t){var e,i,r,a=false,n=false,s=O.INTERNAL_GROUP;t._setParameter(true);t.setVisibleInFilterBar(true);t.setPartOfCurrentVariant(true);this.addAggregation("_parameters",t,true);i={control:t._getControl(),filterItem:t};if(!this._mAdvancedAreaFilter){this._mAdvancedAreaFilter={}}if(!this._mAdvancedAreaFilter[s]){this._mAdvancedAreaFilter[s]={};this._mAdvancedAreaFilter[s].filterItem=null}if(!this._mAdvancedAreaFilter[s].items){this._mAdvancedAreaFilter[s].items=[]}for(e=0;e<this._mAdvancedAreaFilter[s].items.length;e++){var o=this._mAdvancedAreaFilter[s].items[e];if(o.filterItem._isParameter()){continue}this._mAdvancedAreaFilter[s].items.splice(e,0,i);a=true;break}if(!a){this._mAdvancedAreaFilter[s].items.push(i);if(Object.keys(this._mAdvancedAreaFilter).length>1){n=true}}r=this._addControlToBasicAreaFormContainer(t);if(r){i.container=r;r.setVisible(t.getVisible());t.attachChange(this._filterGroupItemChange.bind(this))}if(a||n){this._oBasicAreaLayout.removeContent(r);if(t.getVisible()){this._addContainerInOrder(i.filterItem,i.container)}}if(!this.getAdvancedMode()){this._showHintText()}this._adaptButtonsEnablement();return this};O.prototype._filterItemChange=function(t,e){var i,r,a,n;if(e&&e.oSource&&e.oSource.isA("sap.ui.comp.filterbar.FilterItem")){a=e.getParameter("propertyName");if(a==="visibleInFilterBar"||a==="visible"||a==="label"||a==="labelTooltip"||a==="controlTooltip"||a==="mandatory"){i=this._determineItemByName(e.oSource.getName(),O.INTERNAL_GROUP);if(i&&i.filterItem){if(a==="visible"){r=e.oSource.getVisible();i.filterItem.setVisible(r)}else if(a==="visibleInFilterBar"){r=e.oSource.getVisibleInFilterBar();var s=this._checkChangePossibleVisibleInFilterBar(i.filterItem,r);if(s){i.filterItem.setVisibleInFilterBar(r)}else{e.oSource.setVisibleInFilterBar(true)}}else if(a==="label"){i.filterItem.setLabel(e.oSource.getLabel())}else if(a==="labelTooltip"){i.filterItem.setLabelTooltip(e.oSource.getLabelTooltip())}else if(a==="controlTooltip"){n=this.determineControlByFilterItem(i.filterItem,true);if(n&&n.setTooltip){n.setTooltip(i.filterItem.getControlTooltip())}}else if(a==="mandatory"){r=e.oSource.getMandatory();i.filterItem.setMandatory(r)}}}}};O.prototype._filterGroupItemChange=function(t){var e;var i;if(t&&t.oSource){i=t.getParameter("propertyName");if(i==="visibleInFilterBar"||i==="visible"){e=this._determineItemByName(t.oSource.getName(),t.oSource.getGroupName());if(e){if(i==="visibleInFilterBar"){var r=t.oSource.getVisibleInFilterBar();var a=r;var n=this._checkChangePossibleVisibleInFilterBar(t.oSource,r);if(!n){t.oSource.setVisibleInFilterBar(true);a=true}if(a){t.oSource.setPartOfCurrentVariant(true)}if(!r&&!this._isFilterItemInBasicGroup(e.filterItem)){t.oSource.setPartOfCurrentVariant(false)}if(!this.getAdvancedMode()&&!this._oAdaptFiltersDialog){this._rerenderItem(e)}}else if(i==="visible"){if(!this._oAdaptFiltersDialog){if(this.getAdvancedMode()&&e.container){e.container.setVisible(true)}else{this._updateToolbarText();this._rerenderItem(e)}}}this._showHintText()}}else if(i==="groupTitle"){if(this._mAdvancedAreaFilter&&this._mAdvancedAreaFilter[t.oSource.getGroupName()]){this._adaptGroupTitle(t.oSource.getGroupName())}}else if(i==="label"){if(!this._oAdaptFiltersDialog){this._adaptGroupTitleForFilter(t.oSource)}}else if(i==="mandatory"){this._mandatoryFilterItemChange(t.oSource)}else if(i==="partOfCurrentVariant"&&this.ensureLoadedValueHelpList){var s=this.determineFilterItemByName(t.oSource.getName());if(s&&s.getPartOfCurrentVariant()){this.ensureLoadedValueHelpList(t.oSource.getName())}}if(this.getAdvancedMode()&&!this.getIsRunningInValueHelpDialog()){this._rerenderAA()}}};O.prototype._addContainer=function(t){if(t&&this._oBasicAreaLayout){if(t.container&&this._oBasicAreaLayout.indexOfContent(t.container)===-1){this._addContainerInOrder(t.filterItem,t.container)}}};O.prototype._removeContainer=function(t){if(t&&this._oBasicAreaLayout){if(t.container&&this._oBasicAreaLayout.indexOfContent(t.container)>-1){this._oBasicAreaLayout.removeContent(t.container)}}};O.prototype._addContainerInOrder=function(t,e){var i,r,a,n=this._oBasicAreaLayout.getContent(),s=-1;if(this._oBasicSearchField&&this._isNewFilterBarDesign()){s++}if(this._mAdvancedAreaFilter){for(i in this._mAdvancedAreaFilter){var o=this._mAdvancedAreaFilter[i];if(o&&o.items){for(r=0;r<o.items.length;r++){if(!o.items[r].container){continue}if(o.items[r].container===e){this._oBasicAreaLayout.insertContent(e,s+1);return}a=n.indexOf(o.items[r].container);if(a>=0){s=a}}}}}};O.prototype._checkChangePossibleVisibleInFilterBar=function(t,e){if(t&&t.getMandatory()&&!e){var i=this._hasFilterValue(t);if(!i){t.setVisibleInFilterBar(true);return false}}return true};O.prototype._hasFilterValue=function(t){var e;if(!this._getTriggerFilterChangeState()&&this.getAllFiltersWithValues){e=this.getAllFiltersWithValues()}else{e=this._getFiltersWithValues()}return this._checkFilterForValue(e,t)};O.prototype._adaptGroupTitleForFilter=function(t){var e;var i;if(t&&!t.getHiddenFilter()){e=t.getLabel();i=t.getLabelControl(this.getId());if(this.getConsiderGroupTitle()){if(i&&t.getGroupTitle()){i.setText(e+" ("+t.getGroupTitle()+")")}}else{i.setText(e)}}};O.prototype._adaptGroupTitle=function(t){var e;var i;if(this._mAdvancedAreaFilter&&this._mAdvancedAreaFilter[t]&&this._mAdvancedAreaFilter[t].items){for(e=0;e<this._mAdvancedAreaFilter[t].items.length;e++){i=this._mAdvancedAreaFilter[t].items[e];if(i&&i){this._adaptGroupTitleForFilter(i.filterItem)}}}};O.prototype.registerGetFiltersWithValues=function(t){this._fRegisterGetFiltersWithValues=t;return this};O.prototype.registerFetchData=function(t){this._fRegisteredFetchData=t;return this};O.prototype.registerApplyData=function(t){this._fRegisteredApplyData=t;return this};O.prototype._isTINAFScenario=function(){if(this._oVariantManagement){if(!this._isUi2Mode()){return true}}else{if(this._oCollectiveSearch&&this.getAdvancedMode()){return true}}return false};O.prototype.fireInitialise=function(){if(this._isTINAFScenario()){this._createVisibleFilters();if(this.getAdvancedMode()){this._ensureFilterLoaded(null)}this._fireInitialiseEvent()}else{this._initializeVariantManagement()}if(this.getIsRunningInValueHelpDialog()){this._rerenderFilters()}};O.prototype.variantsInitialized=function(){this._afterVariantsLoad();this.fireInitialized();this._oInitializedDeferred.resolve()};O.prototype.fireInitialized=function(){this.fireEvent("initialized");this._mAdvancedAreaFilterFlat=this._getAllFilterItemsFlat();this._oInitializedDeferred.resolve()};O.prototype.getInitializedPromise=function(){return this._oInitializedDeferred.promise};O.prototype._initializeVariantManagement=function(){this._createVisibleFilters();if(this._oVariantManagement&&this.getPersistencyKey()){if(this._isTINAFScenario()){this._oVariantManagement.initialise(this._initialiseVariants,this)}else{this._fInitialiseVariants=this._initialiseVariants.bind(this);this._oVariantManagement.attachInitialise(this._fInitialiseVariants,this);this._oVariantManagement.initialise()}}else{this._fireInitialiseEvent()}};O.prototype._fireInitialiseEvent=function(){try{this.fireEvent("initialise");this._showHintText()}catch(t){b.error("error during initialise event handling - "+t.message)}this._bIsInitialized=true;this._updateToolbarText()};O.prototype._initialiseVariants=function(){this._fireInitialiseEvent();if(this._oVariantManagement){this._oVariantManagement.currentVariantSetModified(false)}};O.prototype.fireAfterVariantLoad=function(t,e){this._rerenderFilters();this._aAdaptFilterItems=[];this._oSelectedVariantBase=null;var i={context:t,executeOnSelect:e};try{this.fireEvent("afterVariantLoad",i)}catch(t){b.error("error during 'afterVariantLoad' event handling - "+t.message)}};O.prototype.fireBeforeVariantSave=function(t){var e={context:t};var i=this._getConsiderFilterChanges();if(t){this._setConsiderFilterChanges(false)}this.fireEvent("beforeVariantSave",e);if(t){this._setConsiderFilterChanges(i)}};O.prototype.destroyFilterGroupItems=function(){var t=this.getFilterGroupItems();this._destroyItems(t);return this};O.prototype.destroyFilterItems=function(){var t=this.getFilterItems();this._destroyItems(t);return this};O.prototype.removeAllFilterItems=function(){var t,e=this.getFilterItems();if(e&&e.length){for(t=0;t<e.length;t++){this.removeFilterItem(e[t])}}return e};O.prototype.removeAllFilterGroupItems=function(){var t,e=[],i=this.getFilterGroupItems();if(i&&i.length){for(t=0;t<i.length;t++){e.push(i[t]);this.removeFilterGroupItem(i[t])}}return e};O.prototype.removeAllFilters=function(){this.removeAllFilterItems();this.removeAllFilterGroupItems();this.removeBasicSearch()};O.prototype.removeBasicSearch=function(){this.setBasicSearch(null)};O.prototype.getAllFilterItems=function(t){var e,i=null;var r=[];var a,n;if(!t){this._ensureFilterLoaded(null)}if(this._mAdvancedAreaFilter){for(i in this._mAdvancedAreaFilter){if(i){a=this._mAdvancedAreaFilter[i];if(a.items){for(e=0;e<a.items.length;e++){n=a.items[e];if(n&&n.filterItem&&n.filterItem.getVisible()){if(t){if(n.filterItem.getVisibleInFilterBar()||this._checkIfFilterHasValue(n.filterItem.getName())||n.filterItem.data("isCustomField")&&this._checkIfCustomControlFilterHasValue(n)){r.push(n.filterItem)}}else{r.push(n.filterItem)}}}}}}}return r};O.prototype._checkIfFilterHasValue=function(t){return false};O.prototype._checkIfCustomControlFilterHasValue=function(t){return false};O.prototype._clearErrorState=function(){this._resetFiltersInErrorValueState()};O.prototype.getAggregation=function(t){if(t=="filterGroupItems"&&!this.__bDeleteMode){this._ensureFilterLoaded(null)}return c.prototype.getAggregation.apply(this,arguments)};O.prototype._getFilterInformation=function(){return[]};O.prototype._isFilterBarContext=function(){return true};O.prototype._createVisibleFilters=function(){this._getFilters()};O.prototype._getFilters=function(){var t=[],e=this._oFilterProvider&&this._oFilterProvider.getModel()&&this._oFilterProvider.getModel().getData();if(e){t=Object.keys(e).filter(function(t){return this._checkIfFilterHasValue(t)}.bind(this))}this._aFields=this._getFilterInformation();var i,r;if(this._aFields&&this._aFields.length>0){if(!this._mAdvancedAreaFilter){this._mAdvancedAreaFilter={};if(!this.getAdvancedMode()){this._mAdvancedAreaFilter[O.INTERNAL_GROUP]={};this._mAdvancedAreaFilter[O.INTERNAL_GROUP].filterItem=null;this._mAdvancedAreaFilter[O.INTERNAL_GROUP].items=null}}for(i=0;i<this._aFields.length;i++){r=this._aFields[i];if(r.groupName!==O.INTERNAL_GROUP){if(!this._mAdvancedAreaFilter[r.groupName]){this._mAdvancedAreaFilter[r.groupName]={};this._mAdvancedAreaFilter[r.groupName].groupTitle=r.groupTitle;this._mAdvancedAreaFilter[r.groupName].filterItem=null;this._mAdvancedAreaFilter[r.groupName].items=[]}}if(r.visibleInAdvancedArea||r.groupName===O.INTERNAL_GROUP||t.includes(r.name)){this._instanciateFilterItem(r)}}}this._adaptButtonsEnablement()};O.prototype.isVisibleInFilterBarByName=function(t){var e,i=this._getFilterMetadata(t);if(i&&i.factory){if(i.hasOwnProperty("visibleInAdvancedArea")&&i.visibleInAdvancedArea||i.groupName===O.INTERNAL_GROUP){return true}}else{e=this.determineFilterItemByName(t);if(e){return e.getVisibleInFilterBar()}}return false};O.prototype._getFilterMetadata=function(t){if(this._aFields){for(var e=0;e<this._aFields.length;e++){if(this._aFields[e].fieldName===t){return this._aFields[e]}}}return null};O.prototype.getNonVisibleCustomFilterNames=function(){if(this._aFields.length>0){return this._getLazyNonVisibleCustomFilterNames()}else{return this._getNonVisibleCustomFilterNames()}};O.prototype._getLazyNonVisibleCustomFilterNames=function(){var t=this,e=[];this._aFields.forEach(function(i){if(i.factory){if(i.isCustomFilterField&&!i.visibleInAdvancedArea){e.push(i.fieldName)}}else if(t._isNonVisibleCustomFilterNamesByName(i.fieldName,i.groupName)){e.push(i.fieldName)}});return e};O.prototype._isNonVisibleCustomFilterNamesByName=function(t,e){var i,r;if(this._mAdvancedAreaFilter&&this._mAdvancedAreaFilter[e]&&this._mAdvancedAreaFilter[e].items){for(i=0;i<this._mAdvancedAreaFilter[e].items.length;i++){r=this._mAdvancedAreaFilter[e].items[i];if(r.filterName&&r.filterItem.getName()===t){return this._isNonVisibleCustomFilterNamesByFilter(r.filterItem)}}}return false};O.prototype._isNonVisibleCustomFilterNamesByFilter=function(t){if(t.data("isCustomField")&&!t.getVisibleInFilterBar()){return true}return false};O.prototype._getNonVisibleCustomFilterNames=function(){var t=this,e=[],i=this.getAllFilterItems();if(i){i.forEach(function(i){if(t._isNonVisibleCustomFilterNamesByFilter(i)){e.push(i.getName())}})}return e};O.prototype._ensureFilterLoaded=function(t){var e,i,r;if(this._aFields&&this._aFields.length>0){for(i=0;i<this._aFields.length;i++){r=this._aFields[i];if(!r.factory){continue}if(t){for(e=0;e<t.length;e++){if(r.fieldName===t[e].name){if(r.groupName===t[e].group){this._instanciateFilterItem(r);break}else if(r.groupEntityType===t[e].group){this._instanciateFilterItem(r)}}}}else{this._instanciateFilterItem(r)}}if(!t){this._aFields=[]}}};O.prototype._instanciateFilterItem=function(t){var e=t.factory;if(e){delete t.factory;e.call(t)}};O.prototype._destroyItems=function(t){if(t&&t.length){for(var e=0;e<t.length;e++){t[e].destroy()}}};O.prototype._reapplyVisibility=function(t,e){var i,r=null;var a;var n=[];if(this._mAdvancedAreaFilter){for(r in this._mAdvancedAreaFilter){if(r){var s=this._mAdvancedAreaFilter[r];if(s&&s.items){for(i=0;i<s.items.length;i++){a=s.items[i];if(a&&a.filterItem){this._setPersVisibility(t,a.filterItem,n,e)}}}}}}return n};O.prototype._setPersVisibility=function(t,e,i,r){var a,n;if(e&&!e.getHiddenFilter()){a=e.getGroupName();n=this._checkForFilterInfo(t,e);if(this._isTINAFScenario()){if(n){e.setVisibleInFilterBar(n.visibleInFilterBar);if(n.hasOwnProperty("visible")){e.setVisible(n.visible)}}else{e.setVisibleInFilterBar(false);if(a===O.INTERNAL_GROUP||e._isParameter()){}}}else{if(n&&n.visibleInFilterBar!==undefined){e.setVisibleInFilterBar(n.visibleInFilterBar)}else{if(a!==O.INTERNAL_GROUP&&n&&n.group===a){e.setVisibleInFilterBar(n!==null)}}}if(e){var s=this.determineControlByFilterItem(e,true);if(!r&&s&&s.getValueState&&s.getValueState()!==D.None){s.setValueState(D.None)}if(n&&n.hasOwnProperty("partOfCurrentVariant")&&!n.partOfCurrentVariant){i.push(e)}}}};O.prototype._checkForFilterInfo=function(t,e){var i,r,a=e.getName(),n=[e.getGroupName(),e.getEntitySetName(),e.getEntityTypeName()];var s=[];if(t&&t.length){for(i=0;i<t.length;i++){if(t[i].name===a){if(n.indexOf(t[i].group)>-1){s.push(t[i])}}}}if(s.length===1){return s[0]}else if(s.length>1){for(r=0;r<n.length;r++){for(i=0;i<s.length;i++){if(s[i].group===n[r]){return s[i]}}}}return null};O.prototype._createVariantManagement=function(){var t=new f(this.getId()+"-variantUi2",{});var e=new u({type:"filterBar",keyName:"persistencyKey"});e.setControl(this);t.addPersonalizableControl(e);t.addStyleClass("sapUiCompFilterBarMarginLeft");return t};O.prototype.fireAssignedFiltersChanged=function(){this.fireEvent("assignedFiltersChanged")};O.prototype.retrieveFiltersWithValuesAsText=function(){var t,e,i=this.retrieveFiltersWithValues(),r,a=this.getBasicSearchValue();if(a&&i){i.splice(0,0,this._oRb.getText("FILTER_BAR_ASSIGNED_FILTERS_SEARCH_TERM"))}if(!i||i.length===0){t=this._oRb.getText("FILTER_BAR_ASSIGNED_FILTERS_ZERO")}else if(i&&i.length===1){if(!this._isPhone()){t=this._oRb.getText("FILTER_BAR_ASSIGNED_ONE_FILTER",[i.length,i[0]])}else{t=this._oRb.getText("FILTER_BAR_ASSIGNED_ONE_FILTER_MOBILE",[i.length])}}else{if(!this._isPhone()){r=Math.min(5,i.length);e="";for(var n=0;n<r;n++){e+=i[n];if(n<r-1){e+=", "}}t=this._oRb.getText("FILTER_BAR_ASSIGNED_FILTERS",[i.length,e]);if(r<i.length){t+=", ..."}}else{t=this._oRb.getText("FILTER_BAR_ASSIGNED_FILTERS_MOBILE",[i.length])}}return t};O.prototype.retrieveFiltersWithValuesAsTextExpanded=function(){var t,e="",i=this.retrieveFiltersWithValues(),r=this.getBasicSearchValue(),a=this.retrieveNonVisibleFiltersWithValues();if(a.length>0){e=" "+this._oRb.getText("FILTER_BAR_ASSIGNED_HIDDEN_FILTERS",[a.length])}if(r&&i){i.splice(0,0,this._oRb.getText("FILTER_BAR_ASSIGNED_FILTERS_SEARCH_TERM"))}if(i.length===0){t=this._oRb.getText("FILTER_BAR_ASSIGNED_FILTERS_ZERO")}else if(i.length===1){if(!this._isPhone()){t=this._oRb.getText("FILTER_BAR_ASSIGNED_ONE_FILTER_EXPANDED",[i.length]);t+=e}else{t=this._oRb.getText("FILTER_BAR_ASSIGNED_ONE_FILTER_MOBILE",[i.length]);t+=e}}else{if(!this._isPhone()){t=this._oRb.getText("FILTER_BAR_ASSIGNED_FILTERS_EXPANDED",[i.length]);t+=e}else{t=this._oRb.getText("FILTER_BAR_ASSIGNED_FILTERS_MOBILE",[i.length]);t+=e}}return t};O.prototype.retrieveFiltersWithValues=function(){var t,e=[];var i=this._getFiltersWithValues();if(i){for(t=0;t<i.length;t++){if(i[t].getHiddenFilter()){continue}if(i[t].getVisible()&&i[t].getPartOfCurrentVariant()){e.push(i[t].getLabel())}}}return e};O.prototype.retrieveNonVisibleFiltersWithValues=function(){var t,e=[],i,r=this._getFiltersWithValues();if(r){for(t=0;t<r.length;t++){i=r[t];if(i.getHiddenFilter()){continue}if(i.getVisible()&&!i.getVisibleInFilterBar()&&i.getPartOfCurrentVariant()){e.push(i.getLabel())}}}return e};O.prototype._getFiltersWithValues=function(){if(this._fRegisterGetFiltersWithValues){try{return this._fRegisterGetFiltersWithValues()}catch(t){b.error("callback for obtaining the filter count throws an exception")}}return null};O.prototype._getFiltersWithValuesCount=function(){var t=0;var e=this.retrieveFiltersWithValues();t=e.length;if(this._oBasicSearchField&&this._oBasicSearchField.getValue&&this._oBasicSearchField.getValue()){t++}return t};O.prototype._checkFilterForValue=function(t,e){var i;if(t){for(i=0;i<t.length;i++){if(t[i]===e){return true}}}return false};O.prototype._handleVisibilityOfToolbar=function(){if(this.getAdvancedMode()&&this._oToolbar){var t=false;var e=this._oToolbar.getContent();for(var i=0;i<e.length;i++){if(e[i]instanceof s){continue}if(e[i].getVisible&&e[i].getVisible()){t=true;break}}this._oToolbar.setVisible(t)}};O.prototype._hasMandatoryFields=function(){return this.getFilterGroupItems().some(function(t){return t.getMandatory()})};O.prototype._toggleHideShow=function(){var t;this.setFilterBarExpanded(!this.getFilterBarExpanded());if(this.isPropertyInitial("showAllFilters")){t=this._hasMandatoryFields()?true:false;this.setShowAllFilters(t)}if(!this.getAdvancedMode()){this._rerenderFilters()}};O.prototype._updateToolbarText=function(){if(this.bPreventUpdateToolbarText){return}var t=this._isNewFilterBarDesign()?"FILTER_BAR_ADAPT_FILTERS":"FILTER_BAR_ACTIVE_FILTERS";var e=this._isNewFilterBarDesign()?"FILTER_BAR_ADAPT_FILTERS_ZERO":"FILTER_BAR_ACTIVE_FILTERS_ZERO";var i=this._getFiltersWithValuesCount();var r=i?this._oRb.getText(t,[i]):this._oRb.getText(e);this._oFiltersButton.setText(r);this.fireAssignedFiltersChanged()};O.prototype.setFilterBarExpanded=function(t){var e;if(this.getAdvancedMode()){this.setProperty("filterBarExpanded",t);if(this._oHideShowButton){if(t){this._oHideShowButton.setText(this._oRb.getText("FILTER_BAR_VH_HIDE_FILTERS"))}else{this._oHideShowButton.setText(this._oRb.getText("FILTER_BAR_VH_SHOW_FILTERS"))}}this._calcVisibilityGoButton();if(this.getIsRunningInValueHelpDialog()){this._oBasicAreaLayout.setVisible(t)}else{this._oAdvancedPanel.setVisible(t)}}else{if(this._isPhone()&&this.getUseToolbar()){e=false}else{e=t}this.setProperty("filterBarExpanded",e);if(this._isNewFilterBarDesign()){return this}if(this._isPhone()){if(this._oHideShowButton){this._oHideShowButton.setVisible(false)}this._calcVisibilityGoButton();this._oBasicAreaLayout.setVisible(false)}else{if(this._oHideShowButton){if(e){this._oHideShowButton.setText(this._oRb.getText("FILTER_BAR_HIDE"))}else{this._oHideShowButton.setText(this._oRb.getText("FILTER_BAR_SHOW"))}this._oHideShowButton.setVisible(true)}this._calcVisibilityGoButton();if(this._oHideShowButton){if(this._oHideShowButton.getEnabled()){this._oBasicAreaLayout.setVisible(e)}else{this._oBasicAreaLayout.setVisible(false)}}}}this._updateToolbarText();return this};O.prototype._selectionChangedInFilterDialogByValue=function(t,e){e.setVisibleInFilterBar(t);if(this._getConsiderFilterChanges()&&this._oVariantManagement&&!this._oVariantManagement.getInErrorState()){this._oVariantManagement.currentVariantSetModified(true)}this._bDirtyViaDialog=true};O.prototype._onLiveChangeValidateSymbols=function(t){var e=new RegExp("[\\w][*][\\w]"),i=new RegExp("[+]"),r=t.getSource(),a=r.getValue(),n=e.test(a)||i.test(a);this._onSymbolsValidationSetValueState.call(this,n,r)};O.prototype._onSymbolsValidationSetValueState=function(t,e){var i=e._oValueStateMessage,r="sapMSFContentWrapperWarning";if(t&&!e.hasStyleClass(r)&&e.setValueState===undefined){e.addStyleClass(r);e.getValueState=function(){return D.Warning};i.open()}else if(!t&&e.hasStyleClass(r)&&e.setValueState===undefined){e.getValueState=function(){return D.None};i.close();e.removeStyleClass(r)}else if(t&&e.getValueState&&e.getValueState()===D.None){e.setValueState(D.Warning);e.setValueStateText(E)}else if(!t&&e.getValueState()===D.Warning){e.setValueState(D.None)}};O.prototype._mandatoryFilterChange=function(t){if(!t){return}var e=t.getParameters();if(!e||!e.oSource){return}var i=this._determineByControl(e.oSource);if(i){this._mandatoryFilterItemChange(i.filterItem)}};O.prototype._mandatoryFilterItemChange=function(t){if(t){if(!t.getMandatory()){return}var e=this._hasFilterValue(t);if(!t.getVisibleInFilterBar()&&!e){t.setVisibleInFilterBar(true)}}};O.prototype._isPhone=function(){return!!o.system.phone};O.prototype._isTablet=function(){return!!(o.system.tablet&&!o.system.desktop)};O.prototype.fireSearch=function(t){if(this._bOKFiltersDialogTriggered&&this._oAdaptFiltersDialog){this._oAdaptFiltersDialog.close()}else if(this._oAdaptFiltersDialog){this._bEnterPressedLeadsToSearch=true}this.fireEvent("search",t)};O.prototype._variantSave=function(t){this._oVariant={};this.fireBeforeVariantSave()};O.prototype._afterVariantSave=function(t){this._aOrderedFilterItems=this._aAdaptFilterItems;this._aAdaptFilterItems=[];this.fireAfterVariantSave()};O.prototype._filterSetInErrorState=function(t){if(this._oAdaptFiltersDialog&&this._oAdaptFiltersDialog.isOpen()){if(this._getConsiderFilterChanges()&&this._oVariantManagement&&!this._oVariantManagement.getInErrorState()){this._oVariantManagement.currentVariantSetModified(true)}this._bDirtyViaDialog=true}};O.prototype._cancelFilterDialog=function(t){if(t&&this._oVariantManagement){this._bDirtyViaDialog=this._oVariantManagement._bSaveCanceled}if(!this.getPersistencyKey()&&this.getUseSnapshot()===false){this.fireCancel();return}if(this._oInitialVariant&&this._oInitialVariant.content&&this._bDirtyViaDialog){var e=this._retrieveCurrentSelectionSet(false);this._deleteValidatingTokenFlag(e);this.applyVariant(this._oInitialVariant.content,"CANCEL");if(this._oVariantManagement){if(!this._oVariantManagement.isPageVariant()){this._oVariantManagement.setCurrentVariantKey(this._oInitialVariant.key)}this._oVariantManagement.currentVariantSetModified(this._oInitialVariant.modified)}this.fireCancel()}};O.prototype._resetFiltersInErrorValueState=function(){var t;t=this._retrieveCurrentSelectionSet(true,true);t.forEach(function(t){if(t.control&&t.control.setValueState&&t.control.getValueState){if(t.control.getValueState()===D.Error){if(t.control.setValue){t.control.setValue("")}t.control.setValueState(D.None)}}})};O.prototype.setContentWidth=function(t){if(this._oAdaptFiltersDialog){this._oAdaptFiltersDialog.setContentWidth(t+"px")}};O.prototype.setContentHeight=function(t){if(this._oAdaptFiltersDialog){this._oAdaptFiltersDialog.setContentHeight(t+"px")}};O.prototype.addAdaptFilterDialogCustomContent=function(t){this._mCustomViewInfo={item:t.item,search:t.search,selectionChange:t.selectionChange,filterSelect:t.filterSelect,content:t.content}};O.prototype._createStructureForAdaptFiltersDialog=function(){var t,e,i={filtersOnFilterBar:{},allFilters:[]};var r,a=this.getAllFiltersWithValues?this.getAllFiltersWithValues():this._getFiltersWithValues();if(this._mAdvancedAreaFilter){for(var n in this._mAdvancedAreaFilter){if(n){t=this._mAdvancedAreaFilter[n];if(t.items){for(var s=0;s<t.items.length;s++){e=t.items[s];r=this._checkFilterForValue(a,e.filterItem);if(e.filterItem.getVisibleInFilterBar()){i.filtersOnFilterBar[e.filterItem.getName()]=e.filterItem}var o=e.filterItem.getGroupName()?e.filterItem.getGroupName():O.INTERNAL_GROUP;var l=o===O.INTERNAL_GROUP?this._oRb.getText("FILTER_BAR_BASIC_GROUP"):e.filterItem.getGroupTitle();var h=e.filterItem.getControlTooltip()?e.filterItem.getControlTooltip():"";i.allFilters.push({name:e.filterItem.getName(),label:e.filterItem.getLabel(),group:o,groupLabel:l,tooltip:h,visibleInDialog:e.filterItem.getVisible(),filterItem:e.filterItem,active:r,required:e.filterItem.getMandatory()})}}}}if(i.allFilters.length>0){var d=[],u=this._aAdaptFilterItems.length>0?this._aAdaptFilterItems:this._aOrderedFilterItems;if(u.length>0){u.forEach(function(t,e){d[t.name]=e});i.allFilters.sort(function(t,e){return d[t.name]-d[e.name]})}}}return i};O.prototype._getAllFilterItemsFlat=function(){var t,e,i,r=[];if(this._mAdvancedAreaFilter){for(var a in this._mAdvancedAreaFilter){if(a){t=this._mAdvancedAreaFilter[a];if(t.items){for(var n=0;n<t.items.length;n++){e=t.items[n];i=e.filterItem;var s=i.getGroupName()?i.getGroupName():O.INTERNAL_GROUP;var o=s===O.INTERNAL_GROUP?this._oRb.getText("FILTER_BAR_BASIC_GROUP"):i.getGroupTitle();var l=i.getControlTooltip()?i.getControlTooltip():"";r.push({name:i.getName(),label:i.getLabel(),group:s,groupLabel:o,tooltip:l,visibleInDialog:i.getVisible(),filterItem:i,required:i.getMandatory()})}}}}}return r};O.prototype._restoreControls=function(t,e){var i,r,a;if(this._fRegisteredFilterChangeHandlers){this.detachFilterChange(this._fRegisteredFilterChangeHandlers);this._fRegisteredFilterChangeHandlers=null}if(this._mAdvancedAreaFilter){for(var n in this._mAdvancedAreaFilter){if(n){i=this._mAdvancedAreaFilter[n];if(i.items){for(var s=0;s<i.items.length;s++){r=i.items[s];if(r.filterItem&&!r.filterItem.getHiddenFilter()&&r.control&&r.container){if(r.contentReplaced){r.contentReplaced=undefined;a=r.container.getContent();var o=a[1];r.container.removeContent(o);if(o&&o.getValueState){if(e&&o.getValueState()!=r.control.getValueState()){r.control.setValueState(o.getValueState())}}o.destroy();r.container.getContent()[0].setLabelFor&&r.container.getContent()[0].setLabelFor(r.control);r.container.insertContent(r.control,1);if(this._isPhone()||this._isTablet()){r.control.sName=r.filterItem.getName();r.control._onAfterInputRenderingDelegate={onAfterRendering:function(t){this._applyInputModeAttribute(t.srcControl,t.srcControl.sName)},sName:r.filterItem.getName()};r.control.addDelegate(r.control._onAfterInputRenderingDelegate,this)}}r.filterItem.detachChange(t)}}}}}}this._rerenderFilters()};O.prototype._expandGroup=function(t){if(this._oAdaptFiltersDialog&&this._oAdaptFiltersDialogModel&&this._oAdaptFiltersPanel&&t&&t.filterItem){var e=t.filterItem.getGroupName()?t.filterItem.getGroupName():O.INTERNAL_GROUP;var i=this._oAdaptFiltersDialogModel.getData().itemsGrouped;for(var r=0;r<i.length;r++){if(i[r].group===e){for(var a=0;a<i[r].items.length;a++){if(i[r].items[a].name===t.filterItem.getName()){this._oAdaptFiltersPanel.setGroupExpanded(i[r].items[a].group,true);return}}return}}}};var H,U;O.prototype._getEntitiesLazy=function(){if(H&&U){return Promise.resolve()}this.setBusy(true);return sap.ui.getCore().loadLibrary("sap.ui.mdc",{async:true}).then(function(){return new Promise(function(t){sap.ui.require(["sap/ui/mdc/p13n/P13nBuilder","sap/ui/mdc/p13n/panels/AdaptFiltersPanel"],function(e,i){H=e;U=i;t();this.setBusy(false)}.bind(this))}.bind(this))}.bind(this))};O.prototype._filtersButtonPressed=function(){this._oFiltersButton.focus();this.showAdaptFilterDialog()};O.prototype._checkAssignedFilters=function(){if(this._oAdaptFiltersDialog){var t=this.getAllFiltersWithValues?this.getAllFiltersWithValues():this._getFiltersWithValues();var e=this._oAdaptFiltersDialogModel.getData().items;for(var i=0;i<e.length;i++){if(e[i].hasOwnProperty("filterItem")){var r=this._checkFilterForValue(t,e[i].filterItem);if(e[i].active!==r){e[i].active=r}}}}};O.prototype.showAdaptFilterDialogForKeyUser=function(t,e){this._fGetDataForKeyUser=e;return this.showAdaptFilterDialog().then(function(){this._oAdaptFiltersDialog._oPopup&&this._oAdaptFiltersDialog._oPopup.addStyleClass(t);H.addRTACustomFieldButton(this._oAdaptFiltersDialog._oPopup)}.bind(this))};O.prototype._createKeyUserChange=function(){var t=[];if(this._bOKFiltersDialogTriggered&&this._oVariantManagement&&this._oVariantManagement.isA("sap.ui.comp.smartvariants.SmartVariantManagement")&&this._oVariantManagement.getVisible()&&this._oVariantManagement._getPersoController()){t=[{selectorControl:this._oVariantManagement._getPersoController(),changeSpecificData:{changeType:"variantContent",content:{key:this._oVariantManagement.getSelectionKey(),persistencyKey:this.getPersistencyKey(),content:this.fetchVariant()}}}]}return t};O.prototype.showAdaptFilterDialog=function(t){return new Promise(function(e){this._getEntitiesLazy().then(function(){var i;if(!this._oAdaptFiltersDialog){i=new v;i.setSizeLimit(0);var r=function(t,e){for(var i=0;i<t.length;i++){if(t[i].group===e){var r=t[i].items;for(var a=0;a<r.length;a++){if(r[a].filterItem&&r[a].filterItem.getVisible()){if(!t[i].groupVisible){t[i].groupVisible=true}return}}if(t[i].groupVisible){t[i].groupVisible=false}return}}};var a=function(t){if(t&&t.oSource&&t.oSource.isA("sap.ui.comp.filterbar.FilterItem")){var e=t.getParameter("propertyName");if(this._oAdaptFiltersDialogModel&&e){var i=this._oAdaptFiltersDialogModel.getData().items;for(var a=0;a<i.length;a++){if(i[a].hasOwnProperty("filterItem")&&i[a].filterItem===t.oSource){if(e==="visible"){var n=t.oSource.getVisible();if(i[a].visibleInDialog!=n){i[a].visibleInDialog=n;r(this._oAdaptFiltersDialogModel.getData().itemsGrouped,i[a].group);this._oAdaptFiltersDialogModel.checkUpdate();break}}else if(e==="visibleInFilterBar"){i[a].visible=t.oSource.getVisibleInFilterBar();this._oAdaptFiltersDialogModel.checkUpdate();break}}}}}}.bind(this);this._ensureFilterLoaded(null);var n=this._createStructureForAdaptFiltersDialog();var s=this;var o=H.prepareAdaptationData(n.allFilters,function(t,e){V(t,e);var i=true;if(!e.filterItem||e.filterItem.getHiddenFilter()){s._mAdvancedAreaHiddenFilters.push(t);i=false}t.visible=!!n.filtersOnFilterBar[e.name];return i},true);H.sortP13nData({visible:"visible",position:"position"},o.items);this._oAdaptFiltersDialogModel=new v;this._oAdaptFiltersDialogModel.setSizeLimit(1e3);this._oAdaptFiltersDialogModel.setData(o);this._mAdaptFiltersDialogInitialItemsOrder=[].concat(this._oAdaptFiltersDialogModel.getData().items,this._mAdvancedAreaHiddenFilters);var l=this._oAdaptFiltersDialogModel.getData().items;for(var h=0;h<l.length;h++){if(l[h].hasOwnProperty("filterItem")){l[h].filterItem.attachChange(a)}}this._fRegisteredFilterChangeHandlers=function(t){this._mandatoryFilterChange(t)}.bind(this);this.attachFilterChange(this._fRegisteredFilterChangeHandlers);var d=function(t,e){if(t&&t.filterItem&&t.filterItem.getVisibleInFilterBar()!==e){this._selectionChangedInFilterDialogByValue(e,t.filterItem)}}.bind(this);var u=function(t){var e,i,r,a,n=t.getParameter("item"),s=t.getParameter("reason"),o=s==="Add"||s==="SelectAll"||s==="RangeSelect";if(s==="SelectAll"||s==="DeselectAll"){if(this._oAdaptFiltersPanel.getCurrentViewKey()===this._oAdaptFiltersPanel.GROUP_KEY){i=t.getParameter("item").group;r=this._oAdaptFiltersDialogModel.getProperty("/itemsGrouped").filter(function(t){return t.group===i})[0].items}else{r=this._oAdaptFiltersDialogModel.getProperty("/items")}for(e=0;e<r.length;e++){n=r[e];if(!o&&this._shouldBeVisible(n)){a="/items/"+e;this._oAdaptFiltersDialogModel.setProperty(a+"/visible",true)}else{d(n,o)}}}else if(s==="RangeSelect"&&n){if(this._oAdaptFiltersPanel.getCurrentViewKey()===this._oAdaptFiltersPanel.LIST_KEY){for(e=0;e<n.length;e++){var l=n[e];if(!o&&this._shouldBeVisible(l)){a="/items/"+e;this._oAdaptFiltersDialogModel.setProperty(a+"/visible",true)}else{d(l,o)}}}}else if((s==="Add"||s==="Remove")&&n){if(!o&&this._shouldBeVisible(n)){n.visible=true}else{d(n,o)}}else if(s==="Move"){this._bDirtyViaDialog=true;this._bMoveTriggered=true}}.bind(this);var f=new U({enableReorder:true});f.getView(f.GROUP_KEY).getContent().attachChange(u);f.getView(f.LIST_KEY).getContent().attachChange(u);this._oAdaptFiltersPanel=f;f.setItemFactory(function(t){var e,r,a,n;n=t.getObject();if(!n){return undefined}a=this._determineItemByName(n.name,n.group);if(!a||!a.filterItem||!a.control){return undefined}e=a.control;if(!a.contentReplaced&&a.container&&a.container.getContent()[1]===e){a.contentReplaced=true;a.container.removeContent(e);r=e.clone();a.container.getContent()[0].setLabelFor&&a.container.getContent()[0].setLabelFor("");r.setModel(i);a.container.insertContent(r,1)}return e}.bind(this));this.fireFiltersDialogBeforeOpen({newDialog:true});if(this._mCustomViewInfo&&this._mCustomViewInfo.item&&this._mCustomViewInfo.item.getKey()){f.addCustomView(this._mCustomViewInfo);f.switchView(t?t:f.getDefaultView())}sap.ui.require(["sap/m/p13n/Popup"],function(t){var i=new t(this.getId()+"-adapt-filters",{panels:[f],title:this._oRb.getText(this._isNewFilterBarDesign()?"FILTER_BAR_ADAPT_FILTERS_DIALOG":"FILTER_BAR_ADV_FILTERS_DIALOG"),reset:this.getShowRestoreButton()&&!this._fGetDataForKeyUser?this._dialogRestore.bind(this):null,warningText:sap.ui.getCore().getLibraryResourceBundle("sap.m").getText("p13n.RESET_WARNING_TEXT"),close:function(t){if(t.getParameter("reason")==="Ok"){this._bOKFiltersDialogTriggered=true}else{this._dialogCancel(this._oAdaptFiltersDialog)}if(this._bOKFiltersDialogTriggered&&typeof this._clearErroneusControlValues==="function"){this._clearErroneusControlValues()}this._restoreControls(a,!this._bOKFiltersDialogTriggered);if(!this._bOKFiltersDialogTriggered){this._cancelFilterDialog(false)}if(this._fGetDataForKeyUser){this._fGetDataForKeyUser(this._createKeyUserChange())}if(this._bOKFiltersDialogTriggered){this._aAdaptFilterItems=this._oAdaptFiltersDialogModel.getProperty("/items");this._aAdaptFilterItems=[].concat(this._aAdaptFilterItems,this._mAdvancedAreaHiddenFilters);this._mAdvancedAreaFilter=this._mapReorderedFilterItemsInGroups(this._aAdaptFilterItems);this._reorderItemsInBasicAreaLayout(this._aAdaptFilterItems);this._bMoveTriggered=false;this._mAdvancedAreaHiddenFilters=[]}else{this._aAdaptFilterItems=[]}(function(){this._oBasicAreaLayout.rerender()}).bind(this)();this._applyAttributes();this._oAdaptFiltersDialogModel=null;this._oAdaptFiltersPanel=null;this._oVariant={};this._oInitialVariant=null;this._oAdaptFiltersDialog.destroy();this._oAdaptFiltersDialog=null;this._fGetDataForKeyUser=null;if((this._bOKFiltersDialogTriggered&&this._bDirtyViaDialog||this._bResetFiltersDialogTriggered)&&!this._bEnterPressedLeadsToSearch){if(!this.isLiveMode||!this.isLiveMode()){this.fireFilterChange()}}this._bEnterPressedLeadsToSearch=false;this._bResetFiltersDialogTriggered=false;this.fireFiltersDialogClosed({context:this._bOKFiltersDialogTriggered?"SEARCH":"CANCEL"});if(this._bNoFiltersInAdvancedArea&&this._oHintText&&!this._oHintText.getVisible()){this._bNoFiltersInAdvancedArea=false;this.setFilterBarExpanded(true)}}.bind(this)});i._getIdPrefix=function(){return"-dialog"};this._oAdaptFiltersDialog=i;this._oAdaptFiltersDialog.setParent(this);this._oVariant.content=this.fetchVariant();if(this._oVariantManagement){this._oVariant.key=this._oVariantManagement.getSelectionKey();this._oVariant.modified=this._oVariantManagement.currentVariantGetModified()}this._oInitialVariant={};V(this._oInitialVariant,this._oVariant);this._bOKFiltersDialogTriggered=false;this._bDirtyViaDialog=false;this._bEnterPressedLeadsToSearch=false;if(this.$().closest(".sapUiSizeCompact").length>0){this._oAdaptFiltersDialog.addStyleClass("sapUiSizeCompact")}this._oAdaptFiltersDialog.isPopupAdaptationAllowed=function(){return false};this._oAdaptFiltersDialog.open();e()}.bind(this));f.setP13nModel(this._oAdaptFiltersDialogModel);return}e()}.bind(this))}.bind(this))};O.prototype._mapReorderedFilterItemsInGroups=function(t){var e=[];t.forEach(function(t){if(!e[t.group]){e[t.group]={};e[t.group].filterItem=null;e[t.group].items=[]}if(!e[t.group].items){e[t.group].items=[]}e[t.group].items.push(this._mAdvancedAreaFilter[t.group].items.find(function(e){return e.filterItem===t.filterItem}));if(!e[t.group].filterItem){e[t.group].filterItem=t.filterItem}}.bind(this));return e};O.prototype._reorderItemsInBasicAreaLayout=function(t){if(!t||!t.length){return}t.forEach(function(t,e){var i=this._determineItemByName(t.name,t.group);if(!i||!i.filterItem||!i.control){return}var r=this._oBasicAreaLayout.removeContent(i.container);this._oBasicAreaLayout.insertContent(r,e+1);return}.bind(this))};O.prototype._reorderItemsInAdvancedAreaFilter=function(){var t,e;t=this._createStructureForAdaptFiltersDialog();e=t.allFilters;this._mAdvancedAreaFilter=this._mapReorderedFilterItemsInGroups(e)};O.prototype.isDialogOpen=function(){return this._oAdaptFiltersDialog?true:false};O.prototype._dialogCancel=function(t){if(t){this._bOKFiltersDialogTriggered=false;this.fireFiltersDialogCancel()}};O.prototype._dialogRestore=function(){this.reset();if(this._oVariantManagement&&this._oVariantManagement.getVisible()&&!this._oVariantManagement.getInErrorState()){this._oVariantManagement.currentVariantSetModified(false)}if(this._oAdaptFiltersPanel){var t=[],e=this._oAdaptFiltersDialogModel.getData();if(this._bMoveTriggered&&this._mAdaptFiltersDialogInitialItemsOrder.length>0){this._mAdaptFiltersDialogInitialItemsOrder.forEach(function(e,i){t[e.name]=i});e.items.sort(function(e,i){return t[e.name]-t[i.name]})}else{this._aOrderedFilterItems.forEach(function(e,i){t[e.name]=i});e.items.sort(function(e,i){return t[e.name]-t[i.name]});H.sortP13nData({visible:"visible",position:"position"},e.items)}this._oAdaptFiltersPanel.setP13nData(e)}this._bDirtyViaDialog=false;this._bResetFiltersDialogTriggered=true};O.prototype._createButtons=function(t){var i=this;this._oSearchButton=new e(this.getId()+"-btnGo",{visible:this.getShowGoOnFB(),text:this._oRb.getText("FILTER_BAR_GO"),type:N.Emphasized}).addStyleClass("sapUiCompFilterBarPaddingRightBtn");this._oSearchButton.addEventDelegate({ontouchstart:function(){this.bPreventUpdateToolbarText=true}.bind(this),ontouchend:function(){this.bPreventUpdateToolbarText=false;this._updateToolbarText()}.bind(this)});B.addConfig(this._oSearchButton,{event:"search"},this);this._oSearchButton.attachPress(function(){i._oSearchButton.focus();i._searchFromFilterBar()});t.addContent(this._oSearchButton);this._oHideShowButton=new e(this.getId()+"-btnShowHide",{text:this._oRb.getText("FILTER_BAR_HIDE"),type:N.Transparent,enabled:false});this._oHideShowButton.attachPress(function(){i._toggleHideShow()});t.addContent(this._oHideShowButton);this._oClearButtonOnFB=new e(this.getId()+"-btnClear",{visible:this.getShowClearOnFB(),text:this._oRb.getText("FILTER_BAR_CLEAR"),type:N.Transparent,enabled:false}).addStyleClass("sapUiCompFilterBarPaddingRightBtn");this._oClearButtonOnFB.attachPress(function(){i.clear();if(i.isLiveMode&&i.isLiveMode()){i._searchFromFilterBar()}});t.addContent(this._oClearButtonOnFB);this._oRestoreButtonOnFB=new e(this.getId()+"-btnRestore",{visible:this.getShowRestoreOnFB(),text:this._oRb.getText("FILTER_BAR_RESTORE"),type:N.Transparent,enabled:false});this._oRestoreButtonOnFB.attachPress(function(){i.reset();if(i._oVariantManagement){i._oVariantManagement.currentVariantSetModified(false)}});t.addContent(this._oRestoreButtonOnFB);this._oFiltersButton=new e(this.getId()+"-btnFilters",{visible:this.getShowFilterConfiguration(),text:this._oRb.getText("FILTER_BAR_ACTIVE_FILTERS_ZERO"),type:N.Transparent,enabled:false});this._oFiltersButton.attachPress(function(){this._filtersButtonPressed()}.bind(this));t.addContent(this._oFiltersButton)};O.prototype._toggleAllFilters=function(){var t,e;this.setShowAllFilters(!this.getShowAllFilters());this._oShowAllFiltersButton.setVisible(!this.getShowAllFilters());this._rerenderFilters();if(!this._bDelegateAdded&&this.getFilterGroupItems()){t=this.getFilterGroupItems()[7].getControl();e={onAfterRendering:function(){t.focus()}};t.addDelegate(e,this);this._bDelegateAdded=true}};O.prototype.initShowAllFiltersButton=function(){this._oShowAllFiltersButton=new e(this.getId()+"-btnShowAll",{text:this._oRb.getText("FILTER_BAR_VH_SHOW_ALL"),type:N.Transparent,press:this._toggleAllFilters.bind(this)});this._oBasicAreaLayout.addEndContent(this._oShowAllFiltersButton)};O.prototype._createVariantLayout=function(){this._oVariantManagement=this._createVariantManagement();if(this._possibleToChangeVariantManagement()){this._oVariantManagement.setVisible(false)}this._registerVariantManagement();return this._oVariantManagement};O.prototype._createToolbar=function(t){var e=new n(this.getId()+"-toolbar");if(!t){var i=this._createVariantLayout();e.addContent(i)}e.addContent(new s);this._createButtons(e);e.addStyleClass("sapUiCompFilterBarToolbar");e.setLayoutData(new g({span:"L12 M12 S12"}));return e};O.prototype._replaceVariantManagement=function(t){if(this._oVariantManagement){this._unregisterVariantManagement();if(this._oToolbar&&this._oToolbar.getContent(this._oVariantManagement)){this._oToolbar.removeContent(this._oVariantManagement)}this._oVariantManagement.destroy()}this._oVariantManagement=t;this._registerVariantManagement();this._adaptNewFilterBarDesign()};O.prototype._createAdvancedAreaForm=function(){if((!M||!x||!P||!w)&&!this._bAdvancedRequested){M=sap.ui.require("sap/ui/layout/form/Form");x=sap.ui.require("sap/ui/layout/form/FormContainer");P=sap.ui.require("sap/ui/layout/form/FormElement");w=sap.ui.require("sap/ui/layout/form/ResponsiveGridLayout");if(!M||!x||!P||!w){sap.ui.require(["sap/ui/layout/form/Form","sap/ui/layout/form/FormContainer","sap/ui/layout/form/FormElement","sap/ui/layout/form/ResponsiveGridLayout"],W.bind(this));this._bAdvancedRequested=true}}if(!M||!x||!P||!w){return}var t=new w(this.getId()+"-AdvancedFormLayout");t.addStyleClass("sapUiCompFilterBarPaddingForm");t.setColumnsL(3);t.setColumnsM(2);var e=new M(this.getId()+"-AdvancedForm",{editable:true});e.setLayout(t);if(!this.oInvisibleFormTitle){this.oInvisibleFormTitle=new _({text:this._oRb.getText("ADVANCED_SEARCH_TEXT")});this.addContent(this.oInvisibleFormTitle)}e.addAriaLabelledBy(this.oInvisibleFormTitle);this._oAdvancedPanel.addContent(e);return e};function W(t,e,i,r){M=t;x=e;P=i;w=r;this._bAdvancedRequested=false;if(!this._bIsBeingDestroyed){if(!this.getIsRunningInValueHelpDialog()){this._oAdvancedAreaForm=this._createAdvancedAreaForm();this._rerenderAA()}}}O.prototype._addControlToBasicAreaFormContainer=function(t){var e=t._getControl();if(!e){b.error("no Control obtained");return null}var i=t.getLabelControl(this.getId());if(!i){b.error("no Label obtained");return null}this._adaptGroupTitleForFilter(t);return this._addControlToBasicAreaContainer(t,e,i)};O.prototype._addControlToBasicAreaContainer=function(t,e,i){var r=new F;if(e.setWidth){e.setWidth("100%")}r.setWidth("100%");if(i){if(!i.hasStyleClass("sapUiCompFilterLabel")){i.addStyleClass("sapUiCompFilterLabel")}r.addContent(i);if(i.setLabelFor){if(t&&e){i.setLabelFor(e);if(e.setTooltip&&t.getControlTooltip()){e.setTooltip(t.getControlTooltip())}}}}r.addContent(e);if((!this.getAdvancedMode()||this.getIsRunningInValueHelpDialog())&&!this._oAdaptFiltersDialog){if(t&&t.getVisible()&&t.getVisibleInFilterBar()){var a=this._oBasicAreaLayout.getContent();if(this._isNewFilterBarDesign()&&!this._isPhone()){this._oBasicAreaLayout.insertContent(r,a.length)}else{this._oBasicAreaLayout.addContent(r)}}}return r};O.prototype._rerenderAA=function(){if(this._oAdvancedAreaForm){this._oAdvancedAreaForm.removeAllFormContainers();var t=this._flattenMap();this._layOutAA(t)}};O.prototype._groupsWithVisibleFilters=function(){var t,e,i=this._mAdvancedAreaFilter;if(this._mAdvancedAreaFilter&&Object.keys(this._mAdvancedAreaFilter).length>1){i={};for(var r in this._mAdvancedAreaFilter){if(r&&this._mAdvancedAreaFilter[r]&&this._mAdvancedAreaFilter[r].items){t=this._mAdvancedAreaFilter[r].items.length;for(var a=0;a<this._mAdvancedAreaFilter[r].items.length;a++){e=this._mAdvancedAreaFilter[r].items[a].filterItem;if(e&&(e.getHiddenFilter()||!e.getVisible())){t--}}if(t){i[r]={}}}}}return i};O.prototype._layOutAA=function(t){var e=this._groupsWithVisibleFilters();if(e&&Object.keys(e).length>1){this._layOutAAMultipleGroup(t)}else{this._layOutAASingleGroup(t)}};O.prototype._layOutAAMultipleGroup=function(t){var e,i,r=0,a=null,n=false;for(e=0;e<t.length;e++){if(t[e].control===null){r++}}if(this._mAdvancedAreaFilter&&Object.keys(this._mAdvancedAreaFilter).length===2&&this._mAdvancedAreaFilter[O.INTERNAL_GROUP]&&this._mAdvancedAreaFilter[O.INTERNAL_GROUP].items&&this._mAdvancedAreaFilter[O.INTERNAL_GROUP].items.length>0){n=true}var s=this._oAdvancedAreaForm.getLayout();if(s){if(r>=3){s.setLabelSpanL(5);s.setLabelSpanM(5);s.setColumnsL(3);s.setColumnsM(2)}else if(r===2){s.setLabelSpanL(4);s.setLabelSpanM(5);s.setColumnsL(2);s.setColumnsM(2)}else if(r===1){s.setLabelSpanL(4);s.setLabelSpanM(5);s.setColumnsL(2);s.setColumnsM(2)}}for(e=0;e<t.length;e++){if(t[e].control===null){a=new x;if(Object.keys(this._mAdvancedAreaFilter).length>1&&!n){if(r>=3&&t[e].filterItem.getGroupName()===O.INTERNAL_GROUP){a.setTitle(this._oRb.getText("FILTER_BAR_BASIC_GROUP"))}else{a.setTitle(t[e].filterItem.getGroupTitle())}}this._oAdvancedAreaForm.addFormContainer(a);i=e+1;while(i<t.length&&t[i].control){this._addControlToAdvancedArea(t[i].filterItem,t[i].control,a);i++}e=i-1}}if(r===1){this._oAdvancedAreaForm.addFormContainer(new x)}};O.prototype._layOutAASingleGroup=function(t){var e,i,r,a;var n=t.length-1;var s=n>2?2:1;if(s>1){r=Math.floor(n/s);a=r*s<n;for(e=1;e<s;e++){i=e*r;if(a){++i}if(i+e<t.length){t.splice(i+e,0,t[0])}}}this._layOutAAMultipleGroup(t)};O.prototype._flattenMap=function(){var t=null,e,i=[],r;if(this._mAdvancedAreaFilter){for(t in this._mAdvancedAreaFilter){if(t&&this._mAdvancedAreaFilter[t].items){r=false;for(e=0;e<this._mAdvancedAreaFilter[t].items.length;e++){var a=this._mAdvancedAreaFilter[t].items[e];if(a.filterItem&&a.filterItem.getVisibleInFilterBar()&&a.filterItem.getVisible()&&!a.filterItem.getHiddenFilter()){if(!r){r=true;i.push({control:null,filterItem:this._mAdvancedAreaFilter[t].filterItem})}i.push({control:a.control,filterItem:a.filterItem})}}}}}return i};O.prototype._rerenderItem=function(t,e){var i;if(t){i=t.filterItem.getVisible()&&t.filterItem.getVisibleInFilterBar()&&!t.filterItem.getHiddenFilter();if(e!==undefined){i=i&&!e}if(t.container){t.container.setVisible(i);if(i){this._addContainer(t)}else{this._removeContainer(t)}}}};O.prototype._rerenderFilters=function(){var t;var e=null;var i=null;var r=[];if(this._mAdvancedAreaFilter){for(e in this._mAdvancedAreaFilter){if(e&&this._mAdvancedAreaFilter[e]&&this._mAdvancedAreaFilter[e].items){for(t=0;t<this._mAdvancedAreaFilter[e].items.length;t++){i=this._mAdvancedAreaFilter[e].items[t];var a=i.filterItem.getVisible()&&i.filterItem.getVisibleInFilterBar()&&!i.filterItem.getHiddenFilter();if(a){r.push({visible:a,item:i})}else{this._removeContainer(i)}}}}}var n=this.getIsRunningInValueHelpDialog()&&!this.getShowAllFilters();var s=r.length;var o=r.length>this._nMaxFiltersByDefault?this._nMaxFiltersByDefault-1:this._nMaxFiltersByDefault;for(var l=0;l<r.length;l++){var h=n&&l>=o;this._rerenderItem(r[l].item,h)}if(this._oShowAllFiltersButton){if(n&&s>this._nMaxFiltersByDefault){this._oShowAllFiltersButton.setVisible(true)}else{this._oShowAllFiltersButton.setVisible(false)}}this._updateToolbarText()};O.prototype.rerenderFilters=function(){this._rerenderFilters()};O.prototype._setTriggerFilterChangeState=function(t){this._triggerFilterChangeState=t};O.prototype._getTriggerFilterChangeState=function(){return this._triggerFilterChangeState};O.prototype._setConsiderFilterChanges=function(t){this._filterChangeSemaphore=t};O.prototype._getConsiderFilterChanges=function(){return this._filterChangeSemaphore};O.prototype.fireFilterChange=function(t){this._updateToolbarText();if(!this._getTriggerFilterChangeState()){return}if(this._getConsiderFilterChanges()&&this._oVariantManagement&&!this._oVariantManagement.getInErrorState()){this._oVariantManagement.currentVariantSetModified(true)}if(this._oAdaptFiltersDialog&&!this._oAdaptFiltersDialog.isOpen()){return}if(this._oAdaptFiltersDialog){this._bDirtyViaDialog=true;this._checkAssignedFilters()}this.fireEvent("filterChange",t)};O.prototype._notifyAboutChangedFilters=function(t,e){var i,r=this._determineByControl(e);if(t){i={added:e,filterItem:r}}else{i={deleted:e,filterItem:r}}this.fireFilterChange(i)};O.prototype._determineVariantFiltersInfo=function(t,e){var i;var r=null,a,n;var s=[];if(this._mAdvancedAreaFilter){for(r in this._mAdvancedAreaFilter){if(r){if(this._mAdvancedAreaFilter[r].items){for(i=0;i<this._mAdvancedAreaFilter[r].items.length;i++){a=this._mAdvancedAreaFilter[r].items[i];if(t||a.filterItem.getVisible()){n={group:a.filterItem.getGroupName(),name:a.filterItem.getName(),partOfCurrentVariant:a.filterItem.getPartOfCurrentVariant(),visibleInFilterBar:a.filterItem.getVisibleInFilterBar(),visible:a.filterItem.getVisible()};if(e||this._considerFilter(n)){s.push(n)}}}}}}}return s};O.prototype.mergeVariant=function(t,e){var i={};V(i,e);i.filterbar=[];i.filterBarVariant={};V(i.filterbar,t.filterbar);V(i.filterBarVariant,t.filterBarVariant);if(e&&e.hasOwnProperty("version")){i.filterbar=this._mergeVariantFields(i.filterbar,e.filterbar);i.filterBarVariant=e.filterBarVariant}return i};O.prototype._mergeVariantFields=function(t,e){var i;e.forEach(function(e){for(i=0;i<t.length;i++){if(t[i].group===e.group&&t[i].name===e.name){t.splice(i,1);break}}});return t.concat(e)};O.prototype._isUi2Mode=function(){if(this._oVariantManagement instanceof f){return true}return false};O.prototype._isDeltaHandling=function(){if(this._isUi2Mode()){return false}return this.getDeltaVariantMode()};O.prototype._getStandardVariant=function(){return this._oVariantManagement.getStandardVariant(this)};O.prototype._considerFilter=function(t){if(!this._isDeltaHandling()){return true}var e=null;var i=this._getStandardVariant();if(i&&i.filterbar){for(var r=0;r<i.filterbar.length;r++){if(i.filterbar[r].group===t.group&&i.filterbar[r].name===t.name){e=i.filterbar[r];break}}}if(!e){if(!t.partOfCurrentVariant){return false}return true}if(e.partOfCurrentVariant!==t.partOfCurrentVariant||e.visibleInFilterBar!==t.visibleInFilterBar||e.visible!==t.visible){return true}return false};O.prototype._addControlToAdvancedArea=function(t,e,i){var r=new P({label:t.getLabelControl(this.getId()),fields:[e!==null?e:new a]});i.addFormElement(r)};O.prototype._determineVisibility=function(t){var e=false;if(t){e=t.getVisible()&&(t.getVisibleInFilterBar()||this._checkIfFilterHasValue(t.getName()));e=e&&!t.getHiddenFilter()}return e};O.prototype._retrieveVisibleAdvancedItems=function(){var t,e=null,i;var r=[];if(this._mAdvancedAreaFilter){for(e in this._mAdvancedAreaFilter){if(e){if(this._mAdvancedAreaFilter[e]&&this._mAdvancedAreaFilter[e].items){for(t=0;t<this._mAdvancedAreaFilter[e].items.length;t++){i=this._mAdvancedAreaFilter[e].items[t];if(i){if(this._determineVisibility(i.filterItem)){r.push(i)}}}}}}}return r};O.prototype._retrieveCurrentSelectionSet=function(t,e){var i,r,a,n=[];var s=this._retrieveVisibleAdvancedItems();for(i=0;i<s.length;i++){r=s[i];if(r.control&&r.filterItem&&(e||!r.filterItem._isParameter())){if(t){a={name:s[i].filterItem.getName(),control:s[i].control}}else{a=s[i].control}n.push(a)}}return n};O.prototype.search=function(){this.fireSearch({selectionSet:this._retrieveCurrentSelectionSet(false),firedFromFilterBar:this._bSearchFiredFromFilterBar});this._bSearchFiredFromFilterBar=false;return true};O.prototype._searchFromFilterBar=function(){this._bSearchFiredFromFilterBar=true;this.search.apply(this,arguments)};O.prototype.clear=function(){var t={};t.selectionSet=this._retrieveCurrentSelectionSet(false);this._deleteValidatingTokenFlag(t.selectionSet);this._clearErrorState();this.fireClear(t);this._updateToolbarText()};O.prototype._deleteValidatingTokenFlag=function(t){t.forEach(function(t){if(t.hasOwnProperty("__bValidatingToken")){delete t.__bValidatingToken}})};O.prototype.reset=function(){var t={};t.selectionSet=this._retrieveCurrentSelectionSet(false);this.fireReset(t);this._resetVariant()};O.prototype._resetVariant=function(){var t=null,e=null;this._resetFiltersInErrorValueState();var i=this._retrieveCurrentSelectionSet(false);this._deleteValidatingTokenFlag(i);if(this._oVariantManagement){var r=this._oVariantManagement.getSelectionKey()||this._oVariantManagement.getStandardVariantKey();if(r){t=this._oVariantManagement.getVariantContent(this,r);if(this._oVariant){this._oVariant.content=t;this._oVariant.modified=false;if(this.getPersistencyKey()&&this._oInitialVariant){this._oInitialVariant.content=t;this._oInitialVariant.modified=false;this._oInitialVariant.key=r}}if(!this.getPersistencyKey()&&this.getUseSnapshot()===undefined&&this._oInitialVariant&&this._oInitialVariant.content){e=this._oInitialVariant.content}if(t||e){this.applyVariant(t||e,"RESET")}if(this._oSelectedVariantBase&&this._isFilterBarContext()){this.applyVariant(this._oSelectedVariantBase,"RESET")}}}};O.prototype._removeValuesForNonPartOfCurrentVariants=function(t){};O.prototype._removeEmptyFilters=function(t){return t};O.prototype._applyVariant=function(t,e,i,r){var a,n=null,s,o=false,l=[];if(t){if(i){s=this._getTriggerFilterChangeState();this._setTriggerFilterChangeState(false)}this._setConsiderFilterChanges(false);a=t.filterBarVariant;n=t.filterbar;if(this._oFilterProvider){this._oFilterProvider._setSingleInputsTextArrangementData(JSON.parse(t.singleInputsTextArrangementData||"{}"))}l=t.orderedFilterItems?JSON.parse(t.orderedFilterItems):[];if(!l.length){l=this._mAdvancedAreaFilterFlat}if(Array.isArray(n)&&n.length){this._ensureFilterLoaded(n.filter(function(t){return t.visibleInFilterBar}))}this._applyVariantFields(a,r);var h=this._reapplyVisibility(n,e==="CANCEL");this._removeValuesForNonPartOfCurrentVariants(h);if(this._oBasicSearchField&&this._oBasicSearchField.setValue){this._oBasicSearchField.setValue(t.basicSearch||"")}if(t.executeOnSelection){o=t.executeOnSelection}this._reorderItemsInBasicAreaLayout(l);this._aOrderedFilterItems=l;this._reorderItemsInAdvancedAreaFilter();this.fireAfterVariantLoad(e,o);this._setConsiderFilterChanges(true);this._updateToolbarText();if(o||this.getLiveMode&&this.getLiveMode()){this._searchFromFilterBar()}else if(e!=="CANCEL"){this._clearErrorState()}if(i){this._setTriggerFilterChangeState(s)}if((!e||e==="RESET")&&this._isFilterBarContext()){this._oSelectedVariantBase=t}}};O.prototype._fetchVariantFiltersData=function(t){if(this._fRegisteredFetchData){try{return this._fRegisteredFetchData(t)}catch(t){b.error("callback for fetching data throws an exception")}}else{b.warning("no callback for fetch data supplied")}return null};O.prototype._applyVariantFields=function(t,e){if(this._fRegisteredApplyData){try{return this._fRegisteredApplyData(t,e)}catch(t){b.error("callback for applying data throws an exception")}}else{b.warning("no callback for apply data supplied")}};O.prototype._isStandardVariant=function(){var t=this.getCurrentVariantId();if(!t){return true}if(this._oVariantManagement){if(t===this._oVariantManagement.getStandardVariantKey()){return true}if(this._oVariantManagement._oStandardVariant===null){return true}}return false};O.prototype.isCurrentVariantExecuteOnSelectEnabled=function(){if(this._oVariantManagement&&!this._oVariantManagement.getInErrorState()){var t=this.getCurrentVariantId();if(!t){return this._oVariantManagement.getExecuteOnSelectForStandardVariant()}var e=this._oVariantManagement.getItemByKey(t);if(e){return e.getExecuteOnSelect()}}return false};O.prototype.fetchVariant=function(){var t,e={},i,r,a=[];if(this._isDeltaHandling()){if(!this._isStandardVariant()){e.version="V3"}}this.fireBeforeVariantFetch();t=this._determineVariantFiltersInfo(true,!e.version);e.filterbar=!t?[]:t;var n=function(t){t.forEach(function(t){a.push({name:t.name,group:t.group})})};if(this._aAdaptFilterItems&&this._aAdaptFilterItems.length>0){n(this._aAdaptFilterItems);e.orderedFilterItems=JSON.stringify(a)}else{if(this._aOrderedFilterItems.length>0){n(this._aOrderedFilterItems)}else{this._mAdvancedAreaFilterFlat=this._getAllFilterItemsFlat();n(this._mAdvancedAreaFilterFlat)}e.orderedFilterItems=JSON.stringify(a)}r=this._fetchVariantFiltersData(e.version);e.filterBarVariant=this._removeEmptyFilters(r);e.singleInputsTextArrangementData=JSON.stringify(this._oFilterProvider?this._oFilterProvider._getSingleInputsTextArrangementData():{});i=this._getBasicSearchValue();if(i){e.basicSearch=i}if(this._oVariant&&this._oVariant.content){this._oVariant.content=e}if(!this._oSelectedVariantBase||this._oSelectedVariantBase===null){this._oSelectedVariantBase=e}return e};O.prototype.applyVariant=function(t,e,i){if(t.hasOwnProperty("version")){t=this.mergeVariant(this._getStandardVariant(),t,e)}this._applyVariant(t,e,i,t.version)};O.prototype._afterVariantsLoad=function(){if(this._bDelayRendering){this._oBasicAreaLayout.setVisible(this.getFilterBarExpanded())}this._bDelayRendering=false};O.prototype.determineMandatoryFilterItems=function(){var t;var e=[];var i=this._retrieveVisibleAdvancedItems();for(t=0;t<i.length;t++){if(i[t].filterItem.getMandatory()===true){if(i[t].control){e.push(i[t].filterItem)}}}return e};O.prototype.determineControlByFilterItem=function(t,e){var i,r=null;var a,n;if(!t||!e&&t._isParameter()){return null}if(this._aBasicAreaSelection){for(i=0;i<this._aBasicAreaSelection.length;i++){a=this._aBasicAreaSelection[i];if(t===a.filterItem){return a.control}}}if(this._mAdvancedAreaFilter){for(r in this._mAdvancedAreaFilter){if(r){n=this._mAdvancedAreaFilter[r];if(n&&n.items){for(i=0;i<n.items.length;i++){a=n.items[i];if((e||!a.filterItem._isParameter())&&t===a.filterItem){return a.control}}}}}}return null};O.prototype.determineControlByName=function(t,e){var i=this._determineEnsuredItemByName(t,e);if(i&&i.filterItem&&!i.filterItem._isParameter()){return i.control}return null};O.prototype.determineLabelByName=function(t,e){var i=this._determineEnsuredItemByName(t,e);if(i&&i.filterItem){return i.filterItem._oLabel}return null};O.prototype._determineEnsuredItemByName=function(t,e){if(!e){e=this._determineGroupNameByName(t)}this._ensureFilterLoaded([{name:t,group:e}]);return this._determineItemByName(t,e)};O.prototype._determineGroupNameByName=function(t){if(this._aFields){for(var e=0;e<this._aFields.length;e++){if(this._aFields[e].fieldName===t){return this._aFields[e].groupName}}}var i=this._determineFilterItemByName(t);if(i){var r=i.getGroupName();if(r!==O.INTERNAL_GROUP){return r}}return null};O.prototype._determineItemByName=function(t,e){var i;var r,a;var n=e;if(!t){return null}if(!n){n=O.INTERNAL_GROUP}if(this._mAdvancedAreaFilter){a=this._mAdvancedAreaFilter[n];if(a&&a.items){for(i=0;i<a.items.length;i++){r=a.items[i];if(r&&r.filterItem&&r.filterItem.getName()===t){return r}}}}return null};O.prototype.determineFilterItemByName=function(t,e){var i;if(e){i=this._determineEnsuredItemByName(t,e)}else{i=this._determineEnsuredItemByName(t)}if(i&&i.filterItem){return i.filterItem}return null};O.prototype._determineFilterItemByName=function(t){var e,i;if(this._mAdvancedAreaFilter){for(e in this._mAdvancedAreaFilter){i=this._determineItemByName(t,e);if(i){return i.filterItem}}}return null};O.prototype._determineByControl=function(t){var e=null,i;if(this._mAdvancedAreaFilter){for(e in this._mAdvancedAreaFilter){if(e){var r=this._mAdvancedAreaFilter[e];if(r&&r.items){for(i=0;i<r.items.length;i++){if(r.items[i]&&r.items[i].control===t){return r.items[i]}}}}}}return null};O.prototype.onAfterRendering=function(t){if(!(this._isPhone()||this._isTablet())){if(this._oHintText&&this._oHintText.getVisible()){this._bNoFiltersInAdvancedArea=true;this.setFilterBarExpanded(false)}}this._applyAttributes();if(this.getIsRunningInValueHelpDialog()){if(!this._isPhone()){var e=this.iAddedContentLength,i=this._oBasicAreaLayout.getContent(),r;if(e>0&&e<4){for(var a=3;a>=4-e;a--){r=i[a].$().parent()[0];if(r){r.style.height="0px";r.style.margin="0px"}}}}}else{if(this._oToolbar&&this._oBasicSearchField&&(this._oVariantManagement&&this._oVariantManagement.getVisible()||this.getHeader())&&!this._isPhone()&&!this._oToolbar.getContent()[1].isA("sap.m.ToolbarSeparator")){this._oToolbar.insertContent((new T).addStyleClass("sapUiTinyMarginEnd"),1)}}};O.prototype._applyAttributes=function(){if(this._isPhone()||this._isTablet()){var t=this.getAllFilterItems(true);if(t.length>0){for(var e=0;e<t.length;e++){var i=t[e],r=i.getControl(),a=i.getName();this._applyInputModeAttribute(r,a)}}}};O.prototype._applyInputModeAttribute=function(t,e){if(this._oFilterProvider&&this._oFilterProvider._aFilterBarNumericFieldMetadata&&this._oFilterProvider._aFilterBarNumericFieldMetadata.indexOf(e)!==-1){var i=t.getDomRef("inner");if(i){i.setAttribute("inputmode","decimal");i.setAttribute("pattern","[0-9]+([.,][0-9]+)?")}}};O.prototype._destroyLazyFilterControl=function(){var t,e;if(this._aFields&&this._aFields.length>0){if(this._aFields&&this._aFields.length>0){for(t=0;t<this._aFields.length;t++){e=this._aFields[t];if(e.factory){if(e.control){e.control.destroy()}}}}}};O.prototype._destroyNonVisibleFilterControl=function(){var t,e,i;if(this._mAdvancedAreaFilter){for(e in this._mAdvancedAreaFilter){if(e&&this._mAdvancedAreaFilter[e]&&this._mAdvancedAreaFilter[e].items){for(t=0;t<this._mAdvancedAreaFilter[e].items.length;t++){i=this._mAdvancedAreaFilter[e].items[t];if(i&&i.container){if(this._oBasicAreaLayout&&this._oBasicAreaLayout.indexOfContent(i.container)<0){if(i.control&&!i.bDestroyed){i.control.destroy();i.bDestroyed=true}}}}}}}};O.prototype._removeInputRenderingDelegate=function(){var t,e,i;if(this._mAdvancedAreaFilter){for(e in this._mAdvancedAreaFilter){if(e&&this._mAdvancedAreaFilter[e]&&this._mAdvancedAreaFilter[e].items){for(t=0;t<this._mAdvancedAreaFilter[e].items.length;t++){i=this._mAdvancedAreaFilter[e].items[t];if(i&&i.control&&i.control._onAfterInputRenderingDelegate){i.control.removeDelegate(i.control._onAfterInputRenderingDelegate)}}}}}};O.prototype._destroyFilterControls=function(){if(!this.getAdvancedMode()){this._destroyLazyFilterControl();this._destroyNonVisibleFilterControl()}this._removeInputRenderingDelegate()};O.prototype._registerVariantManagement=function(){if(this._oVariantManagement){this._oVariantManagement.attachSave(this._variantSave,this);this._oVariantManagement.attachAfterSave(this._afterVariantSave,this)}};O.prototype._unregisterVariantManagement=function(){if(this._oVariantManagement){if(this._fInitialiseVariants){this._oVariantManagement.detachInitialise(this._fInitialiseVariants);this._fInitialiseVariants=null}this._oVariantManagement.detachSave(this._variantSave,this);this._oVariantManagement.detachAfterSave(this._afterVariantSave,this);if((!this.getUseToolbar()||this.getAdvancedMode())&&!this._oVariantManagement.getDomRef()){this._oVariantManagement.destroy()}}};O.prototype.showFilterDialog=function(){if(!this._oAdaptFiltersDialog){this.showAdaptFilterDialog()}};O.prototype.addFilterDialogContent=function(t){if(this._oAdaptFiltersDialog){return t}return null};O.prototype.getFilterDialogContent=function(){if(this._oAdaptFiltersDialog){return new M}return null};O.prototype.setShowOldFilterDialog=function(){};O.prototype._getFilterControlById=function(t){for(var e in this._mAdvancedAreaFilter){var i=this._mAdvancedAreaFilter[e];for(var r=0;r<i.items.length;r++){var a=i.items[r];if(a.control&&a.control.getId()===t){return a.control}}}return null};O.prototype._getFilterControlByIndex=function(t){var e=0;for(var i in this._mAdvancedAreaFilter){var r=this._mAdvancedAreaFilter[i];for(var a=0;a<r.items.length;a++){var n=r.items[a];if(n.filterItem.getVisibleInFilterBar()){if(e===t){return n.control}e++}}}};function k(t,e){var i=t.filter(function(t){return t.getText()===e});return i.length>0}O.prototype._getFilterControlByLabel=function(t){for(var e in this._mAdvancedAreaFilter){var i=this._mAdvancedAreaFilter[e];for(var r=0;r<i.items.length;r++){var a=i.items[r];if(a.control){if(k(a.control.getLabels(),t)){return a.control}}}}};O.prototype._isFilterItemInBasicGroup=function(t){return t&&!t.getGroupName()||t.getGroupName()===O.INTERNAL_GROUP};O.prototype._shouldBeVisible=function(t){return t.filterItem.getMandatory()&&!this._hasFilterValue(t.filterItem)||t.name==="_BASIC_SEARCH_FIELD"};O.prototype.exit=function(){this._unregisterVariantManagement();this._destroyFilterControls();if(this._oHintText&&this._oAdvancedPanel.indexOfContent(this._oHintText)<0){this._oHintText.destroy()}window.sessionStorage.removeItem(this.getId());window.sessionStorage.removeItem("semanticDates");c.prototype.exit.apply(this,arguments);if(this._oAdaptFiltersDialog){this._oAdaptFiltersDialog.destroy();this._oAdaptFiltersDialog=null}if(this._oAdaptFiltersDialogModel){this._oAdaptFiltersDialogModel=null}if(this._oAdaptFiltersPanel){this._oAdaptFiltersPanel=null}if(this.oModel){this.oModel.destroy();this.oModel=null}this._aFields=null;this._oHintText=null;this._aBasicAreaSelection=null;this._mAdvancedAreaFilter=null;this._oBasicAreaLayout=null;this._oVariantManagement=null;this._oCollectiveSearch=null;this._oVariant=null;this._fRegisteredFetchData=null;this._fRegisteredApplyData=null;this._fRegisterGetFiltersWithValues=null;this._fRegisteredFilterChangeHandlers=null;this._oSearchButton=null;this._oFiltersButton=null;this._oHideShowButton=null;this._oClearButtonOnFB=null;this._oRestoreButtonOnFB=null;this._oBasicSearchField=null;this._oBasicSearchFieldContainer=null;this._oButtonsVLayout=null;this._bLayoutAdded=null;this.iAddedContentLength=null;this._bSearchFiredFromFilterBar=false;this._oInitializedDeferred=null;this._bDelegateAdded=false};return O});
/*!
 * SAPUI5
 * (c) Copyright 2009-2023 SAP SE. All rights reserved.
 */
sap.ui.predefine("sap/ui/comp/filterbar/FilterGroupItem", ["./FilterItem","sap/ui/comp/library"],function(t,e){"use strict";var r=t.extend("sap.ui.comp.filterbar.FilterGroupItem",{metadata:{library:"sap.ui.comp",properties:{groupTitle:{type:"string",group:"Misc",defaultValue:null},groupName:{type:"string",group:"Misc",defaultValue:null},visibleInAdvancedArea:{type:"boolean",group:"Misc",defaultValue:false}}}});r.prototype.init=function(){this.setVisibleInAdvancedArea(false);this._setParameter(false)};r.prototype._setParameter=function(t){this._bIsParameter=t};r.prototype.setGroupTitle=function(t){this.setProperty("groupTitle",t);this.fireChange({propertyName:"groupTitle"});return this};r.prototype.setVisibleInAdvancedArea=function(t){this.setVisibleInFilterBar(t);return this};r.prototype.getVisibleInAdvancedArea=function(){return this.getVisibleInFilterBar()};r.prototype._getControl=function(){return this.getControl.apply(this,arguments)};r.prototype.destroy=function(){t.prototype.destroy.apply(this,arguments)};return r});
/*!
 * SAPUI5
 * (c) Copyright 2009-2023 SAP SE. All rights reserved.
 */
sap.ui.predefine("sap/ui/comp/filterbar/FilterItem", ["sap/m/Label","sap/ui/core/Element","sap/ui/comp/util/IdentifierUtil"],function(t,e,r){"use strict";var o=e.extend("sap.ui.comp.filterbar.FilterItem",{metadata:{library:"sap.ui.comp",properties:{label:{type:"string",group:"Misc",defaultValue:null},name:{type:"string",group:"Misc",defaultValue:null},mandatory:{type:"boolean",group:"Misc",defaultValue:false},visible:{type:"boolean",group:"Misc",defaultValue:true},labelTooltip:{type:"string",group:"Misc",defaultValue:null},controlTooltip:{type:"string",group:"Misc",defaultValue:null},partOfCurrentVariant:{type:"boolean",group:"Misc",defaultValue:true},visibleInFilterBar:{type:"boolean",group:"Misc",defaultValue:true},hiddenFilter:{type:"boolean",group:"Misc",defaultValue:false},entitySetName:{type:"string",group:"Misc",defaultValue:null},entityTypeName:{type:"string",group:"Misc",defaultValue:null}},aggregations:{control:{type:"sap.ui.core.Control",multiple:false}},events:{change:{parameters:{propertyName:{type:"string"}}}}}});o.prototype.init=function(){this._oLabel=null;this._bIsParameter=false;this._sControlId=null};o.prototype.setControl=function(t){if(t&&t.getId){this._sControlId=t.getId()}this.setAggregation("control",t);return this};o.prototype.getControl=function(){var t=this.getAggregation("control");if(t){return t}if(this._sControlId===null){return null}return sap.ui.getCore().byId(this._sControlId)};o.prototype._getControl=function(){return this.getControl.apply(this,arguments)};o.prototype._isParameter=function(){return this._bIsParameter};o.prototype.setVisible=function(t){this.setProperty("visible",t);this.fireChange({propertyName:"visible"});return this};o.prototype.setVisibleInFilterBar=function(t){this.setProperty("visibleInFilterBar",t);this.fireChange({propertyName:"visibleInFilterBar"});return this};o.prototype.setPartOfCurrentVariant=function(t){if(t){this.fireChange({propertyName:"partOfCurrentVariant"})}return this};o.prototype.getPartOfCurrentVariant=function(){return true};o.prototype._getGroupName=function(){var t="";if(this.getGroupName){t=r.replace(this.getGroupName())}return t};o.prototype._getName=function(){var t=r.replace(this.getName());var e=this._getGroupName();if(e){t=e+"-"+t}return t};o.prototype._createLabelControl=function(e){var r=this.getLabel();var o="filterItem-"+this._getName();if(e){o=e+"-"+o}var i=new t({id:o,required:this.getMandatory(),textAlign:"Begin"});i.setText(r);i.setTooltip(this.getLabelTooltip());return i};o.prototype.setMandatory=function(t){this.setProperty("mandatory",t);if(this._oLabel){this._oLabel.setRequired(t)}this.fireChange({propertyName:"mandatory"});return this};o.prototype.setLabel=function(t){this.setProperty("label",t);if(this._oLabel){this._oLabel.setText(t)}if(!this.getLabelTooltip()){this.setLabelTooltip(t)}this.fireChange({propertyName:"label"});return this};o.prototype.setLabelTooltip=function(t){this.setProperty("labelTooltip",t);if(this._oLabel){this._oLabel.setTooltip(t)}this.fireChange({propertyName:"labelTooltip"});return this};o.prototype.setControlTooltip=function(t){this.setProperty("controlTooltip",t);this.fireChange({propertyName:"controlTooltip"});return this};o.prototype.getLabelControl=function(t){if(!this._oLabel){this._oLabel=this._createLabelControl(t)}return this._oLabel};o.prototype.destroy=function(){e.prototype.destroy.apply(this,arguments);if(this._oLabel&&!this._oLabel.bIsDestroyed){this._oLabel.destroy()}if(this._getControl()&&!this._getControl().bIsDestroyed){this._getControl().destroy()}var t=this.getId()+"__filterGroupItem",r=sap.ui.getCore().byId(t);if(r){e.prototype.destroy.apply(r,arguments);if(r._oLabel&&!r._oLabel.bIsDestroyed){r._oLabel.destroy()}r._oLabel=null}this._oLabel=null;this._sQuickinfo=null};return o});
/*!
 * SAPUI5
 * (c) Copyright 2009-2023 SAP SE. All rights reserved.
 */
sap.ui.predefine("sap/ui/comp/filterbar/VariantConverterFrom", ["sap/ui/comp/library","sap/ui/core/date/UI5Date","sap/ui/comp/util/DateTimeUtil","sap/m/DatePicker","sap/m/DateRangeSelection","sap/base/Log","sap/ui/core/format/DateFormat"],function(e,t,i,a,r,n,o){"use strict";var l=e.ANALYTICAL_PARAMETER_PREFIX;var s=e.smartfilterbar.FilterType;var f=e.valuehelpdialog.ValueHelpRangeOperation;var c=function(){};c.prototype.convert=function(e,t,i){var a=null,r=null,n;if(e){this._bStrictMode=i;n=JSON.parse(e);if(t&&t.getFilterBarViewMetadata&&n){this._sBasicSearchName=null;this._sBasicSearchValue=null;if(t.getBasicSearchName){this._sBasicSearchName=t.getBasicSearchName()}a={};if(n.Parameters){this._addParameters(n.Parameters,t,a)}if(n.SelectOptions){this._addSelectOptions(n.SelectOptions,t,a)}r={payload:null,variantId:null};r.payload=JSON.stringify(a);if(n.SelectionVariantID){r.variantId=n.SelectionVariantID}if(this._sBasicSearchValue){r.basicSearch=this._sBasicSearchValue}}}return r};c.prototype.retrieveVariantId=function(e){var t=null;var i;if(e){i=JSON.parse(e);if(i&&i.SelectionVariantID){t=i.SelectionVariantID}}return t};c.prototype._getParameterMetaData=function(e,t,i){if(this._bStrictMode){return this._getParameterMetaDataStrictMode(e,t)}return this._getParameterMetaDataNonStrictMode(e,t,i)};c.prototype._getFilter=function(e,t){var i,a,r,n;n=t.getFilterBarViewMetadata();if(n){for(i=0;i<n.length;i++){r=n[i];for(a=0;a<r.fields.length;a++){if(e===r.fields[a].fieldName){return r.fields[a]}}}}return null};c.prototype._getParameter=function(e,t){var i,a;if(t.getAnalyticalParameters){a=t.getAnalyticalParameters();if(a){for(i=0;i<a.length;i++){if(e===a[i].fieldName){return a[i]}}}}return null};c.prototype._getParameterWithInnerPrefix=function(e,t){var i=e;if(e.indexOf(l)!==0){i=l+e}return this._getParameter(i,t)};c.prototype._getParameterMetaDataStrictMode=function(e,t){var i=this._getExactFilterParameterMatch(e,t);if(i){return i}return null};c.prototype._getParameterMetaDataNonStrictMode=function(e,t,i){var a,r,n,o,s=e,f=false,c=function(){return f&&s===o||!f&&s!==o};if(e.indexOf(l)===0){s=e.substr(l.length);f=true}if(s.indexOf("P_")===0){r=s;n=s.substr(2)}else{r="P_"+s;n=s}if(s!==r){o=r}else if(s!==n){o=n}a=this._getExactParameterMatch(s,t);if(a){return a}a=this._getExactParameterMatch(o,t);if(a){return a}if(c()){a=this._getFilter(n,t);if(a){return a}}return null};c.prototype._getExactParameterMatch=function(e,t){var i;i=this._getParameterWithInnerPrefix(e,t);if(i){return i}return null};c.prototype._getExactFilterParameterMatch=function(e,t){var i,a;i=this._getFilter(e,t);if(i){return i}a=this._getParameterWithInnerPrefix(e,t);if(a){return a}return null};c.prototype._addParameters=function(e,t,i){var a;var r,o;var l;for(a=0;a<e.length;a++){o=e[a].PropertyValue;r=e[a].PropertyName;if(this._sBasicSearchName&&r===this._sBasicSearchName){this._sBasicSearchValue=o;continue}l=this._getParameterMetaData(r,t,true);if(l){t.determineControlByName(r);this._addAccordingMetaData(i,t,l,o)}else{n.error("neither metadata nor custom information for filter '"+r+"'")}}};c.prototype._addSelectOptions=function(e,t,i){var a;var r,o;var l,s;for(a=0;a<e.length;a++){r=e[a].PropertyName;o=e[a].Ranges;if(this._sBasicSearchName&&r===this._sBasicSearchName){if(o&&o.length>0){this._sBasicSearchValue=o[0].Low}continue}t.determineControlByName(r);l=this._getParameterMetaData(r,t,false);if(l){s=l.control;this._addRangesAccordingMetaData(i,t,l,o,s)}else{n.error("neither metadata nor custom information for filter '"+r+"'")}}};c.convertOption=function(e,t){var i;switch(e){case"CP":i=f.Contains;if(t){var a=t.indexOf("*");var r=t.lastIndexOf("*");if(a>-1){if(a===0&&r!==t.length-1){i=f.EndsWith;t=t.substring(1,t.length)}else if(a!==0&&r===t.length-1){i=f.StartsWith;t=t.substring(0,t.length-1)}else{t=t.substring(1,t.length-1)}}}break;case"EQ":if(t===""||t===null){i=f.Empty;t=null}else{i=e}break;case"BT":case"LE":case"GE":case"GT":case"LT":i=e;break;default:n.error("Suite Option is not supported '"+e+"'");i=undefined;t=undefined}return{op:i,v:t}};c.prototype._getYearMonthDatePattern=function(e){var t=e.match(/^([0-9]{4})([0-9]{2})([0-9]{2})$/);if(t){return[t[1],t[2],t[3]]}};c.prototype._getTimeZoneFormat=function(e){return e.split(/[\s+-]/)[0]};c.prototype._createDateObject=function(e){var i,a,r,n,o,l,s,f;if(!e){return}i=e.split(".");a=i[0];r=i[1];if(r){r=this._getTimeZoneFormat(r)}o=a.split("T");f=o[0].split("-");if(f.length===1){n=this._getYearMonthDatePattern(f[0]);if(n){f=n}}if(o.length<2){l=t.getInstance(f[0],f[1]-1,f[2])}else{s=o[1].split(":");l=t.getInstance(f[0],f[1]-1,f[2],s[0],s[1],s[2],r?r:0)}l.setFullYear(f[0]);return l};c.prototype._addRangesAccordingMetaData=function(e,t,l,u,d,m){var h,p;var g=function(e,t,a,r){if(t&&t.isInUTCMode&&a.indexOf("PT")===-1&&e.filterType==="date"){if(t.isInUTCMode()){a=a.split("T")[0]+"T00:00:00"}else if(!t.isInUTCMode()&&a.split("T").length===1){a+="T00:00:00"}}if(a.indexOf("Z")!==a.length-1){if(t&&t.isInUTCMode&&!t.isInUTCMode()){r=i.localToUtc(this._createDateObject(a)).toJSON()}else{r=this._createDateObject(a).toJSON()}}else{n.error("Property '"+e.fieldName+"' was added with zulu time zone information.")}return r}.bind(this);var v=function(e){var t=o.getTimeInstance({pattern:"'PT'hh'H'mm'M'ss'S'"});return t.parse(e)};var _=function(e){var i=e;if(e&&l){if(l.filterType==="numeric"){if(l.type==="Edm.Decimal"||l.type==="Edm.Float"||l.type==="Edm.Double"||l.type==="Edm.Single"){i=parseFloat(e)}else{i=parseInt(e)}}else{switch(l.type){case"Edm.DateTime":i=g(l,t,e,i);break;case"Edm.Time":if(e.indexOf("PT")===0){i=v(e)}else{i=g(l,t,e,i)}break;case"Edm.String":if(l.isCalendarDate&&!l.calendarType&&!(l.filterType==="stringdate"&&l.controlType==="date")){i=g(l,t,e,i)}break;case"Edm.DateTimeOffset":i=e;break;case"Edm.Date":var a=e.split("T"),r=a[1];if(r){r=this._getTimeZoneFormat(r)}i=r?a[0]+"T"+r:e;break;default:i=e;break}}}return i};var y=function(t,i){var a,r,n;for(a=0;a<i.length;a++){n=c.convertOption(i[a].Option,i[a].Low);if(n&&n.op){r={exclude:i[a].Sign==="E",operation:n.op,keyField:t,value1:_(n.v),value2:_(i[a].High)};if(!e[t]){e[t]={ranges:[],items:[],value:null}}e[t].ranges.push(r)}}};var S=function(e){for(var t=0;t<e.length;t++){if(e[t].Sign==="E"){return true}}return false};if(u&&u.length>0){if(l.isCustomFilterField){if(!e._CUSTOM){e._CUSTOM={}}if(Array.isArray(u)&&u.length>1){e._CUSTOM[l.fieldName]=u.map(function(e){return e.Low})}else{e._CUSTOM[l.fieldName]=u[0].Low}return}if(l.conditionType){for(h=0;h<u.length;h++){if(!u[h].High){u[h].High=u[h].Low}}y(l.fieldName,u);return}if(l.filterRestriction===s.single){if(!u[0].Low&&d&&d instanceof a){e[l.fieldName]=null}else{e[l.fieldName]=_(u[0].Low)}}else if(l.filterRestriction===s.interval){if(d&&d instanceof r){if(u[0].Low&&u[0].High){e[l.fieldName]={low:_(u[0].Low),high:_(u[0].High)}}else if(u[0].Low&&!u[0].High){e[l.fieldName]={low:_(u[0].Low),high:_(u[0].Low)}}else if(!u[0].Low&&u[0].High){e[l.fieldName]={low:_(u[0].High),high:_(u[0].High)}}else{e[l.fieldName]={low:null,high:null}}}else{if(l.type==="Edm.Time"){y(l.fieldName,u)}else{e[l.fieldName]={low:u[0].Low===undefined?null:_(u[0].Low),high:u[0].High===undefined?null:_(u[0].High)}}}}else if(l.filterRestriction===s.multiple){e[l.fieldName]={ranges:[],items:[],value:null};var T=l.type==="Edm.DateTimeOffset"||l.isCalendarDate||l.type==="Edm.DateTime"||l.type==="Edm.Time";var M=d&&d.isA("sap.m.MultiInput")&&S(u);if(d&&!T&&(d.isA("sap.m.MultiComboBox")||d.isA("sap.m.MultiInput"))&&!M){var P;for(h=0;h<u.length;h++){P=_(u[h].Low);if(u[h].Option==="EQ"&&P===""){p={op:u[h].Option,v:P}}else{p=c.convertOption(u[h].Option,P)}if(p.op===f.EQ){e[l.fieldName].items.push({key:_(p.v)})}}}else{y(l.fieldName,u)}}else{y(l.fieldName,u)}n.warning("potential reduced information for filter '"+l.fieldName+"'")}else{n.warning("no Ranges-section found for filter '"+l.fieldName+"'")}};c.prototype._addAccordingMetaData=function(e,t,i,a){var r=i.type==="Edm.DateTime"?"":a;var n=[{Sign:"I",Low:a,High:r,Option:"EQ"}];this._addRangesAccordingMetaData(e,t,i,n)};return c},true);
/*!
 * SAPUI5
 * (c) Copyright 2009-2023 SAP SE. All rights reserved.
 */
sap.ui.predefine("sap/ui/comp/filterbar/VariantConverterTo", ["sap/ui/comp/library","sap/ui/core/date/UI5Date","sap/ui/comp/util/DateTimeUtil","sap/ui/comp/odata/ODataType","sap/ui/comp/util/FormatUtil","sap/ui/core/format/DateFormat","sap/ui/core/format/TimezoneUtil","sap/base/Log"],function(e,a,t,i,n,r,l,s){"use strict";var o=e.smartfilterbar.FilterType;var u=e.valuehelpdialog.ValueHelpRangeOperation;var g=e.ANALYTICAL_PARAMETER_PREFIX;var d=function(){};d.prototype.convert=function(e,a,t,i,n,r,l){var s,o,u,g,f=null,p,h;var c={SelectionVariantID:e};if(r){c.ParameterContextUrl=r}if(l){c.FilterContextUrl=l}this._sAPILevel=n;if(t&&a){u=JSON.parse(t);if(u){s=this._getFields(a);if(s&&s.length>0){for(o=0;o<s.length;o++){this._convertField(c,s[o],u,i)}}if(u._CUSTOM){if(typeof u._CUSTOM==="string"){g=JSON.parse(u._CUSTOM)}else{g=u._CUSTOM}for(f in g){if(f){if(Array.isArray(g[f])&&g[f].length>1){this._addArrayOfSingleValues(c,f,g[f])}else{this._addSingleValue(c,f,d._getValue(g[f],true))}}}}if(i&&i.getBasicSearchName){p=i.getBasicSearchName();if(p){h=i.getBasicSearchValue();this._addSingleValue(c,p,d._getValue(h,true))}}}}return JSON.stringify(c)};d.prototype._getParameterMetaData=function(e,a){var t,i,n;var r=a.getFilterBarViewMetadata();if(r){for(t=0;t<r.length;t++){n=r[t];for(i=0;i<n.fields.length;i++){if(e===n.fields[i].fieldName){return n.fields[i]}}}}if(a.getAnalyticalParameters){var l=a.getAnalyticalParameters();if(l){for(i=0;i<l.length;i++){if(e===l[i].fieldName){return l[i]}}}}return null};d.prototype._convertField=function(e,a,t,r){var l,s,u=null,g,f,p,h;if(t&&a&&e){l=t[a];if(l){f=this._getParameterMetaData(a,r);if(f){if(f.isCustomFilterField){return}var c=r.getUseDateRangeType()&&(f.type==="Edm.DateTime"&&f.displayFormat==="Date"||f.type==="Edm.String"&&f.isCalendarDate)||t[a]&&t[a].conditionTypeInfo&&t[a].conditionTypeInfo.name&&t[a].conditionTypeInfo.name==="sap.ui.comp.config.condition.DateRangeType";if(f.filterRestriction===o.single&&(!c||f.isParameter)){s=l.value===undefined?l:l.value;s=d._getValueWithMetadata(r,f,s,true);this._addSingleValue(e,a,s);if(c&&f.isParameter){if(t&&a&&e&&t[a]&&t[a].conditionTypeInfo){var l=t[a];if(l.ranges&&l.ranges.length>0){g=d.addRangeEntry(e,a);d.addRanges(g,l.ranges,r,f)}}}}else if(f.filterRestriction===o.interval){if(l.conditionTypeInfo){this._convertFieldByValue(e,a,t,r,f)}else{g=d.addRangeEntry(e,a);if(f.type==="Edm.DateTime"&&!l.high){l.high=l.low}else if(f.type==="Edm.String"&&!l.high){u="EQ"}if(f.type==="Edm.Time"){this._addRangeMultipleRangeValues(r,f,g,l.ranges,true)}else if(f.type==="Edm.DateTimeOffset"&&!l.high){u="BT";p=n.parseDateTimeOffsetInterval(l.low);if(p&&p.length===2&&p[0]){p[0]=f.ui5Type.parseValue(p[0],"string");if(p.length===2){p[1]=f.ui5Type.parseValue(p[1],"string")}h={low:p[0],high:p[1]};this._addRangeLowHigh(r,f,g,h,"BT")}else{this._addRangeLowHigh(r,f,g,l,"EQ")}}else if(i.isNumeric(f.type)&&!l.high){p=n.parseFilterNumericIntervalData(l.low);if(p&&p.length===2&&p[0]){this._addRangeLowHigh(r,f,g,{low:p[0],high:p[1]},"BT")}else{this._addRangeLowHigh(r,f,g,l,"EQ")}}else{this._addRangeLowHigh(r,f,g,l,u)}}}else if(f.filterRestriction===o.multiple){g=d.addRangeEntry(e,a);if(l.items&&l.items.length>0){this._addRangeMultipleSingleValues(r,f,g,l.items)}else if(l.ranges&&l.ranges.length>0){this._addRangeMultipleRangeValues(r,f,g,l.ranges,l.conditionTypeInfo?true:false)}else{this._addRangeSingleValue(g,l.value)}}else{this._convertFieldByValue(e,a,t,r,f)}}else{this._convertFieldByValue(e,a,t,r,f)}}}};d.prototype._convertFieldByValue=function(e,a,t,i,n){var r;var l;if(t&&a&&e){r=t[a];if(r){if(r.conditionTypeInfo){if(r.ranges&&r.ranges.length>0){l=d.addRangeEntry(e,a);d.addRanges(l,r.ranges,i,n)}}else if(r.ranges!==undefined&&r.items!==undefined&&r.value!==undefined){l=d.addRangeEntry(e,a);if(r.ranges&&r.ranges.length>0){d.addRanges(l,r.ranges,i,n)}if(r.items&&r.items.length>0){this._addRangeMultipleSingleValues(i,n,l,r.items)}if(r.value){this._addRangeSingleValue(l,d._getValueWithMetadata(i,n,r.value))}}else if(r.items!==undefined&&r.items&&r.items.length>0){l=d.addRangeEntry(e,a);this._addRangeMultipleSingleValues(i,n,l,r.items)}else if(r.low!==undefined&&r.low&&r.high!==undefined&&r.high){l=d.addRangeEntry(e,a);this._addRangeLowHigh(i,n,l,r)}else if(r.value!==undefined&&r.value){this._addSingleValue(e,a,r.value)}else if(r){this._addSingleValue(e,a,r)}}}};d.addRangeEntry=function(e,a){var t={PropertyName:a,Ranges:[]};if(!e.SelectOptions){e.SelectOptions=[]}e.SelectOptions.push(t);return t.Ranges};d.addRanges=function(e,a,t,i){var n,r,l,s;for(var o=0;o<a.length;o++){n=a[o].exclude?"E":"I";l=d._getValueWithMetadata(t,i,a[o].value1,true);s=null;if(a[o].operation===u.BT){s=d._getValueWithMetadata(t,i,a[o].value2)}l=d._prepareLowValue(a[o].operation,l);r=d._prepareOptionValue(a[o].operation,l);if(r){e.push({Sign:n,Option:r,Low:l,High:s})}}};d.addP13nRanges=function(e,a,t,i,n){var r,l,s,o;for(var g=0;g<a.length;g++){r=a[g].exclude?"E":"I";s=""+a[g].value1;o=null;if(a[g].operation===u.BT){o=""+a[g].value2}if(["date","datetime","time"].includes(t)){s=d._processP13NDateValue(a[g].value1,t,i,n);o=d._processP13NDateValue(a[g].value2,t,i,n)}s=d._prepareLowValue(a[g].operation,s);l=d._prepareOptionValue(a[g].operation,s);e.push({Sign:r,Option:l,Low:s,High:o})}};d._processP13NDateValue=function(e,i,n,r){if(!e||r){return e}if(typeof e==="string"){e=a.getInstance(e)}if(n&&(i==="date"||i==="time")){e=t.localToUtc(e)}if(i==="datetime"){return e.toISOString()}return e.toISOString().slice(0,-1)};d._prepareLowValue=function(e,a){switch(e){case u.Contains:if(a){a="*"+a+"*"}break;case u.StartsWith:if(a){a=a+"*"}break;case u.EndsWith:if(a){a="*"+a}break;case u.Empty:a="";break;case u.EQ:case u.BT:case u.LE:case u.GE:case u.GT:case u.LT:break;default:s.error("ValueHelpRangeOperation is not supported '"+e+"'");return}return a};d._prepareOptionValue=function(e,a){var t;switch(e){case u.Contains:case u.StartsWith:case u.EndsWith:t="CP";break;case u.Empty:t="EQ";break;case u.EQ:case u.BT:case u.LE:case u.GE:case u.GT:case u.LT:t=e;break;default:s.error("ValueHelpRangeOperation is not supported '"+e+"'");return}return t};d.prototype._addRangeMultipleSingleValues=function(e,a,t,i){for(var n=0;n<i.length;n++){t.push({Sign:"I",Option:"EQ",Low:d._getValueWithMetadata(e,a,i[n].key,true),High:null})}};d.prototype._addRangeMultipleRangeValues=function(e,a,t,i,n){for(var r=0;r<i.length;r++){t.push({Sign:i[r].exclude?"E":"I",Option:n?"BT":"EQ",Low:d._getValueWithMetadata(e,a,i[r].value1,true),High:n?d._getValueWithMetadata(e,a,i[r].value2):null})}};d.prototype._addRangeSingleValue=function(e,a){e.push({Sign:"I",Option:"EQ",Low:d._getValue(a,true),High:null})};d.prototype._addRangeLowHigh=function(e,a,t,i,n){var r=n||"BT";t.push({Sign:"I",Option:r,Low:d._getValueWithMetadata(e,a,i.low,true),High:d._getValueWithMetadata(e,a,i.high)})};d.prototype._addParamaterSingleValue=function(e,a,t){if(!e.Parameters){e.Parameters=[]}e.Parameters.push({PropertyName:a,PropertyValue:t})};d.prototype._createRangeSingleValue=function(e,a,t){var i=d.addRangeEntry(e,a);this._addRangeSingleValue(i,t)};d.prototype._addSingleValue=function(e,a,t){var i;if(this._sAPILevel){i=a.split(g);if(i.length>1){this._addParamaterSingleValue(e,i[i.length-1],t)}else{this._createRangeSingleValue(e,a,t)}}else{this._addParamaterSingleValue(e,a,t)}};d.prototype._addArrayOfSingleValues=function(e,a,t){var i=d.addRangeEntry(e,a);t.forEach(function(e){i.push({Sign:"I",Option:"EQ",Low:d._getValue(e,true),High:null})})};d.prototype._getFields=function(e){var a=[];if(e){for(var t=0;t<e.length;t++){a.push(e[t].name)}}return a};d._getValue=function(e,a){if(e===null||e===undefined||e===""){return a?"":null}return""+e};d._getValueWithMetadata=function(e,i,n,r){if(n===null||n===undefined||n===""){return r?"":null}else if(e&&i){if(i.type==="Edm.DateTime"||i.type==="Edm.Time"){if(i.isParameter&&n.oData){n=n.oData}if(i.isParameter&&!n.oData&&n.ranges&&n.ranges[0]&&n.ranges[0].value1){n=n.ranges[0].value1}if(e&&e.isInUTCMode&&e.isInUTCMode()){n=t.localToUtc(a.getInstance(n)).toJSON()}if(n.indexOf("Z")===n.length-1){n=n.substr(0,n.length-1)}}else if(i.type==="Edm.DateTimeOffset"){var l=e&&e._oFilterProvider&&e._oFilterProvider._getFilterTimeZone(i.name);if(l){n=t.toTimezone(n,l).toJSON()}else{n=a.getInstance(n).toJSON()}}}return""+n};return d},true);
/*!
 * SAPUI5
 * (c) Copyright 2009-2023 SAP SE. All rights reserved.
 */
sap.ui.predefine("sap/ui/comp/historyvalues/Constants", function(){"use strict";var r="sapui5.history.";var t="ui5.";var e="__sapui5_suggestion_order";var i=5;var n="__sapui5_forced_visible_suggestion";return{getHistoryPrefix:function(){return r},getShortHistoryPrefix:function(){return t},getSuggestionsGroupPropertyName:function(){return e},getForcedVisiblePropertyName:function(){return n},getMaxHistoryItems:function(){return i}}});
/*!
 * SAPUI5
 * (c) Copyright 2009-2023 SAP SE. All rights reserved.
 */
sap.ui.predefine("sap/ui/comp/historyvalues/HistoryAppDataService", ["sap/ui/base/Object","./Constants","./Utils","./HistoryGlobalDataService","sap/ui/core/Configuration"],function(t,i,e,a,n){"use strict";var r="en";var s;var o=t.extend("sap.ui.comp.historyvalues.HistoryAppDataService",{constructor:function(){t.apply(this,arguments);this._initialize()}});o.prototype._initialize=function(){this._initializeAppContainerId=this._initializeAppContainerId.bind(this);this._initializeAppData=this._initializeAppData.bind(this);this._sContainerId="";this._sItemId=i.getHistoryPrefix()+"appData";this._oPersonalizer=null;this._sAppId=i.getHistoryPrefix()+e.getAppInfo().id;this._oData={};this._oDataReadyPromise=this._getHistoryGlobalDataService().getApps().then(this._initializeAppContainerId).then(this._initializeAppData)};o.prototype._getHistoryGlobalDataService=function(){return a.getInstance()};o.prototype._initializeAppContainerId=function(t){this._sContainerId=t[this._sAppId];if(!this._sContainerId){this._createAndSaveContainerId(t)}return this._sContainerId};o.prototype._initializeAppData=function(){return this._getPersonalizer().getPersData().then(function(t){this._oData=t||this._getDefaultData();return this._oData}.bind(this))};o.prototype._getPersonalizer=function(){if(this._oPersonalizer){return this._oPersonalizer}var t=sap.ushell.Container.getService("Personalization"),i={keyCategory:t.constants.keyCategory.FIXED_KEY,writeFrequency:t.constants.writeFrequency.LOW,clientStorageAllowed:false,validity:Infinity},e={container:this._sContainerId,item:this._sItemId};this._oPersonalizer=t.getPersonalizer(e,i);return this._oPersonalizer};o.prototype._createAndSaveContainerId=function(t){this._sContainerId=this._createContainerId();t[this._sAppId]=this._sContainerId;this._getHistoryGlobalDataService().setApps(t)};o.prototype._createContainerId=function(){var t="xxxxxxxx.xxxx.4xxx.yxxx.xxxxxxxxxxxx".replace(/[xy]/g,function(t){var i=Math.random()*16|0;if(t==="y"){i=i&3|8}return i.toString(16)});return i.getShortHistoryPrefix()+t};o.prototype._getDefaultData=function(){return{}};o.prototype._isDataReady=function(){return this._oDataReadyPromise};o.prototype._getHistoryEnabled=function(){return this._getHistoryGlobalDataService().getHistoryEnabled()};o.prototype.getFieldData=function(t){return this._isDataReady().then(this._getHistoryEnabled.bind(this)).then(function(e){if(!e){return[]}var a=[],n=this._getLanguage();if(this._isDefaultLanguage(n)){a=this._oData[t]||[]}else{var r=i.getHistoryPrefix()+n;if(!this._oData[r]){a=[]}else{a=this._oData[r][t]||[]}}return a.slice()}.bind(this))};o.prototype.setFieldData=function(t,e){return this._isDataReady().then(this._getHistoryEnabled.bind(this)).then(function(a){if(!a){return false}var n=this._getLanguage();if(this._isDefaultLanguage(n)){this._oData[t]=e}else{var r=i.getHistoryPrefix()+n;if(!this._oData[r]){this._oData[r]={}}this._oData[r][t]=e}return this._getPersonalizer().setPersData(this._oData)}.bind(this))};o.prototype._getLanguage=function(){var t=n.getLanguage()||r;var i=t.match(/[a-z]+/i);if(i[0]){t=i[0].toLowerCase()}return t};o.prototype._isDefaultLanguage=function(t){return t===r};o.prototype.destroy=function(){t.prototype.destroy.apply(this,arguments);this._sContainerId="";this._sItemId="";this._oPersonalizer=null;this._sAppId="";this._oData={};this._oDataReadyPromise=null};return{getInstance:function(){var t=i.getHistoryPrefix()+e.getAppInfo().id;if(!s){s=new o}if(s._sAppId!==t){s.destroy();s=new o}return s}}});
/*!
 * SAPUI5
 * (c) Copyright 2009-2023 SAP SE. All rights reserved.
 */
sap.ui.predefine("sap/ui/comp/historyvalues/HistoryGlobalDataService", ["sap/ui/base/Object","./Constants"],function(t,i){"use strict";var e;var a=t.extend("sap.ui.comp.historyvalues.HistoryGlobalDataService",{constructor:function(){t.apply(this,arguments);this._initialize()}});a.prototype._initialize=function(){this._initializeHistoryData=this._initializeHistoryData.bind(this);this._sContainerId=i.getHistoryPrefix()+"HistorySettings";this._sItemId=i.getHistoryPrefix()+"settings";this._oPersonalizer=null;this._oData={};this._oDataReadyPromise=this._getPersonalizer().getPersData().then(this._initializeHistoryData)};a.prototype._initializeHistoryData=function(t){this._oData=t||this._getDefaultData();return Object.assign({},this._oData)};a.prototype._getPersonalizer=function(){if(this._oPersonalizer){return this._oPersonalizer}var t=sap.ushell.Container.getService("Personalization"),i={keyCategory:t.constants.keyCategory.FIXED_KEY,writeFrequency:t.constants.writeFrequency.LOW,clientStorageAllowed:false,validity:Infinity},e={container:this._sContainerId,item:this._sItemId};this._oPersonalizer=t.getPersonalizer(e,i);return this._oPersonalizer};a.prototype._getDefaultData=function(){return{historyEnabled:true,apps:{}}};a.prototype._isDataReady=function(){return this._oDataReadyPromise};a.prototype.getHistoryEnabled=function(){return this._isDataReady().then(function(){return this._oData.historyEnabled}.bind(this))};a.prototype.setHistoryEnabled=function(t){return this._isDataReady().then(function(){this._oData.historyEnabled=t;return this._getPersonalizer().setPersData(this._oData)}.bind(this))};a.prototype.getApps=function(){return this._isDataReady().then(function(){return Object.assign({},this._oData.apps)}.bind(this))};a.prototype.setApps=function(t){return this._isDataReady().then(function(){this._oData.apps=t;return this._getPersonalizer().setPersData(this._oData)}.bind(this))};a.prototype.deleteHistory=function(){return this._isDataReady().then(function(){var t=this._oData,i=[],e=t.apps;Object.keys(e).forEach(function(t){i.push(sap.ushell.Container.getService("Personalization").delContainer(e[t]))});return Promise.all(i)}.bind(this))};a.prototype.destroy=function(){t.prototype.destroy.apply(this,arguments);this._sContainerId="";this._sItemId="";this._oPersonalizer=null;this._oData={};this._oDataReadyPromise=null};return{getInstance:function(){if(!e){e=new a}return e}}});
/*!
 * SAPUI5
 * (c) Copyright 2009-2023 SAP SE. All rights reserved.
 */
sap.ui.predefine("sap/ui/comp/historyvalues/HistoryOptOutProvider", ["sap/ui/base/Object","sap/ui/core/Core","sap/ui/core/IconPool","./HistoryGlobalDataService","./Constants","./Utils","sap/m/Dialog","sap/m/MessageBox","sap/m/FlexBox","sap/m/VBox","sap/m/HBox","sap/m/Switch","sap/m/Button","sap/m/Label"],function(t,e,o,i,s,n,a,r,l,u,_,h,c,y){"use strict";var p;var H=t.extend("sap.ui.comp.historyvalues.HistoryOptOutProvider",{metadata:{library:"sap.ui.comp"},constructor:function(){t.apply(this,arguments);this._initialize()}});H.prototype._initialize=function(){this._oRB=e.getLibraryResourceBundle("sap.ui.comp");this._oHistoryGlobalDataService=i.getInstance();this._oDialog=null;this._oHistoryEnabledSwitch=null;this._oHistoryEnabledLabel=null;this._oDeleteHistoryButton=null;this._oDeleteHistoryLabel=null;this._oSaveButton=null;this._oCancelButton=null;this._oDialogLayout=null;this._oHistoryEnabledLayout=null;this._oDeleteHistoryLayout=null};H.prototype._createOptOutUserProfileEntry=function(){var t=sap.ushell.Container.getRenderer("fiori2"),e={controlType:"sap.m.Button",oControlProperties:{id:s.getHistoryPrefix()+"optOut.trigger",text:this._oRB.getText("HISTORY_SETTING_TITLE"),icon:o.getIconURI("history"),press:function(){this._createDialogContent();this._createLayouts();this._createDialog();this._oHistoryGlobalDataService.getHistoryEnabled().then(function(t){this._oHistoryEnabledSwitch.setState(t);if(!t){this._oHistoryEnabledSwitch.setState(t)}this._oDialog.open()}.bind(this))}.bind(this)},bIsVisible:true,bCurrentState:true};return t.addUserAction(e)};H.prototype._createDialogContent=function(){this._createHistoryEnabledSwitch();this._createHistoryEnabledLabel();this._createDeleteHistoryButton();this._createDeleteHistoryLabel();this._createSaveButton();this._createCancelButton()};H.prototype._createLayouts=function(){this._oHistoryEnabledLayout=new _({alignItems:"Center",items:[this._oHistoryEnabledLabel,this._oHistoryEnabledSwitch]});this._oDeleteHistoryLayout=new l({alignItems:"Center",items:[this._oDeleteHistoryLabel,this._oDeleteHistoryButton]});this._oDialogLayout=new u({items:[this._oHistoryEnabledLayout,this._oDeleteHistoryLayout]}).addStyleClass("sapUiSmallMargin")};H.prototype._createDialog=function(){this._oDialog=new a(s.getHistoryPrefix()+"optOutDialog",{title:this._oRB.getText("HISTORY_SETTING_TITLE"),content:[this._oDialogLayout],buttons:[this._oSaveButton,this._oCancelButton]});this._oDialog.attachAfterClose(this._onOptOutDialogAfterClose,this)};H.prototype._createHistoryEnabledSwitch=function(){this._oHistoryEnabledSwitch=new h};H.prototype._createHistoryEnabledLabel=function(){this._oHistoryEnabledLabel=new y({text:this._oRB.getText("HISTORY_SETTING_ENABLE_TRACKING_DESCRIPTION")}).addStyleClass("sapUiSmallMarginEnd")};H.prototype._createDeleteHistoryButton=function(){this._oDeleteHistoryButton=new c({busyIndicatorDelay:0,text:this._oRB.getText("HISTORY_SETTING_DELETE_BUTTON")});this._oDeleteHistoryButton.attachPress(this._onDeleteHistoryPress,this)};H.prototype._createDeleteHistoryLabel=function(){this._oDeleteHistoryLabel=new y({text:this._oRB.getText("HISTORY_SETTING_DELETE_DESCRIPTION")}).addStyleClass("sapUiSmallMarginEnd")};H.prototype._createSaveButton=function(){this._oSaveButton=new c({text:this._oRB.getText("HISTORY_SETTING_SAVE")});this._oSaveButton.attachPress(this._onSavePress,this)};H.prototype._createCancelButton=function(){this._oCancelButton=new c({text:this._oRB.getText("HISTORY_SETTING_CANCEL")});this._oCancelButton.attachPress(this._onCancelPress,this)};H.prototype._onOptOutDialogAfterClose=function(){this._oDialog.destroy()};H.prototype._onDeleteHistoryPress=function(t){var e=t.getSource();e.setBusy(true);this._oHistoryGlobalDataService.deleteHistory().then(function(){e.setBusy(false)})};H.prototype._onSavePress=function(){r.confirm(this._oRB.getText("HISTORY_SETTING_CONFIRM"),{onClose:function(t){if(t=="CANCEL"){return}this._oHistoryGlobalDataService.setHistoryEnabled(this._oHistoryEnabledSwitch.getState()).then(function(){window.location.reload()})}.bind(this)})};H.prototype._onCancelPress=function(){this._oDialog.close()};H.prototype.exit=function(){if(this._oDialog){this._oDialog.destroy();this._oDialog=null}this._oRB=null;this._oHistoryEnabledSwitch=null;this._oHistoryEnabledLabel=null;this._oDeleteHistoryButton=null;this._oDeleteHistoryLabel=null;this._oSaveButton=null;this._oCancelButton=null;this._oDialogLayout=null;this._oHistoryEnabledLayout=null;this._oDeleteHistoryLayout=null};return{createOptOutSettingPage:function(){if(n.getAppInfo().homePage===true){return}if(!p){p=new H}if(!p._oUserActionPromise){p._oUserActionPromise=p._createOptOutUserProfileEntry()}else{p._oUserActionPromise.then(function(){p._oUserActionPromise=p._createOptOutUserProfileEntry()})}return p}}});
/*!
 * SAPUI5
 * (c) Copyright 2009-2023 SAP SE. All rights reserved.
 */
sap.ui.predefine("sap/ui/comp/historyvalues/HistoryValuesProvider", ["sap/ui/base/EventProvider","sap/base/util/values","./Constants","./HistoryGlobalDataService","./HistoryAppDataService"],function(t,e,o,i,n){"use strict";var r=t.extend("sap.ui.comp.providers.HistoryValuesProvider",{metadata:{library:"sap.ui.comp",events:{fieldUpdated:{parameters:{fieldData:{type:"Array"}}}}},constructor:function(e,o){t.apply(this,arguments);this._initialize(e,o)}});r.prototype._initialize=function(t,e){this._oControl=t;this._sFieldName=e};r.prototype._getHistoryGlobalDataService=function(){return i.getInstance()};r.prototype._getHistoryAppDataService=function(){return n.getInstance()};r.prototype.attachChangeListener=function(){if(this._oControl.isA("sap.m.MultiInput")){this._oControl.attachTokenUpdate(this._onMultiInputChange,this);return}if(this._oControl.isA("sap.m.MultiComboBox")){this._oControl.attachSelectionChange(this._onMultiComboBoxChange,this);return}if(this._oControl.isA("sap.m.Input")){this._oControl.attachSuggestionItemSelected(this._suggestionItemSelected,this);return}if(this._oControl.isA("sap.m.ComboBox")){this._oControl.attachChange(this._onComboBoxChange,this);return}};r.prototype._detachChangeListener=function(){if(this._oControl.isA("sap.m.MultiInput")){this._oControl.detachTokenUpdate(this._onMultiInputChange,this);return}if(this._oControl.isA("sap.m.MultiComboBox")){this._oControl.detachSelectionChange(this._onMultiComboBoxChange,this);return}if(this._oControl.isA("sap.m.Input")){this._oControl.detachSuggestionItemSelected(this._suggestionItemSelected,this);return}if(this._oControl.isA("sap.m.ComboBox")){this._oControl.detachChange(this._onComboBoxChange,this);return}};r.prototype._onMultiInputChange=function(t){var e=t.getParameter("type"),o=t.getParameter("addedTokens");if(e==="added"){var i=o.reduce(function(t,e){var o=e.data("row");if(o){return t.concat(o)}return t},[]);this.setFieldData(i)}};r.prototype._onMultiComboBoxChange=function(t){var e=t.getParameter("selected"),o=t.getParameter("changedItem");if(e&&o){var i=o.getBindingContext("list").getObject();this._processSingleValueControl(i)}};r.prototype._suggestionItemSelected=function(t){var e=sap.ui.getCore().byId(t.getSource().getSelectedRow());if(e){var o=e.getBindingContext("list").getObject();this._processSingleValueControl(o)}};r.prototype._onComboBoxChange=function(t){var e=t.getParameter("value"),o=t.getParameter("newValue"),i=t.getSource().getSelectedItem();if(e&&o&&i){var n=i.getBindingContext("list").getObject();this._processSingleValueControl(n)}};r.prototype._processSingleValueControl=function(t){if(t){this.setFieldData([t])}};r.prototype._processDateValues=function(t){return Object.keys(t).reduce(function(e,o){if(typeof t[o]==="object"&&Object.prototype.toString.call(t[o])==="[object Date]"){e[o]="/Date("+t[o].getTime()+")/"}else{e[o]=t[o]}return e},{})};r.prototype._getDistinct=function(t){var o={},i=[];t.forEach(function(t){var n=e(t).join();if(!o[n]){i.push(t);o[n]=true}},this);return i};r.prototype._getItemId=function(t){if(!t){return null}var e=t.lastIndexOf("(");return t.slice(e)};r.prototype.getFieldData=function(){return this._getHistoryAppDataService().getFieldData(this._sFieldName)};r.prototype.setFieldData=function(t){t=t.reduce(function(t,e){var i=this._getItemId(e.__metadata&&e.__metadata.id);e=Object.assign({},e);if(i){e=Object.assign({__ui5_id:i},e)}delete e.__metadata;delete e[o.getForcedVisiblePropertyName()];delete e[o.getSuggestionsGroupPropertyName()];e=this._processDateValues(e);t.push(e);return t}.bind(this),[]);return this._getHistoryAppDataService().getFieldData(this._sFieldName).then(function(e){var i=o.getMaxHistoryItems(),n=this._getDistinct(t.concat(e));n=n.slice(0,i);this.fireEvent("fieldUpdated",{fieldData:n});return this._getHistoryAppDataService().setFieldData(this._sFieldName,n)}.bind(this))};r.prototype.getHistoryEnabled=function(){return this._getHistoryGlobalDataService().getHistoryEnabled()};r.prototype.destroy=function(){t.prototype.destroy.apply(this,arguments);if(this._oControl){this._detachChangeListener();this._oControl=null}this._sFieldName="";this._oDataReadyPromise=null};return r});
/*!
 * SAPUI5
 * (c) Copyright 2009-2023 SAP SE. All rights reserved.
 */
sap.ui.predefine("sap/ui/comp/historyvalues/Utils", function(){"use strict";return{getAppInfo:function e(){var t=sap.ushell.Container.getService("AppLifeCycle"),i=t.getCurrentApplication(),n,a,p,f={};if(i){n=i.componentInstance;f.homePage=i.homePage}if(n){a=n.getMetadata()}if(a){p=a.getManifest()}if(p){f.id=p["sap.app"].id}return f}}});
/*!
 * SAPUI5
 * (c) Copyright 2009-2023 SAP SE. All rights reserved.
 */
sap.ui.predefine("sap/ui/comp/library", ["sap/ui/core/Core","sap/ui/core/library","sap/m/library","sap/ui/mdc/library"],function(a,e,t,i){"use strict";var r=sap.ui.getCore().initLibrary({name:"sap.ui.comp",version:"1.120.3",dependencies:["sap.ui.core","sap.m","sap.ui.mdc"],designtime:"sap/ui/comp/designtime/library.designtime",types:["sap.ui.comp.smartfield.ControlProposalType","sap.ui.comp.smartfield.ControlContextType","sap.ui.comp.smartfield.ControlType","sap.ui.comp.smartchart.SelectionMode","sap.ui.comp.smartfield.DisplayBehaviour","sap.ui.comp.smartfield.JSONType","sap.ui.comp.smartfield.CriticalityRepresentationType","sap.ui.comp.smartfield.TextInEditModeSource","sap.ui.comp.smartfield.Importance","sap.ui.comp.TextArrangementType","sap.ui.comp.smarttable.TableType","sap.ui.comp.smarttable.ExportType","sap.ui.comp.smartlist.ListType","sap.ui.comp.personalization.AggregationRole","sap.ui.comp.personalization.ResetType","sap.ui.comp.personalization.ChangeType","sap.ui.comp.valuehelpdialog.ValueHelpRangeOperation","sap.ui.comp.smartfilterbar.SelectOptionSign","sap.ui.comp.smartfilterbar.DisplayBehaviour","sap.ui.comp.smartform.SmartFormValidationMode"],interfaces:["sap.ui.comp.smartform.SmartFormLayout","sap.ui.comp.IFormGroupElement","sap.ui.comp.IDropDownTextArrangement"],controls:["sap.ui.comp.filterbar.FilterBar","sap.ui.comp.navpopover.NavigationPopover","sap.ui.comp.navpopover.SmartLink","sap.ui.comp.smartchart.SmartChart","sap.ui.comp.smartfield.SmartField","sap.ui.comp.smartfield.SmartLabel","sap.ui.comp.smartfilterbar.SmartFilterBar","sap.ui.comp.smartform.SmartForm","sap.ui.comp.smartmultiedit.Field","sap.ui.comp.smartmultiedit.Container","sap.ui.comp.smartmicrochart.SmartAreaMicroChart","sap.ui.comp.smartmicrochart.SmartLineMicroChart","sap.ui.comp.smartmicrochart.SmartBulletMicroChart","sap.ui.comp.smartmicrochart.SmartDeltaMicroChart","sap.ui.comp.smartmicrochart.SmartRadialMicroChart","sap.ui.comp.smartmicrochart.SmartStackedBarMicroChart","sap.ui.comp.smartmicrochart.SmartComparisonMicroChart","sap.ui.comp.smartmicrochart.SmartColumnMicroChart","sap.ui.comp.smartmicrochart.SmartHarveyBallMicroChart","sap.ui.comp.smartmicrochart.SmartMicroChart","sap.ui.comp.smarttable.SmartTable","sap.ui.comp.smartlist.SmartList","sap.ui.comp.valuehelpdialog.ValueHelpDialog","sap.ui.comp.transport.TransportDialog","sap.ui.comp.variants.EditableVariantItem","sap.ui.comp.variants.VariantManagement","sap.ui.comp.smartvariants.SmartVariantManagement","sap.ui.comp.smartvariants.SmartVariantManagementUi2"],elements:["sap.ui.comp.filterbar.FilterGroupItem","sap.ui.comp.filterbar.FilterItem","sap.ui.comp.navpopover.LinkData","sap.ui.comp.navpopover.SemanticObjectController","sap.ui.comp.smartfield.Configuration","sap.ui.comp.smartfield.ControlProposal","sap.ui.comp.smartfield.ObjectStatus","sap.ui.comp.smartfilterbar.ControlConfiguration","sap.ui.comp.smartfilterbar.GroupConfiguration","sap.ui.comp.smartfilterbar.SelectOption","sap.ui.comp.smartform.Group","sap.ui.comp.smartform.GroupElement","sap.ui.comp.smartform.SemanticGroupElement","sap.ui.comp.smartform.Layout","sap.ui.comp.smartvariants.PersonalizableInfo","sap.ui.comp.variants.VariantItem","sap.ui.comp.navpopover.NavigationContainer","sap.ui.comp.smartvariants.SmartVariantManagementAdapter"],extensions:{flChangeHandlers:{"sap.ui.comp.smartform.SmartForm":"sap/ui/comp/smartform/flexibility/SmartForm","sap.ui.comp.smartform.Group":{hideControl:"default",unhideControl:"default",renameGroup:"sap/ui/comp/smartform/flexibility/changes/RenameGroup",addField:"sap/ui/comp/smartform/flexibility/changes/AddField",addFields:"sap/ui/comp/smartform/flexibility/changes/AddFields",addMultiEditField:"sap/ui/comp/smartmultiedit/flexibility/changes/AddMultiEditFields"},"sap.ui.comp.smartform.GroupElement":{hideControl:"default",unhideControl:"sap/ui/comp/smartform/flexibility/changes/UnhideControl",renameField:"sap/ui/comp/smartform/flexibility/changes/RenameField"},"sap.ui.comp.navpopover.NavigationContainer":{addLink:{changeHandler:"sap/ui/comp/navpopover/flexibility/LinkFlex",layers:{USER:true}},removeLink:{changeHandler:"sap/ui/comp/navpopover/flexibility/LinkFlex",layers:{USER:true}}},"sap.ui.comp.smartfield.SmartField":"sap/ui/comp/smartfield/flexibility/SmartField","sap.ui.comp.smarttable.SmartTable":{ToolbarContentMove:"sap/ui/comp/smarttable/flexibility/ToolbarContentMove"}},"sap.ui.support":{publicRules:true}}})||r;r.DEFAULT_DISPLAY_BEHAVIOUR="descriptionAndId";r.ANALYTICAL_PARAMETER_PREFIX="$Parameter.";r.STANDARD_VARIANT_NAME="STANDARD";r.smartform=r.smartform||{};r.smartform.inheritCostomDataToFields=function(a){var e=a.getKey();var t={startsWith:{strings:["sap.ui.fl"],compareFunction:function(a){return e.startsWith(a)}},wholeString:{strings:["sap-ui-custom-settings"],compareFunction:function(a){return e==a}}};var i=true;Object.keys(t).forEach(function(a){if(i&&t[a].strings.some(t[a].compareFunction)){i=false;return true}});return i};r.TextArrangementType={TextFirst:"com.sap.vocabularies.UI.v1.TextArrangementType/TextFirst",TextLast:"com.sap.vocabularies.UI.v1.TextArrangementType/TextLast",TextSeparate:"com.sap.vocabularies.UI.v1.TextArrangementType/TextSeparate",TextOnly:"com.sap.vocabularies.UI.v1.TextArrangementType/TextOnly"};r.smartchart=r.smartchart||{};r.smartchart.SelectionMode={Multi:"MULTIPLE",Single:"SINGLE",None:"NONE"};r.smartfield=r.smartfield||{};r.smartfield.ControlType={auto:"auto",dropDownList:"dropDownList",input:"input",datePicker:"datePicker",checkBox:"checkBox",selection:"selection"};r.smartfield.DisplayBehaviour={auto:"auto",descriptionOnly:"descriptionOnly",descriptionAndId:"descriptionAndId",idAndDescription:"idAndDescription",idOnly:"idOnly",TrueFalse:"TrueFalse",OnOff:"OnOff",YesNo:"YesNo"};r.smartfield.JSONType={String:"String",Date:"Date",Float:"Float",Integer:"Integer",Boolean:"Boolean",DateTime:"DateTime"};r.smartfield.ControlContextType={None:"",ResponsiveTable:"responsiveTable",Form:"form",Table:"table",SmartFormGrid:"smartFormGrid"};r.smartfield.ControlProposalType={None:"",ObjectNumber:"ObjectNumber",ObjectIdentifier:"ObjectIdentifier"};r.smartfield.CriticalityRepresentationType={WithoutIcon:"WithoutIcon",WithIcon:"WithIcon"};r.smarttable=r.smarttable||{};r.smarttable.TableType={Table:"Table",ResponsiveTable:"ResponsiveTable",AnalyticalTable:"AnalyticalTable",TreeTable:"TreeTable"};r.smarttable.InfoToolbarBehavior={Auto:"Auto",On:"On",Off:"Off"};r.smartfield.TextInEditModeSource={None:"None",NavigationProperty:"NavigationProperty",ValueList:"ValueList",ValueListNoValidation:"ValueListNoValidation",ValueListWarning:"ValueListWarning"};r.smartfield.Importance={High:"High",Medium:"Medium",Low:"Low"};r.smarttable.ExportType={GW:"GW",UI5Client:"UI5Client",UI5ClientPDF:"UI5ClientPDF"};r.smartlist=r.smartlist||{};r.smartlist.ListType={List:"List",Tree:"Tree"};r.personalization=r.personalization||{};r.personalization.ResetType={ResetFull:"ResetFull",ResetPartial:"ResetPartial"};r.personalization.AggregationRole={Dimension:"Dimension",Measure:"Measure",NotDimeasure:"NotDimeasure"};r.personalization.ChangeType={Unchanged:"Unchanged",ModelChanged:"ModelChanged",TableChanged:"TableChanged"};r.personalization.TableType={ResponsiveTable:"ResponsiveTable",Table:"Table",AnalyticalTable:"AnalyticalTable",TreeTable:"TreeTable",ChartWrapper:"ChartWrapper",SelectionWrapper:"SelectionWrapper"};r.personalization.ColumnType={ResponsiveColumn:"ResponsiveColumn",TableColumn:"TableColumn",ColumnWrapper:"ColumnWrapper"};r.smartfilterbar=r.smartfilterbar||{};r.smartfilterbar.FilterType={auto:"auto",single:"single",multiple:"multiple",interval:"interval",searchExpression:"searchExpression"};r.smartfilterbar.ControlType={auto:"auto",input:"input",dropDownList:"dropDownList",date:"date",dateTimePicker:"dateTimePicker"};r.smartfilterbar.MandatoryType={auto:"auto",mandatory:"mandatory",notMandatory:"notMandatory"};r.smartfilterbar.DisplayBehaviour={auto:"auto",descriptionOnly:"descriptionOnly",descriptionAndId:"descriptionAndId",idAndDescription:"idAndDescription",idOnly:"idOnly"};r.smartfilterbar.SelectOptionSign={I:"I",include:"I",E:"E",exclude:"E"};r.navpopover=r.navpopover||{};r.navpopover.ChangeHandlerType={addLink:"addLink",removeLink:"removeLink",moveLink:"moveLink"};r.smartvariants=r.smartvariants||{};r.smartvariants.ChangeHandlerType={addFavorite:"addFavorite",removeFavorite:"removeFavorite"};r.valuehelpdialog=r.valuehelpdialog||{};r.valuehelpdialog.ValueHelpRangeOperation={BT:"BT",EQ:"EQ",Contains:"Contains",StartsWith:"StartsWith",EndsWith:"EndsWith",LT:"LT",LE:"LE",GT:"GT",GE:"GE",Initial:"Initial",Empty:"Empty"};r.smartform.SmartFormValidationMode={Standard:"Standard",Async:"Async"};r.smartform.Importance={High:"High",Medium:"Medium",Low:"Low"};r.filterbar=r.filterbar||{};r.numericEdmTypes=["Edm.Int64","Edm.Decimal","Edm.Double","Edm.Single","Edm.Int32","Edm.Int16","Edm.Byte","Edm.SByte"];return r});
/*!
 * SAPUI5
 * (c) Copyright 2009-2023 SAP SE. All rights reserved.
 */
sap.ui.predefine("sap/ui/comp/navpopover/ContactDetailsController", ["sap/ui/comp/library","sap/ui/core/Element","sap/ui/layout/form/SimpleForm","sap/m/Title","sap/m/Label","sap/m/Text","sap/m/Image","sap/m/Link","sap/ui/base/ManagedObjectObserver","sap/ui/comp/odata/MetadataAnalyser","sap/base/Log","sap/ui/layout/library","sap/ui/core/library","sap/base/util/merge"],function(e,t,r,n,o,i,a,s,p,u,d,l,c,f){"use strict";var m=c.TitleLevel;var h=l.form.SimpleFormLayout;var v=t.extend("sap.ui.comp.navpopover.ContactDetailsController",{metadata:{library:"sap.ui.comp"}});v.prototype.init=function(){this._oObserver=null};v.prototype.exit=function(){if(this._oObserver){this._oObserver.disconnect();this._oObserver=null}};v.prototype.getBindingPath4ContactAnnotation=function(e,t,r){if(t===undefined||t===null||!e){return Promise.resolve(null)}if(!this.getModel()){return Promise.resolve(null)}if(!this.getModel().getMetaModel()){return Promise.resolve(null)}var n=this.getModel().getMetaModel();return n.loaded().then(function(){var o;try{n.getMetaContext(e)}catch(t){d.error("sap.ui.comp.navpopover.ContactDetailsController.getBindingPath4ContactAnnotation: binding path '"+e+"' is not valid. Error has been caught: "+t);return null}try{o="/"+t+"('"+r+"')";n.getMetaContext(o);return o}catch(e){}try{o=t?e+"/"+t:e;n.getMetaContext(o);return o}catch(r){d.error("sap.ui.comp.navpopover.ContactDetailsController.getBindingPath4ContactAnnotation: the path of sContactAnnotationPath '"+e+"/"+t+"' is not valid. Error has been caught: "+r);return null}})};v.prototype.getContactDetailsAnnotation=function(e){if(!e){return null}var t=new u(this.getModel());var r=t.getContactAnnotation(e);if(!r){return null}return r};v.prototype.getContactDetailsContainers=function(e){var t=this.getContactDetailsAnnotation(e);if(!t){return[]}var o=[];var i=[];var a=[];var s;this._oObserver=new p(function(e){if(e.type==="property"&&e.name==="visible"){var t=false;for(var r=1;r<s.getContent().length;r++){if(s.getContent()[r].getLabelFor&&s.getContent()[r].getLabelFor()){continue}if(s.getContent()[r].getVisible()){t=true}}s.setVisible(t)}});var u=sap.ui.getCore().getLibraryResourceBundle("sap.ui.comp");this.addProperty2ExpandAndSelect("photo",t,e,i,a);this._addPhoto("photo",t,e,o,this._oObserver);this.addProperty2ExpandAndSelect("fn",t,e,i,a);this._addLabeledText("fn",u.getText("POPOVER_CONTACT_SECTION_NAME"),t,e,o,this._oObserver);this.addProperty2ExpandAndSelect("role",t,e,i,a);this._addLabeledText("role",u.getText("POPOVER_CONTACT_SECTION_ROLE"),t,e,o,this._oObserver);this.addProperty2ExpandAndSelect("title",t,e,i,a);this._addLabeledText("title",u.getText("POPOVER_CONTACT_SECTION_JOBTITLE"),t,e,o,this._oObserver);this.addProperty2ExpandAndSelect("org",t,e,i,a);this._addLabeledText("org",u.getText("POPOVER_CONTACT_SECTION_DEPARTMENT"),t,e,o,this._oObserver);this._addEmails(t,e,i,a,o,this._oObserver);this._addTels(t,e,i,a,o,this._oObserver);this._addAddresses(t,e,i,a,o,this._oObserver);if(!o.length){return[]}o.splice(0,0,new n({text:sap.ui.getCore().getLibraryResourceBundle("sap.ui.comp").getText("POPOVER_CONTACT_SECTION_TITLE"),level:m.H2}));s=new r({maxContainerCols:1,editable:false,layout:h.ResponsiveGridLayout,content:o});this._requestData(s,e,i,a);return[s]};v.prototype._addPhoto=function(e,t,r,n,o){if(!t[e]){return}var i=r+"/"+t[e].Path;if(this.isPropertyHidden(i)){return}var s=new a({src:{path:i},visible:{path:i,formatter:function(e){return!!e}},decorative:false});s.addStyleClass("sapUiIcon");s.addStyleClass("navigationPopoverThumbnail");o.observe(s,{properties:["visible"]});n.push(s)};v.prototype._addLabeledText=function(e,t,r,n,a,s){if(!r[e]){return}var p=n+"/"+r[e].Path;if(this.isPropertyHidden(p)){return}var u=new i({text:{path:p},visible:{path:p,formatter:function(e){return!!e}}});var d=new o({text:t,labelFor:u.getId()});s.observe(u,{properties:["visible"]});a.push(d);a.push(u)};v.prototype._addEmails=function(e,t,r,n,o,i){if(!e.email||!e.email.length){return}var a=sap.ui.getCore().getLibraryResourceBundle("sap.ui.comp");var s=f([],e.email);s.filter(function(e){return!e.processed&&e.type&&(e.type.EnumMember.indexOf("com.sap.vocabularies.Communication.v1.ContactInformationType/preferred")>-1||e.type.EnumMember.indexOf("com.sap.vocabularies.Communication.v1.ContactInformationType/work")>-1)}).sort(function(e,t){if(e.type.EnumMember.indexOf("com.sap.vocabularies.Communication.v1.ContactInformationType/preferred")>-1&&t.type.EnumMember.indexOf("com.sap.vocabularies.Communication.v1.ContactInformationType/preferred")<0){return-1}if(t.type.EnumMember.indexOf("com.sap.vocabularies.Communication.v1.ContactInformationType/preferred")>-1&&e.type.EnumMember.indexOf("com.sap.vocabularies.Communication.v1.ContactInformationType/preferred")<0){return 1}return 0}).forEach(function(e){this.addProperty2ExpandAndSelect("address",e,t,r,n);this._addLabeledEmail("address",a.getText("POPOVER_CONTACT_SECTION_EMAIL"),e,t,o,i);e.processed=true},this)};v.prototype._addTels=function(e,t,r,n,o,i){if(!e.tel||!e.tel.length){return}var a=sap.ui.getCore().getLibraryResourceBundle("sap.ui.comp");var s=f([],e.tel);s.filter(function(e){return!e.processed&&e.type&&e.type.EnumMember.indexOf("com.sap.vocabularies.Communication.v1.PhoneType/work")>-1}).sort(function(e,t){if(e.type.EnumMember.indexOf("com.sap.vocabularies.Communication.v1.PhoneType/preferred")>-1){return-1}if(t.type.EnumMember.indexOf("com.sap.vocabularies.Communication.v1.PhoneType/preferred")>-1){return 1}return 0}).forEach(function(e){this.addProperty2ExpandAndSelect("uri",e,t,r,n);this._addLabeledTel("uri",a.getText("POPOVER_CONTACT_SECTION_PHONE"),e,t,o,i);e.processed=true},this);s.filter(function(e){return!e.processed&&e.type&&e.type.EnumMember.indexOf("com.sap.vocabularies.Communication.v1.PhoneType/cell")>-1}).sort(function(e,t){if(e.type.EnumMember.indexOf("com.sap.vocabularies.Communication.v1.PhoneType/preferred")>-1){return-1}if(t.type.EnumMember.indexOf("com.sap.vocabularies.Communication.v1.PhoneType/preferred")>-1){return 1}return 0}).forEach(function(e){this.addProperty2ExpandAndSelect("uri",e,t,r,n);this._addLabeledTel("uri",a.getText("POPOVER_CONTACT_SECTION_MOBILE"),e,t,o,i);e.processed=true},this);s.filter(function(e){return!e.processed&&e.type&&e.type.EnumMember.indexOf("com.sap.vocabularies.Communication.v1.PhoneType/fax")>-1}).sort(function(e,t){if(e.type.EnumMember.indexOf("com.sap.vocabularies.Communication.v1.PhoneType/preferred")>-1){return-1}if(t.type.EnumMember.indexOf("com.sap.vocabularies.Communication.v1.PhoneType/preferred")>-1){return 1}return 0}).forEach(function(e){this.addProperty2ExpandAndSelect("uri",e,t,r,n);this._addLabeledTel("uri",a.getText("POPOVER_CONTACT_SECTION_FAX"),e,t,o,i);e.processed=true},this);s.filter(function(e){return!e.processed&&e.type&&e.type.EnumMember.indexOf("com.sap.vocabularies.Communication.v1.PhoneType/preferred")>-1}).forEach(function(e){this.addProperty2ExpandAndSelect("uri",e,t,r,n);this._addLabeledTel("uri",a.getText("POPOVER_CONTACT_SECTION_PHONE"),e,t,o,i);e.processed=true},this)};v.prototype._addAddresses=function(e,t,r,n,o,i){if(!e.adr||!e.adr.length){return}var a=sap.ui.getCore().getLibraryResourceBundle("sap.ui.comp");var s=f([],e.adr);s.filter(function(e){return!e.processed&&e.type&&(e.type.EnumMember.indexOf("com.sap.vocabularies.Communication.v1.ContactInformationType/preferred")>-1||e.type.EnumMember.indexOf("com.sap.vocabularies.Communication.v1.ContactInformationType/work")>-1)}).sort(function(e,t){if(e.type.EnumMember.indexOf("com.sap.vocabularies.Communication.v1.ContactInformationType/preferred")>-1&&t.type.EnumMember.indexOf("com.sap.vocabularies.Communication.v1.ContactInformationType/preferred")<0){return-1}if(t.type.EnumMember.indexOf("com.sap.vocabularies.Communication.v1.ContactInformationType/preferred")>-1&&e.type.EnumMember.indexOf("com.sap.vocabularies.Communication.v1.ContactInformationType/preferred")<0){return 1}return 0}).forEach(function(e){this._addLabeledAddress(a.getText("POPOVER_CONTACT_SECTION_ADR"),e,t,r,n,o,i);e.processed=true},this)};v.prototype._addLabeledAddress=function(e,t,r,n,a,s,p){var u=[];["street","code","locality","region","country"].forEach(function(e){this.addProperty2ExpandAndSelect(e,t,r,n,a);var o;if(t[e]){o=r+"/"+t[e].Path}u.push(o&&!this.isPropertyHidden(o)?{path:o}:{path:"$notExisting"})},this);if(!u.length){return}var d=new i({text:{parts:u,formatter:function(e,t,r,n,o){var i=[];if(e){i.push(e)}if(t&&r){i.push(t+" "+r)}else{if(t){i.push(t)}if(r){i.push(r)}}if(n){i.push(n)}if(o){i.push(o)}return i.join(", ")}},visible:{parts:u,formatter:function(e,t,r,n,o){return!!(e||t||r||n||o)}}});var l=new o({text:e,labelFor:d.getId()});p.observe(d,{properties:["visible"]});s.push(l);s.push(d)};v.prototype._addLabeledTel=function(e,t,r,n,i,a){if(!r[e]||!n){return}var p=n+"/"+r[e].Path;if(this.isPropertyHidden(p)){return}var u=new s({href:{path:p,formatter:function(e){return e?"tel:"+e:e}},text:{path:p},visible:{path:p,formatter:function(e){return!!e}}});var d=new o({text:t,labelFor:u.getId()});a.observe(u,{properties:["visible"]});i.push(d);i.push(u)};v.prototype._addLabeledEmail=function(e,t,r,n,i,a){if(!r[e]||!n){return}var p=n+"/"+r[e].Path;if(this.isPropertyHidden(p)){return}var u=new s({href:{path:p,formatter:function(e){return e?"mailto:"+e:e}},text:{path:p},visible:{path:p,formatter:function(e){return!!e}}});var d=new o({text:t,labelFor:u.getId()});a.observe(u,{properties:["visible"]});i.push(d);i.push(u)};v.prototype.addProperty2ExpandAndSelect=function(e,t,r,n,o){if(!t[e]||!r){return}var i=r+"/"+t[e].Path;if(!i){return}if(i.indexOf("/")!==0){throw"sap.ui.comp.navpopover.ContactDetailsController.addProperty2ExpandAndSelect: the path of sBindingPathOfProperty '"+i+"' is not valid."}var a=i.split("/");a.shift();a.shift();var s=a.join("/");if(s){o.push(s)}a.pop();var p=a.join("/");if(!p){return}var u=n.filter(function(e){return e===p});if(!u.length){n.push(p)}};v.prototype.isPropertyHidden=function(e){var t;if(!this.getModel()){d.error("sap.ui.comp.navpopover.ContactDetailsController.isPropertyHidden: the model does not exist");return false}if(!this.getModel().getMetaModel()){d.error("sap.ui.comp.navpopover.ContactDetailsController.isPropertyHidden: the model should be the ODataModel");return false}try{t=this.getModel().getMetaModel().getMetaContext(e)}catch(t){d.error("sap.ui.comp.navpopover.ContactDetailsController.isPropertyHidden: the path of property path '"+e+"' is not valid. Error has been caught: "+t);return false}var r=t.getProperty(t.getPath());return u.isHidden(r)};v.prototype._requestData=function(e,t,r,n){var o={};if(r.length){o.expand=r.join(",")}if(n.length){o.select=n.join(",")}var i="/"+t.split("/")[1];e.bindObject({path:i,parameters:o,events:{change:function(){e.invalidate()}}})};return v});
/*!
 * SAPUI5
 * (c) Copyright 2009-2023 SAP SE. All rights reserved.
 */
sap.ui.predefine("sap/ui/comp/navpopover/Factory", ["sap/ui/comp/library"],function(e){"use strict";var i={getUShellContainer:function(){return sap.ui.require("sap/ushell/Container")},getService:function(e,i){const r=this.getUShellContainer();if(!r){return i?Promise.resolve(null):null}switch(e){case"CrossApplicationNavigation":return i?r.getServiceAsync("CrossApplicationNavigation"):r.getService("CrossApplicationNavigation");case"URLParsing":return i?r.getServiceAsync("URLParsing"):r.getService("URLParsing");default:return i?Promise.resolve(null):null}}};return i},true);
/*!
 * SAPUI5
 * (c) Copyright 2009-2023 SAP SE. All rights reserved.
 */
sap.ui.predefine("sap/ui/comp/navpopover/FakeFlpConnector", ["sap/ui/thirdparty/jquery","./Factory"],function(jQuery,e){"use strict";function r(){}function t(e){return{hrefForExternal:function(e){if(!e||!e.target||!e.target.shellHash){return null}return e.target.shellHash},hrefForExternalAsync:function(e){if(!e||!e.target||!e.target.shellHash){return Promise.resolve(null)}return Promise.resolve(e.target.shellHash)},getDistinctSemanticObjects:function(){var r=[];for(var t in e){r.push(t)}var n=jQuery.Deferred();setTimeout(function(){n.resolve(r)},0);return n.promise()},getLinks:function(r){var t=[];if(!Array.isArray(r)){if(e[r.semanticObject]){t=e[r.semanticObject].links}else{t=[]}}else{r.forEach(function(r){if(e[r[0].semanticObject]){t.push([e[r[0].semanticObject].links])}else{t.push([[]])}})}var n=jQuery.Deferred();setTimeout(function(){n.resolve(t)},0);return n.promise()}}}function n(e){return{parseShellHash:function(r){var t=function(e){var t=e.filter(function(e){return e.intent===r});return t[0]};for(var n in e){var i=t(e[n].links);if(i){return{semanticObject:n,action:i.action}}}return{semanticObject:null,action:null}}}}r.enableFakeConnector=function(t){if(r.getServiceReal){return}r.getServiceReal=e.getService;e.getService=r._createFakeService(t)};r._createFakeService=function(e){return function(i,a){switch(i){case"CrossApplicationNavigation":return a?Promise.resolve(t(e)):t(e);case"URLParsing":return a?Promise.resolve(n(e)):n(e);default:return r.getServiceReal(i,a)}}};r.disableFakeConnector=function(){if(r.getServiceReal){e.getService=r.getServiceReal;r.getServiceReal=undefined}};return r},true);
/*!
 * SAPUI5
 * (c) Copyright 2009-2023 SAP SE. All rights reserved.
 */
sap.ui.predefine("sap/ui/comp/navpopover/FlexConnector", ["sap/ui/comp/library","sap/ui/comp/navpopover/flexibility/LinkFlex","sap/base/Log"],function(t,e,n){"use strict";var a=t.navpopover.ChangeHandlerType;return{createAndSaveChangesForControl:function(t,e,n){if(!t.length&&!e.length){return Promise.resolve()}return this._createChangesForControl(e.concat(t),n).then(function(t){return this._saveChangesForControl(n,t)}.bind(this),function(t){return Promise.reject(t)})},_getControlPersonalizationWriteAPI:function(){return sap.ui.getCore().loadLibrary("sap.ui.fl",{async:true}).then(function(){return new Promise(function(t){sap.ui.require(["sap/ui/fl/write/api/ControlPersonalizationWriteAPI"],function(e){t(e)})})})},discardChangesForControl:function(t){return this._getControlPersonalizationWriteAPI().then(function(e){return e.reset({selectors:[t]})})},_saveChangesForControl:function(t,e){return this._getControlPersonalizationWriteAPI().then(function(n){return n.save({selector:t,changes:e})})},_createChangesForControl:function(t,e){if(!t.length){return[]}var n=[];t.forEach(function(t){var r={selectorElement:e,changeSpecificData:{changeType:t.visible?a.addLink:a.removeLink,content:t,isUserDependent:true}};n.push(r)});return this._getControlPersonalizationWriteAPI().then(function(t){return t.add({changes:n})})},activateApplyChangeStatistics:function(){var t=this;this.aStatistics=[];var n=function(e,n){if(t.aStatistics.findIndex(function(t){return t.stableId===n.getId()&&t.changeId===e.getId()})<0){var a=n.getAvailableActions().find(function(t){return t.getKey()===e.getContent().key});t.aStatistics.push({stableId:n.getId(),changeId:e.getId(),layer:e.getLayer(),key:e.getContent().key,text:a?a.getText():"",changeType:e.getChangeType()})}};var a=function(e){t.aStatistics=t.aStatistics.filter(function(t){return t.layer!==e})};var r=e.applyChange.bind(e);e.applyChange=function(t,e,a){n(t,e);r(t,e,a)};var i=e.discardChangesOfLayer.bind(e);e.discardChangesOfLayer=function(t,e){a(t);i(t,e)}},_formatStatistic:function(t){var e=t.layer;switch(t.layer){case"VENDOR":e=""+e;break;case"CUSTOMER":e="        "+e;break;case"USER":e="                "+e;break;default:e=""+e}var n;switch(t.changeType){case a.addLink:n="On";break;case a.removeLink:n="Off";break;default:n=""}return{formattedLayer:e,formattedValue:n}},printStatisticAll:function(){if(!this.aStatistics){n.info("Please activate with sap.ui.comp.navpopover.FlexConnector.activateApplyChangeStatistics()");return}var t=this;n.info("idx - VENDOR ------------ CUSTOMER ----------- USER --------------------------------------");this.aStatistics.forEach(function(e,a){var r=t._formatStatistic(e);n.info(a+" "+e.stableId+" "+r.formattedLayer+" '"+e.text+"' "+r.formattedValue)})}}},true);
/*!
 * SAPUI5
 * (c) Copyright 2009-2023 SAP SE. All rights reserved.
 */
sap.ui.predefine("sap/ui/comp/navpopover/LinkData", ["sap/ui/comp/library","sap/ui/core/Element"],function(e,t){"use strict";var i=t.extend("sap.ui.comp.navpopover.LinkData",{metadata:{library:"sap.ui.comp",properties:{text:{type:"string",defaultValue:null},href:{type:"string",defaultValue:null},internalHref:{type:"string",defaultValue:null},target:{type:"string",defaultValue:null},description:{type:"string",defaultValue:undefined},visible:{type:"boolean",defaultValue:true},key:{type:"string",defaultValue:undefined},press:{type:"object",defaultValue:null},isSuperiorAction:{type:"boolean"},visibleChangedByUser:{type:"boolean"}}}});i.prototype.getJson=function(){return{key:this.getKey(),href:this.getHref(),internalHref:this.getInternalHref(),text:this.getText(),target:this.getTarget(),description:this.getDescription(),visible:this.getVisible(),press:this.getPress(),isSuperiorAction:this.getIsSuperiorAction()}};i.convert2Json=function(e){return e.map(function(e){return e.getJson()})};return i});
/*!
 * SAPUI5
 * (c) Copyright 2009-2023 SAP SE. All rights reserved.
 */
sap.ui.predefine("sap/ui/comp/navpopover/Log", ["sap/ui/base/Object","sap/ui/thirdparty/jquery"],function(t,jQuery){"use strict";var e=t.extend("sap.ui.comp.navpopover.Log",{constructor:function(){this.reset()}});e.prototype.reset=function(){this._oLog={semanticObjects:[],intents:[]};return this};e.prototype.createSemanticObjectStructure=function(t){this._oLog.semanticObjects[t]={attributes:{},intents:[]}};e.prototype.addIntent=function(t){this._oLog.intents.push(t);return this};e.prototype.addSemanticObjectAttribute=function(t,e,n){if(!this._oLog.semanticObjects[t]){this.createSemanticObjectStructure(t)}this._oLog.semanticObjects[t].attributes[e]=n;return this};e.prototype.addSemanticObjectIntent=function(t,e){if(!this._oLog.semanticObjects[t]){this.createSemanticObjectStructure(t)}this._oLog.semanticObjects[t].intents.push(e);return this};e.prototype.updateSemanticObjectAttributes=function(t,e,n){if(!this._oLog.semanticObjects[t]){this.createSemanticObjectStructure(t)}var i,r;var o=Object.keys(n);for(var s in n){if(this._oLog.semanticObjects[t].attributes[s]){i=this._oLog.semanticObjects[t].attributes[s].transformations;r=i[i.length-1];if(n[s]!==r["value"]){this._oLog.semanticObjects[t].attributes[s].transformations.push({value:n[s],description:" Value of the attribute has been changed in an event handler.",reason:" Is changed in the event handler of the event BeforePopoverOpens for the SmartLink control. Please check the implementation if the result is not what you expected."})}}else{this.addSemanticObjectAttribute(t,s,{transformations:[{value:n[s],description:" The attribute has been added in an event handler.",reason:" Is added in the event handler of the event BeforePopoverOpens for the SmartLink control. Please check the implementation if the result is not what you expected."}]})}}for(var a in e){if(o.indexOf(a)<0&&this._oLog.semanticObjects[t].attributes[a]){this._oLog.semanticObjects[t].attributes[a].transformations.push({value:undefined,description:" The attribute has been removed in an event handler.",reason:" Is removed in the event handler of the event BeforePopoverOpens for the SmartLink control. Please check the implementation if the result is not what you expected."})}}return this};e.prototype.getFormattedText=function(){var t=function(t){return typeof t==="string"?"'"+t+"'":t};var e=function(e,n){var i={value:" "+n+" : ",description:""};e.forEach(function(e,n){i.value=i.value+(n>0?"    ":"")+t(e["value"]);i.description=i.description+"   "+e["description"]+"\n";if(e["reason"]){i.description=i.description+"   "+e["reason"]+"\n"}});return i};var n=function(t){var e="";t.forEach(function(t){e+=" '"+t.text+"' : "+t.intent+"\n"});return e};var i=function(t){try{var e=sap.ui.getCore().getConfiguration().getLocale().toString();if(typeof window.Intl!=="undefined"){var n=window.Intl.Collator(e,{numeric:true});t.sort(function(t,e){return n.compare(t,e)})}else{t.sort(function(t,n){return t.localeCompare(n,e,{numeric:true})})}}catch(t){}};var r="";for(var o in this._oLog.semanticObjects){r=r+"\n"+" "+o+"\n";if(jQuery.isEmptyObject(this._oLog.semanticObjects[o].attributes)){r+="   No semantic attributes available for semantic object "+o+". Please be aware "+"that without semantic attributes no URL parameters can be created.\n"}else{var s=Object.keys(this._oLog.semanticObjects[o].attributes);i(s);for(var a=0;a<s.length;a++){var c=s[a];var u=e(this._oLog.semanticObjects[o].attributes[c].transformations,c);r+=u.value+"\n";r+=u.description}}if(this._oLog.semanticObjects[o].intents.length){r+="\nIntents returned by FLP for semantic object "+o+":\n";r+=n(this._oLog.semanticObjects[o].intents)}}if(this._oLog.intents.length){r+="\nIntents returned by event handler:\n";r+=n(this._oLog.intents)}return r};return e});
/*!
 * SAPUI5
 * (c) Copyright 2009-2023 SAP SE. All rights reserved.
 */
sap.ui.predefine("sap/ui/comp/navpopover/NavigationContainer", ["sap/m/Link","sap/ui/core/Control","sap/m/VBox","sap/m/HBox","sap/m/Button","sap/m/Title","sap/ui/core/library","sap/m/Image","sap/m/Text","sap/ui/layout/form/SimpleForm","./Factory","./LinkData","sap/ui/model/json/JSONModel","./Util","sap/ui/layout/HorizontalLayout","sap/ui/layout/VerticalLayout","sap/ui/layout/library","sap/ui/comp/personalization/Util","sap/ui/base/ManagedObjectObserver","sap/m/FlexItemData","sap/ui/model/BindingMode","sap/m/library","sap/ui/comp/personalization/Controller","sap/ui/comp/personalization/SelectionWrapper","sap/ui/comp/personalization/ColumnWrapper","sap/base/Log","sap/ui/core/CustomData","sap/ui/core/Component"],function(e,t,i,n,a,o,r,s,l,p,u,v,c,g,h,f,d,b,y,m,A,C,_,P,k,I,L,x){"use strict";var N=d.form.SimpleFormLayout;var S=C.FlexJustifyContent;var w=C.ButtonType;var M=r.TitleLevel;var D=i.extend("sap.ui.comp.navpopover.NavigationContainer",{metadata:{library:"sap.ui.comp",properties:{mainNavigationId:{type:"string",group:"Misc",defaultValue:null},enableAvailableActionsPersonalization:{type:"boolean",defaultValue:true}},aggregations:{availableActions:{type:"sap.ui.comp.navpopover.LinkData",multiple:true,singularName:"availableAction"},mainNavigation:{type:"sap.ui.comp.navpopover.LinkData",multiple:false}},associations:{extraContent:{type:"sap.ui.core.Control",multiple:false},component:{type:"sap.ui.core.Element",multiple:false},control:{type:"sap.ui.core.Control",multiple:false}},events:{navigate:{},beforePopoverOpen:{},afterPopoverClose:{}}},renderer:{apiVersion:2}});D.prototype.init=function(){i.prototype.init.call(this);var e=new c({mainNavigationLink:{title:undefined,subtitle:undefined,href:undefined,target:undefined},availableActions:[],enableAvailableActionsPersonalization:undefined,extraContent:undefined,initialAvailableActions:[]});e.setDefaultBindingMode(A.TwoWay);e.setSizeLimit(1e3);this.setModel(e,"$sapuicompNavigationContainer");this._oObserver=new y(this._observeChanges.bind(this));this._oAvailableActionsObserver=new y(this._observeAvailableActionsChanges.bind(this));this._oAvailableActionsObserver.observe(this,{aggregations:["availableActions"]});this.oPersonalizationController=null};D.prototype.applySettings=function(){i.prototype.applySettings.apply(this,arguments);this._createContent()};D.prototype.exit=function(e){if(this._getInternalModel()){this._getInternalModel().destroy()}if(this._oObserver){this._oObserver.disconnect();this._oObserver=null}if(this._oAvailableActionsObserver){this._oAvailableActionsObserver.disconnect();this._oAvailableActionsObserver=null}this._oDefaultExtraConent=null;this._oSeparator=null};D.prototype.openSelectionDialog=function(e,t,i,n,a,o){this.fireBeforePopoverOpen();return this._getFlexRuntimeInfoAPI().then(function(n){return n.waitForChanges({element:this}).then(function(){return new Promise(function(n){var r=this._getInternalModel();var s=g.getStorableAvailableActions(r.getProperty("/initialAvailableActions"));var l=g.getStorableAvailableActions(r.getProperty("/availableActions")).map(function(e){return{columnKey:e.key,visible:e.visible}});var p=new P({press:function(e){this._onLinkPress(e)}.bind(this),columns:s.map(function(t){return new k({label:t.text,selected:t.visible,href:e?undefined:t.href,internalHref:e?undefined:t.internalHref,target:t.target,description:t.description,customData:new L({key:"p13nData",value:{columnKey:t.key}})})})});p._container=this;if(!this.oPersonalizationController){this.oPersonalizationController=new _({resetToInitialTableState:true,table:p,setting:{selection:{visible:true,payload:{callbackSaveChanges:function(e){var t=e&&e.selection&&e.selection.selectionItems||[];if(i){i(t.map(function(e){return{key:e.columnKey,visible:e.visible}}));return Promise.resolve(true)}var n=[];var a=[];t.forEach(function(e){if(e.visible===true){n.push({key:e.columnKey,visible:e.visible})}else{a.push({key:e.columnKey,visible:e.visible})}});return D._saveChanges(n,a,this).then(function(){return true})}.bind(this)}}},dialogConfirmedReset:function(){D._discardChanges(this)}.bind(this),dialogAfterClose:function(){this.fireAfterPopoverClose();n()}.bind(this)})}this.oPersonalizationController.setPersonalizationData({selection:{selectionItems:l}});this.oPersonalizationController.openDialog({contentWidth:"28rem",contentHeight:"35rem",styleClass:""+a,showReset:t,selection:{visible:true}}).then(function(){var e=this.oPersonalizationController._oDialog;if(o){o.addDependent(e)}n()}.bind(this))}.bind(this))}.bind(this))}.bind(this))};D._discardChanges=function(e){return new Promise(function(t){sap.ui.getCore().loadLibrary("sap.ui.fl",{async:true}).then(function(){sap.ui.require(["sap/ui/comp/navpopover/FlexConnector"],function(i){return i.discardChangesForControl(e).then(function(){return t(true)},function(e){I.error("Changes could not be discarded in LRep: "+e);return t(false)})})})})};D._saveChanges=function(e,t,i){return new Promise(function(n){sap.ui.getCore().loadLibrary("sap.ui.fl",{async:true}).then(function(){sap.ui.require(["sap/ui/comp/navpopover/FlexConnector"],function(a){return a.createAndSaveChangesForControl(e,t,i).then(function(){return n(true)},function(e){I.error("Changes could not be saved in LRep: "+e);return n(false)})})})})};D.prototype.getDirectLink=function(){var e=this._getInternalModel();if(e.getProperty("/extraContent")){return null}if(e.getProperty("/mainNavigationLink/href")&&!e.getProperty("/availableActions").length){return this._oHeaderArea.getItems()[0].getContent()}if(e.getProperty("/availableActions").length===1&&!e.getProperty("/mainNavigationLink/href")){return this._oActionArea.getItems()[0].getItems()[0]}return null};D.prototype.hasContent=function(){var e=this._getInternalModel();return!!e.getProperty("/mainNavigationLink/href")||!!e.getProperty("/availableActions").length||!!e.getProperty("/extraContent")};D.prototype.setExtraContent=function(e){this.setAssociation("extraContent",e);if(!e){return this}var t=this._getInternalModel();if(t.getProperty("/extraContent")){this.removeItem(1)}if(typeof e==="string"){e=sap.ui.getCore().byId(e)}this.insertItem(e,1);t.setProperty("/extraContent",e);return this};D.prototype.setMainNavigationId=function(e){this.setProperty("mainNavigationId",e,true);var t=this._getInternalModel();if(typeof e==="string"){t.setProperty("/mainNavigationLink/title",e)}return this};D.prototype.setMainNavigation=function(e){this.setAggregation("mainNavigation",e,true);if(!e){return this}var t=this._getInternalModel();if(e.getHref()){t.setProperty("/mainNavigationLink/href",e.getHref());t.setProperty("/mainNavigationLink/internalHref",e.getInternalHref());t.setProperty("/mainNavigationLink/target",e.getTarget())}if(!t.getProperty("/mainNavigationLink/title")&&t.getProperty("/mainNavigationLink/title")!==""){t.setProperty("/mainNavigationLink/title",e.getText())}t.setProperty("/mainNavigationLink/subtitle",e.getDescription());return this};D.prototype.setEnableAvailableActionsPersonalization=function(e){this.setProperty("enableAvailableActionsPersonalization",e,true);this._getInternalModel().setProperty("/enableAvailableActionsPersonalization",e);return this};D.prototype.onAfterRenderingActionForm=function(){var e=this._getInternalModel();var t=e.getProperty("/extraContent")?e.getProperty("/extraContent").$()[0]:undefined;if(t&&t.scrollHeight>t.clientHeight){this.setFitContainer(false).setJustifyContent(S.Start)}};D.prototype._getFlexRuntimeInfoAPI=function(){return sap.ui.getCore().loadLibrary("sap.ui.fl",{async:true}).then(function(){return new Promise(function(e){sap.ui.require(["sap/ui/fl/apply/api/FlexRuntimeInfoAPI"],function(t){e(t)})})})};D.prototype._createContent=function(){this.addStyleClass("navigationPopover");this._oHeaderArea=this._createHeaderArea();this._oDefaultExtraConent=new p({layout:N.ResponsiveGridLayout,content:[new o({text:sap.ui.getCore().getLibraryResourceBundle("sap.ui.comp").getText("POPOVER_MSG_NO_CONTENT")})]});this._oDefaultExtraConent.addStyleClass("navigationPopoverDefaultExtraContent");this._oSeparator=new i({visible:false});this._oSeparator.addStyleClass("navigationPopoverSeparator");this._oActionArea=new i({items:{path:"/availableActions",templateShareable:false,factory:function(t,n){var a=new e({visible:"{visible}",text:"{text}",href:"{href}",target:"{target}",press:n.getProperty("press"),wrapping:true});var o=new L({key:"internalHref",value:"{internalHref}"});a.addCustomData(o);this._oObserver.observe(a,{bindings:["visible"],properties:["visible"]});return new i({visible:"{visible}",layoutData:new m({styleClass:n.getProperty("description")?"navigationPopoverAvailableLinkGroup":"navigationPopoverAvailableLinkWithoutGroup"}),items:[a,new l({visible:"{visible}",text:"{description}"})]})}.bind(this)}});this._oActionArea.addEventDelegate({onAfterRendering:this.onAfterRenderingActionForm.bind(this)});this._oActionArea.addStyleClass("navigationPopoverAvailableLinks");this._oPersonalizationButton=new n({visible:{parts:[{path:"/enableAvailableActionsPersonalization"}],formatter:function(e){return!!e}},justifyContent:"End",items:new a({type:w.Transparent,text:sap.ui.getCore().getLibraryResourceBundle("sap.ui.comp").getText("POPOVER_DEFINE_LINKS"),press:function(e){this.openSelectionDialog(false,true,undefined,true,undefined,e.getSource())}.bind(this)})});this._oPersonalizationButton.addStyleClass("navigationPopoverPersonalizationButton");this.setFitContainer(true);this.setJustifyContent(S.Start);this.addItem(this._oHeaderArea).addItem(this._getInternalModel().getProperty("/extraContent")||this._oDefaultExtraConent).addItem(this._oSeparator).addItem(this._oActionArea).addItem(this._oPersonalizationButton);this._oHeaderArea.setModel(this._getInternalModel());this._oSeparator.setModel(this._getInternalModel());this._oActionArea.setModel(this._getInternalModel());this._oPersonalizationButton.setModel(this._getInternalModel())};D.prototype._createHeaderArea=function(){var e=this._createTitle();var t=this._createSubTitle();var n=new i({items:[e,t],visible:{path:"/mainNavigationLink/title",formatter:function(e){return!!e}}});n.addStyleClass("navigationPopoverTitleH1");n.addStyleClass("navigationPopoverHeader");return n};D.prototype._createSubTitle=function(){var e=new l({text:{path:"/mainNavigationLink/subtitle"},visible:{path:"/mainNavigationLink/subtitle",formatter:function(e){return!!e}}});return e};D.prototype._createTitle=function(){var t=new e({href:{path:"/mainNavigationLink/href"},text:{path:"/mainNavigationLink/title"},target:{path:"/mainNavigationLink/target"},visible:{path:"/mainNavigationLink/title",formatter:function(e){return!!e}},enabled:{path:"/mainNavigationLink/href",formatter:function(e){return!!e}},press:this._onLinkPress.bind(this),wrapping:true});var i=new L({key:"internalHref",value:"{/mainNavigationLink/internalHref}"});t.addCustomData(i);var n=new o({level:M.Auto,content:t});n.addStyleClass("sapFontHeader5Size");this._oObserver.observe(n,{bindings:["visible"],properties:["visible"]});return n};D.prototype._getControl=function(){var e=this.getAssociation("control");if(typeof e==="string"){e=sap.ui.getCore().byId(e)}return e};D.prototype._onLinkPress=function(e){var t=e.getId()==="press"?e.getSource():e.getParameters().getSource();var i=e.getParameters().ctrlKey||e.getParameters().metaKey;if(t.getTarget()!=="_blank"&&!i){e.preventDefault();this.fireNavigate({text:t.getText(),href:t.getHref(),internalHref:t.data("internalHref")})}};D.prototype._getComponent=function(){var e=this.getComponent();if(typeof e==="string"){e=x.get(e)}return e};D.prototype._observeAvailableActionsChanges=function(e){var t;if(e.object.isA("sap.ui.comp.navpopover.NavigationContainer")){switch(e.name){case"availableActions":t=this._getInternalModel();var i=e.child?[e.child]:e.children;i.forEach(function(i){switch(e.mutation){case"insert":if(!i||!i.isA("sap.ui.comp.navpopover.LinkData")){return}i.setPress(this._onLinkPress.bind(this));this._oAvailableActionsObserver.observe(i,{properties:["visible"]});t.setProperty("/initialAvailableActions/"+this.indexOfAvailableAction(i)+"/",i.getJson());t.setProperty("/availableActions/"+this.indexOfAvailableAction(i)+"/",i.getJson());break;case"remove":I.error("Deletion of AvailableActions is not supported");break;default:I.error("Mutation '"+e.mutation+"' is not supported jet.")}}.bind(this));break;default:I.error("The '"+e.name+"' of NavigationContainer is not supported yet.")}}else if(e.object.isA("sap.ui.comp.navpopover.LinkData")){switch(e.name){case"visible":var n=e.object;t=this._getInternalModel();var a=-1;t.getProperty("/availableActions").some(function(e,t){if(n.getKey()===e.key){a=t;return true}});if(a<0){I.error("The available action with key '"+n.getKey()+"' does not exist in availableActions.")}if(n.getVisibleChangedByUser()){t.setProperty("/availableActions/"+a+"/visible",n.getVisible())}else{t.setProperty("/initialAvailableActions/"+a+"/visible",n.getVisible());t.setProperty("/availableActions/"+a+"/visible",n.getVisible())}break;default:I.error("The '"+e.name+"' of LinkData is not supported yet.")}}};D.prototype._observeChanges=function(e){if((e.type==="property"||e.type==="binding")&&e.name==="visible"){var t=this._getInternalModel().getProperty("/availableActions");var i=t.filter(function(e){return e.visible===true});this._oSeparator.setVisible(i.length>0||!!this._getInternalModel().getProperty("/enableAvailableActionsPersonalization"));this._oActionArea.setVisible(i.length>0);if(this.hasContent()&&!this._getInternalModel().getProperty("/extraContent")){this._oDefaultExtraConent.setVisible(false)}}};D.prototype._getInternalModel=function(){return this.getModel("$sapuicompNavigationContainer")};return D});
/*!
 * SAPUI5
 * (c) Copyright 2009-2023 SAP SE. All rights reserved.
 */
sap.ui.predefine("sap/ui/comp/navpopover/NavigationPopover", ["sap/m/Link","sap/m/ResponsivePopover","sap/m/Button","sap/m/Title","sap/m/Image","sap/m/Text","sap/m/VBox","sap/m/HBox","./Factory","./LinkData","sap/ui/model/json/JSONModel","sap/ui/base/ManagedObjectObserver","sap/m/FlexItemData","sap/ui/model/BindingMode","sap/ui/Device","sap/m/library","sap/base/Log","sap/ui/core/CustomData","sap/ui/core/Component"],function(t,e,n,i,a,o,r,s,l,p,h,g,u,v,c,d,f,b,y){"use strict";var m=d.PlacementType;var A=d.FlexJustifyContent;var P=d.ButtonType;var C=e.extend("sap.ui.comp.navpopover.NavigationPopover",{metadata:{library:"sap.ui.comp",properties:{semanticObjectName:{type:"string",group:"Misc",defaultValue:null},semanticAttributes:{type:"object",group:"Misc",defaultValue:null},appStateKey:{type:"string",group:"Misc",defaultValue:null},mainNavigationId:{type:"string",group:"Misc",defaultValue:null},availableActionsPersonalizationText:{type:"string",group:"Misc",defaultValue:undefined}},aggregations:{availableActions:{type:"sap.ui.comp.navpopover.LinkData",multiple:true,singularName:"availableAction"},mainNavigation:{type:"sap.ui.comp.navpopover.LinkData",multiple:false},ownNavigation:{type:"sap.ui.comp.navpopover.LinkData",multiple:false}},associations:{source:{type:"sap.ui.core.Control",multiple:false},extraContent:{type:"sap.ui.core.Control",multiple:false},component:{type:"sap.ui.core.Element",multiple:false}},events:{targetsObtained:{},navigate:{parameters:{text:{type:"string"},href:{type:"string"}}},availableActionsPersonalizationPress:{}}},renderer:{apiVersion:2}});C.prototype.init=function(){e.prototype.init.call(this);var t=new h({mainNavigationLink:{title:undefined,subtitle:undefined,href:undefined,target:undefined},ownNavigation:undefined,availableActions:[],availableActionsPersonalizationText:undefined,extraContent:undefined});t.setDefaultBindingMode(v.TwoWay);t.setSizeLimit(1e3);this.setModel(t,"$sapuicompNavigationPopover");this._bUseExternalContent=false;this.addStyleClass("navigationPopover");this.setContentWidth("380px");this.setHorizontalScrolling(false);this.setShowHeader(c.system.phone);this.setPlacement(m.Auto);this._oObserver=null};C.prototype.applySettings=function(t){if(t&&t.customData&&t.customData.getProperty("key")==="useExternalContent"){this._bUseExternalContent=true}this._createContent();e.prototype.applySettings.apply(this,arguments)};C.prototype.exit=function(t){if(this._getInternalModel()){this._getInternalModel().destroy()}if(this._oObserver){this._oObserver.disconnect();this._oObserver=null}e.prototype.exit.apply(this,arguments)};C.prototype.retrieveNavTargets=function(){f.warning("sap.ui.comp.navpopover.NavigationPopover#retrieveNavTargets called. This function is deprecated since UI5 version 1.42!");var t=l.getService("CrossApplicationNavigation");var e=l.getService("URLParsing");if(!t||!e){f.error("Service 'CrossApplicationNavigation' could not be obtained");this.fireTargetsObtained();return}var n=this;this.setMainNavigation(null);this.setOwnNavigation(null);this.removeAllAvailableActions();var i=t.getLinks({semanticObject:this.getSemanticObjectName(),params:this.getSemanticAttributes(),appStateKey:this.getAppStateKey(),ui5Component:this._getComponent(),sortResultOnTexts:true});i.done(function(i){if(!i||!i.length){n.fireTargetsObtained();return}var a=t.hrefForExternal();if(a&&a.indexOf("?")!==-1){a=a.split("?")[0]}i.forEach(function(t){if(t.intent.indexOf(a)===0){n.setOwnNavigation(new p({href:t.intent,text:t.text}));return}var i=e.parseShellHash(t.intent);if(i.action&&i.action==="displayFactSheet"){n.setMainNavigation(new p({href:t.intent,text:sap.ui.getCore().getLibraryResourceBundle("sap.ui.comp").getText("POPOVER_FACTSHEET")}));return}n.addAvailableAction(new p({href:t.intent,text:t.text}))});n.fireTargetsObtained()});i.fail(function(){f.error("'retrieveNavTargets' failed")})};C.prototype.show=function(t){var e=t||this._getControl();if(!e){f.error("no source assigned");return}this.openBy(e)};C.prototype.getDirectLink=function(){if(this._bUseExternalContent){return this.getContent()[0].getDirectLink()}var t=this._getInternalModel();if(t.getProperty("/extraContent")){return null}if(t.getProperty("/mainNavigationLink/href")&&!t.getProperty("/availableActions").length){return this._oHeaderArea.getItems()[0]}if(t.getProperty("/availableActions").length===1&&!t.getProperty("/mainNavigationLink/href")){return this._oActionArea.getItems()[0].getItems()[0]}return null};C.prototype.hasContent=function(){if(this._bUseExternalContent){return this.getContent()[0].hasContent()}var t=this._getInternalModel();return!!t.getProperty("/mainNavigationLink/href")||!!t.getProperty("/availableActions").length||!!t.getProperty("/extraContent")};C.prototype.setMainNavigationId=function(t){if(this._bUseExternalContent){throw"The API should not be used in case that the external content has been set"}this.setProperty("mainNavigationId",t,true);var e=this._getInternalModel();if(typeof t==="string"){e.setProperty("/mainNavigationLink/title",t)}return this};C.prototype.setAvailableActionsPersonalizationText=function(t){if(this._bUseExternalContent){throw"The API should not be used in case that the external content has been set"}this.setProperty("availableActionsPersonalizationText",t,true);var e=this._getInternalModel();e.setProperty("/availableActionsPersonalizationText",t);return this};C.prototype.setExtraContent=function(t){if(this._bUseExternalContent){throw"The API should not be used in case that the external content has been set"}var e=this._getInternalModel();if(e.getProperty("/extraContent")){this._getContentContainer().removeItem(1)}if(typeof t==="string"){t=sap.ui.getCore().byId(t)}this._getContentContainer().insertItem(t,1);this.setAssociation("extraContent",t);e.setProperty("/extraContent",t);return this};C.prototype.setMainNavigation=function(t){if(this._bUseExternalContent){throw"The API should not be used in case that the external content has been set"}this.setAggregation("mainNavigation",t,true);if(!t){return this}var e=this._getInternalModel();if(t.getHref()){e.setProperty("/mainNavigationLink/href",t.getHref());e.setProperty("/mainNavigationLink/internalHref",t.getInternalHref());e.setProperty("/mainNavigationLink/target",t.getTarget())}if(!e.getProperty("/mainNavigationLink/title")&&e.getProperty("/mainNavigationLink/title")!==""){e.setProperty("/mainNavigationLink/title",t.getText())}e.setProperty("/mainNavigationLink/subtitle",t.getDescription());return this};C.prototype.addAvailableAction=function(t){if(this._bUseExternalContent){throw"The API should not be used in case that the external content has been set"}this.addAggregation("availableActions",t);if(!t){return this}t.setPress(this._onLinkPress.bind(this));var e=this._getInternalModel();e.setProperty("/availableActions/"+this.indexOfAvailableAction(t)+"/",t.getJson());return this};C.prototype.insertAvailableAction=function(t,e){if(this._bUseExternalContent){throw"The API should not be used in case that the external content has been set"}this.insertAggregation("availableActions",t,e);if(!t){return this}t.setPress(this._onLinkPress.bind(this));var n=this._getInternalModel();this.getAvailableActions().forEach(function(t,e){n.setProperty("/availableActions/"+e+"/",t.getJson())});return this};C.prototype.removeAvailableAction=function(t){if(this._bUseExternalContent){throw"The API should not be used in case that the external content has been set"}var e=this.indexOfAvailableAction(t);if(e>-1){var n=this._getInternalModel();n.getData().availableActions.splice(e,1);n.refresh(true)}t=this.removeAggregation("availableActions",t);return t};C.prototype.removeAllAvailableActions=function(){if(this._bUseExternalContent){throw"The API should not be used in case that the external content has been set"}var t=this.removeAllAggregation("availableActions");var e=this._getInternalModel();e.setProperty("/availableActions",[]);e.refresh(true);return t};C.prototype.onAfterRenderingActionForm=function(){var t=this._getInternalModel();var e=t.getProperty("/extraContent")?t.getProperty("/extraContent").$()[0]:undefined;if(e&&e.scrollHeight>e.clientHeight){this._getContentContainer().setFitContainer(false).setJustifyContent(A.Start)}};C.prototype._createContent=function(){if(this._bUseExternalContent){return}var e=this;var i=new t({href:{path:"/mainNavigationLink/href"},text:{path:"/mainNavigationLink/title"},target:{path:"/mainNavigationLink/target"},visible:{path:"/mainNavigationLink/title",formatter:function(t){return!!t}},enabled:{path:"/mainNavigationLink/href",formatter:function(t){return!!t}},press:this._onLinkPress.bind(this),wrapping:true});var a=new b({key:"internalHref",value:"/mainNavigationLink/internalHref"});i.addCustomData(a);i.addStyleClass("sapFontHeader5Size");var l=new o({text:{path:"/mainNavigationLink/subtitle"},visible:{path:"/mainNavigationLink/subtitle",formatter:function(t){return!!t}}});this._oHeaderArea=new r({items:[i,l],visible:{path:"/mainNavigationLink/title",formatter:function(t){return!!t}}});this._oHeaderArea.addStyleClass("navigationPopoverTitleH1");this._oHeaderArea.addStyleClass("navigationPopoverHeader");this._oHeaderArea.setModel(this._getInternalModel());this._oObserver=new g(function(t){if(t.type==="property"&&t.name==="visible"){var e=this._getInternalModel().getProperty("/availableActions").filter(function(t){return t.visible===true});p.setVisible(e.length>0||this._getInternalModel().getProperty("/enableAvailableActionsPersonalization"));this._oActionArea.setVisible(e.length>0)}}.bind(this));var p=new r;p.setModel(this._getInternalModel());p.addStyleClass("navigationPopoverSeparator");this._oActionArea=new r({items:{path:"/availableActions",templateShareable:false,factory:function(e,n){var i=new t({visible:"{visible}",text:"{text}",href:"{href}",target:"{target}",press:n.getProperty("press"),wrapping:true});var a=new b({key:"internalHref",value:"{internalHref}"});i.addCustomData(a);this._oObserver.observe(i,{properties:["visible"]});return new r({visible:"{visible}",layoutData:new u({styleClass:n.getProperty("description")?"navigationPopoverAvailableLinkGroup":"navigationPopoverAvailableLinkWithoutGroup"}),items:[i,new o({visible:"{visible}",text:"{description}"})]})}.bind(this)}});this._oActionArea.addEventDelegate({onAfterRendering:this.onAfterRenderingActionForm.bind(this)});this._oActionArea.addStyleClass("navigationPopoverAvailableLinks");this._oActionArea.setModel(this._getInternalModel());this._oPersonalizationButton=new s({visible:{parts:[{path:"/enableAvailableActionsPersonalization"}],formatter:function(t){return!!t}},justifyContent:"End",items:new n({type:P.Transparent,text:{path:"/availableActionsPersonalizationText"},press:function(){e.fireAvailableActionsPersonalizationPress()}})});this._oPersonalizationButton.setModel(this._getInternalModel());this._oPersonalizationButton.addStyleClass("navigationPopoverPersonalizationButton");var h=new r({fitContainer:true,justifyContent:A.Start,items:[this._oHeaderArea]});if(this._getInternalModel().getProperty("/extraContent")){h.addItem(this._getInternalModel().getProperty("/extraContent"))}h.addItem(p).addItem(this._oActionArea).addItem(this._oPersonalizationButton);this.addContent(h)};C.prototype._onLinkPress=function(t){this.fireNavigate({text:t.getSource().getText(),href:t.getSource().getHref(),internalHref:t.getSource().data("internalHref")})};C.prototype._getControl=function(){var t=this.getAssociation("source");if(typeof t==="string"){t=sap.ui.getCore().byId(t)}return t};C.prototype._getComponent=function(){var t=this.getComponent();if(typeof t==="string"){t=y.get(t)}return t};C.prototype._getContentContainer=function(){return this.getContent()[0]};C.prototype._getInternalModel=function(){return this.getModel("$sapuicompNavigationPopover")};return C});
/*!
 * SAPUI5
 * (c) Copyright 2009-2023 SAP SE. All rights reserved.
 */
sap.ui.predefine("sap/ui/comp/navpopover/NavigationPopoverHandler", ["sap/ui/thirdparty/jquery","sap/ui/comp/library","sap/ui/base/ManagedObject","./SemanticObjectController","sap/ui/model/json/JSONModel","sap/ui/model/BindingMode","sap/ui/core/Control","./Factory","./NavigationPopover","./Util","sap/m/VBox","./LinkData","sap/m/MessageBox","sap/ui/comp/personalization/Controller","sap/ui/comp/personalization/Util","./NavigationContainer","./ContactDetailsController","./Log","sap/ui/core/InvisibleText","sap/ui/core/CustomData","sap/base/Log","sap/base/util/isPlainObject","sap/ui/core/Component","sap/base/util/merge","sap/base/strings/whitespaceReplacer"],function(jQuery,t,e,i,n,a,o,r,s,l,c,p,u,g,v,d,f,b,m,h,y,P,A,C,N){"use strict";var _=e.extend("sap.ui.comp.navpopover.NavigationPopoverHandler",{metadata:{library:"sap.ui.comp",properties:{semanticObject:{type:"string",defaultValue:null},additionalSemanticObjects:{type:"string[]",defaultValue:[]},semanticObjectController:{type:"any",defaultValue:null},fieldName:{type:"string",defaultValue:null},semanticObjectLabel:{type:"string",defaultValue:null},mapFieldToSemanticObject:{type:"boolean",defaultValue:true},contactAnnotationPath:{type:"string",defaultValue:undefined},enableAvailableActionsPersonalization:{type:"boolean",defaultValue:true},beforeNavigationCallback:{type:"function"}},aggregations:{_popover:{type:"sap.ui.comp.navpopover.NavigationPopover",multiple:false,visibility:"hidden"}},associations:{control:{type:"sap.ui.core.Control",multiple:false}},events:{beforePopoverOpens:{parameters:{semanticObject:{type:"string"},semanticAttributes:{type:"object"},semanticAttributesOfSemanticObjects:{type:"object"},setSemanticAttributes:{type:"function"},setAppStateKey:{type:"function"},originalId:{type:"string"},open:{type:"function"}}},navigationTargetsObtained:{parameters:{mainNavigation:{type:"sap.ui.comp.navpopover.LinkData"},actions:{type:"sap.ui.comp.navpopover.LinkData[]"},ownNavigation:{type:"sap.ui.comp.navpopover.LinkData"},popoverForms:{type:"sap.ui.layout.form.SimpleForm[]"},semanticObject:{type:"string"},semanticAttributes:{type:"object"},originalId:{type:"string"},show:{type:"function"}}},innerNavigate:{parameters:{text:{type:"string"},href:{type:"string"},semanticObject:{type:"string"},semanticAttributes:{type:"object"},originalId:{type:"string"}}}}}});_.prototype.init=function(){this._oPopover=null;this._oContactDetailsController=new f;var t=new n({semanticObject:undefined,semanticAttributes:undefined,appStateKey:undefined,mainNavigationId:undefined,navigationTarget:{mainNavigation:undefined,enableAvailableActionsPersonalization:undefined,extraContent:undefined},availableActions:[]});t.setDefaultBindingMode(a.TwoWay);t.setSizeLimit(1e3);this.setModel(t,"$sapuicompNavigationPopoverHandler");this._oRTANavigationHandling={enabled:false,initialValue:undefined};this._oLog=y.getLevel()>=y.Level.INFO?new b:undefined};_.prototype.applySettings=function(t){e.prototype.applySettings.apply(this,arguments);this._setSemanticAttributes(this._calculateSemanticAttributes(null))};_.prototype.openPopover=function(t){var e=this;return this._getPopover().then(function(i){var n=i.getDirectLink();if(n){e._fireInnerNavigate({text:n.getText(),href:n.getHref(),internalHref:n.data("internalHref")});e._destroyPopover();return}i.show(t)})};_.prototype.getSemanticObjectValue=function(){var t=this._getSemanticAttributes();if(t){return t[this.getSemanticObject()][this.getSemanticObject()]}return undefined};_.prototype.getNavigationPopoverStableId=function(){var t=sap.ui.getCore().byId(this.getControl());if(!t){y.error("NavigationPopoverHandler: Stable ID could not be determined because the control is undefined");return undefined}var e=this._getComponent(t);if(!e){y.error("NavigationPopoverHandler: Stable ID could not be determined because the app component is not defined for control '"+t.getId()+"'");return undefined}var i=this.getModel("$sapuicompNavigationPopoverHandler").getProperty("/semanticObject");if(!i){y.error("NavigationPopoverHandler: Stable ID could not be determined because no default semantic object is defined");return undefined}var n=[i].concat(this.getAdditionalSemanticObjects());l.sortArrayAlphabetical(n);var a=n.join("--");return e.createId("sapuicompnavpopoverNavigationPopover---"+a)};_.prototype.updateBindingContext=function(){var t=this.getBindingContext("$sapuicompNavigationPopoverHandler");o.prototype.updateBindingContext.apply(this,arguments);var e=this.getBindingContext("$sapuicompNavigationPopoverHandler");if(e&&e!==t){this._setSemanticAttributes(this._calculateSemanticAttributes(null));this._destroyPopover()}};_.prototype.setSemanticObject=function(t){this._destroyPopover();this.setProperty("semanticObject",t);this.getModel("$sapuicompNavigationPopoverHandler").setProperty("/semanticObject",t);this._setSemanticAttributes(this._calculateSemanticAttributes(null));return this};_.prototype._setSemanticAttributes=function(t){this.getModel("$sapuicompNavigationPopoverHandler").setProperty("/semanticAttributes",t)};_.prototype._getSemanticAttributes=function(){return this.getModel("$sapuicompNavigationPopoverHandler").getProperty("/semanticAttributes")};_.prototype.setEnableAvailableActionsPersonalization=function(t){this.setProperty("enableAvailableActionsPersonalization",t);this.getModel("$sapuicompNavigationPopoverHandler").setProperty("/navigationTarget/enableAvailableActionsPersonalization",t);return this};_.prototype.setFieldName=function(t){this.setProperty("fieldName",t);this._setSemanticAttributes(this._calculateSemanticAttributes(null));return this};_.prototype.setControl=function(t){this.setAssociation("control",t);this.setModel(t.getModel());this._destroyPopover();this._updateSemanticObjectController();this._setSemanticAttributes(this._calculateSemanticAttributes(null));return this};_.prototype.setMapFieldToSemanticObject=function(t){this.setProperty("mapFieldToSemanticObject",t);this._setSemanticAttributes(this._calculateSemanticAttributes(null));return this};_.prototype.setSemanticObjectController=function(t){this._updateSemanticObjectController(t);this._setSemanticAttributes(this._calculateSemanticAttributes(null));return this};_.prototype.exit=function(){this._oContactDetailsController.destroy();this._destroyPopover();if(this.getSemanticObjectController()){this.getSemanticObjectController().unregisterControl(this)}if(this.getModel("$sapuicompNavigationPopoverHandler")){this.getModel("$sapuicompNavigationPopoverHandler").destroy()}this._oRTANavigationHandling=undefined};_.prototype._initModel=function(){var t=this;var e;var i=this.getSemanticObject();var n=this.getAdditionalSemanticObjects();var a=l.getContactAnnotationPath(this,this.getSemanticObjectController());var o=sap.ui.getCore().byId(this.getControl());if(!o){y.error("sap.ui.comp.navpopover.NavigationPopoverHandler: No control provided, popover cannot be attached.")}var r=o&&o.getBindingContext()?o.getBindingContext().getPath():null;if(!r){y.warning("sap.ui.comp.navpopover.NavigationPopoverHandler: Binding Context is null. Please be aware that without binding context no semantic attributes can be calculated. Without semantic attributes no URL parameters can be created.")}var s=this.getModel();var c=this._getComponent(o);var u=o&&o.getId();var g,v,d;if(this._oLog){this._oLog.reset()}return sap.ui.getCore().loadLibrary("sap.ui.fl",{async:true}).then(function(){return l.retrieveSemanticObjectMapping(t.getFieldName(),s,r)}).then(function(n){t._setSemanticAttributes(t._calculateSemanticAttributes(n,t._oLog));e=t._getSemanticAttributes();return t._fireBeforePopoverOpens(e,i,u,t._oLog)}).then(function(a){e=a.semanticAttributes;t._setSemanticAttributes(e);v=t.getSemanticObjectValue();g=o&&o._getTextOfDom&&o._getTextOfDom()||t.getSemanticObjectValue();t.getModel("$sapuicompNavigationPopoverHandler").setProperty("/appStateKey",a.appStateKey);return l.retrieveNavigationTargets(i,n,a.appStateKey,c,e,g,t.getFieldName(),s,r,t._oLog)}).then(function(e){d=e;t._oContactDetailsController.setModel(s);return t._oContactDetailsController.getBindingPath4ContactAnnotation(r,a,v)}).then(function(n){var a=t._oContactDetailsController.getContactDetailsContainers(n);return t._fireNavigationTargetsObtained(g,i,e,u,a,d,t._oLog)}).then(function(e){var i=e.availableActions;var n=[];if(i){i.forEach(function(e){if(e.getText()){e.setText(N(e.getText()))}if(e.getHref()){e.setInternalHref(e.getHref());n.push(t._convertToExternal(e.getHref()).then(function(t){e.setHref(t)}))}})}var a=e.mainNavigation;if(a){if(a.getDescription()){a.setDescription(N(a.getDescription()))}if(a.getText()){a.setText(N(a.getText()))}if(a.getHref()){a.setInternalHref(a.getHref());n.push(t._convertToExternal(a.getHref()).then(function(t){a.setHref(t)}))}}if(e.mainNavigationId){e.mainNavigationId=N(e.mainNavigationId)}return Promise.all(n).then(function(){var i=t.getModel("$sapuicompNavigationPopoverHandler");i.setProperty("/mainNavigationId",e.mainNavigationId);i.setProperty("/navigationTarget/mainNavigation",e.mainNavigation);i.setProperty("/navigationTarget/extraContent",e.extraContent);i.setProperty("/availableActions",t._updateVisibilityOfAvailableActions(p.convert2Json(e.availableActions)));i.setProperty("/navigationTarget/enableAvailableActionsPersonalization",t._getEnableAvailableActionsPersonalization(i.getProperty("/availableActions")));if(y.getLevel()>=y.Level.TRACE){y.info("sap.ui.comp.NavigationPopoverHandler: calculation of semantic attributes\n---------------------------------------------\nBelow you can see detailed information regarding semantic attributes which have been calculated for one or more semantic objects defined in a SmartLink control. Semantic attributes are used to create the URL parameters. Additionally you can see all links containing the URL parameters.\n"+t._getLogFormattedText())}})})};_.prototype._initPopover=function(){var t=this;return this._initModel().then(function(){var e=t.getModel("$sapuicompNavigationPopoverHandler");var i=t._createPopover();i.setModel(e,"$sapuicompNavigationPopoverHandler");var n=sap.ui.getCore().byId(t.getControl());if(n){n.addDependent(i)}return i})};_.prototype._initNavigationContainer=function(){var t=this;return this._initModel().then(function(){var e=t.getModel("$sapuicompNavigationPopoverHandler");var i=t._createNavigationContainer();i.setModel(e,"$sapuicompNavigationPopoverHandler");var n=sap.ui.getCore().byId(t.getControl());if(n){n.addDependent(i)}return i})};_.prototype._getPopover=function(){if(!this._oPopover){return this._initPopover()}else{return Promise.resolve(this._oPopover)}};_.prototype._getNavigationContainer=function(){return this._initNavigationContainer().then(function(t){return t})};_.prototype._destroyPopover=function(){if(this._oPopover){this._oPopover.destroy();this._oPopover=null}};_.prototype._createPopover=function(){if(this._oPopover){return this._oPopover}var t=this._createNavigationContainer();this._oPopover=new s({customData:new h({key:"useExternalContent"}),content:[t],title:"{$sapuicompNavigationPopoverHandler>/mainNavigationId}",source:this.getControl(),beforeClose:function(){this.removeAllContent().forEach(function(t){t.destroy()})},afterClose:this._destroyPopover.bind(this),ariaLabelledBy:t._oHeaderArea.getItems()[0].getContent().getId()});this.setAggregation("_popover",this._oPopover);return this._oPopover};_.prototype._createNavigationContainer=function(){var t=this.getNavigationPopoverStableId();if(!t){y.error("NavigationPopoverHandler: Due to undefined stable ID the button of action personalization is set to disabled")}var e=sap.ui.getCore().byId(t);if(e){if(e.getParent()&&e.getParent().getParent()&&e.getParent().getParent().isA("sap.ui.comp.navpopover.NavigationPopover")){e.getParent().getParent().close();if(!e.isDestroyed()){e.destroy()}}else{y.error("Duplicate ID '"+t+"'. The instance of NavigationContainer should be destroyed first in order to avoid duplicate creation of NavigationContainer with stable ID.");throw"Duplicate ID"}}var i=this.getModel("$sapuicompNavigationPopoverHandler");return new d(t,{mainNavigationId:"{$sapuicompNavigationPopoverHandler>/mainNavigationId}",mainNavigation:i.getProperty("/navigationTarget/mainNavigation"),availableActions:{path:"$sapuicompNavigationPopoverHandler>/availableActions",templateShareable:false,template:new p({key:"{$sapuicompNavigationPopoverHandler>key}",href:"{$sapuicompNavigationPopoverHandler>href}",internalHref:"{$sapuicompNavigationPopoverHandler>internalHref}",text:"{$sapuicompNavigationPopoverHandler>text}",target:"{$sapuicompNavigationPopoverHandler>target}",description:"{$sapuicompNavigationPopoverHandler>description}",visible:"{$sapuicompNavigationPopoverHandler>visible}"})},extraContent:i.getProperty("/navigationTarget/extraContent")?i.getProperty("/navigationTarget/extraContent").getId():undefined,component:this._getComponent(sap.ui.getCore().byId(this.getControl())),enableAvailableActionsPersonalization:"{$sapuicompNavigationPopoverHandler>/navigationTarget/enableAvailableActionsPersonalization}",beforePopoverOpen:function(){if(this._oPopover){this._oPopover.setModal(true)}}.bind(this),afterPopoverClose:function(){if(this._oPopover){this._oPopover.setModal(false)}}.bind(this),navigate:this._onNavigate.bind(this),control:this.getControl()})};_.prototype._convertToExternal=function(t){return r.getService("CrossApplicationNavigation",true).then(function(e){if(!e){return Promise.resolve(t)}return e.hrefForExternalAsync({target:{shellHash:t}},this._getComponent())}.bind(this))};_.prototype._fireBeforePopoverOpens=function(t,e,i,n){var a=this;return new Promise(function(o){var r={semanticAttributes:t,appStateKey:undefined};if(!a.hasListeners("beforePopoverOpens")){o(r);return}var s=function(t){var e=Object.keys(t).filter(function(e){return!jQuery.isEmptyObject(t[e])});return!!e.length};a.fireBeforePopoverOpens({originalId:i,semanticObject:e,semanticAttributes:!jQuery.isEmptyObject(t[e])?t[e]:null,semanticAttributesOfSemanticObjects:s(t)?t:null,setSemanticAttributes:function(t,i){i=i||e;r.semanticAttributes=r.semanticAttributes||{};if(n){n.updateSemanticObjectAttributes(i,r.semanticAttributes[i],t)}r.semanticAttributes[i]=t},setAppStateKey:function(t){r.appStateKey=t},open:function(){return o(r)}})})};_.prototype._fireNavigationTargetsObtained=function(t,e,i,n,a,o,r){var s=this;return new Promise(function(l){var u={mainNavigationId:t,mainNavigation:o.mainNavigation,availableActions:o.availableActions,ownNavigation:o.ownNavigation,extraContent:a.length?new c({items:a}):undefined};if(!s.hasListeners("navigationTargetsObtained")){l(u);return}s.fireNavigationTargetsObtained({mainNavigation:o.mainNavigation,actions:o.availableActions,ownNavigation:o.ownNavigation,popoverForms:a,semanticObject:e,semanticAttributes:i?i[e]:i,originalId:n,show:function(t,e,i,n){if(arguments.length>0&&!(typeof t==="string"||e instanceof p||Array.isArray(i))&&n===undefined){n=i;i=e;e=t;t=undefined}if(t!==undefined&&t!==null){u.mainNavigationId=t}if(e!==undefined){u.mainNavigation=e;if(r&&e){r.addIntent({text:e.getText(),intent:e.getHref()})}}if(i){i.forEach(function(t){if(t.getKey()===undefined){y.error("'key' attribute of 'availableAction' '"+t.getText()+"' is undefined. Links without 'key' can not be persisted.");y.warning("The 'visible' attribute of 'availableAction' '"+t.getText()+"' is set to 'true'");t.setVisible(true)}if(r&&t){r.addIntent({text:t.getText(),intent:t.getHref()})}});u.availableActions=i}if(n){u.extraContent=n}return l(u)}})})};_.prototype._onNavigate=function(t){var e=t.getParameters();this._fireInnerNavigate({text:e.text,href:e.href,internalHref:e.internalHref})};_.prototype._fireInnerNavigate=function(t){var e=sap.ui.getCore().byId(this.getControl());var i=this.getSemanticObject();var n=this._getSemanticAttributes();if(this.getAdditionalSemanticObjects().length>0){var a=this.getAdditionalSemanticObjects().find(function(e){return t.href.includes(e)});if(a){i=a}}var o={text:t.text,href:t.href,originalId:e?e.getId():undefined,semanticObject:i,semanticAttributes:n?n[i]:n};if(this.getBeforeNavigationCallback()){this.getBeforeNavigationCallback()(C({},o)).then(function(e){if(e===true){o.internalHref=t.internalHref;this.fireInnerNavigate(o);if(!this.getSemanticObjectController()){l.navigate(t.internalHref)}}}.bind(this))}else{o.internalHref=t.internalHref;this.fireInnerNavigate(o);if(!this.getSemanticObjectController()){l.navigate(t.internalHref)}}};_.prototype._getComponent=function(t){if(!t){return null}var e=t.getParent();while(e){if(e instanceof A){if(e&&e.getAppComponent){e=e.getAppComponent()}return e}e=e.getParent()}return A.get(A.getOwnerIdFor(t))};_.prototype.getAppComponent=function(){return this._getComponent(sap.ui.getCore().byId(this.getControl()))};_.prototype._getBindingContextObject=function(){var t=sap.ui.getCore().byId(this.getControl());var e=this.getBindingContext()||t&&t.getBindingContext();return e?e.getObject(e.getPath()):null};_.prototype._getLogFormattedText=function(){return this._oLog?this._oLog.getFormattedText():"No logging data available"};_.prototype._calculateSemanticAttributes=function(t,e){var i=this._getBindingContextObject();var n=this.getFieldName();var a=this;var o=["",this.getSemanticObject()].concat(this.getAdditionalSemanticObjects());var r={};o.forEach(function(o){r[o]={};var s=a._getMappingRules(o,t,i);for(var l in i){var c=null,p=null;if(e&&o){c={transformations:[]};e.addSemanticObjectAttribute(o,l,c)}if(i[l]===undefined||i[l]===null){if(c){c.transformations.push({value:i[l],description:" Undefined and null values have been removed in NavigationPopoverHandler."})}continue}if(P(i[l])){if(c){c.transformations.push({value:i[l],description:" Plain objects has been removed in NavigationPopoverHandler."})}continue}var u=s[l];if(c&&l!==u){p=t?{value:undefined,description:" The attribute "+l+" has been renamed to "+u+" in NavigationPopoverHandler.",reason:" A com.sap.vocabularies.Common.v1.SemanticObjectMapping annotation is defined for semantic object "+o+" with source attribute "+l+" and target attribute "+u+". You can modify the annotation if the mapping result is not what you expected."}:{value:undefined,description:" The attribute "+l+" has been renamed to "+u+" in NavigationPopoverHandler.",reason:" The property mapFieldToSemanticObject is set to true. Attribute "+l+" is mapped to "+u+". (semantic object is "+a.getSemanticObject()+", field name is "+a.getFieldName()+"). If this is not what you expected, you can set the property to false or define a com.sap.vocabularies.Common.v1.SemanticObjectMapping annotation."}}var g=i[l];if(r[o][u]){if(i[n]){if(u===s[a.getFieldName()]){g=i[n]}else{y.error("The attribute "+l+" can not be renamed to the attribute "+u+" due to a clash situation. This can lead to wrong navigation later on.")}}}r[o][u]=g;if(c){c.transformations.push({value:i[l],description:" The attribute "+l+" with the value "+i[l]+" is taken from the binding context in NavigationPopoverHandler."});if(p){c.transformations.push(p);e.addSemanticObjectAttribute(o,u,{transformations:[{value:g,description:" The attribute "+u+" with the value "+g+" has been added due to a mapping rule regarding the attribute "+l+" in NavigationPopoverHandler."}]})}}}});return r};_.prototype._getMappingRules=function(t,e,i){var n=this.getMapFieldToSemanticObject();if(this.getSemanticObjectController()&&this.getSemanticObjectController().getMapFieldToSemanticObject()!==undefined){n=this.getSemanticObjectController().getMapFieldToSemanticObject()}var a;var o={};if(e){for(a in e[t]){if(typeof e[t][a]==="string"){o[a]=e[t][a]}}}else if(n){if(this.getSemanticObjectController()){var r=this.getSemanticObjectController().getFieldSemanticObjectMap();for(a in r){o[a]=r[a]}}if(this.getFieldName()&&this.getSemanticObject()){o[this.getFieldName()]=this.getSemanticObject()}}for(a in i){if(!o.hasOwnProperty(a)){o[a]=a}}return o};_.prototype._updateSemanticObjectController=function(t){var e=this.getProperty("semanticObjectController");var i=sap.ui.getCore().byId(this.getControl());t=t||this.getSemanticObjectController()||this._getSemanticObjectControllerOfControl(i);if(t&&i&&t.isControlRegistered(i)){t.unregisterControl(this)}if(t!==e&&e){e.unregisterControl(this)}this.setProperty("semanticObjectController",t);if(t&&!t.isControlRegistered(i)){t.registerControl(this)}};_.prototype._getSemanticObjectControllerOfControl=function(t){if(!t){return undefined}var e;var i=t.getParent();while(i){if(i.getSemanticObjectController){e=i.getSemanticObjectController();if(e){this.setSemanticObjectController(e);break}}i=i.getParent()}return e};_.prototype._updateVisibilityOfAvailableActions=function(t){var e=this._oRTANavigationHandling.initialValue===undefined?this._getEnableAvailableActionsPersonalization(t):this._oRTANavigationHandling.initialValue;if(!e){return t}var i=l.getStorableAvailableActions(t);var n=i.some(function(t){return!!t.isSuperiorAction});i.forEach(function(e){if(t.length>10){e.visible=false}if(n){e.visible=false}if(e.isSuperiorAction){e.visible=true}});if(t.every(function(t){return!t.visible})){if(t[0]){t[0].visible=true}if(t[1]){t[1].visible=true}if(t[2]){t[2].visible=true}}return t};_.prototype._getEnableAvailableActionsPersonalization=function(t){var e=l.getStorableAvailableActions(t);if(e.length===0){return false}var i=this.getEnableAvailableActionsPersonalization();if(this.getSemanticObjectController()&&this.getSemanticObjectController().getEnableAvailableActionsPersonalization()&&this.getSemanticObjectController().getEnableAvailableActionsPersonalization()[this.getFieldName()]!==undefined){i=this.getSemanticObjectController().getEnableAvailableActionsPersonalization()[this.getFieldName()]}return i};return _});
/*!
 * SAPUI5
 * (c) Copyright 2009-2023 SAP SE. All rights reserved.
 */
sap.ui.predefine("sap/ui/comp/navpopover/RTAHandler", ["sap/ui/comp/library","sap/ui/comp/personalization/Controller","sap/ui/comp/personalization/Util","./Util","./Factory"],function(n,e,o,t,i){"use strict";var r=n.navpopover.ChangeHandlerType;var a={};a.isSettingsAvailable=function(){return!!i.getService("CrossApplicationNavigation")};a.getStableElements=function(n){if(!n||!n.isA("sap.ui.comp.navpopover.NavigationPopoverHandler")){return null}var e=n.getNavigationPopoverStableId();if(!e){return null}var o=n.getAppComponent();if(!o){return null}return[{id:e,appComponent:o}]};a.execute=function(n,e,o){return new Promise(function(e,t){if(!n||!n.isA("sap.ui.comp.navpopover.NavigationPopoverHandler")){t(new Error("oNavigationPopoverHandler is not of supported type sap.ui.comp.navpopover.NavigationPopoverHandler"));return}if(!n.getNavigationPopoverStableId()){t(new Error("StableId is not defined. SemanticObject="+n.getSemanticObject()));return}var i=n.getAppComponent();if(!i){t(new Error("AppComponent is not defined. oControl="+n.getControl()));return}n._getNavigationContainer().then(function(n){var t=[];var a=[];var p=function(o){var p=n.getId();t=o.filter(function(n){return n.visible===true}).map(function(n){return{selectorControl:{id:p,controlType:"sap.ui.comp.navpopover.NavigationContainer",appComponent:i},changeSpecificData:{changeType:r.addLink,content:n}}});a=o.filter(function(n){return n.visible===false}).map(function(n){return{selectorControl:{id:p,controlType:"sap.ui.comp.navpopover.NavigationContainer",appComponent:i},changeSpecificData:{changeType:r.removeLink,content:n}}});e(t.concat(a))};n.openSelectionDialog(true,false,p,false,o,undefined).then(function(){n.destroy()})})})};return a},true);
/*!
 * SAPUI5
 * (c) Copyright 2009-2023 SAP SE. All rights reserved.
 */
sap.ui.predefine("sap/ui/comp/navpopover/SemanticObjectController", ["sap/ui/thirdparty/jquery","sap/ui/comp/library","sap/ui/core/Element","./Factory","sap/ui/model/json/JSONModel","sap/ui/comp/odata/MetadataAnalyser","sap/ui/model/BindingMode","sap/base/Log","sap/base/util/merge","./Util"],function(jQuery,t,e,i,n,a,o,r,s,c){"use strict";var p=e.extend("sap.ui.comp.navpopover.SemanticObjectController",{metadata:{library:"sap.ui.comp",properties:{ignoredFields:{type:"string",group:"Misc",defaultValue:null},prefetchNavigationTargets:{type:"boolean",group:"Misc",defaultValue:false},fieldSemanticObjectMap:{type:"object",group:"Misc",defaultValue:null},entitySet:{type:"string",group:"Misc",defaultValue:null},contactAnnotationPaths:{type:"object",defaultValue:null},enableAvailableActionsPersonalization:{type:"object",defaultValue:null},mapFieldToSemanticObject:{type:"boolean"},forceLinkRendering:{type:"object",defaultValue:null},beforeNavigationCallback:{type:"function"},replaceSmartLinkNavigationTargetsObtained:{type:"boolean",defaultValue:false}},events:{navigationTargetsObtained:{parameters:{mainNavigation:{type:"sap.ui.comp.navpopover.LinkData"},actions:{type:"sap.ui.comp.navpopover.LinkData[]"},ownNavigation:{type:"sap.ui.comp.navpopover.LinkData"},popoverForms:{type:"sap.ui.layout.form.SimpleForm[]"},semanticObject:{type:"string"},semanticAttributes:{type:"object"},originalId:{type:"string"},show:{type:"function"}}},beforePopoverOpens:{parameters:{semanticObject:{type:"string"},semanticAttributes:{type:"object"},semanticAttributesOfSemanticObjects:{type:"object"},setSemanticAttributes:{type:"function"},setAppStateKey:{type:"function"},originalId:{type:"string"},open:{type:"function"}}},navigate:{parameters:{text:{type:"string"},href:{type:"string"},semanticObject:{type:"string"},semanticAttributes:{type:"object"},originalId:{type:"string"}}},prefetchDone:{parameters:{semanticObjects:{type:"object"}}}}}});p.oSemanticObjects={};p.oNavigationTargetActions={};p.bHasPrefetchedDistinctSemanticObjects=false;p.bHasPrefetchedNavigationTargetActions=false;p.oPromise=null;p.oPromiseActions=null;p.prototype.init=function(){p.prefetchDistinctSemanticObjects();this._proxyOnBeforePopoverOpens=this._onBeforePopoverOpens.bind(this);this._proxyOnTargetsObtained=this._onTargetsObtained.bind(this);this._proxyOnNavigate=this._onNavigate.bind(this);this._aRegisteredControls=[]};p.prototype.isControlRegistered=function(t){return this._aRegisteredControls.indexOf(t)>-1};p.prototype.registerControl=function(t){if(!t||!(t.isA("sap.ui.comp.navpopover.SmartLink")||t.isA("sap.ui.comp.navpopover.NavigationPopoverHandler"))){r.warning("sap.ui.comp.navpopover.SemanticObjectController: "+(t&&t.getMetadata?t.getMetadata():"parameter")+" is neither of SmartLink nor of NavigationPopoverHandler instance");return}if(this.isControlRegistered(t)){return}if(t.attachBeforePopoverOpens){t.attachBeforePopoverOpens(this._proxyOnBeforePopoverOpens)}if(t.attachNavigationTargetsObtained){t.attachNavigationTargetsObtained(this._proxyOnTargetsObtained)}if(t.attachInnerNavigate){t.attachInnerNavigate(this._proxyOnNavigate)}this._aRegisteredControls.push(t)};p.prototype.unregisterControl=function(t){if(!t){return}if(!this.isControlRegistered(t)){return}if(t.detachBeforePopoverOpens){t.detachBeforePopoverOpens(this._proxyOnBeforePopoverOpens)}if(t.detachNavigationTargetsObtained){t.detachNavigationTargetsObtained(this._proxyOnTargetsObtained)}if(t.detachInnerNavigate){t.detachInnerNavigate(this._proxyOnNavigate)}this._aRegisteredControls.splice(this._aRegisteredControls.indexOf(t),1)};p.prototype.setEnableAvailableActionsPersonalization=function(t){this.setProperty("enableAvailableActionsPersonalization",t,true);return this};p.prototype._onBeforePopoverOpens=function(t){var e=t.getParameters();if(this.hasListeners("beforePopoverOpens")){this.fireBeforePopoverOpens({semanticObject:e.semanticObject,semanticAttributes:e.semanticAttributes,semanticAttributesOfSemanticObjects:e.semanticAttributesOfSemanticObjects,setSemanticAttributes:e.setSemanticAttributes,setAppStateKey:e.setAppStateKey,originalId:e.originalId,open:e.open})}else{e.open()}};p.prototype._onTargetsObtained=function(t){var e=t.getParameters();if(!this.hasListeners("navigationTargetsObtained")){e.show();return}this.fireNavigationTargetsObtained({mainNavigation:e.mainNavigation,actions:e.actions,ownNavigation:e.ownNavigation,popoverForms:e.popoverForms,semanticObject:e.semanticObject,semanticAttributes:e.semanticAttributes,originalId:e.originalId,show:e.show})};p.prototype._onNavigate=function(t){if(t){var e=t.getParameters();var i={text:e.text,href:e.href,originalId:e.originalId,semanticObject:e.semanticObject,semanticAttributes:e.semanticAttributes};if(this.getBeforeNavigationCallback()&&!t.getSource().getBeforeNavigationCallback()){this.getBeforeNavigationCallback()(s({},i)).then(function(t){if(t===true){this.fireNavigate(e);c.navigate(e.internalHref)}}.bind(this))}else{this.fireNavigate(e);c.navigate(e.internalHref)}}};p.prototype.setIgnoredState=function(t){if(t&&t.isA("sap.ui.comp.navpopover.SmartLink")){t._updateEnabled()}};p.prototype.setIgnoredFields=function(t){this.setProperty("ignoredFields",t);this._aRegisteredControls.forEach(function(t){if(t._updateEnabled){t._updateEnabled()}});return this};p.prototype.setPrefetchNavigationTargets=function(t){this.setProperty("prefetchNavigationTargets",t);if(t!==true){return this}r.error("sap.ui.comp.navpopover.SemanticObjectController: Please be aware that in case of a large amount of semantic objects the performance may suffer significantly and the received links will be created out of context");var e=this;p.getDistinctSemanticObjects().then(function(t){p.getNavigationTargetActions(t).then(function(t){e.firePrefetchDone({semanticObjects:t})})});return this};p.prototype.getFieldSemanticObjectMap=function(){var t=this.getProperty("fieldSemanticObjectMap");if(t){return t}if(!this.getEntitySet()){r.warning("sap.ui.comp.navpopover.SemanticObjectController: FieldSemanticObjectMap is not set on SemanticObjectController, retrieval without EntitySet not possible");return null}var e=new a(this.getModel());t=e.getFieldSemanticObjectMap(this.getEntitySet());if(t){this.setProperty("fieldSemanticObjectMap",t,true)}return t};p.prototype.getEntitySet=function(){var t=this.getProperty("entitySet");if(t){return t}var e=this.getParent();while(e){if(e.getEntitySet){t=e.getEntitySet();if(t){this.setProperty("entitySet",t,true);break}}e=e.getParent()}return t};p.prototype.hasSemanticObjectLinks=function(t){return p.hasDistinctSemanticObject([t],p.oSemanticObjects)};p.prefetchDistinctSemanticObjects=function(){p.getJSONModel();if(!p.bHasPrefetchedDistinctSemanticObjects){p.getDistinctSemanticObjects()}};p.getDistinctSemanticObjects=function(){if(p.bHasPrefetchedDistinctSemanticObjects){return Promise.resolve(p.oSemanticObjects)}if(!p.oPromise){p.oPromise=i.getService("CrossApplicationNavigation",true).then(function(t){if(!t){r.error("sap.ui.comp.navpopover.SemanticObjectController: Service 'CrossApplicationNavigation' could not be obtained");p.bHasPrefetchedDistinctSemanticObjects=true;return{}}return t.getDistinctSemanticObjects().then(function(t){t.forEach(function(t){p.oSemanticObjects[t]={}});var e=p.getJSONModel();e.setProperty("/distinctSemanticObjects",p.oSemanticObjects);p.bHasPrefetchedDistinctSemanticObjects=true;return p.oSemanticObjects},function(){r.error("sap.ui.comp.navpopover.SemanticObjectController: getDistinctSemanticObjects() of service 'CrossApplicationNavigation' failed");p.bHasPrefetchedDistinctSemanticObjects=true;return{}})})}return p.oPromise};p.getNavigationTargetActions=function(t){if(p.bHasPrefetchedNavigationTargetActions){return Promise.resolve(p.oNavigationTargetActions)}if(!p.oPromiseLinks){var e=i.getService("CrossApplicationNavigation",true);var n=i.getService("URLParsing",true);p.oPromiseLinks=Promise.all([e,n]).then(function(e){var i=e[0];var n=e[1];if(!i||!n){r.error("sap.ui.comp.navpopover.SemanticObjectController: Service 'CrossApplicationNavigation' or 'URLParsing' could not be obtained");p.bHasPrefetchedNavigationTargetActions=true;return{}}var a=Object.keys(t);var o=a.map(function(t){return[{semanticObject:t}]});return i.getLinks(o).then(function(t){a.forEach(function(e,i){p.oNavigationTargetActions[e]=[];t[i][0].forEach(function(t){var i=n.parseShellHash(t.intent);if(i&&i.semanticObject===e){p.oNavigationTargetActions[e].push(i.action)}})});var e=p.getJSONModel();e.setProperty("/navigationTargetActions",p.oNavigationTargetActions);p.bHasPrefetchedNavigationTargetActions=true;return p.oNavigationTargetActions},function(){r.error("sap.ui.comp.navpopover.SemanticObjectController: getLinks() of service 'CrossApplicationNavigation' failed");p.bHasPrefetchedNavigationTargetActions=true;return{}})})}return p.oPromiseLinks};p.hasDistinctSemanticObject=function(t,e){return t.some(function(t){return!!e[t]})};p.getJSONModel=function(){var t=sap.ui.getCore().getModel("$sapuicompSemanticObjectController_DistinctSemanticObjects");if(t&&!jQuery.isEmptyObject(t.getData())){return t}t=new n({distinctSemanticObjects:{}});t.setDefaultBindingMode(o.OneTime);t.setSizeLimit(1e3);sap.ui.getCore().setModel(t,"$sapuicompSemanticObjectController_DistinctSemanticObjects");return t};p.destroyDistinctSemanticObjects=function(){p.oSemanticObjects={};p.oNavigationTargetActions={};p.oPromise=null;p.oPromiseActions=null;p.bHasPrefetchedDistinctSemanticObjects=false;p.bHasPrefetchedNavigationTargetActions=false;var t=sap.ui.getCore().getModel("$sapuicompSemanticObjectController_DistinctSemanticObjects");if(t){t.destroy()}};return p});
/*!
 * SAPUI5
 * (c) Copyright 2009-2023 SAP SE. All rights reserved.
 */
sap.ui.predefine("sap/ui/comp/navpopover/SmartLink", ["sap/ui/base/ManagedObject","sap/m/Link","./LinkData","sap/ui/core/Control","./SemanticObjectController","./NavigationPopoverHandler","sap/ui/model/json/JSONModel","sap/ui/comp/personalization/Util","./Util","sap/base/Log","./SmartLinkRenderer","sap/m/library"],function(t,e,i,n,o,a,r,s,l,p,c,g){"use strict";var d=g.EmptyIndicatorMode;var h=e.extend("sap.ui.comp.navpopover.SmartLink",{metadata:{library:"sap.ui.comp",designtime:"sap/ui/comp/designtime/navpopover/SmartLink.designtime",properties:{semanticObject:{type:"string",defaultValue:null},additionalSemanticObjects:{type:"string[]",defaultValue:[]},semanticObjectController:{type:"any",defaultValue:null},fieldName:{type:"string",defaultValue:null},semanticObjectLabel:{type:"string",defaultValue:null},createControlCallback:{type:"object",defaultValue:null},mapFieldToSemanticObject:{type:"boolean",defaultValue:true},contactAnnotationPath:{type:"string",defaultValue:undefined},ignoreLinkRendering:{type:"boolean",defaultValue:false},enableAvailableActionsPersonalization:{type:"boolean",defaultValue:true},forceLinkRendering:{type:"boolean",defaultValue:false},uom:{type:"string",defaultValue:undefined},beforeNavigationCallback:{type:"function"}},aggregations:{innerControl:{type:"sap.ui.core.Control",multiple:false}},events:{beforePopoverOpens:{parameters:{semanticObject:{type:"string"},semanticAttributes:{type:"object"},semanticAttributesOfSemanticObjects:{type:"object"},setSemanticAttributes:{type:"function"},setAppStateKey:{type:"function"},originalId:{type:"string"},open:{type:"function"}}},navigationTargetsObtained:{parameters:{mainNavigation:{type:"sap.ui.comp.navpopover.LinkData"},actions:{type:"sap.ui.comp.navpopover.LinkData[]"},ownNavigation:{type:"sap.ui.comp.navpopover.LinkData"},popoverForms:{type:"sap.ui.layout.form.SimpleForm[]"},semanticObject:{type:"string"},semanticAttributes:{type:"object"},originalId:{type:"string"},show:{type:"function"}}},innerNavigate:{parameters:{text:{type:"string"},href:{type:"string"},semanticObject:{type:"string"},semanticAttributes:{type:"object"},originalId:{type:"string"}}}}}});h.prototype.getInnerControlValue=function(){if(this._isRenderingInnerControl()){var t=this._getInnerControl();if(t){if(t.getText){return t.getText()}if(t.getValue){return t.getValue()}}}return this.getText()};h.prototype.getNavigationPopoverHandler=function(){return this._createNavigationPopoverHandler()};h.prototype.init=function(){o.prefetchDistinctSemanticObjects();this._oNavigationPopoverHandler=null;this.attachPress(this._onLinkPressed);this.addStyleClass("sapUiCompSmartLink");this.setText(this.getText())};h.prototype.applySettings=function(e){t.prototype.applySettings.apply(this,arguments);this._updateEnabled()};h.prototype.onAfterRendering=function(){e.prototype.onAfterRendering.apply(this,arguments);var t=this.getDomRef();if(!this.getText()&&this.getEmptyIndicatorMode()===d.Off){t.setAttribute("aria-hidden",true)}else if(t.getAttribute("aria-hidden")){t.removeAttribute("aria-hidden")}};h.prototype.updateBindingContext=function(){n.prototype.updateBindingContext.apply(this,arguments);this.setHref(null);this.setTarget(null);if(this._oNavigationPopoverHandler){this._oNavigationPopoverHandler.setBindingContext(this.getBindingContext())}};h.prototype._getTextOfDom=function(){if(!this.getDomRef()){return""}if(this.$().find("span").length===2){return this.$().find("span")[0].textContent+this.$().find("span")[1].textContent}else{return this.$()[0].textContent}};h.prototype.setText=function(t){if(this._isRenderingInnerControl()){this.setProperty("text",t,true)}else{e.prototype.setText.call(this,t)}return this};h.prototype.setMapFieldToSemanticObject=function(t){this.setProperty("mapFieldToSemanticObject",t);if(this._oNavigationPopoverHandler){this._oNavigationPopoverHandler.setMapFieldToSemanticObject(t)}return this};h.prototype.setSemanticObject=function(t){this.setProperty("semanticObject",t);if(this._oNavigationPopoverHandler){this._oNavigationPopoverHandler.setSemanticObject(t)}this._updateEnabled();return this};h.prototype.setAdditionalSemanticObjects=function(t){this.setProperty("additionalSemanticObjects",t);if(this._oNavigationPopoverHandler){this._oNavigationPopoverHandler.setAdditionalSemanticObjects(t)}this._updateEnabled();return this};h.prototype.setBeforeNavigationCallback=function(t){this.setProperty("beforeNavigationCallback",t);if(this._oNavigationPopoverHandler){this._oNavigationPopoverHandler.setBeforeNavigationCallback(t)}return this};h.prototype.setContactAnnotationPath=function(t){this.setProperty("contactAnnotationPath",t);if(this._oNavigationPopoverHandler){this._oNavigationPopoverHandler.setContactAnnotationPath(t)}this._updateEnabled();return this};h.prototype.setEnableAvailableActionsPersonalization=function(t){this.setProperty("enableAvailableActionsPersonalization",t);if(this._oNavigationPopoverHandler){this._oNavigationPopoverHandler.setEnableAvailableActionsPersonalization(t)}return this};h.prototype.setIgnoreLinkRendering=function(t){this.setProperty("ignoreLinkRendering",t);this._updateEnabled();return this};h.prototype.setFieldName=function(t){this.setProperty("fieldName",t);if(this._oNavigationPopoverHandler){this._oNavigationPopoverHandler.setFieldName(t)}this._updateEnabled();return this};h.prototype.setSemanticObjectController=function(t){if(t&&!t.isA("sap.ui.comp.navpopover.SemanticObjectController")){p.warning("Warning: setSemanticObjectController() has to be an object of sap.ui.comp.navpopover.SemanticObjectController instances",this);return this}var e=this.getProperty("semanticObjectController");if(e===t){return this}if(e){e.unregisterControl(this)}this.setProperty("semanticObjectController",t,true);if(t){if(this.hasListeners("navigationTargetsObtained")&&t.getReplaceSmartLinkNavigationTargetsObtained()&&t.hasListeners("navigationTargetsObtained")){this.mEventRegistry.navigationTargetsObtained.forEach(function(t){this.detachNavigationTargetsObtained(t.fFunction)}.bind(this))}t.registerControl(this);if(!this.getBeforeNavigationCallback()){this.setBeforeNavigationCallback(t.getBeforeNavigationCallback())}}if(this._oNavigationPopoverHandler){this._oNavigationPopoverHandler.setSemanticObjectController(t)}this._updateEnabled();return this};h.prototype.onBeforeRendering=function(){e.prototype.onBeforeRendering.apply(this,arguments);if(!this.getSemanticObjectController()){var t=this._getSemanticObjectControllerOfParent();if(t){this.setSemanticObjectController(t)}}};h.prototype.exit=function(){if(this.getSemanticObjectController()){this.getSemanticObjectController().unregisterControl(this)}if(this._oNavigationPopoverHandler){this._oNavigationPopoverHandler.destroy();this._oNavigationPopoverHandler=null}};h.prototype._handlePress=function(t){if(this.getUom()&&t.target.localName==="span"){var i=this.getDomRef()?this.getDomRef():t.target.parentElement;t.target=i}e.prototype._handlePress.apply(this,arguments)};h.prototype.onsapenter=h.prototype._handlePress;h.prototype.onclick=h.prototype._handlePress;h.prototype._onLinkPressed=function(t){this._createNavigationPopoverHandler().openPopover()};h.prototype._createNavigationPopoverHandler=function(){if(!this._oNavigationPopoverHandler){if(!this.getFieldName()){var t=this.getBinding("text");var e;if(t){if(t.getBindings){e=t.getBindings()[0].getPath()}else{e=t.getPath()}}this.setFieldName(e)}this._oNavigationPopoverHandler=new a({semanticObject:this.getSemanticObject(),additionalSemanticObjects:this.getAdditionalSemanticObjects(),semanticObjectController:this.getSemanticObjectController(),fieldName:this.getFieldName(),mapFieldToSemanticObject:this.getMapFieldToSemanticObject(),contactAnnotationPath:this.getContactAnnotationPath(),enableAvailableActionsPersonalization:this.getEnableAvailableActionsPersonalization(),control:this,beforePopoverOpens:this._onBeforePopoverOpens.bind(this),navigationTargetsObtained:this._onNavigationTargetsObtained.bind(this),innerNavigate:this._onInnerNavigate.bind(this),beforeNavigationCallback:this.getBeforeNavigationCallback()});this._oNavigationPopoverHandler.setModel(this.getModel());this._oNavigationPopoverHandler.isPopupAdaptationAllowed=function(){return false}}return this._oNavigationPopoverHandler};h.prototype._onNavigationTargetsObtained=function(t){var e=t.getParameters();if(!this.hasListeners("navigationTargetsObtained")){e.show();return}this.fireNavigationTargetsObtained({mainNavigation:e.mainNavigation,actions:e.actions,ownNavigation:e.ownNavigation,popoverForms:e.popoverForms,semanticObject:e.semanticObject,semanticAttributes:e.semanticAttributes,originalId:e.originalId,show:e.show})};h.prototype._onBeforePopoverOpens=function(t){var e=t.getParameters();if(!this.hasListeners("beforePopoverOpens")){e.open();return}this.fireBeforePopoverOpens({originalId:e.originalId,semanticObject:e.semanticObject,semanticAttributes:e.semanticAttributes,semanticAttributesOfSemanticObjects:e.semanticAttributesOfSemanticObjects,setSemanticAttributes:e.setSemanticAttributes,setAppStateKey:e.setAppStateKey,open:e.open})};h.prototype._onInnerNavigate=function(t){var e=t.getParameters();if(!this.hasListeners("innerNavigate")){return}this.fireInnerNavigate({text:e.text,href:e.href,internalHref:e.internalHref,originalId:e.originalId,semanticObject:e.semanticObject,semanticAttributes:e.semanticAttributes})};h.prototype._isRenderingInnerControl=function(){return this.getIgnoreLinkRendering()&&this._getInnerControl()!==null};h.prototype._getInnerControl=function(){var t=this.getAggregation("innerControl");if(t){return t}var e=this.getCreateControlCallback();if(e){t=e();this.setAggregation("innerControl",t,true);return t}return null};h.prototype._getSemanticObjectControllerOfParent=function(){var t;var e=this.getParent();while(e){if(e.getSemanticObjectController){t=e.getSemanticObjectController();if(t){this.setSemanticObjectController(t);break}}e=e.getParent()}return t};h.prototype._updateEnabled=function(){var t=this;return o.getDistinctSemanticObjects().then(function(e){if(t.getSemanticObjectController()&&s.createArrayFromString(t.getSemanticObjectController().getIgnoredFields()).indexOf(t.getFieldName())>-1){t.setEnabled(false);return}if(t.getIgnoreLinkRendering()===true){t.setEnabled(false);return}if(l.getForceLinkRendering(t,t.getSemanticObjectController())){t.setEnabled(true);return}if(!o.hasDistinctSemanticObject(t.getAdditionalSemanticObjects().concat(t.getSemanticObject()),e)&&l.getContactAnnotationPath(t,t.getSemanticObjectController())===undefined){t.setEnabled(false);return}t.setEnabled(true)})};h.prototype.getAccessibilityInfo=function(){var t=this.getEnabled()?e.prototype.getAccessibilityInfo.apply(this,arguments):{description:this.getText()||this.getHref()||""};if(this.getUom()&&t.description&&t.description!==""&&!t.description.includes(this.getUom())){t.description+=this.getUom()}return t};return h});
/*!
 * SAPUI5
 * (c) Copyright 2009-2023 SAP SE. All rights reserved.
 */
sap.ui.predefine("sap/ui/comp/navpopover/SmartLinkRenderer", ["sap/ui/core/Renderer","sap/m/LinkRenderer","sap/base/strings/whitespaceReplacer","sap/m/library"],function(e,t,r,n){"use strict";var i=n.EmptyIndicatorMode;var a=e.extend(t);a.apiVersion=2;a.render=function(e,r){var n=true;if(r.getIgnoreLinkRendering()){var i=r._getInnerControl();if(i){e.openStart("div",r);e.openEnd();e.renderControl(i);e.close("div");n=false}}if(n){if(!r.getAriaLabelledBy()||Array.isArray(r.getAriaLabelledBy())&&r.getAriaLabelledBy().length==0){r.addAriaLabelledBy(r)}t.render.apply(this,arguments)}};a.writeText=function(e,t){var r=t.getUom();var n=t.getEmptyIndicatorMode()!==i.Off&&!t.getText();if(!r){this._writeText(e,t,n);return}this._writeTextWithUom(e,r,t,n)};a._writeTextWithUom=function(e,t,r,n){t=t.padStart(5,"");e.openStart("span");e.openEnd();this._writeText(e,r,n);e.close("span");e.openStart("span");if(n){e.class("sapMEmptyIndicator");e.class("sapMLnkDsbl")}e.style("display","inline-flex");e.style("min-width","2.5em");e.style("width","3.0em");e.style("justify-content","end");e.openEnd();e.text(t);e.close("span")};a._writeText=function(e,n,i){var a=r(n.getText());if(i){t.renderEmptyIndicator(e,n)}else{e.text(a)}};return a},true);
/*!
 * SAPUI5
 * (c) Copyright 2009-2023 SAP SE. All rights reserved.
 */
sap.ui.predefine("sap/ui/comp/navpopover/Util", ["sap/ui/comp/library","./Factory","./LinkData","sap/base/Log"],function(t,e,n,i){"use strict";var r={getContactAnnotationPath:function(t,e){var n=t?t.getContactAnnotationPath():undefined;if(n===undefined&&e&&e.getContactAnnotationPaths()&&e.getContactAnnotationPaths()[t.getFieldName()]!==undefined){n=e.getContactAnnotationPaths()[t.getFieldName()]}return n},getForceLinkRendering:function(t,e){if(!t){return undefined}return t.getForceLinkRendering()||!!(e&&e.getForceLinkRendering()&&e.getForceLinkRendering()[t.getFieldName()])},getStorableAvailableActions:function(t){return t?t.filter(function(t){return t&&t.key!==undefined}):[]},sortArrayAlphabetical:function(t){var e;try{e=sap.ui.getCore().getConfiguration().getLocale().toString();if(typeof window.Intl!=="undefined"){var n=window.Intl.Collator(e,{numeric:true});t.sort(function(t,e){return n.compare(t,e)})}else{t.sort(function(t,n){return t.localeCompare(n,e,{numeric:true})})}}catch(t){}},retrieveNavigationTargets:function(t,r,a,o,c,s,u,l,v,f){var m={mainNavigation:undefined,ownNavigation:undefined,availableActions:[]};var p=e.getService("CrossApplicationNavigation",true);var g=e.getService("URLParsing",true);return Promise.all([p,g]).then(function(e){var p=e[0];var g=e[1];if(!p||!g){i.error("Service 'CrossApplicationNavigation' or 'URLParsing' could not be obtained");return Promise.resolve(m)}var b=[t].concat(r);var d=b.map(function(t){return[{semanticObject:t,params:c?c[t]:undefined,appStateKey:a,ui5Component:o,sortResultsBy:"text"}]});var h;return new Promise(function(t){p.getLinks(d).then(function(e){return t(e)})}).then(function(t){h=t;return h&&h.length?this.retrieveSemanticObjectUnavailableActions(u,l,v):Promise.resolve({})}.bind(this)).then(function(t){if(!h||!h.length){return Promise.resolve(m)}return p.hrefForExternalAsync().then(function(e){if(e&&e.indexOf("?")!==-1){e=e.split("?")[0]}if(e){e+="?"}var i=function(e,n){return!!t&&!!t[e]&&t[e].indexOf(n)>-1};h[0][0].forEach(function(t){var r=g.parseShellHash(t.intent);var a=r.semanticObject&&r.action?r.semanticObject+"-"+r.action:undefined;var o=t.tags&&t.tags.indexOf("superiorAction")>-1;if(t.intent.indexOf(e)===0){var c=new n({key:a,href:t.intent,visible:true,isSuperiorAction:o});c.setText(t.text);m.ownNavigation=c;return}if(r.action&&r.action==="displayFactSheet"&&!i(r.semanticObject,r.action)){m.mainNavigation=new n({key:a,href:t.intent,text:sap.ui.getCore().getLibraryResourceBundle("sap.ui.comp").getText("POPOVER_FACTSHEET"),visible:true,isSuperiorAction:o});if(f){f.addSemanticObjectIntent(r.semanticObject,{text:t.text,intent:t.intent})}return}if(!i(r.semanticObject,r.action)){var s=new n({key:a,href:t.intent,visible:true,isSuperiorAction:o});s.setText(t.text);m.availableActions.push(s);if(f){f.addSemanticObjectIntent(r.semanticObject,{text:t.text,intent:t.intent})}}});if(!m.mainNavigation&&typeof s==="string"){var r=new n({visible:true});r.setText(s);m.mainNavigation=r}var a=[];for(var o=1;o<b.length;o++){a=a.concat(h[o][0])}a.forEach(function(t){var e=g.parseShellHash(t.intent);if(i(e.semanticObject,e.action)){return}var r=t.tags&&t.tags.indexOf("superiorAction")>-1;var a=new n({key:e.semanticObject&&e.action?e.semanticObject+"-"+e.action:undefined,href:t.intent,visible:true,isSuperiorAction:r});a.setText(t.text);m.availableActions.push(a);if(f){f.addSemanticObjectIntent(e.semanticObject,{text:t.text,intent:t.intent})}});return Promise.resolve(m)})})}.bind(this))},retrieveSemanticObjectMapping:function(t,e,n){return this._getEntityTypeAnnotationOfProperty(t,e,n).then(function(t){if(!t){return Promise.resolve(null)}if(!t[0]["com.sap.vocabularies.Common.v1.SemanticObjectMapping"]){return Promise.resolve(null)}var i=this._getSemanticObjectMappingsOfProperty(t[0],this._getSemanticObjectsOfProperty(t[0],e,n));var r={};for(var a in i){r[i[a].name]=i[a].mapping}return Promise.resolve(r)}.bind(this))},retrieveSemanticObjectUnavailableActions:function(t,e,n){return this._getEntityTypeAnnotationOfProperty(t,e,n).then(function(t){if(!t){return Promise.resolve(null)}if(!t[0]["com.sap.vocabularies.Common.v1.SemanticObjectUnavailableActions"]){return Promise.resolve(null)}var i=this._getSemanticObjectUnavailableActionsOfProperty(t[0],this._getSemanticObjectsOfProperty(t[0],e,n));var r={};for(var a in i){r[i[a].name]=i[a].unavailableActions}return Promise.resolve(r)}.bind(this))},oNavigationPromise:undefined,navigate:function(t){if(t.indexOf("#")===0&&e.getUShellContainer()){var n=this;if(!n.oNavigationPromise){n.oNavigationPromise=e.getService("CrossApplicationNavigation",true).then(function(e){e.toExternal({target:{shellHash:t.substring(1)}});n.oNavigationPromise=undefined})}}else{window.location.href=t}},_getEntityTypeAnnotationOfProperty:function(t,e,n){if(!t){return Promise.resolve(null)}if(!e||!e.getMetaModel()){return Promise.resolve(null)}var r=e.getMetaModel();return r.loaded().then(function(){var e;try{e=r.getMetaContext(n)}catch(t){i.error("sap.ui.comp.navpopover.Util._getEntityTypeAnnotationOfProperty: binding path '"+n+"' is not valid. Error has been caught: "+t);return Promise.resolve(null)}if(!e){return Promise.resolve(null)}var a=e.getProperty(e.getPath());if(!a.property){return Promise.resolve(null)}var o=a.property.filter(function(e){return e.name===t});if(o.length!==1){return Promise.resolve(null)}return Promise.resolve(o)})},_getSemanticObjectsOfProperty:function(t,e,n){var i={};for(var r in t){var a=r.split("#")[0];var o=r.split("#")[1]||"";if(a.startsWith("com.sap.vocabularies.Common.v1.SemanticObject")&&a.endsWith("com.sap.vocabularies.Common.v1.SemanticObject")){i[o]={name:t[r]["Path"]?e.getProperty(n+"/"+t[r]["Path"]):t[r]["String"],mapping:undefined}}}return i},_getSemanticObjectMappingsOfProperty:function(t,e){var n=function(t){var e={};if(Array.isArray(t)){t.forEach(function(t){e[t.LocalProperty.PropertyPath]=t.SemanticObjectProperty.String})}return e};for(var i in t){var r=i.split("#")[0];var a=i.split("#")[1]||"";if(r.startsWith("com.sap.vocabularies.Common.v1.SemanticObjectMapping")&&r.endsWith("com.sap.vocabularies.Common.v1.SemanticObjectMapping")){if(e[a]){e[a].mapping=n(t[i])}}}return e},_getSemanticObjectUnavailableActionsOfProperty:function(t,e){var n=function(t){var e=[];if(Array.isArray(t)){t.forEach(function(t){e.push(t.String)})}return e};for(var i in t){var r=i.split("#")[0];var a=i.split("#")[1]||"";if(r.startsWith("com.sap.vocabularies.Common.v1.SemanticObjectUnavailableActions")&&r.endsWith("com.sap.vocabularies.Common.v1.SemanticObjectUnavailableActions")){if(e[a]){e[a].unavailableActions=n(t[i])}}}return e}};return r},true);
/*!
 * SAPUI5
 * (c) Copyright 2009-2023 SAP SE. All rights reserved.
 */
sap.ui.predefine("sap/ui/comp/navpopover/flexibility/LinkFlex", ["sap/base/util/isEmptyObject","sap/base/Log","sap/ui/fl/changeHandler/condenser/Classification"],function(e,t,n){"use strict";var i={};var r="visible";i.applyChange=function(n,i,o){var a=n.getContent();if(e(a)){t.error("Change does not contain sufficient information to be applied");return Promise.reject("Change does not contain sufficient information to be applied")}var s=i.getAvailableActions().find(function(e){return e.getKey()===a.key});if(!s){t.error("Item with key "+a.key+" not found in the availableAction aggregation");return Promise.reject("Item with key "+a.key+" not found in the availableAction aggregation")}var f=o.modifier;return Promise.resolve().then(f.getProperty.bind(f,s,r)).then(function(e){f.setProperty(s,"visibleChangedByUser",n.getLayer()==="USER");f.setVisible(s,a.visible);n.setRevertData({key:a.key,originalValue:e})})};i.completeChangeContent=function(t,n,i){if(e(n.content)){throw new Error("oSpecificChangeInfo.content should be filled")}if(!n.content.key){throw new Error("In oSpecificChangeInfo.content.key attribute is required")}if(n.changeType==="addLink"){if(n.content.visible!==true){throw new Error("In oSpecificChangeInfo.content.visible attribute should be 'true'")}}else if(n.changeType==="removeLink"){if(n.content.visible!==false){throw new Error("In oSpecificChangeInfo.content.visible attribute should be 'false'")}}t.setContent(n.content)};i.revertChange=function(n,i,r){var o=n.getContent();if(e(o)){t.error("Change does not contain sufficient information to be applied");return false}var a=i.getAvailableActions().find(function(e){return e.getKey()===o.key});if(!a){t.error("Item with key "+o.key+" not found in the availableAction aggregation");return false}var s=n.getRevertData();if(s){r.modifier.setProperty(a,"visibleChangedByUser",n.getLayer()==="USER");r.modifier.setVisible(a,s.originalValue);n.resetRevertData()}else{t.error("Attempt to revert an unapplied change.")}};i.getCondenserInfo=function(e){return{affectedControl:{id:e.getContent().key,idIsLocal:true},uniqueKey:r,classification:n.Reverse}};return i},true);
/*!
 * SAPUI5
 * (c) Copyright 2009-2023 SAP SE. All rights reserved.
 */
sap.ui.predefine("sap/ui/comp/odata/AnalyticalAnalyser", ["sap/ui/comp/odata/MetadataAnalyser","sap/ui/comp/library"],function(t,e){"use strict";var i=function(e){t.apply(this,arguments)};i.prototype=Object.create(t.prototype);Object.assign(i,t);i.prototype.getVLEntitySets=function(e){var i,a,n,r,o,s,p=t.prototype.getVLEntitySets.apply(this,arguments),y=Array.isArray(p)&&p[0];if(!y&&typeof e==="string"&&this._containsNavigation(e)){r=e.split("/");o=r[0];s=r[1];i=this._oMetaModel.getODataEntitySet(o);if(i&&this.isSemanticParameters(i.entityType)&&s){a=this._oMetaModel.getODataEntityType(i.entityType);n=this._oMetaModel.getODataAssociationSetEnd(a,s);if(n){y=this._oMetaModel.getODataEntitySet(n.entitySet)}}}return[y,i]};i.prototype.getVLProperty=function(i,a){var n,r,o,s,p=a[1];if(i&&p&&this.isSemanticParameters(p.entityType)){o=this._containsNavigation(i.String);if(o){n=i.String.split("/");r=n[1];if(r){s=e.ANALYTICAL_PARAMETER_PREFIX+r}}}if(!s){s=t.prototype.getVLProperty.call(this,i)}return s};i.prototype._containsNavigation=function(t){return typeof t==="string"&&t.indexOf("/")>0&&!t.endsWith("/")};i.prototype.isSemanticParameters=function(t){var e;if(t&&this._oMetaModel){e=this._oMetaModel.getODataEntityType(t);if(e){return e["sap:semantics"]==="parameters"}}return false};return i},true);
/*!
 * SAPUI5
 * (c) Copyright 2009-2023 SAP SE. All rights reserved.
 */
sap.ui.predefine("sap/ui/comp/odata/CalendarFormat", ["sap/ui/comp/odata/PeriodDateFormat"],function(e){"use strict";var a=e.extend("sap.ui.comp.odata.CalendarFormat",{metadata:{library:"sap.ui.comp"},constructor:function(a,t){e.apply(this,arguments)}});a.getDateInstance=function(e){return new a(null,e)};a.prototype.getName=function(){return"sap.ui.comp.odata.CalendarFormat"};a.oRegexFormatPatterns={year:/[1-9][0-9]{3}/,period:/[0-9]{3}/,quarter:/[1-4]/,week:/0[1-9]|[1-4][0-9]|5[0-3]/,day:/366|3[0-6][0-9]|[1-2][0-9][0-9]|[1-9][0-9]|[1-9]/,month:/0[1-9]|1[0-2]/};a.oRegexParsePatterns={year:/[0-9]{1,4}/,period:/[0-9]{1,3}/,quarter:/[1-4]/,week:/[0-9]{1,2}/,day:/[1-9]/,month:/[0-9]{1,2}/};a.prototype.oSymbols={"":"",y:{format:a.oRegexFormatPatterns.year,parse:a.oRegexParsePatterns.year},Y:{format:a.oRegexFormatPatterns.year,parse:a.oRegexParsePatterns.year},M:{format:a.oRegexFormatPatterns.month,parse:a.oRegexParsePatterns.month},L:{format:a.oRegexFormatPatterns.month,parse:a.oRegexParsePatterns.month},Q:{format:a.oRegexFormatPatterns.quarter,parse:a.oRegexParsePatterns.quarter},W:{format:a.oRegexFormatPatterns.week,parse:a.oRegexParsePatterns.week},D:{format:a.oRegexFormatPatterns.day,parse:a.oRegexParsePatterns.day},d:{format:a.oRegexFormatPatterns.day,parse:a.oRegexParsePatterns.day}};return a});
/*!
 * SAPUI5
 * (c) Copyright 2009-2023 SAP SE. All rights reserved.
 */
sap.ui.predefine("sap/ui/comp/odata/CalendarMetadata", [],function(){"use strict";var e=["com.sap.vocabularies.Common.v1.IsCalendarDate","com.sap.vocabularies.Common.v1.IsCalendarYear","com.sap.vocabularies.Common.v1.IsCalendarWeek","com.sap.vocabularies.Common.v1.IsCalendarMonth","com.sap.vocabularies.Common.v1.IsCalendarQuarter","com.sap.vocabularies.Common.v1.IsCalendarYearWeek","com.sap.vocabularies.Common.v1.IsCalendarYearMonth","com.sap.vocabularies.Common.v1.IsCalendarYearQuarter"];var a={isDate:function(a){return this._isDefaultTrue(a[e[0]])},isYear:function(a){return this._isDefaultTrue(a[e[1]])},isWeek:function(a){return this._isDefaultTrue(a[e[2]])},isMonth:function(a){return this._isDefaultTrue(a[e[3]])},isQuarter:function(a){return this._isDefaultTrue(a[e[4]])},isYearWeek:function(a){return this._isDefaultTrue(a[e[5]])},isYearMonth:function(a){return this._isDefaultTrue(a[e[6]])},isYearQuarter:function(a){return this._isDefaultTrue(a[e[7]])},isCalendarValue:function(a){return this._isMatching(a,e)},_isMatching:function(e,a){var r=false;for(var n=0;n<a.length;n++){if(this._isDefaultTrue(e[a[n]])){r=true;break}}return r},_isDefaultTrue:function(e){if(e){return e.Bool?e.Bool!=="false":true}return false},updateViewMetadata:function(e){var a=this.getCalendarAnnotationType(e);if((a==="IsCalendarYearQuarter"||a==="IsCalendarYearWeek"||a==="IsCalendarYearMonth")&&e.maxLength){e.maxLength=(parseInt(e.maxLength)+1).toString()}return e},getCalendarAnnotationType:function(a){for(var r=1;r<e.length;r++){var n=a[e[r]];var t=e[r].split(".");if(n&&n.Bool!=="false"&&t){return t[t.length-1]}}return null}};return a});
/*!
 * SAPUI5
 * (c) Copyright 2009-2023 SAP SE. All rights reserved.
 */
sap.ui.predefine("sap/ui/comp/odata/ChartMetadata", [],function(){"use strict";var a={"com.sap.vocabularies.UI.v1.ChartType/Column":"column","com.sap.vocabularies.UI.v1.ChartType/ColumnStacked":"stacked_column","com.sap.vocabularies.UI.v1.ChartType/ColumnDual":"dual_column","com.sap.vocabularies.UI.v1.ChartType/ColumnStackedDual":"dual_stacked_column","com.sap.vocabularies.UI.v1.ChartType/ColumnStacked100":"100_stacked_column","com.sap.vocabularies.UI.v1.ChartType/ColumnStackedDual100":"100_dual_stacked_column","com.sap.vocabularies.UI.v1.ChartType/Bar":"bar","com.sap.vocabularies.UI.v1.ChartType/BarStacked":"stacked_bar","com.sap.vocabularies.UI.v1.ChartType/BarDual":"dual_bar","com.sap.vocabularies.UI.v1.ChartType/BarStackedDual":"dual_stacked_bar","com.sap.vocabularies.UI.v1.ChartType/BarStacked100":"100_stacked_bar","com.sap.vocabularies.UI.v1.ChartType/BarStackedDual100":"100_dual_stacked_bar","com.sap.vocabularies.UI.v1.ChartType/Area":"area","com.sap.vocabularies.UI.v1.ChartType/AreaStacked":"stacked_column","com.sap.vocabularies.UI.v1.ChartType/AreaStacked100":"100_stacked_column","com.sap.vocabularies.UI.v1.ChartType/HorizontalArea":"bar","com.sap.vocabularies.UI.v1.ChartType/HorizontalAreaStacked":"stacked_bar","com.sap.vocabularies.UI.v1.ChartType/HorizontalAreaStacked100":"100_stacked_bar","com.sap.vocabularies.UI.v1.ChartType/Line":"line","com.sap.vocabularies.UI.v1.ChartType/LineDual":"dual_line","com.sap.vocabularies.UI.v1.ChartType/Combination":"combination","com.sap.vocabularies.UI.v1.ChartType/CombinationStacked":"stacked_combination","com.sap.vocabularies.UI.v1.ChartType/CombinationDual":"dual_combination","com.sap.vocabularies.UI.v1.ChartType/CombinationStackedDual":"dual_stacked_combination","com.sap.vocabularies.UI.v1.ChartType/HorizontalCombinationStacked":"horizontal_stacked_combination","com.sap.vocabularies.UI.v1.ChartType/Pie":"pie","com.sap.vocabularies.UI.v1.ChartType/Donut":"donut","com.sap.vocabularies.UI.v1.ChartType/Scatter":"scatter","com.sap.vocabularies.UI.v1.ChartType/Bubble":"bubble","com.sap.vocabularies.UI.v1.ChartType/Radar":"line","com.sap.vocabularies.UI.v1.ChartType/HeatMap":"heatmap","com.sap.vocabularies.UI.v1.ChartType/TreeMap":"treemap","com.sap.vocabularies.UI.v1.ChartType/Waterfall":"waterfall","com.sap.vocabularies.UI.v1.ChartType/Bullet":"bullet","com.sap.vocabularies.UI.v1.ChartType/VerticalBullet":"vertical_bullet","com.sap.vocabularies.UI.v1.ChartType/HorizontalWaterfall":"horizontal_waterfall","com.sap.vocabularies.UI.v1.ChartType/HorizontalCombinationDual":"dual_horizontal_combination","com.sap.vocabularies.UI.v1.ChartType/HorizontalCombinationStackedDual":"dual_horizontal_stacked_combination"};var e="dual_column,dual_stacked_column,100_stacked_column,100_dual_stacked_column,bar,dual_bar,dual_stacked_bar,100_dual_stacked_bar,area,stacked_bar,100_stacked_bar,dual_line,stacked_combination,dual_stacked_combination,horizontal_stacked_combination,pie,donut,heatmap,treemap,bullet,horizontal_waterfall,dual_horizontal_combination,dual_horizontal_stacked_combination";var o={"com.sap.vocabularies.UI.v1.ChartMeasureRoleType/Axis1":"axis1","com.sap.vocabularies.UI.v1.ChartMeasureRoleType/Axis2":"axis2","com.sap.vocabularies.UI.v1.ChartMeasureRoleType/Axis3":"axis3","com.sap.vocabularies.UI.v1.ChartMeasureRoleType/Axis4":"axis4"};var r={"com.sap.vocabularies.UI.v1.ChartDimensionRoleType/Category":"category","com.sap.vocabularies.UI.v1.ChartDimensionRoleType/Series":"series","com.sap.vocabularies.UI.v1.ChartDimensionRoleType/Category2":"category2"};var t=["AcceptanceRangeLowValue","AcceptanceRangeHighValue","ToleranceRangeLowValue","ToleranceRangeHighValue","DeviationRangeLowValue","DeviationRangeHighValue"];var i={mCriticalityType:{},mImprovementDirectionType:{},getChartType:function(e){return a[e]},getIgnoredChartTypesForTimeSeries:function(){return e},getAnnotationChartType:function(e){for(var o in a){if(a[o]===e){return o}}},getMeasureRole:function(a){return o[a]},getAnnotationMeasureRole:function(a){for(var e in o){if(o[e]===a){return e}}},getDimensionRole:function(a){return r[a]},getAnnotationDimensionRole:function(a){for(var e in r){if(r[e]===a){return e}}},getCriticalityThresholds:function(){return t},calculateConstantValue:function(a){var e=a?a.Decimal||a.Int||a.String:undefined;return Number(e)},calculateValue:function(a){var e=a?a.Decimal||a.Int||a.String:undefined;return e},getValueCriticality:function(a){return a["com.sap.vocabularies.UI.v1.ValueCriticality"]||null},getCriticalityType:function(a){return i.mCriticalityType[a]},getImprovementDirectionType:function(a){return i.mImprovementDirectionType[a]},feedWithChartLibrary:function(a){if(!i.chartLibrary){i.chartLibrary=a;var e=a.coloring.CriticalityType;var o=a.coloring.ImprovementDirectionType;i.mCriticalityType={"com.sap.vocabularies.UI.v1.CriticalityType/Neutral":e.Neutral,"com.sap.vocabularies.UI.v1.CriticalityType/Negative":e.Negative,"com.sap.vocabularies.UI.v1.CriticalityType/Critical":e.Critical,"com.sap.vocabularies.UI.v1.CriticalityType/Positive":e.Positive};i.mImprovementDirectionType={"com.sap.vocabularies.UI.v1.ImprovementDirectionType/Target":o.Target,"com.sap.vocabularies.UI.v1.ImprovementDirectionType/Maximize":o.Maximize,"com.sap.vocabularies.UI.v1.ImprovementDirectionType/Minimize":o.Minimize}}}};return i},true);
/*!
 * SAPUI5
 * (c) Copyright 2009-2023 SAP SE. All rights reserved.
 */
sap.ui.predefine("sap/ui/comp/odata/ComboBox", ["sap/m/ComboBox","sap/m/ComboBoxRenderer","sap/ui/comp/util/ComboBoxUtils"],function(e,t,r){"use strict";var s=e.extend("sap.ui.comp.odata.ComboBox",{metadata:{library:"sap.ui.comp",interfaces:["sap.ui.comp.IDropDownTextArrangement"],properties:{textArrangement:{type:"string",group:"Misc",defaultValue:""}},events:{selectedKeyChange:{parameters:{selectedKey:{type:"string"}}}}},renderer:t});s.prototype.onBeforeRendering=function(){e.prototype.onBeforeRendering.apply(this,arguments);this._processTextArrangement();this._processSelectedKeyChange()};s.prototype._processSelectedKeyChange=function(){var e,t,r=this.getSelectedKey();if(r!==this._sKey){e=this.getKeys();t=this.getItemByKey(""+r);if(t&&e.indexOf(r)!==-1){this.fireSelectedKeyChange({selectedKey:r});this._sKey=r}}};s.prototype._processTextArrangement=function(){var e,t=this.getSelectedKey(),s=this.getItemByKey(""+t),o=this.getTextArrangement();if(!o||s===null){return}e=r.formatDisplayBehaviour(s,o);if(e){this.setValue(e)}};return s});
/*!
 * SAPUI5
 * (c) Copyright 2009-2023 SAP SE. All rights reserved.
 */
sap.ui.predefine("sap/ui/comp/odata/CriticalityMetadata", [],function(){"use strict";var i={"com.sap.vocabularies.UI.v1.CriticalityType/Neutral":0,"com.sap.vocabularies.UI.v1.CriticalityType/Negative":1,"com.sap.vocabularies.UI.v1.CriticalityType/Critical":2,"com.sap.vocabularies.UI.v1.CriticalityType/Positive":3,0:0,1:1,2:2,3:3};var t={0:"None",1:"Error",2:"Warning",3:"Success"};var r={0:null,1:"sap-icon://error",2:"sap-icon://alert",3:"sap-icon://sys-enter-2"};var a={getCriticalityState:function(r){if(typeof r==="string"){r=i[r]}return t[r]},getCriticalityIcon:function(t){if(typeof t==="string"){t=i[t]}return r[t]},getShowCriticalityIcon:function(i){return i==="com.sap.vocabularies.UI.v1.CriticalityRepresentationType/WithoutIcon"?false:true}};return a},true);
/*!
 * SAPUI5
 * (c) Copyright 2009-2023 SAP SE. All rights reserved.
 */
sap.ui.predefine("sap/ui/comp/odata/FiscalFormat", ["sap/ui/comp/odata/PeriodDateFormat"],function(e){"use strict";var a=e.extend("sap.ui.comp.odata.FiscalFormat",{metadata:{library:"sap.ui.comp"},constructor:function(a,r){e.apply(this,arguments)}});a.getDateInstance=function(e){return new a(null,e)};a.prototype.getName=function(){return"sap.ui.comp.odata.FiscalFormat"};a.oRegexFormatPatterns={year:/[1-9][0-9]{3}/,period:/[0-9]{3}/,quarter:/[1-4]/,week:/0[1-9]|[1-4][0-9]|5[0-3]/,day:/371|370|3[0-6][0-9]|[1-2][0-9][0-9]|[1-9][0-9]|[1-9]/};a.oRegexParsePatterns={year:/[0-9]{1,4}/,period:/[0-9]{1,3}/,quarter:/[1-4]/,week:/[0-9]{1,2}/,day:/[1-9]/};a.prototype.oSymbols={"":"",y:{format:a.oRegexFormatPatterns.year,parse:a.oRegexParsePatterns.year},Y:{format:a.oRegexFormatPatterns.year,parse:a.oRegexParsePatterns.year},P:{format:a.oRegexFormatPatterns.period,parse:a.oRegexParsePatterns.period},W:{format:a.oRegexFormatPatterns.week,parse:a.oRegexParsePatterns.week},d:{format:a.oRegexFormatPatterns.day,parse:a.oRegexParsePatterns.day},Q:{format:a.oRegexFormatPatterns.quarter,parse:a.oRegexParsePatterns.quarter},q:{format:a.oRegexFormatPatterns.quarter,parse:a.oRegexParsePatterns.quarter}};return a});
/*!
 * SAPUI5
 * (c) Copyright 2009-2023 SAP SE. All rights reserved.
 */
sap.ui.predefine("sap/ui/comp/odata/FiscalMetadata", [],function(){"use strict";var a={isFiscalValue:function(a){for(var s=0;s<this.aAnnotations.length;s++){if(this.isTermDefaultTrue(a[this.aAnnotations[s]])){return true}}return false},isFiscalYear:function(a){return this.isTermDefaultTrue(a["com.sap.vocabularies.Common.v1.IsFiscalYear"])},isFiscalYearPeriod:function(a){return this.isTermDefaultTrue(a["com.sap.vocabularies.Common.v1.IsFiscalYearPeriod"])},getFiscalAnnotationType:function(a){for(var s=0;s<this.aAnnotations.length;s++){var e=a[this.aAnnotations[s]];var o=this.aAnnotations[s].split(".");if(e&&e.Bool!=="false"&&o){return o[o.length-1]}}return null},isTermDefaultTrue:function(a){if(a){return a.Bool?a.Bool!=="false":true}return false},updateViewMetadata:function(a){var s=this.getFiscalAnnotationType(a);if(s==="IsFiscalYearPeriod"||s==="IsFiscalYearQuarter"||s==="IsFiscalYearWeek"){a.maxLength=(parseInt(a.maxLength)+1).toString()}return a},aAnnotations:["com.sap.vocabularies.Common.v1.IsFiscalYear","com.sap.vocabularies.Common.v1.IsFiscalPeriod","com.sap.vocabularies.Common.v1.IsFiscalYearPeriod","com.sap.vocabularies.Common.v1.IsFiscalQuarter","com.sap.vocabularies.Common.v1.IsFiscalYearQuarter","com.sap.vocabularies.Common.v1.IsFiscalWeek","com.sap.vocabularies.Common.v1.IsFiscalYearWeek","com.sap.vocabularies.Common.v1.IsDayOfFiscalYear"]};return a});
/*!
 * SAPUI5
 * (c) Copyright 2009-2023 SAP SE. All rights reserved.
 */
sap.ui.predefine("sap/ui/comp/odata/MetadataAnalyser", ["./ODataType","sap/ui/comp/odata/FiscalMetadata","sap/ui/model/odata/AnnotationHelper","sap/m/library","sap/base/Log","sap/ui/comp/odata/CalendarMetadata"],function(e,t,i,n,a,o){"use strict";var r={"com.sap.vocabularies.Common.v1.FilterExpressionType/SingleInterval":"interval","com.sap.vocabularies.Common.v1.FilterExpressionType/MultiValue":"multi-value","com.sap.vocabularies.Common.v1.FilterExpressionType/SingleValue":"single-value"};var s={"com.sap.vocabularies.UI.v1.SelectionRangeOptionType/EQ":"EQ","com.sap.vocabularies.UI.v1.SelectionRangeOptionType/BT":"BT","com.sap.vocabularies.UI.v1.SelectionRangeOptionType/CP":"CP","com.sap.vocabularies.UI.v1.SelectionRangeOptionType/LE":"LE","com.sap.vocabularies.UI.v1.SelectionRangeOptionType/GE":"GE","com.sap.vocabularies.UI.v1.SelectionRangeOptionType/NE":"NE","com.sap.vocabularies.UI.v1.SelectionRangeOptionType/NB":"NB","com.sap.vocabularies.UI.v1.SelectionRangeOptionType/NP":"NP","com.sap.vocabularies.UI.v1.SelectionRangeOptionType/GT":"GT","com.sap.vocabularies.UI.v1.SelectionRangeOptionType/LT":"LT"};var l={"com.sap.vocabularies.UI.v1.SelectionRangeSignType/I":"I","com.sap.vocabularies.UI.v1.SelectionRangeSignType/E":"E"};var u=n.P13nConditionOperation;var p=function(e){if(typeof e==="object"){this.oModel=e}else{this._sResourceRootUri=e}this._oMetadata=null;if(!this.oModel&&this._sResourceRootUri){a.error("Analyzing metadata cannot be done without an ODataModel!");return}if(this.oModel){this._oMetaModel=this.oModel.getMetaModel()}if(this._oMetaModel){this._oMetadata=this._oMetaModel.getProperty("/")}if(this._oMetadata&&this._oMetadata.dataServices){this._oSchemaDefinition=this._oMetadata.dataServices.schema[0]}};p.hierarchyType={nodeFor:1,nodeExternalKeyFor:2,parentNodeFor:3,levelFor:4,drillStateFor:5,nodeDescendantCountFor:6};p.prototype.getNamespace=function(){if(this._oSchemaDefinition){return this._oSchemaDefinition.namespace}};p.prototype.getSchemaDefinition=function(){return this._oSchemaDefinition};p.prototype.getEntityContainerAttribute=function(e){var t=null,i;if(this._oMetaModel&&e){if(e.indexOf("sap:")<0){e="sap:"+e}i=this._oMetaModel.getODataEntityContainer();t=i[e]||null}return t};p.prototype.getEntityLabelByEntityTypeName=function(e){var t=this._getEntityDefinition(e),i,n="";if(t){i=t["com.sap.vocabularies.Common.v1.Label"];if(i&&i.String){n=i.String}}return n};p.prototype._getEntityDefinition=function(e){var t=null;if(e){t=this._oMetaModel.getODataEntityType(this._getFullyQualifiedNameForEntity(e))}return t};p.prototype._getComplexTypeDefinition=function(e){var t=null;if(e){t=this._oMetaModel.getODataComplexType(this._getFullyQualifiedNameForEntity(e))}return t};p.prototype._getNameOfPropertyUsingComplexType=function(e,t){var i;if(this._oSchemaDefinition){i=this._oSchemaDefinition.namespace}if(e&&t&&i){var n=i+"."+t;var a=this._getEntityDefinition(e);if(a){var o=a.property;if(o&&o.length){var r=0;for(r=0;r<o.length;r++){var s=o[r];if(s&&s.type===n){return s.name}}}}}return null};p.prototype.removeNamespace=function(e){var t,i=e;if(e){t=e.lastIndexOf(".")+1}if(t>0){i=e.substring(t)}return i};p.prototype.getEntityTypeNameFromEntitySetName=function(e){var t=null,i=null;if(this._oMetaModel){t=this._oMetaModel.getODataEntitySet(e);if(t){i=t.entityType}}return i};p.prototype.getEntitySetNameFromEntityTypeName=function(e){var t,i,n,a,o,r;if(this._oMetaModel&&e){t=this._getFullyQualifiedNameForEntity(e);i=this._oMetaModel.getODataEntityContainer();if(i&&t){n=i.entitySet;o=n.length;for(a=0;a<o;a++){r=n[a];if(r.entityType===t){break}r=null}if(r){return r.name}}}return null};p.prototype.getKeysByEntitySetName=function(e){var t=null,i=null;if(!this._oMetaModel){return undefined}i=this.getEntityTypeNameFromEntitySetName(e);if(i){t=this.getKeysByEntityTypeName(i)}return t};p.prototype.getKeysByEntityTypeName=function(e){var t=null,i=null,n,a=0,o=null;if(!this._oMetaModel){return undefined}o=this._getEntityDefinition(e);if(o){if(o.key){i=o.key.propertyRef;if(i){a=i.length;t=[];for(n=0;n<a;n++){t.push(i[n].name)}}}}return t};p.prototype.getFieldsByEntitySetName=function(e){var t=null,i,n=null;if(!this._oMetaModel){return undefined}i=this._oMetaModel.getODataEntitySet(e);if(i){n=i.entityType}if(n){t=this.getFieldsByEntityTypeName(n);this._enrichEntitySetMetadata(t,i)}return t};p.prototype._enrichEntitySetMetadata=function(e,t){var i,n,a,o,r,s;a=this._getNonSortableFields(t);o=this._getNonFilterableFields(t);r=this._getRequiredFilterFields(t);s=this._getFilterExpressionRestriction(t);i=e.length;while(i--){n=e[i];n.sortable=!(a.indexOf(n.name)>-1);n.filterable=!(o.indexOf(n.name)>-1);n.requiredFilterField=r.indexOf(n.name)>-1;n.filterRestriction=s[n.name]}};p.prototype._extractPropertyPathsFromAnnotation=function(e,t){var i=[],n,a,o;if(e&&t){n=e[t]}if(n){a=n.length;while(a--){o=n[a].PropertyPath;if(o){i.push(o)}}}return i};p.prototype._getNonSortableFields=function(e){var t;if(e){t=e["Org.OData.Capabilities.V1.SortRestrictions"]}return this._extractPropertyPathsFromAnnotation(t,"NonSortableProperties")};p.prototype._getNonFilterableFields=function(e){var t;if(e){t=e["Org.OData.Capabilities.V1.FilterRestrictions"]}return this._extractPropertyPathsFromAnnotation(t,"NonFilterableProperties")};p.prototype._getRequiredFilterFields=function(e){var t;if(e){t=e["Org.OData.Capabilities.V1.FilterRestrictions"]}return this._extractPropertyPathsFromAnnotation(t,"RequiredProperties")};p.prototype._getFilterExpressionRestriction=function(e){var t={},i,n,a,o,s;if(e){var l=e["Org.OData.Capabilities.V1.FilterRestrictions"];if(l){i=l["FilterExpressionRestrictions"];if(i){for(var u=0;u<i.length;u++){o=i[u].Property;s=i[u].AllowedExpressions;if(s&&s.String){switch(s.String){case"SingleValue":t[o.PropertyPath]="single-value";break;case"MultiValue":t[o.PropertyPath]="multi-value";break;case"SingleRange":t[o.PropertyPath]="interval";break;case"SearchExpression":t[o.PropertyPath]="search-expression";break;default:}}}}}if(i==undefined){i=e["com.sap.vocabularies.Common.v1.FilterExpressionRestrictions"];if(i){n=i.length;while(n--){a=i[n];if(a){o=a.Property;s=a.AllowedExpressions;if(o&&s&&o.PropertyPath&&s.EnumMember){t[o.PropertyPath]=r[s.EnumMember]}}}}}}return t};p.prototype._isFilterable=function(e,t){var i,n=true;if(t){i=this._getNonFilterableFields(t);n=!(i.indexOf(e.name)>-1)}if(n){n=!(e["sap:filterable"]==="false")}return n};p.isHiddenFilter=function(e){return!!e["com.sap.vocabularies.UI.v1.HiddenFilter"]&&p.isTermDefaultTrue(e["com.sap.vocabularies.UI.v1.HiddenFilter"])};p.isHidden=function(e){return!!e["com.sap.vocabularies.UI.v1.Hidden"]&&p.isTermDefaultTrue(e["com.sap.vocabularies.UI.v1.Hidden"])};p.prototype.getFieldsByEntityTypeName=function(e){var t;if(!this._oMetaModel){return undefined}t=this._getEntityDefinition(e);return this._getFieldsByEntityDefinition(t)};p.prototype.getFieldsByComplexTypeName=function(e,t){var i;if(!this._oMetaModel){return undefined}i=this._getComplexTypeDefinition(e);return this._getFieldsByEntityDefinition(i,t)};p.prototype.getAllEntityTypeNames=function(){if(!this._oMetaModel){return undefined}var e=this._oSchemaDefinition;if(e.entityType&&e.entityType.length>0){var t=0;var i=[];for(t=0;t<e.entityType.length;t++){i.push(e.entityType[t].name)}return i}return null};p.prototype.getFieldSemanticObjectMap=function(e){var t=this.getFieldsByEntitySetName(e);if(!t){return null}var i={},n,a=t.length;for(n=0;n<a;n++){var o=t[n];var r=this.getSemanticObjectAnnotation(o.fullName);if(r&&r.semanticObject){i[o.name]=r.semanticObject}}return i};p.prototype._getFieldsByEntityDefinition=function(e,t){var i=null,n=null,a=0,o=0,r,s;if(e){n=e.property}if(n){i=[];o=n.length;for(a=0;a<o;a++){r=n[a];if(r){s=this._parseV4PropertyAnnotations(r,e,t);this._determineHierarchyInformation(s,r);this._determineFilterAndSortInformation(s,r,null);i.push(s)}}}return i};p.prototype.getPropertyContextByPath=function(e){var t,i,n,a,o;if(e&&this._oMetaModel){t=e.split("/");i=this._oMetaModel.getODataEntityType(t[0])||this._oMetaModel.getODataComplexType(t[0]);n=t[1];a=this._oMetaModel.getODataProperty(i,n,true);if(a){o=this._oMetaModel.createBindingContext(a)}}return o};p.getDisplayFormat=function(e){var t=e["sap:display-format"];if(t){return t}};p.isCalendarDate=function(e){return p.isPropertyStringType(e)&&p.isTermDefaultTrue(e["com.sap.vocabularies.Common.v1.IsCalendarDate"])};p.isFiscalDate=function(e){return t.isFiscalValue(e)};p.isCalendarType=function(e){return o.isCalendarValue(e)};p.getTimezonePropertyPath=function(e){if(e["type"]!=="Edm.DateTimeOffset"){return undefined}var t=e["com.sap.vocabularies.Common.v1.Timezone"];return t?t.Path:undefined};p.getIsTimezoneProperty=function(e){if(e["type"]!=="Edm.String"){return undefined}return e["com.sap.vocabularies.Common.v1.IsTimezone"]&&e["com.sap.vocabularies.Common.v1.IsTimezone"].Bool!=="false"};p.hasValueListRelevantQualifiers=function(e){var t=false;if(e&&e["com.sap.vocabularies.Common.v1.ValueListRelevantQualifiers"]){t=true}return t};p.getAggregationRole=function(e){if(e["com.sap.vocabularies.Analytics.v1.Dimension"]){return"dimension"}if(e["com.sap.vocabularies.Analytics.v1.Measure"]){return"measure"}return undefined};p.getLinkDisplayFormat=function(e){if(p.isEmailAddress(e)){return"EmailAddress"}if(p.isPhoneNumber(e)){return"PhoneNumber"}if(p.isURL(e)){return"URL"}return""};p.getValueListMode=function(e){if(p.isValueListWithFixedValues(e)){return"fixed-values"}var t=e["sap:value-list"];if(t){return t}return""};p.isTermTrue=function(e){return!!e&&e.Bool==="true"};p.isPropertyStringType=function(e){return!!e&&e.type==="Edm.String"};p.isTermDefaultTrue=function(e){if(e){return e.Bool?e.Bool!=="false":true}return false};p.isNullable=function(e){return!(e&&e.nullable==="false")};p.isSkippingMeasuredQuantityCheck=function(e){var t="com.sap.vocabularies.UI.v1.DoNotCheckScaleOfMeasuredQuantity";return p.isTermTrue(e[t])};p.isDigitSequence=function(e){return p.isPropertyStringType(e)&&p.isTermDefaultTrue(e["com.sap.vocabularies.Common.v1.IsDigitSequence"])};p.isUpperCase=function(e){return p.isPropertyStringType(e)&&p.isTermDefaultTrue(e["com.sap.vocabularies.Common.v1.IsUpperCase"])};p.isEmailAddress=function(e){return p.isPropertyStringType(e)&&p.isTermDefaultTrue(e["com.sap.vocabularies.Communication.v1.IsEmailAddress"])};p.isPhoneNumber=function(e){return p.isPropertyStringType(e)&&p.isTermDefaultTrue(e["com.sap.vocabularies.Communication.v1.IsPhoneNumber"])};p.isURL=function(e){return p.isPropertyStringType(e)&&(p.isTermDefaultTrue(e["Org.OData.Core.V1.IsURL"])||p.isTermDefaultTrue(e["Org.OData.Core.V1.IsUrl"]))};p.isValueList=function(e){var t="com.sap.vocabularies.Common.v1.ValueList";return!!(e&&(e["sap:value-list"]||e[t]))};p.isRecommendationList=function(e){return!!(e&&e["com.sap.vocabularies.UI.v1.RecommendationList"])};p.isCurrencyCode=function(e){return!!(e&&e["sap:semantics"]==="currency-code")};p.isUnitOfMeasure=function(e){return!!(e&&e["sap:semantics"]==="unit-of-measure")};p.isValueListWithFixedValues=function(e){var t="com.sap.vocabularies.Common.v1.ValueListWithFixedValues";return p.isTermTrue(e[t])};p.hasImportance=function(e){return!!(e&&e["com.sap.vocabularies.UI.v1.Importance"])};p.prototype._parseProperty=function(e,t,i){var n=this._parseV4PropertyAnnotations(e,t,i);this._determineHierarchyInformation(n,e);this._determineFilterAndSortInformation(n,e,null);return n};p.prototype._parseV4PropertyAnnotations=function(e,t,i){var n=Object.assign({},e);var a=e["com.sap.vocabularies.Common.v1.Label"];if(a){n.fieldLabel=a.String}a=e["com.sap.vocabularies.Common.v1.QuickInfo"];if(a){n.quickInfo=a.String}n.displayFormat=p.getDisplayFormat(e);n.isDigitSequence=p.isDigitSequence(e);n.isURL=p.isURL(e);n.isEmailAddress=p.isEmailAddress(e);n.isPhoneNumber=p.isPhoneNumber(e);n.isUpperCase=p.isUpperCase(e);n.isCalendarDate=p.isCalendarDate(e);n.isCalendarType=p.isCalendarType(e);n.calendarType=o.getCalendarAnnotationType(e);n.isFiscalDate=p.isFiscalDate(e);n.timezone=p.getTimezonePropertyPath(e);n.isTimezone=p.getIsTimezoneProperty(e);n.aggregationRole=p.getAggregationRole(e);a=e["Org.OData.Measures.V1.ISOCurrency"];if(a){n.isCurrencyField=true;n.isMeasureField=true;n.unit=a.Path}a=e["Org.OData.Measures.V1.Unit"];if(a){n.isMeasureField=true;n.unit=a.Path}a=e["com.sap.vocabularies.Common.v1.Text"];if(a){n.description=a.Path;n.displayBehaviour=this.getTextArrangementValue(a)}else if(e["com.sap.vocabularies.UI.v1.TextArrangement"]){n.displayBehaviour=this.getTextArrangementValue(e)}a=e["com.sap.vocabularies.UI.v1.IsImageURL"]||e["com.sap.vocabularies.UI.v1.IsImageUrl"];n.isImageURL=p.isTermDefaultTrue(a);n.entityName=t.name;n.parentPropertyName=i;n.fullName=this._getFullyQualifiedNameForField(e.name,t);a=e["com.sap.vocabularies.Common.v1.FieldControl"];n.visible=!(a&&(a.EnumMember==="com.sap.vocabularies.Common.v1.FieldControlType/Hidden"||a.EnumMember==="com.sap.vocabularies.Common.v1.FieldControlType/Inapplicable"));n.visible=n.visible&&!p.isHidden(e);n.hiddenFilter=p.isHiddenFilter(e);if(e["defaultValue"]!==undefined){n.defaultPropertyValue=e["defaultValue"]}a=e["com.sap.vocabularies.Common.v1.FilterDefaultValue"];if(a){n.defaultFilterValue=this._getDefaultValues(e.type,a,e)}return n};p.prototype._determineHierarchyInformation=function(e,t){var i={field:null,type:null};if(t["sap:hierarchy-node-for"]!=null){i.field=t["sap:hierarchy-node-for"];i.type=p.hierarchyType.nodeFor}if(t["sap:hierarchy-node-external-key-for"]!=null){i.field=t["sap:hierarchy-node-external-key-for"];i.type=p.hierarchyType.nodeExternalKeyFor}if(t["sap:hierarchy-parent-node-for"]!=null){i.field=t["sap:hierarchy-parent-node-for"];i.type=p.hierarchyType.parentNodeFor}if(t["sap:hierarchy-level-for"]!=null){i.field=t["sap:hierarchy-level-for"];i.type=p.hierarchyType.levelFor}if(t["sap:hierarchy-drill-state-for"]!=null){i.field=t["sap:hierarchy-drill-state-for"];i.type=p.hierarchyType.drillStateFor}if(t["sap:hierarchy-node-descendant-count-for"]!=null){i.field=t["sap:hierarchy-node-descendant-count-for"];i.type=p.hierarchyType.nodeDescendantCountFor}if(i.type!=null){e.hierarchy=i}};p.prototype._determineFilterAndSortInformation=function(e,t,i){if(i){this._enrichEntitySetMetadata([e],i)}if(e.filterable==undefined||e.filterable){e.filterable=t["sap:filterable"]!=="false"}if(!e.filterRestriction&&t["sap:filter-restriction"]){e.filterRestriction=t["sap:filter-restriction"]}if(!e.requiredFilterField){e.requiredFilterField=t["sap:required-in-filter"]==="true"}if(e.sortable==undefined||e.sortable){e.sortable=t["sap:sortable"]!=="false"}};p.prototype._getDefaultValues=function(t,i,n){var o=null,r=e.getDefaultValueTypeName(t);if(i[r]){o=i[r]}else{a.error("default value for "+n.name+" expected through the property "+r)}return o};p.prototype.extractNavigationPropertyField=function(e,t){var i,n,a,o,r,s,l,u=null;if(t&&e){i="/"+t+"/";o=e.split("/");r=o.pop();s=o.join("/");if(s&&r){n=this._oMetaModel.getMetaContext(i+s);if(n){l=this._oMetaModel.getProperty(n.getPath())}}if(l){a=this._oMetaModel.getODataProperty(l,r)}if(a){u=this._parseV4PropertyAnnotations(a,l,s);u.name=e;var p=this._oMetaModel.getODataEntitySet(t);this._determineFilterAndSortInformation(u,a,p);u.name=a.name}}return u};p.prototype.getAllFilterableFieldNamesByEntityTypeName=function(e){var t,i,n,a,o,r,s;r=[];t=this.getAllFilterableFieldsByEntityTypeName(e);if(t&&t.length){n=t.length;for(i=0;i<n;i++){s=t[i];if(s.fields&&s.fields.length){o=s.fields.length;for(a=0;a<o;a++){r.push(s.fields[a].name)}}}}return r};p.prototype._getAllFilterableFieldsByEntity=function(e,t,i,n){var a=[],o,r,s,l,u,p,f,c;if(!this._oMetaModel||!e){return undefined}if(t){r=this._oMetaModel.getODataEntitySet(e);if(r){o=this._getEntityDefinition(r.entityType)}}else{o=this._getEntityDefinition(e)}if(o){a.push(this._getFilterableFieldsFromEntityDefinition(o,undefined,r));s=this._getFilterableAssociations(o,r);for(l in s){if(!n||n.indexOf(l)>-1){c=s[l];if(t){u=this._oMetaModel.getODataAssociationSetEnd(o,l);if(u.entitySet){f=this._oMetaModel.getODataEntitySet(u.entitySet)}}p=this._getEntityDefinition(c);if(p){if(i&&p["sap:semantics"]==="parameters"){continue}a.push(this._getFilterableFieldsFromEntityDefinition(p,l,f))}}}}return a};p.prototype._getAllFilterableFieldsByEntityForAllEndpoints=function(e,t,i,n){var a=[],o,r,s,l,u,p,f,c;if(!this._oMetaModel||!e){return undefined}if(t){r=this._oMetaModel.getODataEntitySet(e);if(r){o=this._getEntityDefinition(r.entityType)}}else{o=this._getEntityDefinition(e)}if(o){a.push(this._getFilterableFieldsFromEntityDefinition(o,undefined,r));s=this._getAssociations(o,r,true,true);for(l in s){if(!n||n.indexOf(l)>-1){c=s[l];if(t){u=this._oMetaModel.getODataAssociationSetEnd(o,l);if(u.entitySet){f=this._oMetaModel.getODataEntitySet(u.entitySet)}}p=this._getEntityDefinition(c);if(p){if(i&&p["sap:semantics"]==="parameters"){continue}a.push(this._getFilterableFieldsFromEntityDefinition(p,l,f))}}}}return a};p.prototype.getAllFilterableFieldsByEntitySetName=function(e,t,i){if(!this._oMetaModel){return undefined}return this._getAllFilterableFieldsByEntity(e,true,t,i)};p.prototype.getAllFilterableFieldsByEntityTypeName=function(e){if(!this._oMetaModel){return undefined}return this._getAllFilterableFieldsByEntity(e)};p.prototype._getFilterableFieldsFromEntityDefinition=function(e,t,i){var n={},o=[],r=[],s=null,l,u,p,f=null;if(!this._oMetaModel||!e){return undefined}if(!i){a.error("mandatory parameter 'oEntitySet' not set or null.")}else{l=e["com.sap.vocabularies.Common.v1.Label"];if(l){n.groupLabel=l.String}n.groupEntitySetName=i.name;n.groupEntityTypeName=e.name;n.groupName=t;s=this._getFieldsByEntityDefinition(e,t);if(i){this._enrichEntitySetMetadata(s,i)}p=s.length;for(u=0;u<p;u++){f=s[u];if(f.filterable){if(f.visible){f.groupEntitySet=n.groupEntitySetName;f.groupEntityType=n.groupEntityTypeName;o.push(f)}else{r.push(f)}}}}n.fields=o;n.hiddenFields=r;return n};p.prototype._getFullyQualifiedNameForField=function(e,t){var i,n,a=e;if(t){i=t.namespace;n=t.name}if(i&&n){a=i+"."+n+"/"+e}return a};p.prototype.getFieldNameByFullyQualifiedFieldName=function(e){var t,i;t=this.removeNamespace(e);i=t.indexOf("/");t=t.substring(i+1);return t};p.prototype._getFilterableAssociations=function(e,t){return this._getAssociations(e,t,true,false)};p.prototype._getAssociations=function(e,t,i,n){var a={},o=null,r=null,s,l=0,u=null;if(!this._oMetaModel||!e){return undefined}o=e.navigationProperty;if(o&&o.length){l=o.length;for(s=0;s<l;s++){r=o[s];if(i){if(!this._isFilterable(r,t)||p.isHiddenFilter(r)){continue}}u=this._oMetaModel.getODataAssociationEnd(e,r.name);if(!u||u.type===e.namespace+"."+e.name){continue}if(n||u.multiplicity==="1"||u.multiplicity==="0..1"){if(a[r.name]===undefined){a[r.name]=u.type}}}}return a};p.prototype.getParametersByEntitySetName=function(e){var t,i,n,a,o,r,s,l,u,p,f;f=this._oMetaModel.getODataEntitySet(e);if(f){u=this._getEntityDefinition(f.entityType)}i=this._getAssociations(u,null,false,false);for(a in i){r=i[a];l=this._oMetaModel.getODataAssociationSetEnd(u,a);if(l.entitySet){p=this._getEntityDefinition(r);if(p){if(p["sap:semantics"]==="parameters"&&p.key){t={entitySetName:l.entitySet,parameters:[],navPropertyName:""};for(var c=0;c<p.key.propertyRef.length;c++){t.parameters.push(p.key.propertyRef[c].name)}n=this._getAssociations(p,null,false,true);for(o in n){s=n[o];if(s===f.entityType){t.navPropertyName=o;break}}return t}}}}return null};p.prototype.getValueListAnnotationLazy=function(e,t){var i,n,a,o,r={additionalAnnotations:[],additionalAnnotationsWithPVQualifier:[]},s,l,u,f,c;o=new Promise(function(o,m){if(e&&this._oMetaModel){f=this.getPropertyContextByPath(e);u=e.split("/");l=u[1];if(f){i=f.getObject&&f.getObject();if(t&&p.hasValueListRelevantQualifiers(i)){a=this.oModel.getContext(t);n=this.getODataRelevantValueLists(f,a)}else{n=this._oMetaModel.getODataValueLists(f)}n.then(function(e){for(c in e){s={annotation:e[c]};if(s.annotation){this._enrichValueHelpAnnotation(s,l);if(!s.annotation["PresentationVariantQualifier"]){if(!c){r.primaryValueListAnnotation=s}else{r.additionalAnnotations.push(s)}s.qualifier=c}else{if(!c){r.primaryValueListAnnotationWithPVQualifier=s}else{s.qualifier=c;r.additionalAnnotationsWithPVQualifier.push(s)}}}}if(!r.primaryValueListAnnotation){r.primaryValueListAnnotation=r.additionalAnnotations.shift()}o(r)}.bind(this),m);return}}m()}.bind(this));return o};p.prototype.getODataRelevantValueLists=function(e,t){return this._oMetaModel.getODataValueLists(e).then(function(i){var n,a={},o=this._getODataValueListRelevantQualifiers(e,t),r=Array.isArray(o)&&o.length>0;for(n in i){if(r&&o.indexOf(n)!==-1){a[n]=i[n]}}return a}.bind(this))};p.prototype._getODataValueListRelevantQualifiers=function(e,t){var i,n=t.getModel(),a=e.getObject(),o=a["com.sap.vocabularies.Common.v1.ValueListRelevantQualifiers"];if(Array.isArray(o)&&n!==undefined){i=o.filter(function e(i){var a,o,r,s,l=false,u=i["If"],p=i["String"];if(p||p===""){l=true}else if(this._isBooleanStatement(u)){o=u[0]["Path"];s=n.getObject(o,t);if(s===true){l=true}}else if(u){a=u[0]["Eq"];o=a[0]["Path"];r=a[1]["String"];s=n.getObject(o,t);if(r===s){l=true}}return l}.bind(this)).map(function e(t){var i,n=t["If"],a=t["String"];if(a||a===""){i=a}else if(n){i=n[1]&&n[1]["String"]}return i})}return i};p.prototype._isBooleanStatement=function(e){var t=false;if(e&&e[0]&&e[0]["Eq"]===undefined&&e[0]["Path"]!==undefined){t=true}return t};p.prototype.getValueListAnnotationForFunctionImport=function(e,t){var i={additionalAnnotations:[]},n,a;for(a in e){n={annotation:e[a]};if(n.annotation){this._enrichValueHelpAnnotation(n,t);if(!a){i.primaryValueListAnnotation=n}else{n.qualifier=a;i.additionalAnnotations.push(n)}}}return i};p.prototype.getValueListAnnotation=function(e){var t={additionalAnnotations:[]},i,n,a,o,r,s;if(e&&this._oMetaModel){a=e.split("/");o=this._oMetaModel.getODataEntityType(a[0])||this._oMetaModel.getODataComplexType(a[0]);r=this._oMetaModel.getODataProperty(o,a[1]);if(r){n=r.name;for(var l in r){if(l==="com.sap.vocabularies.Common.v1.ValueList"||l.indexOf("com.sap.vocabularies.Common.v1.ValueList#")>-1){s=null;i={annotation:r[l]};a=l.split("#");if(a.length===2){s=a[1]}if(i.annotation){this._enrichValueHelpAnnotation(i,n);if(!s){t.primaryValueListAnnotation=i}else{i.qualifier=s;t.additionalAnnotations.push(i)}}}}}}return t};p.prototype._getRecommendationListAnnotation=function(e){var t=e.split("/"),i=this._oMetaModel.getODataEntityType(t[0])||this._oMetaModel.getODataComplexType(t[0]),n=t[1],a=this._oMetaModel.getODataProperty(i,n,true),o=this._oMetaModel.createBindingContext(a),r=o.getObject();return r["com.sap.vocabularies.UI.v1.RecommendationList"]};p.prototype._enrichValueHelpAnnotation=function(e,t){var i,n,a,o,r=[],s,l={},u={},f={},c,m,y,d=[],h=[],g,v,b,M,_,F,S=0,T=0,P=0,D=0,E,O=[],A=[];if(e&&e.annotation){i=e.annotation;if(i){n=i["SearchSupported"];e.isSearchSupported=n?n.Bool==="true":false;n=i["CollectionPath"];if(n){e.valueListEntitySetName=n.String;a=this.getVLEntitySets(e.valueListEntitySetName);o=a[0];if(o){e.valueListEntityName=o.entityType;e.valueListEntitySetName=o.name;e.semantics=o["sap:semantics"];r=this.getKeysByEntitySetName(o.name);d=this.getFieldsByEntitySetName(o.name)}}n=i["Label"];if(n){e.valueListTitle=n.String}g=i["Parameters"];if(d&&g){S=g.length}for(T=0;T<S;T++){F=g[T];b=undefined;M=undefined;_=undefined;v=F["ValueListProperty"];b=this.getVLProperty(v,a);v=F["LocalDataProperty"];if(v){M=v.PropertyPath}v=F["Constant"];if(v){_=v[Object.keys(v)[0]]}c=false;if(F.RecordType==="com.sap.vocabularies.Common.v1.ValueListParameterInOut"||F.RecordType==="com.sap.vocabularies.Common.v1.ValueListParameterIn"){c=true}m=false;if(F.RecordType==="com.sap.vocabularies.Common.v1.ValueListParameterInOut"||F.RecordType==="com.sap.vocabularies.Common.v1.ValueListParameterOut"){m=true}y=false;if(F.RecordType==="com.sap.vocabularies.Common.v1.ValueListParameterConstant"){y=true}if(F.InitialValueIsSignificant&&F.InitialValueIsSignificant.Bool==="true"&&(F.RecordType==="com.sap.vocabularies.Common.v1.ValueListParameterIn"||F.RecordType==="com.sap.vocabularies.Common.v1.ValueListParameterConstant")){A.push(b)}if(c){l[M]=b}if(m){u[M]=b}if(y){f[b]=_}if(m||F.RecordType==="com.sap.vocabularies.Common.v1.ValueListParameterDisplayOnly"){D=d.length;while(D--){if(d[D].name===b){h.push(d[D]);break}}}if(!s&&m&&M===t){s=b}if(p.hasImportance(F)&&this._getImportanceAnnotation(F)==="High"){for(P=0;P<d.length;P++){E=d[P];if(E.name===b){O.push(E);break}}}}}e.inParams=l;e.outParams=u;e.constParams=f;e.fields=d;e.valueListFields=h;e.aHighImportanceFields=O;e.keys=r;e.keyField=s;e.descriptionField=this.getDescriptionFieldName(e.keyField,e.valueListEntitySetName);e.deprecationCodeField=this.getDeprecationCodeFieldName(d);e.aInitialValueIsSignificantFields=A}};p.prototype.getVLEntitySets=function(e){var t;if(this._oMetaModel){t=this._oMetaModel.getODataEntitySet(e)}return[t]};p.prototype.getVLProperty=function(e){var t;if(e){t=e.String}return t};p.prototype._enrichRecommendationListAnnotation=function(e){var t={},i=[],n,a;t.annotation=e;a=e["CollectionPath"];if(a){t.path=a.String}a=e["RankProperty"];if(a){t.rankProperty=a.String}a=e["Binding"];if(a){i=a}if(this._oMetaModel&&t.path){n=this._oMetaModel.getODataEntitySet(t.path)}if(n){t.entityName=n.name;t.keys=this.getKeysByEntitySetName(n.name);t.fields=this.getFieldsByEntitySetName(n.name);t.rankField=t.fields.filter(function(e){return e.name===t.rankProperty})}i=i.map(function(e){var i=0;while(i<t.fields.length){if(t.fields[i].name===e.RecommendationListProperty.String){return t.fields[i]}i++}return false});t.fieldsToDisplay=i.concat(t.rankField);return t};p.prototype.getDescriptionFieldName=function(e,t){var i,n=0,a,o,r;if(typeof e==="object"){o=e}else{i=this.getFieldsByEntitySetName(t);if(i){a=i.length;for(n=0;n<a;n++){o=i[n];if(o.name===e){break}o=null}}}if(o&&o["com.sap.vocabularies.Common.v1.Text"]){r=o["com.sap.vocabularies.Common.v1.Text"].Path}return r};p.prototype.getDeprecationCodeFieldName=function(e){var t=0,i,n,a;for(t=0,i=e.length;t<i;t++){n=e[t];if(p.isTermDefaultTrue(n["com.sap.vocabularies.CodeList.v1.IsConfigurationDeprecationCode"])){a=n.name;break}}return a};p.prototype.getIsSearchSupported=function(e){var t=false,i;if(e){i=e.SearchSupported;if(i&&i.Bool==="true"){t=true}}return t};p.prototype.getValueListSemantics=function(e){var t,i,n;if(e){t=e["CollectionPath"]?e["CollectionPath"].String:undefined}if(t){i=this._oMetaModel.getODataEntitySet(t);if(i){n=i["sap:semantics"]}}return n};p.prototype.getLineItemAnnotation=function(e,t){var i,n,a,o;if(e&&this._oMetaModel){i=this._oMetaModel.getODataEntityType(e);if(i){n="com.sap.vocabularies.UI.v1.LineItem";if(t){n+="#"+t}a=i[n];if(a){o={annotation:a};this._enrichAnnotationWithUIDataField(o,a)}}}return o};p.prototype.isSemanticAggregation=function(e){var t;if(e&&this._oMetaModel){t=this._oMetaModel.getODataEntityType(e);if(t){return t["sap:semantics"]==="aggregate"}}return false};p.prototype.getPresentationVariantAnnotation=function(e,t){var i,n,a,o,r,s,l,u,p;if(e&&this._oMetaModel){i=this._oMetaModel.getODataEntityType(e);if(i){n="com.sap.vocabularies.UI.v1.PresentationVariant";if(t){n+="#"+t}a=i[n];if(a){s={annotation:a,requestAtLeastFields:[],sortOrderFields:[],groupByFields:[],maxItems:undefined};if(a.Visualizations){o=a.Visualizations.length;for(r=0;r<o;r++){p=a.Visualizations[r].AnnotationPath;if(!l&&(p==="@com.sap.vocabularies.UI.v1.LineItem"||p.indexOf("@com.sap.vocabularies.UI.v1.LineItem#")>-1)){l=i[p.substring(1)];s.lineItemAnnotation={annotation:l};this._enrichAnnotationWithUIDataField(s.lineItemAnnotation,l)}else if(!u&&(p==="@com.sap.vocabularies.UI.v1.Chart"||p.indexOf("@com.sap.vocabularies.UI.v1.Chart#")>-1)){u=i[p.substring(1)];s.chartAnnotation={annotation:u,semantics:i["sap:semantics"]};this._enrichChartAnnotation(s.chartAnnotation,u)}if(l&&u){break}}}if(a.RequestAtLeast){o=a.RequestAtLeast.length;for(r=0;r<o;r++){s.requestAtLeastFields.push(a.RequestAtLeast[r].PropertyPath)}}if(a.SortOrder){o=a.SortOrder.length;for(r=0;r<o;r++){s.sortOrderFields.push({name:a.SortOrder[r].Property.PropertyPath,descending:a.SortOrder[r].Descending?a.SortOrder[r].Descending.Bool==="true":false})}}if(a.GroupBy){o=a.GroupBy.length;for(r=0;r<o;r++){s.groupByFields.push(a.GroupBy[r].PropertyPath)}}if(a.MaxItems){s.maxItems=a.MaxItems.Int}}}}return s};p.prototype._getPresentationVariantQualifierForVHD=function(e){var t,i,n,a,o;if(e&&this._oMetaModel){t=this._oMetaModel.getODataEntityType(e);i="com.sap.vocabularies.UI.v1.PresentationVariant";for(o in t){if(o.indexOf(i+"#")>-1){a=o.split("#");if(a.length===2){n=a[1]}}}}return n||""};p.prototype._enrichChartAnnotation=function(e,t){var i,n,a;if(e&&t){e.measureFields=[];e.dimensionFields=[];e.measureAttributes={};e.dimensionAttributes={};if(t.ChartType&&t.ChartType.EnumMember){e.chartType=t.ChartType.EnumMember}if(t.Measures){n=t.Measures.length;for(i=0;i<n;i++){e.measureFields.push(t.Measures[i].PropertyPath)}}if(t.MeasureAttributes){n=t.MeasureAttributes.length;for(i=0;i<n;i++){a=t.MeasureAttributes[i];if(a.Measure){e.measureAttributes[a.Measure.PropertyPath]={role:a.Role?a.Role.EnumMember:null,dataPoint:a.DataPoint?a.DataPoint.AnnotationPath:null}}}}if(t.Dimensions){n=t.Dimensions.length;for(i=0;i<n;i++){e.dimensionFields.push(t.Dimensions[i].PropertyPath)}}if(t.DimensionAttributes){n=t.DimensionAttributes.length;for(i=0;i<n;i++){a=t.DimensionAttributes[i];if(a.Dimension){e.dimensionAttributes[a.Dimension.PropertyPath]={role:a.Role?a.Role.EnumMember:null,hierarchyLevel:a.HierarchyLevel?a.HierarchyLevel.Int:0}}}}}};p.prototype.getChartAnnotation=function(e,t){var i,n,a,o;if(e&&this._oMetaModel){i=this._oMetaModel.getODataEntityType(e);if(i){o="com.sap.vocabularies.UI.v1.Chart";if(t){o+="#"+t}n=i[o];if(n){a={annotation:n,semantics:i["sap:semantics"]};this._enrichChartAnnotation(a,n)}}}return a};p.prototype.getDataPointAnnotation=function(e){var t,i,n,a,o,r={};if(e&&this._oMetaModel){t=this._oMetaModel.getODataEntityType(e);if(t){for(i in t){if(i==="com.sap.vocabularies.UI.v1.DataPoint"||i.indexOf("com.sap.vocabularies.UI.v1.DataPoint#")>-1){n=null;o=t[i];a=i.split("#");if(a.length===2){n=a[1]}if(o){if(n){if(!r.additionalAnnotations){r.additionalAnnotations={}}r.additionalAnnotations[n]=o}else{r.primaryAnnotation=o}}}}}}return r};p.prototype.getFieldGroupAnnotation=function(e){var t,i,n,a,o,r,s=[];if(e&&this._oMetaModel){t=this._oMetaModel.getODataEntityType(this._getFullyQualifiedNameForEntity(e));if(t){for(var l in t){if(l==="com.sap.vocabularies.UI.v1.FieldGroup"||l.indexOf("com.sap.vocabularies.UI.v1.FieldGroup#")>-1){i=null;o=t[l];n=l.split("#");if(n.length===2){i=n[1]}if(o){r={annotation:o};if(i){r.groupName=i}a=o["Label"];if(a){r.groupLabel=a.String}a=o["Data"];if(a){this._enrichAnnotationWithUIDataField(r,a)}s.push(r)}}}}}return s};p.prototype.getFieldGroupsByFilterFacetsAnnotation=function(e){var t,i,n,a,o,r=this.getFieldGroupAnnotation(e);o=r;if(e&&this._oMetaModel){t=this._oMetaModel.getODataEntityType(this._getFullyQualifiedNameForEntity(e));if(t){for(var s in t){if(s==="com.sap.vocabularies.UI.v1.FilterFacets"||s.indexOf("com.sap.vocabularies.UI.v1.FilterFacets#")>-1){o=[];a=t[s];if(a){for(var l=0;l<a.length;l++){i=a[l].Target.AnnotationPath.split("#");if(i.length===2){n=i[1]}if(n){r.some(function(e){if(e.groupName===n){if(a[l].Label){e.groupLabel=a[l].Label.String}o.push(e);return true}return false})}}}}}}}return o};p.prototype._enrichAnnotationWithUIDataField=function(e,t){var i=[],n={},a={},o={},r={},s={},l,u,p,f=0,c=0;if(e&&t){f=t.length;i=[];a={};for(c=0;c<f;c++){p=t[c];if(p&&(p.RecordType==="com.sap.vocabularies.UI.v1.DataField"||p.RecordType==="com.sap.vocabularies.UI.v1.DataFieldWithUrl")){u=null;l=p["Value"];if(l){u=l.Path}if(u){i.push(u);l=p["Url"];if(l){n[u]=this._extractURLInfo(l)}l=p["Label"];if(l&&l.String){a[u]=l.String}o[u]=this._getImportanceAnnotation(p);l=p["Criticality"];if(l){r[u]=this._extractCriticalityInfo(l,p)}s[u]=this._getWidthAnnotation(p)}}}e.fields=i;e.urlInfo=n;e.labels=a;e.importance=o;e.criticality=r;e.width=s}};p.prototype._extractCriticalityInfo=function(e,t){var i,n;if(e.Path||e.EnumMember){i={};i["path"]=e.Path;i["criticalityType"]=e.EnumMember;n=t["CriticalityRepresentation"];if(n){if(n.Path){i["criticalityRepresentationPath"]=n.Path}else if(n.EnumMember){i["criticalityRepresentationType"]=n.EnumMember}}}return i};p.prototype._extractURLInfo=function(e){var t,n,a,o;if(e){if(e.Apply&&e.Apply.Name==="odata.fillUriTemplate"){t={urlTarget:undefined,parameters:[]};if(!this._oDummyAnnotationHelperContext){this._oDummyAnnotationHelperContext=this._oMetaModel.createBindingContext("/")}if(this._oDummyAnnotationHelperContext){t.urlTarget=i.format(this._oDummyAnnotationHelperContext,e)}n=e.Apply.Parameters;a=n&&n.length?n.length:0;while(a--){o=n[a];if(o&&o.Type==="LabeledElement"&&o.Value&&o.Value.Path){t.parameters.push(o.Value.Path)}}}else if(e.Path){t={urlPath:e.Path}}}return t};p.prototype.updateDataFieldDefault=function(e){var t=e&&e["com.sap.vocabularies.UI.v1.DataFieldDefault"],i;if(t&&(t.RecordType==="com.sap.vocabularies.UI.v1.DataField"||t.RecordType==="com.sap.vocabularies.UI.v1.DataFieldWithUrl")){i=t["Label"];if(i&&i.String){e.label=i.String}i=t["Criticality"];if(i){e.criticalityInfo=this._extractCriticalityInfo(i,t)}i=t["Url"];if(i){e.urlInfo=this._extractURLInfo(i)}e.width=this._getWidthAnnotation(t);e.importance=this._getImportanceAnnotation(t)}};p.prototype.getSelectionVariantAnnotationList=function(e){var t,i,n,a=[],o;if(e&&this._oMetaModel){t=this._oMetaModel.getODataEntityType(this._getFullyQualifiedNameForEntity(e));if(t){for(var r in t){if(r==="com.sap.vocabularies.UI.v1.SelectionVariant"||r.indexOf("com.sap.vocabularies.UI.v1.SelectionVariant#")>-1){n="";i=t[r];o=r.split("#");if(o.length===2){n=o[1]}if(i){a.push({qualifier:n,annotation:i})}}}}}return a};p.prototype.getSelectionPresentationVariantAnnotationList=function(e){var t,i,n,a,o,r,s,l=null,u=null,p=null,f=[],c;if(e&&this._oMetaModel){i=this._oMetaModel.getODataEntitySet(e);if(i){n=this._oMetaModel.getODataEntityType(i.entityType)}t=[i,n];var m=function(e,t){return t.filter(function(t){return t.qualifier===e})[0]};var y=this.getEntityTypeNameFromEntitySetName(e);var d=this;t.forEach(function(e){if(e){for(var t in e){if(t==="com.sap.vocabularies.UI.v1.SelectionPresentationVariant"||t.indexOf("com.sap.vocabularies.UI.v1.SelectionPresentationVariant#")>-1){o="";a=e[t];c=t.split("#");if(c.length===2){o=c[1]}if(a){l=null;if(a.Text&&a.Text.String){l=a.Text.String}if(a.SelectionVariant&&a.SelectionVariant.Path){s=a.SelectionVariant.Path;r="";c=s.split("#");if(c.length===2){r=c[1]}if(n[s.substring(1)]){var i=m(r,d.getSelectionVariantAnnotationList(y));u={qualifier:r,annotation:i?i.annotation:undefined}}}if(a.PresentationVariant&&a.PresentationVariant.Path){s=a.PresentationVariant.Path;r="";c=s.split("#");if(c.length===2){r=c[1]}if(n[s.substring(1)]){p={qualifier:r,annotation:d.getPresentationVariantAnnotation(y,r)}}}f.push({qualifier:o,text:l,annotation:a,selectionVariant:u,presentationVariant:p})}}}}})}return f};p.prototype.getSelectionFieldsAnnotation=function(e){var t,i,n,a,o;if(e&&this._oMetaModel){t=this._oMetaModel.getODataEntityType(this._getFullyQualifiedNameForEntity(e));if(t){i=t["com.sap.vocabularies.UI.v1.SelectionFields"];if(i){o={annotation:i,selectionFields:[]};n=i.length;for(a=0;a<n;a++){o.selectionFields.push(i[a].PropertyPath)}}}}return o};p.prototype.getSemanticKeyAnnotation=function(e){var t,i,n,a,o;if(e&&this._oMetaModel){t=this._oMetaModel.getODataEntityType(e);if(t){i=t["com.sap.vocabularies.Common.v1.SemanticKey"];if(i){o={annotation:i,semanticKeyFields:[]};n=i.length;for(a=0;a<n;a++){o.semanticKeyFields.push(i[a].PropertyPath)}}}}return o};p.resolveEditableFieldFor=function(e){var t=e&&e["com.sap.vocabularies.Common.v1.EditableFieldFor"];return t&&t.PropertyPath};p.isPotentiallySensitive=function(e){return this.isTermTrue(e["com.sap.vocabularies.PersonalData.v1.IsPotentiallySensitive"])};p.prototype._getImportanceAnnotation=function(e){var t=null,i;i=e["com.sap.vocabularies.UI.v1.Importance"];if(i){t=i.EnumMember}switch(t){case"com.sap.vocabularies.UI.v1.ImportanceType/Medium":return"Medium";case"com.sap.vocabularies.UI.v1.ImportanceType/Low":return"Low";default:return"High"}};p.prototype._getWidthAnnotation=function(e){var t=null,i,n,a=/\d*\.?\d+(px|em|rem)/gi;i=e["com.sap.vocabularies.HTML5.v1.CssDefaults"];if(i){n=i.width;if(n&&n.String&&a.test(n.String)){t=n.String}}return t};p.prototype.getTextArrangementValue=function(e){var t,i,n,a,o;if(e&&this._oMetaModel){if(typeof e==="string"){e=this._getFullyQualifiedNameForEntity(e);t=e.split("/");if(t.length>1){i=this._oMetaModel.getODataEntityType(t[0])||this._oMetaModel.getODataComplexType(t[0]);n=this._oMetaModel.getODataProperty(i,t[1])}else{n=this._oMetaModel.getODataEntityType(e)||this._oMetaModel.getODataComplexType(e)}}else{n=e}if(n){a=n["com.sap.vocabularies.UI.v1.TextArrangement"]||n["com.sap.vocabularies.Common.v1.Text"]&&n["com.sap.vocabularies.Common.v1.Text"]["com.sap.vocabularies.UI.v1.TextArrangement"]}if(a){switch(a.EnumMember){case"com.sap.vocabularies.UI.v1.TextArrangementType/TextFirst":o="descriptionAndId";break;case"com.sap.vocabularies.UI.v1.TextArrangementType/TextLast":o="idAndDescription";break;case"com.sap.vocabularies.UI.v1.TextArrangementType/TextSeparate":o="idOnly";break;case"com.sap.vocabularies.UI.v1.TextArrangementType/TextOnly":o="descriptionOnly";break;default:o=undefined;break}}}return o};p.prototype.getSemanticObjectAnnotation=function(e){var t,i,n,a;if(e&&this._oMetaModel){t=e.split("/");i=this._oMetaModel.getODataEntityType(t[0])||this._oMetaModel.getODataComplexType(t[0]);n=this._oMetaModel.getODataProperty(i,t[1]);if(n){a=n["com.sap.vocabularies.Common.v1.SemanticObject"]}return this._prepareSemanticObjectAnnotationFromProperty(a)}return null};p.prototype.getSemanticObjectsFromAnnotation=function(e){if(!e||!this._oMetaModel){return null}var t=e.split("/");var i=this._oMetaModel.getODataEntityType(t[0])||this._oMetaModel.getODataComplexType(t[0]);return p.getSemanticObjectsFromProperty(this._oMetaModel.getODataProperty(i,t[1]))};p.getSemanticObjectsFromProperty=function(e){var t={defaultSemanticObject:undefined,additionalSemanticObjects:[]};for(var i in e){if(i==="com.sap.vocabularies.Common.v1.SemanticObject"){t.defaultSemanticObject=e[i]["Path"]?p._getSemanticObjectBindingPath(e[i]["Path"]):e[i]["String"]}else if(i.startsWith("com.sap.vocabularies.Common.v1.SemanticObject#")){t.additionalSemanticObjects.push(e[i]["String"])}}return t.defaultSemanticObject||t.additionalSemanticObjects.length>0?t:undefined};p._getSemanticObjectBindingPath=function(e){return"{"+e+"}"};p.prototype.getSemanticObjectAnnotationFromProperty=function(e){var t;if(e){t=e["com.sap.vocabularies.Common.v1.SemanticObject"];return this._prepareSemanticObjectAnnotationFromProperty(t)}return null};p.prototype._prepareSemanticObjectAnnotationFromProperty=function(e){var t,i;if(e){t=e["Path"]?p._getSemanticObjectBindingPath(e["Path"]):e["String"];if(t){i={annotation:e};i.semanticObject=t}}return i};p.prototype.getContactAnnotation=function(e){var t=this._oMetaModel.getMetaContext(e);var i=t.getProperty(t.getPath());return i["com.sap.vocabularies.Communication.v1.Contact"]};p.prototype._getFullyQualifiedNameForEntity=function(e){var t,i;if(!e){return undefined}if(e.indexOf(".")>-1){return e}if(this._oSchemaDefinition){t=this._oSchemaDefinition.namespace}if(t&&!(e.indexOf(t)>-1)){i=t+"."+e}else{i=e}return i};p.prototype.getMultiUnitBehaviorEnabled=function(){var e=this._oMetaModel&&this._oMetaModel.getODataEntityContainer();return p.isTermDefaultTrue(e&&e["com.sap.vocabularies.Common.v1.ApplyMultiUnitBehaviorForSortingAndFiltering"])};p.prototype.getPDFSupportedAnnotation=function(){var e=this._oMetaModel&&this._oMetaModel.getODataEntityContainer(true);var t=this._oMetaModel.getObject(e+"/com.sap.vocabularies.PDF.v1.Features");var i={};for(var n in t){var a=t[n];if(a.Bool){i[n]=a.Bool==="true"}else if(a.String){i[n]=a.String}else if(a.Int){i[n]=parseInt(a.Int)}}return t?i:undefined};p.getSelectionRangeOptionType=function(e){return s[e]};p.getSelectionRangeSignType=function(e){return l[e]};p.hasTextArrangementAnnotation=function(e){if(e["com.sap.vocabularies.UI.v1.TextArrangement"]||e["com.sap.vocabularies.Common.v1.Text"]&&e["com.sap.vocabularies.Common.v1.Text"]["com.sap.vocabularies.UI.v1.TextArrangement"]){return true}return false};p.isNumber=function(e){return!!e&&(e.type==="Edm.Decimal"||e.type==="Edm.Double"||e.type==="Edm.Int16"||e.type==="Edm.Int32"||e.type==="Edm.Int64"||e.type==="Edm.Byte"||e.type==="Edm.Single"||e.type==="Edm.String"&&this.isDigitSequence(e))};p._getSearchExpressionTypeOperations=function(){var e={},t=p._getSearchExpressionType();e[t]=p._getSearchExpressionRangeOperationsKeys();return e};p._getSearchExpressionRangeOperationsKeys=function(){return[u.Contains,u.StartsWith,u.EndsWith]};p._getSearchExpressionType=function(){return"string"};p.prototype.destroy=function(){this.oModel=null;this._oMetaModel=null;this._oMetadata=null;this._oSchemaDefinition=null;this._sResourceRootUri=null;this.bIsDestroyed=true;this._oDummyAnnotationHelperContext=null};return p},true);
/*!
 * SAPUI5
 * (c) Copyright 2009-2023 SAP SE. All rights reserved.
 */
sap.ui.predefine("sap/ui/comp/odata/ODataModelUtil", ["sap/ui/model/odata/v2/ODataModel"],function(e){"use strict";var t={handleModelInit:function(t,a,i){var n=false,o;if(t&&!t._bMetaModelLoadAttached&&a){o=t.getModel();if(o){if(o.getMetadata()&&o instanceof e){n=true}else if(o.bLoadMetadataAsync||o.getServiceMetadata&&!o.getServiceMetadata()){n=true}t._bMetaModelLoadAttached=true;if(n&&o.getMetaModel()&&o.getMetaModel().loaded){var l=!!i;if(!l){o.getMetaModel().loaded().then(a.bind(t))}else{this._getFlexRuntimeInfoAPI().then(function(e){var n;if(!e.isFlexSupported({element:t})){n=Promise.resolve()}else if(typeof i==="boolean"){n=e.waitForChanges({element:t})}else{n=e.waitForChanges({complexSelectors:i})}Promise.all([o.getMetaModel().loaded(),n]).then(a.bind(t))})}}else{a.apply(t)}}}},_getFlexRuntimeInfoAPI:function(){return sap.ui.getCore().loadLibrary("sap.ui.fl",{async:true}).then(function(){return new Promise(function(e){sap.ui.require(["sap/ui/fl/apply/api/FlexRuntimeInfoAPI"],function(t){e(t)})})})}};return t},true);
/*!
 * SAPUI5
 * (c) Copyright 2009-2023 SAP SE. All rights reserved.
 */
sap.ui.predefine("sap/ui/comp/odata/ODataModelUtilSync", ["sap/ui/model/odata/v2/ODataModel","sap/ui/fl/apply/api/FlexRuntimeInfoAPI"],function(e,t){"use strict";var a={handleModelInit:function(t,a,n){var i=false,o;if(t&&!t._bMetaModelLoadAttached&&a){o=t.getModel();if(o){if(o.getMetadata()&&o instanceof e){i=true}else if(o.bLoadMetadataAsync||o.getServiceMetadata&&!o.getServiceMetadata()){i=true}t._bMetaModelLoadAttached=true;if(i&&o.getMetaModel()&&o.getMetaModel().loaded){var r=!!n;if(!r){return o.getMetaModel().loaded().then(a.bind(t))}else{return this._waitForFlexChanges(o,t,a,n)}}else{a.apply(t)}}}return Promise.resolve()},_waitForFlexChanges:function(e,a,n,i){return this._flexRuntimeInfoAPIHandler(t,e,a,n,i)},_getFlexRuntimeInfoAPI:function(){return sap.ui.getCore().loadLibrary("sap.ui.fl",{async:true}).then(function(){return new Promise(function(e){sap.ui.require(["sap/ui/fl/apply/api/FlexRuntimeInfoAPI"],function(t){e(t)})})})},_flexRuntimeInfoAPIHandler:function(e,t,a,n,i){var o;if(!e.isFlexSupported({element:a})){o=Promise.resolve()}else if(typeof i==="boolean"){o=e.waitForChanges({element:a})}else{o=e.waitForChanges({complexSelectors:i})}return Promise.all([t.getMetaModel().loaded(),o]).then(n.bind(a))}};return a},true);
/*!
 * SAPUI5
 * (c) Copyright 2009-2023 SAP SE. All rights reserved.
 */
sap.ui.predefine("sap/ui/comp/odata/ODataType", ["sap/ui/model/odata/type/Boolean","sap/ui/model/odata/type/Byte","sap/ui/model/odata/type/DateTime","sap/ui/model/odata/type/DateTimeOffset","sap/ui/model/odata/type/Decimal","sap/ui/model/odata/type/Double","sap/ui/model/odata/type/Single","sap/ui/model/odata/type/Guid","sap/ui/model/odata/type/Int16","sap/ui/model/odata/type/Int32","sap/ui/model/odata/type/Int64","sap/ui/model/odata/type/SByte","sap/ui/model/odata/type/String","sap/ui/model/odata/type/Time","sap/ui/comp/odata/type/StringDate","sap/ui/comp/odata/type/FiscalDate","sap/ui/comp/odata/type/NumericText","sap/ui/model/odata/type/DateTimeWithTimezone","sap/ui/comp/odata/type/CalendarDate"],function(e,t,a,i,d,m,n,u,o,r,l,p,s,E,y,f,D,T,c){"use strict";var I={"Edm.Boolean":e,"Edm.Byte":t,"Edm.DateTime":a,"Edm.DateTimeOffset":i,"Edm.Decimal":d,"Edm.Double":m,"Edm.Float":n,"Edm.Guid":u,"Edm.Int16":o,"Edm.Int32":r,"Edm.Int64":l,"Edm.SByte":p,"Edm.Single":n,"Edm.String":s,"Edm.Time":E};var g={"Edm.Boolean":"Bool","Edm.Byte":"Int","Edm.DateTime":"Date","Edm.DateTimeOffset":"DateTimeOffset","Edm.Decimal":"Decimal","Edm.Double":"Float","Edm.Float":"Float","Edm.Guid":"Guid","Edm.Int16":"Int","Edm.Int32":"Int","Edm.Int64":"Int","Edm.SByte":"Int","Edm.Single":"Float","Edm.String":"String","Edm.Time":"TimeOfDay"};var S={"Edm.Byte":true,"Edm.Decimal":true,"Edm.Double":true,"Edm.Float":true,"Edm.Int16":true,"Edm.Int32":true,"Edm.Int64":true,"Edm.SByte":true,"Edm.Single":true};var B={"Edm.DateTime":true,"Edm.DateTimeOffset":true,"Edm.Time":true};var F={getType:function(e,t,a,i){var d=null,m;if(i){if(i.isCalendarType&&i.calendarType){return new c(t,a,{calendarType:i.calendarType})}if(typeof i==="boolean"||i.isCalendarDate){return new y(t)}if(i.isFiscalDate&&i.fiscalType){return new f(t,a,{fiscalType:i.fiscalType})}if(a&&a.isDigitSequence){return new D(t,a)}if(i.isTimezone){return new T(t)}}m=I[e];if(m){d=new m(t,a)}return d},isNumeric:function(e){return S[e]?true:false},isDateOrTime:function(e){return B[e]?true:false},getDefaultValueTypeName:function(e){return g[e]},getTypeName:function(e){if(e.indexOf("Edm.")===0){return e.substring(4)}return e}};return F},true);
/*!
 * SAPUI5
 * (c) Copyright 2009-2023 SAP SE. All rights reserved.
 */
sap.ui.predefine("sap/ui/comp/odata/PeriodDateFormat", ["sap/ui/base/Object","sap/ui/core/LocaleData","sap/ui/core/Configuration"],function(t,e,o){"use strict";var r=t.extend("sap.ui.comp.odata.PeriodDateFormat",{metadata:{library:"sap.ui.comp"},constructor:function(r,s){t.call(this,r,s);var a,i,n,l,p=o.getFormatSettings().getFormatLocale(),f=e.getInstance(p),u=o.getFormatSettings().getCustomLocaleData(),m=/(m|y)(?:.*)(\W)(m|y)/i,h=u["dateFormats-short"];this.oFormatOptions=s;if(this.oFormatOptions.format.length>4){a="yM"}else if(this.oFormatOptions.format==="PPP"){a="M"}else{a=this.oFormatOptions.format}if(h&&a==="yM"){l=h.match(m).splice(1).join("");if(l){i=l}}else{i=f.getCustomDateTimePattern(a,this.oFormatOptions.calendarType)}i=i.replace(/([\u4e00-\u9faf\u3000-\u303f\u3040-\u309f\u30a0-\u30ff\uff00-\uffef])+/gi,"");if(this.oFormatOptions.format.length>4){i=i.replace(/y+/i,this.oFormatOptions.format.slice(0,this.oFormatOptions.format.lastIndexOf("Y")+1));i=i.replace(/m+/i,this.oFormatOptions.format.slice(this.oFormatOptions.format.lastIndexOf("Y")+1))}else if(this.oFormatOptions.format==="PPP"){i="PPP"}n=this.parseCldrDatePattern(i);this.oFormatOptions.pattern=n.length>1?i:"";this._setFormatRegex(n);this._setParseRegex(n);this._setValidationRegex(n)}});r.getDateInstance=function(t){return new r(null,t)};r.prototype.getPattern=function(){return this.oFormatOptions.pattern};r.prototype.getRegExPattern=function(){return this.sFormatRegExPattern};r.prototype.getTemplate=function(){return this.sFormatRegExGroups};r.prototype._setFormatRegex=function(t){var e=[],o=[],r,s,a,i,n;for(n=0;n<t.length;n++){r=t[n];s=r.symbol||"";a=this.oSymbols[s].format;if(s===""){o[n]=r.value}else if(s==="y"||s==="Y"){e.unshift("("+a.source+")");o[n]="$"+1}else{e.push("("+a.source+")");i=t.some(function(t){return t.symbol==="y"||t.symbol==="Y"});o[n]=i?"$"+2:"$"+1}}this.sFormatRegExPattern=new RegExp(e.join(""));this.sFormatRegExGroups=o.join("")};r.prototype._setParseRegex=function(t){var e,o,r,a,i,n=[],l={},p=0;for(a=0;a<t.length;a++){e=t[a];o=e.symbol||"";r=this.oSymbols[o].parse;if(o===""){n.push("\\D+?")}else{n.push("("+r.source+")");i=++p;l[i]=e}}this.sParseRegExPattern=new RegExp("^"+n.join("")+"$");this.fnParseRegExReplacer=function(){var t,e,o=[];for(var r in l){t=l[r];e=arguments[r];if(e.length<t.digits){if(t.symbol==="y"||t.symbol==="Y"){e=s(e)}else{e=e.padStart(t.digits,"0")}}if(t.symbol==="y"||t.symbol==="Y"){o.unshift(e)}else{o.push(e)}}return o.join("")}};r.prototype._setValidationRegex=function(t){var e,o,r,s,a=[];for(e=0;e<t.length;e++){o=t[e];r=o.symbol||"";s=this.oSymbols[r].format;if(r===""){continue}else if(r==="y"||r==="Y"){a.unshift(s.source)}else{a.push(s.source)}}this.sValidationRegExPattern=new RegExp("^("+a.join(")(")+")$")};r.prototype.parseCldrDatePattern=function(t){var e,o,r,s,a=[];for(e=0;e<t.length;e++){o=t[e];if(r!==o){s={}}else{s.digits+=1;continue}if(typeof this.oSymbols[o]==="undefined"){s.value=o;s.type="text"}else{s.symbol=o;s.digits=1}r=o;a.push(s)}return a};r.prototype.format=function(t){if(t==null||typeof t!=="string"){return""}return t.replace(this.sFormatRegExPattern,this.sFormatRegExGroups)};r.prototype.parse=function(t){if(t){return t.replace(this.sParseRegExPattern,this.fnParseRegExReplacer)}return null};r.prototype.validate=function(t){return this.sValidationRegExPattern.test(t)};r.oRegexFormatPatterns={};r.oRegexParsePatterns={};r.prototype.oSymbols={};r.prototype.destroy=function(){t.prototype.destroy.apply(this,arguments);this._oAnnotationValidationRegexPattern=null};function s(t){var e,o=Number.parseInt(t),r=(new Date).getUTCFullYear(),s=Math.floor(r/100);e=s*100+o-r;if(t.length===3){o+=Math.floor((s-1)/10)*1e3}else if(e<-70){o+=(s+1)*100}else if(e<30){o+=s*100}else{o+=(s-1)*100}return o}return r});
/*
 * SAPUI5
 * (c) Copyright 2009-2023 SAP SE. All rights reserved.
 */
sap.ui.predefine("sap/ui/comp/odata/SideEffects", [],function(){"use strict";var e=function(){};e.prototype.getSideEffects=function(e,t,r){var i={};if(r){if(e){if(r.entitySet){i.entitySet=this._getForPath(r.entitySet,e)}if(r.entityType){i.entityType=this._getForPath(r.entityType,e)}}if(t&&r.complexType){i.complexType=this._getForPath(r.complexType,t)}}return i};e.prototype._getForPath=function(e,t){var r,i,o={};for(r in e){if(r.indexOf&&r.indexOf("com.sap.vocabularies.Common.v1.SideEffects")===0){i=e[r];if(this._checkSourceProperties(i,t)){o[r]=i}if(this._checkSourceEntities(i,t)){o[r]=i}}}return o};e.prototype._checkSourceProperties=function(e,t){var r,i;if(e.SourceProperties){i=e.SourceProperties.length;for(r=0;r<i;r++){if(e.SourceProperties[r].PropertyPath===t){return true}}}return false};e.prototype._checkSourceEntities=function(e,t){var r,i;if(e.SourceEntities&&e.SourceEntities.Collection){i=e.SourceEntities.Collection.length;for(r=0;r<i;r++){if(e.SourceEntities.Collection[r].NavigationPropertyPath===t){return true}}}else if(e.SourceEntities&&Array.isArray(e.SourceEntities)){i=e.SourceEntities.length;for(r=0;r<i;r++){if(e.SourceEntities[r].NavigationPropertyPath===t){return true}}}return false};e.prototype.destroy=function(){};return e},true);
/*!
 * SAPUI5
 * (c) Copyright 2009-2023 SAP SE. All rights reserved.
 */
sap.ui.predefine("sap/ui/comp/odata/type/CalendarDate", ["sap/ui/core/Core","sap/ui/core/library","sap/ui/comp/smartfield/type/String","sap/ui/comp/odata/type/NumericText","sap/ui/comp/odata/CalendarFormat","sap/ui/model/ValidateException"],function(e,t,a,r,s,i){"use strict";var o=a.extend("sap.ui.comp.odata.type.CalendarDate",{constructor:function(e,i,n){a.call(this,e,i);if(this.oConstraints&&this.oConstraints.isDigitSequence){r.call(this,e,i)}this.sCalendarType=n.calendarType;this.formatter=s.getDateInstance(Object.assign({format:o.CalendarDateFormatter[this.sCalendarType],calendarType:t.CalendarType.Gregorian},e))}});o.prototype.parseValue=function(e){if(e===""){return null}if(this.oConstraints&&this.oConstraints.isDigitSequence){return this.formatter.parse(r.prototype.parseValue.apply(this,arguments))}return this.formatter.parse(a.prototype.parseValue.apply(this,arguments))};o.prototype.formatValue=function(e){var t;if(this.oConstraints&&this.oConstraints.isDigitSequence){var s=Array.from(arguments),i=true;s.push(i);t=r.prototype.formatValue.apply(this,s)}else{t=a.prototype.formatValue.apply(this,arguments)}if(t===null){return null}return this.formatter.format(t)};o.prototype.validateValue=function(e){try{a.prototype.validateValue.apply(this,arguments)}catch(t){if(!this.formatter.validate(e)){throw new i(this.getErrorMessage(this.sCalendarType))}}if(e===null){return}if(!this.formatter.validate(e)){throw new i(this.getErrorMessage(this.sCalendarType))}};o.prototype.destroy=function(){a.prototype.destroy.apply(this,arguments);if(this.formatter){this.formatter.destroy();this.formatter=null}};o.prototype.getErrorMessage=function(t){var a;this.iFullYear=this.iFullYear||(new Date).getFullYear().toString();switch(t){case"IsCalendarYear":a=this.iFullYear;break;case"IsCalendarQuarter":a="1";break;case"IsCalendarYearQuarter":a=this.iFullYear+"1";break;case"IsCalendarWeek":a="01";break;case"IsCalendarYearWeek":a=this.iFullYear+"01";break;case"IsCalendarMonth":a="01";break;case"IsCalendarYearMonth":a=this.iFullYear+"01";break;default:a=this.iFullYear}return e.getLibraryResourceBundle("sap.ui.comp").getText("CALENDAR_VALIDATION_FAILS",[this.formatValue(a,"string")])};o.CalendarDateFormatter={IsCalendarYear:"YYYY",IsCalendarWeek:"WW",IsCalendarMonth:"MM",IsCalendarQuarter:"Q",IsCalendarYearWeek:"YYYYWW",IsCalendarYearMonth:"YYYYMM",IsCalendarYearQuarter:"YYYYQ"};o.prototype.getName=function(){return"sap.ui.comp.odata.type.CalendarDate"};o.prototype.getFormatter=function(){return this.formatter};return o});
/*!
 * SAPUI5
 * (c) Copyright 2009-2023 SAP SE. All rights reserved.
 */
sap.ui.predefine("sap/ui/comp/odata/type/FiscalDate", ["sap/ui/core/Core","sap/ui/core/library","sap/ui/comp/smartfield/type/String","sap/ui/comp/odata/type/NumericText","sap/ui/comp/odata/FiscalFormat","sap/ui/model/ValidateException"],function(t,e,a,r,s,i){"use strict";var o=a.extend("sap.ui.comp.odata.type.FiscalDate",{constructor:function(t,i,l){a.call(this,t,i);if(this.oConstraints&&this.oConstraints.isDigitSequence){r.call(this,t,i)}this.sFiscalType=this._getFiscalType(l);this.formatter=s.getDateInstance(Object.assign({format:o.FiscalDateFormatter[this.sFiscalType],calendarType:e.CalendarType.Gregorian},t))}});o.prototype.parseValue=function(t){if(t===""){return null}if(this.oConstraints&&this.oConstraints.isDigitSequence){return this.formatter.parse(r.prototype.parseValue.apply(this,arguments))}return this.formatter.parse(a.prototype.parseValue.apply(this,arguments))};o.prototype.formatValue=function(t){var e;if(this.oConstraints&&this.oConstraints.isDigitSequence){var s=Array.from(arguments),i=true;s.push(i);e=r.prototype.formatValue.apply(this,s)}else{e=a.prototype.formatValue.apply(this,arguments)}if(e===null){return null}return this.formatter.format(e)};o.prototype.validateValue=function(t){try{a.prototype.validateValue.apply(this,arguments)}catch(e){if(!this.formatter.validate(t)){throw new i(this.getErrorMessage(this.sFiscalType))}}if(t===null){return}if(!this.formatter.validate(t)){throw new i(this.getErrorMessage(this.sFiscalType))}};o.prototype.destroy=function(){a.prototype.destroy.apply(this,arguments);if(this.formatter){this.formatter.destroy();this.formatter=null}};o.prototype.getErrorMessage=function(e){var a;this.iFullYear=this.iFullYear||(new Date).getFullYear().toString();switch(e){case"IsFiscalYear":a=this.iFullYear;break;case"IsFiscalPeriod":a="001";break;case"IsFiscalYearPeriod":a=this.iFullYear+"001";break;case"IsFiscalQuarter":a="1";break;case"IsFiscalYearQuarter":a=this.iFullYear+"1";break;case"IsFiscalWeek":a="01";break;case"IsFiscalYearWeek":a=this.iFullYear+"01";break;case"IsDayOfFiscalYear":a="1";break;case"IsFiscalYearVariant":break;default:a=this.iFullYear}return t.getLibraryResourceBundle("sap.ui.comp").getText("FISCAL_VALIDATION_FAILS",[this.formatValue(a,"string")])};o.FiscalDateFormatter={IsFiscalYear:"YYYY",IsFiscalPeriod:"PPP",IsFiscalYearPeriod:"YYYYPPP",IsFiscalQuarter:"Q",IsFiscalYearQuarter:"YYYYQ",IsFiscalWeek:"WW",IsFiscalYearWeek:"YYYYWW",IsDayOfFiscalYear:"d",IsFiscalYearVariant:""};o.prototype.getName=function(){return"sap.ui.comp.odata.type.FiscalDate"};o.prototype.getFormatter=function(){return this.formatter};o.prototype._getFiscalType=function(t){var e="com.sap.vocabularies.Common.v1.";if(t.anotationType&&t.anotationType.indexOf(e)!=-1){return t.anotationType.replace(e,"")}return t.fiscalType};return o});
/*!
 * SAPUI5
 * (c) Copyright 2009-2023 SAP SE. All rights reserved.
 */
sap.ui.predefine("sap/ui/comp/odata/type/NumericText", ["sap/ui/core/Core","sap/ui/core/library","sap/ui/comp/smartfield/type/String"],function(t,e,o){"use strict";var r=o.extend("sap.ui.comp.odata.type.NumericText",{constructor:function(t,e){o.call(this,t,e);this.oCustomRegex=new RegExp("^[0]*$")}});r.prototype.parseValue=function(t,e,r){if(this.oCustomRegex.test(t)&&!r){if(typeof this.oFieldControl==="function"){this.oFieldControl(t,e)}if(this.oFormatOptions&&this.oFormatOptions.parseKeepsEmptyString){return""}return null}return o.prototype.parseValue.apply(this,arguments)};r.prototype.formatValue=function(t,e,r){if(this.oCustomRegex.test(t)){if(r){return"0"}return null}return o.prototype.formatValue.apply(this,arguments)};r.prototype.getName=function(){return"sap.ui.comp.odata.type.NumericText"};r.prototype.destroy=function(){o.prototype.destroy.apply(this,arguments)};return r});
/*
 * SAPUI5
 * (c) Copyright 2009-2023 SAP SE. All rights reserved.
 */
sap.ui.predefine("sap/ui/comp/odata/type/StringDate", ["sap/ui/core/library","sap/ui/model/SimpleType","sap/ui/core/format/DateFormat","sap/ui/model/ValidateException"],function(t,e,a,r){"use strict";var i=e.extend("sap.ui.comp.odata.type.StringDate",{constructor:function(r){e.apply(this,[r]);this.sName="sap.ui.comp.odata.type.StringDate";r=Object.assign({},r,{UTC:false});this.displayFormatter=a.getDateInstance(r);this.parseFormatter=a.getDateInstance({UTC:false,pattern:"yyyyMMdd",calendarType:t.CalendarType.Gregorian,strictParsing:true})}});i.prototype.parseValue=function(t,e){if(t===""){t=null}if(t!=null&&t!=""){var a=e==="string"?this.parseFormatter.parse(t,true):t;t=this.parseFormatter.format(a)}return t};i.prototype.formatValue=function(t,e){if(t===null||t===undefined||t==""){return null}if(!(t instanceof Date)){t=this.parseFormatter.parse(t)}if(e==="string"){return this.displayFormatter.format(t)}return t};i.prototype.validateValue=function(t){if(t!=null){var e=this.parseFormatter.parse(t);if(!e){throw new r(t+" is not a valid date")}}};return i});
/*!
 * SAPUI5
 * (c) Copyright 2009-2023 SAP SE. All rights reserved.
 */
sap.ui.predefine("sap/ui/comp/p13n/P13nConditionPanel", ["sap/m/P13nConditionPanel","sap/m/library","sap/ui/core/library","sap/ui/core/date/UI5Date","sap/ui/core/Control","sap/ui/core/IconPool","sap/ui/Device","sap/ui/core/InvisibleText","sap/ui/core/InvisibleMessage","sap/ui/core/ResizeHandler","sap/ui/core/Item","sap/ui/core/ListItem","sap/ui/model/odata/type/Boolean","sap/ui/model/type/String","sap/ui/model/odata/type/String","sap/ui/model/type/Date","sap/ui/model/type/Time","sap/ui/model/odata/type/DateTime","sap/ui/model/type/Float","sap/ui/layout/Grid","sap/ui/layout/GridData","sap/m/Button","sap/m/OverflowToolbar","sap/m/OverflowToolbarLayoutData","sap/m/ToolbarSpacer","sap/m/Text","sap/m/SearchField","sap/m/CheckBox","sap/m/ComboBox","sap/m/Select","sap/m/Label","sap/m/Input","sap/m/DatePicker","sap/m/TimePicker","sap/m/DateTimePicker","sap/base/Log","sap/ui/comp/odata/type/StringDate","sap/ui/comp/p13n/P13nOperationsHelper","./P13nConditionPanelRenderer","sap/ui/model/json/JSONModel","sap/ui/model/Sorter"],function(e,t,i,a,n,o,s,r,l,d,p,u,g,c,h,y,f,_,m,S,C,v,I,T,F,b,x,O,L,V,D,k,P,E,M,K,w,N,A,B,G){"use strict";var R=t.ButtonType,H=t.P13nConditionOperation,U=t.P13nConditionOperationType,z=i.ValueState,j=[H.BT,H.EQ,H.LE,H.LT,H.GE,H.GT,H.NotBT,H.NotEQ,H.NotLE,H.NotLT,H.NotGE,H.NotGT],X=i.InvisibleMessageMode;var W=e.extend("sap.ui.comp.p13n.P13nConditionPanel",{metadata:{library:"sap.ui.comp.p13n",properties:{defaultOperation:{type:"string",group:"Misc",defaultValue:null},_calendarWeekSettings:{type:"string",group:"Misc",defaultValue:"",visibility:"hidden"}}},renderer:A.renderer});W.prototype.init=function(){this._oRbComp=sap.ui.getCore().getLibraryResourceBundle("sap.ui.comp");e.prototype.init.apply(this);this._oOperationsHelper=new N};W.prototype.onBeforeRendering=function(){if(!this._oInvisibleMessage){this._oInvisibleMessage=l.getInstance()}};W.prototype.setOperations=function(e,t,i){var a=i?U.Exclude:U.Include;t=t||"default";if(this._oTypeOperations[t]===undefined){this._oTypeOperations[t]={}}this._oTypeOperations[t][a]=e;this._updateAllOperations()};W._createKeyFieldTypeInstance=function(e){var t;if(!e.typeInstance){switch(e.type){case"boolean":e.typeInstance=new g;break;case"numc":if(!(e.formatSettings&&e.formatSettings.isDigitSequence)){K.error("sap.m.P13nConditionPanel","NUMC type support requires isDigitSequence==true!");e.formatSettings=Object.assign({},e.formatSettings,{isDigitSequence:true})}t=e.formatSettings;if(e.maxLength){t=Object.assign({},t,{maxLength:e.maxLength})}if(!t.maxLength){K.error("sap.m.P13nConditionPanel","NUMC type suppport requires maxLength!")}e.typeInstance=new h({},t);break;case"date":e.typeInstance=new y(Object.assign({},e.formatSettings,{strictParsing:true}),{});break;case"time":e.typeInstance=new f(Object.assign({},e.formatSettings,{strictParsing:true}),{});break;case"datetime":e.typeInstance=new _(Object.assign({},e.formatSettings,{strictParsing:true}),{displayFormat:"Date"});var i=e.typeInstance;if(!i.oFormat){i.formatValue(a.getInstance(),"string")}if(i.oFormat){i.oFormat.oFormatOptions.UTC=false}break;case"stringdate":e.typeInstance=new w(Object.assign({},e.formatSettings,{strictParsing:true}));break;case"numeric":if(e.precision||e.scale){t={};if(e.precision){t["maxIntegerDigits"]=parseInt(e.precision)}if(e.scale){t["maxFractionDigits"]=parseInt(e.scale)}}e.typeInstance=new m(t);break;default:var n=e.formatSettings;if(e.maxLength){n=Object.assign({},n,{maxLength:e.maxLength})}e.typeInstance=new c({},n);break}}};W.prototype.setKeyFields=function(e){this._aKeyFields=e;this._aKeyFields.forEach(function(e){W._createKeyFieldTypeInstance(e)},this);this._updateKeyFieldItems(this._oConditionsGrid,true);this._updateAllConditionsEnableStates();this._createAndUpdateAllKeyFields();this._updateAllOperations();this._updateConditionFields()};W.prototype.setValues=function(e,t){t=t||"default";this._oTypeValues[t]=e};W.prototype.addOperation=function(e,t,i){var a=i?U.Exclude:U.Include;t=t||"default";if(this._oTypeOperations[t]===undefined){this._oTypeOperations[t]={}}if(this._oTypeOperations[t][a]===undefined){this._oTypeOperations[t][a]=[]}this._oTypeOperations[t][a].push(e);this._updateAllOperations()};W.prototype.getOperations=function(e,t){var i,a,n,o;e=e||"default";if(t!==undefined){i=t?U.Exclude:U.Include;o=this._oTypeOperations[e]&&this._oTypeOperations[e][i]||[]}else{a=this._oTypeOperations[e]&&this._oTypeOperations[e][U.Include]||[];n=this._oTypeOperations[e]&&this._oTypeOperations[e][U.Exclude]||[];o=a.concat(n)}return o};W.prototype._updatePaginatorToolbar=function(){if(this._sConditionType!=="Filter"||this.getMaxConditions()!=="-1"){return}var e=this._aConditionKeys.length;var t=1+Math.floor(Math.max(0,e-1)/this._iConditionPageSize);var i=1+Math.floor(this._iFirstConditionIndex/this._iConditionPageSize);var a=this.getParent();if(!this._oPaginatorToolbar){if(e>this._iConditionPageSize){this._createPaginatorToolbar();this.insertAggregation("content",this._oPaginatorToolbar,0);this._onGridResize()}else{if(a&&a.getMetadata().getName()==="sap.m.Panel"){if(this._sOrgHeaderText==undefined){this._sOrgHeaderText=a.getHeaderText()}}return}}this._oPrevButton.setEnabled(this._iFirstConditionIndex>0);this._oNextButton.setEnabled(this._iFirstConditionIndex+this._iConditionPageSize<e);if(a&&a.setHeaderToolbar){if(!a.getHeaderToolbar()){this.removeAggregation("content",this._oPaginatorToolbar);a.setHeaderToolbar(this._oPaginatorToolbar);a.attachExpand(function(e){this._setToolbarElementVisibility(e.getSource().getExpanded()&&this._bPaginatorButtonsVisible)}.bind(this))}}if(a&&a.getMetadata().getName()==="sap.m.Panel"){if(this._sOrgHeaderText==undefined){this._sOrgHeaderText=a.getHeaderText()}var n=this._sOrgHeaderText+(e>0?" ("+e+")":"");this._oHeaderText.setText(n)}else{this._oHeaderText.setText(e+" Conditions")}this._oPageText.setText(i+"/"+t);this._bPaginatorButtonsVisible=this._bPaginatorButtonsVisible||t>1;this._setToolbarElementVisibility(this._bPaginatorButtonsVisible);if(i>t){this._iFirstConditionIndex-=Math.max(0,this._iConditionPageSize);this._clearConditions();this._fillConditions()}var o=0;this._oConditionsGrid.getContent().forEach(function(e){if(e.select.getSelected()){o++}},this);if(t==i&&e-this._iFirstConditionIndex>o){this._clearConditions();this._fillConditions()}};W.prototype._setToolbarElementVisibility=function(e){this._oPrevButton.setVisible(e);this._oNextButton.setVisible(e);this._oPageText.setVisible(e);this._oFilterField.setVisible(false);this._setLayoutVisible(this._oAddButton,e);this._setLayoutVisible(this._oRemoveAllButton,e)};W.prototype._unregisterResizeHandler=function(){if(this._sContainerResizeListener){d.deregister(this._sContainerResizeListener);this._sContainerResizeListener=null}};W.prototype._registerResizeHandler=function(){if(this.getContainerQuery()){this._sContainerResizeListener=d.register(this._oConditionsGrid,this._onGridResize.bind(this));this._onGridResize()}};W.prototype._handleAddCondition=function(e,t,i){var a=e.getContent().indexOf(t);var n=this._createConditionRow(e,undefined,null,a+1,i);this._changeField(n);setTimeout(function(){if(n.keyField.getVisible()){n.keyField.focus();return}if(n.operation.getVisible()){n.operation.focus()}},500);this._updatePaginatorToolbar()};W.prototype._handleRemoveCondition=function(e,t){var i=e.getContent().indexOf(t);this._removeCondition(e,t);if(this.getAutoReduceKeyFieldItems()){this._updateKeyFieldItems(e,false)}if(i>=0){i=Math.min(i,e.getContent().length-1);var t=e.getContent()[i];setTimeout(function(){t.remove.focus()},500)}this._updatePaginatorToolbar()};W.prototype._getCurrentKeyFieldItem=function(e){if(e.getSelectedKey&&e.getSelectedKey()){var t=e.getSelectedKey();var i=this._aKeyFields;for(var a in i){var n=i[a];if(n.key===t){return n}}}return null};W.prototype._createConditionRow=function(e,t,i,a,n){var o,s=this,r=new B;if(a===undefined){a=e.getContent().length}var l=new S({width:"100%",defaultSpan:"L12 M12 S12",hSpacing:1,vSpacing:0,containerQuery:this.getContainerQuery()}).data("_key",i);for(var d in this._aConditionsFields){var p;var u=this._aConditionsFields[d];switch(u["Control"]){case"CheckBox":p=new O({enabled:false,layoutData:new C({span:u["Span"+this._sConditionType]})});this._setLayoutVisible(p,false);if(u["ID"]==="showIfGrouped"){p.setEnabled(true);p.setText(u["Label"]);p.attachSelect(function(){s._changeField(l)});p.setSelected(t?t.showIfGrouped:true)}else{if(t){p.setSelected(true);p.setEnabled(true)}}break;case"ComboBox":if(u["ID"]==="keyField"){p=new L({width:"100%",ariaLabelledBy:this._oInvisibleTextField});var g=p.setSelectedKey.bind(p);p.setSelectedKey=function(e){g(e);var t=s.getValidationExecutor();if(t){t()}};var c=p.setSelectedItem.bind(p);p.setSelectedItem=function(e){c(e);var t=s.getValidationExecutor();if(t){t()}};p.setLayoutData(new C({span:u["Span"+this._sConditionType]}));this._fillKeyFieldListItems(p,this._aKeyFields);if(p.attachSelectionChange){p.attachSelectionChange(function(t){var i=s.getValidationExecutor();if(i){i()}s._handleSelectionChangeOnKeyField(e,l)})}if(p.attachChange){p.attachChange(function(t){l.keyField.close();s._handleChangeOnKeyField(e,l)})}if(p.setSelectedItem){if(t){p.setSelectedKey(t.keyField);this._aKeyFields.forEach(function(e,i){var a=e.key;if(a===undefined){a=e}if(t.keyField===a){p.setSelectedItem(p.getItems()[i])}},this)}else{if(this.getUsePrevConditionSetting()&&!this.getAutoReduceKeyFieldItems()){if(a>0&&!i&&n){o=e.getContent()[a-1];if(o.keyField.getSelectedKey()){p.setSelectedKey(o.keyField.getSelectedKey())}else{if(!p.getSelectedItem()&&p.getItems().length>0){p.setSelectedItem(p.getItems()[0])}}}else{this._aKeyFields.some(function(e,t){if(e.isDefault){p.setSelectedItem(p.getItems()[t]);return true}if(!p.getSelectedItem()&&e.type!=="boolean"){p.setSelectedItem(p.getItems()[t])}},this);if(!p.getSelectedItem()&&p.getItems().length>0){p.setSelectedItem(p.getItems()[0])}}}else{this._aKeyFields.forEach(function(e,t){if(e.isDefault){p.setSelectedItem(p.getItems()[t])}},this)}}}}if(u["ID"]==="operation"){p=new L({width:"100%",ariaLabelledBy:this._oInvisibleTextOperator,layoutData:new C({span:u["Span"+this._sConditionType]})});p.addEventDelegate({onmouseup:function(){if(!this.isOpen()){this.showItems()}}},p);p.setFilterFunction(function(){return true});p.setModel(r);p.attachChange(function(t){s._validateOperationValue(t);s._handleChangeOnOperationField(e,l)});l[u["ID"]]=p;this._updateOperationItems(e,l);var h=this._getCurrentKeyFieldItem(l.keyField),y=this._getRelevantOperations(h);if(t){var f=this.getCurrentOparation(t);y.some(function(e){if(f===e){p.setSelectedKey(e);return true}},this)}else{if(this.getUsePrevConditionSetting()){if(a>0&&i===null){var o=e.getContent()[a-1],_=o.operation.getSelectedKey()||y[0];p.setSelectedKey(_)}else{if(this.getDefaultOperation()){p.setSelectedKey(this.getDefaultOperation())}else{p.setSelectedKey(y[0])}}}}}if(p.getSelectedItem&&p.getSelectedItem()&&p.getMetadata()._sUIDToken!=="box"){p.setTooltip(p.getSelectedItem().getTooltip())}break;case"TextField":var m=this._getCurrentKeyFieldItem(l.keyField);p=this._createValueField(m,u,l);p.oTargetGrid=e;if(p.addAriaDescribedBy){p.addAriaDescribedBy(this._oInvisibleTextOperatorInputValue)}if(t&&t[u["ID"]]!==undefined){var v=t[u["ID"]];if(p instanceof V){if(typeof v==="boolean"){p.setSelectedIndex(v?2:1)}}else if(v!==null&&l.oType){if(typeof v==="string"&&l.oType.getName()==="sap.ui.comp.odata.type.StringDate"){p.setValue(v)}else{var I=l&&l.operation&&j.indexOf(l.operation.getSelectedKey())!==-1;if(typeof v==="string"&&["String","sap.ui.model.odata.type.String","sap.ui.model.odata.type.Decimal"].indexOf(l.oType.getName())==-1){try{v=l.oType.parseValue(v,"string",I);p.setValue(l.oType.formatValue(v,"string",I))}catch(e){K.error("sap.m.P13nConditionPanel","Value '"+v+"' does not have the expected type format for "+l.oType.getName()+".parseValue()")}}else{p.setValue(l.oType.formatValue(v,"string",I));if(p.isA("sap.m.ComboBox")){if(v===""){p.getModel().attachEventOnce("batchRequestCompleted",function(e){e.setSelectedItem(e.getItems()[0])}.bind(null,p))}else{p.setSelectedKey(v)}}}}}else{p.setValue(v)}}break;case"Label":p=new D({text:u["Text"]+":",visible:this.getShowLabel(),layoutData:new C({span:u["Span"+this._sConditionType]})}).addStyleClass("conditionLabel");p.oTargetGrid=e;break}l[u["ID"]]=p;l.addContent(p)}this._addButtons(l,e);e.insertContent(l,a);this._updateOperationItems(e,l);this._changeOperationValueFields(e,l);this._updateAllConditionsEnableStates();this._updateConditionButtons(e);if(this.getAutoReduceKeyFieldItems()){this._updateKeyFieldItems(e,false)}if(this._sLayoutMode){this._updateLayout({name:this._sLayoutMode})}if(t){var T=this._getFormatedConditionText(t.operation,t.value1,t.value2,t.exclude,t.keyField,t.showIfGrouped);t._oGrid=l;t.value=T;this._oConditionsMap[i]=t}var F=l.operation.getSelectedKey();if(F==="BT"&&l.value1.setMinDate&&l.value2.setMaxDate){var b=l.value1.getDateValue();var x=l.value2.getDateValue();this._updateMinMaxDate(l,b,x)}else{this._updateMinMaxDate(l,null,null)}return l};W.prototype._fillOperationListItems=function(e,t,i){var a={items:[]};if(i==="_STRING_"||i==="_TEXT_"){i=""}if(i==="_TIME_"||i==="_DATETIME_"){i="_DATE_"}if(i==="_BOOLEAN_"||i==="_NUMC_"){i=""}e.destroyItems();if(t&&t.length>0){t.forEach(function(e){var t=this._oRb.getText("CONDITIONPANEL_OPTION"+i+e,null,true);if(t===undefined||t.startsWith("CONDITIONPANEL_OPTION")){t=this._oRb.getText("CONDITIONPANEL_OPTION"+e)}a.items.push({key:e,text:t,sorter:this._oOperationsHelper.isExcludeType(e)?this._oRbComp.getText("VALUEHELPDLG_EXCLUDE"):this._oRbComp.getText("VALUEHELPDLG_INCLUDE"),tooltip:t})}.bind(this));e.getModel().setData(a);e.bindAggregation("items",{path:"/items",sorter:new G("sorter",true,true),template:new u({key:"{key}",text:"{text}"})})}};W.prototype._validateOperationValue=function(e){var t=e.getSource(),i=t.getSelectedKey(),a=t.getValue();if(!i&&a){t.setValueState(z.Error);t.setValueStateText(this._oRbComp.getText("VALUEHELPDLG_VALUE_NOT_EXIST",a))}else{t.setValueState(z.None)}};W.prototype._fillKeyFieldListItems=function(e,t){e.destroyItems();for(var i in t){var a=t[i];e.addItem(new u({key:a.key,text:a.text,tooltip:a.tooltip}))}this._setLayoutVisible(e,e.getItems().length>1)};W.prototype._updateOperationItems=function(e,t){var i=this._getCurrentKeyFieldItem(t.keyField);var a=i&&i.type||"";var n=t.operation;var o=n.getSelectedItem();var s=this._getRelevantOperations(i);this._fillOperationListItems(n,s,a?"_"+a.toUpperCase()+"_":"");if(o&&n.getItemByKey(o.getKey())){n.setSelectedKey(o.getKey())}else{n.setSelectedItem(n.getItems()[1])}this._sConditionType="Filter";if(s[0]===H.Ascending||s[0]===H.Descending){this._sConditionType="Sort"}if(s[0]===H.GroupAscending||s[0]===H.GroupDescending){this._sConditionType="Group"}this._adjustValue1Span(t)};W.prototype._updateKeyFieldItems=function(e,t,i,a){var n=e.getContent().length;var o;var s={};if(!t){for(o=0;o<n;o++){var r=e.getContent()[o].keyField;var l=r.getSelectedKey();if(l!=null&&l!==""){s[l]=true}}}for(o=0;o<n;o++){var r=e.getContent()[o].keyField;var d=e.getContent()[o].select;var p=r.getSelectedKey();var g=0;var c=this._aKeyFields;if(r!==a){if(i){g=c.length-1}else{r.destroyItems()}for(g;g<c.length;g++){var h=c[g];if(h.key==null||h.key===""||!s[h.key]||h.key===p){r.addItem(new u({key:h.key,text:h.text,tooltip:h.tooltip}))}}this._setLayoutVisible(r,r.getItems().length>1)}if(p){r.setSelectedKey(p)}else if(r.getItems().length>0){r.setSelectedItem(r.getItems()[0])}if(!d.getSelected()){this._aKeyFields.some(function(e,t){if(e.isDefault){r.setSelectedItem(r.getItems()[t]);return true}if(!r.getSelectedItem()){if(e.type!=="boolean"){r.setSelectedItem(r.getItems()[t])}}},this)}if(r.getSelectedItem()){r.setTooltip(r.getSelectedItem().getTooltip())}}};W.prototype._adjustValue1Span=function(e){if(this._sConditionType==="Filter"&&e.value1&&e.operation){var t=e.operation;var i=this._aConditionsFields[5]["Span"+this._sConditionType];var a=t.getSelectedKey();if(a!==H.BT&&a!==H.NotBT){i=this._aKeyFields.length>1?"L5 M11 S10":"XL8 L8 M8 S10"}var n=e.value1.getLayoutData();if(n.getSpan()!==i){n.setSpan(i)}}};W.prototype._changeField=function(e,t){var i=e.keyField.getSelectedKey();if(e.keyField.getSelectedItem()){e.keyField.setTooltip(e.keyField.getSelectedItem().getTooltip())}else{e.keyField.setTooltip(null)}var a=e.operation.getSelectedKey();var n=this._oOperationsHelper.isExcludeType(a);a=n?this._oOperationsHelper.getCorrespondingIncludeOperation(a):a;if(e.operation.getSelectedItem()){e.operation.setTooltip(e.operation.getSelectedItem().getTooltip())}else{e.operation.setTooltip(null)}var o=function(e,t,i){var a,n,o=e.getParent();if(e.getDateValue&&!e.isA("sap.m.TimePicker")&&t.getName()!=="sap.ui.comp.odata.type.StringDate"){n=e.getDateValue();if(t&&n){if(i&&i.getParameter("valid")||e.isValidValue()){a=t.formatValue(n,"string")}else{a=""}}}else{a=this._getValueTextFromField(e);n=a;if(t&&t.getName()==="sap.ui.comp.odata.type.StringDate"){a=t.formatValue(n,"string")}else if(t&&a){try{var s=o&&o.operation&&j.indexOf(o.operation.getSelectedKey())!==-1;n=t.parseValue(a,"string",s);var r=this._getCurrentKeyFieldItem(o.keyField);if(r&&r.type==="numc"&&!s&&n===null){a=t.formatValue(n,"string",s);e.setValue(a)}t.validateValue(n);if(e.isA("sap.m.ComboBox")&&!e.getSelectedKey()||i&&e.getId()==i.getSource().getId()&&o.operation.getSelectedKey()===H.BT&&(this._isInvalidFiscalRange(o)||this._isFieldNumeric(o)&&this._isInvalidRange(o))){a=""}}catch(e){K.error("sap.m.P13nConditionPanel","not able to parse value "+a+" with type "+t.getName());a=""}}}return[n,a]}.bind(this);var s=o(e.value1,e.oType,t);var r=s[0],l=s[1];s=o(e.value2,e.oType,t);var d=s[0],p=s[1];if(this._hasSecondValue(a)){this._updateMinMaxDate(e,r,d)}else{this._updateMinMaxDate(e,null,null)}var u=this._getCurrentKeyFieldItem(e.keyField);if(u&&u.type==="numc"){if([H.Contains,H.EndsWith].indexOf(a)!=-1){r=e.oType.formatValue(r,"string")}}var g=e.showIfGrouped.getSelected();var c=e.select;var h="";var y;if(i===""||i==null){i=null;y=this._getKeyFromConditionGrid(e);this._removeConditionFromMap(y);this._enableCondition(e,false);var f=this._getIndexOfCondition(e);if(c.getSelected()){c.setSelected(false);c.setEnabled(false);this._bIgnoreSetConditions=true;this.fireDataChange({key:y,index:f,operation:"remove",newData:null});this._bIgnoreSetConditions=false}return}this._enableCondition(e,true);h=this._getFormatedConditionText(a,l,p,n,i,g);var _={value:h,exclude:n,operation:a,keyField:i,value1:r,value2:this._hasSecondValue(a)?d:null,showIfGrouped:g};y=this._getKeyFromConditionGrid(e);if(h!==""||e.value1.isA("sap.m.ComboBox")){c.setSelected(true);c.setEnabled(true);var m="update";if(!this._oConditionsMap[y]){m="add"}this._oConditionsMap[y]=_;if(m==="add"){this._aConditionKeys.splice(this._getIndexOfCondition(e),0,y)}e.data("_key",y);this.fireDataChange({key:y,index:this._getIndexOfCondition(e),operation:m,newData:_})}else if(this._oConditionsMap[y]!==undefined){this._removeConditionFromMap(y);e.data("_key",null);var f=this._getIndexOfCondition(e);if(c.getSelected()){c.setSelected(false);c.setEnabled(false);this._bIgnoreSetConditions=true;this.fireDataChange({key:y,index:f,operation:"remove",newData:null});this._bIgnoreSetConditions=false}}this._updatePaginatorToolbar()};W.prototype._getConditions=function(e){return{index:this._iConditions,key:this._createConditionKey(),exclude:this._oOperationsHelper.isExcludeType(e.oOperation),operation:e.oOperation,keyField:e.oKeyField,value1:e.oPastedValue,value2:null}};W.prototype._isFieldNumeric=function(e){var t=this._getCurrentKeyFieldItem(e.keyField),i=t.type;return!!(i==="numc"||i==="numeric")};W.prototype._isFiscalField=function(e){var t=this._getCurrentKeyFieldItem(e.keyField);return t.typeInstance&&t.typeInstance.isA("sap.ui.comp.odata.type.FiscalDate")};W.prototype._isInvalidRange=function(e){var t=e.value1.getValue(),i=e.value2.getValue();return!!(t&&i&&Number(e.oType.parseValue(t,"string"))>Number(e.oType.parseValue(i,"string")))};W.prototype._isInvalidFiscalRange=function(e){var t,i,a,n,o=e.value1.getValue(),s=e.value2.getValue(),r=this._getCurrentKeyFieldItem(e.keyField),l=r.typeInstance&&r.typeInstance.sFiscalType;if(!this._isFiscalField(e)||!o||!s){return false}if(l==="IsFiscalYearPeriod"||l==="IsFiscalYearQuarter"||l==="IsFiscalYearWeek"){if(o.indexOf("/")!==-1&&s.indexOf("/")!==-1){t=o.split("/")[0];a=s.split("/")[0];i=o.split("/")[1];n=s.split("/")[1];return i===n?t>a:i>n}}else{return parseFloat(o)>parseFloat(s)}};W.prototype._validateAndFormatFieldValue=function(e){var t=e.oSource;var i=t.getParent();var a;var n=this._oRbComp.getText("VALUEHELPVALDLG_FIELD_RANGE_MESSAGE"),o=i&&i.operation&&j.indexOf(i.operation.getSelectedKey())!==-1;if(t.getDateValue&&e){a=e.getParameter("value");var s=e.getParameter("valid");this._makeFieldValid(t,s);return}else{a=t.getValue&&t.getValue()}if(!i){return}if(this.getDisplayFormat()==="UpperCase"&&a){a=a.toUpperCase();t.setValue(a)}if(i.oType&&a){try{var r=i.oType.parseValue(a,"string",o);i.oType.validateValue(r);this._makeFieldValid(t,true);a=i.oType.formatValue(r,"string",o);t.setValue(a);if(i.operation.getSelectedKey()===H.BT){if(this._isFieldNumeric(i)&&this._isInvalidRange(i,e)||this._isInvalidFiscalRange(i,e)){this._makeFieldValid(t,false,n)}else{this._makeFieldValid(i.value1,true);this._makeFieldValid(i.value2,true)}}}catch(e){var l=e.message;this._makeFieldValid(t,false,l)}}else{this._makeFieldValid(t,true)}};W.prototype._changeOperationValueFields=function(t,i){e.prototype._changeOperationValueFields.apply(this,arguments);var a=i.getContent().length,n=i.remove,o=i.indexOfContent(n),s=a-1;if(o!==s){i.insertContent(n,s)}};W.prototype._updateLayout=function(e){};W.prototype._updateConditionFields=function(){this._aConditionsFields=this._createConditionsFields()};W.prototype._addButtons=function(e,t){var i=this,a;var n=new v({type:R.Transparent,icon:o.getIconURI("decline"),tooltip:this._oRb.getText("CONDITIONPANEL_REMOVE"+(this._sAddRemoveIconTooltipKey?"_"+this._sAddRemoveIconTooltipKey:"")+"_TOOLTIP"),press:function(){a=document.getElementById(i.getId()+"-firstfe");if(a&&a.focus){a.focus()}i._oInvisibleMessage.announce(i._oRbComp.getText("VALUEHELPDLG_CONDITIONPANEL_CONDITION_REMOVED"),X.Polite);i._handleRemoveCondition(this.oTargetGrid,e)},layoutData:new C({span:"XL1 L1 M1 S1"})});n.oTargetGrid=t;e.addContent(n);e["remove"]=n;var s=new v({text:this._oRbComp.getText("VALUEHELPDLG_CONDITIONPANEL_ADD"),press:function(){a=document.getElementById(i.getId()+"-firstfe");if(a&&a.focus){a.focus()}i._oInvisibleMessage.announce(i._oRbComp.getText("VALUEHELPDLG_CONDITIONPANEL_CONDITION_ADDED"),X.Polite);i._handleAddCondition(this.oTargetGrid,e,true)},layoutData:new C({span:"XL2 L3 M3 S3",indent:"XL9 L8 M8 S7",linebreak:true}),ariaDescribedBy:i._oInvisibleTextOperatorAddButton});s.oTargetGrid=t;s.addStyleClass("conditionAddBtnFloatRight");s.addStyleClass("conditionAddBtnMarginTop");e.addContent(s);e["add"]=s};W.prototype.getCurrentOparation=function(e){return e.exclude?this._oOperationsHelper.getCorrespondingExcludeOperation(e.operation):e.operation};W.prototype._hasSecondValue=function(t){return e.prototype._hasSecondValue.apply(this,arguments)||t===H.NotBT};W.prototype._hasNoValues=function(t){return e.prototype._hasNoValues.apply(this,arguments)||t===H.NotEmpty};W.prototype._createConditionsFields=function(){return[{ID:"select",Label:"",SpanFilter:"L1 M1 S1",SpanSort:"L1 M1 S1",SpanGroup:"L1 M1 S1",Control:"CheckBox",Value:""},{ID:"keyFieldLabel",Text:"Sort By",SpanFilter:"L1 M1 S1",SpanSort:"L1 M1 S1",SpanGroup:"L1 M1 S1",Control:"Label"},{ID:"keyField",Label:"",SpanFilter:"L3 M5 S10",SpanSort:"L5 M5 S12",SpanGroup:"L4 M4 S12",Control:"ComboBox"},{ID:"operationLabel",Text:"Sort Order",SpanFilter:"L1 M1 S1",SpanSort:"L1 M1 S1",SpanGroup:"L1 M1 S1",Control:"Label"},{ID:"operation",Label:"",SpanFilter:this._aKeyFields.length>1?"L3 M6 S10":"XL3 L3 M3 S10",SpanSort:s.system.phone?"L5 M5 S8":"L5 M5 S9",SpanGroup:"L2 M5 S10",Control:"ComboBox"},{ID:"value1",Label:this._sFromLabelText,SpanFilter:this._aKeyFields.length>1?"L3 M10 S10":"XL4 L4 M4 S10",SpanSort:"L3 M10 S10",SpanGroup:"L3 M10 S10",Control:"TextField",Value:""},{ID:"value2",Label:this._sToLabelText,SpanFilter:this._aKeyFields.length>1?"L2 M10 S10":"XL4 L4 M4 S10",SpanSort:"L2 M10 S10",SpanGroup:"L2 M10 S10",Control:"TextField",Value:""},{ID:"showIfGrouped",Label:this._sShowIfGroupedLabelText,SpanFilter:"L1 M10 S10",SpanSort:"L1 M10 S10",SpanGroup:"L3 M4 S9",Control:"CheckBox",Value:"false"}]};W.prototype._getConditionsGridAtPosition=function(e){var t=this._oConditionsGrid.getContent();if(e>=t.length){return null}return t[e]};W.prototype._getConditionsCount=function(){var e=this._oConditionsGrid.getContent();return e.length};W.prototype.fireDataChange=function(e){var t,i=e.newData;if(i){t=i.operation;i.operation=this._oOperationsHelper.isExcludeType(t)?this._oOperationsHelper.getCorrespondingIncludeOperation(t):t}return n.prototype.fireEvent.call(this,"dataChange",e)};W.prototype._makeFieldValid=function(e,t,i,a){if(a){var n=e.getSelectedItem();if(!n){e.setValueState(z.Error)}else{e.setValueState(z.None)}}else if(t){e.setValueState(z.None);e.setValueStateText("")}else{e.setValueState(z.Warning);e.setValueStateText(i?i:this._sValidationDialogFieldMessage)}};W.prototype._getRelevantOperations=function(e){var t,i=e&&e.typeInstance,a=i&&e.typeInstance.oConstraints&&e.typeInstance.oConstraints.isDigitSequence,n=i&&(e.typeInstance.sFiscalType==="IsFiscalPeriod"||e.typeInstance.sFiscalType==="IsFiscalYearPeriod"),o=a&&n?"numcFiscal":e&&e.type,s=e&&e.type&&this.getOperations(o);if(e&&e.operations){t=e.operations}else if(Array.isArray(s)&&s.length>0){t=s}else{t=this.getOperations("default")}return t};W.prototype._handleComboBoxChangeEvent=function(e,t){var i=t.getSource();this._makeFieldValid(i,true,undefined,true);if(i.getValueState()===z.None){this._changeField(e)}};W.prototype._createValueField=function(e,t,i){var a,n,o=this,s,r={value:t["Value"],width:"100%",placeholder:t["Label"],change:function(e){o._validateAndFormatFieldValue(e);o._changeField(i,e)},layoutData:new C({span:t["Span"+this._sConditionType]})};if(e&&e.typeInstance){var l=e.typeInstance;n=this._findConfig(l,"ctrl");if(n==="DateTimePicker"&&l.getMetadata().getName()==="sap.ui.model.odata.type.DateTime"){if(!(l.oConstraints&&l.oConstraints.isDateOnly)){K.error("sap.m.P13nConditionPanel","sap.ui.model.odata.type.DateTime without displayFormat = Date is not supported!");l.oConstraints=Object.assign({},l.oConstraints,{isDateOnly:true})}n="DatePicker"}i.oType=l;if(n=="select"){var d=[];var u=e.values||this._oTypeValues[n]||["",l.formatValue(false,"string"),l.formatValue(true,"string")];u.forEach(function(e,t){d.push(new p({key:t.toString(),text:e.toString()}))});r={width:"100%",items:d,change:function(){o._changeField(i);o._makeFieldValid(a,true)},layoutData:new C({span:t["Span"+this._sConditionType]})};a=new V(r)}else if(n=="TimePicker"){if(l.oFormatOptions&&l.oFormatOptions.style){r.displayFormat=l.oFormatOptions.style}a=new E(r)}else if(n=="DateTimePicker"){if(l.oFormatOptions&&l.oFormatOptions.style){r.displayFormat=l.oFormatOptions.style}s=this.getProperty("_calendarWeekSettings");if(s){r.calendarWeekNumbering=s}a=new M(r)}else if(n==="DatePicker"){if(l.oFormatOptions){r.displayFormat=l.oFormatOptions.style||l.oFormatOptions.pattern;if(l.isA("sap.ui.comp.odata.type.StringDate")){r.valueFormat="yyyyMMdd"}}s=this.getProperty("_calendarWeekSettings");if(s){r.calendarWeekNumbering=s}a=new P(r)}else{var g=this.data("dropdownFields");a=new k(r);if(g){for(var c=0;c<g.length;c++){if(g[c].name===e.key){r={width:"100%",items:[],change:this._handleComboBoxChangeEvent.bind(this,i),layoutData:new C({span:t["Span"+this._sConditionType]})};a=new L(r);break}}}if(this._fSuggestCallback){e=this._getCurrentKeyFieldItem(i.keyField);if(e&&e.key){var h=this._fSuggestCallback(a,e.key);if(h){a._oSuggestProvider=h}}}}}else{i.oType=null;a=new k(r)}if(n!=="boolean"&&n!=="enum"&&a){a.onpaste=function(e){var t;if(window.clipboardData){t=window.clipboardData.getData("Text")}else{t=e.originalEvent.clipboardData.getData("text/plain")}var i=e.srcControl.getParent();var a=t.split(/\r\n|\r|\n/g);if(a&&a[a.length-1].trim()===""){a.pop()}var n=i.operation;var s=n.getSelectedKey();if(a&&a.length>1&&s!=="BT"){setTimeout(function(){var e=a?a.length:0;var t=o._getCurrentKeyFieldItem(i.keyField);var n=i.operation;for(var s=0;s<e;s++){if(o._aConditionKeys.length>=o._getMaxConditionsAsNumber()){break}var r=a[s].trim();if(r){var l;if(t.typeInstance){try{l=t.typeInstance.parseValue(r,"string");t.typeInstance.validateValue(l)}catch(e){K.error("sap.m.P13nConditionPanel.onPaste","not able to parse value "+r+" with type "+t.typeInstance.getName());r="";l=null}if(!l){continue}}var d={index:o._iConditions,key:o._createConditionKey(),exclude:o.getExclude()||o._oOperationsHelper.isExcludeType(n.getSelectedKey()),operation:n.getSelectedKey(),keyField:t.key,value1:l,value2:null};o._addCondition2Map(d);o.fireDataChange({key:d.key,index:d.index,operation:"add",newData:d})}}o._clearConditions();o._fillConditions()},0)}}}if(e&&e.maxLength&&a.setMaxLength){var y=-1;if(typeof e.maxLength==="string"){y=parseInt(e.maxLength)}if(typeof e.maxLength==="number"){y=e.maxLength}if(y>0&&(!a.getShowSuggestion||!a.getShowSuggestion())){a.setMaxLength(y)}}var f={onAfterRendering:function(e){var t=e.srcControl.getDomRef("inner");if(t){t.setAttribute("inputmode","decimal");t.setAttribute("pattern","[0-9]+([.,][0-9]+)?")}}};if(e&&(e.type==="numeric"||e.type==="numc")&&(this._isPhone()||this._isTablet())){a.addDelegate(f,this)}return a};W.prototype._enableCondition=function(e,t){var i=this._getCurrentKeyFieldItem(e.keyField);i&&i.type==="boolean"?e.operation.setEnabled(false):e.operation.setEnabled(t);e.value1.setEnabled(t);e.value2.setEnabled(t);e.showIfGrouped.setEnabled(t)};W.prototype._getValueTextFromField=function(e){if(e instanceof V){return e.getSelectedItem()?e.getSelectedItem().getText():""}if(e.isA("sap.m.ComboBox")){return e.getSelectedItem()?e.getSelectedItem().getKey():""}return e.getValue()};W.prototype._isPhone=function(){return!!s.system.phone};W.prototype._isTablet=function(){return!!(s.system.tablet&&!s.system.desktop)};return W});
/*!
 * SAPUI5
 * (c) Copyright 2009-2023 SAP SE. All rights reserved.
 */
sap.ui.predefine("sap/ui/comp/p13n/P13nConditionPanelRenderer", ["sap/ui/core/Renderer"],function(n){"use strict";return n.extend("sap.m.P13nConditionPanelRenderer",{renderer:{apiVersion:2,render:function(n,e){n.openStart("span",e.getId()+"-firstfe").class("sapMDialogFirstFE").attr("role","none").attr("tabindex","0").openEnd().close("span");n.openStart("section",e);n.class("sapMConditionPanel");n.openEnd();n.openStart("div");n.class("sapMConditionPanelContent");n.class("sapMConditionPanelBG");n.openEnd();e.getAggregation("content").forEach(function(e){n.renderControl(e)});n.close("div");n.close("section")}}})},true);
/*!
 * SAPUI5
 * (c) Copyright 2009-2023 SAP SE. All rights reserved.
 */
sap.ui.predefine("sap/ui/comp/p13n/P13nFilterPanel", ["sap/m/P13nFilterPanel","sap/ui/comp/p13n/P13nConditionPanel","sap/ui/layout/form/SimpleForm","sap/m/library","sap/m/P13nFilterItem","sap/ui/comp/p13n/P13nOperationsHelper","sap/m/P13nFilterPanelRenderer","sap/ui/layout/library"],function(e,t,i,n,o,a,s,r){"use strict";var l=n.P13nPanelType,p=n.P13nConditionOperation;var d=r.form.SimpleFormLayout;var u=e.extend("sap.ui.comp.p13n.P13nFilterPanel",{metadata:{library:"sap.ui.comp.p13n",properties:{maxIncludes:{type:"string",group:"Misc",defaultValue:"-1"},maxExcludes:{type:"string",group:"Misc",defaultValue:"-1"},maxConditions:{type:"string",group:"Misc",defaultValue:"-1"},defaultOperation:{type:"string",group:"Misc",defaultValue:null}}},renderer:s.renderer});u.prototype.setConditions=function(e){this._oConditionPanel.setConditions(e);return this};u.prototype.getConditions=function(){return this._oConditionPanel.getConditions()};u.prototype.setContainerQuery=function(e){this.setProperty("containerQuery",e);this._oConditionPanel.setContainerQuery(e);return this};u.prototype.setLayoutMode=function(e){this.setProperty("layoutMode",e);this._oConditionPanel.setLayoutMode(e);return this};u.prototype.validateConditions=function(){return this._oConditionPanel.validateConditions()};u.prototype.removeInvalidConditions=function(){this._oConditionPanel.removeInvalidConditions()};u.prototype.removeValidationErrors=function(){this._oConditionPanel.removeValidationErrors()};u.prototype.setIncludeOperations=function(e,t,i){t=t||"default";this.bEnhanceInclude=!i;this._aIncludeOperations[t]=e;if(this._oConditionPanel){this._oConditionPanel.setOperations(this._aIncludeOperations[t],t)}};u.prototype.getIncludeOperations=function(e){if(this._oConditionPanel){return this._oConditionPanel.getOperations(e,false)}};u.prototype.setExcludeOperations=function(e,t,i){t=t||"default";this.bEnhanceExclude=!i;this._aExcludeOperations[t]=e;if(this._oConditionPanel){this._oConditionPanel.setOperations(this._aExcludeOperations[t],t,true)}};u.prototype.getExcludeOperations=function(e){if(this._oConditionPanel){return this._oConditionPanel.getOperations(e,true)}};u.prototype.setKeyFields=function(e,t){this._aKeyFields=e;if(this._oConditionPanel){e.some(function(e){if(e.isDefault){this._oConditionPanel.setAutoAddNewRow(true)}}.bind(this));this._oConditionPanel.setKeyFields&&this._oConditionPanel.setKeyFields(e)}};u.prototype.setMaxConditions=function(e){this.setProperty("maxConditions",e);if(this._oConditionPanel){this._oConditionPanel.setMaxConditions(e)}return this};u.prototype.setMaxIncludes=function(e){this.setProperty("maxIncludes",e);this._updateIncludeOperations();return this};u.prototype.setMaxExcludes=function(e){this.setProperty("maxExcludes",e);this._updateExcludeOperations();return this};u.prototype._updatePanel=function(){};u.prototype.setDefaultOperation=function(e){this.setProperty("defaultOperation",e);if(this._oConditionPanel){this._oConditionPanel.setDefaultOperation(e)}return this};u.prototype.init=function(){this.setType(l.filter);this.setTitle(sap.ui.getCore().getLibraryResourceBundle("sap.m").getText("FILTERPANEL_TITLE"));this._aKeyFields=[];this._oRb=sap.ui.getCore().getLibraryResourceBundle("sap.m");this._aIncludeOperations={};this._aExcludeOperations={};this.bEnhanceExclude=true;this.bEnhanceInclude=true;this._oPanel=new i({layout:d.ResponsiveGridLayout});this._oConditionPanel=new t({maxConditions:this.getMaxConditions(),alwaysShowAddIcon:false,layoutMode:this.getLayoutMode(),dataChange:this._handleDataChange(),defaultOperation:this.getDefaultOperation()});this._oConditionPanel._sAddRemoveIconTooltipKey="FILTER";this._oPanel.addContent(this._oConditionPanel);this.addAggregation("content",this._oPanel);if(!this._oOperationsHelper){this._oOperationsHelper=new a}this._updateOperations()};u.prototype.onBeforeRendering=function(){var e=[],t,i,n=this.getEnableEmptyOperations();if(this._bUpdateRequired){this._bUpdateRequired=false;var o=this.getMessageStrip();if(o){o.addStyleClass("sapUiResponsiveMargin");this.insertAggregation("content",o,0)}t=[];i=(this.getBindingInfo("items")||{}).model;var a=function(e,t,i){var n=i.getBinding(e),o;if(n&&t){return t.getObject()[n.getPath()]}o=i.getMetadata();return o.hasProperty(e)?o.getProperty(e).get(i):o.getAggregation(e).get(i)};this.getItems().forEach(function(o){var s=o.getBindingContext(i),r,l,p;if(o.getBinding("key")){s.getObject()[o.getBinding("key").getPath()]=o.getKey()}t.push(r={key:o.getColumnKey(),text:a("text",s,o),tooltip:a("tooltip",s,o),maxLength:a("maxLength",s,o),type:a("type",s,o),typeInstance:a("typeInstance",s,o),formatSettings:a("formatSettings",s,o),precision:a("precision",s,o),scale:a("scale",s,o),isDefault:a("isDefault",s,o),values:a("values",s,o)});if(n){l=o.getNullable();p={};Object.keys(r).forEach(function(e){p[e]=r[e]});e.push(p);this._enhanceFieldOperationsWithEmpty(r,l);this._modifyFieldOperationsBasedOnMaxLength(p)}this._modifyFieldOperationsBasedOnMaxLength(r)},this);this.setKeyFields&&this.setKeyFields(t,e);var s=[];i=(this.getBindingInfo("filterItems")||{}).model;this.getFilterItems().forEach(function(e){var t=e.getBindingContext(i);if(e.getBinding("key")&&t){t.getObject()[e.getBinding("key").getPath()]=e.getKey()}s.push({key:e.getKey(),keyField:a("columnKey",t,e),operation:a("operation",t,e),value1:a("value1",t,e),value2:a("value2",t,e),exclude:a("exclude",t,e)})});this.setConditions(s)}};u.prototype._updateOperations=function(){this._updateIncludeOperations();this._updateExcludeOperations()};u.prototype._updateIncludeOperations=function(){if(this.getMaxIncludes()==="0"){this._oOperationsHelper.getIncludeTypes().forEach(function(e){this.setIncludeOperations([],e)}.bind(this))}else{this._oOperationsHelper.getIncludeTypes().forEach(function(e){this.setIncludeOperations(this._oOperationsHelper.getIncludeOperationsByType(e),e)}.bind(this))}};u.prototype._updateExcludeOperations=function(){if(this.getMaxExcludes()==="0"){this._oOperationsHelper.getExcludeTypes().forEach(function(e){this.setExcludeOperations([],e)}.bind(this))}else{this._oOperationsHelper.getExcludeTypes().forEach(function(e){this.setExcludeOperations(this._oOperationsHelper.getExcludeOperationsByType(e),e)}.bind(this))}};u.prototype._modifyFieldOperationsBasedOnMaxLength=function(e){var t;if(e.maxLength===1||e.maxLength==="1"){t=e.operations?e.operations:this._oConditionPanel.getOperations(e.type);e.operations=[];t.forEach(function(t){if([p.Contains,p.StartsWith,p.EndsWith].indexOf(t)===-1){e.operations.push(t)}},this)}};u.prototype._enhanceFieldOperationsWithEmpty=function(e,t){var i,n,o=e&&e.typeInstance&&e.typeInstance.oConstraints&&e.typeInstance.oConstraints.isDigitSequence,a=e&&e.typeInstance&&(e.typeInstance.sFiscalType==="IsFiscalPeriod"||e.typeInstance.sFiscalType==="IsFiscalYearPeriod");if(["string","stringdate","guid"].indexOf(e.type)>-1||["date","datetime"].indexOf(e.type)>-1&&t&&!(o&&a)&&!this.bIsSingleIntervalRange){i=this._oConditionPanel.getOperations(e.type,false).slice();n=this._oConditionPanel.getOperations(e.type,true).slice();if(i.length===0){i=this._oConditionPanel.getOperations("default",false)}if(n.length===0){n=this._oConditionPanel.getOperations("default",true)}if(i.indexOf(p.Empty)===-1&&this.getMaxIncludes()!=="0"&&this.bEnhanceInclude){i.push(p.Empty)}if(n.indexOf(p.NotEmpty)===-1&&this.getMaxExcludes()!=="0"&&this.bEnhanceExclude){n.push(p.NotEmpty)}if(!Array.isArray(e.operations)){e.operations=[]}e.operations=e.operations.concat(i).concat(n)}};u.prototype._handleDataChange=function(){var e=this;return function(t){var i=t.getParameter("newData"),n=t.getParameter("operation"),a=t.getParameter("key"),s=t.getParameter("index"),r;switch(n){case"update":r=e.getFilterItems()[s];if(r){r.setExclude(i.exclude);r.setColumnKey(i.keyField);r.setOperation(i.operation);r.setValue1(i.value1);r.setValue2(i.value2)}e.fireUpdateFilterItem({key:a,index:s,filterItemData:r});e.fireFilterItemChanged({reason:"updated",key:a,index:s,itemData:{columnKey:i.keyField,operation:i.operation,exclude:i.exclude,value1:i.value1,value2:i.value2}});break;case"add":if(s>=0){s++}r=new o({columnKey:i.keyField,exclude:i.exclude,operation:i.operation});r.setValue1(i.value1);r.setValue2(i.value2);e._bIgnoreBindCalls=true;e.fireAddFilterItem({key:a,index:s,filterItemData:r});e.fireFilterItemChanged({reason:"added",key:a,index:s,itemData:{columnKey:i.keyField,operation:i.operation,exclude:i.exclude,value1:i.value1,value2:i.value2}});e._bIgnoreBindCalls=false;break;case"remove":e._bIgnoreBindCalls=true;e.fireRemoveFilterItem({key:a,index:s});e.fireFilterItemChanged({reason:"removed",key:a,index:s});e._bIgnoreBindCalls=false;break;default:throw"Operation'"+n+"' is not supported yet"}e._notifyChange()}};u.prototype.getConditionPanel=function(){return this._oConditionPanel};u.prototype.setInnerTitle=function(e){this._oPanel&&this._oPanel.setHeaderText(e)};u.prototype.setSuggestCallback=function(e){if(this._oConditionPanel){this._oConditionPanel.setSuggestCallback(e)}};return u});
/*!
 * SAPUI5
 * (c) Copyright 2009-2023 SAP SE. All rights reserved.
 */
sap.ui.predefine("sap/ui/comp/p13n/P13nOperationsHelper", ["sap/m/P13nOperationsHelper","sap/m/library"],function(t,o){"use strict";var e=o.P13nConditionOperation;var n="Not";var N=function(){t.apply(this,arguments);this.init();this.oIncludeOperations.numcFiscal=[e.EQ,e.BT,e.LT,e.LE,e.GT,e.GE]};N.prototype=Object.create(t.prototype);N.prototype.oIncludeOperationsOptinal={optinal:[e.Empty]};N.prototype.oExcludeOperationsDefault={default:[e.NotEQ]};N.prototype.oExcludeOperationsExtended={default:[e.NotEQ,e.NotBT,e.NotLT,e.NotLE,e.NotGT,e.NotGE],string:[e.NotContains,e.NotEQ,e.NotBT,e.NotStartsWith,e.NotEndsWith,e.NotLT,e.NotLE,e.NotGT,e.NotGE],date:[e.NotEQ,e.NotBT,e.NotLT,e.NotLE,e.NotGT,e.NotGE],time:[e.NotEQ,e.NotBT,e.NotLT,e.NotLE,e.NotGT,e.NotGE],datetime:[e.NotEQ,e.NotBT,e.NotLT,e.NotLE,e.NotGT,e.NotGE],numeric:[e.NotEQ,e.NotBT,e.NotLT,e.NotLE,e.NotGT,e.NotGE],numc:[e.NotContains,e.NotEQ,e.NotBT,e.NotEndsWith,e.NotLT,e.NotLE,e.NotGT,e.NotGE],numcFiscal:[e.NotEQ,e.NotBT,e.NotLT,e.NotLE,e.NotGT,e.NotGE],boolean:[e.NotEQ]};N.prototype.oExcludeOperationsOptional={optinal:[e.NotEmpty]};N.prototype.isExcludeType=function(t){return i(t,this.oExcludeOperationsExtended)||i(t,this.oExcludeOperationsOptional)};N.prototype.getCorrespondingExcludeOperation=function(t){return n+t};N.prototype.getCorrespondingIncludeOperation=function(t){return t.slice(n.length)};function i(t,o){var e,n,N,i,r=false;for(n in o){N=o[n];for(e=0;e<N.length;e++){i=N[e];if(i===t){r=true;break}}if(r){break}}return r}return N},true);
/*!
 * SAPUI5
 * (c) Copyright 2009-2023 SAP SE. All rights reserved.
 */
sap.ui.predefine("sap/ui/comp/personalization/BaseController", ["sap/ui/base/ManagedObject","sap/ui/comp/library","./Util","./ColumnHelper","sap/base/Log","sap/ui/mdc/p13n/P13nBuilder","sap/ui/model/json/JSONModel"],function(t,e,n,o,a,i,r){"use strict";var s=t.extend("sap.ui.comp.personalization.BaseController",{metadata:{abstract:true,library:"sap.ui.comp",properties:{type:{type:"string",defaultValue:null},itemType:{type:"string",defaultValue:null},ignoreColumnKeys:{type:"object",defaultValue:[]},additionalIgnoreColumnKeys:{type:"object",defaultValue:[]},stableColumnKeys:{type:"string[]",defaultValue:[]},columnHelper:{type:"sap.ui.comp.personalization.ColumnHelper",defaultValue:null},columnKeys:{type:"string[]",defaultValue:[]},tableType:{type:"string",defaultValue:null},messageStrip:{type:"sap.m.MessageStrip"}},associations:{table:{type:"sap.ui.core.Control",multiple:false}},events:{beforePotentialTableChange:{},afterPotentialTableChange:{},afterPotentialModelChange:{parameters:{json:{type:"object"}}}}}});s.prototype.exit=function(){if(this.getModel()){this.getModel().destroy()}if(this._oAdaptationModel){this._oAdaptationModel.destroy();this._oAdaptationModel=null;this.oPanel=null}};s.prototype.setModelFunction=function(){var t=this;return function(){if(!this.getModel("$sapmP13nPanel")){this.setModel(t.getInternalModel(),"$sapmP13nPanel")}}};s.prototype.setTable=function(t){this.setAssociation("table",t);this.setTableType(n.getTableType(this.getTable()));return this};s.prototype.getTable=function(){var t=this.getAssociation("table");if(typeof t==="string"){t=sap.ui.getCore().byId(t)}return t};s.prototype.getColumnMap=function(){return this.getColumnHelper().getColumnMap()};s.prototype.createControlDataStructure=function(t){t=t||[];var e={};e[this.getType()]={};e[this.getType()][this.getItemType()]=t;return e};s.prototype.createColumnKeysStructure=function(t){t=t||[];var e={};e[this.getType()]={};e[this.getType()][this.getItemType()]=t.map(function(t){return{columnKey:t}});return e};s.prototype.checkConsistency=function(){var t=this.getColumnMap();this.getIgnoreColumnKeys().some(function(e){if(t[e]&&t[e].getVisible()){throw"The provided 'ignoreColumnKeys' for '"+this.getType()+"' are inconsistent. No columns specified as ignored is allowed to be visible."}},this);var e=this.getColumnKeys();Object.keys(t).forEach(function(t){if(e.indexOf(t)<0){throw"The provided 'columnKeys' and columns are inconsistent. For the column '"+t+"' no entry in 'columnKeys' exists."}});var n=this.getStableColumnKeys();n.forEach(function(e,n){if(t[e].getIndex()!=n){throw"The provided 'stableColumnKeys' are inconsistens. Please provide 'stableColumnKeys' by ascending indices of the columns, starting from index 0."}})};s.prototype.initializeInternalModel=function(t){["controlDataInitial","controlDataBase","controlData","alreadyKnownRuntimeData","alreadyKnownPersistentData"].forEach(function(e){if(!t.getProperty("/"+e)){t.setProperty("/"+e,{})}t.setProperty("/"+e+"/"+this.getType(),this.createControlDataStructure()[this.getType()])},this);["ignoreData"].forEach(function(e){if(!t.getProperty("/"+e)){t.setProperty("/"+e,{})}t.setProperty("/"+e+"/"+this.getType(),this.createColumnKeysStructure()[this.getType()])},this);["persistentDataChangeType","persistentDeltaDataChangeType"].forEach(function(n){if(!t.getProperty("/"+n)){t.setProperty("/"+n,{})}t.setProperty("/"+n+"/"+this.getType(),e.personalization.ChangeType.Unchanged);t.setProperty("/"+n+"/"+this.getType(),e.personalization.ChangeType.Unchanged)},this);["controlDataReduce","transientData","beforeOpenData","variantDataInitial"].forEach(function(e){if(!t.getProperty("/"+e)){t.setProperty("/"+e,undefined)}});this.setModel(t,"$sapuicomppersonalizationBaseController")};s.prototype._extendPropertyWithControlDataStructure=function(t){var e=this.getInternalModel();if(e.getProperty("/"+t)){return}e.setProperty("/"+t,{});e.setProperty("/"+t+"/"+this.getType(),this.createControlDataStructure()[this.getType()])};s.prototype.getInternalModel=function(){return this.getModel("$sapuicomppersonalizationBaseController")};s.prototype.calculateIgnoreData=function(){var t=this.getIgnoreColumnKeys().concat(this.getAdditionalIgnoreColumnKeys());t=t.filter(function(e,n){return t.indexOf(e)===n});var e=this.createColumnKeysStructure(t);this.setIgnoreData2Model(e)};s.prototype.calculateControlData=function(){var t=n.copy(this.getControlDataBase());this._deselectIgnoreDataFromJson(t);this.setControlData2Model(t)};s.prototype.calculateControlDataReduce=function(){var t=n.copy(this.getControlDataBase());this._removeIgnoreDataFromJson(t);this.setControlDataReduce2Model(t)};s.prototype.calculateTransientData=function(t){t=n.copy(t);this._removeIgnoreDataFromJson(t);this.setTransientData2Model(t)};s.prototype.calculatePersistentChangeTypesFromJson=function(t,n){var o=this.getPersistentDeltaDataChangeType();var a=this.getUnionData(this.getControlDataInitial(),t);o[this.getType()]=this.getChangeType(a,this.getAlreadyKnownPersistentData());this.setPersistentDeltaDataChangeType(o);o=this.getPersistentDataChangeType();if(n===e.personalization.ResetType.ResetFull){o[this.getType()]=this.getChangeType(t,this.getControlDataInitial())}else if(n===e.personalization.ResetType.ResetPartial){o[this.getType()]=this.getChangeType(t,this.getVariantDataInitial())}this.setPersistentDataChangeType(o)};s.prototype._removeIgnoreDataFromJson=function(t){if(!this.getIgnoreData()[this.getType()]){return}this.getIgnoreData()[this.getType()][this.getItemType()].forEach(function(e){var o=n.getIndexByKey("columnKey",e.columnKey,t[this.getType()][this.getItemType()]);if(o>-1){t[this.getType()][this.getItemType()].splice(o,1)}},this)};s.prototype._deselectIgnoreDataFromJson=function(t){if(!this.getIgnoreData()[this.getType()]){return}this.getIgnoreData()[this.getType()][this.getItemType()].forEach(function(e){var o=n.getIndexByKey("columnKey",e.columnKey,t[this.getType()][this.getItemType()]);if(o>-1){this.handleIgnore(t,o)}},this)};s.prototype.updateControlDataBaseFromJson=function(t){var e=this.getIgnoreData();var o=n.copy(this.getControlDataBase());var a=n.copy(this.getControlDataBase());var i=n.copy(t);o[this.getType()][this.getItemType()]=this.getControlDataBase()[this.getType()][this.getItemType()].filter(function(t){return n.getIndexByKey("columnKey",t.columnKey,e[this.getType()][this.getItemType()])>-1},this);i[this.getType()][this.getItemType()]=t[this.getType()][this.getItemType()].filter(function(t){return n.getIndexByKey("columnKey",t.columnKey,e[this.getType()][this.getItemType()])<0},this);a[this.getType()][this.getItemType()]=i[this.getType()][this.getItemType()];if(this.getType()==="columns"){if(a[this.getType()][this.getItemType()].length!==i[this.getType()][this.getItemType()].length){throw"the updated columns are inconsistent with 'controlDataBase'"}a[this.getType()][this.getItemType()].some(function(t){if(n.getIndexByKey("columnKey",t.columnKey,i[this.getType()][this.getItemType()])<0){throw"the columnKey '"+t.columnKey+"' is not contained in 'controlDataBase'"}},this)}var r=n.copy(this.getControlDataBase());r[this.getType()][this.getItemType()]=a[this.getType()][this.getItemType()].concat(o[this.getType()][this.getItemType()]);Object.keys(r[this.getType()]).forEach(function(e){if(!Array.isArray(r[this.getType()][e])){r[this.getType()][e]=t[this.getType()][e]}},this);this.setControlDataBase2Model(r);this.fireAfterPotentialModelChange({json:r})};s.prototype.extendControlDataInitial=function(t){this._extendData("controlDataInitial",t)};s.prototype.extendControlDataBase=function(t){this._extendData("controlDataBase",t)};s.prototype.extendVariantDataInitial=function(t){this._extendData("variantDataInitial",t)};s.prototype.extendAlreadyKnownRuntimeData=function(t){this._extendData("alreadyKnownRuntimeData",t)};s.prototype.extendAlreadyKnownPersistentData=function(t){this._extendData("alreadyKnownPersistentData",t)};s.prototype._extendData=function(t,e){if(!e||!e[this.getType()]||!this._getInternalModelData(t)){return}var o=n.copy(e);var a=this.getInternalModel();Object.keys(o[this.getType()]).forEach(function(e){if(Array.isArray(o[this.getType()][e])){o[this.getType()][e].forEach(function(o){var i=this._getInternalModelData(t)[this.getType()][e];if(n.getIndexByKey("columnKey",o.columnKey,i)>-1){throw"columnKey '"+o.columnKey+"' does already exist in internal model"}a.setProperty("/"+t+"/"+this.getType()+"/"+e+"/"+i.length+"/",o)},this);return}a.setProperty("/"+t+"/"+this.getType()+"/"+e+"/",o[this.getType()][e])},this)};s.prototype.setControlDataInitial2Model=function(t){this._setModelData("controlDataInitial",t)};s.prototype.setControlDataBase2Model=function(t){this._setModelData("controlDataBase",t)};s.prototype.setControlData2Model=function(t){this._setModelData("controlData",t)};s.prototype.setAlreadyKnownRuntimeData2Model=function(t){this._setModelData("alreadyKnownRuntimeData",t)};s.prototype.setAlreadyKnownPersistentData2Model=function(t){this._setModelData("alreadyKnownPersistentData",t)};s.prototype.setVariantDataInitial2Model=function(t){this._extendPropertyWithControlDataStructure("variantDataInitial");this._setModelData("variantDataInitial",t)};s.prototype.setIgnoreData2Model=function(t){this._setModelData("ignoreData",t)};s.prototype.setPersistentDataChangeType=function(t){this._setModelData("persistentDataChangeType",t)};s.prototype.setPersistentDeltaDataChangeType=function(t){this._setModelData("persistentDeltaDataChangeType",t)};s.prototype.setControlDataReduce2Model=function(t){this._extendPropertyWithControlDataStructure("controlDataReduce");this._setModelData("controlDataReduce",t)};s.prototype.setTransientData2Model=function(t){this._extendPropertyWithControlDataStructure("transientData");this._setModelData("transientData",t)};s.prototype.setBeforeOpenData2Model=function(t){this._extendPropertyWithControlDataStructure("beforeOpenData");this._setModelData("beforeOpenData",t)};s.prototype._setModelData=function(t,e){this.getInternalModel().setProperty("/"+t+"/"+this.getType(),e?n.copy(e)[this.getType()]:undefined)};s.prototype.getControlDataInitial=function(){return this._getInternalModelData("controlDataInitial")};s.prototype.getControlDataBase=function(){return this._getInternalModelData("controlDataBase")};s.prototype.getControlData=function(){return this._getInternalModelData("controlData")};s.prototype.getAlreadyKnownRuntimeData=function(){return this._getInternalModelData("alreadyKnownRuntimeData")};s.prototype.getAlreadyKnownPersistentData=function(){return this._getInternalModelData("alreadyKnownPersistentData")};s.prototype.getVariantDataInitial=function(){return this._getInternalModelData("variantDataInitial")};s.prototype.getIgnoreData=function(){return this._getInternalModelData("ignoreData")};s.prototype.getPersistentDataChangeType=function(){return this._getInternalModelData("persistentDataChangeType")};s.prototype.getPersistentDeltaDataChangeType=function(){return this._getInternalModelData("persistentDeltaDataChangeType")};s.prototype.getControlDataReduce=function(){return this._getInternalModelData("controlDataReduce")};s.prototype.getTransientData=function(){return this._getInternalModelData("transientData")};s.prototype.getBeforeOpenData=function(){return this._getInternalModelData("beforeOpenData")};s.prototype.isEqualAdditionalIgnoreColumnKeys=function(t){var e=this.getAdditionalIgnoreColumnKeys();if(e.length!==t.length){return false}return!e.some(function(e){return t.indexOf(e)<0})};s.prototype._getInternalModelData=function(t){return this.getInternalModel().getProperty("/"+t)};s.prototype.determineMissingColumnKeys=function(t){if(!t||!t[this.getType()]||!t[this.getType()][this.getItemType()]){return this.createColumnKeysStructure()}var e=this.getColumnMap();var o=this.getIgnoreData();var a=t[this.getType()][this.getItemType()].filter(function(t){return!e[t.columnKey]}).filter(function(t){return n.getIndexByKey("columnKey",t.columnKey,o[this.getType()][this.getItemType()])<0},this).map(function(t){return t.columnKey});return this.createColumnKeysStructure(a)};s.prototype.extractIgnoreDataFromJson=function(t){if(!t||!t[this.getType()]||!t[this.getType()][this.getItemType()]){return null}var e=this.getIgnoreData();var o=t[this.getType()][this.getItemType()].filter(function(t){return n.getIndexByKey("columnKey",t.columnKey,e[this.getType()][this.getItemType()])>-1},this);return o.length?this.createControlDataStructure(o):null};s.prototype.getTable2Json=function(t){var e=this.createControlDataStructure();var n=this.getColumnMap();var o=this.getColumnKeys();t[this.getType()][this.getItemType()].forEach(function(t){var i=n[t.columnKey];if(!i){a.warning("Column with columnKey '"+t.columnKey+"' does not exist.");return}var r=this.getColumn2Json(i,t.columnKey,o.indexOf(t.columnKey));if(r){e[this.getType()][this.getItemType()].push(r)}},this);this.getAdditionalData2Json(e,this.getTable());return e};s.prototype.getTable2JsonTransient=function(t){var e=this.createControlDataStructure();var o=this.getColumnMap();var a,i;var r;t[this.getType()][this.getItemType()].forEach(function(t){var n=false;if(this.getType()==="columns"){this.getStableColumnKeys().forEach(function(e){if(e==t.columnKey){n=true}})}var s=o[t.columnKey];if(!s||n){return}if(s.isA("sap.ui.table.Column")){if(!s.getLabel()){throw"The column '"+t.columnKey+"' should have a 'label' aggregation otherwise the column can not be identified in the personalization dialog."}a=s.getLabel().getText();r=s.getTooltip();i=r&&typeof r==="object"&&r.isA("sap.ui.core.TooltipBase")?r.getTooltip_Text():s.getTooltip_Text()}if(s.isA("sap.m.Column")){if(!s.getHeader()){throw"The column '"+t.columnKey+"' should have a 'header' aggregation otherwise the column can not be identified in the personalization dialog."}a=s.getHeader().getText();r=s.getHeader().getTooltip();i=r&&typeof r==="object"&&r.isA("sap.ui.core.TooltipBase")?r.getTooltip_Text():s.getHeader().getTooltip_Text()}if(s.isA("sap.ui.comp.personalization.ColumnWrapper")){if(!s.getLabel()){throw"The column '"+t.columnKey+"' should have a 'label' aggregation otherwise the column can not be identified in the personalization dialog."}a=s.getLabel();r=s.getTooltip();i=r&&typeof r==="object"&&r.isA("sap.ui.core.TooltipBase")?r.getTooltip_Text():s.getTooltip_Text()}var l=this.getColumn2JsonTransient(s,t.columnKey,a,i);if(l){e[this.getType()][this.getItemType()].push(l)}},this);n.sortItemsByText(e[this.getType()][this.getItemType()],"text");return e};s.prototype.getColumn2Json=function(t,e,n){};s.prototype.getAdditionalData2Json=function(t,e){};s.prototype.getColumn2JsonTransient=function(t,e){};s.prototype.handleIgnore=function(t,e){};s.prototype.fixConflictWithIgnore=function(t,e){};s.prototype.syncJson2Table=function(t){};s.prototype.getPanel=function(){};s.prototype.getAdaptationUI=function(){return this.oPanel&&!this.oPanel.bIsDestroyed?this.oPanel:null};s.prototype.retrieveAdaptationUI=function(t){return this.getPanel(t)};s.prototype.getAdaptationData=function(){var t=this.getTransientData();var e=this.getInternalModel().getProperty("/controlDataReduce");var n=e[this.getType()][this.getItemType()].reduce(function(t,e,n){t[e.columnKey]=Object.assign({},e);t[e.columnKey].position=n;return t},{});var o=[];t[this.getType()][this.getItemType()].forEach(function(t,e){o.push(this._transformAdaptationData(n[t.columnKey],t))}.bind(this));this._sortAdaptationData(o);return o};s.prototype._transformAdaptationData=function(t,e){return{position:t?t.position:-1,name:e.columnKey,label:e.text,tooltip:e.tooltip}};s.prototype._sortAdaptationData=function(t){i.sortP13nData({visible:"visible",position:"position"},t)};s.prototype._getPresenceAttribute=function(){return"visible"};s.prototype._getP13nBuilder=function(){return i};s.prototype.getChangeType=function(t,e){};s.prototype.getChangeData=function(t,e){};s.prototype.getUnionData=function(t,e){};s.prototype.getResetWarningText=function(){return undefined};return s});
/*!
 * SAPUI5
 * (c) Copyright 2009-2023 SAP SE. All rights reserved.
 */
sap.ui.predefine("sap/ui/comp/personalization/ChartWrapper", ["sap/ui/core/Element","sap/ui/comp/library","./ColumnWrapper","sap/ui/core/CustomData"],function(e,t,a,r){"use strict";var o=t.personalization.AggregationRole;var n=e.extend("sap.ui.comp.personalization.ChartWrapper",{constructor:function(t,a){e.apply(this,arguments)},metadata:{library:"sap.ui.comp",properties:{externalFilters:{type:"sap.m.P13nFilterItem[]",defaultValue:[]}},aggregations:{columns:{type:"sap.ui.comp.personalization.ColumnWrapper",multiple:true,singularName:"column"}},associations:{chart:{type:"sap.chart.Chart",multiple:false}},events:{externalFiltersSet:{parameters:{filters:{type:"sap.m.P13nFilterItem[]"}}}}}});n.prototype.getChartObject=function(){var e=this.getAssociation("chart");if(typeof e==="string"){e=sap.ui.getCore().byId(e)}return e};n.prototype.getModel=function(){return this.getChartObject().getModel()};n.prototype.getDomRef=function(){var e=this.getChartObject();return e&&e.getDomRef()};n.createChartWrapper=function(e,t,l){var i;var s={};e.getDimensions().forEach(function(t){i=t.data("p13nData");s[i.columnKey]=new a({label:t.getLabel(),tooltip:t.getTooltip(),selected:e.getVisibleDimensions().indexOf(t.getName())>-1,aggregationRole:o.Dimension,role:t.getRole()?t.getRole():t.getMetadata().getProperty("role").getDefaultValue(),sorted:i.sorted,sortOrder:i.sortOrder,customData:new r({key:"p13nData",value:i}),hierarchyLevel:i.hierarchyLevel,chart:e})});e.getMeasures().forEach(function(t){i=t.data("p13nData");s[i.columnKey]=new a({label:t.getLabel(),tooltip:t.getTooltip(),selected:e.getVisibleMeasures().indexOf(t.getName())>-1,aggregationRole:o.Measure,role:t.getRole()?t.getRole():t.getMetadata().getProperty("role").getDefaultValue(),sorted:i.sorted,sortOrder:i.sortOrder,customData:new r({key:"p13nData",value:i}),chart:e})});if(t){t.forEach(function(t){s[t.columnKey]=new a({label:t.label,tooltip:t.tooltip,selected:false,aggregationRole:o.NotDimeasure,sorted:t.sorted,sortOrder:t.sortOrder,customData:new r({key:"p13nData",value:t}),chart:e});if(!s[t.columnKey].getParent()){e.addDependent(s[t.columnKey])}})}return new n({chart:e,columns:l.map(function(e){return s[e]})})};return n});
/*!
 * SAPUI5
 * (c) Copyright 2009-2023 SAP SE. All rights reserved.
 */
sap.ui.predefine("sap/ui/comp/personalization/ColumnHelper", ["sap/ui/base/ManagedObject","./Util","./ColumnWrapper","sap/base/util/isEmptyObject"],function(e,o,t,n){"use strict";var u=e.extend("sap.ui.comp.personalization.ColumnHelper",{constructor:function(o,t){e.apply(this,arguments)},metadata:{properties:{callbackOnSetVisible:{type:"object",defaultValue:null},callbackOnSetSummed:{type:"object",defaultValue:null},callbackOnSetGrouped:{type:"object",defaultValue:null}}}});u.prototype.init=function(){this._oColumnKey2ColumnMap={};this._oColumnKeyIsMonkeyPatched={}};u.prototype.exit=function(){this._oColumnKey2ColumnMap=null;this._oColumnKeyIsMonkeyPatched=null};u.prototype.addColumns=function(e){if(!e){return}e.forEach(function(e){this._addColumnToMap(o.getColumnKey(e),e)},this);this._checkConsistencyOfColumns(this._oColumnKey2ColumnMap)};u.prototype.addColumnMap=function(e){if(!e){return}for(var o in e){this._addColumnToMap(o,e[o])}this._checkConsistencyOfColumns(this._oColumnKey2ColumnMap)};u.prototype.getColumnMap=function(){return this._oColumnKey2ColumnMap};u.prototype._checkConsistencyOfColumns=function(e){if(n(e)){return}var t=Object.keys(e)[0];var u=!!o._getCustomProperty(e[t],"columnKey");for(var i in e){if(u!==!!o._getCustomProperty(e[i],"columnKey")){throw"The table instance contains some columns for which a columnKey is provided, some for which a columnKey is not provided."}}};u.prototype._addColumnToMap=function(e,o){if(this._oColumnKey2ColumnMap[e]){throw"Duplicate 'columnKey': The column '"+o.getId()+"' and column '"+this._oColumnKey2ColumnMap[e]+"' have same 'columnKey' "+e}if(!this._oColumnKey2ColumnMap[e]){this._oColumnKey2ColumnMap[e]=o;this._monkeyPatchColumn(o,e)}};u.prototype._monkeyPatchColumn=function(e,o){if(e instanceof t){return}if(this._oColumnKeyIsMonkeyPatched[o]){return}this._oColumnKeyIsMonkeyPatched[o]=true;var n=this.getCallbackOnSetVisible();var u=e.setVisible.bind(e);var i=function(e){if(n){n(e,o)}u(e)};e.setVisible=i;if(e.setSummed){var l=this.getCallbackOnSetSummed();var a=e.setSummed.bind(e);var s=function(o){if(l){l(o,e)}a(o)};e.setSummed=s}if(e.isA("sap.ui.table.AnalyticalColumn")){var c=this.getCallbackOnSetGrouped();if(typeof c==="function"){var m=e.setGrouped.bind(e);var r=function(o,t){if(!t&&c){c(o,e)}m(o)};e.setGrouped=r}}};return u});
/*!
 * SAPUI5
 * (c) Copyright 2009-2023 SAP SE. All rights reserved.
 */
sap.ui.predefine("sap/ui/comp/personalization/ColumnWrapper", ["sap/ui/core/Element","sap/ui/comp/personalization/Util"],function(e,t){"use strict";var a=e.extend("sap.ui.comp.personalization.ColumnWrapper",{constructor:function(t,a){e.apply(this,arguments)},metadata:{library:"sap.ui.comp",properties:{label:{type:"string"},tooltip:{type:"string"},selected:{type:"boolean",defaultValue:false},aggregationRole:{type:"sap.ui.comp.personalization.AggregationRole"},role:{type:"string"},href:{type:"string",defaultValue:null},internalHref:{type:"string",defaultValue:null},target:{type:"string",defaultValue:null},press:{type:"object",defaultValue:null},sorted:{type:"boolean",defaultValue:false},sortOrder:{type:"string",defaultValue:"Ascending"},hierarchyLevel:{type:"int",defaultValue:0},description:{type:"string",defaultValue:null}},associations:{chart:{type:"sap.chart.Chart",multiple:false}}}});a.prototype.getVisible=function(){var e=this.getAssociation("chart");if(typeof e==="string"){e=sap.ui.getCore().byId(e)}var a=e.getVisibleDimensions().concat(e.getVisibleMeasures());var i=t.getColumnKey(this);return a.indexOf(i)>-1};return a});
/*!
 * SAPUI5
 * (c) Copyright 2009-2023 SAP SE. All rights reserved.
 */
sap.ui.predefine("sap/ui/comp/personalization/ColumnsController", ["./BaseController","sap/m/library","sap/ui/comp/library","./Util","sap/base/util/merge"],function(e,t,n,i,o){"use strict";var l=t.MultiSelectMode;var s=e.extend("sap.ui.comp.personalization.ColumnsController",{constructor:function(n,i){e.apply(this,arguments);this.setType(t.P13nPanelType.columns);this.setItemType(t.P13nPanelType.columns+"Items")},metadata:{properties:{triggerModelChangeOnColumnInvisible:{type:"boolean",group:"Misc",defaultValue:false}},events:{afterColumnsModelDataChange:{}}}});s.prototype.setTable=function(t){e.prototype.setTable.apply(this,arguments);if(this.getTableType()===n.personalization.TableType.ResponsiveTable){var i=t.findElements(false,function(e){return e.isA("sap.m.plugins.ColumnResizer")})[0];if(i){i.detachColumnResize(this._onColumnResize,this);i.attachColumnResize(this._onColumnResize,this)}}else if(this.getTableType()===n.personalization.TableType.AnalyticalTable||this.getTableType()===n.personalization.TableType.Table||this.getTableType()===n.personalization.TableType.TreeTable){t.detachColumnMove(this._onColumnMove,this);t.detachColumnVisibility&&t.detachColumnVisibility(this._onColumnVisibility,this);t.detachColumnResize(this._onColumnResize,this);t.attachColumnMove(this._onColumnMove,this);t.attachColumnVisibility&&t.attachColumnVisibility(this._onColumnVisibility,this);t.attachColumnResize(this._onColumnResize,this)}this._monkeyPatchTable(t)};s.prototype.getColumn2Json=function(e,t,n){return{columnKey:t,index:n,visible:e.getVisible(),width:e.getWidth?e.getWidth():undefined,total:e.getSummed?e.getSummed():undefined}};s.prototype.getAdditionalData2Json=function(e,t){e.columns.fixedColumnCount=t&&t.getFixedColumnCount?t.getFixedColumnCount():undefined;e.columns.showDetails=false};s.prototype.getColumn2JsonTransient=function(e,t,n,i){return{columnKey:t,text:n,tooltip:i!==n?i:undefined}};s.prototype.handleIgnore=function(e,t){e.columns.columnsItems[t].visible=false};s.prototype.syncJson2Table=function(e){var t=this.getTable();var i=this.getColumnMap();this.fireBeforePotentialTableChange();if(this.getTable()&&(this.getTableType()===n.personalization.TableType.AnalyticalTable||this.getTableType()===n.personalization.TableType.Table||this.getTableType()===n.personalization.TableType.TreeTable)){this._applyChangesToUiTableType(t,e,i)}else if(this.getTableType()===n.personalization.TableType.ResponsiveTable){this._applyChangesToMTableType(t,e,i)}this.fireAfterPotentialTableChange()};s.prototype.getDataSuiteFormat2Json=function(e){var t=this.createControlDataStructure();var n=function(e,n,o){var l=i.getIndexByKey("columnKey",e,t.columns.columnsItems);if(l<0){l=t.columns.columnsItems.length;t.columns.columnsItems.splice(l,0,{columnKey:e})}t.columns.columnsItems[l][n]=o};this.getControlDataInitial().columns.columnsItems.filter(function(e){return e.visible===true}).forEach(function(e){n(e.columnKey,"visible",false)});if(e.Visualizations&&e.Visualizations.length){var o=e.Visualizations.filter(function(e){return e.Type==="LineItem"});if(o.length){o[0].Content.forEach(function(e,t){n(e.Value,"visible",true);n(e.Value,"index",t)},this)}var l=e.Visualizations.filter(function(e){return e.Type==="ColumnWidth"});if(l.length){l[0].Content.forEach(function(e){n(e.Value,"width",e.Width)},this)}}if(e.Total&&e.Total.length){e.Total.forEach(function(e){n(e,"total",true)})}return t};s.prototype.getDataSuiteFormatSnapshot=function(e){var t=this.getUnionData(this.getControlDataInitial(),this.getControlData());if(!t.columns||!t.columns.columnsItems||!t.columns.columnsItems.length){return}var n=t.columns.columnsItems.filter(function(e){return!!e.total});if(n.length){e.Total=n.map(function(e){return e.columnKey})}var i=t.columns.columnsItems.filter(function(e){return!!e.visible});if(i.length){if(!e.Visualizations){e.Visualizations=[]}i.sort(this._sortByIndex);e.Visualizations.push({Type:"LineItem",Content:i.map(function(e){return{Value:e.columnKey,Label:undefined}})})}var o=t.columns.columnsItems.filter(function(e){return!!e.width});if(o.length){if(!e.Visualizations){e.Visualizations=[]}e.Visualizations.push({Type:"ColumnWidth",Content:o.map(function(e){return{Value:e.columnKey,Width:e.width}})})}};s.prototype._onColumnMove=function(e){var t=e.getParameter("newPos"),n=i.getColumnKey(e.getParameter("column")),o=this.getControlData(),l=o.columns.columnsItems,s,a,u;this._sortAdaptationData(l);s=l.findIndex(function(e){return e.index===t});a=i.getIndexByKey("columnKey",n,l);if(a<0||s<0||a>l.length-1||s>l.length-1){return}if(s<a){u=1}else if(s>a){u=-1}this.fireBeforePotentialTableChange();var r=l.splice(a,1);l.splice(s,0,r[0]);for(var m=s;m!=a;m=m+u){this._swapIndexes(l[m],l[m+u])}this.updateControlDataBaseFromJson(o);this.fireAfterPotentialTableChange();this.fireAfterColumnsModelDataChange()};s.prototype._onColumnVisibility=function(e){this.fireBeforePotentialTableChange();this._updateInternalModel(i.getColumnKey(e.getParameter("column")),"visible",e.getParameter("newVisible"));this.fireAfterPotentialTableChange();this.fireAfterColumnsModelDataChange()};s.prototype._onColumnTotal=function(e){this.fireBeforePotentialTableChange();this._updateInternalModel(i.getColumnKey(e.column),"total",e.isSummed);this.fireAfterPotentialTableChange();this.fireAfterColumnsModelDataChange()};s.prototype._onColumnResize=function(e){this.fireBeforePotentialTableChange();this._updateInternalModel(i.getColumnKey(e.getParameter("column")),"width",e.getParameter("width"));this.fireAfterPotentialTableChange();this.fireAfterColumnsModelDataChange()};s.prototype._onColumnFixedCount=function(e){this.fireBeforePotentialTableChange();var t=this.getControlData();this.getInternalModel().setProperty("/controlData/columns/fixedColumnCount",e);this.updateControlDataBaseFromJson(t);this.fireAfterPotentialTableChange();this.fireAfterColumnsModelDataChange()};s.prototype._updateInternalModel=function(e,t,n){if(!e||!t){return}var o=this.getControlData();var l=i.getIndexByKey("columnKey",e,o.columns.columnsItems);if(l<0){throw"No entry found in 'controlDataBase' for columnKey '"+e+"'"}this.getInternalModel().setProperty("/controlData/columns/columnsItems/"+l+"/"+t,n);this.updateControlDataBaseFromJson(o)};s.prototype.getPanel=function(e){var t=e&&e.visibleItemsThreshold?e.visibleItemsThreshold:-1;return new Promise(function(e){sap.ui.require(["sap/m/P13nColumnsPanel","sap/m/P13nItem","sap/m/P13nColumnsItem"],function(n,i,o){return e(new n({visibleItemsThreshold:t,items:{path:"$sapmP13nPanel>/transientData/columns/columnsItems",template:new i({columnKey:"{$sapmP13nPanel>columnKey}",text:"{$sapmP13nPanel>text}",tooltip:"{$sapmP13nPanel>tooltip}"})},columnsItems:{path:"$sapmP13nPanel>/controlDataReduce/columns/columnsItems",template:new o({columnKey:"{$sapmP13nPanel>columnKey}",index:"{$sapmP13nPanel>index}",visible:"{$sapmP13nPanel>visible}",width:"{$sapmP13nPanel>width}",total:"{$sapmP13nPanel>total}"})},beforeNavigationTo:this.setModelFunction(),changeColumnsItems:function(e){if(!e.getParameter("items")){return}var t=this.getControlDataReduce();t.columns.columnsItems=e.getParameter("items");this.setControlDataReduce2Model(t);this._enhanceForStableKeys(this.getControlDataInitial(),t);this.fireAfterPotentialModelChange({json:t})}.bind(this)}))}.bind(this))}.bind(this))};s.prototype._swapIndexes=function(e,t){var n=e.index;e.index=t.index;t.index=n};s.prototype._quickSortPartition=function(e,t,n){var i,o=t,l=e[n];for(i=t;i<=n-1;i++){if(e[i].index<l.index){if(i!==o){this._swapIndexes(e[o],e[i])}o++}}this._swapIndexes(e[o],l);return o};s.prototype._quickSort=function(e,t,n){var i,o,l,s=[t,n];while(s[s.length-1]>=0){l=s.pop();o=s.pop();i=this._quickSortPartition(e,o,l);if(i-1>o){s.push(o);s.push(i-1)}if(i+1<l){s.push(i+1);s.push(l)}}};s.prototype._sortIndexesByOrder=function(e){var t=e.findIndex(function(e){return!Number.isInteger(e.index)}),n=t===-1?e.length-1:t-1;if(n>0){this._quickSort(e,0,n)}};s.prototype.retrieveAdaptationUI=function(e){return new Promise(function(e){sap.ui.require(["sap/m/p13n/SelectionPanel"],function(t){var n=this.getAdaptationData();var i=new t({showHeader:true,enableCount:true,fieldColumn:sap.ui.getCore().getLibraryResourceBundle("sap.ui.mdc").getText("fieldsui.COLUMNS"),multiSelectMode:l.Default});i.setP13nData(n);this.oPanel=i;var o;i.attachChange(function(e){o=e.getSource().getP13nData().map(function(e,t){var i={columnKey:e.name,visible:e.visible,width:e.width,total:e.total};i.index=n[t].position;return i});this._sortAdaptationData(o);this._sortIndexesByOrder(o);var t=this.getControlDataReduce();t.columns.columnsItems=o;this.setControlDataReduce2Model(t);this.fireAfterPotentialModelChange({json:this._enhanceForStableKeys(this.getControlDataInitial(),t)})}.bind(this));e(i)}.bind(this))}.bind(this))};s.prototype._transformAdaptationData=function(t,n){var i=e.prototype._transformAdaptationData.apply(this,arguments);i.visible=t.visible;i.position=t.index;i.width=t.width;i.total=t.total;return i};s.prototype._sortByIndex=function(e,t){if(e.index!==undefined&&t.index===undefined){return-1}if(t.index!==undefined&&e.index===undefined){return 1}if(e.index<t.index){return-1}if(e.index>t.index){return 1}return 0};s.prototype._applyChangesToUiTableType=function(e,t,n){var i=null;var o={};var l=this;var s=function(e,t){e.forEach(function(e){o[e.columnKey]=e});e.sort(l._sortByIndex);var n=e.map(function(e){return e.columnKey});t.forEach(function(e,t){if(n.indexOf(e)<0){n.splice(t,0,e)}});return n};var a=function(e,t){var n=o[e];if(n&&n.visible!==undefined&&t.getVisible()!==n.visible){t.setVisible(n.visible,true)}};var u=function(t,n,i){var o=e.indexOfColumn(i);var l=t;if(l!==undefined&&o!==l){if(o>-1){e.removeColumn(i,true)}e.insertColumn(i,l,true)}};var r=function(e,t){var n=o[e];if(n&&n.width!==undefined&&t.getWidth()!==n.width){t.setWidth(n.width,true)}};var m=function(e,t){var n=o[e];if(n&&n.total!==undefined&&t.getSummed&&t.getSummed()!==n.total){t.setSummed(n.total,true)}};if(t.columns.columnsItems.length){var c=s(t.columns.columnsItems,this.getColumnKeys());c.forEach(function(e,t){i=n[e];if(i){a(e,i);u(t,e,i);r(e,i);m(e,i)}})}var f=t.columns.fixedColumnCount||0;if(e.getFixedColumnCount&&e.getFixedColumnCount()!==f){e.setFixedColumnCount(f,true)}};s.prototype._applyChangesToMTableType=function(e,t,n){var i=false;var o=function(e,t){var n=e.index;if(n!==undefined){t.setOrder(n,true);i=true}};var l=function(e,t){if(e.visible!==undefined&&t.getVisible()!==e.visible){t.setVisible(e.visible,true);i=true}};var s=function(e,t){if(e.width!==undefined&&t.getWidth()!==e.width){t.setWidth(e.width)}};if(t.columns.columnsItems.length){t.columns.columnsItems.sort(function(e,t){if(e.index<t.index){return-1}if(e.index>t.index){return 1}return 0});t.columns.columnsItems.forEach(function(e){var t=n[e.columnKey];if(t){o(e,t);l(e,t);s(e,t)}},this)}if(i){e.invalidate()}};s.prototype.getChangeType=function(e,t){var i=this.getChangeData(e,t);var o=this.getTableType()===n.personalization.TableType.AnalyticalTable||this.getTriggerModelChangeOnColumnInvisible();if(i){var l=n.personalization.ChangeType.TableChanged,s=i.columns.showDetails;i.columns.columnsItems.some(function(e){if(e.visible||e.visible===false&&o){l=n.personalization.ChangeType.ModelChanged;return true}if(e.total===false||e.total===true){l=n.personalization.ChangeType.ModelChanged;return true}});if(s&&s!==t.columns.showDetails){l=n.personalization.ChangeType.ModelChanged}return l}return n.personalization.ChangeType.Unchanged};s.prototype.getChangeData=function(e,t){if(!t||!t.columns||!t.columns.columnsItems){return null}var n={columns:i.copy(e.columns)},o=e.columns.showDetails===t.columns.showDetails,l=true;l=e.columns.fixedColumnCount===t.columns.fixedColumnCount;e.columns.columnsItems.some(function(e){var n=i.getArrayElementByKey("columnKey",e.columnKey,t.columns.columnsItems);if(!i.semanticEqual(e,n)){l=false;return true}});l=l&&o;if(l){return null}var s=[];n.columns.columnsItems.forEach(function(e,n){var o=i.getArrayElementByKey("columnKey",e.columnKey,t.columns.columnsItems);if(i.semanticEqual(e,o)){s.push(e);return}for(var l in e){if(l==="columnKey"||!o){if(o&&o[l]===undefined){delete e[l]}else{continue}}if(e[l]===o[l]){delete e[l]}}if(Object.keys(e).length<2){s.push(e)}});s.forEach(function(e){var t=i.getIndexByKey("columnKey",e.columnKey,n.columns.columnsItems);n.columns.columnsItems.splice(t,1)});if(n.columns.fixedColumnCount===0){delete n.columns.fixedColumnCount}if(o){delete n.columns.showDetails}return n};s.prototype._sortArrayByPropertyName=function(e,t,n){var i=[];if(n===null||n===undefined){n=false}if(e&&e.length>0&&t!==undefined&&t!==null&&t!==""){if(n){i=o([],e)}else{i=e}i.sort(function(e,n){var i=e[t];var o=n[t];if(i<o||i!==undefined&&o===undefined){return-1}if(i>o||i===undefined&&o!==undefined){return 1}return 0})}return i};s.prototype.getUnionData=function(e,t){if(!t||!t.columns||!t.columns.columnsItems){return i.copy(e)}var n=i.copy(t);Object.keys(e.columns).forEach(function(t){if(Array.isArray(e.columns[t])){e.columns[t].forEach(function(e){var o=i.getArrayElementByKey("columnKey",e.columnKey,n.columns[t]);if(!o){n.columns[t].push(e);return}if(o.visible===undefined&&e.visible!==undefined){o.visible=e.visible}if(o.width===undefined&&e.width!==undefined){o.width=e.width}if(o.total===undefined&&e.total!==undefined){o.total=e.total}if(o.index===undefined&&e.index!==undefined){o.index=e.index}});return}if(n.columns[t]===undefined&&e.columns[t]!==undefined){n.columns[t]=e.columns[t]}},this);n.columns.columnsItems=n.columns.columnsItems.sort(function(e,t){return e.index-t.index}).reduce(function(e,t){var n=e[e.length-1];if(n&&n.index>=t.index){t.index=n.index+1}e.push(t);return e},[]);return n};s.prototype._enhanceForStableKeys=function(e,t){if(this.getStableColumnKeys().length>0&&this._checkFillRequired(e,t)){var n=this._getFilledArray(e,t);t.columns.columnsItems=n}return t};s.prototype._checkFillRequired=function(e,t){var n=t.columns.columnsItems.reduce(function(e,t){e[t.columnKey]=t;return e},{});var i=e.columns.columnsItems.some(function(e){return!n[e.columnKey]});return i};s.prototype._getFilledArray=function(e,t){var n=[];var i=e.columns.columnsItems.reduce(function(e,t){e[t.columnKey]=t;return e},{});for(var o=0;o<t.columns.columnsItems.length;o++){var l=t.columns.columnsItems[o];if(i[l.columnKey]){var s=l.index;i[l.columnKey]=l;i[l.columnKey].index=s}}Object.keys(i).forEach(function(e){n.push(i[e])});return n};s.prototype.fixConflictWithIgnore=function(e,t){if(!e||!e.columns||!e.columns.columnsItems||!t||!t.columns||!t.columns.columnsItems||!t.columns.columnsItems.length){return e}this._sortArrayByPropertyName(e.columns.columnsItems,"index");var n=false;t.columns.columnsItems.forEach(function(t){var o=i.getIndexByKey("columnKey",t.columnKey,e.columns.columnsItems);if(o<0||e.columns.columnsItems[o].index===undefined){return}if(o+1<=e.columns.columnsItems.length-1&&e.columns.columnsItems[o+1].index===e.columns.columnsItems[o].index||o-1>=0&&e.columns.columnsItems[o-1].index===e.columns.columnsItems[o].index){n=true}if(o+1<=e.columns.columnsItems.length-1&&e.columns.columnsItems[o+1].index===e.columns.columnsItems[o].index){var l=e.columns.columnsItems.splice(o,1);e.columns.columnsItems.splice(o+1,0,l[0])}});if(n){var o=-1;e.columns.columnsItems.forEach(function(e){if(e.index!==undefined){e.index=++o}})}};s.prototype.isColumnSelected=function(e,t){var n=i.getIndexByKey("columnKey",t,e.columnsItems);return n>-1?e.columnsItems[n].visible:false};s.prototype._monkeyPatchTable=function(e){if(this.getTableType()!==n.personalization.TableType.AnalyticalTable&&this.getTableType()!==n.personalization.TableType.Table&&this.getTableType()!==n.personalization.TableType.TreeTable){return}var t=this;var i=e.setFixedColumnCount.bind(e);var o=function(e,n){t._onColumnFixedCount(e);i(e,n)};if(e.setFixedColumnCount.toString()===o.toString()){return}e.setFixedColumnCount=o};s.prototype._updateInternalModelShowHide=function(e){var t=this.getControlData();this.getInternalModel().setProperty("/controlData/columns/showDetails/",e);this.updateControlDataBaseFromJson(t);this.fireAfterColumnsModelDataChange()};s.prototype.exit=function(){e.prototype.exit.apply(this,arguments);var t=this.getTable();if(this.getTable()&&(this.getTableType()===n.personalization.TableType.AnalyticalTable||this.getTableType()===n.personalization.TableType.Table||this.getTableType()===n.personalization.TableType.TreeTable)){t.detachColumnMove(this._onColumnMove,this);t.detachColumnVisibility&&t.detachColumnVisibility(this._onColumnVisibility,this);t.detachColumnResize(this._onColumnResize,this)}};return s});
/*!
 * SAPUI5
 * (c) Copyright 2009-2023 SAP SE. All rights reserved.
 */
sap.ui.predefine("sap/ui/comp/personalization/Controller", ["sap/base/Log","sap/ui/thirdparty/jquery","sap/ui/base/ManagedObject","sap/m/library","sap/ui/comp/library","./ColumnsController","./FilterController","./GroupController","./SortController","./DimeasureController","./SelectionController","./Util","./ChartWrapper","./SelectionWrapper","./ColumnHelper","sap/m/MessageStrip","sap/m/P13nDialog","./Validator","sap/ui/model/json/JSONModel","sap/ui/Device","sap/ui/model/BindingMode"],function(t,jQuery,e,n,i,a,o,r,s,l,h,u,g,p,c,_,C,f,d,y,D){"use strict";var m=e.extend("sap.ui.comp.personalization.Controller",{constructor:function(t,n){e.apply(this,arguments)},metadata:{library:"sap.ui.comp",interfaces:["sap.m.p13n.modules.AdaptationProvider"],properties:{setting:{type:"object",defaultValue:{}},resetToInitialTableState:{type:"boolean",defaultValue:true},columnKeys:{type:"string[]",defaultValue:[]}},associations:{table:{type:"object",multiple:false}},events:{beforePotentialTableChange:{},afterPotentialTableChange:{},afterP13nModelDataChange:{parameters:{persistentData:{type:"object"},persistentDataChangeType:{type:"sap.ui.comp.personalization.ChangeType"},runtimeDeltaData:{type:"object"},runtimeDeltaDataChangeType:{type:"sap.ui.comp.personalization.ChangeType"}}},requestColumns:{parameters:{columnKeys:{type:"string"}}},dialogAfterClose:{parameters:{cancel:{type:"boolean"}}},dialogAfterOpen:{},dialogConfirmedReset:{}}}});m.prototype.applySettings=function(t){e.prototype.applySettings.apply(this,arguments);this._initialize()};m.prototype._initialize=function(){this._bInitCalled=true;var t,e=this.getTable();if(!e){throw"The table instance should be passed into constructor."}t=e.getParent();if(t&&t.isA("sap.ui.comp.smarttable.SmartTable")){this._aAvailablePanels=t._aAvailablePanels.map(function(t){return t.toLowerCase()})}this._createSettingCurrent(this.getSetting());var n=e.getColumns();if(!this.getColumnKeys().length){this.setProperty("columnKeys",u.getColumnKeys(n),true)}var i=this._createInternalModel(this.getColumnKeys());this._callControllers(this._oSettingCurrent,"initializeInternalModel",i);this._oColumnHelper=new c({callbackOnSetVisible:this._onSetVisible.bind(this),callbackOnSetSummed:this._onSetSummed.bind(this),callbackOnSetGrouped:e.fireGroup?this._onSetGrouped.bind(this):null});this._oColumnHelper.addColumns(n);this._callControllers(this._oSettingCurrent,"setColumnHelper",this._oColumnHelper);this._callControllers(this._oSettingCurrent,"setTriggerModelChangeOnColumnInvisible");this._callControllers(this._oSettingCurrent,"setTable",e);this._callControllers(this._oSettingCurrent,"setColumnKeys",this.getColumnKeys());this._callControllers(this._oSettingCurrent,"setIgnoreColumnKeys");this._callControllers(this._oSettingCurrent,"setStableColumnKeys");this._callControllers(this._oSettingCurrent,"checkConsistency");this._callControllers(this._oSettingCurrent,"calculateIgnoreData");var a=m._getOrderedColumnKeys(this._oColumnHelper.getColumnMap(),this.getColumnKeys());this._extendModelStructure(a);this._callControllers(this._oSettingCurrent,"calculateControlData");this._suspendTable();this._syncTableUi();this._resumeTable(true);this._fireChangeEvent()};m.prototype.init=function(){this._oDialog=null;this._bInitCalled=false;this._bSuspend=false;this._bUnconfirmedResetPressed=false;this._oColumnHelper=null;this._oSettingCurrent={}};m.prototype.setSetting=function(t){if(this._bInitCalled){throw"The setting instance should be passed only into constructor."}t=this.validateProperty("setting",t);this.setProperty("setting",t,true);return this};m.prototype.setResetToInitialTableState=function(t){if(this._bInitCalled){throw"The resetToInitialTableState property should be passed only into constructor."}t=this.validateProperty("resetToInitialTableState",t);this.setProperty("resetToInitialTableState",t,true);return this};m.prototype.setColumnKeys=function(e){if(this._bInitCalled){throw"The columnKeys array should be passed only into constructor."}e=this.validateProperty("columnKeys",e);var n=e.filter(function(n,i){var a=e.indexOf(n,i+1)>-1;if(a){t.warning("The provided columnKeys is inconsistent as columnKey "+n+" is not unique and therefore the duplicate entry is deleted from columnKeys.")}return!a});this.setProperty("columnKeys",n,true);return this};m.prototype.setTable=function(t){if(this._bInitCalled){throw"The table instance should be passed only into constructor."}this.setAssociation("table",t);return this};m.prototype._createSettingCurrent=function(t){var e=u.getTableType(this.getTable());var a,o;switch(e){case i.personalization.TableType.ChartWrapper:a=[n.P13nPanelType.dimeasure,n.P13nPanelType.sort,n.P13nPanelType.filter];break;case i.personalization.TableType.SelectionWrapper:a=[n.P13nPanelType.selection];break;default:a=[n.P13nPanelType.columns,n.P13nPanelType.sort,n.P13nPanelType.filter,n.P13nPanelType.group]}for(o in t){if(t[o].visible===false&&a.indexOf(o)>-1){a.splice(a.indexOf(o),1)}if(t[o].visible===true&&a.indexOf(o)<0){a.push(o)}}a.forEach(function(e){this._oSettingCurrent[e]={visible:true,controller:t[e]&&t[e].controller?t[e].controller:this._controllerFactory(e),payload:t[e]&&t[e].payload?t[e].payload:undefined,ignoreColumnKeys:t[e]&&t[e].ignoreColumnKeys?t[e].ignoreColumnKeys:[],triggerModelChangeOnColumnInvisible:t[e]&&t[e].triggerModelChangeOnColumnInvisible?t[e].triggerModelChangeOnColumnInvisible:undefined,createMessageStrip:t[e]&&t[e].createMessageStrip?t[e].createMessageStrip:undefined};if(e=="columns"){this._oSettingCurrent.columns.stableColumnKeys=t.stableColumnKeys}},this)};m.prototype._mixSetting=function(t,e){if(!e){return t}if(e.useAvailablePanels){return Object.assign(t,e)}for(var n in e){if(e[n].visible===true&&t[n]&&t[n].visible===true){e[n].controller=t[n].controller;e[n].payload=e[n].payload||t[n].payload}}return e};m.prototype.openLegacyDialog=function(t){this._suspendTable();this._prepareDialogUi();var e=this._mixSetting(this._oSettingCurrent,t);this._bCancelPressed=false;this._oDialog=new C(this.getId()+"-P13nDialog",{stretch:y.system.phone,showReset:t&&t.showReset!==undefined?t.showReset:true,showResetEnabled:{path:"$sapuicomppersonalizationBaseController>/isDirty"},initialVisiblePanelType:this._oInitialVisiblePanelType,validationExecutor:function(){var t=u.getTableType(this.getTable());var n=this._oColumnHelper.getColumnMap();var i=this._callControllers(e,"getUnionData",this._getControlDataInitial(),this._getControlDataReduce());return f.checkGroupAndColumns(t,e,n,i,[]).then(function(n){var i=this._callControllers(e,"getUnionData",this._getControlDataBase(),this._getControlDataReduce());var a=this._callControllers(e,"getUnionData",this._getControlDataInitial(),i);var o=this._callControllers(e,"getChangeData",a,this._getAlreadyKnownPersistentData());return f.checkSaveChanges(t,e,o,n)}.bind(this)).then(function(n){return f.checkChartConsistency(t,e,i,n)}).then(function(t){return t})}.bind(this)});this._oDialog.setModel(this._getInternalModel(),"$sapuicomppersonalizationBaseController");this._oDialog.toggleStyleClass("sapUiSizeCompact",!!jQuery(this.getTable().getDomRef()).closest(".sapUiSizeCompact").length);if(t&&t.contentWidth){this._oDialog.setContentWidth(t.contentWidth)}if(t&&t.contentHeight){this._oDialog.setContentHeight(t.contentHeight)}if(t&&t.styleClass){this._oDialog.addStyleClass(t.styleClass)}this._callControllers(this._oSettingCurrent,"setMessageStrip");var n=this._callControllers(e,"getPanel");var i=[];for(var a in n){if(n[a]){i.push(n[a])}}Promise.all(i).then(function(t){t.forEach(function(t){this._oDialog.addPanel(t)},this);this._oDialog.attachOk(this._handleDialogOk,this);this._oDialog.attachCancel(this._handleDialogCancel,this);this._oDialog.attachReset(this._handleDialogReset,this);this._oDialog.attachAfterClose(this._handleDialogAfterClose,this);this._oDialog.isPopupAdaptationAllowed=function(){return false};this._oDialog.setEscapeHandler(function(){this._handleDialogCancel().bind(this)}.bind(this));this._oDialog.open();this.fireDialogAfterOpen()}.bind(this))};m.prototype.getUISettings=function(){var t=this._oUISetting;var e=this._callControllers(t,"retrieveAdaptationUI");var n={resetEnabled:t.showReset,contentHeight:t.contentHeight,contentWidth:t.contentWidth};var i=[];var a=Object.keys(e);var o=sap.ui.getCore().getLibraryResourceBundle("sap.ui.mdc");var r={columns:o.getText("p13nDialog.TAB_Column"),dimeasure:o.getText("p13nDialog.TAB_Chart"),filter:o.getText("p13nDialog.TAB_Filter"),sort:o.getText("p13nDialog.TAB_Sort"),group:o.getText("p13nDialog.TAB_Group"),selection:o.getText("info.SELECTION_DIALOG_ALIGNEDTITLE")};var s=this._callControllers(t,"getResetWarningText");a.forEach(function(t){var a=r[t];var o=e[t];n[t]={resetEnabled:true,adaptationUI:o instanceof Promise?o:Promise.resolve(),reset:{warningText:s[t]},containerSettings:{title:a,tabText:a,contentHeight:n.contentHeight,contentWidth:n.contentWidth}};i.push(e[t])},this);Promise.all(i).then(function(t){this._callControllers(this._oSettingCurrent,"setModelFunction")}.bind(this));return n};m.prototype.initAdaptation=function(){return Promise.resolve()};m.prototype.reset=function(e,n){this._resetMessageStrip();return new Promise(function(n){this.resetPersonalization();this._syncDialogUi();this._callControllers(this._oSettingCurrent,"setBeforeOpenData2Model",this._getControlDataBase());for(var i in this._oSettingCurrent){var a=this._oSettingCurrent[i].controller;if(a&&a.getAdaptationUI()&&a.getAdaptationUI().setP13nData){a.getAdaptationUI().setP13nData(a.getAdaptationData())}}return new Promise(function(n){if(e){sap.ui.getCore().loadLibrary("sap.ui.fl",{async:true}).then(function(){sap.ui.require(["sap/ui/comp/navpopover/FlexConnector"],function(i){return i.discardChangesForControl(e._container).then(function(){n(true)},function(e){t.error("Changes could not be discarded in LRep: "+e);n(false)})})})}else{n(false)}}).then(function(){this._syncDialogUi();for(var t in this._oSettingCurrent){var e=this._oSettingCurrent[t].controller;if(e&&e.getAdaptationUI()&&e.getAdaptationUI().setP13nData){e.getAdaptationUI().setP13nData(e.getAdaptationData())}}n()}.bind(this))}.bind(this))};m.prototype.validateP13n=function(t,e,n){var i=u.getTableType(this.getTable());var a=this._oColumnHelper.getColumnMap();var o=this._callControllers(this._oSettingCurrent,"getUnionData",this._getControlDataInitial(),this._getControlDataReduce());return f.checkGroupAndColumns(i,this._oSettingCurrent,a,o,[]).then(function(t){return f.checkChartConsistency(i,this._oSettingCurrent,o,t)}.bind(this)).then(function(t){return f.checkVisibleItemsThreshold(i,this._oSettingCurrent,o,t)}.bind(this)).then(function(t){if(t.length>0){t.forEach(function(t){for(var e in this._oSettingCurrent){var n=this._oSettingCurrent[e].controller;if(t.panelTypes.indexOf(e)>-1&&n){n.getAdaptationUI().setMessageStrip(new _({type:t.messageType,text:t.messageText}))}}}.bind(this))}else{this._resetMessageStrip()}}.bind(this))};m.prototype.preparePersonalization=function(){this._prepareDialogUi()};m.prototype.openDialog=function(t){var e;this._suspendTable();this._prepareDialogUi();this._oUISetting=this._mixSetting(this._oSettingCurrent,t);if(this._oUISetting&&this._oUISetting.showReset!==undefined){e={showReset:this._oUISetting.showReset}}this._callControllers(this._oSettingCurrent,"setMessageStrip");var n=Object.keys(this._getControllers());var i=Object.assign([],n);if(t&&t.useAvailablePanels!==true){var a=Object.keys(t);n.forEach(function(t,e){if(a.indexOf(t)<0){i.splice(i.indexOf(t),1)}})}if(!e&&i&&i.length===1&&this._aAvailablePanels&&this._aAvailablePanels.indexOf(i[0])>-1){e={showReset:false}}return sap.ui.getCore().loadLibrary("sap.ui.mdc",{async:true}).then(function(){return new Promise(function(t,e){sap.ui.require(["sap/ui/comp/personalization/UIManager"],function(e){t(e)},e)})}).then(function(n){if(!this._oUIManager){this._oUIManager=new n(this)}return this._oUIManager.show(this.getTable(),i,e).then(function(e){if(e.getCustomHeader()){var n=e.getCustomHeader().getContentRight()[0];if(n){n.bindProperty("enabled",{model:"$sapmP13nPanel",path:"/isDirty",formatter:function(t){return!!t}})}}e.getButtons()[1].attachPress(this._handleDialogCancel,this);e.attachAfterClose(this._handleDialogAfterClose,this);if(i.length>1&&this._sActivePanel){e.getContent()[0].switchView(this._sActivePanel)}if(t&&t.styleClass){e.addStyleClass(t.styleClass)}e.setModel(this._getInternalModel(),"$sapmP13nPanel");this._oDialog=e;this.fireDialogAfterOpen();return e}.bind(this))}.bind(this))};m.prototype.addColumns=function(t){var e=this.getTable();Object.keys(t).forEach(function(n){if(!t[n].getParent()){e.addDependent(t[n])}});this._oColumnHelper.addColumnMap(t)};m.prototype.getDataSuiteFormatSnapshot=function(){this._callControllers(this._oSettingCurrent,"calculateControlData");var t={};this._callControllers(this._oSettingCurrent,"getDataSuiteFormatSnapshot",t);return t};m.prototype.setDataSuiteFormatSnapshot=function(t,e,n){if(n){u.convertSelectOptions(t,this._oColumnHelper.getColumnMap());u.convertFilters(e,this._oColumnHelper.getColumnMap())}var i=this._callControllers(this._oSettingCurrent,"getDataSuiteFormat2Json",t);this._setRuntimeAndPersonalizationData(i,e)};m.prototype.setPersonalizationDataAsDataSuiteFormat=function(t,e){if(e){u.convertSelectOptions(t,this._oColumnHelper.getColumnMap())}var n=this._callControllers(this._oSettingCurrent,"getDataSuiteFormat2Json",t);this._setRuntimeAndPersonalizationData(n,n)};m.prototype.setPersonalizationData=function(t,e){this._extendModelStructure(this._requestMissingColumnsWithoutIgnore(t));if(e){u.convertFilters(t,this._oColumnHelper.getColumnMap())}this._setRuntimeAndPersonalizationData(t,t)};m.prototype._resetFilters=function(t){var e,n,i,a=this._oSettingCurrent&&this._oSettingCurrent.filter&&this._oSettingCurrent.filter.controller,o=this._getVariantData()&&this._getVariantData().filter&&this._getVariantData().filter.filterItems||[],r=this._getControlDataInitial()&&this._getControlDataInitial().filter&&this._getControlDataInitial().filter.filterItems;if(a){n=a.oFilterProvider;i=a.oMDCFilterPanel}if(i&&this._oDialog&&this._oDialog.isOpen()){if(t){if(!this._getControlDataInitial()){if(n){n.clear()}e=e.map(function(t){t.active=false;return t});i.setP13nData(e)}else{this._resetToState(r,n,a,i)}}else{this._resetToState(o,n,a,i)}}};m.prototype._resetToState=function(t,e,n,i){var a,o,r,s,l,h,u,g=i.getP13nData();if(g&&t){for(a=0;a<g.length;a++){s=g[a];h=s.name;s.active=false;u=n._getControlByName(h);if(e){l=e._getFieldMetadata(h);e._createInitialModelForField({},l)}if(u){if(u.setValue){u.setValue(null)}if(u.setTokens){u.setTokens([])}}for(o=0;o<t.length;o++){r=t[o];if(r.columnKey===h){s.active=true;break}}}i.setP13nData(g);if(e){n._updateFilterData(t)}else{n._updateBasicFilters(t)}}};m.prototype.resetPersonalization=function(t){t=this._determineResetType(t);if(t===i.personalization.ResetType.ResetFull){this._resetFull();this._resetFilters(true)}else{this._resetPartial();this._resetFilters(false)}this._setRuntimeAndPersonalizationData(this._getControlDataBase(),this._getVariantData())};m.prototype.addToSettingIgnoreColumnKeys=function(t){if(this._isEqualAdditionalIgnoreColumnKeys(t)){return this}this._callControllers(this._oSettingCurrent,"setAdditionalIgnoreColumnKeys",t);this._callControllers(this._oSettingCurrent,"calculateIgnoreData");this._requestMissingColumnsWithoutIgnore(this._getControlDataBase());this._suspendTable();this._syncTableUi();this._resumeTable(true);this._fireChangeEvent();return this};m.prototype._handleDialogReset=function(){this._bUnconfirmedResetPressed=true;var t=this._determineResetType();if(t===i.personalization.ResetType.ResetFull){this._resetFull()}else{this._resetPartial()}this._syncDialogUi()};m.prototype._handleDialogOk=function(){if(this._oDialog.isA("sap.m.P13nDialog")){this._oDialog.detachOk(this._handleDialogOk,this)}if(this._bUnconfirmedResetPressed){this.fireDialogConfirmedReset()}setTimeout(function(){this._postDialogUi(this._getControlDataReduce());this._syncTableUi();var t=function(t){var e=false;for(var n in this._oSettingCurrent){e=e||t.getParameter("runtimeDeltaDataChangeType")[n]==="ModelChanged";if(e){break}}var i=!e;this._resumeTable(i)};this.attachEventOnce("afterP13nModelDataChange",t,this);this._fireChangeEvent()}.bind(this),0);if(this._oDialog.isA("sap.m.P13nDialog")){this._oDialog.close()}};m.prototype.handleP13n=function(){return new Promise(function(t){var e=this._oDialog.getContent()[0];if(e.isA("sap.m.p13n.Container")){this._sActivePanel=e.getCurrentViewKey()}var n=u.getTableType(this.getTable());var i=this._callControllers(this._oSettingCurrent,"getUnionData",this._getControlDataBase(),this._getControlDataReduce());var a=this._callControllers(this._oSettingCurrent,"getUnionData",this._getControlDataInitial(),i);var o=this._callControllers(this._oSettingCurrent,"getChangeData",a,this._getAlreadyKnownPersistentData());this._handleDialogOk(true);return f.checkSaveChanges(n,this._oSettingCurrent,o,[]).then(function(){t()})}.bind(this))};m.prototype._handleDialogCancel=function(){if(this._oDialog.isA("sap.m.P13nDialog")){this._oDialog.detachCancel(this._handleDialogCancel,this)}setTimeout(function(){this._postDialogUi(this._getBeforeOpenData());this._resumeTable(false);this._callControllers(this._oSettingCurrent,"calculateControlData")}.bind(this),0);this._bCancelPressed=true;if(this._oDialog.isA("sap.m.P13nDialog")){this._oDialog.close()}};m.prototype._handleDialogAfterClose=function(){if(this._oDialog.isA("sap.m.P13nDialog")){this._oInitialVisiblePanelType=this._oDialog.getVisiblePanel()?this._oDialog.getVisiblePanel().getType():this._getInitialVisiblePanelType()}this._bUnconfirmedResetPressed=false;this.fireDialogAfterClose({cancel:this._bCancelPressed});if(this._oDialog){this._oDialog.destroy();this._oDialog=null}};m.prototype._getInitialVisiblePanelType=function(){for(var t in this._oSettingCurrent){return t}};m.prototype._suspendTable=function(){if(u.getTableBaseType(this.getTable())===i.personalization.TableType.Table){this._bSuspend=true}};m.prototype._resumeTable=function(t){t=t===undefined?true:t;var e=this.getTable();if(this._bSuspend){if(e){if(t){e.invalidate()}}this._bSuspend=false}};m.prototype._requestMissingColumnsWithoutIgnore=function(t){var e=this._callControllers(this._oSettingCurrent,"determineMissingColumnKeys",t);var n=u.getUnionOfColumnKeys(e);if(!n.length){return[]}this.fireRequestColumns({columnKeys:n});return n};m.prototype._extendModelStructure=function(t){if(!t.length){return}var e=this._callControllers(this._oSettingCurrent,"createColumnKeysStructure",t);var n=this._callControllers(this._oSettingCurrent,"getTable2Json",e);this._callControllers(this._oSettingCurrent,"extendControlDataInitial",n);this._callControllers(this._oSettingCurrent,"extendVariantDataInitial",n);this._callControllers(this._oSettingCurrent,"extendControlDataBase",n);this._callControllers(this._oSettingCurrent,"extendAlreadyKnownRuntimeData",n);this._callControllers(this._oSettingCurrent,"extendAlreadyKnownPersistentData",n)};m.prototype._setRuntimeAndPersonalizationData=function(t,e){t=t===null?{}:t;if(!this._sanityCheck(t)){return}e=e===null?{}:e;if(!this._sanityCheck(e)){return}this._setVariantData(e);this._extendModelStructure(this._requestMissingColumnsWithoutIgnore(t));var n=this._callControllers(this._oSettingCurrent,"getUnionData",this._getControlDataInitial(),e);this._callControllers(this._oSettingCurrent,"setVariantDataInitial2Model",n);var i=this._callControllers(this._oSettingCurrent,"getUnionData",this._getControlDataInitial(),t);this._callControllers(this._oSettingCurrent,"fixConflictWithIgnore",i,this._getIgnoreData());this._callControllers(this._oSettingCurrent,"setControlDataBase2Model",i);for(var a in this._oSettingCurrent){this._calculateChangeType(a,i)}this._suspendTable();this._syncTableUi();this._resumeTable(true);this._fireChangeEvent()};m.prototype._prepareDialogUi=function(){var t=this._callControllers(this._oSettingCurrent,"createColumnKeysStructure",this.getColumnKeys());this._extendModelStructure(this._requestMissingColumnsWithoutIgnore(t));this._callControllers(this._oSettingCurrent,"setBeforeOpenData2Model",this._getControlDataBase());this._callControllers(this._oSettingCurrent,"calculateControlDataReduce");var e=this._callControllers(this._oSettingCurrent,"getTable2JsonTransient",t);this._callControllers(this._oSettingCurrent,"calculateTransientData",e);this._callControllers(this._oSettingCurrent,"calculatePropertyInfo",e)};m.prototype._postDialogUi=function(t){this._callControllers(this._oSettingCurrent,"updateControlDataBaseFromJson",t);this._callControllers(this._oSettingCurrent,"setBeforeOpenData2Model",undefined);this._callControllers(this._oSettingCurrent,"setControlDataReduce2Model",undefined);this._callControllers(this._oSettingCurrent,"setTransientData2Model",undefined)};m.prototype._syncDialogUi=function(){this._callControllers(this._oSettingCurrent,"calculateControlDataReduce")};m.prototype._syncTableUi=function(){this._callControllers(this._oSettingCurrent,"calculateControlData");this._callControllers(this._oSettingCurrent,"syncJson2Table",this._getControlData())};m.prototype._resetFull=function(){this._setVariantData(undefined);this._callControllers(this._oSettingCurrent,"setControlDataBase2Model",this._getControlDataInitial())};m.prototype._resetPartial=function(){this._callControllers(this._oSettingCurrent,"setControlDataBase2Model",this._getVariantDataInitial())};m.prototype._calculateChangeType=function(t,e){var n={};n[t]=this._oSettingCurrent[t];this._callControllers(n,"calculatePersistentChangeTypesFromJson",e,this._determineResetType());var a=this._getPersistentDataChangeType();var o=false;for(t in this._oSettingCurrent){if(a[t]!==i.personalization.ChangeType.Unchanged){o=true}}this._setIsDirty(o)};m.prototype._fireChangeEvent=function(t){var e={};var n=this._callControllers(this._oSettingCurrent,"getUnionData",this._getControlDataInitial(),this._getControlData());e.runtimeDeltaDataChangeType=this._callControllers(this._oSettingCurrent,"getChangeType",n,this._getAlreadyKnownRuntimeData());e.persistentDeltaDataChangeType=this._getPersistentDeltaDataChangeType();e.persistentDataChangeType=this._getPersistentDataChangeType();if(!u.hasChangedType(e.runtimeDeltaDataChangeType)&&!u.hasChangedType(e.persistentDeltaDataChangeType)){return}var i=this._callControllers(this._oSettingCurrent,"getChangeData",n,this._getAlreadyKnownRuntimeData());e.runtimeDeltaData=u.removeEmptyProperty(u.copy(i));var a=this._callControllers(this._oSettingCurrent,"getChangeData",this._getControlDataBase(),this._getControlDataInitial());e.persistentData=u.removeEmptyProperty(a);this._callControllers(this._oSettingCurrent,"setAlreadyKnownRuntimeData2Model",this._getControlData());this._callControllers(this._oSettingCurrent,"setAlreadyKnownPersistentData2Model",this._getControlDataBase());delete e.persistentDeltaDataChangeType;this.fireAfterP13nModelDataChange(e)};m.prototype._onSetVisible=function(t,e){if(t){var n=u.getUnionOfAttribute(this._oSettingCurrent,"ignoreColumnKeys");if(n.indexOf(e)>-1){throw"The provided 'ignoreColumnKeys' are inconsistent. No column specified as ignored is allowed to be visible. "+this}}};m.prototype._onSetSummed=function(t,e){this._oSettingCurrent.columns.controller._onColumnTotal({column:e,isSummed:t})};m.prototype._onSetGrouped=function(t,e){this._oSettingCurrent.group.controller._setGroup(t,e)};m.prototype._getArgumentsByType=function(t,e){var n=[],i=null;if(t&&t.length&&e){t.forEach(function(t){if(t&&t[e]&&typeof t[e]!=="function"){i={};i[e]=t[e];n.push(i)}else{n.push(t)}})}return n};m.prototype._callControllers=function(t,e){var n,i,a;var o={},r=Array.prototype.slice.call(arguments,2);for(var s in t){n=i=a=null;n=t[s];i=n.controller;if(!i||!n.visible||!i[e]){continue}a=this._getArgumentsByType(r,s);if(e==="getPanel"||e==="retrieveAdaptationUI"){a.push(n.payload)}else if(e==="setIgnoreColumnKeys"){a.push(n.ignoreColumnKeys)}else if(e==="setTriggerModelChangeOnColumnInvisible"){a.push(n.triggerModelChangeOnColumnInvisible)}if(e==="setStableColumnKeys"&&s=="columns"){a.push(t.columns.stableColumnKeys)}if(e==="setMessageStrip"&&n.createMessageStrip){var l=n.createMessageStrip();a.push(l)}var h=i[e].apply(i,a);if(h!==null&&h!==undefined&&h[s]!==undefined){o[s]=h[s]}else{o[s]=h}}return o};m.prototype._sanityCheck=function(t){return true};m.prototype._createInternalModel=function(t){var e=new d;e.setDefaultBindingMode(D.TwoWay);e.setSizeLimit(1e4);this.setModel(e,"$sapuicomppersonalizationBaseController");return e};m.prototype._getInternalModel=function(){return this.getModel("$sapuicomppersonalizationBaseController")};m.prototype._getInternalModelData=function(t){return this._getInternalModel().getProperty("/"+t)};m.prototype._getControlDataInitial=function(){return this._getInternalModelData("controlDataInitial")};m.prototype._getControlDataBase=function(){return this._getInternalModelData("controlDataBase")};m.prototype._getIgnoreData=function(){return this._getInternalModelData("ignoreData")};m.prototype._getPersistentDataChangeType=function(){return this._getInternalModelData("persistentDataChangeType")};m.prototype._getPersistentDeltaDataChangeType=function(){return this._getInternalModelData("persistentDeltaDataChangeType")};m.prototype._getControlData=function(){return this._getInternalModelData("controlData")};m.prototype._getControlDataReduce=function(){return this._getInternalModelData("controlDataReduce")};m.prototype._getTransientData=function(){return this._getInternalModelData("transientData")};m.prototype._getAlreadyKnownRuntimeData=function(){return this._getInternalModelData("alreadyKnownRuntimeData")};m.prototype._getAlreadyKnownPersistentData=function(){return this._getInternalModelData("alreadyKnownPersistentData")};m.prototype._getVariantDataInitial=function(){return this._getInternalModelData("variantDataInitial")};m.prototype._getBeforeOpenData=function(){return this._getInternalModelData("beforeOpenData")};m.prototype._setVariantData=function(t){this._getInternalModel().setProperty("/variantData",t?u.copy(t):undefined)};m.prototype._setIsDirty=function(t){this._getInternalModel().setProperty("/isDirty",t)};m.prototype._getVariantData=function(){return this._getInternalModel().getProperty("/variantData")};m.prototype._getControllers=function(){var t={};Object.keys(this._oSettingCurrent).forEach(function(e){var n=this._oSettingCurrent[e];if(n.hasOwnProperty("controller")){t[e]=n}}.bind(this));return t};m.prototype._controllerFactory=function(t){var e=this;switch(t){case n.P13nPanelType.columns:return new a({afterColumnsModelDataChange:function(){var t=this.mEventRegistry.afterColumnsModelDataChange[0].fFunction;this.detachAfterColumnsModelDataChange(t);e._syncTableUi();this.attachAfterColumnsModelDataChange(t);e._fireChangeEvent()},beforePotentialTableChange:function(){e.fireBeforePotentialTableChange()},afterPotentialTableChange:function(){e.fireAfterPotentialTableChange()},afterPotentialModelChange:function(n){e._calculateChangeType(t,n.getParameter("json"))}});case n.P13nPanelType.sort:return new s({afterSortModelDataChange:function(){e._fireChangeEvent()},beforePotentialTableChange:function(){e.fireBeforePotentialTableChange()},afterPotentialTableChange:function(){e.fireAfterPotentialTableChange()},afterPotentialModelChange:function(n){e._calculateChangeType(t,n.getParameter("json"))}});case n.P13nPanelType.filter:return new o({afterFilterModelDataChange:function(){e._fireChangeEvent()},beforePotentialTableChange:function(){e.fireBeforePotentialTableChange()},afterPotentialTableChange:function(){e.fireAfterPotentialTableChange()},afterPotentialModelChange:function(n){e._calculateChangeType(t,n.getParameter("json"))}});case n.P13nPanelType.group:return new r({afterGroupModelDataChange:function(){e._fireChangeEvent()},beforePotentialTableChange:function(){e.fireBeforePotentialTableChange()},afterPotentialTableChange:function(){e.fireAfterPotentialTableChange()},afterPotentialModelChange:function(n){e._calculateChangeType(t,n.getParameter("json"))}});case n.P13nPanelType.dimeasure:return new l({afterDimeasureModelDataChange:function(){e._fireChangeEvent()},beforePotentialTableChange:function(){e.fireBeforePotentialTableChange()},afterPotentialTableChange:function(){e.fireAfterPotentialTableChange()},afterPotentialModelChange:function(n){e._calculateChangeType(t,n.getParameter("json"))}});case n.P13nPanelType.selection:return new h({afterSelectionModelDataChange:function(){e._fireChangeEvent()},beforePotentialTableChange:function(){e.fireBeforePotentialTableChange()},afterPotentialTableChange:function(){e.fireAfterPotentialTableChange()},afterPotentialModelChange:function(n){e._calculateChangeType(t,n.getParameter("json"))}});default:throw"Panel type '"+t+"' is not valid"}};m.prototype.getTable=function(){var t=this.getAssociation("table");if(typeof t==="string"){t=sap.ui.getCore().byId(t)}return t};m.prototype.getColumnMap=function(){return this._oColumnHelper?.getColumnMap()};m._getOrderedColumnKeys=function(t,e){var n=Object.keys(t);return e.reduce(function(t,e){if(n.indexOf(e)>-1){t.push(e)}return t},[])};m.prototype.exit=function(){var t;this._resumeTable(false);if(this._oDialog){this._oDialog.destroy();this._oDialog=null}if(this._oUIManager){this._oUIManager.destroy();this._oUIManager=null}this._oUISetting=null;this._callControllers(this._oSettingCurrent,"destroy");for(t in this._oSettingCurrent){this._oSettingCurrent[t]=null}this._oSettingCurrent=null;this._oColumnHelper=null};m.prototype._determineResetType=function(t){t=t||(this.getResetToInitialTableState()?i.personalization.ResetType.ResetFull:i.personalization.ResetType.ResetPartial);if(t===i.personalization.ResetType.ResetFull||this._getVariantData()===undefined){return i.personalization.ResetType.ResetFull}return i.personalization.ResetType.ResetPartial};m.prototype._isEqualAdditionalIgnoreColumnKeys=function(t){var e=this._callControllers(this._oSettingCurrent,"isEqualAdditionalIgnoreColumnKeys",t);var n=true;for(var i in e){n=n&&e[i]}return n};m.prototype._resetMessageStrip=function(t){for(var e in this._oSettingCurrent){var n=this._oSettingCurrent[e].controller;if(n&&n.getAdaptationUI()&&n.getAdaptationUI().isA("sap.m.p13n.BasePanel")){n.getAdaptationUI().setMessageStrip(undefined)}}};m.prototype._setShowDetails=function(t){this._callControllers(this._oSettingCurrent,"_updateInternalModelShowHide",t)};m.SyncReason={ResetFull:14,ResetPartial:15,NewModelDataMixedWithVariant:7};return m});
/*!
 * SAPUI5
 * (c) Copyright 2009-2023 SAP SE. All rights reserved.
 */
sap.ui.predefine("sap/ui/comp/personalization/DimeasureController", ["./BaseController","sap/m/library","sap/ui/comp/library","./Util","sap/ui/comp/odata/ChartMetadata","sap/m/MessageStrip"],function(e,t,i,a,n,r){"use strict";var o=e.extend("sap.ui.comp.personalization.DimeasureController",{constructor:function(i,a){e.apply(this,arguments);this.setType(t.P13nPanelType.dimeasure);this.setItemType(t.P13nPanelType.dimeasure+"Items");this.CHARTLAYOUT_AXIS1="axis1";this.CHARTLAYOUT_AXIS2="axis2";this.CHARTLAYOUT_AXIS3="axis3";this.CHARTLAYOUT_CATEGORY="category";this.CHARTLAYOUT_CATEGORY2="category2";this.CHARTLAYOUT_SERIES="series"},metadata:{events:{afterDimeasureModelDataChange:{}}}});o.prototype.setTable=function(t){e.prototype.setTable.apply(this,arguments);if(this.getTableType()!==i.personalization.TableType.ChartWrapper){throw"The provided object is incorrect. 'oTable' has to be an instance of sap.ui.comp.personalization.ChartWrapper. "}var a=t.getChartObject();a.detachDrilledDown(this._onDrilledDown,this);a.attachDrilledDown(this._onDrilledDown,this);a.detachDrilledUp(this._onDrilledUp,this);a.attachDrilledUp(this._onDrilledUp,this);this._monkeyPatchTable(a)};o.prototype._monkeyPatchTable=function(e){var t=this;var i=e.setChartType.bind(e);var a=function(e){i(e);t._onSetChartType(e)};if(e.setChartType.toString()===a.toString()){return}e.setChartType=a};o.prototype._onSetChartType=function(e){var t=this.getControlData();if(!e||e===t.dimeasure.chartTypeKey){return}this.fireBeforePotentialTableChange();t.dimeasure.chartTypeKey=e;this.updateControlDataBaseFromJson(t);this.fireAfterPotentialTableChange();this.fireAfterDimeasureModelDataChange()};o.prototype._onDrilledDown=function(e){this.fireBeforePotentialTableChange();this._addVisibleDimensions(e.getParameter("dimensions")||[]);this.fireAfterPotentialTableChange();this.fireAfterDimeasureModelDataChange()};o.prototype._addVisibleDimensions=function(e){if(!e.length){return}var t=this.getControlData();var n=t.dimeasure.dimeasureItems.filter(function(t){return t.visible&&t.aggregationRole===i.personalization.AggregationRole.Dimension&&e.indexOf(t.columnKey)<0}).reduce(function(e,t){return t.columnKey},"");e.forEach(function(e){var i=a.getIndexByKey("columnKey",n,t.dimeasure.dimeasureItems)+1;var r=a.getIndexByKey("columnKey",e,t.dimeasure.dimeasureItems);n=e;if(r<0||i<0||r>t.dimeasure.dimeasureItems.length-1||i>t.dimeasure.dimeasureItems.length-1){return}var o=t.dimeasure.dimeasureItems.splice(r,1);o[0].visible=true;t.dimeasure.dimeasureItems.splice(i,0,o[0]);var s=-1;t.dimeasure.dimeasureItems.forEach(function(e){if(e.index!==undefined){e.index=++s}});this.updateControlDataBaseFromJson(t)},this)};o.prototype._onDrilledUp=function(e){this.fireBeforePotentialTableChange();var t=this.getControlData();var i=e.getParameter("dimensions")||[];i.forEach(function(e){var i=a.getArrayElementByKey("columnKey",e,t.dimeasure.dimeasureItems);if(!i){throw"No entry found in 'controlDataBase' for columnKey '"+e+"'"}i.visible=false;this.updateControlDataBaseFromJson(t)},this);this.fireAfterPotentialTableChange();this.fireAfterDimeasureModelDataChange()};o.prototype.getColumn2Json=function(e,t,i){if(!a.isAggregatable(e)){return null}return{columnKey:t,index:i,visible:e.getVisible(),role:e.getRole(),aggregationRole:e.getAggregationRole()}};o.prototype.getAdditionalData2Json=function(e,t){var i=t.getChartObject();e.dimeasure.chartTypeKey=i.getChartType()};o.prototype.getColumn2JsonTransient=function(e,t,i,n){if(!a.isAggregatable(e)){return null}return{columnKey:t,text:i,tooltip:n!==i?n:undefined,aggregationRole:e.getAggregationRole()}};o.prototype.handleIgnore=function(e,t){e.dimeasure.dimeasureItems[t].visible=false};o.prototype.syncJson2Table=function(e){var t=this.getTable().getChartObject();var n=function(e,t,i,n){var r=a.copy(e);r.sort(o._sortByIndex);var s=[];r.forEach(function(e){if(e.visible===true){s.push(e.columnKey);var t=n(e.columnKey);if(t){t.setRole(e.role)}}});if(JSON.stringify(s)!==JSON.stringify(t)){i(s,true)}};this.fireBeforePotentialTableChange();var r=e.dimeasure.dimeasureItems.filter(function(e){return e.aggregationRole===i.personalization.AggregationRole.Dimension});var s=e.dimeasure.dimeasureItems.filter(function(e){return e.aggregationRole===i.personalization.AggregationRole.Measure});var u=t.getVisibleDimensions();n(r,u,t.setVisibleDimensions.bind(t),t.getDimensionByName.bind(t));var l=t.getVisibleMeasures();n(s,l,t.setVisibleMeasures.bind(t),t.getMeasureByName.bind(t));t.setChartType(e.dimeasure.chartTypeKey);this.fireAfterPotentialTableChange()};o.prototype.getDataSuiteFormat2Json=function(e){var t=this.createControlDataStructure();var r=function(e,i,n){var r=a.getIndexByKey("columnKey",e,t.dimeasure.dimeasureItems);if(r<0){r=t.dimeasure.dimeasureItems.length;t.dimeasure.dimeasureItems.splice(r,0,{columnKey:e})}t.dimeasure.dimeasureItems[r][i]=n};this.getControlDataInitial().dimeasure.dimeasureItems.filter(function(e){return e.visible===true}).forEach(function(e){r(e.columnKey,"visible",false)});if(e.Visualizations&&e.Visualizations.length){var o=e.Visualizations.filter(function(e){return e.Type==="Chart"});if(o.length){var s=0;if(o[0].Content.Dimensions.length){s=o[0].Content.Dimensions.length;o[0].Content.Dimensions.forEach(function(e,t){var s=a.getArrayElementByKey("Dimension",e,o[0].Content.DimensionAttributes);r(e,"visible",true);r(e,"index",t);if(s&&s.Role){r(e,"role",n.getDimensionRole(s.Role))}r(e,"aggregationRole",i.personalization.AggregationRole.Dimension)},this)}if(o[0].Content.Measures.length){o[0].Content.Measures.forEach(function(e,t){var u=a.getArrayElementByKey("Measure",e,o[0].Content.MeasureAttributes);r(e,"visible",true);r(e,"index",s+t);if(u&&u.Role){r(e,"role",n.getMeasureRole(u.Role))}r(e,"aggregationRole",i.personalization.AggregationRole.Measure)},this)}}t.dimeasure.chartTypeKey=n.getChartType(o[0].Content.ChartType)}return t};o.prototype.getDataSuiteFormatSnapshot=function(e){var t=this.getUnionData(this.getControlDataInitial(),this.getControlData());if(!t.dimeasure||!t.dimeasure.dimeasureItems||!t.dimeasure.dimeasureItems.length){return}var a=t.dimeasure.dimeasureItems.filter(function(e){return e.aggregationRole===i.personalization.AggregationRole.Dimension}).filter(function(e){return e.visible===true});var r=t.dimeasure.dimeasureItems.filter(function(e){return e.aggregationRole===i.personalization.AggregationRole.Measure}).filter(function(e){return e.visible===true});if(a.length||r.length){if(!e.Visualizations){e.Visualizations=[]}e.Visualizations.push({Type:"Chart",Content:{ChartType:n.getAnnotationChartType(t.dimeasure.chartTypeKey),Dimensions:a.sort(function(e,t){return e.index-t.index}).map(function(e){return e.columnKey}),DimensionAttributes:a.sort(function(e,t){return e.index-t.index}).map(function(e){return{Dimension:e.columnKey,Role:n.getAnnotationDimensionRole(e.role)}}),Measures:r.sort(function(e,t){return e.index-t.index}).map(function(e){return e.columnKey}),MeasureAttributes:r.sort(function(e,t){return e.index-t.index}).map(function(e){return{Measure:e.columnKey,Role:n.getAnnotationMeasureRole(e.role)}})}})}};o.prototype.getPanel=function(e){if(!a.hasAggregatableColumns(this.getColumnMap())){return null}var t=e&&e.availableChartTypes?e.availableChartTypes:[];return new Promise(function(e){sap.ui.require(["sap/m/P13nDimMeasurePanel","sap/m/P13nItem","sap/m/P13nDimMeasureItem","sap/ui/core/ResizeHandler"],function(i,n,r,o){var s=new i({availableChartTypes:t,chartTypeKey:"{$sapmP13nPanel>/controlDataReduce/dimeasure/chartTypeKey}",items:{path:"$sapmP13nPanel>/transientData/dimeasure/dimeasureItems",template:new n({columnKey:"{$sapmP13nPanel>columnKey}",text:"{$sapmP13nPanel>text}",tooltip:"{$sapmP13nPanel>tooltip}",aggregationRole:"{$sapmP13nPanel>aggregationRole}"})},dimMeasureItems:{path:"$sapmP13nPanel>/controlDataReduce/dimeasure/dimeasureItems",template:new r({columnKey:"{$sapmP13nPanel>columnKey}",index:"{$sapmP13nPanel>index}",visible:"{$sapmP13nPanel>visible}",role:"{$sapmP13nPanel>role}"})},beforeNavigationTo:this.setModelFunction(),changeChartType:function(e){var t=this.getControlDataReduce();t.dimeasure.chartTypeKey=e.getParameter("chartTypeKey");this.setControlDataReduce2Model(t);this.fireAfterPotentialModelChange({json:t})}.bind(this),changeDimMeasureItems:function(e){if(!e.getParameter("items")){return}var t=e.getParameter("items");var i=this.getControlDataReduce();i.dimeasure.dimeasureItems.forEach(function(e){var i=a.getArrayElementByKey("columnKey",e.columnKey,t);if(!i){return}e.index=i.index;e.visible=i.visible;e.role=i.role});this.setControlDataReduce2Model(i);this.fireAfterPotentialModelChange({json:i})}.bind(this)});o.deregister(s._sContainerResizeListener);return e(s)}.bind(this))}.bind(this))};o.prototype.getChartTypeLayoutConfig=function(){if(this._aChartTypeLayout){return this._aChartTypeLayout}var e=[this.CHARTLAYOUT_AXIS1,this.CHARTLAYOUT_CATEGORY,this.CHARTLAYOUT_SERIES];var t=[this.CHARTLAYOUT_AXIS1,this.CHARTLAYOUT_AXIS2,this.CHARTLAYOUT_CATEGORY,this.CHARTLAYOUT_SERIES];var i=[this.CHARTLAYOUT_AXIS1,this.CHARTLAYOUT_CATEGORY,this.CHARTLAYOUT_CATEGORY2];var a=[this.CHARTLAYOUT_AXIS1,this.CHARTLAYOUT_AXIS2,this.CHARTLAYOUT_AXIS3,this.CHARTLAYOUT_CATEGORY,this.CHARTLAYOUT_SERIES];this._aChartTypeLayout=[{key:"column",allowedLayoutOptions:e},{key:"bar",allowedLayoutOptions:e},{key:"line",allowedLayoutOptions:e},{key:"combination",allowedLayoutOptions:e},{key:"pie",allowedLayoutOptions:e},{key:"donut",allowedLayoutOptions:e},{key:"dual_column",allowedLayoutOptions:t},{key:"dual_bar",allowedLayoutOptions:t},{key:"dual_line",allowedLayoutOptions:t},{key:"stacked_bar",allowedLayoutOptions:e},{key:"scatter",allowedLayoutOptions:t},{key:"bubble",allowedLayoutOptions:a},{key:"heatmap",allowedLayoutOptions:i},{key:"bullet",allowedLayoutOptions:e},{key:"vertical_bullet",allowedLayoutOptions:e},{key:"dual_stacked_bar",allowedLayoutOptions:t},{key:"100_stacked_bar",allowedLayoutOptions:e},{key:"stacked_column",allowedLayoutOptions:e},{key:"dual_stacked_column",allowedLayoutOptions:t},{key:"100_stacked_column",allowedLayoutOptions:e},{key:"dual_combination",allowedLayoutOptions:t},{key:"dual_horizontal_combination",allowedLayoutOptions:t},{key:"dual_horizontal_combination",allowedLayoutOptions:t},{key:"dual_stacked_combination",allowedLayoutOptions:t},{key:"dual_horizontal_stacked_combination",allowedLayoutOptions:t},{key:"stacked_combination",allowedLayoutOptions:e},{key:"100_dual_stacked_bar",allowedLayoutOptions:e},{key:"100_dual_stacked_column",allowedLayoutOptions:e},{key:"horizontal_stacked_combination",allowedLayoutOptions:e},{key:"waterfall",allowedLayoutOptions:i},{key:"horizontal_waterfall",allowedLayoutOptions:i}];return this._aChartTypeLayout};o.prototype._getTimeseriesSpecificPanelLayout=function(e){if(e.includes("timeseries")){var t=[this.CHARTLAYOUT_AXIS1,this.CHARTLAYOUT_CATEGORY,this.CHARTLAYOUT_SERIES];this._aChartTypeLayoutTimeseries=[{key:"timeseries_scatter",allowedLayoutOptions:t}];var i=this._aChartTypeLayoutTimeseries.find(function(t){return t.key===e});if(i){return i}else{var a=e.replace("timeseries_","");return this.getChartTypeLayoutConfig().find(function(e){return e.key===a})}}return undefined};o.prototype.retrieveAdaptationUI=function(e){function t(e,t){if(!e.hasOwnProperty("index")||!t.hasOwnProperty("index")){return 0}if(e.index<t.index){return-1}if(e.index>t.index){return 1}return 0}var i;var n=new Promise(function(e,t){i=e});sap.ui.require(["sap/ui/mdc/p13n/panels/ChartItemPanel"],function(e){var n,o=this.getControlDataReduce().dimeasure.chartTypeKey;var s=[{kind:"Dimension"},{kind:"Measure"}];if(o.includes("timeseries")){n=this._getTimeseriesSpecificPanelLayout(o)}if(!n){n=this.getChartTypeLayoutConfig().find(function(e){return e.key===o})}if(!n){var u=[this.CHARTLAYOUT_AXIS1,this.CHARTLAYOUT_AXIS2,this.CHARTLAYOUT_AXIS3,this.CHARTLAYOUT_CATEGORY,this.CHARTLAYOUT_CATEGORY2,this.CHARTLAYOUT_SERIES];n={key:o,allowedLayoutOptions:u}}n.templateConfig=s;var l=new e({panelConfig:n,changeItems:function(e){if(!e.getParameter("items")){return}var t=e.getParameter("items");var i=this.getControlDataReduce();i.dimeasure.dimeasureItems.forEach(function(e){var i=a.getArrayElementByKey("columnKey",e.columnKey,t);if(!i){return}e.index=i.index;e.visible=i.visible;e.role=i.role});this.setControlDataReduce2Model(i);this.fireAfterPotentialModelChange({json:i})}.bind(this)});var d=this.getAdaptationData().sort(t);l.setP13nData(d);this.oPanel=l;if(o==="heatmap"||o==="timeseries_heatmap"){var m=sap.ui.getCore().getLibraryResourceBundle("sap.ui.mdc");l.setMessageStrip(new r({text:m.getText("chart.PERSONALIZATION_DIALOG_MEASURE_WARNING"),type:"Warning"}))}i(l)}.bind(this));return n};o.prototype._transformAdaptationData=function(t,i){var a=e.prototype._transformAdaptationData.apply(this,arguments);a.visible=t.visible;a.role=t.role;a.kind=t.aggregationRole;a.index=t.index;return a};o.prototype._isDimMeasureItemEqual=function(e,t){if(!e&&!t){return true}if(e&&!t){if(e.index===-1&&e.visible===false){return true}return false}if(t&&!e){if(t.index===-1&&t.visible===false){return true}return false}for(var i in e){if(t[i]===undefined||e[i]!==t[i]){return false}}return true};o.prototype._isSemanticEqual=function(e,t){if(e.dimeasure.chartTypeKey!==t.dimeasure.chartTypeKey){return false}var i=function(e,t){if(e.visible===true&&(t.visible===false||t.visible===undefined)){return-1}else if((e.visible===false||e.visible===undefined)&&t.visible===true){return 1}else if(e.visible===true&&t.visible===true){if(e.index<t.index){return-1}else if(e.index>t.index){return 1}else{return 0}}else if((e.visible===false||e.visible===undefined)&&(t.visible===false||t.visible===undefined)){if(e.columnKey<t.columnKey){return-1}else if(e.columnKey>t.columnKey){return 1}else{return 0}}};var n=a.copy(e.dimeasure.dimeasureItems).sort(i);var r=a.copy(t.dimeasure.dimeasureItems).sort(i);var o=true;n.some(function(e,t){if(!this._isDimMeasureItemEqual(e,r[t])){o=false;return true}},this);return o};o.prototype.getChangeType=function(e,t){if(!t||!t.dimeasure||!t.dimeasure.dimeasureItems){return i.personalization.ChangeType.Unchanged}return this._isSemanticEqual(e,t)?i.personalization.ChangeType.Unchanged:i.personalization.ChangeType.ModelChanged};o.prototype.getChangeData=function(e,t){if(!e||!e.dimeasure||!e.dimeasure.dimeasureItems){return this.createControlDataStructure()}if(!t||!t.dimeasure||!t.dimeasure.dimeasureItems){return{chartTypeKey:e.dimeasure.chartTypeKey,dimeasure:a.copy(e.dimeasure)}}if(!this._isSemanticEqual(e,t)){return{chartTypeKey:e.dimeasure.chartTypeKey,dimeasure:a.copy(e.dimeasure)}}return null};o.prototype.getUnionData=function(e,t){if(!t||!t.dimeasure||!t.dimeasure.dimeasureItems){return a.copy(e)}var i=a.copy(t);Object.keys(e.dimeasure).forEach(function(t){if(Array.isArray(e.dimeasure[t])){e.dimeasure[t].forEach(function(e){var n=a.getArrayElementByKey("columnKey",e.columnKey,i.dimeasure[t]);if(!n){i.dimeasure[t].push(e);return}if(n.visible===undefined&&e.visible!==undefined){n.visible=e.visible}if(n.role===undefined&&e.role!==undefined){n.role=e.role}if(n.index===undefined&&e.index!==undefined){n.index=e.index}if(n.aggregationRole===undefined&&e.aggregationRole!==undefined){n.aggregationRole=e.aggregationRole}});return}if(i.dimeasure[t]===undefined&&e.dimeasure[t]!==undefined){i.dimeasure[t]=e.dimeasure[t]}},this);return i};o._sortByIndex=function(e,t){if(e.index!==undefined&&t.index===undefined){return-1}if(t.index!==undefined&&e.index===undefined){return 1}if(e.index<t.index){return-1}if(e.index>t.index){return 1}return 0};o.prototype.isChartConsistent=function(e){var t=this.getTable();if(!t){return Promise.resolve(true)}var i=t.getChartObject();if(!i){return Promise.resolve(true)}return sap.ui.getCore().loadLibrary("sap.chart",{async:true}).then(function(){try{var t=sap.ui.require("sap/chart/library");var a=t.api.getChartTypeLayout(e.dimeasure.chartTypeKey,i.getDimensions(),i.getMeasures());return a.errors.length===0}catch(e){return false}})};o.prototype.exit=function(){e.prototype.exit.apply(this,arguments);var t=this.getTable();if(t){var i=t.getChartObject();if(i){i.detachDrilledDown(this._onDrilledDown,this);i.detachDrilledUp(this._onDrilledUp,this)}}};return o});
/*!
 * SAPUI5
 * (c) Copyright 2009-2023 SAP SE. All rights reserved.
 */
sap.ui.predefine("sap/ui/comp/personalization/FilterController", ["./BaseController","sap/m/library","sap/ui/comp/library","./Util","sap/ui/comp/filterbar/VariantConverterTo","sap/ui/comp/filterbar/VariantConverterFrom","sap/base/util/merge","sap/ui/comp/smartfilterbar/FilterProvider","sap/ui/mdc/p13n/panels/FilterPanel","sap/ui/comp/util/FormatUtil","sap/ui/comp/smartfilterbar/FilterProviderUtils","sap/ui/core/library","sap/ui/comp/odata/MetadataAnalyser","sap/ui/comp/smartfilterbar/SFBMultiInput","sap/ui/comp/providers/TokenParser","sap/ui/comp/p13n/P13nConditionPanel","sap/m/Token","sap/m/MultiInput","sap/ui/comp/valuehelpdialog/ValueHelpDialog"],function(e,t,a,i,r,l,n,o,s,u,p,f,d,h,m,c,g,y,F){"use strict";var _=f.ValueState;var C=a.smartfilterbar.FilterType;var P=e.extend("sap.ui.comp.personalization.FilterController",{constructor:function(a,i){e.apply(this,arguments);this.setType(t.P13nPanelType.filter);this.setItemType(t.P13nPanelType.filter+"Items");this._aDropdownFields=[];this.aFilterItems=[];this._aSFBMultiInputs=[];this._aFilterPanelFields=[];this._aCustomFields=[];this._aCustomColumnKeysWithSlash=[];this.aSFBControlConfig=[];this._aRangeKeyFields=[];this._oResourceBundle=sap.ui.getCore().getLibraryResourceBundle("sap.ui.comp")},metadata:{events:{afterFilterModelDataChange:{}}}});P.prototype.setTable=function(t){e.prototype.setTable.apply(this,arguments)};P.prototype.getColumn2Json=function(e,t,r){if(this.getTableType()!==a.personalization.TableType.AnalyticalTable&&this.getTableType()!==a.personalization.TableType.Table&&this.getTableType()!==a.personalization.TableType.TreeTable){return null}if(!i.isFilterable(e)){return null}if(!e.getFiltered||e.getFiltered&&!e.getFiltered()){return null}return{columnKey:t,exclude:false,operation:e.getFilterOperator(),value1:e.getFilterValue(),value2:""}};P.prototype.getColumn2JsonTransient=function(e,t,r,l){if(!i.isFilterable(e)){return null}var n;if(this.getTableType()===a.personalization.TableType.AnalyticalTable||this.getTableType()===a.personalization.TableType.Table||this.getTableType()===a.personalization.TableType.TreeTable){if(i.getColumnType(e)==="boolean"){n=i._getCustomProperty(e,"values")}return{columnKey:t,text:r,tooltip:l!==r?l:undefined,maxLength:i._getCustomProperty(e,"maxLength"),precision:i._getCustomProperty(e,"precision"),scale:i._getCustomProperty(e,"scale"),type:i.getColumnType(e),typeInstance:i._getCustomProperty(e,"typeInstance"),values:n,nullable:i._getCustomProperty(e,"nullable")}}if(this.getTableType()===a.personalization.TableType.ResponsiveTable){if(i.getColumnType(e)==="boolean"){n=i._getCustomProperty(e,"values")}return{columnKey:t,text:r,tooltip:l!==r?l:undefined,maxLength:i._getCustomProperty(e,"maxLength"),precision:i._getCustomProperty(e,"precision"),scale:i._getCustomProperty(e,"scale"),type:i.getColumnType(e),typeInstance:i._getCustomProperty(e,"typeInstance"),values:n,nullable:i._getCustomProperty(e,"nullable")}}if(this.getTableType()===a.personalization.TableType.ChartWrapper){return{columnKey:t,text:r,tooltip:l!==r?l:undefined,maxLength:i._getCustomProperty(e,"maxLength"),precision:i._getCustomProperty(e,"precision"),scale:i._getCustomProperty(e,"scale"),type:i.getColumnType(e),typeInstance:i._getCustomProperty(e,"typeInstance"),values:n,nullable:i._getCustomProperty(e,"nullable")}}};P.prototype.handleIgnore=function(e,t){e.sort.sortItems.splice(t,1)};P.prototype.syncJson2Table=function(e){var t=this.getColumnMap();var i=n({},t);this.fireBeforePotentialTableChange();if(this.getTableType()===a.personalization.TableType.AnalyticalTable||this.getTableType()===a.personalization.TableType.Table||this.getTableType()===a.personalization.TableType.TreeTable){e.filter.filterItems.forEach(function(e){var a=t[e.columnKey];if(a){if(!a.getFiltered()){a.setFiltered(true)}delete i[e.columnKey]}});for(var r in i){var l=i[r];if(l&&l.getFiltered()){l.setFiltered(false)}}}this.fireAfterPotentialTableChange()};P.prototype.getDataSuiteFormat2Json=function(e){var t=this.createControlDataStructure();if(!e.SelectOptions||!e.SelectOptions.length){return t}t.filter.filterItems=e.SelectOptions.map(function(e){var t=l.convertOption(e.Ranges[0].Option,e.Ranges[0].Low);return{columnKey:e.PropertyName,exclude:e.Ranges[0].Sign==="E",operation:t.op,value1:t.v,value2:e.Ranges[0].High}});return t};P.prototype.getDataSuiteFormatSnapshot=function(e){var t=this.getUnionData(this.getControlDataInitial(),this.getControlData());if(!t.filter||!t.filter.filterItems||!t.filter.filterItems.length){return}var a=this.getColumnMap(),l=i.getColumnKeysOfType("date",a),n=i.getColumnKeysOfType("datetime",a),o=i.getColumnKeysOfType("time",a);t.filter.filterItems.forEach(function(t){var i,s,u=true,p=t.columnKey,f=r.addRangeEntry(e,p);if(this._getSmartTable()){u=this._getSmartTable()._oTableProvider.getIsUTCDateHandlingEnabled()}if(this._getSmartChart()){u=this._getSmartChart()._oChartProvider.getIsUTCDateHandlingEnabled()}if(l.includes(p)){i="date"}else if(n.includes(p)){i="datetime"}else if(o.includes(p)){i="time"}if(l.concat(n,o).includes(p)){s=!!a[p]?.data("p13nData")?.typeInstance?.isA("sap.ui.comp.odata.type.FiscalDate");r.addP13nRanges(f,[t],i,u,s);return}r.addRanges(f,[t])},this)};P.prototype._getFilterPropertyFromColumn=function(e){var t,a,i,r=this._getColumnByKey(e);if(!r){i=this.getColumnMap();r=i&&i[e]}if(r){if(r.getFilterProperty){a=r.getFilterProperty()}t=r.data("p13nData");if(t&&!a){a=t["filterProperty"]}}return a};P.prototype._createFilterFieldControl=function(e){if(e.conditionType){e.control=e.conditionType.initializeFilterItem()}else if(!e.control&&e.fCreateControl){e.fCreateControl(e);delete e.fCreateControl}};P.prototype._getControlDataReduceFilterItems=function(){var e=this.getControlDataReduce();return e&&e.filter&&e.filter.filterItems};P.prototype._updateControlDataReduce=function(e){var t=this.getControlDataReduce();if(!e||!(t&&t.filter&&t.filter.filterItems)){return}e.reverse();t.filter.filterItems=e;this.setControlDataReduce2Model(t);this.fireAfterPotentialModelChange({json:t})};P.prototype._getColumnByKey=function(e){var t,a,i,r,l,n=this.getTable();if(n){t=n.getColumns();i=t.length;for(r=0;r<i;r++){a=t[r];l=a.data("p13nData");if(l&&l.columnKey===e){return a}}}return null};P.prototype._getIsCustomColumn=function(e){var t=this._getColumnByKey(e),a=t&&t.data("p13nData");return!a?false:!a.typeInstance};P.prototype._getFilterQueryPanelParameter=function(){return new URLSearchParams(window.location.search).get("sap-ui-xx-filterQueryPanel")==="true"};P.prototype.getPanel=function(e){if(!i.hasFilterableColumns(this.getColumnMap())){return null}if(e&&e.column){var t=i.getColumnKey(e.column);if(t){var a=this.getTransientData();a.filter.filterItems.forEach(function(e){e["isDefault"]=e.columnKey===t})}}var r=this.getTable(),l=this._getSmartFilterBar();if(l&&l._oFilterProvider){this._aDropdownFields=l._oFilterProvider._aFilterBarDropdownFieldMetadata}else if(r&&r.oParent&&r.oParent._oTableProvider&&r.oParent._oTableProvider._aTableViewMetadata){this._aDropdownFields=r.oParent._oTableProvider._aTableViewMetadata.filter(function(e){return e.hasFixedValues})}return new Promise(function(e){sap.ui.require(["sap/ui/comp/p13n/P13nFilterPanel","sap/m/P13nItem","sap/m/P13nAnyFilterItem","sap/ui/comp/providers/ValueListProvider"],function(t,a,r,l){var n,u=true;if(u){var p,f,d;if(!this.oSmartTable){this.oSmartTable=this._getSmartTable()}if(!this.oSmartChart){this.oSmartChart=this._getSmartChart()}if(!this.oSmartFilterBar){this.oSmartFilterBar=this._getSmartFilterBar();this.aSFBControlConfig=this.oSmartFilterBar&&this.oSmartFilterBar.getControlConfiguration()}if(this.oSmartTable){d=this.oSmartTable}else if(this.oSmartChart){d=this.oSmartChart}if(d){p=d.getModel();f=d.getEntitySet();n=d.getId()}if(!f&&!d&&this.getTable()&&this.getTable().isA("sap.ui.table.AnalyticalTable")){p=this.getTable().getModel();f=this.getTable().getBinding("rows")&&this.getTable().getBinding("rows").getPath().slice(1).split("(")[0]}try{this.oMDCFilterPanel=new s({enableReorder:false,change:this._mdcFilterPanelChangeHandler.bind(this),itemFactory:this._itemFactoryHandler.bind(this)});this._detachFieldsFromMDCFilterPanel();if(!this.oFilterProviderPromise){this.oFilterProviderPromise=o._createFilterProvider({entitySet:f,model:p,defaultDropDownDisplayBehaviour:this.oSmartTable&&this.oSmartTable.data("defaultDropDownDisplayBehaviour"),defaultTokenDisplayBehaviour:this.oSmartTable&&this.oSmartTable.data("defaultTokenDisplayBehaviour"),defaultSingleFieldDisplayBehaviour:this.oSmartTable&&this.oSmartTable.data("defaultSingleFieldDisplayBehaviour"),dateFormatSettings:this.oSmartTable&&this.oSmartTable.data("dateFormatSettings"),useContainsAsDefaultFilter:this.oSmartTable&&this.oSmartTable.data("useContainsAsDefaultFilter"),defaultFilterBarExpanded:this.oSmartTable&&this.oSmartTable.data("defaultFilterBarExpanded"),defaultShowAllFilters:this.oSmartTable&&this.oSmartTable.data("defaultShowAllFilters"),annotationSuppressed:true,useDateRangeType:false,context:"mdcFilterPanel",smartContainerId:n,additionalConfiguration:this.oSmartFilterBar&&this.oSmartFilterBar.getAdditionalConfiguration()})}this.oFilterProviderPromise.then(function(e){this._aActiveFilterPanelFieldNames=[];if(!e._aCustomFieldMetadata){e._aCustomFieldMetadata=[]}this.oFilterProvider=e;this.oMDCFilterPanel.setModel(e.oModel,e.sFilterModelName);if(!this._aSplitIntervalFields){this._aSplitIntervalFields=this._getSplitIntervalFieldNames()}this.oMDCFilterPanel.setP13nData(this._prepareP13nData());this._updateFilterData()}.bind(this))}catch(e){this.oMDCFilterPanel=this._createBasicFilterPanel()}return e(this.oMDCFilterPanel)}else{var h=this.getColumnMap(true),m=new t({containerQuery:true,enableEmptyOperations:true,items:{path:"$sapmP13nPanel>/transientData/filter/filterItems",template:new a({columnKey:"{$sapmP13nPanel>columnKey}",text:"{$sapmP13nPanel>text}",tooltip:"{$sapmP13nPanel>tooltip}",maxLength:"{$sapmP13nPanel>maxLength}",precision:"{$sapmP13nPanel>precision}",scale:"{$sapmP13nPanel>scale}",type:"{$sapmP13nPanel>type}",typeInstance:"{$sapmP13nPanel>typeInstance}",isDefault:"{$sapmP13nPanel>isDefault}",values:"{$sapmP13nPanel>values}",nullable:"{$sapmP13nPanel>nullable}"})},filterItems:{path:"$sapmP13nPanel>/controlDataReduce/filter/filterItems",template:new r({key:"{$sapmP13nPanel>key}",columnKey:"{$sapmP13nPanel>columnKey}",exclude:"{$sapmP13nPanel>exclude}",operation:"{$sapmP13nPanel>operation}",value1:"{$sapmP13nPanel>value1}",value2:"{$sapmP13nPanel>value2}"})},messageStrip:this.getMessageStrip(),beforeNavigationTo:this.setModelFunction(),filterItemChanged:function(e){var t=e.getParameter("reason");var a=e.getParameter("index");var i=e.getParameter("itemData");var r=this.getControlDataReduce();if(i&&t==="added"){if(a>-1){r.filter.filterItems.splice(a,0,i)}else{r.filter.filterItems.push(i)}}if(t==="removed"&&a>-1){r[this.getType()][this.getItemType()].splice(a,1)}this.setControlDataReduce2Model(r);this.fireAfterPotentialModelChange({json:r})}.bind(this)});if(this._aDropdownFields&&this._aDropdownFields.length>0){this._aDropdownFields=this._aDropdownFields.filter(function(e){var t=h[e.name];return!!i._getCustomProperty(t,"fullName")})}m._oConditionPanel.data("dropdownFields",this._aDropdownFields);var c=function(e,t){var a=this.getColumnMap(true),r=a[t],n=i._getCustomProperty(r,"fullName"),o=this._getSmartFilterBar(),s,u=this._getSmartTable(),p,f=o&&o.getControlConfiguration(),d,h,c,g,y,F;if(e.isA("sap.m.ComboBox")||e.isA("sap.m.MultiComboBox")){d="items";h=false;if(o&&o._oFilterProvider){s=o._oFilterProvider;c=s._sTextArrangementDisplayBehaviour||"idOnly"}else if(u&&u._oTableProvider){s=u._oTableProvider;c=s._oDefaultDropDownDisplayBehaviour||"idOnly"}this._aDropdownFields.forEach(function(e){if(e.name===t){p=e["com.sap.vocabularies.Common.v1.Text"];if(p){c=s._oMetadataAnalyser.getTextArrangementValue(p)}else if(e["com.sap.vocabularies.UI.v1.TextArrangement"]){c=s._oMetadataAnalyser.getTextArrangementValue(e)}}});if(Array.isArray(f)&&f.length>0){for(F=0;F<f.length;F++){g=f[F];if(g.getKey()===t){c=g.getDisplayBehaviour();break}}}}else{d="suggestionRows";h=true}if(o&&o._oFilterProvider&&o._oFilterProvider._aFilterBarMultiValueFieldMetadata){y=o._oFilterProvider._aFilterBarMultiValueFieldMetadata.filter(function(e){return e.name===t})[0];if(y){m._oConditionPanel.setDisplayFormat(y.displayFormat)}}if(n){e.setShowSuggestion&&e.setShowSuggestion(true);e.setFilterSuggests&&e.setFilterSuggests(false);e.setModel(this.getTable().getModel());return new l({fieldName:t,control:e,model:this.getTable().getModel(),maxLength:i._getCustomProperty(r,"maxLength"),displayBehaviour:c,resolveInOutParams:false,loadAnnotation:true,fullyQualifiedFieldName:n,aggregation:d,typeAheadEnabled:h,enableShowTableSuggestionValueHelp:false})}}.bind(this);m._oConditionPanel._fSuggestCallback=c;m._enableEnhancedExcludeOperations();m.addStyleClass("sapUiSmallMarginTop");return e(m)}}.bind(this))}.bind(this))};P.prototype._removeFilter=function(e){var t=this._getControlDataReduceFilterItems().filter(function(t){return t.columnKey!==e});this._updateControlDataReduce(t);this._getControlByName(e).setTokens([])};P.prototype._createBasicFilterPanel=function(){var e=new s({enableReorder:false,change:this._mdcFilterPanelChangeHandler.bind(this),itemFactory:this._createBasicFilterField.bind(this)});this.oMDCFilterPanel=e;e.setP13nData(this._prepareP13nData());this._detachFieldsFromMDCFilterPanel();this._updateBasicFilters();return e};P.prototype._updateBasicFilters=function(e){var t,a,i=e||this._getControlDataReduceFilterItems();this._aCustomFields.forEach(function(e){e.setTokens([])});if(Array.isArray(i)){i.reverse().forEach(function(e){t=this._getControlByName(e.columnKey);if(t){a=new g({text:this._getFormattedRangeTokenText(e.operation,e.value1,e.value2,e.exclude,e.columnKey)}).data("range",{exclude:e.exclude,operation:e.operation,keyField:e.columnKey,value1:e.value1,value2:e.value2});t.addToken(a)}}.bind(this))}};P.prototype._getFormattedRangeTokenText=function(e,t,a,i,r){var l=this._getKeyFieldByKey(r),n=t,o=a,s=true;if(l){if(!l.typeInstance&&c._createKeyFieldTypeInstance){c._createKeyFieldTypeInstance(l)}if(l.typeInstance){n=l.typeInstance.formatValue(t,"string",s);o=l.typeInstance.formatValue(a,"string",s)}}return u.getFormattedRangeText(e,n,o,i)};P.prototype._getKeyFieldByKey=function(e){var t;if(this._aRangeKeyFields){this._aRangeKeyFields.some(function(a){if(typeof a!=="string"){if(a.key===e){t=a;return true}}return false})}return t};P.prototype._createBasicFilterField=function(e){var t,a=this._getSmartTable(),i=a&&a.getId(),r,l=e.name,n=this._getControlByName(l);if(!n){r="FilterPanel-"+i+"-"+l;n=new y(r,{editable:true,enabled:true,showValueHelp:true,valueHelpOnly:true});n.attachTokenUpdate(function(e){var t,a,i=this._getControlDataReduceFilterItems(),r=e.getParameter("removedTokens"),l=r.length;if(e.getParameter("type")==="removed"){i=i.filter(function(e){for(t=0;t<l;t++){a=r[t].data("range");if(a&&a.keyField===e.columnKey&&a.value1===e.value1&&a.value2===e.value2){l-=1;return false}}return true});this._updateControlDataReduce(i)}}.bind(this));t=new m;t.addKeyField({key:l,label:e.label});t.associateInput(n);t.setDefaultOperation("EQ");n._sControlName=l;n.attachValueHelpRequest(this._vhRequest.bind(this,e,n));this._aCustomFields.push(n)}return n};P.prototype._getSplitIntervalFieldNames=function(){var e,t,a=[],i=this.oFilterProvider;if(i&&i.aAllFields){for(e=0;e<i.aAllFields.length;e++){t=i.aAllFields[e];if(t.filterRestriction===C.Interval&&t.type!=="Edm.DateTime"){a.push(t.name)}}}return a};P.prototype._vhRequest=function(e,t){var a,r=this._getColumnByKey(e.name),l=t&&t.getId()+"-valueHelpDialog",n=new F(l,{key:e.name,supportRangesOnly:true,supportRanges:true,title:e.label,cancel:function(){n.close()}});n.attachOk(this._onOk.bind(this,t,n));n.attachAfterClose(function(){this.destroy()});n.setProperty("_enhancedExcludeOperations",true);a={label:e.label,key:e.name,type:i._getCustomProperty(r,"type")||"string",maxLength:i._getCustomProperty(r,"maxLength"),scale:i._getCustomProperty(r,"scale"),precision:i._getCustomProperty(r,"precision"),nullable:i._getCustomProperty(r,"nullable")};c._createKeyFieldTypeInstance(a);this._aRangeKeyFields.push(a);n.setRangeKeyFields([a]);n.setTokens(t.getTokens());n.open()};P.prototype._onOk=function(e,t,a){var i=a.getParameter("tokens"),r=[];if(!i){t.close();return}e.setTokens(i);var l=this._getControlDataReduceFilterItems();i.forEach(function(e){r.push(e.data("range"))});l=l.filter(function(t){return t.columnKey!==e._sControlName});l.push(this._createConditionForRanges(r));l=l.flat();this._updateControlDataReduce(l);t.close()};P.prototype._getFieldMetadata=function(e,t){var a=null;if(Array.isArray(e)){e.some(function(e){if(e&&e.fields){e.fields.some(function(e){if(e&&e.name===t){a=e}return a!==null})}return a!==null})}return a};P.prototype._itemFactoryHandler=function(e){var t,a,r,l,n,o=e.name,s=this.oFilterProvider,u=this._getControlByName(o),p=this._getFilterPropertyFromColumn(o),f=this._getColumnByKey(o),d;if(u&&u.isA("sap.m.DatePicker")&&u.getValue()&&!this._checkIfFilterHasValue(o)){u.setValue("")}if(p&&p.includes("/")){d=s._oMetadataAnalyser.extractNavigationPropertyField(p,s.sEntitySet);d=s._createFieldMetadata(d)}else{d=s._getFieldMetadata(p)}if(d&&p&&o!==p){d=Object.assign({},d)}this._aActiveFilterPanelFieldNames.push(o);if(!u){if(!d){if(!this._aViewMetadata){this._aViewMetadata=s._oMetadataAnalyser._getAllFilterableFieldsByEntityForAllEndpoints(s.sEntitySet,true,false,null)}d=this._getFieldMetadata(this._aViewMetadata,o);if(d){d=s._createFieldMetadata(d)}}try{d=this._updateFieldMetadata(d,e,p)}catch(e){}if(this.aSFBControlConfig&&d){for(t=0;t<this.aSFBControlConfig.length;t++){a=this.aSFBControlConfig[t];if(a.getKey()===d.fieldName){r=a.getDisplayBehaviour();if(r&&!a.isPropertyInitial("displayBehaviour")){n=Object.assign({},d);n.displayBehaviour=r}l=a.getControlType();if(l){if(!n){n=Object.assign({},d)}n.controlType=l}break}}}if(n){n.fCreateControl(n);u=n.control}else if(d){d.fCreateControl(d);u=d.control}if(!u){u=new h({editable:true,enabled:true,showValueHelp:true,valueHelpOnly:true});d={fieldName:o,type:i._getCustomProperty(f,"edmType")||i._getCustomProperty(f,"type"),filterType:i._getCustomProperty(f,"type"),maxLength:i._getCustomProperty(f,"maxLength"),scale:i._getCustomProperty(f,"scale"),precision:i._getCustomProperty(f,"precision"),nullable:i._getCustomProperty(f,"nullable"),isDigitSequence:i._getCustomProperty(f,"isDigitSequence"),label:e.label};s._associateValueHelpDialog(u,d,true,true);s._aCustomFieldMetadata.push(d);u.bindProperty("value",{path:s.sFilterModelName+">/"+d.fieldName+"/value",type:s._getType(d)});s._handleMultiInput(u,d,s._getType(d))}u.setModel(this.getTable().getModel());u._sControlName=e.name;this._aFilterPanelFields.push(u);if(u.isA("sap.m.Select")||u.isA("sap.m.TimePicker")){u.setWidth("100%")}if(u.isA("sap.m.MultiInput")){u.attachTokenUpdate(this._fieldChangeHandler.bind(this))}else{u.attachChange(this._fieldChangeHandler.bind(this))}}if(u.getValueState&&u.getValueState()===_.Error){u.setValueState(_.None)}return u};P.prototype._fieldChangeHandler=function(e){var t,a,i,r=[],l,n=this.oFilterProvider,o,s=e.getSource(),u=s._sControlName,p={exclude:false,columnKey:u,operation:"EQ",value1:null,value2:null};setTimeout(function(){Promise.all(n._getCurrentValidationPromises()).then(function(){o=n.getFilterData();for(t in o){if(o.hasOwnProperty(t)){a=o[t];if(a){i=n._getFieldMetadata(t);if(i&&i.fieldNameOData&&t!==i.fieldNameOData){t=i.fieldNameOData}p.columnKey=t;if(p.columnKey&&p.columnKey.includes("___")){p.columnKey=p.columnKey.replaceAll("___","/")}l=Object.assign({},p);if(Array.isArray(a.ranges)&&a.ranges.length>0){r.push(this._createConditionForRanges(a.ranges))}if(Array.isArray(a.items)&&a.items.length>0){r.push(this._createConditionForItems(a.items,p))}if(a.hasOwnProperty("low")&&a.low){r.push(this._createConditionForIntervals(a,t,p))}if(a.value){if(s&&s.getValueState()!==_.Error){l=Object.assign({},p);l.value1=a.value;r.push(l)}}if(typeof a!=="object"||a instanceof Date){l=Object.assign({},p);l.value1=a;r.push(l)}}}}r=r.flat();this._updateControlDataReduce(r);if(s._oFieldViewMetadata&&this.oFilterProvider._oMetadataAnalyser.getMultiUnitBehaviorEnabled()){if(s._oFieldViewMetadata.isMeasureField){this._setWarningState(s)}if(d.isUnitOfMeasure(s._oFieldViewMetadata)||d.isCurrencyCode(s._oFieldViewMetadata)){this._clearWarningState(s)}}}.bind(this))}.bind(this))};P.prototype._setWarningState=function(e){var t=e._oFieldViewMetadata,a=this.oFilterProvider&&this.oFilterProvider._getFieldMetadata(t.unit),i=a&&a.label,r=this._oResourceBundle.getText("UNIT_WARNING_TEXT",i),l=this._checkIfFilterHasValue(t.name),n=this._checkIfFilterHasValue(a.name);if(t.filterRestriction==="single"){return}if(!n&&l){setTimeout(function(){e.setValueState(_.Warning);e.setValueStateText(r)})}if(!l){e.setValueState(_.None)}};P.prototype._clearWarningState=function(e){var t=e._oFieldViewMetadata,a=t&&t.name,i=t&&t.label,r=this._oResourceBundle.getText("UNIT_WARNING_TEXT",i),l,n=this._checkIfFilterHasValue(t.name),o;if(t.filterRestriction==="single"){return}this.oFilterProvider.aAllFields.forEach(function(e){if(e.isCurrencyField&&e["Org.OData.Measures.V1.ISOCurrency"].Path===a||e.isMeasureField&&e["Org.OData.Measures.V1.Unit"]&&e["Org.OData.Measures.V1.Unit"].Path===a){l=this._getControlByName(e.name);if(l){o=this._checkIfFilterHasValue(e.name);if(n&&l.getValueState()===_.Warning){l.setValueState(_.None)}if(!n&&o&&l.getValueState()===_.None){l.setValueState(_.Warning);l.setValueStateText(r)}}}}.bind(this))};P.prototype._checkIfFilterHasValue=function(e,t){var a=t||this.oFilterProvider.getFilterData(),i=a[e]||a._CUSTOM&&a._CUSTOM[e];if(i===null||typeof i==="undefined"){return false}if(typeof i==="string"&&i){return true}if(typeof i==="number"){return true}if(typeof i==="object"&&Object.prototype.toString.call(i)==="[object Date]"){return true}if(typeof i==="object"&&(i.hasOwnProperty("low")||i.hasOwnProperty("high"))){return!!i.low||!!i.high}if(typeof i==="object"&&(i.hasOwnProperty("value")||i.hasOwnProperty("items")||i.hasOwnProperty("ranges"))){return!!i.value||i.items&&!!i.items.length||i.ranges&&!!i.ranges.length}return false};P.prototype._updateFieldMetadata=function(e,t,a){var i,r,l=t.name,n=this.oFilterProvider,o=false,s=this._getIsCustomColumn(l),u=this._getColumnByKey(l);if(e){if(t&&!s&&e.fieldName&&e.fieldName.includes("/")){o=true}if(s){i=u&&(u.getHeader&&u.getHeader()||u.getLabel&&u.getLabel());if(i&&i.getText()){e.label=i.getText()}}}if(a&&a.includes("/")){e=n._oMetadataAnalyser.extractNavigationPropertyField(a,n.sEntitySet);e=n._createFieldMetadata(e)}if(!e){l=this._getFilterPropertyFromColumn(l);r=n.aAllFields&&n.aAllFields.find(function(e){return e.name===l});r=n._createFieldMetadata(r);e=Object.assign({},r)}if(s||o){e=this._prepareFieldMetadataForCustomColumn(e,t)}return e};P.prototype._prepareFieldMetadataForCustomColumn=function(e,t){var a=t.name,r,l,n,o,s,u=t.name,p=this._getColumnByKey(u),f=this.oFilterProvider;if(u.includes("/")){this._aCustomColumnKeysWithSlash.push(u);u=u.replaceAll("/","___")}e.customColumnKey=a;e.fieldName=u;e.name=u;o=!!e.ui5Type&&e.ui5Type.oConstraints;e.label=p&&(p.getHeader?p.getHeader().getText():p.getLabel().getText());n=i._getCustomProperty(p,"maxLength");l=i._getCustomProperty(p,"scale");r=i._getCustomProperty(p,"precision");if(o&&(n||l||r)){s=e.ui5Type;e=Object.assign({},e,{ui5Type:Object.assign({},e.ui5Type,{oConstraints:Object.assign({},e.ui5Type.oConstraints)})});for(var d in s){if(!s.hasOwnProperty(d)){e.ui5Type[d]=s[d]}}}if(n){e.maxLength=n;if(o){e.ui5Type.oConstraints.maxLength=n}}if(l){e.scale=l;if(o){e.ui5Type.oConstraints.scale=l}}if(r){e.precision=r;if(o){e.ui5Type.oConstraints.precision=r}}f._aCustomFieldMetadata.push(e);this._updateFilterData();return e};P.prototype._prepareP13nData=function(){var e=[],t,a=this._getControlDataReduceFilterItems();this.getTransientData().filter.filterItems.forEach(function(i){t=a&&a.some(function(e){return e.columnKey===i.columnKey});if(i.isDefault){t=true}e.push({name:i.columnKey,label:i.text,active:t})});return e};P.prototype._mdcFilterPanelChangeHandler=function(e){if(e.getParameter("reason")===this.oMDCFilterPanel.CHANGE_REASON_REMOVE){this._handleFieldRemove(e)}};P.prototype._handleFieldRemove=function(e){try{var t=this.oFilterProvider,a=e.getParameter("item").name,i,r=t._getFieldMetadata(a),l=this._getControlByName(a),n=t.getFilterData(),o=this._getControlDataReduceFilterItems();if(o&&o.length>0){o=o.filter(function(e){return e.columnKey!==a})}this._updateControlDataReduce(o);if(!r){i=this._getFilterPropertyFromColumn(a);r=t.aAllFields.find(function(e){return e.name===i});r=t._createFieldMetadata(r);r.name=a;r.fieldName=a;r.control=l}t._createInitialModelForField(n,r);if(l&&l.getValue&&l.getValue()){l.setValue(null)}}catch(t){this._removeFilter(e.getParameter("item").name)}};P.prototype._detachFieldsFromMDCFilterPanel=function(){var e,t=this.oMDCFilterPanel.exit;this.oMDCFilterPanel.exit=function(){t.apply(this,arguments);this._aFilterPanelFields.forEach(function(t){if(t){e=t.getParent();if(e){e.removeContent(t)}}});this._aCustomFields.forEach(function(t){if(t){e=t.getParent();if(e){e.removeContent(t)}}});if(this._aActiveFilterPanelFieldNames){this._aActiveFilterPanelFieldNames=null}}.bind(this)};P.prototype._createConditionForRanges=function(e){var t,a,i=[],r;for(t=0;t<e.length;t++){a=Object.assign({},e[t]);if(!a.columnKey){a.columnKey=a.keyField}try{r=this.oFilterProvider._getFieldMetadata(a.columnKey);if(r&&r.fieldNameOData){a.columnKey=r.fieldNameOData}if(a.columnKey&&a.columnKey.includes("___")){a.columnKey=a.columnKey.replaceAll("___","/")}}catch(e){}delete a.keyField;delete a.tokenText;i.push(a)}return i};P.prototype._createConditionForItems=function(e,t){var a,i,r=[],l;for(a=0;a<e.length;a++){i=e[a];l=Object.assign({},t);l.value1=i.key;l.token=i.text;r.push(l)}return r};P.prototype._createConditionForIntervals=function(e,t,a){var i,r=this.oFilterProvider,l=[],n;i=Object.assign({},a);i.operation="BT";if(e.low&&e.high){i.value1=e.low;i.value2=e.high}else if(e.low){if(r._aFilterBarDateTimeFieldNames.indexOf(t)>-1){n=r._getFieldMetadata(t);l=[e.low];if(typeof e.low==="string"){l=u.parseDateTimeOffsetInterval(e.low);l[0]=n.ui5Type.parseValue(l[0],"string")}if(l.length===2){l[1]=n.ui5Type.parseValue(l[1],"string")}if(l.length===1){i.operation="EQ"}}else{l=u.parseFilterNumericIntervalData(e.low)}if(l){i.value1=l[0];i.value2=l[1]}}return i};P.prototype._updateFilterData=function(e){var t,a,i,r,l,n,o=this.oFilterProvider,s=e?e:this._getControlDataReduceFilterItems();o.clear();n=Object.assign({},o.getFilterData());if(s&&s.length>0){for(t=0;t<s.length;t++){l=Object.assign({},s[t]);r=l.keyField?l.keyField:l.columnKey;if(this._aCustomColumnKeysWithSlash.includes(r)){r=r.replaceAll("/","___")}i=n[r];if(!l.keyField){l.keyField=l.columnKey;delete l.columnKey}if(l.token){a={key:l.value1,text:l.token};if(!i.items){i.items=[]}i.items.push(a)}else if(l.conditionTypeInfo){if(!l.conditionTypeInfo.data.operation){l.conditionTypeInfo.data.operation=l.conditionTypeInfo.data.operator}i.conditionTypeInfo=l.conditionTypeInfo;i.ranges.push(l)}else if(i&&i.hasOwnProperty("low")){if(o._aFilterBarDateTimeFieldNames&&o._aFilterBarDateTimeFieldNames.indexOf(r)>-1){if(l.value1 instanceof Date){l.value1=l.value1.toISOString()}if(l.value2 instanceof Date){l.value2=l.value2.toISOString()}}if(this._aSplitIntervalFields&&this._aSplitIntervalFields.indexOf(l.keyField)>-1){a={low:l.value1+"-"+l.value2,high:null}}else{a={low:l.value1,high:l.value2}}n[r]=a}else if(i===null||typeof i!=="object"){n[r]=l.value1}else{if(!(i&&i.ranges)){i.ranges=[]}n[r].ranges.push(l)}}o.setFilterData(n)}};P.prototype._getControlByName=function(e){var t,a,i,r=this._aFilterPanelFields.length?this._aFilterPanelFields:this._aCustomFields;for(t=0;t<r.length;t++){i=r[t];if(i._sControlName===e){a=i;break}}return a};P.prototype.getChangeType=function(e,t){if(!t||!t.filter||!t.filter.filterItems){return a.personalization.ChangeType.Unchanged}if(t&&t.filter&&t.filter.filterItems){t.filter.filterItems.forEach(function(e){delete e.key;delete e.source})}if(e&&e.filter&&e.filter.filterItems){e.filter.filterItems.forEach(function(e){delete e.key;delete e.source})}var i=JSON.stringify(e.filter.filterItems)!==JSON.stringify(t.filter.filterItems);return i?a.personalization.ChangeType.ModelChanged:a.personalization.ChangeType.Unchanged};P.prototype.getChangeData=function(e,t){if(!e||!e.filter||!e.filter.filterItems){return this.createControlDataStructure()}if(t&&t.filter&&t.filter.filterItems){t.filter.filterItems.forEach(function(e){delete e.key;delete e.source})}if(e&&e.filter&&e.filter.filterItems){e.filter.filterItems.forEach(function(e){delete e.key;delete e.source})}if(!t||!t.filter||!t.filter.filterItems){return{filter:i.copy(e.filter)}}if(JSON.stringify(e.filter.filterItems)!==JSON.stringify(t.filter.filterItems)){return{filter:i.copy(e.filter)}}return null};P.prototype.getUnionData=function(e,t){if(!t||!t.filter||!t.filter.filterItems){return{filter:i.copy(e.filter)}}return{filter:i.copy(t.filter)}};P.prototype._getSmartFilterBar=function(){var e,t=this.getTable();if(t){e=t.oParent&&t.oParent._oSmartFilter}if(!e&&t&&this.getTableType()===a.personalization.TableType.ChartWrapper){e=t.getChartObject()&&t.getChartObject().oParent&&t.getChartObject().oParent._oSmartFilter}return e?e:null};P.prototype._getSmartTable=function(){var e=this.getTable()&&this.getTable().getParent();return e&&e.isA("sap.ui.comp.smarttable.SmartTable")?e:null};P.prototype._getSmartChart=function(){var e=this.getTable();if(e&&this.getTableType()===a.personalization.TableType.ChartWrapper){return e&&e.getChartObject()&&e.getChartObject().getParent()}return null};P.prototype.exit=function(){e.prototype.exit.apply(this,arguments);this._aDropdownFields=null;this.aFilterItems=null;this._aSFBMultiInputs=null;this.oSmartChart=null;this.oSmartTable=null;this.oSmartFilterBar=null;this.aSFBControlConfig=null;this._aSplitIntervalFields=null;if(this.oFilterProviderPromise){this.oFilterProviderPromise=null}if(this.oFilterProvider&&this.oFilterProvider.destroy){this.oFilterProvider.destroy();this.oFilterProvider=null}if(this._aFilterPanelFields&&this._aFilterPanelFields.length>0){this._aFilterPanelFields.forEach(function(e){e.destroy()})}if(this._aCustomFields&&this._aCustomFields.length>0){this._aCustomFields.forEach(function(e){e.destroy()})}this._aFilterPanelFields=null;this._aCustomFields=null;this._aActiveFilterPanelFieldNames=null;this._aViewMetadata=null;this._aCustomColumnKeysWithSlash=null};return P});
/*!
 * SAPUI5
 * (c) Copyright 2009-2023 SAP SE. All rights reserved.
 */
sap.ui.predefine("sap/ui/comp/personalization/GroupController", ["./BaseController","sap/m/library","sap/ui/comp/library","./Util","sap/m/P13nConditionPanel"],function(e,t,o,r,n){"use strict";var a=t.P13nConditionOperation;var p=e.extend("sap.ui.comp.personalization.GroupController",{constructor:function(o,r){e.apply(this,arguments);this.setType(t.P13nPanelType.group);this.setItemType(t.P13nPanelType.group+"Items")},metadata:{events:{afterGroupModelDataChange:{}}}});p.prototype.setTable=function(t){e.prototype.setTable.apply(this,arguments);if(this.getTableType()===o.personalization.TableType.ResponsiveTable){t.detachEvent("_group",this._onGroup,this);t.attachEvent("_group",this._onGroup,this)}else if(t&&t.detachGroup&&t.attachGroup){t.detachGroup(this._onGroup,this);t.attachGroup(this._onGroup,this)}};p.prototype.getColumn2Json=function(e,t,r){if(this.getTableType()!==o.personalization.TableType.AnalyticalTable){return null}if(!e.getGrouped()){return null}return{columnKey:t,isGrouped:e.getGrouped(),operation:e.getSortOrder&&e.getSortOrder()!=="Descending"?a.GroupAscending:a.GroupDescending,showIfGrouped:e.getShowIfGrouped?e.getShowIfGrouped():false}};p.prototype.getAdditionalData2Json=function(e,t){if(this.getTableType()!==o.personalization.TableType.AnalyticalTable){return}if(!e.group.groupItems.length){return}t.getGroupedColumns().forEach(function(t,o){if(typeof t==="string"){t=sap.ui.getCore().byId(t)}var n=r.getIndexByKey("columnKey",r.getColumnKey(t),e.group.groupItems);if(n>-1&&o===n){return}var a=e.group.groupItems.splice(n,1);e.group.groupItems.splice(o,0,a)})};p.prototype.getColumn2JsonTransient=function(e,t,o,n){if(!r.isGroupable(e)){return null}return{columnKey:t,text:o,tooltip:n!==o?n:undefined}};p.prototype.handleIgnore=function(e,t){e.sort.sortItems.splice(t,1)};p.prototype.syncJson2Table=function(e){var t=this.getColumnMap();var r=this.getTable();var n;this.fireBeforePotentialTableChange();if(this.getTableType()===o.personalization.TableType.TreeTable){return}else if(this.getTableType()===o.personalization.TableType.AnalyticalTable){var a=true;for(var p in t){n=t[p];if(!n){return}if(n.getGrouped()){n.setGrouped(false,a);n.setShowIfGrouped(false)}}e.group.groupItems.forEach(function(e){n=t[e.columnKey];if(!n){return}n.setGrouped(true,a);n.setShowIfGrouped(e.showIfGrouped)})}else if(this.getTableType()===o.personalization.TableType.Table||this.getTableType()===o.personalization.TableType.AnalyticalTable||this.getTableType()===o.personalization.TableType.TreeTable){if(!r.getGroupBy){return}if(e.group.groupItems.length>0){e.group.groupItems.some(function(e){n=t[e.columnKey];if(n){r.setGroupBy&&r.setGroupBy(n);return true}})}else{r.setGroupBy&&r.setGroupBy(null)}}this.fireAfterPotentialTableChange()};p.prototype.getDataSuiteFormat2Json=function(e){var t=this.createControlDataStructure();if(!e.GroupBy||!e.GroupBy.length){return t}t.group.groupItems=e.GroupBy.map(function(e){return{columnKey:e,operation:a.GroupAscending,showIfGrouped:false}});return t};p.prototype.getDataSuiteFormatSnapshot=function(e){var t=this.getUnionData(this.getControlDataInitial(),this.getControlData());if(!t.group||!t.group.groupItems||!t.group.groupItems.length){return}e.GroupBy=t.group.groupItems.map(function(e){return e.columnKey})};p.prototype._onGroup=function(e){this.fireBeforePotentialTableChange();this._updateInternalModel(e.getParameter("groupedColumns"));this.fireAfterPotentialTableChange();this.fireAfterGroupModelDataChange()};p.prototype._setGroup=function(e,t){this.fireBeforePotentialTableChange();if(e){this._updateInternalModel([t])}else{this._updateInternalModel([])}this.fireAfterPotentialTableChange();this.fireAfterGroupModelDataChange()};p.prototype._updateInternalModel=function(e){this.getInternalModel().setProperty("/controlData/group/groupItems",[]);var t=this.getControlData();e.forEach(function(e){if(typeof e==="string"){e=sap.ui.getCore().byId(e)}var o=r.getColumnKey(e);var n=r.getIndexByKey("columnKey",o,t.group.groupItems);n=n>-1?n:t.group.groupItems.length;this.getInternalModel().setProperty("/controlData/group/groupItems/"+n+"/",{columnKey:o,showIfGrouped:e.getShowIfGrouped?e.getShowIfGrouped():false})},this);this.updateControlDataBaseFromJson(t)};p.prototype.getPanel=function(){if(!r.hasGroupableColumns(this.getColumnMap())){return null}return new Promise(function(e){sap.ui.require(["sap/m/P13nGroupPanel","sap/m/P13nItem","sap/m/P13nGroupItem"],function(t,r,n){return e(new t({maxGroups:this.getTableType()===o.personalization.TableType.AnalyticalTable?"-1":"1",containerQuery:true,items:{path:"$sapmP13nPanel>/transientData/group/groupItems",template:new r({columnKey:"{$sapmP13nPanel>columnKey}",text:"{$sapmP13nPanel>text}",tooltip:"{$sapmP13nPanel>tooltip}"})},groupItems:{path:"$sapmP13nPanel>/controlDataReduce/group/groupItems",template:new n({columnKey:"{$sapmP13nPanel>columnKey}",operation:"{$sapmP13nPanel>operation}",showIfGrouped:"{$sapmP13nPanel>showIfGrouped}"})},beforeNavigationTo:this.setModelFunction(),updateGroupItem:function(){this.fireAfterPotentialModelChange({json:this.getControlDataReduce()})}.bind(this),addGroupItem:function(e){if(!e.getParameter("groupItemData")){return}var t=e.getParameter("index");var o=e.getParameter("groupItemData");var r={columnKey:o.getColumnKey(),operation:o.getOperation(),showIfGrouped:o.getShowIfGrouped()};var n=this.getControlDataReduce();if(t>-1){n.group.groupItems.splice(t,0,r)}else{n.group.groupItems.push(r)}this.setControlDataReduce2Model(n);this.fireAfterPotentialModelChange({json:n})}.bind(this),removeGroupItem:function(e){var t=e.getParameter("index");if(t<0){return}var o=this.getControlDataReduce();o.group.groupItems.splice(t,1);this.setControlDataReduce2Model(o);this.fireAfterPotentialModelChange({json:o})}.bind(this)}))}.bind(this))}.bind(this))};p.prototype.retrieveAdaptationUI=function(e){if(!r.hasGroupableColumns(this.getColumnMap())){return null}return new Promise(function(e){sap.ui.require(["sap/m/p13n/GroupPanel"],function(t){var r=this.getAdaptationData();var n=this.getTableType()===o.personalization.TableType.AnalyticalTable;var a=new t({queryLimit:n?undefined:1,enableShowField:n});this.oPanel=a;a.setP13nData(r);a.attachChange(function(e){var t=t=e.getParameter("item");var o=a.getP13nData(true);var r=this.getControlDataReduce();r.group.groupItems=o.map(function(e){return{isGrouped:true,columnKey:e.name,operation:e.descending?"GroupDescending":"GroupAscending",showIfGrouped:t.name===e.name?t.showIfGrouped:true}});this.setControlDataReduce2Model(r);this.fireAfterPotentialModelChange({json:r})}.bind(this));e(a)}.bind(this))}.bind(this))};p.prototype._transformAdaptationData=function(t,o){var r=e.prototype._transformAdaptationData.apply(this,arguments);r.grouped=!!t;r.showIfGrouped=t?t.showIfGrouped:true;return r};p.prototype._sortAdaptationData=function(e){this._getP13nBuilder().sortP13nData({visible:"grouped",position:"position"},e)};p.prototype._getPresenceAttribute=function(){return"grouped"};p.prototype.getChangeType=function(e,t){if(!t||!t.group||!t.group.groupItems){return o.personalization.ChangeType.Unchanged}var r=JSON.stringify(e.group.groupItems)!==JSON.stringify(t.group.groupItems);return r?o.personalization.ChangeType.ModelChanged:o.personalization.ChangeType.Unchanged};p.prototype.getChangeData=function(e,t){if(!e||!e.group||!e.group.groupItems){return this.createControlDataStructure()}if(!t||!t.group||!t.group.groupItems){return{group:r.copy(e.group)}}if(JSON.stringify(e.group.groupItems)!==JSON.stringify(t.group.groupItems)){return{group:r.copy(e.group)}}return null};p.prototype.getUnionData=function(e,t){if(!t||!t.group||!t.group.groupItems){return{group:r.copy(e.group)}}return{group:r.copy(t.group)}};p.prototype.isGroupSelected=function(e,t){var o=-1;e.groupItems.some(function(e,r){if(e.columnKey===t){o=r;return true}});return o>-1};p.prototype.exit=function(){e.prototype.exit.apply(this,arguments);if(this.getTable()&&this.getTable().detachGroup&&(this.getTableType()===o.personalization.TableType.AnalyticalTable||this.getTableType()===o.personalization.TableType.Table||this.getTableType()===o.personalization.TableType.TreeTable)){this.getTable().detachGroup(this._onGroup,this)}};return p});
/*!
 * SAPUI5
 * (c) Copyright 2009-2023 SAP SE. All rights reserved.
 */
sap.ui.predefine("sap/ui/comp/personalization/SelectionController", ["./BaseController","sap/m/library","sap/ui/comp/library","./Util"],function(e,t,n,i){"use strict";var o=e.extend("sap.ui.comp.personalization.SelectionController",{constructor:function(n,i){e.apply(this,arguments);this.setType(t.P13nPanelType.selection);this.setItemType(t.P13nPanelType.selection+"Items")},metadata:{events:{afterSelectionModelDataChange:{}}}});o.prototype.getColumn2Json=function(e,t,n){return{columnKey:t,text:e.getLabel(),visible:e.getSelected()}};o.prototype.getColumn2JsonTransient=function(e,t,n,i){return{columnKey:t,text:n,href:e.getHref(),internalHref:e.getInternalHref(),target:e.getTarget(),press:e.getPress(),description:e.getDescription()}};o.prototype.syncJson2Table=function(e){this.fireBeforePotentialTableChange();this.fireAfterPotentialTableChange()};o.prototype.getPanel=function(e){return new Promise(function(e){sap.ui.require(["sap/m/P13nSelectionPanel","sap/m/P13nItem","sap/m/P13nSelectionItem"],function(t,n,i){return e(new t({titleLarge:sap.ui.getCore().getLibraryResourceBundle("sap.ui.comp").getText("POPOVER_SELECTION_TITLE"),items:{path:"$sapmP13nPanel>/transientData/selection/selectionItems",template:new n({columnKey:"{$sapmP13nPanel>columnKey}",href:"{$sapmP13nPanel>href}",target:"{$sapmP13nPanel>target}",text:"{$sapmP13nPanel>text}",press:"{$sapmP13nPanel>press}"})},selectionItems:{path:"$sapmP13nPanel>/controlDataReduce/selection/selectionItems",template:new i({columnKey:"{$sapmP13nPanel>columnKey}",selected:"{$sapmP13nPanel>visible}"})},beforeNavigationTo:this.setModelFunction(),changeSelectionItems:function(e){if(!e.getParameter("items")){return}var t=this.getControlDataReduce();t.selection.selectionItems=e.getParameter("items").map(function(e){return{columnKey:e.columnKey,visible:e.selected}});this.setControlDataReduce2Model(t);this.fireAfterPotentialModelChange({json:t})}.bind(this)}))}.bind(this))}.bind(this))};o.prototype.retrieveAdaptationUI=function(e){return new Promise(function(e){sap.ui.require(["sap/ui/mdc/p13n/panels/LinkSelectionPanel"],function(t){var n=this.getAdaptationData();var i=new t({showHeader:true,enableCount:true,fieldColumn:sap.ui.getCore().getLibraryResourceBundle("sap.ui.mdc").getText("info.SELECTION_DIALOG_COLUMNHEADER_WITHOUT_COUNT"),linkPressed:this.getTable().getPress(),enableReorder:false});i.setP13nData(n);this.oPanel=i;var o;i.attachChange(function(e){var t=this.getControlDataReduce();o=e.getSource().getP13nData().map(function(e,t){return{columnKey:e.name,visible:e.visible}});t.selection.selectionItems=o;this.setControlDataReduce2Model(t);this.fireAfterPotentialModelChange({json:t})}.bind(this));e(i)}.bind(this))}.bind(this))};o.prototype._transformAdaptationData=function(t,n){var i=e.prototype._transformAdaptationData.apply(this,arguments);i.text=n.text;i.href=n.href;i.internalHref=n.internalHref?n.internalHref:undefined;i.visible=t.visible;i.description=n.description;i.label=n.name;return i};o.prototype.getChangeType=function(e,t){return this.getChangeData(e,t)?n.personalization.ChangeType.ModelChanged:n.personalization.ChangeType.Unchanged};o.prototype.getChangeData=function(e,t){if(!t||!t.selection||!t.selection.selectionItems){return null}var n={selection:i.copy(e.selection)};if(this._isSemanticEqual(e,t)){return null}var o=[];n.selection.selectionItems.forEach(function(e){var n=i.getArrayElementByKey("columnKey",e.columnKey,t.selection.selectionItems);if(i.semanticEqual(e,n)){o.push(e);return}for(var s in e){if(s==="columnKey"||!n){continue}if(e[s]===n[s]){delete e[s]}}if(Object.keys(e).length<2){o.push(e)}});o.forEach(function(e){var t=i.getIndexByKey("columnKey",e.columnKey,n.selection.selectionItems);n.selection.selectionItems.splice(t,1)});return n};o.prototype.getUnionData=function(e,t){var n=i.copy(e);if(!t||!t.selection||!t.selection.selectionItems){return n.selection?{selection:i.copy(n.selection)}:null}if(!n||!n.selection||!n.selection.selectionItems){return{selection:i.copy(t.selection)}}var o=this.createControlDataStructure();n.selection.selectionItems.forEach(function(e){var n=i.getArrayElementByKey("columnKey",e.columnKey,t.selection.selectionItems);if(n){if(n.visible!==undefined){e.visible=n.visible}}o.selection.selectionItems.push(e)});return o};o.prototype._isSemanticEqual=function(e,t){var n=function(e,t){if(e.visible===true&&(t.visible===false||t.visible===undefined)){return-1}else if((e.visible===false||e.visible===undefined)&&t.visible===true){return 1}else if(e.visible===true&&t.visible===true){return 0}else if((e.visible===false||e.visible===undefined)&&(t.visible===false||t.visible===undefined)){if(e.columnKey<t.columnKey){return-1}else if(e.columnKey>t.columnKey){return 1}else{return 0}}};var o=i.copy(e.selection.selectionItems).sort(n);var s=i.copy(t.selection.selectionItems).sort(n);return!o.some(function(e,t){if(!i.semanticEqual(e,s[t])){return true}})};o.prototype.getResetWarningText=function(){return sap.ui.getCore().getLibraryResourceBundle("sap.ui.mdc").getText("info.SELECTION_DIALOG_RESET_WARNING")};return o});
/*!
 * SAPUI5
 * (c) Copyright 2009-2023 SAP SE. All rights reserved.
 */
sap.ui.predefine("sap/ui/comp/personalization/SelectionWrapper", ["sap/ui/core/Element","./ColumnWrapper"],function(e,a){"use strict";var p=e.extend("sap.ui.comp.personalization.SelectionWrapper",{constructor:function(a,p){e.apply(this,arguments)},metadata:{library:"sap.ui.comp",properties:{press:{type:"function",defaultValue:null}},aggregations:{columns:{type:"sap.ui.comp.personalization.ColumnWrapper",multiple:true,singularName:"column"}}}});return p});
/*!
 * SAPUI5
 * (c) Copyright 2009-2023 SAP SE. All rights reserved.
 */
sap.ui.predefine("sap/ui/comp/personalization/SortController", ["./BaseController","sap/m/library","sap/ui/comp/library","./Util","sap/base/util/merge"],function(t,e,o,r,n){"use strict";var a=t.extend("sap.ui.comp.personalization.SortController",{constructor:function(o,r){t.apply(this,arguments);this.setType(e.P13nPanelType.sort);this.setItemType(e.P13nPanelType.sort+"Items")},metadata:{events:{afterSortModelDataChange:{}}}});a.prototype.setTable=function(e){t.prototype.setTable.apply(this,arguments);if(this.getTableType()===o.personalization.TableType.ResponsiveTable){e.detachEvent("_sort",this._onSort,this);e.attachEvent("_sort",this._onSort,this)}else if(e&&e.detachSort&&e.detachSort){e.detachSort(this._onSort,this);e.attachSort(this._onSort,this)}};a.prototype.getColumn2Json=function(t,e,o){if(!r.isSortable(t)){return null}if(!t.getSorted||t.getSorted&&!t.getSorted()){return null}if(!t.getSortOrder||t.getSortOrder()==="None"){return null}return{columnKey:e,operation:t.getSortOrder()}};a.prototype.getColumn2JsonTransient=function(t,e,o,n){if(!r.isSortable(t)){return null}return{columnKey:e,text:o,tooltip:n!==o?n:undefined}};a.prototype.handleIgnore=function(t,e){t.sort.sortItems.splice(e,1)};a.prototype.syncJson2Table=function(t){var e=this.getColumnMap();var r=n({},e);this.fireBeforePotentialTableChange();if(this.getTableType()===o.personalization.TableType.AnalyticalTable||this.getTableType()===o.personalization.TableType.Table||this.getTableType()===o.personalization.TableType.TreeTable){t.sort.sortItems.forEach(function(t){var o=e[t.columnKey];if(!o){return}if(t.operation===undefined){return}if(!o.getSorted()){o.setSorted(true)}if(o.getSortOrder()!==t.operation){o.setSortOrder(t.operation)}delete r[t.columnKey]});for(var a in r){var s=r[a];if(s&&s.getSorted()){s.setSorted(false)}if(s&&s.getSortOrder()!=="None"){s.setSortOrder("None")}}}this.fireAfterPotentialTableChange()};a.prototype.getDataSuiteFormat2Json=function(t){var e=this.createControlDataStructure();if(!t.SortOrder||!t.SortOrder.length){return e}e.sort.sortItems=t.SortOrder.map(function(t){return{columnKey:t.Property,operation:t.Descending?"Descending":"Ascending"}});return e};a.prototype.getDataSuiteFormatSnapshot=function(t){var e=this.getUnionData(this.getControlDataInitial(),this.getControlData());if(!e.sort||!e.sort.sortItems||!e.sort.sortItems.length){return}t.SortOrder=e.sort.sortItems.map(function(t){return{Property:t.columnKey,Descending:t.operation==="Descending"}})};a.prototype._onSort=function(t){t.preventDefault();this._updateInternalModel(r.getColumnKey(t.getParameter("column")),t.getParameter("sortOrder"),t.getParameter("columnAdded"));this.syncJson2Table(this.getControlData());this.fireAfterSortModelDataChange()};a.prototype._updateInternalModel=function(t,e,o){if(!t||e!=="Descending"&&e!=="Ascending"&&e!=="None"){return}if(!o){this.getInternalModel().setProperty("/controlData/sort/sortItems",[])}var n=this.getControlData();if(e!="None"){var a=r.getIndexByKey("columnKey",t,n.sort.sortItems);a=a>-1?a:n.sort.sortItems.length;this.getInternalModel().setProperty("/controlData/sort/sortItems/"+a+"/",{columnKey:t,operation:e})}this.updateControlDataBaseFromJson(n)};a.prototype.getPanel=function(){if(!r.hasSortableColumns(this.getColumnMap())){return null}return new Promise(function(t){sap.ui.require(["sap/m/P13nSortPanel","sap/m/P13nItem","sap/m/P13nSortItem"],function(e,o,r){return t(new e({containerQuery:true,items:{path:"$sapmP13nPanel>/transientData/sort/sortItems",template:new o({columnKey:"{$sapmP13nPanel>columnKey}",text:"{$sapmP13nPanel>text}",tooltip:"{$sapmP13nPanel>tooltip}"})},sortItems:{path:"$sapmP13nPanel>/controlDataReduce/sort/sortItems",template:new r({columnKey:"{$sapmP13nPanel>columnKey}",operation:"{$sapmP13nPanel>operation}"})},beforeNavigationTo:this.setModelFunction(),updateSortItem:function(){this.fireAfterPotentialModelChange({json:this.getControlDataReduce()})}.bind(this),addSortItem:function(t){if(!t.getParameter("sortItemData")){return}var e=t.getParameter("index");var o=t.getParameter("sortItemData");var r={columnKey:o.getColumnKey(),operation:o.getOperation()};var n=this.getControlDataReduce();if(e>-1){n.sort.sortItems.splice(e,0,r)}else{n.sort.sortItems.push(r)}this.setControlDataReduce2Model(n);this.fireAfterPotentialModelChange({json:n})}.bind(this),removeSortItem:function(t){var e=t.getParameter("index");if(e<0){return}var o=this.getControlDataReduce();o.sort.sortItems.splice(e,1);this.setControlDataReduce2Model(o);this.fireAfterPotentialModelChange({json:o})}.bind(this)}))}.bind(this))}.bind(this))};a.prototype.retrieveAdaptationUI=function(t){if(!r.hasSortableColumns(this.getColumnMap())){return null}return new Promise(function(t){sap.ui.require(["sap/m/p13n/SortPanel"],function(e){var o=this.getAdaptationData();var r=new e;r.setP13nData(o);this.oPanel=r;r.attachChange(function(t){var e=r.getP13nData(true);var o=this.getControlDataReduce();o.sort.sortItems=e.map(function(t){return{columnKey:t.name,operation:t.descending?"Descending":"Ascending"}});this.setControlDataReduce2Model(o);this.fireAfterPotentialModelChange({json:o})}.bind(this));t(r)}.bind(this))}.bind(this))};a.prototype._transformAdaptationData=function(e,o){var r=t.prototype._transformAdaptationData.apply(this,arguments);r.sorted=!!e;r.descending=e?e.operation==="Descending":false;return r};a.prototype._sortAdaptationData=function(t){this._getP13nBuilder().sortP13nData({visible:"sorted",position:"position"},t)};a.prototype._getPresenceAttribute=function(){return"sorted"};a.prototype.getChangeType=function(t,e){if(!e||!e.sort||!e.sort.sortItems){return o.personalization.ChangeType.Unchanged}var r=JSON.stringify(t.sort.sortItems)!==JSON.stringify(e.sort.sortItems);return r?o.personalization.ChangeType.ModelChanged:o.personalization.ChangeType.Unchanged};a.prototype.getChangeData=function(t,e){if(!t||!t.sort||!t.sort.sortItems){return{sort:{sortItems:[]}}}if(!e||!e.sort||!e.sort.sortItems){return{sort:r.copy(t.sort)}}if(JSON.stringify(t.sort.sortItems)!==JSON.stringify(e.sort.sortItems)){return{sort:r.copy(t.sort)}}return null};a.prototype.getUnionData=function(t,e){if(!e||!e.sort||!e.sort.sortItems){return{sort:r.copy(t.sort)}}return{sort:r.copy(e.sort)}};a.prototype.exit=function(){t.prototype.exit.apply(this,arguments);var e=this.getTable();if(e&&e.detachSort){e.detachSort(this._onSort,this)}};return a});
/*!
 * SAPUI5
 * (c) Copyright 2009-2023 SAP SE. All rights reserved.
 */
sap.ui.predefine("sap/ui/comp/personalization/UIManager", ["sap/m/p13n/modules/UIManager","sap/ui/base/Object"],function(a,n){"use strict";var t=a.extend("sap.ui.comp.personalization.UIManager",{constructor:function(a){this.oAdaptationProvider=a;n.call(this)}});return t});
/*!
 * SAPUI5
 * (c) Copyright 2009-2023 SAP SE. All rights reserved.
 */
sap.ui.predefine("sap/ui/comp/personalization/Util", ["sap/ui/comp/library","sap/m/library","sap/base/util/deepExtend","sap/ui/core/Configuration","sap/ui/core/date/UI5Date"],function(e,t,r,n,a){"use strict";var i=e.personalization.ChangeType;var o=e.personalization.AggregationRole;var u=e.personalization.TableType;var s=e.personalization.ColumnType;var l={getColumnKeys:function(e){if(!e||!e.length){return[]}return e.map(function(e){return this.getColumnKey(e)},this)},sortItemsByText:function(e,t){var r;try{var r=n.getLocale().toString();if(typeof window.Intl!=="undefined"){var a=window.Intl.Collator(r,{numeric:true});e.sort(function(e,r){return a.compare(e[t],r[t])})}else{e.sort(function(e,n){return e[t].localeCompare(n[t],r,{numeric:true})})}}catch(e){}},getUnionOfAttribute:function(e,t){var r=[];var n=function(e){if(r.indexOf(e)<0){r.push(e)}};for(var a in e){var i=e[a];if(!i[t]){continue}i[t].forEach(n)}return r},getUnionOfColumnKeys:function(e){var t=[];var r=function(e){t=t.concat(e.map(function(e){return e.columnKey}));t=t.filter(function(e,r){return t.indexOf(e)===r})};for(var n in e){for(var a in e[n]){if(!Array.isArray(e[n][a])){continue}r(e[n][a])}}return t},copy:function(e){if(e instanceof Array){return r([],e)}else{return r({},e)}},sort:function(e,t){var r=this.copy(t);r.sort(function(t,r){var n=t[e].toLocaleLowerCase();var a=r[e].toLocaleLowerCase();if(n<a){return-1}if(n>a){return 1}return 0});return r},removeEmptyProperty:function(e){for(var t in e){if(e[t]===null||e[t]===undefined){delete e[t]}}return e},semanticEqual:function(e,t){if(!e||!t){return false}for(var r in e){if(e[r]!==t[r]){return false}}return true},hasChangedType:function(e){for(var t in e){if(e[t]===i.ModelChanged||e[t]===i.TableChanged){return true}}return false},isNamespaceChanged:function(e,t){if(e[t]){return e[t]===i.ModelChanged||e[t]===i.TableChanged}return false},createArrayFromString:function(e){if(!e){return[]}var t=[];var r=e.split(",");r.forEach(function(e){if(e!==""){t.push(e.trim())}});return t},getIndexByKey:function(e,t,r){if(!r||!r.length){return-1}var n=-1;r.some(function(r,a){if(r[e]!==undefined&&r[e]===t){n=a;return true}});return n},getColumnKey:function(e){return this._getCustomProperty(e,"columnKey")||e.getId()},getColumnType:function(e){return this._getCustomProperty(e,"type")},hasSortableColumns:function(e){for(var t in e){if(l.isSortable(e[t])){return true}}return false},hasGroupableColumns:function(e){for(var t in e){if(l.isGroupable(e[t])){return true}}return false},hasFilterableColumns:function(e){for(var t in e){if(l.isFilterable(e[t])){return true}}return false},hasAggregatableColumns:function(e){for(var t in e){if(l.isAggregatable(e[t])){return true}}return false},isGroupable:function(e){if(e&&e.isA("sap.ui.table.AnalyticalColumn")){return e.isGroupableByMenu()||this._getCustomProperty(e,"isGroupable")}if(e&&e.isA("sap.m.Column")){return this.isSortable(e)}return false},isSortable:function(e){if(e.getSortProperty){return!!e.getSortProperty()}return!!this._getCustomProperty(e,"sortProperty")},isFilterable:function(e){if(e.getFilterProperty){return!!e.getFilterProperty()}return!!this._getCustomProperty(e,"filterProperty")},isAggregatable:function(e){if(e.getAggregationRole){return e.getAggregationRole()===o.Dimension||e.getAggregationRole()===o.Measure}return false},getArrayElementByKey:function(e,t,r){if(!r||!r.length){return null}var n=null;r.some(function(r){if(r[e]!==undefined&&r[e]===t){n=r;return true}});return n},isColumnIgnored:function(e,t){if(!t){return false}return t.indexOf(this.getColumnKey(e))>-1},createSort2Json:function(e,t,r,n){if(this.getTableBaseType(e)!==u.Table&&this.getTableType(e)!==u.ChartWrapper){return}this.addSortPersistentData(this._mapTable2P13nSortJson(e),{sort:{sortItems:t}},r,n)},addSortPersistentData:function(e,t,r,n){var a=[];e.sort.sortItems.forEach(function(e){if(!e.isSorted||r.indexOf(e.columnKey)>-1){return}t.sort.sortItems.push({columnKey:e.columnKey,operation:e.operation});a.push(e.columnKey)});if(n){n.forEach(function(e){if(a.indexOf(e.name)>-1||!e.sorted){return}t.sort.sortItems.push({columnKey:e.name,operation:e.sortOrder,initiallyNotVisibleColumn:true})})}},_mapTable2P13nSortJson:function(e){return{sort:{sortItems:e.getColumns().map(function(e){var t=e.getSortOrder()!=="None";if(!e.getSorted()){t=false}return{columnKey:l.getColumnKey(e),isSorted:t,operation:e.getSortOrder()}})}}},getTableType:function(e){switch(e&&e.getMetadata().getName()){case"sap.ui.comp.personalization.ChartWrapper":return u.ChartWrapper;case"sap.ui.comp.personalization.SelectionWrapper":return u.SelectionWrapper;case"sap.m.Table":return u.ResponsiveTable;case"sap.ui.table.AnalyticalTable":return u.AnalyticalTable;case"sap.ui.table.TreeTable":return u.TreeTable;case"sap.ui.table.Table":return u.Table}return null},getTableBaseType:function(e){switch(this.getTableType(e)){case u.ChartWrapper:return u.ChartWrapper;case u.SelectionWrapper:return u.SelectionWrapper;case u.ResponsiveTable:return u.ResponsiveTable;case u.AnalyticalTable:case u.Table:case u.TreeTable:return u.Table}return null},getColumnBaseType:function(e){switch(e&&e.getMetadata().getName()){case"sap.ui.comp.personalization.ColumnWrapper":return s.ColumnWrapper;case"sap.m.Column":return s.ResponsiveColumn;case"sap.ui.table.AnalyticalColumn":case"sap.ui.table.Column":return s.TableColumn}return null},_getCustomProperty:function(e,t){var r=this._getCustomData(e);if(!r||!t){return null}return r[t]},_getCustomData:function(e){if(!e){return null}var t=e.data("p13nData");if(typeof t==="string"){try{t=JSON.parse(t);e.data("p13nData",t)}catch(e){}}return t},getColumnKeysOfType:function(e,t){var r=[];for(var n in t){if(this.getColumnType(t[n])===e){r.push(n)}}return r},convertFilters:function(e,t){if(e&&e.filter&&e.filter.filterItems){var r=this.getColumnKeysOfType("date",t);var n=this.getColumnKeysOfType("time",t);var i=this.getColumnKeysOfType("datetime",t);e.filter.filterItems.forEach(function(e){var o=t&&t[e.columnKey];if(r.indexOf(e.columnKey)>-1||n.indexOf(e.columnKey)>-1||i.indexOf(e.columnKey)>-1){if(o&&o.data("p13nData")&&o.data("p13nData").edmType==="Edm.String"){return}if(e.value1&&typeof e.value1==="string"){e.value1=a.getInstance(e.value1)}if(e.value2&&typeof e.value2==="string"){e.value2=a.getInstance(e.value2)}}})}},convertSelectOptions:function(e,t){if(e&&e.SelectOptions){var r=this.getColumnKeysOfType("date",t);var n=this.getColumnKeysOfType("time",t);var i=this.getColumnKeysOfType("datetime",t);e.SelectOptions.forEach(function(e){e.Ranges.forEach(function(t){if(r.indexOf(e.PropertyName)>-1||n.indexOf(e.PropertyName)>-1||i.indexOf(e.PropertyName)>-1){if(t.Low&&typeof t.Low==="string"){t.Low=a.getInstance(t.Low)}if(t.High&&typeof t.High==="string"){t.High=a.getInstance(t.High)}}})})}}};return l},true);
/*!
 * SAPUI5
 * (c) Copyright 2009-2023 SAP SE. All rights reserved.
 */
sap.ui.predefine("sap/ui/comp/personalization/Validator", ["sap/ui/comp/library","sap/m/library","sap/ui/core/library"],function(e,r,s){"use strict";var n=s.MessageType;var o=r.P13nPanelType;var a=e.personalization.TableType;var i={checkGroupAndColumns:function(e,r,s,i,t){if(e!==a.AnalyticalTable||!r.group||!r.columns){return Promise.resolve(t)}for(var u in s){var l=r.columns.controller.isColumnSelected(i.columns,u);var c=r.group.controller.isGroupSelected(i.group,u);if(c&&!l){t.push({columnKey:u,panelTypes:[o.group,o.columns],messageType:n.Warning,messageText:sap.ui.getCore().getLibraryResourceBundle("sap.ui.comp").getText("PERSODIALOG_MSG_GROUPING_NOT_POSSIBLE_DESCRIPTION")})}}return Promise.resolve(t)},checkSaveChanges:function(e,r,s,i){if(e!==a.SelectionWrapper){return Promise.resolve(i)}return r.selection.payload.callbackSaveChanges(s).then(function(e){if(e){return i}i.push({panelTypes:[o.selection],messageType:n.Error,messageText:sap.ui.getCore().getLibraryResourceBundle("sap.ui.comp").getText("PERSODIALOG_MSG_CHANGES_SAVE_FAILED")});return i})},checkChartConsistency:function(e,r,s,i){if(e!==a.ChartWrapper){return Promise.resolve(i)}return r.dimeasure.controller.isChartConsistent(s).then(function(e){if(!e){i.push({panelTypes:[o.dimeasure],messageType:n.Error,messageText:sap.ui.getCore().getLibraryResourceBundle("sap.ui.comp").getText("PERSODIALOG_MSG_VALIDATION_CHARTTYPE")})}return i})},checkVisibleItemsThreshold:function(e,r,s,a){if(!r.columns){return Promise.resolve(a)}var i=-1;if(r.columns.payload&&r.columns.payload.visibleItemsThreshold){i=r.columns.payload.visibleItemsThreshold}var t=s.columns.columnsItems.filter(function(e){return e.visible}).length;if(i>-1&&t>i){a.push({panelTypes:[o.columns],messageType:n.Warning,messageText:sap.ui.getCore().getLibraryResourceBundle("sap.ui.comp").getText("SMARTTABLE_P13N_VISIBLE_ITEMS_THRESHOLD_MESSAGE")})}return Promise.resolve(a)}};return i},true);
/*!
 * SAPUI5
 * (c) Copyright 2009-2023 SAP SE. All rights reserved.
 */
sap.ui.predefine("sap/ui/comp/providers/BaseValueListProvider", ["sap/ui/comp/library","sap/ui/base/EventProvider","sap/ui/comp/odata/ODataType","sap/ui/comp/odata/MetadataAnalyser","sap/ui/comp/util/FormatUtil","sap/ui/comp/util/DateTimeUtil","sap/base/Log","sap/m/Token","sap/ui/model/Filter","sap/ui/model/FilterOperator","sap/m/table/Util","sap/base/util/isEmptyObject"],function(t,e,i,a,s,o,n,r,l,h,d,u){"use strict";var p=t.smartfilterbar.DisplayBehaviour;var f=t.ANALYTICAL_PARAMETER_PREFIX;var m=e.extend("sap.ui.comp.providers.BaseValueListProvider",{constructor:function(t){e.call(this);this.sFieldName=t.fieldName;this.oControl=t.control;this.oODataModel=t.model;this.oFilterModel=t.filterModel;this.oFilterProvider=t.filterProvider;this.sDisplayFormat=t.displayFormat;this._oDateFormatSettings=t.dateFormatSettings;this._oCalendarWeekSettings=t.calendarWeekSettings;this._aValidationPromises=[];this.sContext=t.context;this.fnAsyncWritePromise=t.fnAsyncWritePromise;this._selectedODataRowHandler=t.selectedODataRowHandler;if(!this._oDateFormatSettings){this._oDateFormatSettings={}}if(!this._oDateFormatSettings.hasOwnProperty("UTC")){this._oDateFormatSettings["UTC"]=true}this._fieldViewMetadata=t.fieldViewMetadata;this.sValueListEntitySetName=null;this.bResolveInOutParams=t.resolveInOutParams===false?false:true;this.sDisplayBehaviour=t.displayBehaviour;this.sDDLBDisplayBehaviour=this.sDisplayBehaviour;if(!this.sDDLBDisplayBehaviour||this.sDDLBDisplayBehaviour===p.auto){this.sDDLBDisplayBehaviour=this.oFilterProvider?this.oFilterProvider.sDefaultDropDownDisplayBehaviour:p.descriptionOnly}this._sType=t.type;this._sMaxLength=t.maxLength;this.sPropertyTypePath="";if(this.bResolveInOutParams&&!this.oFilterModel&&!this.oFilterProvider){this._resolvePropertyPath()}if(t.loadAnnotation&&t.fullyQualifiedFieldName){this._oMetadataAnalyser=t.metadataAnalyser;this._sFullyQualifiedFieldName=t.fullyQualifiedFieldName;this._attachAnnotationLoadOnRender()}else{if(t.loadAnnotation){n.error("BaseValueListProvider","loadAnnotation is true, but no fullyQualifiedFieldName set for field '"+(this._sFullyQualifiedFieldName||this.sFieldName)+"'! Please check your annotations")}this._onAnnotationLoad({primaryValueListAnnotation:t.annotation,additionalAnnotations:t.additionalAnnotations})}}});m.prototype._attachAnnotationLoadOnRender=function(){this.oBeforeRenderingEventDelegate={onBeforeRendering:function(){this.oControl.removeEventDelegate(this.oBeforeRenderingEventDelegate,this);delete this.oBeforeRenderingEventDelegate;if(!this._bValueListRequested){if(this.bInitialised){if(this._onMetadataInitialised&&this.sAggregationName&&!this.bTypeAheadEnabled&&this.oControl.$()){this._onMetadataInitialised()}}else{this._loadAnnotation()}}}};this.oControl.addEventDelegate(this.oBeforeRenderingEventDelegate,this)};m.prototype.loadAnnotation=function(){if(this.oBeforeRenderingEventDelegate){this.oControl.removeEventDelegate(this.oBeforeRenderingEventDelegate,this);delete this.oBeforeRenderingEventDelegate}if(this.oAfterRenderingEventDelegate){this.oControl.removeEventDelegate(this.oAfterRenderingEventDelegate,this);delete this.oAfterRenderingEventDelegate}return this._loadAnnotation()};m.prototype._loadAnnotation=function(){if(!this._bValueListRequested){this._bValueListRequested=true;if(!this._oMetadataAnalyser){this._oMetadataAnalyser=new a(this.oODataModel);this._bCleanupMetadataAnalyser=true}return this.getValueListAnnotation().then(this._onAnnotationLoad.bind(this),function(t){this._oError=t;this.bInitialised=true;n.debug(t)}.bind(this))}return Promise.resolve()};m.prototype.getValueListAnnotation=function(){var t;if(a.hasValueListRelevantQualifiers(this._fieldViewMetadata)){t=this.oControl.getBindingContext()&&this.oControl.getBindingContext().getPath()}return this._oMetadataAnalyser.getValueListAnnotationLazy(this._sFullyQualifiedFieldName,t)};m.prototype.attachValueListChanged=function(t,e){this.attachEvent("valueListChanged",t,e)};m.prototype.detachValueListChanged=function(t,e){this.detachEvent("valueListChanged",t,e)};m.prototype._onAnnotationLoad=function(t){var e={};this.oPrimaryValueListAnnotation=t.primaryValueListAnnotation;this.additionalAnnotations=t.additionalAnnotations;this._resolveAnnotationData(this.oPrimaryValueListAnnotation);this.bInitialised=true;if(this._fBaseValueListProviderResolve){this._fBaseValueListProviderResolve()}if(this._onMetadataInitialised&&this.sAggregationName&&!this.bTypeAheadEnabled&&this.oControl.$()){this._onMetadataInitialised()}if(t.primaryValueListAnnotation&&t.primaryValueListAnnotation.annotation||t.primaryValueListAnnotationWithPVQualifier&&t.primaryValueListAnnotationWithPVQualifier.annotation){e.primaryValueListAnnotation=t.primaryValueListAnnotation||t.primaryValueListAnnotationWithPVQualifier}if(Array.isArray(t.additionalAnnotations)&&t.additionalAnnotations.length>0){e.additionalAnnotations=t.additionalAnnotations}if(Array.isArray(t.additionalAnnotationsWithPVQualifier)&&t.additionalAnnotationsWithPVQualifier.length>0){if(Array.isArray(e.additionalAnnotations)){e.additionalAnnotations=e.additionalAnnotations.concat(t.additionalAnnotationsWithPVQualifier)}else{e.additionalAnnotations=t.additionalAnnotationsWithPVQualifier}}return e};m.prototype._resolvePropertyPath=function(){var t=this.oControl.getBindingInfo("value"),e,i,a;if(t&&t.parts){e=t.parts[0]?t.parts[0].path:""}if(e){a=e.split("/");if(a.length>1){i=a[a.length-1];this.sPropertyTypePath=e.replace("/"+i,"")}}};m.prototype._resolveAnnotationData=function(t){var e=0,i=0,a,s,o,r=this.sValueListsDDLBDisplayBehaviour||this.sDDLBDisplayBehaviour;if(this.oODataModel&&t){this.bSupportBasicSearch=t.isSearchSupported;this.sValueListTitle=t.valueListTitle||t.qualifier;this.sKey=t.keyField;this._aKeys=t.keys;this.sValueListEntitySetName=t.valueListEntitySetName;this.mInParams=t.inParams;this.mOutParams=t.outParams;this.mConstParams=t.constParams;this.sValueListsDDLBDisplayBehaviour=this._getValueListsDDLBDisplayBehaviour(t);this.sTokenDisplayBehaviour=this.sDisplayBehaviour;if(!this.sTokenDisplayBehaviour||this.sTokenDisplayBehaviour===p.auto){this.sTokenDisplayBehaviour=this.oFilterProvider?this.oFilterProvider.sDefaultTokenDisplayBehaviour:p.descriptionAndId}this.sSingleFieldDisplayBehaviour=this.sDisplayBehaviour;if(!this.sSingleFieldDisplayBehaviour||this.sSingleFieldDisplayBehaviour===p.auto){this.sSingleFieldDisplayBehaviour=this.oFilterProvider?this.oFilterProvider.sDefaultSingleFieldDisplayBehaviour:p.descriptionAndId}if(!t.descriptionField){this.sTokenDisplayBehaviour=p.idOnly;this.sSingleFieldDisplayBehaviour=p.idOnly}if(r===p.descriptionOnly&&!t.descriptionField){this.sDescription=this.sKey}else{this.sDescription=t.descriptionField}if(this.sValueListEntitySetName&&this.sKey){this._aCols=[];this._aCombinedDescriptionColNames=[];this.aSelect=[];a=t.valueListFields;o=t.aHighImportanceFields;if(o&&o.length){this._aHighImportanceCols=[]}e=a.length;for(i=0;i<e;i++){s=a[i];if(s.visible){var l=this._getColumnConfigFromField(s);if(l&&o&&o.indexOf(s)!==-1){this._aHighImportanceCols.push(l)}if(l){this._aCols.push(l)}}this.aSelect.push(s.name)}if(t.descriptionField){this.aSelect.push(t.descriptionField)}if(t.deprecationCodeField){this.aSelect.push(t.deprecationCodeField)}}else{if(!this.sKey){n.error("BaseValueListProvider","key for ValueListEntitySetName '"+this.sValueListEntitySetName+"' missing! Please check your annotations")}}}};m.prototype._getValueListsDDLBDisplayBehaviour=function(t){var e,i;if(t&&Array.isArray(t.valueListFields)&&this._oMetadataAnalyser){i=t.valueListFields.find(function(e){return e.name===t.keyField});if(i&&i.fullName){e=this._oMetadataAnalyser.getTextArrangementValue(i.fullName)}}return e};m.prototype._getColumnConfigFromField=function(t){if(this._aCombinedDescriptionColNames&&this._aCombinedDescriptionColNames.includes(t.name)){return}var e=null,s=null,o,n,r=t.displayBehaviour||this._oMetadataAnalyser&&this._oMetadataAnalyser.getTextArrangementValue(t.fullName),l=this._oMetadataAnalyser&&this._oMetadataAnalyser.getDescriptionFieldName(t.name,this.sValueListEntitySetName),h=t.maxLength||0,u="",f=0,m=0,y=t.name,g=a.getIsTimezoneProperty(t),v,c=a.isDigitSequence(t);if(t.type==="Edm.Boolean"){e="boolean"}else if(t.type==="Edm.DateTime"&&t.displayFormat==="Date"){e="date";n=this._oDateFormatSettings;o={displayFormat:"Date"}}else if(t.type==="Edm.Decimal"){e="decimal";o={precision:t.precision,scale:t.scale}}else if(t.type==="Edm.String"){if(t.isCalendarDate){e="stringdate"}else{e="string"}}if(a.hasTextArrangementAnnotation(t)&&l&&r&&(r===p.idAndDescription||r===p.descriptionAndId)){var D=this.oPrimaryValueListAnnotation.valueListFields.find(function(t){return t.name===l});u=D?D.fieldLabel:"";f=D?D.maxLength:0;m=1;y=[t.name,l];this._aCombinedDescriptionColNames.push(l)}o=Object.assign({maxLength:""+(parseInt(h)+parseInt(f)+m),isDigitSequence:c},o);if(this.sContext==="SmartField"&&g){t.isTimezone=true;v=i.getType(t.type,{showDate:false,showTime:false},o,t)}s=i.getType(t.type,n,o,t.isCalendarDate);return{description:t.description,descriptionLabel:u,displayBehaviour:r,label:t.fieldLabel,tooltip:t.quickInfo||t.fieldLabel,type:e,oType:v||s,suggestionsWidth:d.calcColumnWidth(s,t.fieldLabel),width:d.calcColumnWidth(s,t.fieldLabel,{headerGap:true,truncateLabel:false}),template:y,sort:t.sortable?t.name:undefined,sorted:t.sortable&&t.name===this.sKey,sortOrder:"Ascending",isTimezone:t.isTimezone,fieldName:t.name,fieldTemplate:y}};m.prototype._getFilterData=function(){var t,e={};if(this.oFilterProvider&&this.oFilterProvider._oSmartFilter){t=this.oFilterProvider._oSmartFilter.getFilterData();if(this.sFieldName&&this.sFieldName.indexOf(f)===0){Object.keys(t).forEach(function(i){var a=i.split(f);e[a[a.length-1]]=t[i]});return e}}return t};m.prototype._setFilterData=function(t){var e=t,i={};if(this.oFilterProvider){if(this.sFieldName&&this.sFieldName.indexOf(f)===0){Object.keys(t).forEach(function(e){i[f+e]=t[e]});e=i}this.oFilterProvider.setFilterData(e)}};m.prototype._adaptPropertyValue=function(t,e){var i=e;if((e instanceof Date||typeof e==="string"&&!isNaN(e))&&this.oPrimaryValueListAnnotation&&this.oPrimaryValueListAnnotation.fields){var a=null;this.oPrimaryValueListAnnotation.fields.some(function(e){if(e.name===t){a=e}return a!==null});if(a&&a.type==="Edm.DateTime"&&a.displayFormat==="Date"){i=o.utcToLocal(e)}if(a&&a.isDigitSequence){var s=new RegExp("^[0]*$");if(s.test(e)){i=null}}}return i};m.prototype._calculateFilterInputData=function(){var t,e,i=null,a,s;delete this.mFilterInputData;this.mFilterInputData={};this.aFilterField=[];if(this.oFilterProvider&&this.oFilterProvider._oSmartFilter){i=this._getFilterData()}else if(this.oFilterModel){i=this.oFilterModel.getData()}if(this.mInParams&&i){for(t in this.mInParams){if(t){e=this.mInParams[t];e=e.replace("/",".");if(e!==this.sKey){if(this.sContext==="mdcFilterPanel"||this.sContext==="SmartFilterBar"&&this._isFieldHiddenInFilterBar(this.oFilterProvider._oSmartFilter,t)){continue}if(i[t]||i[f+t]){this.mFilterInputData[e]=i[t]||i[f+t];if(typeof this.mFilterInputData[e]==="object"){if(this.mFilterInputData[e].ranges&&this.mFilterInputData[e].ranges.length>0){for(var o=0;o<this.mFilterInputData[e].ranges.length;o++){this.mFilterInputData[e].ranges[o].keyField=e}}}this.aFilterField.push(e)}}}}}else if(this.oODataModel&&this.bResolveInOutParams){a=this.oControl.getBindingContext();if(this.mInParams&&a){for(t in this.mInParams){if(t){e=this.mInParams[t];e=e.replace("/",".");if(e!==this.sKey){var n=this.sPropertyTypePath?this.sPropertyTypePath+"/"+t:t;var r=a.getProperty(n);if(r||r===false){r=this._adaptPropertyValue(e,r);this.mFilterInputData[e]=r;this.aFilterField.push(e)}}}}}}if(this.mConstParams){for(s in this.mConstParams){this.mFilterInputData[s]=this.mConstParams[s];this.aFilterField.push(s)}}};m.prototype._isFieldHiddenInFilterBar=function(t,e){var i=t&&(t._getFilterItemByName(e)||t._getFilterItemByName(f+e));return!i||!i.getVisibleInFilterBar()};m.prototype._calculateAndSetFilterOutputData=function(t){var e,i,a,n=null,r,l,h,d,p,f,m;if(this.mOutParams&&t&&(this.oFilterProvider||this.oFilterModel)){n={};p=function(t){return t.key===h.key};f=function(t){if(h.value1 instanceof Date&&t.value1 instanceof Date){return t.operation==="EQ"&&h.value1.getTime()===t.value1.getTime()}return t.operation==="EQ"&&h.value1===t.value1};m=function(t){return t.operation==="EQ"&&h.key===t.value1};for(e in this.mOutParams){if(e){if(!this.oFilterProvider&&Object.keys(this.mOutParams).length>1){if(e!==this.sFieldName){continue}}var y=this.oFilterProvider&&this.oFilterProvider._getFieldMetadata(e);a=this.mOutParams[e];if(t.length>0){for(var d=0;d<this._aCols.length;d++){if(this._aCols[d].template===a){var g=this._aCols[d].description;i=t[0][g]}}}if(a!==this.sKey){l=null;d=t.length;while(d--){r=t[d];if(this.sContext==="mdcFilterPanel"||this.sContext==="SmartFilterBar"&&this._isFieldHiddenInFilterBar(this.oFilterProvider._oSmartFilter,e)){continue}if(r[a]){var v=r[a];var c=y&&(y.type==="Edm.DateTime"||!y.hasValueListAnnotation);if(c){if(y.type==="Edm.DateTime"&&this._oDateFormatSettings.UTC==true){v=o.utcToLocal(v)}h={exclude:false,operation:"EQ",keyField:e,value1:v,value2:null}}else{h={key:v,text:s.getFormattedExpressionFromDisplayBehaviour(this.sTokenDisplayBehaviour,v,i)}}if(!n[e]){if(!l&&this.oFilterModel){l=this.oFilterModel.getData()}if(l&&l[e]&&l[e].items){n[e]=l[e];if(!n[e].ranges){n[e].ranges=[]}}else{n[e]={items:[],ranges:[]}}}var D=n[e];if(c){if(D.ranges.filter(f).length<=0){D.ranges.push(h)}}else if(D.items.filter(p).length<=0){if(!D.ranges||D.ranges.filter(m).length<=0){D.items.push(h)}}}}}}}if(n){if(this.oFilterProvider){this._setFilterData(n);if(!u(n)){this.fireEvent("valueListChanged",{changes:Object.keys(n)})}}else if(this.oFilterModel){this.oFilterModel.setData(n,true)}}}else if(this.oODataModel&&this.bResolveInOutParams){this._calculateAndSetODataModelOutputData(t[0])}};m.prototype._calculateAndSetODataModelOutputData=function(t){var e,i,a,s,o,n={};if(t&&this.mOutParams){e=this.oControl.getBindingContext();for(i in this.mOutParams){if(i){a=this.mOutParams[i];if(a!==this.sKey){o=t[a];n[i]=o;s=this.sPropertyTypePath?this.sPropertyTypePath+"/"+i:i;this.oODataModel.setProperty(s,o,e,true)}}}if(n&&!jQuery.isEmptyObject(n)){this.fireEvent("valueListChanged",{changes:n})}}};m.prototype._handleRowsSelect=function(t){var e,i,a,o,n,l=[],h,d;if(!(this.oControl&&this.oControl.addToken)){return}h=this.oControl.getTokens();for(e=0;e<t.length;e++){a=t[e][this.sKey];o=t[e][this.sDescription];if(a||a===""){o=s.getFormattedExpressionFromDisplayBehaviour(this.sTokenDisplayBehaviour,a,o);n=new r({key:a,text:o,tooltip:o});n.data("row",t[e]);l.push(n);for(i=0;i<h.length;i++){d=h[i];var u=d.getKey();if(u||u===""&&u===a){break}else if(d.data("range")&&!d.data("range").exclude&&d.data("range").operation==="EQ"&&d.data("range").value1==a){break}}if(i<h.length){h.splice(i,1)}}}if(l.length){this.oControl.setTokens(h.concat(l))}};m.prototype.readData=function(t){var e=[],i;this._oReadPromise=new Promise(function(t){this._fBaseValueListProviderResolve=t}.bind(this));if(this.bInitialised){this._fBaseValueListProviderResolve()}this._oReadPromise.then(function(){this._fBaseValueListProviderResolve=null;for(var a=0;a<t.length;a++){i=this.sDisplayFormat==="UpperCase"?t[a].toUpperCase():t[a];e.push(new l(this.sKey,h.EQ,i))}if(!this.sValueListEntitySetName){return}this.oODataModel.read("/"+this.sValueListEntitySetName,{filters:e,success:function(e,i){if(e){if(e.results&&e.results.length!==t.length){n.error("Expecting "+t.length+" result rows, but received "+e.results.length+" rows...");return}var a=e.results;if(this.oControl&&this.oControl.isA("sap.m.MultiInput")&&this.oControl.getTokens().length!==t.length){a=this._getUpdatedDataModelRows(a)}this._handleRowsSelect(a)}}.bind(this),error:function(t){n.error("Error occured reading /"+this.sValueListEntitySetName)}.bind(this)})}.bind(this))};m.prototype._getUpdatedDataModelRows=function(t){var e=this.oControl.getTokens(),i=[];for(var a=0;a<e.length;a++){var s=e[a];var o=s.getKey();if(o){i.push(o)}else if(s.data("range")&&s.data("range").value1){i.push(s.data("range").value1)}}var n=[];for(var a=0;a<t.length;a++){var r=t[a][this.sKey];if(i.indexOf(r)!==-1){n.push(t[a])}}return n};m.prototype._addValidationPromise=function(t){var e,i,a,s=false;for(e=0;e<this._aValidationPromises.length;e++){a=this._aValidationPromises[e];if(a===null){this._aValidationPromises[e]=t;i=e;s=true;break}}if(!s){this._aValidationPromises.push(t);i=this._aValidationPromises.length-1}t.finally(function(){this._removeValidationPromise(i)}.bind(this))};m.prototype._removeValidationPromise=function(t){this._aValidationPromises[t]=null};m.prototype._getCurrentValidationPromises=function(){var t,e,i=[];for(t=0;t<this._aValidationPromises.length;t++){e=this._aValidationPromises[t];this._removeValidationPromise(t);i.push(e)}return i};m.prototype._isMultiFilterField=function(t){return t.isA("sap.m.MultiInput")};m.prototype._getDisplayBehaviour=function(){return this._isMultiFilterField(this.oControl)?this.sTokenDisplayBehaviour:this.sSingleFieldDisplayBehaviour};m.prototype.setValue=function(t){var e=this.oControl,i=e&&e.getBinding("value"),a=i&&i.getType();if(a&&a.isA("sap.ui.comp.smartfield.type.TextArrangement")){a.setSelectedValue(t)}e.setValue(t)};m.prototype.destroy=function(){e.prototype.destroy.apply(this,arguments);if(this._bCleanupMetadataAnalyser&&this._oMetadataAnalyser){this._oMetadataAnalyser.destroy()}this._oMetadataAnalyser=null;if(this.oBeforeRenderingEventDelegate){this.oControl.removeEventDelegate(this.oBeforeRenderingEventDelegate);delete this.oBeforeRenderingEventDelegate}if(this.oAfterRenderingEventDelegate){this.oControl.removeEventDelegate(this.oAfterRenderingEventDelegate);delete this.oAfterRenderingEventDelegate}this.oControl=null;this.sFieldName=null;this.mFilterInputData=null;this.aFilterField=null;this.sValueListEntitySetName=null;this.oODataModel=null;this.oFilterModel=null;this.oFilterProvider=null;this.oPrimaryValueListAnnotation=null;this.additionalAnnotations=null;this.sDisplayFormat=null;this.bSupportBasicSearch=null;this.bInitialised=null;this._oError=null;this.sValueListTitle=null;this.sKey=null;this._aKeys=null;this.mInParams=null;this.mOutParams=null;this.sDescription=null;this.aSelect=null;this._aCols=null;this._aHighImportanceCols=null;this.sDDLBDisplayBehaviour=null;this.sTokenDisplayBehaviour=null;this._oDateFormatSettings=null;this._oCalendarWeekSettings=null;this._fieldViewMetadata=null;this._oReadPromise=null;this._fBaseValueListProviderResolve=null;this.bIsDestroyed=true;this._aValidationPromises=null};return m});
/*!
 * SAPUI5
 * (c) Copyright 2009-2023 SAP SE. All rights reserved.
 */
sap.ui.predefine("sap/ui/comp/providers/ChartProvider", ["sap/ui/comp/odata/MetadataAnalyser","sap/ui/comp/odata/ChartMetadata","sap/ui/comp/odata/FiscalMetadata","sap/ui/comp/odata/type/FiscalDate","sap/ui/comp/odata/type/CalendarDate","sap/ui/comp/odata/CalendarMetadata","sap/ui/comp/odata/ODataType","./ControlProvider","sap/ui/core/format/DateFormat","sap/ui/core/date/UI5Date"],function(t,e,a,i,n,r,s,o,l,h){"use strict";var d=function(a){this._oRb=sap.ui.getCore().getLibraryResourceBundle("sap.ui.comp");if(a){this._oParentODataModel=a.model;this.sEntitySet=a.entitySet;this._sIgnoredFields=a.ignoredFields;this._bSkipAnnotationParse=a.skipAnnotationParse==="true";this._sChartQualifier=a.chartQualifier;this._sPresentationVariantQualifier=a.presentationVariantQualifier;this._oDefaultDropDownDisplayBehaviour=a.defaultDropDownDisplayBehaviour;this._bUseTimeseries=a.useTimeSeries;this._sNotAssignedText=a.notAssignedText;try{this._oDateFormatSettings=a.dateFormatSettings?JSON.parse(a.dateFormatSettings):undefined;if(!this._oDateFormatSettings.hasOwnProperty("UTC")){this._oDateFormatSettings["UTC"]=true}}catch(t){}if(a.chartLibrary){e.feedWithChartLibrary(a.chartLibrary)}}this._aODataFieldMetadata=[];this._oChartViewMetadata=null;this._oChartDataPointMetadata=null;this._aIgnoredFields=[];this._oMetadataAnalyser=new t(this._oParentODataModel);this._intialiseMetadata()};d.prototype._intialiseMetadata=function(){var t,a=[],i,n,r=0;this._aODataFieldMetadata=this._oMetadataAnalyser.getFieldsByEntitySetName(this.sEntitySet);this._sFullyQualifiedEntityTypeName=this._oMetadataAnalyser.getEntityTypeNameFromEntitySetName(this.sEntitySet);if(!this._bSkipAnnotationParse){this._oPresentationVariant=this._oMetadataAnalyser.getPresentationVariantAnnotation(this._sFullyQualifiedEntityTypeName,this._sPresentationVariantQualifier);if(this._oPresentationVariant&&this._oPresentationVariant.chartAnnotation){this._oChartAnnotation=this._oPresentationVariant.chartAnnotation}else{this._oChartAnnotation=this._oMetadataAnalyser.getChartAnnotation(this._sFullyQualifiedEntityTypeName,this._sChartQualifier)}}if(!this._oDefaultDropDownDisplayBehaviour){this._oDefaultDropDownDisplayBehaviour=this._oMetadataAnalyser.getTextArrangementValue(this._sFullyQualifiedEntityTypeName)}this._generateIgnoredFieldsArray();this._oControlProvider=new o({metadataAnalyser:this._oMetadataAnalyser,model:this._oParentODataModel,fieldsMetadata:this._aODataFieldMetadata,dateFormatSettings:this._oDateFormatSettings,defaultDropDownDisplayBehaviour:this._oDefaultDropDownDisplayBehaviour,enableDescriptions:false,entitySet:this.sEntitySet});if(this._aODataFieldMetadata){this._prepareHierarchy();r=this._aODataFieldMetadata.length}for(n=0;n<r;n++){i=this._aODataFieldMetadata[n];if(this._aIgnoredFields.indexOf(i.name)>-1||!i.visible){continue}if(i.type.indexOf("Edm.")===0){t=this._getFieldViewMetadata(i);this._enrichWithChartViewMetadata(i,t);a.push(i)}}if(this._oChartAnnotation){this._oChartViewMetadata=Object.assign({},this._oChartAnnotation);this._oChartViewMetadata.chartType=e.getChartType(this._oChartViewMetadata.chartType);this._oChartViewMetadata.fields=a}};d.prototype._prepareHierarchy=function(){for(var t=0;t<this._aODataFieldMetadata.length;t++){if(this._aODataFieldMetadata[t].hierarchy){for(var e=0;e<this._aODataFieldMetadata.length;e++){this._aODataFieldMetadata[e].hierarchy=this._aODataFieldMetadata[e].hierarchy||{};this._aODataFieldMetadata[e].hierarchy.up=this._aODataFieldMetadata[e].hierarchy.up||{};if(this._aODataFieldMetadata[t].hierarchy.field===this._aODataFieldMetadata[e].name){this._aODataFieldMetadata[t].hierarchy.down=this._getFieldViewMetadata(this._aODataFieldMetadata[e]);this._aODataFieldMetadata[e].hierarchy.up[this._aODataFieldMetadata[t].hierarchy.type]=this._getFieldViewMetadata(this._aODataFieldMetadata[t])}}}}};d.prototype._setAnnotationMetadata=function(t){if(t&&t.fullName){var e=this._oMetadataAnalyser.getSemanticObjectsFromAnnotation(t.fullName);if(e){t.semanticObjects=e}}};d.prototype._getFieldViewMetadata=function(t){var e=this._oControlProvider.getFieldViewMetadata(t,false);this._setAnnotationMetadata(e);return e};d.prototype._generateIgnoredFieldsArray=function(){if(this._sIgnoredFields){this._aIgnoredFields=this._sIgnoredFields.split(",")}};d.prototype._enrichWithChartViewMetadata=function(e,a){function i(t,e,a){if(e.aggregationRole){return e.aggregationRole===t}if(a){var i=t=="dimension"?a.dimensionFields:a.measureFields;return i&&i.indexOf(e.name)!=-1}return false}e.isMeasure=i("measure",e,this._oChartAnnotation);e.isDimension=i("dimension",e,this._oChartAnnotation);e.isHierarchyDimension=e.hierarchy&&e.hierarchy.type===t.hierarchyType.nodeFor&&i("dimension",e.hierarchy.down,this._oChartAnnotation);e.quickInfo=a.quickInfo;e.modelType=a.modelType;e.hasValueListAnnotation=a.hasValueListAnnotation;e.fullName=a.fullName;e.timeUnitType=this._getTimeUnitType(e);e.dateFormatter=this._getDateFormatter(e);e.isTimeDimension=e.timeUnitType!==undefined;e.role=this._getRole(e);e.hierarchyLevel=this._getHierarchyLevel(e);e.dataPoint=this._getDataPoint(e);e.isNullable=t.isNullable(e);e.filterType=a.filterType;if(a.template){e.template=a.template}if(e.isDimension){e.displayBehaviour=a.displayBehaviour}else if(e.isHierarchyDimension){var n=e.hierarchy.up[t.hierarchyType.nodeExternalKeyFor]||a;e.displayBehaviour=n.displayBehaviour;e.description=n.description||n.name}e.isSemanticObject=a.semanticObjects?true:false;this._setInResult(e);this._setSortOrder(e)};d.prototype._getTimeUnitType=function(t){var e;switch(t.type){case"Edm.Date":e="Date";break;case"Edm.DateTime":case"Edm.DateTimeOffset":if(t.displayFormat==="Date"){e="Date"}break;case"Edm.String":if(a.isFiscalValue(t)){var i=a.getFiscalAnnotationType(t);if(i){var n={IsFiscalWeek:{timeUnitType:undefined},IsFiscalQuarter:{timeUnitType:undefined},IsFiscalPeriod:{timeUnitType:undefined},IsFiscalYearWeek:{timeUnitType:undefined},IsFiscalYearQuarter:{timeUnitType:undefined},IsFiscalYear:{timeUnitType:"fiscalyear"},IsFiscalYearPeriod:{timeUnitType:"fiscalyearperiod"}};e=n[i].timeUnitType;break}}var r=this._getCalendarAnnotationType(t);if(r){var s={IsCalendarYearWeek:{timeUnitType:"yearweek"},IsCalendarYearMonth:{timeUnitType:"yearmonth"},IsCalendarYearQuarter:{timeUnitType:"yearquarter"},IsCalendarWeek:{timeUnitType:undefined},IsCalendarMonth:{timeUnitType:undefined},IsCalendarQuarter:{timeUnitType:undefined},IsCalendarYear:{timeUnitType:undefined},IsCalendarDate:{timeUnitType:"yearmonthday"}};e=s[r].timeUnitType;break}break}return e};d.prototype._getDateFormatter=function(t){var e,a;var i;switch(t.type){case"Edm.Date":a=l.getDateInstance(this._oDateFormatSettings);break;case"Edm.Time":a=l.getTimeInstance(this._oDateFormatSettings);break;case"Edm.DateTimeOffset":case"Edm.DateTime":if(t.type==="Edm.DateTimeOffset"&&t.timezone){a=l.getDateTimeWithTimezoneInstance(this._oDateFormatSettings);break}if(t.displayFormat==="Date"){a=l.getDateInstance(this._oDateFormatSettings)}else{var n=Object.assign({},this._oDateFormatSettings);delete n.UTC;a=l.getDateTimeInstance(n)}break;case"Edm.String":if(r.isDate(t)&&this._oDateFormatSettings){if(!e){var o=s.getType("Edm.String",this._oDateFormatSettings,i,{isCalendarDate:true});e=function(t){return o.formatValue(t,"string")}}}else if(!this._bUseTimeseries){e=this._getDateFormatterForAnnotation(t,i)}break}if(a){e=function(t,e){if(t===""){return this._sNotAssignedText}if(!t){return null}var i=h.getInstance(t);return a.format(i,e)}.bind(this)}return e};d.prototype._getDateFormatterForAnnotation=function(t,e){var o={};var h=null;if(a.isFiscalValue(t)){var d=new i(null,null,{fiscalType:a.getFiscalAnnotationType(t)});h=function(t){if(t==""){return this._sNotAssignedText}return d.formatValue(t,"string")}.bind(this);return h}if(this._oDateFormatSettings){Object.assign(o,this._oDateFormatSettings)}if(r.isCalendarValue(t)){var u=this._getCalendarAnnotationType(t);if(u==="IsCalendarDate"){o.pattern="d MMMM y";var p=s.getType("Edm.String",o,e,{isCalendarDate:true});var y=l.getInstance({pattern:"yyyyMMdd"});h=function(t){if(t==""){return this._sNotAssignedText}var e=y.parse(t);return p.formatValue(e,"string")}.bind(this)}else{var f=new n(null,null,{calendarType:u});h=function(t){if(t==""){return this._sNotAssignedText}return f.formatValue(t,"string")}.bind(this)}return h}return null};d.prototype._getCalendarAnnotationType=function(t){return r.getCalendarAnnotationType(t)||(r.isDate(t)?"IsCalendarDate":undefined)};d.prototype._setInResult=function(t){if(this._oPresentationVariant){if(this._oPresentationVariant.requestAtLeastFields&&this._oPresentationVariant.requestAtLeastFields.indexOf(t.name)>-1){t.inResult=true}}};d.prototype._setSortOrder=function(t){t.sorted=false;t.sortOrder="Ascending";var e;if(this._oPresentationVariant&&this._oPresentationVariant.sortOrderFields){e=this._oPresentationVariant.sortOrderFields.length;for(var a=0;a<e;a++){if(this._oPresentationVariant.sortOrderFields[a].name===t.name){t.sorted=true;t.sortOrder=this._oPresentationVariant.sortOrderFields[a].descending?"Descending":"Ascending";t.sortIndex=a;break}}}};d.prototype._unmarkTextDimensions=function(t,e){var a,i;for(a=0;a<t.length;a++){i=t[a];if(i.isDimension){if(e.indexOf(i.name)>-1){i.isDimension=false}}}};d.prototype._getRole=function(t){if(this._oChartAnnotation){if((t.isDimension||t.isHierarchyDimension)&&this._oChartAnnotation.dimensionAttributes[t.name]){return e.getDimensionRole(this._oChartAnnotation.dimensionAttributes[t.name].role)}else if(t.isMeasure&&this._oChartAnnotation.measureAttributes[t.name]){return e.getMeasureRole(this._oChartAnnotation.measureAttributes[t.name].role)}}};d.prototype._getHierarchyLevel=function(t){if(this._oChartAnnotation){if(t.isHierarchyDimension&&this._oChartAnnotation.dimensionAttributes[t.name]){var e=null;try{e=parseInt(this._oChartAnnotation.dimensionAttributes[t.name].hierarchyLevel)}catch(t){e=0}return e}return 0}};d.prototype._getTextPropertyForHierachyDimension=function(e){var a=e.hierarchy.up[t.hierarchyType.nodeExternalKeyFor]||e;return a.description||a.name};d.prototype._getDataPoint=function(t){if(this._oChartAnnotation&&t.isMeasure&&this._oChartAnnotation.measureAttributes[t.name]&&this._oChartAnnotation.measureAttributes[t.name].dataPoint){var e=this._oChartAnnotation.measureAttributes[t.name].dataPoint;var a=e.split("#");var i=a.length===2?a[1]:"";return this._getMeasureDataPoint(i,t.name)}return null};d.prototype.getChartViewMetadata=function(){return this._oChartViewMetadata};d.prototype.getViewField=function(t){var e=this._oChartViewMetadata.fields.filter(function(e){return e.name===t})[0];return e};d.prototype.getChartDataPointMetadata=function(){if(!this._oChartDataPointMetadata&&this._sFullyQualifiedEntityTypeName){this._oChartDataPointMetadata=this._oMetadataAnalyser.getDataPointAnnotation(this._sFullyQualifiedEntityTypeName)}return this._oChartDataPointMetadata};d.prototype._getMeasureDataPoint=function(t,e){var a=this.getChartDataPointMetadata();if(a){var i=null;if(t){if(a.additionalAnnotations){i=a.additionalAnnotations[t]}}else if(a.primaryAnnotation){i=a.primaryAnnotation}if(i!=null&&i.Value&&i.Value.Path==e){return i}}return null};d.prototype.getIsUTCDateHandlingEnabled=function(){return this._oDateFormatSettings?this._oDateFormatSettings.UTC:false};d.prototype.destroy=function(){if(this._oMetadataAnalyser&&this._oMetadataAnalyser.destroy){this._oMetadataAnalyser.destroy()}this._oMetadataAnalyser=null;if(this._oControlProvider&&this._oControlProvider.destroy){this._oControlProvider.destroy()}this._oControlProvider=null;this._aODataFieldMetadata=null;this._oChartViewMetadata=null;this._oChartDataPointMetadata=null;this._sIgnoredFields=null;this.bIsDestroyed=true};d.prototype.provideSemanticColoring=function(t){var a={};if(t.Criticality){if(t.Criticality.Path){a={Calculated:t.Criticality.Path}}else{a={Static:e.getCriticalityType(t.Criticality.EnumMember)}}}else{var i={};var n=this._buildThresholds(i,t.CriticalityCalculation);if(n){a={ConstantThresholds:i}}else{a={DynamicThresholds:i}}}return a};d.prototype.calculateDimensionColoring=function(t){var a=e.getValueCriticality(t);if(!a){return null}var i,n,r={Positive:{Values:[]},Critical:{Values:[]},Negative:{Values:[]},Neutral:{Values:[]}};for(var s=0;s<a.length;s++){n=a[s];i=e.calculateValue(n.Value);if(n.Criticality.EnumMember.endsWith("Positive")){r.Positive.Values.push(i)}else if(n.Criticality.EnumMember.endsWith("Critical")){r.Critical.Values.push(i)}else if(n.Criticality.EnumMember.endsWith("Negative")){r.Negative.Values.push(i)}else{r.Neutral.Values.push(i)}}return r};d.prototype._buildThresholds=function(t,a){var i=true;t.ImprovementDirection=e.getImprovementDirectionType(a.ImprovementDirection.EnumMember);var n=e.getCriticalityThresholds();var r=n.length;var s={oneSupplied:false};var o={oneSupplied:false};for(var l=0;l<r;l++){s[n[l]]=a[n[l]]?a[n[l]].Path:undefined;s.oneSupplied=s.oneSupplied||s[n[l]];if(!s.oneSupplied){o[n[l]]=e.calculateConstantValue(a[n[l]]);o.oneSupplied=o.oneSupplied||o[n[l]]}}if(s.oneSupplied){i=false;for(var l=0;l<r;l++){if(s[n[l]]){t[n[l]]=s[n[l]]}}}else{var h;t.AggregationLevels=[];if(o.oneSupplied){h={VisibleDimensions:null};for(var l=0;l<r;l++){if(o[n[l]]){h[n[l]]=o[n[l]]}}t.AggregationLevels.push(h)}if(a.ConstantThresholds&&a.ConstantThresholds.length>0){for(var l=0;l<a.ConstantThresholds.length;l++){var d=a.ConstantThresholds[l];var u=d.AggregationLevel?[]:null;if(d.AggregationLevel&&d.AggregationLevel.length>0){for(var p=0;p<d.AggregationLevel.length;p++){u.push(d.AggregationLevel[p].PropertyPath)}}h={VisibleDimensions:u};for(var p=0;p<r;p++){var y=e.calculateConstantValue(d[n[p]]);if(y){h[n[p]]=y}}t.AggregationLevels.push(h)}}}return i};d.prototype.getMaxItems=function(){var t=-1;if(this._oPresentationVariant&&this._oPresentationVariant.maxItems){t=this._oPresentationVariant.maxItems}return t};d.prototype.getIgnoredChartTypesForTimeSeries=function(){return e.getIgnoredChartTypesForTimeSeries()};return d},true);
/*!
 * SAPUI5
 * (c) Copyright 2009-2023 SAP SE. All rights reserved.
 */
sap.ui.predefine("sap/ui/comp/providers/ControlProvider", ["sap/m/CheckBox","sap/m/DatePicker","sap/m/TimePicker","sap/m/HBox","sap/m/Input","sap/m/Text","sap/m/ObjectIdentifier","sap/m/ObjectStatus","sap/m/Image","sap/m/Link","sap/m/VBox","sap/m/FlexItemData","sap/m/library","sap/ui/comp/navpopover/SmartLink","sap/ui/comp/odata/MetadataAnalyser","sap/ui/comp/smartfield/ODataHelper","sap/ui/comp/smartfield/SmartField","sap/ui/comp/odata/ODataType","sap/ui/comp/odata/FiscalMetadata","sap/ui/comp/odata/CalendarMetadata","sap/ui/comp/odata/CriticalityMetadata","sap/ui/comp/util/FormatUtil","sap/ui/comp/util/MultiUnitUtil","sap/ui/core/Control","sap/ui/comp/navpopover/SemanticObjectController","sap/ui/comp/navpopover/NavigationPopoverHandler","./ValueHelpProvider","./ValueListProvider","sap/ui/comp/library","sap/base/Log"],function(e,t,i,a,n,r,s,o,l,p,d,c,u,m,h,y,f,g,_,b,T,C,S,D,v,F,O,A,M,I){"use strict";var P;var x=function(e){if(e){this._oParentODataModel=e.model;this._oMetadataAnalyser=e.metadataAnalyser;this._aODataFieldMetadata=e.fieldsMetadata;this._oLineItemAnnotation=e.lineItemAnnotation;this._oSemanticKeyAnnotation=e.semanticKeyAnnotation;this._smartTableId=e.smartTableId;this._bProcessDataFieldDefault=e.processDataFieldDefault;this._isAnalyticalTable=e.isAnalyticalTable;this._isMobileTable=e.isMobileTable;this._oDateFormatSettings=e.dateFormatSettings;this._useUTCDateTime=e.useUTCDateTime;this._bEnableDescriptions=e.enableDescriptions;this._oCurrencyFormatSettings=e.currencyFormatSettings;this._oDefaultDropDownDisplayBehaviour=e.defaultDropDownDisplayBehaviour||"descriptionAndId";this.useSmartField=e.useSmartField==="true";this.useSmartToggle=e.useSmartToggle==="true";this.defaultFilterBarExpanded=e.defaultFilterBarExpanded;this.defaultShowAllFilters=e.defaultShowAllFilters;this._sEntitySet=e.entitySet;this._oSemanticKeyAdditionalControl=e._semanticKeyAdditionalControl;this._oSemanticObjectController=e.semanticObjectController;this._bPreserveDecimals=e.preserveDecimals;this._oCustomizeConfigTextInEditModeSource=e.textInEditModeSource;this._oCustomizeConfigIgnoreInsertRestrictions=e.ignoreInsertRestrictions;this._oCustomizeConfigClientSideMandatoryCheck=e.clientSideMandatoryCheck}if(!this._oMetadataAnalyser&&this._oParentODataModel){this._oMetadataAnalyser=new h(this._oParentODataModel);this._intialiseMetadata()}this._mSmartField={};this._oHelper=new y(this._oMetadataAnalyser.oModel,null,null,true);this._aValueListProvider=[];this._aValueHelpProvider=[];this._aLinkHandlers=[]};x.prototype._intialiseMetadata=function(){if(!this._aODataFieldMetadata){this._aODataFieldMetadata=this._oMetadataAnalyser.getFieldsByEntitySetName(this.sEntity)}};x.prototype.getFieldViewMetadata=function(e,t){var i=this._createFieldMetadata(e);this._createFieldTemplate(i,t);return i};x.prototype._getTextInEditModeSource=function(e){if(!this._oCustomizeConfigTextInEditModeSource){return M.smartfield.TextInEditModeSource.None}return this._oCustomizeConfigTextInEditModeSource[e.name]||this._oCustomizeConfigTextInEditModeSource["*"]||M.smartfield.TextInEditModeSource.None};x.prototype._getIgnoreInsertRestrictions=function(e){if(!this._oCustomizeConfigIgnoreInsertRestrictions){return false}if(this._oCustomizeConfigIgnoreInsertRestrictions.hasOwnProperty(e.name)){return this._oCustomizeConfigIgnoreInsertRestrictions[e.name]}return this._oCustomizeConfigIgnoreInsertRestrictions["*"]||false};x.prototype._getClientSideMandatoryCheck=function(e){if(!this._oCustomizeConfigClientSideMandatoryCheck){return true}if(this._oCustomizeConfigClientSideMandatoryCheck.hasOwnProperty(e.name)){return this._oCustomizeConfigClientSideMandatoryCheck[e.name]}return this._oCustomizeConfigClientSideMandatoryCheck["*"]||false};x.prototype._createFieldTemplate=function(e,t){if(this.useSmartField){e.template=new f({textInEditModeSource:this._getTextInEditModeSource(e),value:{path:e.name},entitySet:this._sEntitySet,contextEditable:{path:"sm4rtM0d3l>/editable",mode:"OneWay"},controlContext:this._isMobileTable?"responsiveTable":"table",wrapping:this._isMobileTable,clientSideMandatoryCheck:this._getClientSideMandatoryCheck(e)});if(g.isNumeric(e.type)||g.isDateOrTime(e.type)||b.isCalendarValue(e)||_.isFiscalValue(e)){e.template.setTextAlign("Right");e.template.setWidth("100%")}this._completeSmartField(e);e.template._setPendingEditState(t)}if(this.useSmartToggle){e.template=new P({editable:{path:"sm4rtM0d3l>/editable",mode:"OneWay"},edit:this.useSmartField?e.template:this._createEditableTemplate(e),display:this._createDisplayOnlyTemplate(e)})}else if(!this.useSmartField){e.template=t?this._createEditableTemplate(e):this._createDisplayOnlyTemplate(e)}};x.prototype._addCustomDataToConfigData=function(e,t,i,a){if(e==="true"||e==="false"){i[a]=e}else if(typeof e==="object"&&e!==null&&e[t.name]){i[a]=e[t.name]}};x.prototype._completeSmartField=function(e){var t,i,a={annotations:{},path:e.name,ignoreInsertRestrictions:this._getIgnoreInsertRestrictions(e)};if(!this._mSmartField.entitySetObject){this._mSmartField.entitySetObject=this._oHelper.oMeta.getODataEntitySet(this._sEntitySet);this._mSmartField.entityType=this._oHelper.oMeta.getODataEntityType(this._mSmartField.entitySetObject.entityType)}a.modelObject=this._oParentODataModel;a.entitySetObject=this._mSmartField.entitySetObject;a.entitySet=this._mSmartField.entitySetObject;a.entityType=this._mSmartField.entityType;this._oHelper.getProperty(a);e.fieldControlProperty=this._oHelper.oAnnotation.getFieldControlPath(a.property.property);if(e.fieldControlProperty&&e.parentPropertyName){e.fieldControlProperty=e.parentPropertyName+"/"+e.fieldControlProperty}a.annotations.uom=this._oHelper.getUnitOfMeasure2(a);a.annotations.text=this._oHelper.getTextProperty2(a);a.annotations.lineitem=this._oLineItemAnnotation;a.annotations.semantic=h.getSemanticObjectsFromProperty(a.property.property);this._oHelper.getUOMTextAnnotation(a);if(a.property.property["sap:value-list"]||a.property.property["com.sap.vocabularies.Common.v1.ValueList"]){a.annotations.valuelist=this._oHelper.getValueListAnnotationPath(a);if(a.property.property["sap:value-list"]){a.annotations.valuelistType=a.property.property["sap:value-list"]}else{a.annotations.valuelistType=this._oMetadataAnalyser.getValueListSemantics(a.property.property["com.sap.vocabularies.Common.v1.ValueList"])}}if(a.property.property["com.sap.vocabularies.Common.v1.ValueListWithFixedValues"]){a.annotations.valuelistType=h.getValueListMode(a.property.property)}this._oHelper.getUOMValueListAnnotationPath(a);delete a.entitySet;if(this.defaultFilterBarExpanded){this._addCustomDataToConfigData(this.defaultFilterBarExpanded,e,a,"defaultFilterBarExpanded")}if(this.defaultShowAllFilters){this._addCustomDataToConfigData(this.defaultShowAllFilters,e,a,"defaultShowAllFilters")}if(a.annotations.valuelist!==undefined){if(e.template.getTextInEditModeSource()!=="None"){i=function(){if(t===undefined){t=this._oHelper.getAnalyzer().getValueListAnnotationLazy(a.annotations.valuelist)}return t}.bind(this)}}else{e.template.setTextInEditModeSource("None")}e.template.data("configdata",{configdata:a,configdataVL:i});e.template.data("dateFormatSettings",this._oDateFormatSettings);e.template.data("currencyFormatSettings",this._oCurrencyFormatSettings);e.template.data("defaultDropDownDisplayBehaviour",this._oDefaultDropDownDisplayBehaviour);e.template.data("defaultInputFieldDisplayBehaviour",e.displayBehaviour);if(a.annotations.uom||g.isNumeric(e.type)||g.isDateOrTime(e.type)||b.isCalendarValue(e)||_.isFiscalValue(e)){var n=e.template.getTextAlign();if(n==="Initial"){n="Right"}if(g.isNumeric(e.type)&&!e.unit&&e.description&&e.displayBehaviour!=="idOnly"){n=undefined}e.align=n}x._createModelTypeInstance(e,this._oDateFormatSettings,this._useUTCDateTime,this._bPreserveDecimals)};x.prototype._createEditableTemplate=function(a,r){var s=null,o=x._createModelTypeInstance(a,this._oDateFormatSettings,this._useUTCDateTime,this._bPreserveDecimals);var l=a.type==="Edm.DateTime"&&a.displayFormat==="Date";if(l||a.isCalendarDate){s=new t({value:{path:a.name,type:o}})}else if(a.type==="Edm.Boolean"){s=new e({selected:{path:a.name}})}if(a.semanticObjects&&!r){s=this._createSmartLinkFieldTemplate(a,o,function(){return this._createEditableTemplate(a,true)}.bind(this))}if(!s){if(a.type==="Edm.Time"){s=new i({value:{path:a.name,type:o}})}else if(a.type==="Edm.String"&&a.isTimezone){s=new n({value:this._getDefaultBindingInfo(a,o)})}else{s=new n({value:{path:a.name,type:o}});if(a.unit){s.bindProperty("description",{path:a.unit});s.setTextAlign("Right");s.setTextDirection("LTR");s.setFieldWidth("80%")}else if(this._bEnableDescriptions&&a.description){s.bindProperty("description",{path:a.description})}else if(g.isNumeric(a.type)||g.isDateOrTime(a.type)||b.isCalendarValue(a)||_.isFiscalValue(a)){a.align="Right";s.setTextAlign("Right");s.setTextDirection("LTR");if(a.timezone){s.bindProperty("description",{path:a.timezone})}}if(a.hasValueListAnnotation){this._associateValueHelpAndSuggest(s,a)}}}return s};x.prototype._associateValueHelpAndSuggest=function(e,t){e.setShowValueHelp(true);this._aValueHelpProvider.push(new O({fieldName:t.fieldName,control:e,model:this._oParentODataModel,dateFormatSettings:this._oDateFormatSettings,displayFormat:t.displayFormat,displayBehaviour:t.displayBehaviour,loadAnnotation:true,fullyQualifiedFieldName:t.fullName,metadataAnalyser:this._oMetadataAnalyser,title:t.label,preventInitialDataFetchInValueHelpDialog:true,takeOverInputValue:false,type:t.type,maxLength:t.maxLength}));e.setShowSuggestion(true);e.setFilterSuggests(false);this._aValueListProvider.push(new A({fieldName:t.fieldName,control:e,model:this._oParentODataModel,displayFormat:t.displayFormat,dateFormatSettings:this._oDateFormatSettings,displayBehaviour:t.displayBehaviour,loadAnnotation:true,fullyQualifiedFieldName:t.fullName,metadataAnalyser:this._oMetadataAnalyser,aggregation:"suggestionRows",typeAheadEnabled:true}))};x.prototype._createDisplayOnlyTemplate=function(e,t){var i=null,a=null,n,s,o;a=x._createModelTypeInstance(e,this._oDateFormatSettings,this._useUTCDateTime,this._bPreserveDecimals);if(g.isNumeric(e.type)||g.isDateOrTime(e.type)||b.isCalendarValue(e)||_.isFiscalValue(e)){n="Right";if(g.isNumeric(e.type)&&!e.unit&&e.description&&e.displayBehaviour!=="idOnly"){n=undefined}}if(e.urlInfo){i=this._createLink(e,a,e.urlInfo)}else if(e.criticalityInfo){i=this._createObjectStatusTemplate(e,a,e.criticalityInfo)}if(this._isMobileTable&&!i){if(e.isImageURL){i=new l({src:{path:e.name},width:"3em",height:"3em"})}else{o=x._getSemanticKeyIndex(e,this._oSemanticKeyAnnotation);if(o>-1){i=this._createObjectIdentifierTemplate(e,a,o===0)}}}if(!i){if(e.semanticObjects&&!t){i=this._createSmartLinkFieldTemplate(e,a,function(){return this._createDisplayOnlyTemplate(e,true)}.bind(this))}else if(e.unit){i=this._createMeasureFieldTemplate(e,a)}else if(e.isEmailAddress||e.isPhoneNumber){i=this._createEmailOrPhoneLink(e,a)}else{s=this._getDefaultBindingInfo(e,a,true);i=new r({wrapping:this._isMobileTable,textAlign:n,text:s})}}e.align=n;return i};x._getSemanticKeyIndex=function(e,t){var i=-1,a;if(t&&t.semanticKeyFields){i=t.semanticKeyFields.indexOf(e.name);if(i<0){a=h.resolveEditableFieldFor(e);i=a?t.semanticKeyFields.indexOf(a):-1}}return i};x._createModelTypeInstance=function(e,t,i,a){var n,r,s={};var o=e.type==="Edm.DateTime"&&e.displayFormat==="Date";if(o||e.isCalendarDate){n=t;r={displayFormat:"Date"}}else if(e.type==="Edm.DateTime"&&i){n={UTC:true}}else if(e.type==="Edm.Decimal"){r={precision:e.precision,scale:e.scale};n={preserveDecimals:a}}else if(e.type==="Edm.String"){r={isDigitSequence:e.isDigitSequence}}if(e.isCalendarDate){s.isCalendarDate=true}if(e.isCalendarType&&!e.isCalendarDate){s.isCalendarType=true;s.calendarType=b.getCalendarAnnotationType(e)}if(e.isFiscalDate){s.isFiscalDate=true;s.fiscalType=_.getFiscalAnnotationType(e)}if(e.isTimezone){s.isTimezone=true;n={showDate:false,showTime:false}}r=Object.assign({},r,{maxLength:e.maxLength});if(e.type=="Edm.DateTime"&&(e.isFiscalDate||e.isCalendarType)){I.error("Unexpected configuration for Edm.DateTime")}if(e.type=="Edm.DateTime"&&!e.isFiscalDate&&!e.isCalendarType){e.modelType=g.getType(e.type,n,r,s);e.modelType.formatValue(new Date,"string");e.modelType.oFormat.oFormatOptions.UTC=false;return g.getType(e.type,n,r,s)}e.modelType=g.getType(e.type,n,r,s);return e.modelType};x.prototype.createModelTypeInstance=function(e){return x._createModelTypeInstance(e,this._oDateFormatSettings,this._useUTCDateTime,this._bPreserveDecimals)};x.prototype._createEmailOrPhoneLink=function(e,t){var i=new p({text:this._getDefaultBindingInfo(e,t,true),wrapping:this._isMobileTable,press:function(t){var i=t.getSource().getText();if(e.isEmailAddress){u.URLHelper.triggerEmail(i)}else if(e.isPhoneNumber){u.URLHelper.triggerTel(i)}}});return i};x.prototype._getDefaultBindingInfo=function(e,t,i){var a={path:e.name,type:t,formatter:C.getWhitespaceReplacer(i)};if(e.type==="Edm.DateTimeOffset"&&e.timezone){a={parts:[{path:e.name,type:t},{path:e.timezone}],formatter:C.getDateTimeWithTimezoneFormatter(),useRawValues:true}}else if(e.type==="Edm.String"&&e.isTimezone){a={parts:[{value:null},{path:e.name}],type:t}}else if(this._bEnableDescriptions&&e.description){a={parts:[{path:e.name,type:t},{path:e.description}],formatter:C.getFormatterFunctionFromDisplayBehaviour(e.displayBehaviour,i)};if(t&&t.getName()==="sap.ui.comp.odata.type.NumericText"&&this._bEnableDescriptions&&e.description){var n=a.formatter;a.formatter=function(e,t,i){if(e===null&&t){e=""}return n(e,t,i)}}}return a};x.prototype._createLink=function(e,t,i){var a=null;e.linkProperties=i.parameters||i.urlPath;if(i.urlPath){a={path:i.urlPath}}else if(i.urlTarget){a=i.urlTarget}return new p({text:this._getDefaultBindingInfo(e,t,true),wrapping:this._isMobileTable,href:a})};x.prototype._createObjectIdentifierTemplate=function(e,t,i){var a,n,r,o,l,p;var c=this;var u=function(e){return e.startsWith("{")&&e.endsWith("}")};var m=function(e){return e.replace("{","").replace("}","")};var h=function(t,i){var a=e.semanticObjects.additionalSemanticObjects;if(c._oSemanticObjectController&&c._oSemanticObjectController.getForceLinkRendering()&&c._oSemanticObjectController.getForceLinkRendering()[e.name]){return true}i=i?i:e.semanticObjects.defaultSemanticObject;return v.hasDistinctSemanticObject(a.concat(i),t)};if(e.semanticObjects){v.getDistinctSemanticObjects().then(function(t){if(u(e.semanticObjects.defaultSemanticObject)||h(t)){p=new F({semanticObject:e.semanticObjects.defaultSemanticObject,additionalSemanticObjects:e.semanticObjects.additionalSemanticObjects,fieldName:e.name,semanticObjectController:c._oSemanticObjectController,navigationTargetsObtained:function(e){var t=sap.ui.getCore().byId(e.getSource().getControl());var i=e.getParameters().mainNavigation;if(i){i.setDescription(t.getText())}e.getParameters().show(t.getTitle(),i,undefined,undefined)}});c._aLinkHandlers.push(p)}})}if(e.description){switch(e.displayBehaviour){case"descriptionAndId":e.vertical=true;n=e.description;r=e.name;o=t;break;case"idAndDescription":e.vertical=true;n=e.name;r=e.description;l=t;break;case"idOnly":n=e.name;o=t;break;default:n=e.description;break}}else{n=e.name;l=t}a=new s({title:n?{path:n,type:l,formatter:C.getWhitespaceReplacer(true)}:undefined,text:r?{path:r,type:o,formatter:C.getWhitespaceReplacer(true)}:undefined,titleActive:e.semanticObjects?{parts:u(e.semanticObjects.defaultSemanticObject)?[{path:"$sapuicompcontrolprovider_distinctSO>/distinctSemanticObjects"},{path:m(e.semanticObjects.defaultSemanticObject)}]:[{path:"$sapuicompcontrolprovider_distinctSO>/distinctSemanticObjects"}],formatter:function(e,t){return h(e,t)}}:false,titlePress:function(e){if(p){p.setControl(e.getSource());p.setBindingContext(e.getSource().getBindingContext());p.openPopover(e.getParameter("domRef"))}}});a.attachEvent("ObjectIdentifier.designtime",function(e){if(p){p.setControl(e.getSource());e.getParameters().registerNavigationPopoverHandler(p)}});a.setModel(v.getJSONModel(),"$sapuicompcontrolprovider_distinctSO");if(this._oSemanticKeyAdditionalControl&&i){this._bSemanticKeyAdditionalControlUsed=true;return new d({renderType:"Bare",items:[a,this._oSemanticKeyAdditionalControl]}).addStyleClass("sapUiTinyMarginTopBottom")}return a};x.prototype._createObjectStatusTemplate=function(e,t,i){var a,n,r,s;r=T.getShowCriticalityIcon(i.criticalityRepresentationType);if(i.path){e.criticality=i.path;a={path:i.path,formatter:T.getCriticalityState};if(i.criticalityRepresentationPath){e.criticalityRepresentation=i.criticalityRepresentationPath;n={parts:[{path:i.path},{path:i.criticalityRepresentationPath}],formatter:function(e,t){return T.getShowCriticalityIcon(t)?T.getCriticalityIcon(e):undefined}}}else if(r){n={path:i.path,formatter:T.getCriticalityIcon}}}else{a=T.getCriticalityState(i.criticalityType);if(i.criticalityRepresentationPath){e.criticalityRepresentation=i.criticalityRepresentationPath;n={path:i.criticalityRepresentationPath,formatter:function(e){return T.getShowCriticalityIcon(e)?T.getCriticalityIcon(i.criticalityType):undefined}}}else if(r){n=T.getCriticalityIcon(i.criticalityType)}}if(e.unit){s={parts:[{path:e.name,type:t},{path:e.unit},{mode:"OneTime",path:e.isCurrencyField?"/##@@requestCurrencyCodes":"/##@@requestUnitsOfMeasure",targetType:"any"}],formatter:e.isCurrencyField?C.getInlineAmountFormatter(this._bPreserveDecimals):C.getInlineMeasureUnitFormatter(this._bPreserveDecimals),useRawValues:true}}else{s=this._getDefaultBindingInfo(e,t,true)}return new o({text:s,state:a,icon:n})};x.prototype._createSmartLinkFieldTemplate=function(e,t,i){var a=e.unit?{parts:[{path:e.name,type:t},{path:e.unit},{mode:"OneTime",path:e.isCurrencyField?"/##@@requestCurrencyCodes":"/##@@requestUnitsOfMeasure",targetType:"any"}],formatter:e.isCurrencyField?C.getAmountCurrencyFormatter(this._bPreserveDecimals):C.getMeasureUnitFormatter(this._bPreserveDecimals,e.scale),useRawValues:true}:this._getDefaultBindingInfo(e,t,true);var n=new m({semanticObject:e.semanticObjects.defaultSemanticObject,additionalSemanticObjects:e.semanticObjects.additionalSemanticObjects,fieldName:e.name,text:a,uom:e.unit?{path:e.unit}:undefined,wrapping:this._isMobileTable,beforeNavigationCallback:this._oSemanticObjectController?this._oSemanticObjectController.getBeforeNavigationCallback():undefined,navigationTargetsObtained:function(t){var i=this.getBinding("text");if(!i||!Array.isArray(i.getValue())||e.unit){t.getParameters().show();return}var a=i.getValue();var n=C.getTextsFromDisplayBehaviour(e.displayBehaviour,a[0],a[1]);var r=t.getParameters().mainNavigation;if(r){r.setDescription(n.secondText)}t.getParameters().show(n.firstText,r,undefined,undefined)}});n.setSemanticObjectController(this._oSemanticObjectController);n.setCreateControlCallback(i);return n};x.prototype._createMeasureFieldTemplate=function(e,t){var i,n,s,o,l,u=false;u=!!(e.isCurrencyField&&this._oCurrencyFormatSettings&&this._oCurrencyFormatSettings.showCurrencySymbol);o=new r({layoutData:this._isMobileTable?undefined:new c({growFactor:1,baseSize:"0%"}),textDirection:"LTR",wrapping:false,textAlign:"End",text:{parts:[{path:e.name,type:t},{path:e.unit},{mode:"OneTime",path:e.isCurrencyField?"/##@@requestCurrencyCodes":"/##@@requestUnitsOfMeasure",targetType:"any"}],formatter:e.isCurrencyField?C.getAmountCurrencyFormatter(this._bPreserveDecimals):C.getMeasureUnitFormatter(this._bPreserveDecimals,e.scale),useRawValues:true}}).addStyleClass("sapUiCompCurrency").addStyleClass("sapUiCompCurrencyTabNums");l=new r({layoutData:new c({shrinkFactor:0}),textDirection:"LTR",wrapping:false,textAlign:"End",width:"3em",text:{path:e.unit,formatter:u?C.getCurrencySymbolFormatter():undefined}}).addStyleClass("sapUiCompUoMPart").addStyleClass("sapUiCompCurrencyMonoFont");i=new a({renderType:"Bare",justifyContent:"End",wrap:this._isMobileTable?"Wrap":undefined,items:[o,l]});i.addStyleClass("sapUiCompDirectionLTR");if(this._isAnalyticalTable){s=i;s.bindProperty("visible",{path:e.unit,formatter:S.isNotMultiUnit});n=new p({text:sap.ui.getCore().getLibraryResourceBundle("sap.ui.comp").getText("SMARTTABLE_MULTI_LINK_TEXT")||"Show Details",visible:{path:e.unit,formatter:S.isMultiUnit},press:[{value:e.name,unit:e.unit,additionalParent:this.useSmartToggle,smartTableId:this._smartTableId,template:s},S.openMultiUnitPopover]});i=new d({renderType:"Bare",items:[n,s]})}return i};x.prototype._createFieldMetadata=function(e){var t=Object.assign({},e);t.label=e.fieldLabel||e.name;t.quickInfo=e.quickInfo;t.displayBehaviour=t.displayBehaviour||this._oDefaultDropDownDisplayBehaviour;t.filterType=this._getFilterType(e);this._updateValueListMetadata(t);this._setAnnotationMetadata(t);if(this._oLineItemAnnotation&&this._oLineItemAnnotation.fields&&this._oLineItemAnnotation.fields.indexOf(e.name)>-1){t.urlInfo=this._oLineItemAnnotation.urlInfo&&this._oLineItemAnnotation.urlInfo[e.name];t.criticalityInfo=this._oLineItemAnnotation.criticality&&this._oLineItemAnnotation.criticality[e.name]}else if(this._bProcessDataFieldDefault){this._oMetadataAnalyser.updateDataFieldDefault(t)}return t};x.prototype._updateValueListMetadata=function(e){e.hasValueListAnnotation=e["sap:value-list"]!==undefined;if(e.hasValueListAnnotation){e.hasFixedValues=e["sap:value-list"]==="fixed-values"}else if(e["com.sap.vocabularies.Common.v1.ValueList"]){e.hasValueListAnnotation=true;e.hasFixedValues=this._oMetadataAnalyser.getValueListSemantics(e["com.sap.vocabularies.Common.v1.ValueList"])==="fixed-values";if(!e.hasFixedValues){e.hasFixedValues=h.isValueListWithFixedValues(e)}}};x.prototype._setAnnotationMetadata=function(e){if(e&&e.fullName){e.semanticObjects=this._oMetadataAnalyser.getSemanticObjectsFromAnnotation(e.fullName)}};x.prototype._getFilterType=function(e){return C._getFilterType(e)};x.prototype.destroy=function(){var e=function(e){var t;if(e){t=e.length;while(t--){e[t].destroy()}}};if(this._oMetadataAnalyser&&this._oMetadataAnalyser.destroy){this._oMetadataAnalyser.destroy()}this._oMetadataAnalyser=null;if(!this._bSemanticKeyAdditionalControlUsed&&this._oSemanticKeyAdditionalControl&&this._oSemanticKeyAdditionalControl.destroy){this._oSemanticKeyAdditionalControl.destroy()}e(this._aValueHelpProvider);this._aValueHelpProvider=null;e(this._aValueListProvider);this._aValueListProvider=null;e(this._aLinkHandlers);this._aLinkHandlers=null;if(this._oHelper){this._oHelper.destroy()}this._oHelper=null;this._mSmartField=null;this._aODataFieldMetadata=null;this._oDateFormatSettings=null;this._oCurrencyFormatSettings=null;this._oDefaultDropDownDisplayBehaviour=null;this._oLineItemAnnotation=null;this._oSemanticKeyAnnotation=null;this._oParentODataModel=null;this.bIsDestroyed=true};P=D.extend("sap.ui.comp.SmartToggle",{metadata:{library:"sap.ui.comp",properties:{editable:{type:"boolean",defaultValue:false}},aggregations:{edit:{type:"sap.ui.core.Control",multiple:false},display:{type:"sap.ui.core.Control",multiple:false}},associations:{ariaLabelledBy:{type:"sap.ui.core.Control",multiple:true,singularName:"ariaLabelledBy"}}},renderer:{apiVersion:2,render:function(e,t){e.openStart("span",t).class("sapUiCompSmartToggle").openEnd();e.renderControl(t.getEditable()?t.getEdit():t.getDisplay());e.close("span")}}});P.prototype.getFocusDomRef=function(){var e=this.getEditable()?this.getEdit():this.getDisplay();if(e){return e.getFocusDomRef()}return D.prototype.getFocusDomRef.call(this)};P.prototype.getAccessibilityInfo=function(){var e=this.getEditable()?this.getEdit():this.getDisplay();if(e&&e.getVisible()&&e.getAccessibilityInfo){return e.getAccessibilityInfo()}return null};P.prototype.addAssociation=function(e,t,i){if(e==="ariaLabelledBy"){var a=this.getEdit(),n=this.getDisplay();a&&a.addAssociation(e,t,i);n&&n.addAssociation(e,t,i)}return D.prototype.addAssociation.apply(this,arguments)};P.prototype.removeAssociation=function(e,t,i){if(e==="ariaLabelledBy"){var a=this.getEdit(),n=this.getDisplay();a&&a.removeAssociation(e,t,i);n&&n.removeAssociation(e,t,i)}return D.prototype.removeAssociation.apply(this,arguments)};P.prototype.removeAllAssociation=function(e,t){if(e==="ariaLabelledBy"){var i=this.getEdit(),a=this.getDisplay();i&&i.removeAllAssociation(e,t);a&&a.removeAllAssociation(e,t)}return D.prototype.removeAllAssociation.apply(this,arguments)};return x},true);
/*!
 * SAPUI5
 * (c) Copyright 2009-2023 SAP SE. All rights reserved.
 */
sap.ui.predefine("sap/ui/comp/providers/TableProvider", ["sap/ui/comp/odata/MetadataAnalyser","./ControlProvider","sap/ui/comp/util/FormatUtil","sap/ui/Device","sap/ui/comp/odata/FiscalMetadata","sap/ui/comp/odata/CalendarMetadata"],function(t,e,i,a,n,o){"use strict";var s=function(e){if(e){this._oParentODataModel=e.model;this.sEntitySet=e.entitySet;this._sIgnoredFields=e.ignoredFields;this._sInitiallyVisibleFields=e.initiallyVisibleFields;this.isEditableTable=e.isEditableTable;this._smartTableId=e.smartTableId;this._isAnalyticalTable=e.isAnalyticalTable;this._isMobileTable=e.isMobileTable;this.useSmartField=e.useSmartField;this.useSmartToggle=e.useSmartToggle;this.defaultFilterBarExpanded=e.defaultFilterBarExpanded;this.defaultShowAllFilters=e.defaultShowAllFilters;this.useUTCDateTime=e.useUTCDateTime==="true";this._bSkipAnnotationParse=e.skipAnnotationParse==="true";this._sLineItemQualifier=e.lineItemQualifier;this._sPresentationVariantQualifier=e.presentationVariantQualifier;this.enableInResultForLineItem=e.enableInResultForLineItem==="true";this._oSemanticKeyAdditionalControl=e._semanticKeyAdditionalControl;this._bShowDetailsButton=e.showDetailsButton;this._bEnableAutoColumnWidth=e.enableAutoColumnWidth;this._bPreserveDecimals=e.preserveDecimals;this._oCustomizeConfigTextInEditModeSource=e.textInEditModeSource;this._oCustomizeConfigIgnoreInsertRestrictions=e.ignoreInsertRestrictions;this._oCustomizeConfigClientSideMandatoryCheck=e.clientSideMandatoryCheck;try{var i=function(t){switch(typeof t){case"string":return JSON.parse(t);case"object":if(t==null){return undefined}return t;default:return undefined}};this._oDateFormatSettings=i(e.dateFormatSettings);this._oCurrencyFormatSettings=i(e.currencyFormatSettings);this._oDefaultDropDownDisplayBehaviour=e.defaultDropDownDisplayBehaviour}catch(t){}}if(!this._oDateFormatSettings){this._oDateFormatSettings={}}if(!this._oDateFormatSettings.hasOwnProperty("UTC")){this._oDateFormatSettings["UTC"]=true}this._aODataFieldMetadata=[];this._aTableViewMetadata=[];this._aIgnoredFields=[];this._aInitiallyVisibleFields=[];this._oMetadataAnalyser=new t(this._oParentODataModel);this._oSemanticObjectController=e.semanticObjectController;this._intialiseMetadata()};s.prototype._intialiseMetadata=function(){var t=[],i=-1,a,n,o,s,r,l,d;this._aODataFieldMetadata=this._oMetadataAnalyser.getFieldsByEntitySetName(this.sEntitySet);d=this._oMetadataAnalyser.getEntityTypeNameFromEntitySetName(this.sEntitySet);if(!this._bSkipAnnotationParse){this._oPresentationVariant=this._oMetadataAnalyser.getPresentationVariantAnnotation(d,this._sPresentationVariantQualifier);if(this._oPresentationVariant){this._oLineItemAnnotation=this._oPresentationVariant.lineItemAnnotation}if(!this._oLineItemAnnotation){this._oLineItemAnnotation=this._oMetadataAnalyser.getLineItemAnnotation(d,this._sLineItemQualifier)}}if(this._isMobileTable){this._oSemanticKeyAnnotation=this._oMetadataAnalyser.getSemanticKeyAnnotation(d)}if(!this._isAnalyticalTable){this._addLineItemNavigationFields(d)}l=this._oMetadataAnalyser.getEntityContainerAttribute("supported-formats");if(l){this._bSupportsExcelExport=l.indexOf("xlsx")>-1;this._oPdfAnnotation=l.indexOf("pdf")>-1&&this._oMetadataAnalyser.getPDFSupportedAnnotation();this._bSupportsPDFExport=this._oParentODataModel.isA("sap.ui.model.odata.v2.ODataModel")&&this._oPdfAnnotation}if(!this._oDefaultDropDownDisplayBehaviour){this._oDefaultDropDownDisplayBehaviour=this._oMetadataAnalyser.getTextArrangementValue(d)}this._generateArrays();this._oControlProvider=new e({metadataAnalyser:this._oMetadataAnalyser,model:this._oParentODataModel,fieldsMetadata:this._aODataFieldMetadata,lineItemAnnotation:this._oLineItemAnnotation,semanticKeyAnnotation:this._oSemanticKeyAnnotation,_semanticKeyAdditionalControl:this._oSemanticKeyAdditionalControl,processDataFieldDefault:true,isMobileTable:this._isMobileTable,isAnalyticalTable:this._isAnalyticalTable,smartTableId:this._smartTableId,dateFormatSettings:this._oDateFormatSettings,currencyFormatSettings:this._oCurrencyFormatSettings,defaultDropDownDisplayBehaviour:this._oDefaultDropDownDisplayBehaviour,useSmartField:this.useSmartField,useSmartToggle:this.useSmartToggle,defaultFilterBarExpanded:this.defaultFilterBarExpanded,defaultShowAllFilters:this.defaultShowAllFilters,useUTCDateTime:this.useUTCDateTime,enableDescriptions:true,entitySet:this.sEntitySet,semanticObjectController:this._oSemanticObjectController,preserveDecimals:this._bPreserveDecimals,textInEditModeSource:this._oCustomizeConfigTextInEditModeSource,ignoreInsertRestrictions:this._oCustomizeConfigIgnoreInsertRestrictions,clientSideMandatoryCheck:this._oCustomizeConfigClientSideMandatoryCheck});this._oFieldSemanticObjectMap={};if(this._aODataFieldMetadata){n=this._aODataFieldMetadata.length}for(a=0;a<n;a++){o=this._aODataFieldMetadata[a];if(this._aIgnoredFields.indexOf(o.name)>-1||!o.visible){continue}if(o.type.indexOf("Edm.")===0){s=this._oControlProvider.getFieldViewMetadata(o,this.isEditableTable);this._enrichWithTableViewMetadata(s,i++);t.push(s);if(s.semanticObject){this._oFieldSemanticObjectMap[s.name]=s.semanticObject}}}r=function(t,e){return t.index-e.index};this._aTableViewMetadata=t.sort(r);if(this._isAnalyticalTable&&this._mDimensionFromText){this._aTableViewMetadata.forEach(function(t){var e=this._mDimensionFromText[t.name];if(e&&t.aggregationRole!=="dimension"){if(!t.additionalProperty){t.additionalProperty=e}else{t.additionalProperty+=","+e}}}.bind(this))}};s.prototype._addLineItemNavigationFields=function(t){var e,i,a,n;if(this._aODataFieldMetadata&&this._oLineItemAnnotation){e=this._oLineItemAnnotation.fields;if(e){i=e.length}while(i--){a=e[i];if(a&&a.indexOf("/")>=0){n=this._oMetadataAnalyser.extractNavigationPropertyField(a,this.sEntitySet);if(n){n.name=n.parentPropertyName+"/"+n.name;if(n.description){n.description=n.parentPropertyName+"/"+n.description}if(n.unit){n.unit=n.parentPropertyName+"/"+n.unit}this._aODataFieldMetadata.push(n)}}}}};s.prototype.getFieldSemanticObjectMap=function(){return this._oFieldSemanticObjectMap};s.prototype.getTableViewMetadata=function(){return this._aTableViewMetadata};s.prototype.getSupportsExcelExport=function(){return this._bSupportsExcelExport};s.prototype.getExportCapabilities=function(t){var e={};if(t.indexOf("UI5Client")>-1){e["XLSX"]={}}if(this._bSupportsPDFExport&&t=="UI5ClientPDF"){e["PDF"]={};Object.assign(e["PDF"],this._oPdfAnnotation)}return e};s.prototype.getMultiUnitBehaviorEnabled=function(){return this._oMetadataAnalyser.getMultiUnitBehaviorEnabled()};s.prototype.getIsUTCDateHandlingEnabled=function(){return this._oDateFormatSettings?this._oDateFormatSettings.UTC:false};s.prototype.getRequestAtLeastFields=function(){return this._oPresentationVariant&&this._oPresentationVariant.requestAtLeastFields?this._oPresentationVariant.requestAtLeastFields:[]};s.prototype.isLineItemDefaultImportance=function(e){if(e.importance!="High"){return false}var i=this._oLineItemAnnotation&&this._oLineItemAnnotation.annotation||[];return i.some(function(i){return i.Value&&i.Value.Path==e.name&&!t.hasImportance(i)})};s.prototype.getFieldMetadata=function(t,e){var i=this._aTableViewMetadata.concat(this._aODataFieldMetadata).find(function(e){return e.name==t});if(!i&&t&&t.includes("/")){try{i=this._oMetadataAnalyser.extractNavigationPropertyField(t,this.sEntitySet)}catch(t){}}if(i){if(!i.modelType){this._oControlProvider.createModelTypeInstance(i)}if(e&&!i.hasOwnProperty("additionalProperty")){i.additionalProperty=this._getAdditionalProperty(i).join(",")}}return i};s.prototype._generateArrays=function(){if(this._sIgnoredFields){this._aIgnoredFields=this._sIgnoredFields.split(",")}if(this._sInitiallyVisibleFields){this._aInitiallyVisibleFields=this._sInitiallyVisibleFields.split(",")}};s.prototype._getAdditionalProperty=function(t){var e=[];if(t.isMeasureField&&t.unit){e.push(t.unit)}else if(t.description){e.push(t.description)}if(t.criticality){e.push(t.criticality)}if(t.criticalityRepresentation){e.push(t.criticalityRepresentation)}if(t.linkProperties&&t.linkProperties.length){e=e.concat(t.linkProperties)}if(t.fieldControlProperty){e.push(t.fieldControlProperty)}if(t.timezone){e.push(t.timezone)}return e};s.prototype._enrichWithTableViewMetadata=function(t,e){var a=[],s,r,l,d;var h=function(t){var e,i;if(t&&t.indexOf("/")>-1){i=t.split("/");i.pop();e=i.join("/")}return e};this._updateLabel(t);t.importance=this._getFieldImportance(t)||t.importance;t.isInitiallyVisible=this._isInitiallyVisible(t);t.index=this._getIndex(t,e);if(!t.width){d=this._getLineItemFieldWidth(t);if(d){t.width=d}else if(!this._isMobileTable&&!this._bEnableAutoColumnWidth){t.width=i.getWidth(t)}}s=this._getAdditionalProperty(t);l=s.length;if(l){t.additionalProperty=s.join(",")}while(l--){r=h(s[l]);if(r){a.push(r)}}if(t.parentPropertyName){a.push(t.parentPropertyName)}t.navigationProperty=a.join(",");this._setSortOrder(t);if(t.isFiscalDate){n.updateViewMetadata(t)}if(t.isCalendarType){o.updateViewMetadata(t)}t.semanticObjectPath=t["com.sap.vocabularies.Common.v1.SemanticObject"]&&t["com.sap.vocabularies.Common.v1.SemanticObject"]["Path"]||undefined;if(this._isAnalyticalTable){t.summed=t.aggregationRole==="measure";this._setInResult(t);this._setGroupBy(t);this._mapDimensionFromTextProperty(t)}};s.prototype._isInitiallyVisible=function(t){var e=false;if(this._oLineItemAnnotation&&this._oLineItemAnnotation.fields){e=this._oLineItemAnnotation.fields.indexOf(t.name)>-1;if(e&&!a.system.desktop&&!this._bShowDetailsButton){var i=t.importance;if(i){if(a.system.tablet){e=i==="High"||i==="Medium"}else if(a.system.phone){e=i==="High"}}}}if(!e&&this._aInitiallyVisibleFields){e=this._aInitiallyVisibleFields.indexOf(t.name)>-1}return e};s.prototype._setInResult=function(t){if(this._oPresentationVariant){if(this._oPresentationVariant.requestAtLeastFields&&this._oPresentationVariant.requestAtLeastFields.indexOf(t.name)>-1){t.inResult=true}}else if(this.enableInResultForLineItem){if(this._oLineItemAnnotation&&this._oLineItemAnnotation.fields&&this._oLineItemAnnotation.fields.indexOf(t.name)>-1){t.inResult=true}}};s.prototype._setSortOrder=function(t){var e;if(this._oPresentationVariant&&this._oPresentationVariant.sortOrderFields){e=this._oPresentationVariant.sortOrderFields.length;for(var i=0;i<e;i++){if(this._oPresentationVariant.sortOrderFields[i].name===t.name){t.sorted=true;t.sortOrder=this._oPresentationVariant.sortOrderFields[i].descending?"Descending":"Ascending";break}}}};s.prototype._setGroupBy=function(t){if(this._oPresentationVariant&&this._oPresentationVariant.groupByFields&&this._oPresentationVariant.groupByFields.indexOf(t.name)>=0){t.grouped=true}};s.prototype._getFieldImportance=function(t){var e=null;if(this._oLineItemAnnotation&&this._oLineItemAnnotation.importance){e=this._oLineItemAnnotation.importance[t.name]}return e};s.prototype._getLineItemFieldWidth=function(t){var e=null;if(this._oLineItemAnnotation&&this._oLineItemAnnotation.width){e=this._oLineItemAnnotation.width[t.name]}return e};s.prototype._mapDimensionFromTextProperty=function(t){if(!t.description||t.aggregationRole!=="dimension"){return}if(!this._mDimensionFromText){this._mDimensionFromText={}}this._mDimensionFromText[t.description]=t.name};s.prototype._getIndex=function(t,e){var i=-1,a=0,n=0;if(this._oLineItemAnnotation&&this._oLineItemAnnotation.fields){a=this._oLineItemAnnotation.fields.length;i=this._oLineItemAnnotation.fields.indexOf(t.name)}if(i<0&&this._aInitiallyVisibleFields){n=this._aInitiallyVisibleFields.length;i=this._aInitiallyVisibleFields.indexOf(t.name);if(i>-1){i+=a}}if(i>-1){return i}return e+a+n};s.prototype._updateLabel=function(t){var e;if(this._oLineItemAnnotation&&this._oLineItemAnnotation.labels){e=this._oLineItemAnnotation.labels[t.name]}if(e){t.label=e}};s.prototype.getFieldLabel=function(t,e){if(!e){return null}var i;if(e.indexOf("/")>-1){i=this._oMetadataAnalyser.extractNavigationPropertyField(e,t)}else{i=this._oMetadataAnalyser.getFieldsByEntitySetName(t).find(function(t){return t.name==e})}if(!i){return null}return i["com.sap.vocabularies.Common.v1.Label"]&&i["com.sap.vocabularies.Common.v1.Label"]["String"]||i["fieldLabel"]||null};s.prototype.destroy=function(){if(this._oMetadataAnalyser&&this._oMetadataAnalyser.destroy){this._oMetadataAnalyser.destroy()}this._oMetadataAnalyser=null;if(this._oControlProvider&&this._oControlProvider.destroy){this._oControlProvider.destroy()}this._mDimensionFromText=null;this._oControlProvider=null;this._aODataFieldMetadata=null;this._aTableViewMetadata=null;this._aIgnoredFields=null;this._aInitiallyVisibleFields=null;this._sIgnoredFields=null;this._sInitiallyVisibleFields=null;this.bIsDestroyed=true};return s},true);
/*!
 * SAPUI5
 * (c) Copyright 2009-2023 SAP SE. All rights reserved.
 */
sap.ui.predefine("sap/ui/comp/providers/TokenParser", ["sap/ui/comp/library","sap/ui/base/ManagedObject","sap/m/Token","sap/m/library","sap/ui/comp/util/FormatUtil"],function(e,t,a,r,o){"use strict";var n=e.valuehelpdialog.ValueHelpRangeOperation;var i=r.P13nConditionOperation;var p={default:[i.EQ,i.BT,i.LT,i.LE,i.GT,i.GE,i.NotEQ,i.NotBT,i.NotLT,i.NotLE,i.NotGT,i.NotGE],string:[i.Empty,i.NotEmpty,i.Contains,i.EQ,i.BT,i.StartsWith,i.EndsWith,i.LT,i.LE,i.GT,i.GE,i.NotEQ,i.NotContains,i.NotStartsWith,i.NotEndsWith,i.NotBT,i.NotLT,i.NotLE,i.NotGT,i.NotGE],date:[i.Empty,i.NotEmpty,i.EQ,i.BT,i.LT,i.LE,i.GT,i.GE,i.NotEQ,i.NotBT,i.NotLT,i.NotLE,i.NotGT,i.NotGE],time:[i.EQ,i.BT,i.LT,i.LE,i.GT,i.GE,i.NotEQ,i.NotBT,i.NotLT,i.NotLE,i.NotGT,i.NotGE],numeric:[i.EQ,i.BT,i.LT,i.LE,i.GT,i.GE,i.NotEQ,i.NotBT,i.NotLT,i.NotLE,i.NotGT,i.NotGE],numc:[i.Contains,i.EQ,i.BT,i.EndsWith,i.LT,i.LE,i.GT,i.GE,i.NotContains,i.NotEQ,i.NotBT,i.NotEndsWith,i.NotLT,i.NotLE,i.NotGT,i.NotGE],boolean:[i.EQ]};var s=[i.Empty,i.BT,i.EQ,i.Contains,i.StartsWith,i.EndsWith,i.LT,i.LE,i.GT,i.GE,i.NotEmpty,i.NotBT,i.NotEQ,i.NotContains,i.NotStartsWith,i.NotEndsWith,i.NotLT,i.NotLE,i.NotGT,i.NotGE];var l=function(e){var t=e&&e.rangeOperationsKeys||s;this._aKeyFields=[];this._sDefaultOperation=typeof e==="string"&&e||e&&e.defaultOperation&&e.defaultOperation||undefined;this._mTypeOperations=e&&e.typeOperations||p;this._initRangeOperations(t)};function u(e){var t=this.re.exec(e),a=t[1],r=t[2];if(t){if(a&&a.trim){a=a.trim()}if(r&&r.trim){r=r.trim()}return[a,r]}return[]}l.rangeOperations={};l.rangeOperations[i.Empty]={regex:new RegExp("^"+o.getFormattedRangeText(n.Empty,null,null,false)+"$","i"),operator:i.Empty,example:o.getFormattedRangeText(n.Empty,null,null,false),template:o.getFormattedRangeText(n.Empty,null,null,false),exclude:false,parse:function(e){return[]}};l.rangeOperations[i.BT]={regex:/^([^!].*)\.\.\.(.+)$/,operator:i.BT,example:"foo...bar",template:"$0...$1",exclude:false,parse:u};l.rangeOperations[i.EQ]={regex:/^\=(.+)$/,operator:i.EQ,example:"=foo",template:"=$0",exclude:false};l.rangeOperations[i.Contains]={regex:/^\*(.+)\*$/,operator:i.Contains,example:"*foo*",template:"*$0*",exclude:false};l.rangeOperations[i.StartsWith]={regex:/^([^\*!].*)\*$/,operator:i.StartsWith,example:"foo*",template:"$0*",exclude:false};l.rangeOperations[i.EndsWith]={regex:/^\*(.*[^\*])$/,operator:i.EndsWith,example:"*foo",template:"*$0",exclude:false};l.rangeOperations[i.LT]={regex:/^\<([^\=].*)$/,operator:i.LT,example:"< foo",template:"<$0",exclude:false};l.rangeOperations[i.LE]={regex:/^\<\=(.+)$/,operator:i.LE,example:"<=foo",template:"<=$0",exclude:false};l.rangeOperations[i.GT]={regex:/^\>([^\=].*)$/,operator:i.GT,example:"> foo",template:">$0",exclude:false};l.rangeOperations[i.GE]={regex:/^>=(.+)$/,operator:i.GE,example:">=foo",template:">=$0",exclude:false};l.rangeOperations[i.NotEmpty]={regex:new RegExp("^"+o.getFormattedRangeText(n.Empty,null,null,true).replace("(","\\(").replace(")","\\)")+"$","i"),operator:i.NotEmpty,example:o.getFormattedRangeText(n.Empty,null,null,true),template:o.getFormattedRangeText(n.Empty,null,null,true),exclude:true,parse:function(e){return[]}};l.rangeOperations[i.NotBT]={regex:/^![(]?(.+)\.\.\.([^)]+)[)]?$/,operator:i.NotBT,example:"!foo...bar",template:"!($0...$1)",exclude:true,parse:u};l.rangeOperations[i.NotEQ]={regex:/^![(]?=(.+?)[)]?$/,operator:i.NotEQ,example:"!=foo",template:"!(=$0)",exclude:true};l.rangeOperations[i.NotContains]={regex:/^![(]?\*(.+)\*[)]?$/,operator:i.NotContains,example:"!*foo*",template:"!(*$0*)",exclude:true};l.rangeOperations[i.NotStartsWith]={regex:/^![(]?([^\\*].*)\*[)]?$/,operator:i.NotStartsWith,example:"!foo*",template:"!($0*)",exclude:true};l.rangeOperations[i.NotEndsWith]={regex:/^![(]?\*([^\*)]*)[)]?$/,operator:i.NotEndsWith,example:"!*foo",template:"!(*$0)",exclude:true};l.rangeOperations[i.NotLT]={regex:/^![(]?<([^=].*?)[)]?$/,operator:i.NotLT,example:"!<foo",template:"!(<$0)",exclude:true};l.rangeOperations[i.NotLE]={regex:/^![(]?<=(.+?)[)]?$/,operator:i.NotLE,example:"!<=foo",template:"!(<=$0)",exclude:true};l.rangeOperations[i.NotGT]={regex:/^![(]?>([^=].*?)[)]?$/,operator:i.NotGT,example:"!>foo",template:"!(>$0)",exclude:true};l.rangeOperations[i.NotGE]={regex:/^![(]?>=(.+?)[)]?$/,operator:i.NotGE,example:"!>=foo",template:"!(>=$0)",exclude:true};l.excludeOperationsMapping={};l.excludeOperationsMapping[i.NotEmpty]=i.Empty;l.excludeOperationsMapping[i.NotLT]=i.LT;l.excludeOperationsMapping[i.NotLE]=i.LE;l.excludeOperationsMapping[i.NotGT]=i.GT;l.excludeOperationsMapping[i.NotGE]=i.GE;l.excludeOperationsMapping[i.NotContains]=i.Contains;l.excludeOperationsMapping[i.NotStartsWith]=i.StartsWith;l.excludeOperationsMapping[i.NotEndsWith]=i.EndsWith;l.excludeOperationsMapping[i.NotBT]=i.BT;l.excludeOperationsMapping[i.NotEQ]=i.EQ;l.prototype._initRangeOperations=function(e){e.forEach(function(e){this.createOperation(l.rangeOperations[e])},this)};l.prototype.destroy=function(){if(this._oInput&&!this._oInput.bIsDestroyed){this._oInput.removeValidator(this._validator);if(this._aOrgValidators&&this._aOrgValidators.length>0){this._oInput.addValidator(this._aOrgValidators)}this._oInput=null}this._aOrgValidators=null;this._aKeyFields=null;this._mTypeOperations=null};l.prototype.setDefaultOperation=function(e){this._sDefaultOperation=e};l.prototype.getDefaultOperation=function(){return this._sDefaultOperation};l.prototype.getOperations=function(){return this._mOperations};l.prototype.getOperation=function(e){return this._mOperations&&this._mOperations[e]};l.prototype._getKeyFieldByLabel=function(e){var t;this._aKeyFields.some(function(a){if(a.label.toUpperCase()===e.toUpperCase()){t=a}},this);return t};l.prototype.addKeyField=function(e){this._aKeyFields.push(e)};l.prototype.getKeyFields=function(){return this._aKeyFields};l.prototype.addTypeOperations=function(e,t){this._mTypeOperations[e]=t};l.prototype.removeTypeOperations=function(e){delete this._mTypeOperations[e]};l.prototype.getTypeOperations=function(e){return this._mTypeOperations[e]||this._mTypeOperations["default"]};l.prototype.createOperation=function(e){var t=e.operator,a=e.example,r=e.regex,o=e.template,n=e.parse,i=e.exclude;if(!this._mOperations){this._mOperations={}}this._mOperations[t]={key:t,example:a,re:r,template:o,exclude:i,parser:this,match:function(e,t){var a=this.re.exec(e);if(a){var r=this.parse(e);if(t){r.forEach(function(e){if(t.hasOwnProperty("maxLength")&&t.maxLength>=0&&e.length>t.maxLength){a=null}if(t.oType){try{e=t.oType.parseValue(e,"string");t.oType.validateValue(e)}catch(e){a=null}}},this)}}return a},parse:n||function(e){var t=this.re.exec(e);if(t){var a=t[1]||t[2];if(a&&a.trim){a=a.trim()}return[a]}return[]},getFilledTemplate:function(e,t){var a=this.parse(e);var r=[];var o="";for(var n=0;n<a.length;n++){r[n]=this.formatValue(a[n],false,t)}o=l._templateReplace(this.template,r);return o},getConditionData:function(e,t){var a={};a.exclude=this.exclude;if(this.exclude){a.operation=l.excludeOperationsMapping[this.key];if(!a.operation){a.operation=this.key}}else{a.operation=this.key}var r=this.parse(e);for(var o=0;o<r.length;o++){a["value"+(o+1)]=this.formatValue(r[o],true,t)}return a},formatValue:function(e,t,a){if(!a){return e}if(a.hasOwnProperty("maxLength")){if(a.maxLength>=0){e=e.substring(0,a.maxLength)}}if(a.displayFormat){if(a.displayFormat==="UpperCase"){e=e.toUpperCase()}}if(a.oType){try{e=a.oType.parseValue(e,"string");a.oType.validateValue(e)}catch(e){return"ERROR"}if(!t){e=a.oType.formatValue(e,"string")}}return e}};return this._mOperations[t]};l.prototype.removeOperation=function(e){delete this._mOperations[e]};l.prototype.removeAllOperations=function(){var e=Object.keys(this._mOperations);e.forEach(function(e){delete this._mOperations[e]},this)};l.prototype.getTranslatedText=function(e,t,a){var r=t.key;e=e!=="default"?"_"+e.toUpperCase()+"_":"";if(e==="_STRING_"||e==="_BOOLEAN_"||e==="_NUMC_"){e=""}if(e==="_TIME_"){e="_DATE_"}if(!a){a="sap.m"}r="CONDITIONPANEL_OPTION"+e+r;var o=sap.ui.getCore().getLibraryResourceBundle(a).getText(r)||r;if(o.startsWith("CONDITIONPANEL_OPTION")){r="CONDITIONPANEL_OPTION"+t.key;o=sap.ui.getCore().getLibraryResourceBundle(a).getText(r)}return o};l.prototype.associateInput=function(e){this._oInput=e;this._aOrgValidators=this._oInput&&this._oInput.isA("sap.m.MultiInput")?this._oInput.getValidators().slice():[];this._oInput.removeAllValidators();this._oInput.addValidator(this._validator.bind(this))};l.prototype._validator=function(e){if(this._aOrgValidators){var t;this._aOrgValidators.some(function(a){t=a(e);return t},this);if(t){return t}}if(e.text){return this._onValidate(e.text)}return null};l._templateReplace=function(e,t){return e.replace(/\$\d/g,function(e){return t[parseInt(e.substr(1))]})};l.prototype._onValidate=function(e){var r=this._aKeyFields.length>0?this._aKeyFields[0]:null;if(this._oInput._getIsSuggestionPopupOpen&&this._oInput._getIsSuggestionPopupOpen()&&this._oInput._oSuggestionsTable&&this._oInput._oSuggestionsTable.getSelectedItem()){return null}if(r){var o=/^\w+\:\s/.exec(e);if(o){var n=o[0];var p=this._getKeyFieldByLabel(n.slice(0,n.indexOf(":")));if(p){r=p;e=e.slice(o[0].length).trim()}}}var s=r&&r.type||"default";var u=this.getTypeOperations(s);var f=function(e,o){if(e.match(o,r)){var n=e.getConditionData(o,r);n.keyField=r?r.key:null;if(r.hasOwnProperty("maxLength")&&r.maxLength===1){if([i.Contains,i.EndsWith,i.StartsWith].indexOf(e.key)!==-1){return}}if(s==="numc"){if([i.Contains,i.EndsWith].indexOf(e.key)!==-1){n.value1=r.oType.formatValue(n.value1,"string")}}var p=(r&&r.label&&this._aKeyFields.length>1?r.label+": ":"")+e.getFilledTemplate(o,r);p=t.escapeSettingsValue(p);return new a({text:p,tooltip:p}).data("range",n)}return null}.bind(this);var g;if(u.some(function(t){g=f(this._mOperations[t],e);return g},this)){return g}if(this._sDefaultOperation&&this._mOperations[this._sDefaultOperation]){e=l._templateReplace(this._mOperations[this._sDefaultOperation].template,[e]);return f(this._mOperations[this._sDefaultOperation],e)}return null};l._createRangeByText=function(e){var t=l._matchOperationFromText(e);if(!t){return{exclude:false,operation:i.EQ,tokenText:null,value1:e,value2:null}}var a=t;var r=false;if(l.excludeOperationsMapping[t]){a=l.excludeOperationsMapping[t];r=true}var o=a===i.BT?true:false;return l._getRangeByTextAndOperation(e,a,r,o)};l._matchOperationFromText=function(e){var t=[];for(var a in l.rangeOperations){if(l.rangeOperations[a].regex.test(e)){t.push(a)}}if(t.length===0){return null}if(t.length>1){if(e===o.getFormattedRangeText(n.Empty,null,null,false)&&t.indexOf(l.rangeOperations[i.Empty].operator)>-1){t=[l.rangeOperations[i.Empty].operator]}if(e===o.getFormattedRangeText(n.Empty,null,null,true)&&t.indexOf(l.rangeOperations[i.NotEmpty].operator)>-1){t=[l.rangeOperations[i.NotEmpty].operator]}if(t.indexOf(l.rangeOperations[i.NotContains].operator)>-1&&t.indexOf(l.rangeOperations[i.NotStartsWith].operator)>-1){return l.rangeOperations[i.NotContains].operator}}return t[0]};l._getRangeByTextAndOperation=function(e,t,a,r){var o=[];if(a&&e.startsWith("!(")&&e.endsWith(")")){e=e.slice(2,-1)}var n=l.rangeOperations[t].template;if(r){o=e.split("...");return{exclude:a,operation:t,value1:o[0],value2:o[1]}}else{var i=n.indexOf("$0");var p=i+2;if(p===n.length){e=e.slice(i)}else{p=n.length-p;e=e.slice(i,-p)}return{exclude:a,operation:t,value1:e,value2:null}}};return l},true);
/*!
 * SAPUI5
 * (c) Copyright 2009-2023 SAP SE. All rights reserved.
 */
sap.ui.predefine("sap/ui/comp/providers/ValueHelpProvider", ["sap/ui/core/date/UI5Date","sap/ui/thirdparty/jquery","sap/ui/comp/library","sap/m/library","sap/m/List","sap/m/ResponsivePopover","sap/m/StandardListItem","sap/m/Token","sap/m/Table","sap/m/ColumnListItem","sap/m/Label","./BaseValueListProvider","sap/ui/comp/odata/MetadataAnalyser","sap/ui/comp/util/FormatUtil","sap/ui/comp/util/DateTimeUtil","sap/ui/model/json/JSONModel","sap/ui/core/format/DateFormat","sap/ui/Device","sap/ui/model/Sorter","sap/base/util/merge","sap/ui/model/Filter","sap/ui/model/FilterOperator","sap/m/VariantItem","sap/base/strings/capitalize"],function(e,jQuery,t,i,a,s,l,o,r,n,h,u,p,d,g,c,f,m,S,y,_,V,D){"use strict";var v=t.valuehelpdialog.ValueHelpRangeOperation;var F={DeprecatedCode:"W",RevokedCode:"E",ValidCode:""};var C;var b=u.extend("sap.ui.comp.providers.ValueHelpProvider",{constructor:function(e){if(e){this.preventInitialDataFetchInValueHelpDialog=!!e.preventInitialDataFetchInValueHelpDialog;this.sTitle=e.title;this.bSupportMultiselect=!!e.supportMultiSelect;this.bSupportRanges=!!e.supportRanges;this.bIsSingleIntervalRange=!!e.isSingleIntervalRange;this.bIsSearchExpressionFilterRestriction=!!e.isSearchExpressionFilterRestriction;this.bIsUnrestrictedFilter=!!e.isUnrestrictedFilter;this.bTakeOverInputValue=e.takeOverInputValue===false?false:true;this._sScale=e.scale;this._sPrecision=e.precision;this._defaultOperation=e.defaultOperation?e.defaultOperation:null;this.filterBarClass=e.filterBarClass;this._onBeforeOpenValueHelpDialog=e._onBeforeOpenValueHelpDialog||function(){};this.enabledMultiSelectionPlugin=!!e.enabledMultiSelectionPlugin;this.defaultFilterBarExpanded=e.defaultFilterBarExpanded;this.defaultShowAllFilters=e.defaultShowAllFilters;this.calendarWeekSettings=e.calendarWeekSettings;if(this.bIsSingleIntervalRange){this.bSupportRanges=true}}u.apply(this,arguments);this._onInitialise()}});b.prototype._onInitialise=function(){if(this.oControl.attachValueHelpRequest){this._fVHRequested=function(e){if(!this.bInitialised){return}var t=e.getParameter("_userInputValue");this.oControl=e.getSource();this.bForceTriggerDataRetreival=e.getParameter("fromSuggestions");if(this.bSupportBasicSearch&&(this.bTakeOverInputValue||this.bForceTriggerDataRetreival)&&(t||t==="")){this.sBasicSearchText=t}this._createValueHelpDialog()}.bind(this);this.oControl.attachValueHelpRequest(this._fVHRequested)}};b.prototype._getEntitiesLazy=function(){return sap.ui.getCore().loadLibrary("sap.ui.mdc",{async:true}).then(function(){return new Promise(function(e){sap.ui.require(["sap/ui/mdc/filterbar/vh/CollectiveSearchSelect","sap/ui/comp/valuehelpdialog/ValueHelpDialog"],function(t,i){e([i,t])})})})};b.prototype._createValueHelpDialog=function(){if(!this.bCreated){this.bCreated=true;if(!this._oValueHelpDialogClass||!this._oCollectiveSearchSelectClass){this._getEntitiesLazy().then(this._onValueHelpDialogRequired.bind(this))}else{this._onValueHelpDialogRequired([this._oValueHelpDialogClass,this._oCollectiveSearchSelectClass])}}};b.prototype._getTitle=function(){if(this.sTitle){return this.sTitle}else if(this.oFilterProvider){return this.oFilterProvider._determineFieldLabel(this._fieldViewMetadata)}return""};b.prototype.getValueListAnnotation=function(){var e;if(this._isContextDependent()){e=this.oControl.getBindingContext()&&this.oControl.getBindingContext().getPath()}return this._oMetadataAnalyser.getValueListAnnotationLazy(this._sFullyQualifiedFieldName,e)};b.prototype._onValueHelpDialogRequired=function(e){if(this.bInitialised&&this.bIsContextDependent){this._bValueListRequested=false;return this._loadAnnotation().then(function(){return this._onInitValueHelpDialog(e)}.bind(this))}else{return this._onInitValueHelpDialog(e)}};b.prototype._onInitValueHelpDialog=function(e){this._oValueHelpDialogClass=e[0];this._oCollectiveSearchSelectClass=e[1];var t=this.oControl&&this.oControl.getId()+"-valueHelpDialog";this.oValueHelpDialog=new this._oValueHelpDialogClass(t,{stretch:m.system.phone,basicSearchText:this.sBasicSearchText,supportRangesOnly:this.bIsSingleIntervalRange||!this.oPrimaryValueListAnnotation,supportMultiselect:this.bSupportMultiselect,title:this._getTitle(),supportRanges:this.bSupportRanges,displayFormat:this.sDisplayFormat,enabledMultiSelectionPlugin:!!this.enabledMultiSelectionPlugin,ok:this._onOK.bind(this),cancel:this._onCancel.bind(this),beforeOpen:function(){this._onBeforeOpenValueHelpDialog({fieldName:this.sFieldName,_switchView:this._switchView.bind(this)})}.bind(this),afterClose:function(){if(this.oPrimaryValueListAnnotation){this._resolveAnnotationData(this.oPrimaryValueListAnnotation)}this.oValueHelpDialog.destroy();this.bCreated=false;if(this.oControl&&this.oControl.focus&&!m.system.phone){this.oControl.focus()}}.bind(this)});if(this.oValueHelpDialog&&this._defaultOperation&&v[this._defaultOperation]){this.oValueHelpDialog.setConditionPanelDefaultOperation(this._defaultOperation)}if(this.oValueHelpDialog&&this.calendarWeekSettings){this.oValueHelpDialog.setProperty("_conditionPanelCalendarWeekSettings",this.calendarWeekSettings)}if(this.oValueHelpDialog._oColSearchBox){this.oValueHelpDialog._oColSearchBox.destroy();this.oValueHelpDialog._oColSearchBox=null}this.oValueHelpDialog._oColSearchBox=new this._oCollectiveSearchSelectClass({visible:false,title:sap.ui.getCore().getLibraryResourceBundle("sap.ui.comp").getText("COLLECTIVE_SEARCH_SELECTION_TITLE")}).addStyleClass("sapUiTinyMarginEnd");this.oValueHelpDialog.setProperty("_enhancedExcludeOperations",true);this.oControl.addDependent(this.oValueHelpDialog);this.oValueHelpDialog.suggest(function(e,t){if(this.oPrimaryValueListAnnotation){var i=function(i){e.setShowSuggestion(true);e.setFilterSuggests(false);e._oSuggestProvider=new i({fieldName:t,control:e,model:this.oODataModel,displayFormat:this.sDisplayFormat,resolveInOutParams:false,displayBehaviour:this.sTokenDisplayBehaviour,annotation:this.oPrimaryValueListAnnotation,fieldViewMetadata:this._fieldViewMetadata,maxLength:this._sMaxLength,filterModel:this.oFilterModel,aggregation:"suggestionRows",typeAheadEnabled:true,enableShowTableSuggestionValueHelp:false})}.bind(this);C=sap.ui.require("sap/ui/comp/providers/ValueListProvider");if(!C){sap.ui.require(["sap/ui/comp/providers/ValueListProvider"],i)}else{i(C);return e._oSuggestProvider}return null}}.bind(this));if(this.bIsSingleIntervalRange){this.oValueHelpDialog.setIncludeRangeOperations([v.BT,v.EQ],this._sType);(function(){this.oValueHelpDialog.setMaxIncludeRanges&&this.oValueHelpDialog.setMaxIncludeRanges(1);this.oValueHelpDialog.setMaxExcludeRanges&&this.oValueHelpDialog.setMaxExcludeRanges(0)}).bind(this)();this.oValueHelpDialog.setMaxConditions(1);this.oValueHelpDialog.bIsSingleIntervalRange=this.bIsSingleIntervalRange;this._updateInitialInterval()}else if((this._sType==="date"||this._sType==="time"||this._sType==="datetime")&&!this.bIsUnrestrictedFilter){this.oValueHelpDialog.setIncludeRangeOperations([v.EQ],this._sType);(function(){this.oValueHelpDialog.setMaxExcludeRanges(0)}).bind(this)()}else if(this.bIsSearchExpressionFilterRestriction){this.oValueHelpDialog.setIncludeRangeOperations(p._getSearchExpressionRangeOperationsKeys(),p._getSearchExpressionType());this.oValueHelpDialog.setExcludeRangeOperations(p._getSearchExpressionRangeOperationsKeys(),p._getSearchExpressionType())}if(this.oControl.$()&&this.oControl.$().closest(".sapUiSizeCompact").length>0){this.oValueHelpDialog.addStyleClass("sapUiSizeCompact")}else if(this.oControl.$()&&this.oControl.$().closest(".sapUiSizeCozy").length>0){this.oValueHelpDialog.addStyleClass("sapUiSizeCozy")}else if(jQuery("body").hasClass("sapUiSizeCompact")){this.oValueHelpDialog.addStyleClass("sapUiSizeCompact")}else{this.oValueHelpDialog.addStyleClass("sapUiSizeCozy")}if(this.bSupportRanges){this.oValueHelpDialog.setRangeKeyFields([{label:this._getTitle(),key:this.sFieldName,typeInstance:this._fieldViewMetadata?this._fieldViewMetadata.ui5Type:null,type:this._sType,formatSettings:this._sType==="numc"?{isDigitSequence:true,maxLength:this._sMaxLength}:Object.assign({},this._oDateFormatSettings,{UTC:false}),scale:this._sScale,precision:this._sPrecision,maxLength:this._sMaxLength,nullable:this._fieldViewMetadata?this._fieldViewMetadata.nullable:false}])}if(!(this.bIsSingleIntervalRange||!this.oPrimaryValueListAnnotation)){this.oValueHelpDialog.setModel(this.oODataModel);this._createAdditionalValueHelpControls();this._createCollectiveSearchControls()}if(this.oControl.getTokens){var i=this.oControl.getTokens();if(i){i=this._adaptTokensFromFilterBar(i);this.oValueHelpDialog.setTokens(i)}}return Promise.resolve().then(this.oValueHelpDialog.open.bind(this.oValueHelpDialog))};b.prototype._isContextDependent=function(){var e,t;if(this.bIsContextDependent===undefined){t=this._oMetadataAnalyser.getPropertyContextByPath(this._sFullyQualifiedFieldName);if(t){e=t.getObject();if(p.hasValueListRelevantQualifiers(e)){this.bIsContextDependent=true}}}return this.bIsContextDependent};b.prototype._adaptTokensFromFilterBar=function(e){var t,i,a,s=e;if(this.oFilterProvider&&e&&this._sType==="time"){s=[];for(var l=0;l<e.length;l++){t=y({},e[l]);i=t.data("range");if(i){i=y({},i);if(i.value1 instanceof Date){a=g.localToUtc(i.value1);i.value1={__edmType:"Edm.Time",ms:a.getTime()}}if(i.value2 instanceof Date){a=g.localToUtc(i.value2);i.value2={__edmType:"Edm.Time",ms:a.getTime()}}t.data("range",i);s.push(t)}}}return s};b.prototype._updateInitialInterval=function(){var t=this.oControl.getValue(),i,a,s,l,r;if(t){i=new o;a={exclude:false,keyField:this.sFieldName};if(this._sType==="numeric"){s=d.parseFilterNumericIntervalData(t);if(s.length==0){s.push(t)}}else if(this._sType==="datetime"){s=d.parseDateTimeOffsetInterval(t);l=f.getDateTimeInstance(Object.assign({},this._oDateFormatSettings,{UTC:false}));r=l.parse(s[0]);s[0]=r?r:e.getInstance(s[0]);if(s.length===2){r=l.parse(s[1]);s[1]=r?r:e.getInstance(s[1])}}else{s=t.split("-")}if(s&&s.length===2){a.operation="BT";a.value1=s[0];a.value2=s[1]}else{a.operation="EQ";a.value1=s[0]}i.data("range",a)}if(i){this.oValueHelpDialog.setTokens([i])}};b.prototype._createCollectiveSearchControls=function(){var e,t=0,i=0,a,s;if(this.additionalAnnotations&&this.additionalAnnotations.length){a=function(e){var t,i,a,s=e.getParameter("key"),l=e.getSource(),o=l&&l.getItems();for(var r=0;r<o.length;r++){a=o[r];if(a.getKey()===s){t=a;break}}if(t){i=t.data("_annotation");if(i){this._triggerAnnotationChange(i)}}}.bind(this);e=new D({key:this.oPrimaryValueListAnnotation.keyField,text:this.oPrimaryValueListAnnotation.valueListTitle});e.data("_annotation",this.oPrimaryValueListAnnotation);this.oValueHelpDialog._oColSearchBox.addItem(e);this.oValueHelpDialog._oColSearchBox.setSelectedItemKey(this.oPrimaryValueListAnnotation.keyField);i=this.additionalAnnotations.length;for(t=0;t<i;t++){s=this.additionalAnnotations[t];e=new D({key:s.qualifier,text:s.valueListTitle});e.data("_annotation",s);this.oValueHelpDialog._oColSearchBox.addItem(e)}this.oValueHelpDialog._oColSearchBox.attachSelect(a);this.oValueHelpDialog._oColSearchBox.setVisible(true)}};b.prototype._triggerAnnotationChange=function(e){this.oValueHelpDialog.resetTableState();this._resolveAnnotationData(e);this._createAdditionalValueHelpControls()};b.prototype._createAdditionalValueHelpControls=function(){var e=null,t=this.filterBarClass;this.oValueHelpDialog.setKey(this.sKey);this.oValueHelpDialog.setKeys(this._aKeys);this.oValueHelpDialog.setDescriptionKey(this.sDescription);this.oValueHelpDialog.setTokenDisplayBehaviour(this.sTokenDisplayBehaviour);var i=new c;i.setData({cols:this._aCols});this.oValueHelpDialog.setModel(i,"columns");if(this.bSupportBasicSearch){e=this.sKey}if(this.oSmartFilterBar){this.oSmartFilterBar._setCollectiveSearch(null);this.oSmartFilterBar.destroy()}if(!t){t=sap.ui.require("sap/ui/comp/smartfilterbar/SmartFilterBar")}this.oSmartFilterBar=new t(this.oValueHelpDialog.getId()+"-smartFilterBar",{entitySet:this.sValueListEntitySetName,basicSearchFieldName:e,enableBasicSearch:this.bSupportBasicSearch,isRunningInValueHelpDialog:true,advancedMode:true,showGoOnFB:!m.system.phone,search:this._onFilterBarSearchPressed.bind(this),reset:this._onFilterBarResetPressed.bind(this),filterChange:this._onFilterBarFilterChange.bind(this),initialise:this._onFilterBarInitialise.bind(this),filterBarExpanded:!!this.defaultFilterBarExpanded,showAllFilters:!!this.defaultShowAllFilters,considerAnalyticalParameters:true});if(this._oDateFormatSettings){this.oSmartFilterBar.data("dateFormatSettings",this._oDateFormatSettings)}if(this.oPrimaryValueListAnnotation&&this.oPrimaryValueListAnnotation.constParams){this.oSmartFilterBar.data("hiddenFields",Object.keys(this.oPrimaryValueListAnnotation.constParams));this.oSmartFilterBar.data("significantFields",this.oPrimaryValueListAnnotation.aInitialValueIsSignificantFields)}this.oValueHelpDialog.setFilterBar(this.oSmartFilterBar)};b.prototype._onFilterBarFilterChange=function(){if(!this._bIgnoreFilterChange){this.oValueHelpDialog.getTableAsync().then(function(e){e.setShowOverlay(true);this.oValueHelpDialog.TableStateSearchData()}.bind(this))}};b.prototype._expandFilterBar=function(){var e=this.oFilterProvider&&this.oFilterProvider._oAdditionalConfiguration,t=e?e.getControlConfigurationByKey(this._fieldViewMetadata.fieldName):null;if(this.defaultFilterBarExpanded!==false){if(this.oSmartFilterBar._hasMandatoryFields()){this.oSmartFilterBar.setFilterBarExpanded(true);if(this.defaultShowAllFilters!==false){this.oSmartFilterBar.setShowAllFilters(true)}this.oSmartFilterBar.rerenderFilters()}else if(!this.bSupportBasicSearch||this.oFilterProvider&&this.oFilterProvider._getPreventInitialDataFetchInValueHelpDialog(this._fieldViewMetadata,t)){this.oSmartFilterBar.setFilterBarExpanded(true)}}};b.prototype._onFilterBarSearchPressed=function(){this._rebindTable()};b.prototype._rebindTable=function(){var e,t,i,a,s;e=this.oSmartFilterBar.getFilters();a=this.oPrimaryValueListAnnotation.deprecationCodeField;if(a){if(e.length===0||e.length>0&&!this._checkForExistingRevokedFilters(e[0],a)){e.push(new _(a,V.NE,F.RevokedCode))}}t=this.oSmartFilterBar.getParameters()||{};if(this.aSelect&&this.aSelect.length){t["select"]=this.aSelect.toString()}s=this.oSmartFilterBar.getAnalyticBindingPath();i={path:s||"/"+this.sValueListEntitySetName,filters:e,parameters:t,events:{dataReceived:function(e){this.oValueHelpDialog.TableStateDataFilled();var t=e.getSource();this.oValueHelpDialog.getTableAsync().then(function(e){if(t&&this.oValueHelpDialog&&this.oValueHelpDialog.isOpen()){var i=t.getLength();if(i){this.oValueHelpDialog.update()}else{this.oValueHelpDialog._updateTitles()}}}.bind(this))}.bind(this)}};this.oValueHelpDialog.getTableAsync().then(function(e){e.setShowOverlay(false);this.oValueHelpDialog.TableStateDataSearching();e.setEnableBusyIndicator(true);if(e instanceof r){var t;if(this.sKey&&this._oMetadataAnalyser){t=this._oMetadataAnalyser.getFieldsByEntitySetName(this.sValueListEntitySetName);for(var a=0;a<t.length;a++){if(t[a].name===this.sKey&&t[a].sortable!==false){i.sorter=new S(this.sKey);break}}}i.factory=function(t,i){var a=e.getModel("columns").getData().cols;return new n({cells:a.map(function(e){var t=e.template,i="{"+t+"}";if(Array.isArray(t)){i={parts:[{path:t[0]},{path:t[1]}],formatter:function(t,i){var a=d.getFormattedExpressionFromDisplayBehaviour(e.displayBehaviour,t,i);return a}}}return new h({text:i})})})};e.bindItems(i)}else{var s=e.getColumns();for(var a=0;a<s.length;a++){var l=s[a];l._appDefaults=null;if(i&&i.parameters&&i.parameters.custom){var o=i.parameters.custom.search?false:l.getBindingContext("columns").getProperty("sorted");l.setSorted(o);l.setSortOrder(o?"Ascending":"None")}}s=e.getSortedColumns();if(!s||s.length==0){s=e.getColumns()}for(var a=0;a<s.length;a++){var l=s[a];var u=l.getSortOrder()!=="None";if(!l.getSorted()){u=false}if(u){if(!i.sorter){i.sorter=[]}i.sorter.push(new S(l.getSortProperty(),l.getSortOrder()==="Descending"))}}e.bindRows(i)}}.bind(this))};b.prototype._checkForExistingRevokedFilters=function(e,t){var i=false;if(e.sPath===t&&e.sOperator===v.EQ&&e.oValue1===F.RevokedCode){i=true}else if(Array.isArray(e.aFilters)){for(var a=0;a<e.aFilters.length;a++){i=this._checkForExistingRevokedFilters(e.aFilters[a],t);if(i){break}}}return i};b.prototype._onFilterBarResetPressed=function(){this._calculateFilterInputData();if(this.oSmartFilterBar){this.oSmartFilterBar.setFilterData(this.mFilterInputData)}};b.prototype._onFilterBarInitialise=function(){var e=null;this._bIgnoreFilterChange=true;this._onFilterBarResetPressed();delete this._bIgnoreFilterChange;if(this.oSmartFilterBar&&this.oSmartFilterBar.getBasicSearchControl){e=this.oSmartFilterBar.getBasicSearchControl();if(e){e.setValue(this.sBasicSearchText);if(m.system.phone&&e.isA("sap.m.SearchField")){e.setShowSearchButton(true)}}}if(!this.preventInitialDataFetchInValueHelpDialog||this.bForceTriggerDataRetreival){this._rebindTable();this.bForceTriggerDataRetreival=false}if(m.system.desktop){this._expandFilterBar()}};b.prototype._onOK=function(t){var i=t.getParameter("_tokensHaveChanged"),a=t.getParameter("tokens"),s,l,o=0,r=[],n=null,h,u={},p;this._onCancel();if(!i){return}if(this.oControl.isA("sap.m.MultiInput")){this.oControl.setValue("");this.oControl.destroyTokens();this.oControl.setTokens(a);o=a.length;if(o>0){u.type="added";u.addedTokens=a}this.oControl.fireTokenUpdate(u);while(o--){n=a[o].data("row");if(n){r.push(n)}}}else{if(a[0]){if(this.bIsSingleIntervalRange){s=a[0].data("range");if(s){if(this._sType==="datetime"){h=f.getDateTimeInstance(Object.assign({},this._oDateFormatSettings,{UTC:false}));if(typeof s.value1==="string"){s.value1=e.getInstance(s.value1)}if(s.operation==="BT"){if(typeof s.value2==="string"){s.value2=e.getInstance(s.value2)}l=h.format(s.value1)+"-"+h.format(s.value2)}else{l=h.format(s.value1)}}else{if(s.operation==="BT"){l=s.value1+"-"+s.value2}else{l=s.value1}}}}else{l=a[0].getKey()}n=a[0].data("row");if(n){p="/"+encodeURIComponent(a[0].data("longKey"));r.push(n)}a[0].destroy()}if(this.sContext==="SmartField"&&this._selectedODataRowHandler){this._selectedODataRowHandler(l,r[0],p)}this.setValue(l);if(this.sContext==="SmartFilterBar"&&!this.bIsSingleIntervalRange){var g=r[0]&&r[0][this.sDescription];this.oControl.setValue(d.getFormattedExpressionFromDisplayBehaviour(this.sSingleFieldDisplayBehaviour,l,g));this.oControl.setValueState("None");this.oFilterProvider.oModel.setProperty("/"+this.sFieldName,l);this.oFilterProvider._setSingleInputsTextArrangementFieldData(this.sFieldName,l,g)}this.oControl.fireChange({value:l,validated:true})}if(this.fnAsyncWritePromise){this.fnAsyncWritePromise().then(this._calculateAndSetFilterOutputData.bind(this,r))}else{this._calculateAndSetFilterOutputData(r)}};b.prototype._onCancel=function(){this.oValueHelpDialog.close();this.oValueHelpDialog.setModel(null)};b.prototype._switchView=function(e){if(!(this.oValueHelpDialog&&this.oValueHelpDialog._oColSearchBox)){return}var t=this.oValueHelpDialog._oColSearchBox,i=t.getItems(),a=i.find(function(t){return t.getKey()===e});if(a){this._triggerAnnotationChange(a.data("_annotation"));this.oValueHelpDialog._oColSearchBox.setSelectedItemKey(a.getKey())}};b.prototype.destroy=function(){if(this.oControl&&this.oControl.detachValueHelpRequest){this.oControl.detachValueHelpRequest(this._fVHRequested);this._fVHRequested=null}u.prototype.destroy.apply(this,arguments);if(this.oValueHelpDialog){this.oValueHelpDialog.destroy();this.oValueHelpDialog=null}if(this.oSmartFilterBar){this.oSmartFilterBar.destroy();this.oSmartFilterBar=null}this.sTitle=null};return b});
/*!
 * SAPUI5
 * (c) Copyright 2009-2023 SAP SE. All rights reserved.
 */
sap.ui.predefine("sap/ui/comp/providers/ValueListProvider", ["sap/ui/core/library","sap/ui/comp/library","sap/m/library","sap/ui/comp/odata/MetadataAnalyser","sap/ui/comp/util/DateTimeUtil","sap/ui/core/SeparatorItem","sap/m/GroupHeaderListItem","sap/m/Column","sap/m/ColumnListItem","sap/m/Text","sap/m/Token","./BaseValueListProvider","sap/ui/core/ListItem","sap/ui/model/Filter","sap/ui/model/Sorter","sap/ui/model/json/JSONModel","sap/ui/model/FilterOperator","sap/ui/comp/util/FormatUtil","sap/ui/comp/historyvalues/HistoryValuesProvider","sap/ui/comp/historyvalues/HistoryOptOutProvider","sap/ui/comp/historyvalues/Constants","sap/m/ComboBox","sap/m/MultiComboBox","sap/m/Select","sap/base/util/deepEqual","sap/ui/Device","sap/base/Log","sap/base/util/values","sap/m/Label","sap/base/strings/whitespaceReplacer","sap/ui/comp/smartfilterbar/FilterProviderUtils"],function(t,e,i,o,s,n,r,a,l,h,u,d,g,p,m,f,c,_,y,S,C,v,P,b,F,V,D,I,A,w,T){"use strict";var H=e.smartfilterbar.DisplayBehaviour;var L=i.PopinDisplay;var B=i.WrappingType;var R=t.ValueState;var M=sap.ui.getCore().getLibraryResourceBundle("sap.ui.comp").getText("SEARCH_FIELD_VALIDATION_WARNING_MESSAGE");var N={Recommendations:10,RecentlyUsed:20,Others:30};var x="list";var E=d.extend("sap.ui.comp.providers.ValueListProvider",{constructor:function(t){if(t){this.sAggregationName=t.aggregation;this.bTypeAheadEnabled=!!t.typeAheadEnabled;this.bEnableShowTableSuggestionValueHelp=t.enableShowTableSuggestionValueHelp===undefined?true:t.enableShowTableSuggestionValueHelp;this.dropdownItemKeyType=t.dropdownItemKeyType;this.sDeferredGroupId=t.deferredGroupId;this._fieldHistoryEnabled=t.fieldHistoryEnabled;this._fieldHistoryEnabledInitial=t.fieldHistoryEnabledInitial;this._bSuggestionsEnabled=this._getSuggestionsEnabled();this.bShowAllSuggestionsButton=t.bShowAllSuggestionsButton}this._aRecommendations=[];this._oRecommendationListPromise=Promise.resolve();this._oResourceBundle=sap.ui.getCore().getLibraryResourceBundle("sap.ui.comp");this._groupHeaderFactory=this._groupHeaderFactory.bind(this);this._pendingValidationCount=0;d.apply(this,arguments);this._onInitialise()}});E.prototype._onInitialise=function(){if(!this.bTypeAheadEnabled){this.oAfterRenderingEventDelegate={onAfterRendering:this._onMetadataInitialised};this.oControl.addEventDelegate(this.oAfterRenderingEventDelegate,this)}else if(this.oControl.attachSuggest){this._fSuggest=function(t){this.oControl=t.getSource();if(!this.bInitialised){return}if(!this.isDisableSearchMatchesPatternWarning()&&this.oControl.getValueState&&this.oControl.getValueState()===R.Warning&&this.oControl.getValueStateText&&this.oControl.getValueStateText()===M){return}if(!this._oTemplate||!this.oControl.data("_hassuggestionTemplate")){this._createSuggestionTemplate()}var e=t.getParameter("suggestValue");this._fetchData(e)}.bind(this);this.oControl.attachSuggest(this._fSuggest);if(!this.oFilterModel){var t=this;var e=this.oControl.setParent;this.oControl.setParent=function(i,o,s){var n=this.getParent();var r=e.apply(this,arguments);i=this.getParent();var a=!(i&&n===null);if(i!==n&&a){t.unbindAggregation()}return r}}this._handleSelect()}this.oControl.setModel(new f,x);this._setupHistoryValues();this._setupRecommendations()};E.prototype._onMetadataInitialised=function(){if(this.bInitialised){if(this.oAfterRenderingEventDelegate){this.oControl.removeEventDelegate(this.oAfterRenderingEventDelegate)}if(this.oPrimaryValueListAnnotation){this._oPresentationVariant=this._handlePresentationVariantSortOrderAnnotation();if(this.sAggregationName&&this.sAggregationName=="suggestionRows"){this._createSuggestionTemplate()}else{this._createDropDownTemplate()}this._fetchData();if(this._isControlDropdown()){if(this.mOutParams&&Object.keys(this.mOutParams).length>1){this._handleOutParameters()}if(this.mInParams&&Object.keys(this.mInParams).length>1){this._handleInParameters()}}}else{D.error("ValueListProvider","Missing primary ValueListAnnotation for "+(this._sFullyQualifiedFieldName||this.sFieldName))}if(this.oAfterRenderingEventDelegate){delete this.oAfterRenderingEventDelegate}}};E.prototype._onAnnotationLoad=function(t){var e=d.prototype._onAnnotationLoad.call(this,t);if(!this._isControlSupportedForHistory(this.oControl)){return e}if(this._shouldHaveRecommendations()||this._shouldHaveHistory()){this._setupSuggestionInteractions()}if(this.sContext==="SmartFilterBar"&&this._hasNotValidatedSingleField(this.sFieldName)){this._validateInput(this.oFilterProvider._oNotValidatedSingleFields[this.sFieldName],undefined,true);this.oFilterProvider._oNotValidatedSingleFields[this.sFieldName]=""}return e};E.prototype._isSortable=function(t){if(this.oPrimaryValueListAnnotation){for(var e=0;e<this.oPrimaryValueListAnnotation.valueListFields.length;e++){if(this.oPrimaryValueListAnnotation.valueListFields[e].name===t){return this.oPrimaryValueListAnnotation.valueListFields[e].sortable!==false}}return false}return false};E.prototype._createDropDownTemplate=function(){var t=[{path:this._resolveSuggestionBindingPath(this.sKey),type:this.dropdownItemKeyType}],e=this.sValueListsDDLBDisplayBehaviour||this.sDDLBDisplayBehaviour,i=this.oControl.getBinding("realValue")&&this.oControl.getBinding("realValue").getType();if(this.oControl.isA("sap.ui.comp.IDropDownTextArrangement")&&this.sValueListsDDLBDisplayBehaviour&&this.sValueListsDDLBDisplayBehaviour!==this.sDDLBDisplayBehaviour){this.oControl.setTextArrangement(this.sDDLBDisplayBehaviour)}if(this.sDescription){t.push({path:this._resolveSuggestionBindingPath(this.sDescription)})}if(this.sContext==="SmartField"&&o.getIsTimezoneProperty(this._fieldViewMetadata)){this._oTemplate=new g({key:{path:this._resolveSuggestionBindingPath(this.sKey),parts:[{value:null},{path:this._resolveSuggestionBindingPath(this.sKey)}],type:this.dropdownItemKeyType||i},text:{parts:[{value:null},{path:this._resolveSuggestionBindingPath(this.sKey)}],type:this.dropdownItemKeyType||i}})}else{this._oTemplate=new g({key:{path:this._resolveSuggestionBindingPath(this.sKey),type:this.dropdownItemKeyType},text:{parts:t,formatter:function(t,i){var o=_.getFormatterFunctionFromDisplayBehaviour(e),s=o(t,i);return w(s)}}})}if(this._oRecommendationListAnnotation){this._oTemplate.bindProperty("additionalText",{path:this._resolveSuggestionBindingPath(this._oRecommendationListAnnotation.rankProperty)})}this._oSorter=null;var s=this._isSortable(this.sKey),n=this._isSortable(this.sDescription);if(this._oPresentationVariant){if(this._oPresentationVariant._bIsPresentationVariantSortPathInVHDEntityType&&this._oPresentationVariant._bIsPresentationVariantSortOrderPropertySortable){this._oSorter=new m(this._oPresentationVariant.sPresentationVariantSortPath,this._oPresentationVariant.sortOrderFields[0].descending)}else{D.error("ValueListProvider","Is Presentation Variant SortOrder property path part of EntityType = "+this._oPresentationVariant._bIsPresentationVariantSortPathInVHDEntityType+". Is property sortable ="+this._oPresentationVariant._bIsPresentationVariantSortOrderPropertySortable)}}else{if(this.sDDLBDisplayBehaviour===H.idOnly||this.sDDLBDisplayBehaviour===H.idAndDescription||this.sDDLBDisplayBehaviour===H.descriptionAndId){if(s){this._oSorter=new m(this.sKey)}}else{if(n){this._oSorter=new m(this.sDescription)}else if(this.sDescription!==this.sKey&&s){this._oSorter=new m(this.sKey)}}}};E.prototype._createSuggestionTemplate=function(){var t=0,e=0,i=0,o=this._aHighImportanceCols||this._aRecommendationCols||this._aCols,s;this._oTemplate=new l;if(o){this.oControl.removeAllSuggestionColumns();e=o.length;for(t=0;t<e;t++){var n=false,r="1px",h=o[t].suggestionsWidth;if(V.system.phone){h=undefined;if(t>=2){n=true;r=(t+1)*10+"rem"}}this.oControl.addSuggestionColumn(new a({header:new A({wrapping:true,wrappingType:B.Hyphenated,text:o[t].label}),demandPopin:n,popinDisplay:L.Inline,minScreenWidth:r,width:h}));if(o[t].isTimezone){s={path:this._resolveSuggestionBindingPath(o[t].template),parts:[{value:null},{path:this._resolveSuggestionBindingPath(o[t].template)}],type:o[t].oType}}else{s={path:this._resolveSuggestionBindingPath(o[t].template),type:o[t].oType,formatter:function(t){return w(t)}}}if(Array.isArray(o[t].template)){s={parts:[{path:this._resolveSuggestionBindingPath(o[t].template[0])},{path:this._resolveSuggestionBindingPath(o[t].template[1])}],formatter:function(t,e,i){var o=_.getFormatterFunctionFromDisplayBehaviour(t),s=o(e,i);return w(s)}.bind(this,o[t].displayBehaviour)}}this._oTemplate.addCell(new A({wrapping:true,text:s}));if(h){i+=parseFloat(h.substring(0,h.length-2))}}if(i>0){this.oControl.setProperty("maxSuggestionWidth",i+e+"em",true)}if(e===1){this.oControl._setSeparateSuggestions(false)}}this.oControl.data("_hassuggestionTemplate",true);if(this.oControl&&this.oControl._oSuggestionTable){this.oControl._oSuggestionTable.addStyleClass("sapUiCompValueListProviderTable")}};E.prototype._handleRowSelect=function(t,e,i){var o,s,n,r=i&&typeof i.getPath==="function"&&i.getPath()||"";if(t){o=t[this.sKey];s=t[this.sDescription]}if(o||o===""){if(this.oControl.addToken){s=w(_.getFormattedExpressionFromDisplayBehaviour(this.sTokenDisplayBehaviour,o,s));n=new u;n.setKey(o);n.setText(s);n.setTooltip(s);n.data("row",t);if(e){e(n)}if(this.oControl.getValue()===""){this.oControl.setValue("")}delete this.oControl.__sValidationText}else{if(this.sContext==="SmartField"&&this._selectedODataRowHandler){this._selectedODataRowHandler(o,t,r)}this.setValue(o);if(this.sContext==="SmartFilterBar"||this.sContext==="mdcFilterPanel"){this.oControl.setValue(_.getFormattedExpressionFromDisplayBehaviour(this.sSingleFieldDisplayBehaviour,o,s));this.oControl.setValueState("None");this.oFilterProvider.oModel.setProperty("/"+this.sFieldName,o);this.oFilterProvider._setSingleInputsTextArrangementFieldData(this.sFieldName,o,s);if(!this.oFilterProvider._oSingleFieldSetFromFilterData[this.sFieldName]){this.oControl.fireChange({value:o,validated:true})}delete this.oFilterProvider._oSingleFieldSetFromFilterData[this.sFieldName]}if(this.sContext!=="SmartFilterBar"){this.oControl.fireChange({value:o,validated:true})}}}if(this.fnAsyncWritePromise){this.fnAsyncWritePromise().then(this._calculateAndSetFilterOutputData.bind(this,[t]))}else{this._calculateAndSetFilterOutputData([t])}};E.prototype._multiInputValidator=function(t){if(!this.bInitialised){return}if(this._aValidators){var e;this._aValidators.some(function(i){e=i(t);return e},this);if(e){return e}}var i=t.suggestionObject,o,s=t.text;if(i){var n=this._getSuggestionsModelName(),r=i.getBindingContext(n);o=r.getObject();this._handleRowSelect(o,t.asyncCallback,r)}else if(s){this._validateInput(s,t.asyncCallback)}};E.prototype._validateInput=function(t,e,i){var o,s=[],n=this.oControl,r;if(this.sDisplayFormat==="UpperCase"){t=t.toUpperCase()}if(n.__sValidationText!==t){n.__sValidationText=t;if(t===this._truncateSearchText(t)){n.__bValidatingToken=true;this._calculateFilterInputData();if(this.mFilterInputData&&this.aFilterField){s=T.generateFilters(this.aFilterField,this.mFilterInputData)}s.push(new p(this.sKey,c.EQ,t));if(this.bSupportBasicSearch){r={"search-focus":this.sKey}}this._pendingValidationCount++;o=new Promise(function(t,o){this.oODataModel.read("/"+this.sValueListEntitySetName,{filters:s,urlParameters:r,success:function(o){if(!this.oControl||!this._pendingValidationCount&&!this.oControl.hasOwnProperty("__bValidatingToken")){return}var s=o;delete this.oControl.__bValidatingToken;this._pendingValidationCount--;if(o){if(o.results&&o.results.length>=1){if(o.results.length===1){s=o.results[0]}if(this.sContext==="SmartFilterBar"&&this._fieldViewMetadata.filterRestriction==="single"){if(o.results.length>1){this.oFilterProvider.oModel.setProperty("/"+this.sFieldName,o.results[0][this.sKey])}if(!s.results){this._oHistoryValuesProvider&&this._oHistoryValuesProvider.setFieldData([s])}}if(this.oControl.data("__validationError")){this.oControl.data("__validationError",null);this.oControl.setValueState("None")}}else{this.oControl.setValueState("Error");this.oControl.data("__validationError",true)}if(s&&s[this.sKey]){n._pendingAutoTokenGeneration=true;this._handleRowSelect(s,e);n._pendingAutoTokenGeneration=false}}if(!i){this._afterTokenValidate()}t()}.bind(this),error:function(){if(this.oControl.data("__validationError")){this.oControl.setValueState("None")}delete this.oControl.__bValidatingToken;if(!i){this._afterTokenValidate()}t()}.bind(this)})}.bind(this));this._addValidationPromise(o)}else if(this.sContext==="SmartFilterBar"&&this._fieldViewMetadata.filterRestriction==="single"){n.setValueState(R.Error)}}else{if(n.data("__validationError")){n.setValueState(R.Error)}}};E.prototype._validateStringSingleWithValueList=function(t){var e;if(t.getParameter("validated")){return}e=t.getParameter("value");if(e===""||e===undefined){return}this._validateInput(e)};E.prototype._afterTokenValidate=function(){if(this.oFilterProvider&&this.oFilterProvider._oSmartFilter&&this.oFilterProvider._oSmartFilter.bIsSearchPending&&this.oFilterProvider._oSmartFilter.search){if(this.oFilterProvider._oSmartFilter.getLiveMode&&this.oFilterProvider._oSmartFilter.getLiveMode()){return}this.oFilterProvider._oSmartFilter.search()}};E.prototype._onSuggestionItemSelected=function(t){var e,i=t.getParameter("selectedRow");if(i){var o=this._getSuggestionsModelName();e=i.getBindingContext(o);this._handleRowSelect(e.getObject(),null,e)}};E.prototype._setFilterOutputDataFromSelectedRow=function(t){var e,i,o;if(t){e=this._getSuggestionsModelName();i=t.getBindingContext(e);o=i.getObject();this._calculateAndSetFilterOutputData([o])}};E.prototype._onMultiComboBoxItemSelected=function(t){if(!t.getParameter("selected")){return}var e=t.getParameter("changedItem");this._setFilterOutputDataFromSelectedRow(e)};E.prototype._onComboBoxItemSelected=function(t){var e=t.getParameter("value"),i=t.getParameter("newValue"),o=t.getParameter("filterChangeReason");if(o&&!e&&!i){return}var s=this.oControl.getSelectedItem();this._setFilterOutputDataFromSelectedRow(s)};E.prototype._handleSelect=function(){if(this.oControl.addValidator){this._aValidators=this.oControl&&this.oControl.isA("sap.m.MultiInput")?this.oControl.getValidators().slice():[];this.oControl.removeAllValidators();this._fValidator=this._multiInputValidator.bind(this);this.oControl.addValidator(this._fValidator)}else if(this.oControl.attachSuggestionItemSelected){this.oControl.attachSuggestionItemSelected(this._onSuggestionItemSelected,this);if(this.sContext==="SmartFilterBar"&&this._fieldViewMetadata&&this._fieldViewMetadata.hasValueListAnnotation){this.oControl.attachChange(this._validateStringSingleWithValueList,this)}}if(this.oControl.setRowResultFunction){this.oControl.setRowResultFunction(function(t){var e,i="",s=this._getSuggestionsModelName();if(t){e=t.getBindingContext(s)}if(e&&this.sKey){i=e.getProperty(this.sKey)}if(i&&this.sContext=="SmartField"&&o.getIsTimezoneProperty(this._fieldViewMetadata)){i=this.oControl.getBinding("value").getType().formatValue([null,i],"string")}return i}.bind(this))}};E.prototype._filterDropdownRowsByInParameters=function(){this._calculateFilterInputData();if(this.mFilterInputData&&this.aFilterField){this.oControl.setBusy(true);this._fetchData();this._mLastFilterInputData=this.mFilterInputData;if(!this.oControl.isA("sap.m.Select")){this._cleanupControlSelection()}}};E.prototype.isInSmartFilterBar=function(){return!!this.oFilterModel};E.prototype.isDisableSearchMatchesPatternWarning=function(){if(this._disableSearchMatchesPatternWarning===undefined&&this.isInSmartFilterBar()&&this.oFilterProvider&&this.oFilterProvider._oSmartFilter){this._disableSearchMatchesPatternWarning=this.oFilterProvider._oSmartFilter.getDisableSearchMatchesPatternWarning()}return this._disableSearchMatchesPatternWarning};E.prototype._isControlDropdown=function(t){if(!t){t=this.oControl}return!!(t.isA("sap.m.MultiComboBox")||t.isA("sap.m.ComboBox"))||t.isA("sap.m.Select")};E.prototype._cleanupControlSelection=function(){if(this.oControl.isA("sap.m.MultiComboBox")){this.oControl.setSelectedKeys(null);if(this.isInSmartFilterBar()){this.oFilterModel.setProperty("/"+this.sFieldName+"/items",[])}}else{this.oControl.setSelectedKey(null);this.oControl.clearSelection()}};E.prototype._openDropdown=function(){if(this.oControl.isA("sap.m.MultiComboBox")){P.prototype.open.apply(this.oControl,arguments)}else if(this.oControl.isA("sap.m.ComboBox")){v.prototype.open.apply(this.oControl,arguments)}else if(this.oControl.isA("sap.m.Select")){b.prototype.open.apply(this.oControl,arguments)}};E.prototype._handleOutParameters=function(){if(this.oControl.isA("sap.m.MultiComboBox")){this.oControl.attachSelectionChange(this._onMultiComboBoxItemSelected,this)}else if(this.oControl.isA("sap.m.ComboBox")||this.oControl.isA("sap.m.Select")){this.oControl.attachChange(this._onComboBoxItemSelected,this)}};E.prototype._handleInParameters=function(){this.oControl.setBusyIndicatorDelay(0);this._calculateFilterInputData();this._mLastFilterInputData=this.mFilterInputData;this.oControl.open=function(){this._calculateFilterInputData();if(F(this._mLastFilterInputData,this.mFilterInputData)){this._openDropdown();return}this._filterDropdownRowsByInParameters();this._openDropdown()}.bind(this);this.oControl.addEventDelegate({onmousedown:function(t){if(this.oControl.getArrowIcon&&t.target===this.oControl.getArrowIcon().getFocusDomRef()){this._bSkipFocusIn=true}}.bind(this),onmouseup:function(t){if(this._bSkipFocusIn&&(this.oControl.getArrowIcon&&t.target===this.oControl.getArrowIcon().getFocusDomRef())){this.oControl.open()}this._bSkipFocusIn=false}.bind(this),onfocusin:function(t){if(this._bSkipFocusIn){return t}setTimeout(function(){this._calculateFilterInputData();if(F(this._mLastFilterInputData,this.mFilterInputData)){return}this._filterDropdownRowsByInParameters()}.bind(this));return t}.bind(this)})};E.prototype._primaryValueListAnnotationChanged=function(t){var e=this.oControl,i=this._oMetadataAnalyser,o,s,n=[],r=e.getBindingContext()&&e.getBindingContext().getPath();if(r){o=e.getModel()&&e.getModel().getContext(r);s=i.getPropertyContextByPath(this._sFullyQualifiedFieldName);n=i._getODataValueListRelevantQualifiers(s,o)}if(n.length>0&&(!n.includes(this.oPrimaryValueListAnnotation.qualifier)||n.includes("")&&this.oPrimaryValueListAnnotation.qualifier!=="")){i.getValueListAnnotationLazy(this._sFullyQualifiedFieldName,r).then(function(i){if(e.oParent&&e.oParent._oFactory){e.oParent._oFactory._initValueList(i)}this._onAnnotationLoad(i);this._rebindInnerControlSuggestions();this._fetchData(t)}.bind(this));return true}return false};E.prototype._fetchData=function(t){var e={},i=[],s=this._getBindingLength(),n="",r,a;if(o.hasValueListRelevantQualifiers(this._fieldViewMetadata)&&this._primaryValueListAnnotationChanged(t)){return}t=t||"";if(this.bTypeAheadEnabled){if(t&&this.sDisplayFormat==="UpperCase"){t=t.toUpperCase()}if(this.bSupportBasicSearch){if(this._shouldHaveRecommendations()||this._shouldHaveHistory()){e={"search-focus":this.sKey,search:t}}else{e.custom={"search-focus":this.sKey,search:t}}}this._calculateFilterInputData();if(this.mFilterInputData&&this.aFilterField){i=T.generateFilters(this.aFilterField,this.mFilterInputData,{dateSettings:this._oDateFormatSettings})}if(!this.bSupportBasicSearch){if(this._fieldViewMetadata&&this._fieldViewMetadata.filterType==="numc"){i.push(new p(this.sKey,c.Contains,t))}else{n=this._truncateSearchText(t);if(n===t){i.push(new p(this.sKey,c.StartsWith,n))}else{this.oControl.closeSuggestions();return}}}s=10}e["$top"]=s;e["$skip"]=0;if(!this.sValueListEntitySetName){D.error("ValueListProvider","Empty sValueListEntitySetName for "+this.sAggregationName+" binding! (missing primaryValueListAnnotation)")}if(this.sDeferredGroupId){e["batchGroupId"]=this.sDeferredGroupId}if(this.aSelect&&this.aSelect.length){e["$select"]=this.aSelect.toString()}if(!(this._shouldHaveRecommendations()||this._shouldHaveHistory())||!this._isControlSupportedForHistory(this.oControl)){if(this.bTypeAheadEnabled&&this.bEnableShowTableSuggestionValueHelp&&this._isSuggestionEnabled()){a={dataReceived:function(t){var e=t.getSource(),i;if(e){i=e.getLength();if(i&&i<=s){this.oControl.setShowTableSuggestionValueHelp(false)}else{if(!this.bShowAllSuggestionsButton){this.oControl.setShowTableSuggestionValueHelp(false)}else{this.oControl.setShowTableSuggestionValueHelp(true)}}}}.bind(this)}}else if(!this._isSuggestionEnabled()&&this.oControl.setShowTableSuggestionValueHelp&&this.oControl.setShowSuggestion){this.oControl.setShowTableSuggestionValueHelp(false);this.oControl.setShowSuggestion(false)}else if(this.bTypeAheadEnabled){this.oControl.setShowTableSuggestionValueHelp(false)}if(this.aSelect&&this.aSelect.length){e["select"]=this.aSelect.toString();delete e["$select"]}if(this._isControlDropdown(this.oControl)&&(this.mInParams&&Object.keys(this.mInParams).length>=1||this.mConstParams&&Object.keys(this.mConstParams).length>=1)){if(!a){a={dataReceived:function(t){this.oControl.setBusy(false);this._resetValueState(t)}.bind(this)}}this._calculateFilterInputData();if(this.mFilterInputData&&this.aFilterField){i=T.generateFilters(this.aFilterField,this.mFilterInputData,{dateSettings:this._oDateFormatSettings,viewMetadataData:this._createViewMetadataData()})}}this.oControl.bindAggregation(this.sAggregationName,{path:"/"+this.sValueListEntitySetName,length:s,parameters:e,filters:i,sorter:this._oSorter,events:a,template:this._oTemplate,templateShareable:true});return}this._bindInnerControlSuggestions();var l=this;r=new Promise(function(t,o){if(!l.sValueListEntitySetName||!l._isSuggestionEnabled()&&!l._isControlDropdown()){t({results:[]});return}if(!l._isSuggestionEnabled()){t({results:[]});return}l.oODataModel.read("/"+l.sValueListEntitySetName,{urlParameters:e,filters:i,sorters:l._oSorter&&[l._oSorter],success:function(e){t(e)},error:function(t){o(t)}})});var h=Promise.resolve([]);if(this._shouldHaveHistory()){h=l._oHistoryValuesProvider.getFieldData()}Promise.all([r,this._oRecommendationListPromise,h]).then(function(t){var e=[],i=[],o=[],n=[],r=l._getSuggestionsModelName(),a=l.oControl;if(!a){return}var h=a.getModel(r);if(Array.isArray(t[0]&&t[0].results)){i=l._addSuggestionsToGroup(t[0].results,N.Others)}if(Array.isArray(t[1]&&t[1].results)){o=l._addSuggestionsToGroup(t[1].results,N.Recommendations)}if(l._shouldHaveHistory()&&Array.isArray(t[2])){n=l._addSuggestionsToGroup(t[2],N.RecentlyUsed);n=l._parseHistoryJsonDates(n)}e=e.concat(o).concat(n).concat(i);e=l._getDistinctSuggestions(e);e=e.filter(l._filterSuggestionsWithInParams.bind(l,l.mFilterInputData));l._showSuggestionsMoreButton(i.length>=s);if(l.oControl.isA("sap.m.MultiInput")){l.oControl._oSuggPopover._oProposedItem=null}h.setData(e)})};E.prototype._createViewMetadataData=function(){var t=this.mConstParams&&Object.keys(this.mConstParams),e=this.oPrimaryValueListAnnotation.aInitialValueIsSignificantFields,i=[];if(Array.isArray(this.aFilterField)&&this.aFilterField.length>0){i=this.aFilterField.map(function(i){var o={};o.name=i;o.fieldName=i;o.isConstant=Array.isArray(t)&&t.indexOf(i)!==-1;o.isInitialValueSignificant=Array.isArray(e)&&e.indexOf(i)!==-1;return o})}return[{fields:i}]};E.prototype._resetValueState=function(t){var e=t.getParameter("data"),i=e&&e.results,o;if(this.oControl.isA("sap.m.ComboBox")&&i){for(o=0;o<i.length;o++){if(i[o][this.sKey]==this.oControl.getSelectedKey()&&this.oControl.getValueState()===R.Error){this.oControl.setValueState(R.None)}}}};E.prototype._isSuggestionEnabled=function(){return this._bSuggestionsEnabled};E.prototype._sortRecommendations=function(t,e){var i=this._oRecommendationListAnnotation.rankProperty,o=parseFloat(t[i]),s=parseFloat(e[i]);return s-o};E.prototype._showSuggestionsMoreButton=function(t){if(!this.bTypeAheadEnabled){return}if(this.bEnableShowTableSuggestionValueHelp){this.oControl.setShowTableSuggestionValueHelp(t)}else{this.oControl.setShowTableSuggestionValueHelp(false)}};E.prototype._addSuggestionsToGroup=function(t,e){if(!t){return[]}return t.map(function(t){var i={};i[C.getSuggestionsGroupPropertyName()]=e;return Object.assign({},t,i)})};E.prototype._groupHeaderFactory=function(t){var e=this._getGroupHeaderTitle(t.key);if(this._isControlDropdown()){return new n({key:C.getHistoryPrefix()+t.key+".key",text:e})}return new r({title:e})};E.prototype._getGroupHeaderTitle=function(t){switch(t){case N.Recommendations:return this._oResourceBundle.getText("VALUELIST_RECOMMENDATIONS_TITLE");case N.RecentlyUsed:return this._oResourceBundle.getText("VALUELIST_RECENTLY_USED_TITLE");default:return this._oResourceBundle.getText("VALUELIST_OTHERS_TITLE")}};E.prototype._getGroupHeaderSorter=function(){if(this._groupHeaderSorter){return this._groupHeaderSorter}this._groupHeaderSorter=new m({path:C.getSuggestionsGroupPropertyName(),descending:false,group:function(t){return t.getProperty(C.getSuggestionsGroupPropertyName())}});return this._groupHeaderSorter};E.prototype._getDistinctSuggestions=function(t){var e={},i=[],o=this._aHighImportanceCols||this._aCols,s=o&&o.reduce(function(t,e){return t.concat(e.template)},[]);if(!s&&t.length>0){s=Object.keys(t[0])}t.forEach(function(t){var o=s.reduce(function(e,i){e.push([i,t[i]]);return e},[]);var n=o.toString();if(!e[n]){i.push(t);e[n]={index:i.length-1}}else if(e[n]&&Number.isInteger(e[n].index)){var r=e[n].index,a=i[r][C.getSuggestionsGroupPropertyName()];if(a!==N.Others){i[e[n].index][C.getForcedVisiblePropertyName()]=true}}},this);return i};E.prototype._resolveRecommendationListAnnotationData=function(t){var e=t.fieldsToDisplay,i,o,s;this._aRecommendationCols=[];this.aRecommendationSelect=[];for(var n=0;n<e.length;n++){i=e[n];o=this._getColumnConfigFromField(i);if(i.visible){this._aRecommendationCols.push(o);this.aRecommendationSelect.push(i.name)}}if(this._aHighImportanceCols&&this._oRecommendationListAnnotation){s=this._oRecommendationListAnnotation.rankField[0];s=this._getColumnConfigFromField(s);this._aHighImportanceCols.push(s)}};E.prototype._setupRecommendations=function(){if(!this._shouldHaveRecommendations()||!this._isControlSupportedForHistory(this.oControl)){return}this._resolveRecommendationListAnnotationData(this._getRecommendationListAnnotation());this._fetchRecommendations()};E.prototype._shouldHaveRecommendations=function(){return o.isRecommendationList(this._fieldViewMetadata)};E.prototype._getRecommendationListAnnotation=function(){if(!this._oRecommendationListAnnotation){var t=this._oMetadataAnalyser._getRecommendationListAnnotation(this._sFullyQualifiedFieldName);this._oRecommendationListAnnotation=this._oMetadataAnalyser._enrichRecommendationListAnnotation(t)}return this._oRecommendationListAnnotation};E.prototype._fetchRecommendations=function(){var t=this;this._oRecommendationListPromise=new Promise(function(e,i){t.oODataModel.read("/"+t._oRecommendationListAnnotation.path,{urlParameters:{$skip:0,$top:5,$select:t.aRecommendationSelect.toString()},sorter:t._oSorter,success:function(i){var o=t._addSuggestionsToGroup(i.results,N.Recommendations),s=t._getSuggestionsModelName(),n=t.oControl.getModel(s),r=n.getData(),a=o.sort(t._sortRecommendations.bind(t));t._aRecommendations=a;if(Array.isArray(r)){a=[].concat(r).concat(a)}n.setData(a);t._showSuggestionsMoreButton(false);e(i)},error:function(t){i(t)}})})};E.prototype._createHistoryValuesProvider=function(){return new y(this.oControl,this._sFullyQualifiedFieldName)};E.prototype._createHistoryOptOutProvider=function(){return S.createOptOutSettingPage()};E.prototype._setupHistoryValues=function(){if(!this._shouldHaveHistory()||!this._isControlSupportedForHistory(this.oControl)){return}this._oHistoryValuesProvider=this._createHistoryValuesProvider();this._createHistoryOptOutProvider();this._oHistoryValuesProvider.getHistoryEnabled().then(function(t){if(!t||!this._oHistoryValuesProvider){return}this._oHistoryValuesProvider.attachChangeListener();this._oHistoryValuesProvider.attachEvent("fieldUpdated",this._onHistoryFieldUpdated,this);this._oHistoryValuesProvider.getFieldData().then(this._onHistoryDataInitialized.bind(this))}.bind(this))};E.prototype._onHistoryDataInitialized=function(t){this._updateModelHistoryData(t);return t};E.prototype._onHistoryFieldUpdated=function(t){var e=t.getParameter("fieldData")||[];if(this.oControl.isA("sap.m.Input")){this._updateModelHistoryData(e);setTimeout(function(){this.oControl&&this.oControl._oSuggPopover._oPopover.close()}.bind(this),50);return}this._updateModelHistoryData(e);if(this.oControl.isA("sap.m.ComboBox")){setTimeout(function(){this.oControl&&this.oControl._oSuggestionPopover._oPopover.close()}.bind(this))}};E.prototype._updateModelHistoryData=function(t){if(!this.oControl){return}t=this._parseHistoryJsonDates(t);var e=[],i=this._addSuggestionsToGroup(t,N.RecentlyUsed),o=this._getSuggestionsModelName(),s=this.oControl.getModel(o),n=s.getData();if(!Array.isArray(n)){n=[]}e=this._getDistinctSuggestions(e.concat(i).concat(n));s.setData(e);this._showSuggestionsMoreButton(false)};E.prototype._getShellConfig=function(){var t=window["sap-ushell-config"];if(t){return t.apps}return null};E.prototype._getSuggestionsEnabled=function(){var t=this._getShellConfig(),e;if(t){e=t.inputFieldSuggestions}if(e){return e.enabled}return true};E.prototype._getUShellContainer=function(){return sap.ui.require("sap/ushell/Container")};E.prototype._shouldHaveHistory=function(){if(!this._fieldHistoryEnabled||!this._fieldViewMetadata||!this._sFullyQualifiedFieldName||!this.oControl||this._isControlDropdown()&&(this._fieldHistoryEnabledInitial||this._fieldHistoryEnabledInitial===undefined)&&this._fieldHistoryEnabled){return false}var t=this._getShellConfig(),e,i;if(t){e=t.inputFieldHistory}if(e){i=e.enabled}var s=this._getUShellContainer();return s&&i&&!o.isPotentiallySensitive(this._fieldViewMetadata)};E.prototype._bindInnerControlSuggestions=function(){if(this.sAggregationName&&this.oControl.isBound(this.sAggregationName)){return}this._rebindInnerControlSuggestions()};E.prototype._rebindInnerControlSuggestions=function(){if(this.sAggregationName&&this.sAggregationName==="suggestionRows"){this._createSuggestionTemplate()}else{this._createDropDownTemplate()}var t={path:this._getSuggestionsModelName()+">/",template:this._oTemplate,templateShareable:true,length:this._getBindingLength()};t.groupHeaderFactory=this._groupHeaderFactory;t.sorter=this._getGroupHeaderSorter();if(this.sAggregationName){this.oControl.bindAggregation(this.sAggregationName,t)}};E.prototype._setupSuggestionInteractions=function(){if(this.sAggregationName==="suggestionRows"){this._setupInputSuggestionInteractions();return}this._setupComboBoxSuggestionInteractions()};E.prototype._setupInputSuggestionInteractions=function(){var t=this.oControl;t.setFilterSuggests(true);t.setFilterFunction(function(t,e){var i=this._getSuggestionsModelName(),o=e.getBindingContext(i).getObject(),s=o[this.sKey],n=o[this.sDescription],r=_.getFormatterFunctionFromDisplayBehaviour(this.sDDLBDisplayBehaviour),a=r(s,n);if(o[C.getForcedVisiblePropertyName()]||o[C.getSuggestionsGroupPropertyName()]===N.Others){return true}t=t.replace(/\*$/,"");t=t.replace(/^\*/,"");var l=Object.keys(o).some(function(e){var i=o[e]+"";return i.toLowerCase().indexOf(t.toLowerCase())!==-1});var h=a.toLowerCase().indexOf(t.toLowerCase())!==-1;return l||h}.bind(this));t.attachLiveChange(function(t){var e=t.getParameter("value"),i=[N.RecentlyUsed,N.Recommendations];if(e===""){this.oControl._oSuggPopover._oPopover.close();this._showInitialSuggestions(i)}},this);t.addEventDelegate({onmousedown:function(e){if(this.oControl.getAggregation("_suggestionPopup")&&this.oControl.getAggregation("_suggestionPopup").isOpen()||e.target.tagName!=="INPUT"){return}this._bindInnerControlSuggestions();if(this._oHistoryValuesProvider){this._oHistoryValuesProvider.getFieldData().then(function(e){this._updateModelHistoryData(e);this._showInitialSuggestions("suggestionRows",t.getValue())}.bind(this))}},onkeyup:function(e){this._bindInnerControlSuggestions();if(e.keyCode!==9){return}if(this._oHistoryValuesProvider){this._oHistoryValuesProvider.getFieldData().then(function(e){this._updateModelHistoryData(e);this._showInitialSuggestions("suggestionRows",t.getValue())}.bind(this))}}},this);if(t.isA("sap.m.MultiInput")||!this._shouldHaveRecommendations()){return}t.attachSuggestionItemSelected(function(t){var e=this._getSuggestionsModelName(),i=t.getParameter("selectedRow"),o;if(i){var s=i.getBindingContext(e).getObject();o=s&&s[this.sKey]}if(this._isNotRecommendationItemSelected("suggestionRows",o)){this._setControlValueState(R.Warning)}else{this._setControlValueState(R.None)}},this)};E.prototype._setupComboBoxSuggestionInteractions=function(){var t=this.oControl;t.setShowSecondaryValues(true);t.addEventDelegate({onmousedown:function(e){if(this.oControl.getPicker()&&this.oControl.getPicker().isOpen()||e.target.tagName!=="INPUT"){return}this._bindInnerControlSuggestions();setTimeout(function(){this._showInitialSuggestions("items",t.getValue())}.bind(this))},onkeyup:function(e){this._bindInnerControlSuggestions();if(e.keyCode!==9){return}setTimeout(function(){this._showInitialSuggestions("items",t.getValue())}.bind(this))}},this);if(t.isA("sap.m.MultiComboBox")||!this._shouldHaveRecommendations()){return}t.attachChange(function(t){if(this._isNotRecommendationItemSelected("items",t.getParameter("value"))){this._setControlValueState(R.Warning)}else{this._setControlValueState(R.None)}},this)};E.prototype._isNotRecommendationItemSelected=function(t,e){return this._findSuggestionItemGroup(t,e)!==N.Recommendations};E.prototype._findSuggestionItemGroup=function(t,e){var i=this.oControl.getBinding(t),o=i?i.getCurrentContexts():[],s;for(var n=0;n<o.length;n++){var r=o[n].getObject(),a=r[this.sKey],l=r[this.sDescription];if(a===e||l===e){s=r;break}}return s?s[C.getSuggestionsGroupPropertyName()]:null};E.prototype._setControlValueState=function(t){this.oControl.setValueState(t?t:R.None);this.oControl.setValueStateText(" ")};E.prototype._showInitialSuggestions=function(t,e){var i=this,o=[N.RecentlyUsed,N.Recommendations],s=[N.RecentlyUsed],n=[];if(this._isNotRecommendationItemSelected(t,e)){n=o}else if(this._shouldHaveHistory()){n=s}this._calculateFilterInputData();this.oControl.showItems(function(t,e){var o=i._getSuggestionsModelName(),s=e.getBindingContext(o),r=s?s.getObject():{},a=r[C.getSuggestionsGroupPropertyName()];return i._filterSuggestionsWithInParams(i.mFilterInputData,r)&&n.indexOf(a)!==-1})};E.prototype._filterSuggestionsWithInParams=function(t,e){if(!t||t.length===0){return true}return Object.keys(t).every(function(i){var o=e[i];var s=t[i];if(!o){return true}if(typeof s==="string"){return s===o}if(typeof s==="object"&&s.items&&s.items.length>0){return s.items.some(function(t){return t.key===o})}return true})};E.prototype._getSuggestionsModelName=function(){var t;if(!this._isControlSupportedForHistory(this.oControl)){return t}if(this._shouldHaveRecommendations()||this._shouldHaveHistory()){t=x}return t};E.prototype._resolveSuggestionBindingPath=function(t){var e=this._getSuggestionsModelName();if(e){t=e+">"+t}return t};E.prototype._isControlSupportedForHistory=function(t){if(!t){return false}if(t.isA("sap.ui.comp.smartfield.DisplayComboBox")){return false}if(t.isA("sap.m.ComboBox")||t.isA("sap.m.MultiComboBox")||t.isA("sap.m.Input")||t.isA("sap.m.MultiInput")){return true}return false};E.prototype._getBindingLength=function(){var t=300;if(this.oODataModel&&this.oODataModel.iSizeLimit&&this.oODataModel.iSizeLimit>t){t=this.oODataModel.iSizeLimit}return t};E.prototype._parseHistoryJsonDates=function(t){return t.map(function(t){return Object.keys(t).reduce(function(e,i){if(s._hasJsonDateString(t[i])){e[i]=s._parseJsonDateString(t[i])}else{e[i]=t[i]}return e},{})})};E.prototype._truncateSearchText=function(t){var e=-1;if(this._sMaxLength){e=parseInt(this._sMaxLength)}else if(this._fieldViewMetadata&&this._fieldViewMetadata.maxLength){e=parseInt(this._fieldViewMetadata.maxLength)}if(e>-1&&t.length>e){t=t.substr(0,e)}return t};E.prototype._handlePresentationVariantSortOrderAnnotation=function(){var t,e,i=this.oPrimaryValueListAnnotation.valueListEntityName;if(!this._oMetadataAnalyser){this._oMetadataAnalyser=new o(this.oODataModel);this._bCleanupMetadataAnalyser=true}t=this._oMetadataAnalyser._getPresentationVariantQualifierForVHD(i);e=this._oMetadataAnalyser.getPresentationVariantAnnotation(i,t);if(e&&e.sortOrderFields.length!==0){e.sPresentationVariantSortPath=e.sortOrderFields[0].name;this._oMetadataAnalyser._getEntityDefinition(i).property.forEach(function(t){if(t.name===e.sPresentationVariantSortPath){e._bIsPresentationVariantSortPathInVHDEntityType=true}});this.oPrimaryValueListAnnotation.fields.forEach(function(t){if(t.name===e.sPresentationVariantSortPath&&t.sortable===true){e._bIsPresentationVariantSortOrderPropertySortable=true}})}return e};E.prototype._hasNotValidatedSingleField=function(t){return this.oFilterProvider&&this.oFilterProvider._oNotValidatedSingleFields&&this.oFilterProvider._oNotValidatedSingleFields[t]};E.prototype.unbindAggregation=function(){if(this.oControl){this.oControl.unbindAggregation(this.sAggregationName)}return this};E.prototype.destroy=function(){if(this.oControl){if(this.oControl.detachSuggest&&this._fSuggest){this.oControl.detachSuggest(this._fSuggest);this._fSuggest=null}if(this.oControl.removeValidator&&this._fValidator){this.oControl.removeValidator(this._fValidator);this._fValidator=null}else if(this.oControl.detachSuggestionItemSelected){this.oControl.detachSuggestionItemSelected(this._onSuggestionItemSelected,this)}if(this.oControl.detachChange){this.oControl.detachChange(this._validateStringSingleWithValueList,this)}this.oControl.unbindAggregation(this.sAggregationName);this.oControl.data("_hassuggestionTemplate",false);delete this.oControl.__sValidationText;delete this.oControl.__bValidatingToken}if(this._oHistoryValuesProvider){this._oHistoryValuesProvider.destroy();this._oHistoryValuesProvider=null}d.prototype.destroy.apply(this,arguments);if(this.oJsonModel){this.oJsonModel.destroy();this.oJsonModel=null}if(this._oTemplate){this._oTemplate.destroy()}this._oTemplate=null;this.sAggregationName=null;this.bTypeAheadEnabled=null;this._oSorter=null};return E});
/*!
 * SAPUI5
 * (c) Copyright 2009-2023 SAP SE. All rights reserved.
 */
sap.ui.predefine("sap/ui/comp/rules/RulesLog", ["sap/ui/base/Object"],function(e){"use strict";var t=e.extend("sap.ui.comp.rules.RulesLog");t.prototype.setInvokedMethod=function(e,t){if(this.mProperties===undefined||this.mProperties===null){this.mProperties={}}if(this.mProperties[e]===undefined){this.mProperties[e]=t}};t.prototype.getInvokedMethod=function(e){var t=null;if(this.mProperties!==undefined&&this.mProperties[e]!==undefined){t=this.mProperties[e]}return t};t.prototype.getInvokedMethods=function(){var e=null;if(this.mProperties!==undefined){e=this.mProperties}return e};return t},true);
/*
 * SAPUI5
 * (c) Copyright 2009-2023 SAP SE. All rights reserved.
 */
sap.ui.predefine("sap/ui/comp/smartfield/AnnotationHelper", [],function(){"use strict";var t=function(){};t.prototype.getText=function(t){return this._getObject("com.sap.vocabularies.Common.v1.Text/Path",t)};t.prototype.getTextArrangement=function(t,e,r){var o=null,a=null;a=this._getObject("com.sap.vocabularies.Common.v1.Text",t);if(a){o=a["com.sap.vocabularies.UI.v1.TextArrangement"]}if(!o){o=this._getObject("com.sap.vocabularies.UI.v1.TextArrangement",t)}if(!o){o=this._getObject("com.sap.vocabularies.UI.v1.TextArrangement",e)}if(r&&!o&&a&&a.Path){for(var n=0;n<e.property.length;n++){if(e.property[n].name===a.Path){a=e.property[n];var i=this._getObject("com.sap.vocabularies.Common.v1.Text",a);if(i&&!i.navigationPath){o=i["com.sap.vocabularies.UI.v1.TextArrangement"]}break}}}if(o&&o.EnumMember){if(o.EnumMember==="com.sap.vocabularies.UI.v1.TextArrangementType/TextFirst"){return"descriptionAndId"}if(o.EnumMember==="com.sap.vocabularies.UI.v1.TextArrangementType/TextLast"){return"idAndDescription"}if(o.EnumMember==="com.sap.vocabularies.UI.v1.TextArrangementType/TextSeparate"){return"idOnly"}if(o.EnumMember==="com.sap.vocabularies.UI.v1.TextArrangementType/TextOnly"){return"descriptionOnly"}}return null};t.prototype.getUnit=function(t){return this._getObject("Org.OData.Measures.V1.ISOCurrency/Path",t)||this._getObject("Org.OData.Measures.V1.Unit/Path",t)};t.prototype.getLabel=function(t){var e=this._getObject("com.sap.vocabularies.UI.v1.DataFieldWithUrl/Label/String",t);return e||this._getObject("com.sap.vocabularies.Common.v1.Label/String",t)};t.prototype.isCurrency=function(t,e){return!!(e&&e["sap:semantics"]==="currency-code")||!!(t&&this._getObject("Org.OData.Measures.V1.ISOCurrency/Path",t))};t.prototype.getQuickInfo=function(t){return this._getObject("com.sap.vocabularies.Common.v1.QuickInfo/String",t)};t.prototype.isMasked=function(t){return!!this._getObject("com.sap.vocabularies.Common.v1.Masked",t)};t.prototype.isMultiLineText=function(t){return!!this._getObject("com.sap.vocabularies.UI.v1.MultiLineText",t)};t.prototype.isStaticMandatory=function(t){var e=this._getObject("com.sap.vocabularies.Common.v1.FieldControl",t);if(e&&e.EnumMember){return e.EnumMember==="com.sap.vocabularies.Common.v1.FieldControlType/Mandatory"}return false};t.prototype.isStaticOptional=function(t){var e=this._getObject("com.sap.vocabularies.Common.v1.FieldControl",t);if(e&&e.EnumMember){return e.EnumMember==="com.sap.vocabularies.Common.v1.FieldControlType/Optional"}return false};t.prototype.isNullable=function(t){var e=this._getObject("nullable",t);if(e){return e==="true"}return true};t.prototype.isUpperCase=function(t){return this._getObject("com.sap.vocabularies.Common.v1.IsUpperCase/Bool",t)==="true"};t.prototype.canCreateEntitySet=function(t){return!(this._getObject("Org.OData.Capabilities.V1.InsertRestrictions/Insertable/Bool",t)==="false")};t.prototype.canCreateProperty=function(t){var e=this._getObject("Org.OData.Core.V1.Immutable/Bool",t);var r=this._getObject("Org.OData.Core.V1.Computed/Bool",t);if(r){return r=="false"}if(e){return e=="true"}return true};t.prototype.canUpdateEntitySet=function(t){return!(this._getObject("Org.OData.Capabilities.V1.UpdateRestrictions/Updatable/Bool",t)==="false")};t.prototype.getUpdateEntitySetPath=function(t){return this._getObject("Org.OData.Capabilities.V1.UpdateRestrictions/Updatable/Path",t)};t.prototype.canUpdateProperty=function(t){var e=this._getObject("Org.OData.Core.V1.Computed/Bool",t)==="true"||this._getObject("Org.OData.Core.V1.Immutable/Bool",t)==="true"||this._getObject("com.sap.vocabularies.Common.v1.FieldControl/EnumMember",t)==="com.sap.vocabularies.Common.v1.FieldControlType/ReadOnly";return!e};t.prototype.getFieldControlPath=function(t){return this._getObject("com.sap.vocabularies.Common.v1.FieldControl/Path",t)};t.prototype.getUIHiddenPath=function(t){return this._getObject("com.sap.vocabularies.UI.v1.Hidden/Path",t)};t.prototype.getVisible=function(t){var e=this._getObject("com.sap.vocabularies.Common.v1.FieldControl/EnumMember",t);if(e==="com.sap.vocabularies.Common.v1.FieldControlType/Hidden"){return"false"}var r=this._getObject("com.sap.vocabularies.UI.v1.Hidden",t);if(r&&r.Bool&&!(r.Bool=="false")){return"false"}return"true"};t.prototype.getImportanceAnnotation=function(t){var e,r=this._getObject("com.sap.vocabularies.UI.v1.Importance",t);if(r){e=r.EnumMember}switch(e){case"com.sap.vocabularies.UI.v1.ImportanceType/High":return"High";case"com.sap.vocabularies.UI.v1.ImportanceType/Medium":return"Medium";default:return"Low"}};t.prototype._getObject=function(t,e){var r=e,o=t.split("/"),a=0;while(r&&o[a]){r=r[o[a]];a++}return r};t.prototype.destroy=function(){};return t},true);
/*
 * SAPUI5
 * (c) Copyright 2009-2023 SAP SE. All rights reserved.
 */
sap.ui.predefine("sap/ui/comp/smartfield/BindingUtil", ["sap/ui/model/odata/AnnotationHelper","sap/ui/base/BindingParser"],function(t,r){"use strict";var e=function(){};e.prototype.correctPath=function(t){var r,e=/\((.+)\)*/,a=e.exec(t);if(a){r=t.replace(a[0],"")}else{r=t||""}return r.replace("/","")};e.prototype.getNavigationProperties=function(t){var r,e,a={};e=t.getBindingContext();if(e&&e.sPath){a.paths=e.sPath.split("/")}r=t.getObjectBinding();if(r&&r.sPath){a.objectBinding=r.sPath;if(a.paths){a.paths.push(r.sPath)}else{a.paths=[r.sPath]}}if(!a.paths){a.paths=[]}return a};e.prototype.getBindingParts=function(t,r,e){var a=0,o,p,n;if(t&&t.parts){a=t.parts.length}for(o=0;o<a;o++){n="";p=t.parts[o];if(p.model){n=n+p.model+">"}n=n+p.path;r.push(n);e.length++}};e.prototype.toBinding=function(t){var r={},e,a,o,p,n={model:true,formatter:true,mode:true,path:true};if(t){if(t.parts&&t.parts.length){p=t.parts.length;r.parts=[]}for(o=0;o<p;o++){a=t.parts[o];r.parts.push(a)}for(e in n){if(t[e]){r[e]=t[e]}}return r}return null};e.prototype.toBindingPath=function(t){var r,e="",a,o,p;r=this.toBinding(t);if(r){if(r.model){e=r.model+">"}if(r.path){e=e+r.path}else if(r.parts&&r.parts.length>0){p=r.parts.length;for(o=0;o<p;o++){a=r.parts[o];if(a.model){e=e+a.model+">"}e=e+a.path}}}return e};e.prototype.fromFormatter=function(t,r,e){var a,o,p,n={model:t,formatter:r.formatter};p=r.path();o=p.length;if(o>0){n.parts=p;if(e){for(a=0;a<o;a++){e.push(p[a])}}}else{n.path=""}return n};e.prototype.executeODataBindingExpression=function(e,a){var o,p,n,i,s,f="";if(e&&a){s=t.format(a,e);f=s;i=r.complexParser(s,a);n=[];if(i){if(i.formatter){for(o=0;o<i.parts.length;o++){p=a.getProperty(i.parts[o].path,"value");n.push(p)}f=i.formatter.apply(null,n)}else{f=a.getProperty(i.path,"value")}}}return f};e.prototype.destroy=function(){};return e},true);
/*!
 * SAPUI5
 * (c) Copyright 2009-2023 SAP SE. All rights reserved.
 */
sap.ui.predefine("sap/ui/comp/smartfield/ComboBox", ["sap/ui/comp/odata/ComboBox","sap/m/ComboBoxRenderer","sap/ui/comp/util/FormatUtil"],function(e,t,r){"use strict";var i="00000000-0000-0000-0000-000000000000";function s(e){return e===i}var a=e.extend("sap.ui.comp.smartfield.ComboBox",{metadata:{library:"sap.ui.comp",properties:{selectedKey:{type:"string",group:"Data",defaultValue:null},enteredValue:{type:"string",group:"Data",defaultValue:null},realValue:{type:"string",group:"Data",defaultValue:null},valueTextArrangement:{type:"string",group:"Misc",defaultValue:""}}},renderer:t});a.prototype.init=function(){e.prototype.init.apply(this,arguments);this.attachChange(function(){var e=this._getValue();if(this.getItemByKey(e)){this.setSelectedKey(e)}this.setProperty("realValue",e)}.bind(this))};a.prototype.onBeforeRendering=function(){e.prototype.onBeforeRendering.apply(this,arguments);this._processValueTextArrangement();this._synchronize()};a.prototype._processValueTextArrangement=function(){var e,t,i,s,a,l,n,u,o=this.getValueTextArrangement();i=this.getSelectedKey();s=this.getItemByKey(""+i);e=s&&s.getBinding("text");if(o&&s&&i!==""&&e&&Array.isArray(e.aBindings)){n=e.aBindings[0];l=e.aBindings[1];t=n&&n.getValue();a=l&&l.getValue();if(i!==t){return}u=r.getFormattedExpressionFromDisplayBehaviour(o,t,a);this.setValue(u)}};a.prototype._synchronize=function(){var e=this.getSelectedKey(),t=this.getKeys(),r=this.getItemByKey(""+e);if(r&&(e!==""||t.indexOf(e)!==-1)&&e===this.getValue()){this.setAssociation("selectedItem",r,true);this._setPropertyProtected("selectedItemId",r.getId(),true);this.setProperty("enteredValue",e);this.setProperty("realValue",e);this.setValue(r.getText());this._sValue=this.getValue()}};a.prototype.validateProperty=function(t,r){if(r===null&&(t==="enteredValue"||t==="selectedItemId"||t==="selectedKey"||t==="realValue"||t==="value")){return r}return e.prototype.validateProperty.apply(this,arguments)};a.prototype.setRealValue=function(e){if(e===null||s(e)){this.setValue("")}else{this.setValue(e)}this.setSelectedKey(e);return this.setProperty("realValue",e)};a.prototype.setEnteredValue=function(e){var t,r=this.getSelectedItem();if(typeof e!=="undefined"){this.setSelectedKey(e)}if(e&&!r&&!s(e)){this.setValue(e)}t=this._getValue();this.setProperty("enteredValue",t);return this};a.prototype._getValue=function(){var e,t=this.getSelectedKey(),r=this.getSelectedItem();if(r&&t!==null){e=t}else if(t===null&&this.getValue()===""){e=t}else{e=this.getValue()}return e};a.prototype.shouldResetSelection=function(e){var t=this.getKeys(),r=t.length===0||t.indexOf(e)!==-1;return e===this.getMetadata().getProperty("selectedKey").defaultValue||!r};return a});
/*!
 * SAPUI5
 * (c) Copyright 2009-2023 SAP SE. All rights reserved.
 */
sap.ui.predefine("sap/ui/comp/smartfield/Configuration", ["sap/ui/comp/library","sap/ui/core/Element"],function(e,a){"use strict";var i=a.extend("sap.ui.comp.smartfield.Configuration",{metadata:{library:"sap.ui.comp",properties:{controlType:{type:"sap.ui.comp.smartfield.ControlType",group:"Misc",defaultValue:null},displayBehaviour:{type:"sap.ui.comp.smartfield.DisplayBehaviour",group:"Misc",defaultValue:null},preventInitialDataFetchInValueHelpDialog:{type:"boolean",group:"Misc",defaultValue:false}}}});return i});
/*
 * SAPUI5
 * (c) Copyright 2009-2023 SAP SE. All rights reserved.
 */
sap.ui.predefine("sap/ui/comp/smartfield/ControlFactoryBase", ["sap/ui/base/Object","sap/ui/core/library","sap/ui/comp/library","sap/ui/model/BindingMode","sap/ui/comp/util/FormatUtil","sap/ui/comp/providers/ValueHelpProvider","sap/ui/comp/providers/ValueListProvider","sap/ui/comp/smartfield/BindingUtil","sap/ui/comp/odata/MetadataAnalyser","sap/m/HBox","sap/base/Log","sap/base/strings/capitalize","sap/ui/comp/smartfilterbar/SmartFilterBar","sap/ui/comp/smartfield/ValueListDelegate"],function(t,e,a,i,o,n,r,s,l,u,d,p,h,g){"use strict";var f=a.smartfield.ControlContextType;var c=e.ValueState;var y=t.extend("sap.ui.comp.smartfield.ControlFactoryBase",{constructor:function(e,a){t.apply(this,arguments);this.sName="ControlFactoryBase";this._oModel=e;this._oParent=a;this._oBinding=new s;this._aProviders=[];this._oRb=sap.ui.getCore().getLibraryResourceBundle("sap.ui.comp")}});y.prototype.bind=function(){return Promise.resolve()};y.prototype.createControl=function(t){var e,a;e=this._getCreator(t);if(e){a=this[e](t);this._addAriaLabelledBy(a);this._addAriaDescribedBy(a);if(a&&a.onCreate){this[a.onCreate](a.control,a.params)}}return a};y.prototype.updateControl=function(t){var e,a=t.mode,i=this._oParent,o=i.data("configdata");if(o&&o.configdata){e=i.getFirstInnerControl();if(o.configdata.onText&&a==="display"){o.configdata.onText(e)}else if(o.configdata.onInput&&a==="edit"){o.configdata.onInput(e)}}};y.prototype._addAriaLabelledBy=function(t){var e=this._getTargetControlForAccAttributes(t),a=this._oParent.getAriaLabelledBy();if(e&&e.addAriaLabelledBy&&a.length>0){e.removeAllAriaLabelledBy();a.forEach(function(t){e.addAriaLabelledBy(t)})}};y.prototype._addAriaDescribedBy=function(t){var e=this._getTargetControlForAccAttributes(t),a=this._oParent.getAriaDescribedBy();if(e&&e.addAriaDescribedBy&&a.length>0){e.removeAllAriaDescribedBy();a.forEach(function(t){e.addAriaDescribedBy(t)})}};y.prototype._getTargetControlForAccAttributes=function(t){var e,a=this._oParent.getControlContext();if(a===f.None||a===f.Form||a===f.SmartFormGrid){if(t){e=t.control;if(e instanceof u){if(e.getItems().length>0){e=e.getItems()[0]}}}}return e};y.prototype.addValidations=function(t,e){var a,i,o=this;a=function(t,a){var i,n,r=a.getParameter("targetControl")||a.getSource();if(r){if(r.setValueState){r.setValueState(t)}n=a.getParameter("exception");if(n){i=n.message}if(!i){i=a.getParameter("message")}if(r.setValueStateText){r.setValueStateText(i)}}if(e){o._oParent[e](t===c.Error)}};i=function(t){a(c.Error,t)};t.attachFormatError(i);t.attachParseError(i);t.attachValidationError(i);t.attachValidationSuccess(function(t){o._oParent.onValidation(t);a(c.None,t)})};y.prototype._isInnerUoM=function(){var t=this.getCustomDataConfiguration();return t&&t.isUOM&&t.isInnerControl};y.prototype._getDisplayBehaviourConfiguration=function(t){var e=null,i,o=this._isInnerUoM(),n=this._oParent._getComputedTextInEditModeSource()==="ValueListNoValidation";var r=this._oParent.getConfiguration();if(r){e=r.getDisplayBehaviour()}if(!e&&this._oMetaData&&this._oMetaData.entityType){e=this._oHelper.oAnnotation.getTextArrangement(this._oMetaData.property.property,this._oMetaData.entityType,n)}if(!e){if(!t&&this._oSelector){i=this._oSelector.checkComboBox({mode:"edit"});t=i&&i.combobox?"defaultDropDownDisplayBehaviour":"defaultInputFieldDisplayBehaviour"}e=this._oParent.data(t)}if(!e&&!o){e=a.DEFAULT_DISPLAY_BEHAVIOUR}return e};y.prototype._getPreventInitialDataFetchInVHDialog=function(t){var e=this._oParent.getConfiguration();if(e&&!e.isPropertyInitial("preventInitialDataFetchInValueHelpDialog")){return e.getPreventInitialDataFetchInValueHelpDialog()}if(l.isValueList(t)&&t["com.sap.vocabularies.Common.v1.ValueList"]&&t["com.sap.vocabularies.Common.v1.ValueList"].FetchValues){return t["com.sap.vocabularies.Common.v1.ValueList"].FetchValues.Int!=="1"}return false};y.prototype._formatDisplayBehaviour=function(t,e,a){var i=this._getDisplayBehaviourConfiguration(t);if(t==="defaultCheckBoxDisplayBehaviour"){return this._getFormattedExpressionFromDisplayBehaviour(i,e)}if(t==="defaultComboBoxReadOnlyDisplayBehaviour"&&!i){i="descriptionAndId"}return o.getFormattedExpressionFromDisplayBehaviour(i||"idOnly",e,a)};y.prototype._getFormattedExpressionFromDisplayBehaviour=function(t,e){var a="";switch(t){case"OnOff":a=e?"SMARTFIELD_CB_ON":"SMARTFIELD_CB_OFF";break;case"TrueFalse":a=e?"SMARTFIELD_CB_TRUE":"SMARTFIELD_CB_FALSE";break;default:a=e?"SMARTFIELD_CB_YES":"SMARTFIELD_CB_NO";break}return this._oRb.getText(a)};y.prototype.getDropdownItemKeyType=function(){};y.prototype.getValueStateBindingInfoForRecommendationStateAnnotation=function(){};y.prototype.createValueHelp=function(t){var e,a=this.getCustomDataConfiguration(),i=this._isInnerUoM()?a&&a.smartFieldRootControl:this._oParent,o=t.edmProperty,s=t.valueHelp;if(s.annotation&&(o["sap:value-list"]||o["com.sap.vocabularies.Common.v1.ValueList"])){var l=s.displayBehaviour||this._getDisplayBehaviourConfiguration(),u=this._oParent.data("dateFormatSettings"),d=this._getPreventInitialDataFetchInVHDialog(o);if(typeof u==="string"){try{u=JSON.parse(u)}catch(t){}}var p,f,c,y,m,_,v;if(typeof s.annotation==="string"){f=s.annotation}else if(s&&typeof s.annotation==="object"){if(a){c=a.annotations;if(c&&c.valuelist&&typeof c.valuelist==="string"){f=c.valuelist}}y=c&&(c.valueListData&&c.valueListData.annotation||c.valuelist);p=s.analyser.getValueListAnnotationForFunctionImport({"":y||s.annotation},o.name).primaryValueListAnnotation}var P=t.control,A=t.model,B=t.onValueListChange;if(!s.noDialog){if(P.setFilterSuggests){P.setFilterSuggests(false)}if(i){if(i.isContextTable&&i.isContextTable()){v=i.data("configdata")&&i.data("configdata").configdata;if(v){m=v.defaultFilterBarExpanded;_=v.defaultShowAllFilters}}else{m=i.data("defaultFilterBarExpanded");_=i.data("defaultShowAllFilters")}}var b=new n({context:"SmartField",fnAsyncWritePromise:this._oParent._isAsync&&this._oParent._isAsync()?this._oParent.checkValuesValidity.bind(this._oParent):null,selectedODataRowHandler:this._selectedODataRowHandler.bind(this),fieldName:o.name,control:P,model:A,dateFormatSettings:u,displayBehaviour:l,loadAnnotation:true,fullyQualifiedFieldName:f,metadataAnalyser:s.analyser,annotation:p,title:s.dialogtitle,preventInitialDataFetchInValueHelpDialog:d,supportMultiSelect:!!s.supportMultiSelect,supportRanges:!!s.supportRanges,takeOverInputValue:true,type:s.type,maxLength:o.maxLength,filterBarClass:h,enabledMultiSelectionPlugin:true,defaultFilterBarExpanded:m,defaultShowAllFilters:_});if(B){b.attachValueListChanged(B)}this._aProviders.push(b);if(P.setShowValueHelp){P.setShowValueHelp(true)}}var D=true,S=true,F=true;if(this._oParent._getHistoryEnabled){D=this._oParent._getHistoryEnabled();S=this._oParent.isPropertyInitial("historyEnabled")}if(this._oParent.getShowValueHelp&&!this._oParent.getShowValueHelp()){F=false}if(!s.noTypeAhead||!P.isA("sap.m.Input")){e={control:P,model:A,dateFormatSettings:u,displayBehaviour:l,fieldViewMetadata:o,loadAnnotation:true,fullyQualifiedFieldName:f,metadataAnalyser:s.analyser,annotation:p,aggregation:s.aggregation,typeAheadEnabled:!s.noTypeAhead,dropdownItemKeyType:this.getDropdownItemKeyType(P),maxLength:o.maxLength,fieldHistoryEnabled:D,fieldHistoryEnabledInitial:S,bShowAllSuggestionsButton:F};var C=new r(this.getValueListProviderConfiguration(e));if(!s.noTypeAhead){if(P.setShowSuggestion){P.setShowSuggestion(true)}}if(B){C.attachValueListChanged(B)}this.oValueListDelegate=new g(C);this._aProviders.push(C)}}};y.prototype.getValueListProviderConfiguration=function(t){return{context:"SmartField",fnAsyncWritePromise:this._oParent._isAsync&&this._oParent._isAsync()?this._oParent.checkValuesValidity.bind(this._oParent):null,selectedODataRowHandler:this._selectedODataRowHandler.bind(this),control:t.control,model:t.model,dateFormatSettings:t.dateFormatSettings,displayBehaviour:t.displayBehaviour,fieldViewMetadata:t.fieldViewMetadata,loadAnnotation:true,fullyQualifiedFieldName:t.fullyQualifiedFieldName,metadataAnalyser:t.metadataAnalyser,annotation:t.annotation,aggregation:t.aggregation,typeAheadEnabled:t.typeAheadEnabled,dropdownItemKeyType:t.dropdownItemKeyType,maxLength:t.maxLength,fieldHistoryEnabled:t.fieldHistoryEnabled,fieldHistoryEnabledInitial:t.fieldHistoryEnabledInitial,bShowAllSuggestionsButton:t.bShowAllSuggestionsButton}};y.prototype._selectedODataRowHandler=function(t,e,a){if(this.oTextArrangementDelegate){this.oTextArrangementDelegate.setDataForNextDescriptionRequest(t,e);this.oTextArrangementDelegate.setAbsolutePathToVLProperty(a)}};y.prototype.getAttribute=function(t){var e=this._oParent.getBindingInfo(t);if(e){return this._oBinding.toBindingPath(e)}return this._oParent["get"+t.substring(0,1).toUpperCase()+t.substring(1)]()};y.prototype.getCustomDataConfiguration=function(){var t=this._oParent&&this._oParent.data&&this._oParent.data("configdata");return t&&t.configdata?t.configdata:null};y.prototype.createAttributes=function(t,e,a,i){var o=this,n,r={};for(var s in a){if(a.hasOwnProperty(s)){var u=this._oParent.getBindingInfo(s);if(u){r[s]=this._oBinding.toBinding(u)}else if(s==="valueState"&&this._oParent.isPropertyInitial("valueState")){u=this.getValueStateBindingInfoForRecommendationStateAnnotation();if(u){r[s]=u}else{r[s]=this._oParent["get"+p(s)]()}}else{r[s]=this._oParent["get"+p(s)]()}}}if(t){if(e&&e.property&&e.property.type==="Edm.String"&&(this._oHelper.oAnnotation.isStaticOptional(e.property)||this._oParent&&this._oParent._fieldControlValue===3||this._oParent&&!this._oParent.getClientSideMandatoryCheck())){n={parseKeepsEmptyString:true}}if(e&&e.property&&l.getIsTimezoneProperty(e.property)){r[t]={model:this._oMetaData.model,path:this._oMetaData.path,parts:[{value:null},{path:this._oMetaData.path}],type:e?this._oTypes.getType(e,{showDate:false,showTime:false}):null,mode:this._oParent.getBindingMode("value")}}else{r[t]={model:this._oMetaData.model,path:this._oMetaData.path,type:e?this._oTypes.getType(e,n):null,mode:this._oParent.getBindingMode("value")}}}if(i){r[i.event]=function(t){try{var e=t.getParameters();var a={value:e[i.parameter],newValue:e[i.parameter]};o._oParent.fireChange(a)}catch(t){d.warning(t)}}}return r};y.prototype.mapBindings=function(t,e,a){var i,o;for(i in e){o=this._oParent.getBindingInfo(i);if(o){t[e[i]]=this._oBinding.toBinding(o)}else{t[e[i]]=a&&a[e[i]]||this._oParent["get"+i.substring(0,1).toUpperCase()+i.substring(1)]()}}};y.prototype.getFormatSettings=function(t){var e=null,a,i,o;if(t){e=this._oParent.data(t);if(!e){a=this._oParent.getCustomData();if(a){o=a.length;while(o--){i=a[o];if(i.getKey()===t){e=i.getValue();break}}}}if(e&&typeof e==="string"){try{e=JSON.parse(e)}catch(t){return null}}}return e};y.prototype.getValueListProvider=function(){return this._aProviders.find(function(t){return t.isA("sap.ui.comp.providers.ValueListProvider")})};y.prototype.destroyValueHelp=function(){this._aProviders.forEach(function(t){t.destroy()});this._aProviders=[]};y.prototype.destroy=function(){this.destroyValueHelp();if(this._oBinding){this._oBinding.destroy()}this._oBinding=null;this._oParent=null;this._oModel=null;this._oRb=null};return y},true);
/*!
 * SAPUI5
 * (c) Copyright 2009-2023 SAP SE. All rights reserved.
 */
sap.ui.predefine("sap/ui/comp/smartfield/ControlProposal", ["sap/ui/comp/library","sap/ui/core/Element"],function(e,a){"use strict";var t=e.smartfield.ControlProposalType;var o=a.extend("sap.ui.comp.smartfield.ControlProposal",{metadata:{library:"sap.ui.comp",properties:{controlType:{type:"sap.ui.comp.smartfield.ControlProposalType",group:"Misc",defaultValue:t.None}},aggregations:{objectStatus:{type:"sap.ui.comp.smartfield.ObjectStatus",multiple:false}}}});return o});
/*
 * SAPUI5
 * (c) Copyright 2009-2023 SAP SE. All rights reserved.
 */
sap.ui.predefine("sap/ui/comp/smartfield/FieldControl", ["sap/ui/comp/smartfield/BindingUtil","sap/ui/model/ParseException","sap/base/strings/capitalize","sap/base/util/isPlainObject","sap/ui/comp/library"],function(t,e,i,r,n){"use strict";var o=n.numericEdmTypes;var a=function(e,i){this._bIsDestroyed=false;this._oBinding=new t;this._oStoredProperties={};this._bVisibleSet=false;this._bEditableSet=false;this._bMandatorySet=false;this._bUomEditableSet=false;this._oStoredBindings={};this._oParent=e;this._oHelper=i;this._oAnnotation=i.oAnnotation};a.prototype.getPropertyNames=function(t){if(t){return["editable","visible"]}return["editable","visible","mandatory"]};a.prototype.getControlFormatters=function(t,e){var r,n,o,a={};if(t&&e){n=e.length;while(n--){o=e[n];r="_get"+i(o);if(this[r]){a[o]=this[r](t,this._oParent.getBindingInfo(o))}}}return a};a.prototype._getEditable=function(t,e,n){if(n===undefined){n="editable"}var o,a=this._oParent["get"+i(n)](),s=-1,p=-1,l=-1,d=-1,f=this;var u={length:0};if(n==="uomEditable"){this._bUomEditableSet=true}else{this._bEditableSet=true}if(!e){o=this._oParent["get"+i(n)]();this._oStoredProperties[n]=o;this._oStoredBindings.editable=null}else if(this._oStoredBindings.editable===undefined){this._oStoredBindings.editable=e}return{path:function(){var i=[],r,n=0;if(!t.property||!t.property.property){return[""]}r=f._oAnnotation.getFieldControlPath(t.property.property);if(r){i.push(f._toPath(t,r));s=n;n++}if(t.entitySet["sap:updatable-path"]){if(t.toRoleAssociationEndMultiplicity==="1"){i.push(f._toPath(t,t.entitySet["sap:updatable-path"]))}else{i.push(t.entitySet["sap:updatable-path"])}p=n;n++}if(e){l=n;f._oBinding.getBindingParts(e,i,u);n=n+u.length}if(t&&t.navigationPath&&!f._oParent._getEditableForNotExpandedNavigation()){i.push(t.navigationPath);d=n;n++}if(n>0){return i}return[""]},formatter:function h(_,y,g,b){if(f._bIsDestroyed){return false}if(!f._oAnnotation){return false}var c=this||f._oParent;var m;if(c&&typeof c.getBindingContext==="function"){m=c.getBindingContext()}var P=m&&m.getObject(),S=P&&P.__metadata,v=!!(S&&S.created),E=t.property&&t.property.property;if(P&&E){if(v){if(!f._getCreatableStatic(t)){return false}}else if(!f._getUpdatableStatic(t)){return false}}var B=[];if(s>-1){B.push(arguments[s]!==1)}if(p>-1&&(!P||!S||!v)&&arguments[p]!==undefined&&arguments[p]!==null){B.push(!!arguments[p])}if(l>-1){if(e.formatter){B.push(f._execFormatter(e.formatter,arguments,l,u.length))}else{B.push(!!arguments[l])}}if(d>-1){B.push(!!arguments[d])}if(B.length===0){var A=c&&c.getBinding(n),C=c&&c.getBindingPath(n),I=C==="",M=!!A&&A.isInitial(),T=_==null;if(T&&I&&(m&&!m.isTransient()||m===undefined)){o=f._oParent["get"+i(n)]()}else if(I&&r(_)&&P&&E&&f._getCreatableStatic(t)&&f._getUpdatableStatic(t)){o=f._oParent["get"+i(n)]()}else if(!M&&T){o=true}else if(!M&&a&&m&&m.isTransient()&&P&&E&&f._getCreatableStatic(t)){o=true}else if(!M&&!T&&I&&!r(_)){o=_}B.push(o)}return f._compare(B,false,true)}}};a.prototype._execFormatter=function(t,e,i,r){var n=[],o;if(i>-1&&r>-1){for(o=0;o<r;o++){n.push(e[i+o])}}return t.apply(this._oParent,n)};a.prototype._getCreatableStatic=function(t){var e=this._oAnnotation.canCreateEntitySet(t.entitySet),i=this._oAnnotation.canCreateProperty(t.property.property),r=t.ignoreInsertRestrictions;return(e||r)&&i};a.prototype._getUpdatableStatic=function(t){return this._oAnnotation.canUpdateEntitySet(t.entitySet)&&this._oAnnotation.canUpdateProperty(t.property.property)};a.prototype._compare=function(t,e,i){var r,n=t.length;for(r=0;r<n;r++){if(t[r]===e){return e}}return i};a.prototype._getVisible=function(t,e,n){if(n===undefined){n="visible"}var o,a=-1,s=-1,p=this;var l={length:0};this._bVisibleSet=true;if(!e){o=this._oParent["get"+i(n)]();this._oStoredProperties[n]=o;this._oStoredBindings.visible=null}else if(this._oStoredBindings.visible===undefined){this._oStoredBindings.visible=e}return{path:function(){var i=[],r,n=0;if(!t.property||!t.property.property){return[""]}r=p._oAnnotation.getUIHiddenPath(t.property.property);if(!r){r=p._oAnnotation.getFieldControlPath(t.property.property)}if(r){i.push(p._toPath(t,r));s=n;n++}if(e){a=n;p._oBinding.getBindingParts(e,i,l);n=n+l.length}if(n>0){return i}return[""]},formatter:function d(f,u){if(p._bIsDestroyed){return false}if(!p._oAnnotation){return false}var h=this||p._oParent;var _=t.property&&t.property.property;if(_&&p._oAnnotation.getVisible(_)==="false"||p._oAnnotation.getUIHiddenPath(_)&&f===true){return false}var y=[];if(s>-1){y.push(arguments[s]!==0);h._fieldControlValue=f}if(a>-1){if(e.formatter){y.push(p._execFormatter(e.formatter,arguments,a,l.length))}else{y.push(!!arguments[a])}}if(y.length==0){var g=h&&h.getBinding(n),b=h&&h.getBindingPath(n),c=b==="",m=!!g&&g.isInitial(),P=f==null,S;if(m&&P&&c){S=o}else if(!m&&P){S=true}else if(!m&&!P&&c&&!r(f)){S=f}else{S=p._oParent["get"+i(n)]()}y.push(S)}return p._compare(y,false,true)}}};a.prototype._getMandatory=function(t,e){var i=-1,r=-1,n=this;var o={length:0};this._bMandatorySet=true;if(!e){this._oStoredProperties.mandatory=this._oParent.getMandatory();this._oStoredBindings.mandatory=null}else if(this._oStoredBindings.mandatory===undefined){this._oStoredBindings.mandatory=e}return{path:function(){var a=[],s,p=0;if(!t.property||!t.property.property){return[""]}s=n._oAnnotation.getFieldControlPath(t.property.property);if(s){a.push(n._toPath(t,s));r=p;p++}if(e){i=p;n._oBinding.getBindingParts(e,a,o);p=p+o.length}if(p>0){return a}return[""]},formatter:function a(s,p){var l=t.property&&t.property.property,d=[],f,u,h;if(l&&l.nullable!==undefined){h=l&&l.nullable==="false"?true:false}if(n._bIsDestroyed){return true}f=r>-1;if(f){if(arguments[r]===7){h=true}else if(arguments[r]===3){h=false}}if(l&&n._oAnnotation){if(n._oAnnotation.isStaticMandatory(l)){h=true}else if(n._oAnnotation.isStaticOptional(l)){h=false}}if(h!==undefined){d.push(h)}u=i>-1;if(u){if(e.formatter){d.push(n._execFormatter(e.formatter,arguments,i,o.length))}else{d.push(!!arguments[i])}}if(d.length===0||l&&l.nullable==="true"&&!f&&!u){d.push(n._oParent.getMandatory())}return n._compare(d,true,false)}}};a.prototype._toPath=function(t,e){if(t.property.complex){return t.path.replace(t.property.property.name,e)}if(t.navigationPath){return t.navigationPath+"/"+e}return e};a.prototype.getMandatoryCheck=function(t,i){if(t){switch(t.property.type){case"Edm.DateTimeOffset":case"Edm.DateTime":case"Edm.Time":case"Edm.String":case"Edm.Decimal":case"Edm.Double":case"Edm.Float":case"Edm.Single":case"Edm.Int16":case"Edm.Int32":case"Edm.Int64":case"Edm.Byte":case"Edm.SByte":case"Edm.Guid":return function(r,n){var a,s=sap.ui.getCore().getLibraryResourceBundle("sap.ui.comp"),p=i?r==null:r===""||r==null,l=o.indexOf(t.property.type)!==-1;if(p){if(this._oParent&&this._oParent.getComputedTextLabel&&this._oParent.getComputedTextLabel()){a=s.getText("MANDATORY_FIELD_WITH_LABEL_ERROR",[this._oParent.getComputedTextLabel()])}else{a=s.getText("MANDATORY_FIELD_ERROR")}if(this._oAnnotation&&(l&&!this._oAnnotation.isStaticMandatory(t.property))&&(!this._oAnnotation.isNullable(t.property)&&!this._oAnnotation.isStaticOptional(t.property)&&(this._oParent&&this._oParent._fieldControlValue!==3))&&(this._oParent.getClientSideMandatoryCheck()||t.property.type!=="Edm.String")){throw new e(a)}if(this._oParent.getClientSideMandatoryCheck()&&this._oParent.getMandatory()){throw new e(a)}}}.bind(this)}}};a.prototype.getUOMEditState=function(t){var e,i,r,n=0,o;o=this._oParent.getBindingInfo("editable");e=this._getEditable(t,o);r={model:t.model,path:this._oHelper.getUOMPath(t),entitySet:t.entitySet,entityType:t.entityType,property:{property:t.annotations.uom.property,complex:t.property.complex,typePath:this._oHelper.getUOMTypePath(t)}};i=this._getEditable(r,this._oParent.getBindingInfo("uomEditable"),"uomEditable");return{path:function(){var t=e.path(),r=i.path();if(t[0]===""&&r===""){return[""]}n=t.length;return t.concat(r)},formatter:function t(r,o,a,s){var p=[],l,d,f,u=arguments.length;for(l=0;l<n;l++){p.push(arguments[l])}d=e.formatter.apply(null,p);p=[];for(l=0;l<u;l++){p.push(arguments[l])}for(l=0;l<n;l++){p.shift()}f=i.formatter.apply(null,p);if(!f&&!d){return 0}return 1}}};a.prototype.hasUomEditState=function(t){var e;if(t&&t.annotations&&t.annotations.uom){e=this._oParent.getControlProposal();if(e){if(e.getControlType()==="ObjectNumber"){return true}if(e.getObjectStatus()){return true}}return this._oParent.getProposedControl()==="ObjectNumber"}return false};a.prototype.bindProperties=function(t){var e={propertiesNames:this.getPropertyNames()};t=Object.assign(e,t);var i=t.propertiesNames,r=t.metadata;if(i.length){var n=this.getControlFormatters(r,i);for(var o in n){var a=this._oBinding.fromFormatter(r.model,n[o]);this._oParent.bindProperty(o,a)}}};a.prototype.destroy=function(){if(this._oBinding){this._oBinding.destroy();this._oBinding=null}this._oAnnotation=null;var t=this._oParent;if(t&&!t._bInDestroy){var e=true;for(var r in this._oStoredProperties){t.unbindProperty(r,e);var n="set"+i(r),o=t[n];if(typeof o==="function"){o.call(t,this._oStoredProperties[r])}}if(this._oStoredProperties){if(!this._oStoredProperties.editable&&this._bEditableSet){t.unbindProperty("editable")}if(!this._oStoredProperties.visible&&this._bVisibleSet){t.unbindProperty("visible")}if(!this._oStoredProperties.mandatory&&this._bMandatorySet){t.unbindProperty("mandatory")}if(!this._oStoredProperties.uomEditable&&this._bUomEditableSet){t.unbindProperty("uomEditable")}}if(this._oStoredBindings){if(this._oStoredBindings.editable){t.bindProperty("editable",this._oStoredBindings.editable)}if(this._oStoredBindings.visible){t.bindProperty("visible",this._oStoredBindings.visible)}if(this._oStoredBindings.mandatory){t.bindProperty("mandatory",this._oStoredBindings.mandatory)}if(this._oStoredBindings.uomEditable){t.bindProperty("uomEditable",this._oStoredBindings.uomEditable)}}}this._oStoredProperties=null;this._oStoredBindings=null;this._oParent=null;this._oHelper=null;this._bIsDestroyed=true;this._bEditableSet=false;this._bMandatorySet=false;this._bVisibleSet=false;this._bUomEditableSet=false};return a},true);
/*
 * SAPUI5
 * (c) Copyright 2009-2023 SAP SE. All rights reserved.
 */
sap.ui.predefine("sap/ui/comp/smartfield/JSONControlFactory", ["sap/m/CheckBox","sap/m/ComboBox","sap/m/DatePicker","sap/m/Input","sap/m/Text","sap/ui/comp/smartfield/ControlFactoryBase","sap/ui/comp/smartfield/JSONTypes"],function(e,t,r,a,o,n,i){"use strict";var s=n.extend("sap.ui.comp.smartfield.JSONControlFactory",{constructor:function(e,t,r){n.apply(this,[e,t]);this.sName="JSONControlFactory";this._oMetaData=r;this._oTypes=new i}});s.prototype._getCreator=function(){var e={Boolean:"_createBoolean",Date:"_createDate",DateTime:"_createString",Float:"_createString",Integer:"_createString",String:"_createString"};if(!this._oParent.getEditable()||!this._oParent.getEnabled()){if(this._oParent.getJsontype()==="Boolean"){return"_createBoolean"}return"_createDisplay"}return e[this._oParent.getJsontype()]||"_createString"};s.prototype._createString=function(){var e,t,r={width:true,textAlign:true,placeholder:true,name:true,maxLength:true};e=!this._oParent.getShowValueHelp();t=!this._oParent.getShowSuggestion();if(e){if(this._oParent.data("controlType")==="dropDownList"){return this._createComboBox({annotation:null,noDialog:e,noTypeAhead:true})}}return{control:new a(this.createAttributes("value",this._oParent.getJsontype(),r,{event:"change",parameter:"value"})),onCreate:"_onCreate",noDialog:e,noTypeAhead:t,params:{getValue:"getValue"}}};s.prototype._createComboBox=function(e){var r={width:true,textAlign:true,placeholder:true,name:true};return{control:new t(this.createAttributes("value",this._oParent.getJsontype(),r,{event:"selectionChange",parameter:"selectedItem"})),onCreate:"_onCreate",params:{valuehelp:e,getValue:"getValue"}}};s.prototype._createBoolean=function(){var t=this.createAttributes("selected",this._oParent.getJsontype(),{},{event:"select",parameter:"selected"});t.enabled=this._oParent.getEditable()&&this._oParent.getEnabled();return{control:new e(t),onCreate:"_onCreate",params:{getValue:"getSelected"}}};s.prototype._createDate=function(){var e={width:true,textAlign:true,placeholder:true,name:true};return{control:new r(this.createAttributes("value",this._oParent.getJsontype(),e,{event:"change",parameter:"value"})),onCreate:"_onCreate",params:{getValue:"getValue"}}};s.prototype._createDisplay=function(){var e={width:true,textAlign:true};return{control:new o(this.createAttributes("text",this._oParent.getJsontype(),e))}};s.prototype._onCreate=function(e,t){var r;this.addValidations(e,"setSimpleClientError");if(t.getValue){r=t.getValue;t.getValue=function(){return e[r]()}}};s.prototype.destroy=function(){this._oTypes.destroy();this._oTypes=null;this._oMetaData=null;n.prototype.destroy.apply(this,[])};return s},true);
/*
 * SAPUI5
 * (c) Copyright 2009-2023 SAP SE. All rights reserved.
 */
sap.ui.predefine("sap/ui/comp/smartfield/JSONTypes", ["sap/ui/model/type/Boolean","sap/ui/model/type/Date","sap/ui/model/type/Float","sap/ui/model/type/Integer","sap/ui/model/type/String"],function(e,t,n,r,u){"use strict";var o=function(){};o.prototype.getType=function(o){if(o){switch(o){case"Boolean":return new e;case"Date":return new t;case"Float":return new n;case"Integer":return new r;default:return new u}}return null};o.prototype.destroy=function(){};return o},true);
/*
 * SAPUI5
 * (c) Copyright 2009-2023 SAP SE. All rights reserved.
 */
sap.ui.predefine("sap/ui/comp/smartfield/LifecycleUtil",["sap/base/util/Deferred"],function(e){"use strict";var t={};t._getNextModeRenderedPromise=function(){var t=new e,i;this._oNextRendering=t;i={onAfterRendering:function(e){var n=this._oControl[this.getMode()];if(n&&n.getFocusDomRef()){this.removeEventDelegate(i);clearInterval(this._iNMRPromiseTimeout);t.resolve(this)}}.bind(this)};this.addEventDelegate(i);this._iNMRPromiseTimeout=setInterval(t.reject.bind(this,"rejected by timeout"),1e3);return t.promise};t._createICRenderedDeferred=function(){var t;t=new e;this._oRenderedWithContext=t;new Promise(function(e){var t={onAfterRendering:function(i){var n=this._oControl[this.getMode()],r=this.getAggregation("_content");if(!n){return}if(n.getDomRef()&&n.getFocusDomRef()&&n.getBindingContext()&&n===r){this.removeEventDelegate(t);e()}}.bind(this)};this.addEventDelegate(t)}.bind(this)).then(function(){t.resolve()})};t._getICRenderedPromise=function(){var e=this._oRenderedWithContext;return e?e.promise:undefined};t._rejectAll=function(e){if(this._oNextRendering){this._oNextRendering.reject(e)}if(this._oRenderedWithContext){this._oRenderedWithContext.reject(e)}};return t},true);
/*
 * SAPUI5
 * (c) Copyright 2009-2023 SAP SE. All rights reserved.
 */
sap.ui.predefine("sap/ui/comp/smartfield/ODataControlFactory", ["sap/ui/core/library","sap/m/library","sap/ui/comp/library","sap/ui/model/BindingMode","sap/m/TextArea","sap/m/Link","sap/m/CheckBox","sap/m/ComboBox","sap/ui/comp/smartfield/ComboBox","sap/m/DatePicker","sap/m/DateTimePicker","sap/m/HBox","sap/m/Input","sap/m/Select","sap/m/Text","sap/m/ExpandableText","sap/ui/core/Configuration","sap/ui/core/Renderer","sap/ui/comp/navpopover/SmartLink","./ControlFactoryBase","./FieldControl","./ODataControlSelector","./ODataHelper","sap/ui/comp/odata/ODataModelUtilSync","./ODataTypes","./TextArrangementDelegate","sap/m/ObjectNumber","sap/m/ObjectIdentifier","sap/m/ObjectStatus","sap/m/TimePicker","sap/ui/comp/navpopover/SemanticObjectController","sap/ui/comp/util/FormatUtil","sap/ui/comp/smartfield/Configuration","sap/ui/comp/odata/MetadataAnalyser","sap/ui/comp/odata/FiscalMetadata","sap/ui/comp/navpopover/NavigationPopoverHandler","sap/ui/core/InvisibleText","sap/base/Log","sap/base/assert","sap/base/security/URLListValidator","sap/base/util/merge","sap/base/strings/capitalize","sap/base/util/deepClone","sap/base/strings/whitespaceReplacer","sap/m/FlexItemData","sap/ui/comp/odata/CalendarMetadata"],function(t,e,a,o,i,r,n,s,l,p,u,h,d,g,c,m,y,_,f,M,v,D,C,P,T,b,x,S,I,V,F,A,E,O,B,L,N,w,U,H,k,R,j,W,z,q){"use strict";var G=t.ValueState;var K=t.TextAlign;var $=e.InputType;var J=e.EmptyIndicatorMode;var Q=e.FlexJustifyContent;var X=a.smartfield.CriticalityRepresentationType;var Y=a.smartfield.ControlContextType;var Z=t.TextDirection;var tt=e.FlexAlignContent;var et=a.smartfield.TextInEditModeSource;var at;var ot=M.extend("sap.ui.comp.smartfield.ODataControlFactory",{constructor:function(t,e,a){var o;M.call(this,t,e);this.sName="ODataControlFactory";this._oMetaData={annotations:{}};this._oMeta=a;if(t){o=t}else if(a&&a.modelObject){o=a.modelObject}this._oHelper=new C(o,this._oBinding,null,true);this._oFieldControl=new v(e,this._oHelper);this._oTypes=new T(e);this._oSelector=new D(this._oMetaData,e,this._oTypes);this.oTextArrangementDelegate=new b(this);this.oValueListDelegate=null;this._bInitialized=false;this._bInitializeFromConfig=false;this.bPending=false;this.oMeasureField=null;at=sap.ui.require("sap/ui/comp/smartfield/SmartField");if(!at){throw new Error("SmartField module not loaded for "+this)}}});ot.prototype._checkBoxFlag=function(t){if(!t.type){return}if(t.type==="Edm.Boolean"){this._oParent._bEdmBoolDetected=true}};ot.prototype._findProperty=function(t,e){return t.parameter.find(function(t){return t.name===e})};ot.prototype._init=function(t){var e=t.entitySetObject||this._oHelper.oMeta.getODataEntitySet(t.entitySet),a=this._oMetaData.path===t.path&&this._oMetaData.entitySet&&e&&this._oMetaData.entitySet.name===e.name&&this._oMetaData.model===t.model,o;if(!e){o=this._oHelper.oMeta.getODataFunctionImport(t.entitySet);if(o){e=this._oHelper.oMeta.getODataEntitySet(o.entitySet)}}if(a){return}this._oMetaData.model=t.model;this._oMetaData.path=t.path;this._oMetaData.entitySet=e;if(this._oHelper.oMeta){U(this._oMetaData.entitySet,'The entity set named "'+t.entitySet+'" was not found in the "'+this._oHelper.oMeta.getODataEntityContainer().name+'" entity container of the service metadata document. - '+this.getMetadata().getName())}this._oMetaData.entityType=t.entityType||this._oHelper.oMeta.getODataEntityType(this._oMetaData.entitySet.entityType);this._oMetaData.navigationPath=t.navigationPath||null;if(typeof t.ignoreInsertRestrictions==="boolean"){this._oMetaData.ignoreInsertRestrictions=t.ignoreInsertRestrictions}if(this._oModel){this._oHelper.checkNavigationProperty(this._oMetaData,this._oParent);this._oHelper.getProperty(this._oMetaData);var i=this.getEdmProperty();if(!i&&o){i=this._findProperty(o,t.path);if(i){this._oMetaData.property.property=i}}U(!!i,'The EDM property "'+t.path+'" was not found in the "'+this._oMetaData.entityType.namespace+"."+this._oMetaData.entityType.name+'" entity type. - '+this.getMetadata().getName());if(i){this._checkBoxFlag(i);if(!this._oParent._shouldSuppressTextAnnotation()){this._oMetaData.annotations.text=this._oHelper.getTextProperty2(this._oMetaData)}this._oMetaData.annotations.uom=this._oHelper.getUnitOfMeasure2(this._oMetaData);this._oHelper.getValueListData(this._oMetaData);this._oMetaData.annotations.lineitem=this._oHelper.getAnalyzer().getLineItemAnnotation(this._oMetaData.entitySet.entityType);this._oHelper.getUOMValueListAnnotationPath(this._oMetaData);this._oMetaData.annotations.semantic=O.getSemanticObjectsFromProperty(i);this._oMetaData.annotations.semanticKeys=this._oHelper.getAnalyzer().getSemanticKeyAnnotation(this._oMetaData.entitySet.entityType);this._oMetaData._isNumber=O.isNumber(i);if(this._oMetaData.annotations.uom){this._oMetaData.annotations.uom.annotations={};this._oHelper.getValueListData(this._oMetaData.annotations.uom)}this._oHelper.getUOMTextAnnotation(this._oMetaData);if(this._oParent&&this._oParent.getExpandNavigationProperties&&this._oParent.getExpandNavigationProperties()){var r=this._oParent.getBindingContext(),n=r&&r.getObject(),s=n&&n.__metadata.created;if(!s){var l=this._oHelper.getAutoExpandProperties(i);if(l.length>0){this._oParent.bindElement({path:"",parameters:{expand:l,select:l}})}}}}}else{this._oMetaData.modelObject=t.modelObject;this._oMetaData.property=t.property;this._oMetaData.annotations.text=t.annotations.text;this._oMetaData.annotations.uom=t.annotations.uom;if(this._oMetaData.annotations.uom&&!this._oMetaData.annotations.uom.annotations){this._oMetaData.annotations.uom.annotations={}}if(t.annotations.valueListData){this._oMetaData.annotations.valuelist=t.annotations.valueListData}else{this._oMetaData.annotations.valuelist=t.annotations.valuelist}this._oMetaData.annotations.valuelistType=t.annotations.valuelistType;this._oMetaData.annotations.lineitem=t.annotations.lineitem;this._oMetaData.annotations.semantic=t.annotations.semantic;this._oMetaData.annotations.valuelistuom=t.annotations.valuelistuom}};ot.prototype._initValueList=function(t){var e=this._oMetaData.property,a=t.primaryValueListAnnotation;this._oMetaData.annotations.valueListData=a;e.valueListAnnotation=a;e.valueListKeyProperty=this._oHelper.getODataValueListKeyProperty(a);e.valueListEntitySet=this._oHelper.oMeta.getODataEntitySet(a.valueListEntitySetName);e.valueListEntityType=this._oHelper.oMeta.getODataEntityType(this._oHelper.oMeta.getODataEntitySet(a.valueListEntitySetName).entityType)};ot.prototype._getTextArrangementType=function(){var t=null,e=b.getPaths("ValueList",this._oMetaData);if(e.keyField&&e.descriptionField){t=this._oTypes.getType(this._oMetaData.property,null,null,{composite:true,keyField:e.keyField,descriptionField:e.descriptionField,valueListNoValidation:this._oParent._getComputedTextInEditModeSource()==="ValueListNoValidation"});if(!(t.isA("sap.ui.comp.smartfield.type.TextArrangementString")||t.isA("sap.ui.comp.smartfield.type.TextArrangementGuid"))){t=null}}return t};ot.prototype._createEdmDisplay=function(t){var e,a,o,i=this._getLocalTextAnnotation(),r=i&&i.path||null,n,s,l,p="getText",u=this,h={width:true,textAlign:true},d=this.getEdmProperty(),g=this._oParent.data("configdata"),_=this._oSelector.checkDatePicker()||(d?d.type.startsWith("Edm.Date"):false),f=d?d.type==="Edm.Time":false,M=d&&O.getIsTimezoneProperty(d);if(this._checkLink()&&!this._oSelector.useObjectIdentifier()){return this._createLink(_)}n=this.createAttributes(null,this._oMetaData.property,h);n.emptyIndicatorMode=J.Auto;this.oType=null;var v=d&&O.getTimezonePropertyPath(d)||false;if(d&&d.type==="Edm.DateTimeOffset"&&v){this.oType=this._getDateFormatType();var D=function(){if(!arguments[0]&&!(this.oType.oFormatOptions&&this.oType.oFormatOptions.showDate===false&&this.oType.oFormatOptions.showTime===false)){return""}return this.oType.formatValue(arguments,"string")};n.text={model:this._oMetaData.model,type:this.oType,parts:[{path:this._oMetaData.path,type:this.oType},{path:v,parameters:{useUndefinedForUnresolved:true}}],useRawValues:true,formatter:D.bind(this)}}else if(_||f){this.oType=this._getDateFormatType();n.text={model:this._oMetaData.model,path:this._oMetaData.path,type:this.oType}}else if(M){this.oType=this._oTypes.getType(this._oMetaData.property,{showDate:false,showTime:false});n.text={model:this._oMetaData.model,parts:[{value:null},{path:this._oMetaData.path}],type:this.oType}}else{n.text={model:this._oMetaData.model,type:this.oType};if(this._bTextInDisplayModeValueList&&this._oMetaData.property&&this._oMetaData.property.valueListAnnotation){l={};if(this._oHelper.oAnnotation.isUpperCase(this._oMetaData.property.property)){l.sDisplayFormat="UpperCase"}l.valueListNoValidation=this._oParent._getComputedTextInEditModeSource()==="ValueListNoValidation";s=this.oTextArrangementDelegate.getBindingInfo(l);this.oType=s.type;n.text.parts=s.parts}if(!this.oType){this.oType=this._oTypes.getType(this._oMetaData.property);n.text.path=this._oHelper.getEdmDisplayPath(this._oMetaData)}n.text.type=this.oType}if(d){a=this._oHelper.oAnnotation.isMasked(d);if(a){n.text.formatter=T.maskValue}if(r){o=this._oSelector.useObjectIdentifier(_,a);if(o){delete n.width;delete n.textAlign;n.text={path:this._oMetaData.path};n.title={path:this._oHelper.getEdmDisplayPath(this._oMetaData)};if(this._oParent.hasListeners("press")){n.titleActive=true;n.titlePress=function(t){u._oParent.firePress(t)}}else if(this._oMetaData.annotations.semantic&&this._oMetaData.annotations.semantic.defaultSemanticObject){var C;var P;var b=this._oMetaData.annotations.semantic.additionalSemanticObjects.concat(this._oMetaData.annotations.semantic.defaultSemanticObject);F.getDistinctSemanticObjects().then(function(t){C=F.hasDistinctSemanticObject(b,t);if(C){var e=u._oParent.getBindingInfo("value");var a=e.parts[0].path;P=new L({semanticObject:u._oMetaData.annotations.semantic.defaultSemanticObject,additionalSemanticObjects:u._oMetaData.annotations.semantic.additionalSemanticObjects,fieldName:a,navigationTargetsObtained:function(t){var e=sap.ui.getCore().byId(t.getSource().getControl());var a=t.getParameters().mainNavigation;if(a){a.setDescription(e.getText())}t.getParameters().show(e.getTitle(),a,undefined,undefined)}})}});n.titleActive={path:"$sapuicompsmartfield_distinctSO>/distinctSemanticObjects",formatter:function(t){return F.hasDistinctSemanticObject(b,t)}};n.titlePress=function(t){if(C&&P){P.setControl(t.getSource(t.getParameter("domRef")));P.openPopover()}}}}else if(!(g&&g.isInnerControl===true)){n.text={};n.text.parts=[];n.text.parts.push(this._oMetaData.path);n.text.parts.push(this._oHelper.getEdmDisplayPath(this._oMetaData));n.text.formatter=function(t,e){if(u.oType&&!u._bTextInDisplayModeValueList){t=u.oType.formatValue(t,"string")}if(u.oType&&u.oType.isA("sap.ui.comp.odata.type.NumericText")&&t===null&&e){t=""}return u._formatDisplayBehaviour(null,t,e)}}}else if(this._oSelector.checkCheckBox()){n.text.formatter=function(t){return u._formatDisplayBehaviour("defaultCheckBoxDisplayBehaviour",t)}}}if(o){e=new S(this._oParent.getId()+"-objIdentifier",n);if(this._oMetaData.annotations.semantic){e.setModel(F.getJSONModel(),"$sapuicompsmartfield_distinctSO")}}else{if(n.text.type&&n.text.type.isA("sap.ui.comp.smartfield.type.DateTime")&&n.text.type.oConstraints&&n.text.type.oConstraints.isDateOnly){n.wrapping=false}if(this._oParent.isContextTable()&&y.getRTL()){n.textDirection="LTR"}if(typeof n.text.formatter==="undefined"&&!v&&!M){n.text.formatter=function(t){return W(t)}}if(this._oHelper.oAnnotation.isMultiLineText(d)){delete n.width;e=new m(this._oParent.getId()+"-expandableText",n)}else{e=new c(this._oParent.getId()+"-text",n)}}if(o&&g&&g.configdata&&g.configdata.onText){delete g.configdata.onText}var x={control:e,onCreate:"_onCreate",params:{getValue:p,noValidations:true,type:null}};if(this.oType){x.type={type:this.oType,property:this._oMetaData.property}}return x};ot.prototype._getDateFormatType=function(){var t=this.getFormatSettings("dateFormatSettings"),e=this.getEdmProperty(),a;try{a=j(t)}catch(e){a=t}if(a&&e&&e.type==="Edm.DateTimeOffset"){a.UTC=false}return this._oTypes.getType(this._oMetaData.property,a)};ot.prototype._createEdmTime=function(){var t=this.getFormatSettings("dateFormatSettings"),e={width:true,placeholder:true,valueState:true,valueStateText:true};var a=ot.getBoundPropertiesMapInfoForControl(V.getMetadata().getName(),{propertyName:"value"})[0];var o={valueFormat:"HH:mm:ss"};o=Object.assign(o,this.createAttributes(a,this._oMetaData.property,e,{event:"change",parameter:"value"}));if(o.width===""){o.width="100%"}if(t){o[a].type=this._oTypes.getType(this._oMetaData.property,t)}var i=new V(this._oParent.getId()+"-timePicker",o);this._enhanceInputControls(i);return{control:i,onCreate:"_onCreate",params:{getValue:"getValue",type:{type:o.value.type,property:this._oMetaData.property}}}};ot.prototype._createObjectStatus=function(){var t=this.createAttributes(null,this._oMetaData.property,null),e=this._getLocalTextAnnotation();var a=ot.getBoundPropertiesMapInfoForControl(I.getMetadata().getName(),{propertyName:"value"})[0];if(e){t[a]={parts:[this._oHelper.getEdmDisplayPath(this._oMetaData)]}}else{t[a]={model:this._oMetaData.model,path:this._oMetaData.path,type:this._oTypes.getType(this._oMetaData.property)}}this._addObjectStatusAttributes(t);var o=new I(this._oParent.getId()+"-objStatus",t);return{control:o,onCreate:"_onCreate",params:{getValue:"getText",noValidation:true}}};ot.prototype._addObjectStatusAttributes=function(t){var e,a=this._oParent.getControlProposal(),o=a&&a.getObjectStatus();if(o){e=o.getBindingInfo("criticality")}var i=function(t){var e={0:G.None,1:G.Error,2:G.Warning,3:G.Success};var a={"com.sap.vocabularies.UI.v1.CriticalityType/Neutral":G.Neutral,"com.sap.vocabularies.UI.v1.CriticalityType/Negative":G.Warning,"com.sap.vocabularies.UI.v1.CriticalityType/Critical":G.Error,"com.sap.vocabularies.UI.v1.CriticalityType/Positive":G.Success};return a[t]||e[t]||G.None};var r=function(){var t={};t[G.Error]="sap-icon://error";t[G.Warning]="sap-icon://alert";t[G.Success]="sap-icon://sys-enter-2";t[G.None]=null;var a;if(e){if(e.formatter){a=e.formatter.apply(null,arguments)}else{a=arguments[0]}}else{a=o.getCriticality()}if(a===undefined||a===null){return null}return t[i(a)]};var n=function(){if(!o){return false}return o.getCriticalityRepresentationType()!==X.WithoutIcon};if(e){t.state={formatter:function(){var t;if(e.formatter){t=e.formatter.apply(null,arguments)}else{t=arguments[0]}return i(t)},parts:e.parts};if(n()){t.icon={formatter:r,parts:e.parts}}}else{if(o){t.state=i(o.getCriticality())}if(n()){t.icon=r()}}};ot.prototype._createInput=function(t){var e=new d(this._oParent.getId()+"-input",t);this._enhanceInputControls(e);return e};ot.prototype._enhanceInputControls=function(t){if(t.isA("sap.m.InputBase")&&typeof t._setPreferUserInteraction==="function"){t._setPreferUserInteraction(true)}};ot.prototype._createEdmString=function(t){var e={},a=t.mode,o={},i=this.isEmptyStringSignificant();if(this._oSelector.checkCheckBox()){return this._createCheckBox()}var r=this._oSelector.checkSelection();if(r.selection){return this._createSelect({valueHelp:ot.getValueHelpDropdownSettings(r)})}r=this._oSelector.checkComboBox(t);if(r.combobox){return this._createComboBox({valueHelp:ot.getValueHelpDropdownSettings(r),edit:true})}var n={width:true,textAlign:true,placeholder:true,tooltip:true,name:true,valueState:true,valueStateText:true};var s=this.getEdmProperty();if(this._oHelper.oAnnotation.isMultiLineText(s)){delete n["width"];return this._createMultiLineText({attributesNamesMap:n})}var l=this._oParent.isTextInEditModeSourceNotNone(),p=/Edm.String|Edm.Guid/.test(s.type);if(l||this._bTextInDisplayModeValueList){U(p,"The ValueList and NavigationProperty"+"members of the sap.ui.comp.smartfield.TextInEditModeSource enumeration are only supported for OData "+"EDM Properties typed as Edm.String or Edm.Guid. - "+this.getMetadata().getName())}var u=ot.getBoundPropertiesMapInfoForControl(d.getMetadata().getName(),{propertyName:"value"})[0];var h=this._oParent._getComputedTextInEditModeSource(),g,c;if(this._oParent.data("defaultTextInEditModeSource")&&this._oParent.isPropertyInitial("textInEditModeSource")&&a==="edit"){g=true}if(p){this.oTextArrangementDelegate.bValidMetadata=this.oTextArrangementDelegate.checkRequiredMetadata(h,g);c=this._oHelper.checkValueListRequiredMetadataForValidation(this._oMetaData.property)}if(this.oTextArrangementDelegate.bValidMetadata){o=this.createAttributes("",this._oMetaData.property,n);e.valueListNoValidation=this._oParent._getComputedTextInEditModeSource()==="ValueListNoValidation";o[u]=this.oTextArrangementDelegate.getBindingInfo(e)}else if(h===et.ValueList&&c&&a==="edit"){o=this.createAttributes(u,this._oMetaData.property,n);o[u]=this.oTextArrangementDelegate.getBindingInfo(e)}else if(i){o=this.createAttributes(u,Object.assign({isStringNullable:true},this._oMetaData.property),n)}else{o=this.createAttributes(u,this._oMetaData.property,n)}if(B.isFiscalValue(s)){o.placeholder=o.value.type.formatter.getPattern();return{control:this._createInput(o),onCreate:"_onCreate",params:{getValue:"getValue",type:{type:o.value.type,property:this._oMetaData.property}}}}if(q.isCalendarValue(s)){o.placeholder=o.value.type.formatter.getPattern();return{control:this._createInput(o),onCreate:"_onCreate",params:{getValue:"getValue",type:{type:o.value.type,property:this._oMetaData.property}}}}var m=o.value.type&&o.value.type.oConstraints;if(m&&m.maxLength&&!O.isValueList(s)){o.maxLength=m.maxLength}var y=this._createInput(o);if(this._oHelper.oAnnotation.isMasked(s)){y.setType($.Password)}var _=this.getCustomDataConfiguration();if(this.oTextArrangementDelegate.bValidMetadata){this._handleEventingForTextArrangement({control:y})}else{this._handleEventingForEdmString({control:y,edmProperty:this._oMetaData.property.property,currency:_&&_.currency})}return{control:y,onCreate:"_onCreate",params:{valuehelp:{annotation:r.annotation,noDialog:!this._oParent.getShowValueHelp(),noTypeAhead:!this._oParent.getShowSuggestion(),aggregation:"suggestionRows"},getValue:"getValue",type:{type:o.value.type,property:this._oMetaData.property,emptyStringSignificant:i}}}};ot.prototype.isEmptyStringSignificant=function(){var t=this.getEdmProperty(),e=t&&(t["sap:semantics"]==="currency-code"||t["sap:semantics"]==="unit-of-measure"),a=this._getDisplayBehaviourConfiguration(),o=a==="descriptionAndId"||a==="idAndDescription"||false,i=this._oMetaData.annotations&&this._oMetaData.annotations.valueListData,r=i&&i.descriptionField!==undefined;return o&&!e&&r||false};ot.prototype.getLocalTextPropertyName=function(){var t,e=this._oHelper.getAnalyzer(),a=this.getEdmProperty();if(e&&a){t=e.getDescriptionFieldName(a)}return t};ot.getValueHelpDropdownSettings=function(t){return{annotation:t.annotation,noDialog:true,noTypeAhead:true}};ot.prototype._getMaxLength=function(){return this._oTypes.getMaxLength(this._oMetaData.property,this._oParent.getBindingInfo("value"))};ot.prototype._addAriaLabelledBy=function(t){var e,a,o,i=this._oParent.getControlContext();if(i===Y.None||i===Y.Form||i===Y.SmartFormGrid){M.prototype._addAriaLabelledBy.apply(this,arguments);o=this._oParent.data("configdata");if(o&&o.configdata.isInnerControl){if(t){a=t.control;if(a instanceof h){if(a.getItems().length>0){a=a.getItems()[0]}}}if(a&&a.getAriaLabelledBy&&a.getAriaLabelledBy().length===0){var r=this.getEdmProperty();if(this._oHelper.oAnnotation.getLabel(r)){e=new N({text:this._oHelper.oAnnotation.getLabel(r)});a.addAriaLabelledBy(e);this._oParent.addAggregation("_ariaLabelInvisibleText",e)}}}}};ot.prototype._addAriaDescribedBy=function(){var t=this._oParent.getControlContext();if(t===Y.None||t===Y.Form||t===Y.SmartFormGrid){M.prototype._addAriaDescribedBy.apply(this,arguments)}};ot.prototype._handleEventingForEdmString=function(t){var e=t.control;if(!e){return}e.attachChange(function a(o){var i=this._getChangeEventParams(o),r=o&&o.getParameters(),n=o&&o.getSource();if(r){var s=r.value;i.value=s;i.newValue=s;if(e._oSuggestionPopup&&e._oSuggestionPopup.isOpen()){if(!r.validated){return}}if(t.currency){var l=this.getCurrencyValidationSettings();l.oSource=n;if(this._oHelper.oAnnotation.isUpperCase(t.edmProperty)&&s){s=s.toUpperCase();e.setValue(s)}}try{this._oParent.fireChange(i)}catch(t){w.error(t)}}}.bind(this))};ot.prototype._handleEventingForTextArrangement=function(t){var e=t.control;if(!e){return}e.attachChange(function(t){var a=this._getChangeEventParams(t),o=e._oSuggPopover,i=e.getShowSuggestion(),r=i&&o.isOpen(),n=false;if(r){var s=o.getItemsContainer&&o.getItemsContainer();n=s&&s.getSelectedItem()!==null}if(r&&(!a.validated&&n)){return}try{var l=this._oParent.data("configdata");if(l&&l.configdata&&this._oParent.isTextInEditModeSourceNotNone()){this._oParent.checkValuesValidity().catch(function(){}).finally(function(){this._oParent.fireChange(a)}.bind(this))}else{this._oParent.fireChange(a)}}catch(t){w.error(t)}}.bind(this))};ot.prototype.getUOMChangeHandler=function(t){return function(e){try{var a=t.smartFieldRootControl,o=e.getParameters(),i=o.value,r=e.getSource(),n=t.currency,s=n?this.getCurrencyValidationSettings(t):this.getUnitValidationSettings(t);s.oSource=r;n?this.updateModelPropertiesForCurrency("value",s):this.updateModelPropertiesForUnit("value",s);a.fireChange({value:i,newValue:i,unitChanged:!!t.unit,validated:!!o.validated})}catch(e){if(e.validationUnitError){a.fireChange({value:i,newValue:i,unitChanged:!!t.unit,validated:!!o.validated})}w.error(e)}}.bind(this)};ot.prototype.getCurrencyValidationSettings=function(t){var e;if(t){e=t.smartFieldRootControl}else{var a=this.getCustomDataConfiguration();e=a&&a.smartFieldRootControl}var o=e.getInnerControls();return{amountField:o[0],currencyField:o[1],errorState:e._oError,checkValidity:e.checkValuesValidity.bind(e),rootControl:e}};ot.prototype.getUnitValidationSettings=function(t){var e;if(t){e=t.smartFieldRootControl}else{var a=this.getCustomDataConfiguration();e=a&&a.smartFieldRootControl}var o=e.getInnerControls();return{measureField:o[0],unitField:o[1],errorState:e._oError,checkValidity:e.checkUnitValidity.bind(e),rootControl:e}};ot.prototype.updateModelPropertiesForCurrency=function(t,e){var a=e.amountField,i=e.currencyField,r=e.oSource,n=a.getValue(),s,l="";if(i){var p=i.getMetadata().getName();s=ot.getBoundPropertiesMapInfoForControl(p,{propertyName:t})[0];var u="get"+R(s);l=i[u]()}var h=[n,l];var d={rawValues:h,handleSuccess:false};var g=e.checkValidity(d);function c(e){var l=a.getModel(),p=a.getBinding(t),u,d;if(i){u=i.getBinding(s);d=u.getType()}var g=p.getType(),c=p.getExternalValue(),m=u&&u.getExternalValue(),y=g.parseValue(n,"string",h),_=y[1],f=g.formatValue(y,"string"),M=d&&d.formatValue(_,"string");if(l.getDefaultBindingMode()===o.TwoWay){if(!e){p.setValue(y)}}if(!e){a.setValue(f)}var v=false,D=true;if(p.hasValidation()&&!e){var C={element:a,property:t,type:g,newValue:f,oldValue:c,mParameters:{originSource:r}};a.fireValidationSuccess(C,v,D)}if(u&&u.hasValidation()){var P={element:i,property:s,type:d,newValue:M,oldValue:m,mParameters:{originSource:r}};i.fireValidationSuccess(P,v,D)}}function m(t){}function y(){var o=e.errorState;if(o.bComplex&&o.bFirst&&o.bSecond){var r=a.getBinding(t).getExternalValue();h=[r,l];var n={rawValues:h,innerControls:[i],handleSuccess:false};var s=e.checkValidity(n);s.then(function(){return c.call(this,true)}.bind(this)).catch(m)}}g.then(function(){return c()}).catch(m).finally(y)};ot.prototype.updateModelPropertiesForUnit=function(t,e){var a=e.measureField,i=e.unitField,r=a.getValue(),n,s="",l=e.oSource,p=a.getMetadata().getName(),u,h,d={},g,c;if(i){var m=i.getMetadata().getName();n=ot.getBoundPropertiesMapInfoForControl(m,{propertyName:t})[0];var y="get"+R(n),_=i.getParent();if(i.isA("sap.m.ComboBox")){s=i.getSelectedKey()}else if(this._getDisplayBehaviourConfiguration()&&_&&(!_.getEditable()||_._oFactory._getTextArrangementType())){s=_.getBinding("value").getValue()}else{s=i[y]()}}else if(this._checkSuppressUnit()){var f=this.getMetaData().annotations.uom.path,M=a.getBindingContext();s=this._oModel.getData(f,M)}var v=[r,s];var D={rawValues:v,handleSuccess:false};var C=e.checkValidity(D);if(C){var P=a.getModel(),T=a.getBinding(t),b,x;if(i){b=i.getBinding(n);x=b.getType()}var S=T.getType(),I=S.parseValue(r,"string",v),V=I[1],F,A;if(V===undefined&&i&&!i.getEditable){F=S.formatValue([I[0],null],"string");A=V}else{F=S.formatValue(I,"string");if(!T.isA("sap.ui.comp.smartfield.type.Unit")){V=s}A=x&&x.formatValue(V,"string")}if(P.getDefaultBindingMode()===o.TwoWay){T.setValue(I);u=false;h=true;d=ot.getBoundPropertiesMapInfoForControl(p,{propertyName:"value"});g=d&&d[0];c={element:a,property:g,type:T.getType(),newValue:r,oldValue:T.getValue(),mParameters:{originSource:l}};a.fireValidationSuccess(c,u,h)}a.setValue(F);if(i&&i.getEditable&&i.getEditable()&&i.getParent().getVisible()&&!i.isA("sap.m.ComboBox")){i.setValue(A)}}};ot.prototype._createComboBox=function(t){var e=null,a=this._oSelector&&this._oSelector._oParent&&this._oSelector._oParent.oParent&&this._oSelector._oParent.oParent.isA("sap.ui.comp.smartmultiedit.Field")||this._oParent&&this._oParent.getFixedValueListValidationEnabled&&this._oParent.getFixedValueListValidationEnabled(),o=a?s:l,i=this._oParent._getComputedTextInEditModeSource(),r=i==="ValueList"?"realValue":"value",n=a?"value":r,p={width:true,textAlign:true,placeholder:true,tooltip:true,name:true,valueState:true},u,h={},d={width:"100%"},g=false;u=ot.getBoundPropertiesMapInfoForControl(o.getMetadata().getName(),{propertyName:n})[0];h["change"]=this._oHelper.getDropdownChangeHandler(this._oParent,!a);if(t.edit){if(a){h=Object.assign(h,this.createAttributes(u,this._oMetaData.property,p),d);e=new s(this._oParent.getId()+"-comboBoxEdit",h)}else{if(O.getIsTimezoneProperty(this._oMetaData.property)){h=Object.assign(h,this.createAttributes(u,this._oMetaData.property,p),d)}else{g=true;h=Object.assign(h,this.createAttributes(u,Object.assign({isStringNullable:true},this._oMetaData.property),p),d)}e=new l(this._oParent.getId()+"-comboBoxEdit",h)}this._enhanceInputControls(e);e.attachChange(function(){this._oParent.oValidation.handleComboValidation(e)}.bind(this))}else{h=Object.assign(h,this.createAttributes(u,this._oMetaData.property,p),d);e=this._createDisplayedComboBox(h)}this._oParent.oValidation.addValidationToType(h[u].type);e.setFilterFunction(function(t,e){RegExp.escape=function(t){return t.replace(/[-/\\^$*+?.()|[\]{}]/g,"\\$&")};var a=RegExp.escape(t);var o=new RegExp(a,"i");return e.getText().match(new RegExp(o,"i"))||e.getKey().match(new RegExp(o,"i"))});e.useHighlightItemsWithContains=function(){return true};return{control:e,onCreate:"_onCreate",params:{valuehelp:{annotation:t.valueHelp.annotation,aggregation:"items",noDialog:t.valueHelp.noDialog,noTypeAhead:t.valueHelp.noTypeAhead},getValue:"get"+u[0].toUpperCase()+u.slice(1),type:{type:h[u].type,property:this._oMetaData.property,emptyStringSignificant:g}}}};ot.prototype._createDisplayedComboBox=function(t){var e=s.extend("sap.ui.comp.smartfield.DisplayComboBox",{metadata:{library:"sap.ui.comp",properties:{wrapping:{type:"boolean",group:"Appearance",defaultValue:true}}},renderer:{apiVersion:2,render:function(t,e){var a=e.getWidth(),o=e.getValue(),i=e.getTextDirection(),r=e.getTextAlign(),n=e.getTooltip_AsString(),s=e.getWrapping();t.openStart("span",e);t.class("sapMText");t.class("sapUiSelectable");if(s){if(o&&o.length>0&&!/\s/.test(o)){t.class("sapMTextBreakWord")}}else{t.class("sapMTextNoWrap")}if(a&&o!==""){t.style("width",a)}else{t.class("sapMTextMaxWidth")}if(i!==Z.Inherit){t.attr("dir",i.toLowerCase())}if(n){t.attr("title",n)}if(r){r=_.getTextAlign(r,i);if(r){t.style("text-align",r)}}var l=s?"sapMTextRenderWhitespaceWrap":"sapMTextRenderWhitespace";t.class(l);t.openEnd();o.replace(/\r\n|\n\r|\r/g,"\n");t.text(o);t.close("span")}},updateDomValue:function(t){if(!this.isActive()){return this}t=this._getInputValue(t);if(this.$().text()!==t){this.$().text(t);this._bCheckDomValue=true}return this},getValue:function(){return this.getProperty("value")},getFocusDomRef:function(){return this.getDomRef()},getEditable:function(){return false}});return new e(this._oParent.getId()+"-comboBoxDisp",t)};ot.prototype._createSelect=function(t){var e={width:true,name:true,valueState:true},a;var o=ot.getBoundPropertiesMapInfoForControl(g.getMetadata().getName(),{propertyName:"value"})[0];var i={change:this._oHelper.getDropdownChangeHandler(this._oParent),forceSelection:false};i=Object.assign(i,this.createAttributes(o,this._oMetaData.property,e));if(i.width===""){i.width="100%"}a=new g(this._oParent.getId()+"-select",i);this._enhanceInputControls(a);return{control:a,onCreate:"_onCreate",params:{valuehelp:{annotation:t.valueHelp.annotation,aggregation:"items",noDialog:t.valueHelp.noDialog,noTypeAhead:t.valueHelp.noTypeAhead},getValue:"getSelectedKey",type:{type:i.selectedKey.type,property:this._oMetaData.property}}}};ot.prototype._createCheckBox=function(){var t=ot.getBoundPropertiesMapInfoForControl(n.getMetadata().getName(),{propertyName:"value"})[0];var e=this.createAttributes(t,null,{},{event:"select",parameter:"selected"});e.editable=this._oParent.getEditable()&&this._oParent.getEnabled()&&this._oParent.getContextEditable();e.selected.type=this._oTypes.getAbapBoolean();return{control:new n(this._oParent.getId()+"-cBox",e),onCreate:"_onCreate",params:{getValue:"getSelected"}}};ot.prototype._createEdmDateTime=function(){var t=this.getFormatSettings("dateFormatSettings"),e,a,o;var i={width:true,textAlign:true,placeholder:true,name:true,valueState:true};var r=this.createAttributes(null,this._oMetaData.property,i,{event:"change",parameter:"value"});if(this._oSelector.checkDatePicker()){e=ot.getBoundPropertiesMapInfoForControl(p.getMetadata().getName(),{propertyName:"value"})[0];r[e]={path:this._oMetaData.path,type:this._oTypes.getType(this._oMetaData.property,t,{displayFormat:"Date"}),model:this._oMetaData.model,mode:this._oParent.getBindingMode("value")};if(t&&t.style){r.displayFormat=t.style}o=new p(this._oParent.getId()+"-datePicker",r);this._enhanceInputControls(o);return{control:o,onCreate:"_onCreate",params:{getValue:"getValue",type:{type:r.value.type,property:this._oMetaData.property}}}}e=ot.getBoundPropertiesMapInfoForControl(u.getMetadata().getName(),{propertyName:"value"})[0];r[e]={path:this._oMetaData.path,model:this._oMetaData.model,type:this._oTypes.getType(this._oMetaData.property,t),mode:this._oParent.getBindingMode("value")};a=new u(this._oParent.getId()+"-input",r);this._enhanceInputControls(a);return{control:a,onCreate:"_onCreate",params:{getValue:"getValue",type:{type:r.value.type,property:this._oMetaData.property}}}};ot.prototype._createEdmDateTimeOffset=function(){var t,e=this.getFormatSettings("dateFormatSettings"),a=this.getEdmProperty(),o;try{t=j(e)}catch(a){t=e}if(t){t.UTC=false}var i=ot.getBoundPropertiesMapInfoForControl(u.getMetadata().getName(),{propertyName:"value"})[0];var r={width:true,textAlign:true,placeholder:true,name:true,valueState:true};var n=this.createAttributes(null,this._oMetaData.property,r,{event:"change",parameter:"value"});var s=a&&O.getTimezonePropertyPath(a)||false;if(s){if(e&&e.showTimezone===false){n.showTimezone=false}else{n.showTimezone=true}if(t&&t.style){n.displayFormat=t.style}if(t&&t.pattern){n.displayFormat=t.pattern}this.oType=this._oTypes.getType(this._oMetaData.property,t);n[i]={model:this._oMetaData.model,type:this.oType,parts:[{path:this._oMetaData.path,parameters:{useUndefinedForUnresolved:true},type:this.oType},{path:s,parameters:{useUndefinedForUnresolved:true}}],useRawValues:true,mode:this._oParent.getBindingMode("value")}}else{n[i]={model:this._oMetaData.model,path:this._oMetaData.path,type:this._oTypes.getType(this._oMetaData.property,t),mode:this._oParent.getBindingMode("value")}}o=new u(this._oParent.getId()+"-input",n);this._enhanceInputControls(o);return{control:o,onCreate:"_onCreate",params:{getValue:"getValue",type:{type:n.value.type,property:this._oMetaData.property}}}};ot.prototype._createEdmNumeric=function(t){var e=this._oSelector.checkComboBox(t),a=t?t.mode:undefined,o;if(e.combobox){return this._createComboBox({valueHelp:{annotation:e.annotation,noDialog:true,noTypeAhead:true},edit:true})}var i={width:true,textAlign:true,placeholder:true,name:true,valueState:true};var r=ot.getBoundPropertiesMapInfoForControl(d.getMetadata().getName(),{propertyName:"value"})[0];var n=this.createAttributes(r,this._oMetaData.property,i,{event:"change",parameter:"value"});if(this._oParent.isContextTable()&&y.getRTL()){n.textDirection="LTR"}o=this._createInput(n);if(a==="edit"&&this._oParent.isFormContextType()){o.setTextAlign(K.End)}return{control:o,onCreate:"_onCreate",params:{getValue:"getValue",type:{type:n.value.type,property:this._oMetaData.property}}}};ot.prototype._createEdmUOM=function(t){var e=t.mode,a=this._oParent.getEntitySet(),o=ot.getBoundPropertiesMapInfoForControl(at.getMetadata().getName(),{propertyName:"value"})[0],i=this._getPropertyBindingMode(o),r=this.getEdmProperty(),n=this._oMetaData.annotations.uom.property.property,s=this._oMetaData.annotations.uom&&this._oHelper.oAnnotation.isCurrency(r,n);var l={currency:s,edmProperty:n,bindingMode:i};var p=this._createEdmUOMAttributes(l),u=y.getRTL(),d=u&&this._oParent.isContextTable(),g=this._oParent.getId(),c;if(d){p.textDirection="LTR"}var m=this._createInput(p);this.oMeasureField=m;if(e==="edit"&&this._oParent.isFormContextType()){m.setTextAlign(K.End)}if(this._oParent.data("suppressUnit")==="true"){var _={getValue:"getValue"};if(!s){_.type={type:p.value.type,property:this._oMetaData.property}}return{control:m,onCreate:"_onCreate",params:_}}if(!s){c={type:p.value.type,property:this._oMetaData.property}}var f={textAlign:this._getEdmUOMTextAlignment()};if(i==="TwoWay"){f.change=this.getUOMChangeHandler({smartFieldRootControl:this._oParent,currency:s,unit:true})}var M=this._oHelper.getUOMPath(this._oMetaData);f[o]={model:this._oMetaData.model,path:M,mode:i};this.mapBindings(f,ot._getEmbeddedSmartFieldMapSettings(),t);if(this._oParent.getConfiguration()){f.configuration=new E({preventInitialDataFetchInValueHelpDialog:this._getPreventInitialDataFetchInVHDialog()})}if(a){f.entitySet=a}var v=new at(g+"-sfEdit",f),D=this;v.data("configdata",{configdata:{currency:s,smartFieldRootControl:this._oParent,measureField:this.oMeasureField,isInnerControl:true,isUOM:!this._oParent.data("configdata"),model:this._oMetaData.model,navigationPath:this._oMetaData.annotations.uom.navigationPath||null,path:M,entitySetObject:this._oMetaData.annotations.uom.entitySet,entityType:this._oMetaData.annotations.uom.entityType,property:this._oMetaData.annotations.uom.property,annotations:{valuelist:this._oMetaData.annotations.valuelistuom,valuelistType:this._oMetaData.annotations.uom.annotations.valuelistType,text:this._oMetaData.annotations.textuom},modelObject:this._oMetaData.modelObject||this._oModel,onText:function(t){D._updateStaticAmountInputFlexItemData(m);D._updateStaticUOMTextFlexItemData(v);D._updateInnerControl(t,{RTLInTable:d})},onInput:function(t){var e=v&&!v.getVisible();D._updateDynamicAmountInputFlexItemData(m,{isfullWidth:e});D._updateStaticUOMInputFlexItemData(v);D._updateInnerControl(t,{RTLInTable:d})}}});v.data("errorCheck","setComplexClientErrorSecondOperandNested");if(v.getVisible()){m.addStyleClass("smartFieldPaddingRight")}m.addStyleClass("sapUiCompSmartFieldValue");var C=new h({justifyContent:Q.End,items:[m,v],fitContainer:true,width:this._oParent.getWidth()});C.addStyleClass("sapUiCompUOM");C.enhanceAccessibilityState=function(t,e){this._oParent.enhanceAccessibilityState(t,e)}.bind(this);if(this._oParent.isContextTable()){if(d){C.addStyleClass("sapUiCompDirectionLTR")}C.addStyleClass("sapUiCompUOMInTable");if(e!=="edit"){C.addStyleClass("sapUiCompUOMInTableDisplay")}}return{control:C,onCreate:"_onCreateUOM",params:{getValue:true,valuehelp:true,type:c}}};ot.prototype._createEdmUOMAttributes=function(t){t=t||{};var e=this.createUOMDefaultAttributes(t);var a=ot.getBoundPropertiesMapInfoForControl(d.getMetadata().getName(),{propertyName:"value"})[0];var i=t.bindingMode||"TwoWay";var r=t.currency||this._oMetaData.annotations.uom&&this._oHelper.oAnnotation.isCurrency(this.getEdmProperty(),this._oMetaData.annotations.uom.property.property);e[a]={mode:o.OneWay,model:this._oMetaData.model,parts:[{mode:i,path:this._oMetaData.path},{mode:i,path:this._oHelper.getUOMPath(this._oMetaData)},{mode:"OneTime",path:r?"/##@@requestCurrencyCodes":"/##@@requestUnitsOfMeasure",targetType:"any"}],type:r?this._oTypes.getCurrencyType(this._oMetaData.property):this._oTypes.getUoMType(this._oMetaData.property)};return e};ot.prototype.createUOMDefaultAttributes=function(t){return{textAlign:this._getEdmUOMTextAlignment(),placeholder:this.getAttribute("placeholder"),name:this.getAttribute("name"),valueState:this.getValueStateBindingInfoForRecommendationStateAnnotation(),change:this.getUOMChangeHandler({smartFieldRootControl:this._oParent,currency:t.currency})}};ot.prototype._getEdmUOMTextAlignment=function(){var t=this.getAttribute("textAlign");if(!t){t=K.Initial}if(t===K.Initial){if(this._oParent.isContextTable()){return K.End}return K.Begin}return t};ot.prototype._createEdmUOMDisplay=function(t){var e=this,a=this._oParent.getEntitySet(),o=this._oHelper.getUOMPath(this._oMetaData),i=this._getEdmUOMTextAlignment(),r=null,n=this.getEdmProperty(),s=y.getRTL(),l=s&&this._oParent.isContextTable(),p=this._oHelper.oAnnotation.isCurrency(n),u=ot.getBoundPropertiesMapInfoForControl(at.getMetadata().getName(),{propertyName:"value"})[0],d=this._getPropertyBindingMode(u)||"TwoWay";var g=ot.getBoundPropertiesMapInfoForControl(c.getMetadata().getName(),{propertyName:"value"})[0];var m={textAlign:i};m[g]={parts:[{path:this._oMetaData.path,type:this._oTypes.getType(this._oMetaData.property)},{path:o},{mode:"OneTime",path:p?"/##@@requestCurrencyCodes":"/##@@requestUnitsOfMeasure",targetType:"any"}],model:this._oMetaData.model,formatter:this._oTypes.getDisplayFormatter(n,{currency:p,mask:this._oHelper.oAnnotation.isMasked(n),type:this._oTypes.getType(this._oMetaData.property)}),useRawValues:true};if(l){m.textDirection="LTR"}var _=new c(this._oParent.getId()+"-text",m);o=this._oHelper.getUOMPath(this._oMetaData);m={textAlign:this._getEdmUOMTextAlignment()};if(d==="TwoWay"){m.change=this.getUOMChangeHandler({smartFieldRootControl:this._oParent,currency:p,unit:true})}g=ot.getBoundPropertiesMapInfoForControl(at.getMetadata().getName(),{propertyName:"value"})[0];m[g]={model:this._oMetaData.model,path:o,mode:this._getPropertyBindingMode(g)};this.mapBindings(m,ot._getEmbeddedSmartFieldMapSettings(),t);_.addStyleClass("sapUiCompSmartFieldValue");_.addStyleClass("smartFieldUoMAmountDisplayText");_.addStyleClass("smartFieldPaddingRight");if(this._checkSuppressUnit()){return{control:_}}if(a){m.entitySet=a}r=new at(this._oParent.getId()+"-sfDisp",m);r.data("configdata",{configdata:{isInnerControl:true,isUOM:!this._oParent.data("configdata"),model:this._oMetaData.model,navigationPath:this._oMetaData.annotations.uom.navigationPath||null,path:o,entitySetObject:this._oMetaData.annotations.uom.entitySet,entityType:this._oMetaData.annotations.uom.entityType,property:this._oMetaData.annotations.uom.property,annotations:{valuelist:this._oMetaData.annotations.valuelistuom,text:this._oMetaData.annotations.textuom},modelObject:this._oMetaData.modelObject||this._oModel,onText:function(t){if(t&&t.setWrapping){t.setWrapping(false)}e._updateInnerControl(t,{RTLInTable:l})},onInput:function(t){e._updateInnerControl(t,{RTLInTable:l})},getContextEditable:function(){return e._oParent.getContextEditable()}}});r.data("errorCheck","setComplexClientErrorSecondOperandNested");var f=new h({alignItems:tt.Center,items:[_,r],fitContainer:true,width:this._oParent.getWidth()});f.enhanceAccessibilityState=function(t,e){this._oParent.enhanceAccessibilityState(t,e)}.bind(this);if(this._oParent.isContextTable()){f.setJustifyContent("End");this._oParent.addStyleClass("sapUiCompUOMInTable");if(l){f.addStyleClass("sapUiCompDirectionLTR")}f.addStyleClass("sapUiCompUOMInTable")}return{control:f}};ot.prototype._createEdmUOMObjectStatus=function(){var t,e=this.getEdmProperty(),a=this._oMetaData.annotations.uom&&this._oHelper.oAnnotation.isCurrency(e),o=this._oTypes.getDisplayFormatter(e,{currency:a}),i=this._oHelper.getUOMPath(this._oMetaData),r={};var n=ot.getBoundPropertiesMapInfoForControl(I.getMetadata().getName(),{propertyName:"value"})[0];r[n]={parts:[{path:this._oMetaData.path,type:this._oTypes.getType(this._oMetaData.property)},{path:i},{mode:"OneTime",path:a?"/##@@requestCurrencyCodes":"/##@@requestUnitsOfMeasure",targetType:"any"}],formatter:function(){var t=o.apply(this,arguments);return t+arguments[1]},useRawValues:true};this._addObjectStatusAttributes(r);t=new I(this._oParent.getId()+"-objStatus",r);t.addStyleClass("sapUiCompUOM");return{control:t}};ot.prototype._createEdmUOMObjectNumber=function(){var t,e,a=this._getEdmUOMTextAlignment();var o=ot.getBoundPropertiesMapInfoForControl(x.getMetadata().getName(),{propertyName:"value"});if(this._oMetaData.annotations.uom&&this._oHelper.oAnnotation.isCurrency(this.getEdmProperty(),this._oMetaData.annotations.uom.property.property)){t={model:this._oMetaData.model,textAlign:a};t[o[0]]={parts:[{path:this._oMetaData.path},{path:this._oHelper.getUOMPath(this._oMetaData)},{mode:"OneTime",path:"/##@@requestCurrencyCodes",targetType:"any"}],type:this._oTypes.getCurrencyType(this._oMetaData.property)};t[o[1]]={path:this._oHelper.getUOMPath(this._oMetaData)}}else{t={model:this._oMetaData.model,textAlign:a};t[o[0]]={path:this._oMetaData.path,type:this._oTypes.getType(this._oMetaData.property)};t[o[1]]={path:this._oHelper.getUOMPath(this._oMetaData)}}e=new x(this._oParent.getId()+"-objNumber",t);e.addStyleClass("sapUiCompUOM");return{control:e}};ot.prototype._createEdmSemantic=function(){var t=this,e=this._oParent.getBindingPath("value"),a=this.getEdmProperty(),o=this._getLocalTextAnnotation(),i=o&&o.path||null;var r={semanticObject:this._oMetaData.annotations.semantic.defaultSemanticObject,additionalSemanticObjects:this._oMetaData.annotations.semantic.additionalSemanticObjects,fieldName:e,width:this.getAttribute("width"),createControlCallback:function(){var t=this.createControl(true);if(t){return t.control}return null}.bind(this)};this.oType=this._oTypes.getType(this._oMetaData.property);if(i){r.text={parts:[this._oMetaData.path,this._oHelper.getEdmDisplayPath(this._oMetaData)],model:this._oMetaData.model,formatter:function(e,a){if(t.oType){e=t.oType.formatValue(e,"string")}if(t.oType&&t.oType.isA("sap.ui.comp.odata.type.NumericText")&&e===null&&a){e=""}if(e&&a){return t._formatDisplayBehaviour("defaultInputFieldDisplayBehaviour",e,a)}return e?e:""}};r.navigationTargetsObtained=function(e){var a=this.getBinding("text");if(!Array.isArray(a.getValue())){e.getParameters().show();return}var o=a.getValue();var i=t._getDisplayBehaviourConfiguration("defaultInputFieldDisplayBehaviour")||"idOnly";var r=A.getTextsFromDisplayBehaviour(i,o[0],o[1]);var n=e.getParameters().mainNavigation;if(n){n.setDescription(r.secondText)}e.getParameters().show(r.firstText,n,undefined,undefined)}}else{var n=this._oHelper.getUOMPath(this._oMetaData);if(n){r.text={parts:[{path:e},{path:n}],model:this._oMetaData.model,formatter:this._oHelper.oAnnotation.isCurrency(a,this._oMetaData.annotations.uom.property.property)?A.getAmountCurrencyFormatter():A.getMeasureUnitFormatter(),useRawValues:true};r.uom={path:n}}else{r.text={path:e,model:this._oMetaData.model,type:this.oType}}}return{control:new f(this._oParent.getId()+"-sl",r),onCreate:"_onCreate",params:{getValue:"getInnerControlValue"}}};ot.prototype._createMultiLineText=function(t){var e=ot.getBoundPropertiesMapInfoForControl(i.getMetadata().getName(),{propertyName:"value"})[0];var a=this.createAttributes(e,this._oMetaData.property,t.attributesNamesMap);var o=this.getFormatSettings("multiLineSettings");a=k(a,o);if(this._oParent.isContextTable()){a.width="100%"}var r=new i(this._oParent.getId()+"-textArea",a);this._enhanceInputControls(r);this._handleEventingForEdmString({control:r,edmProperty:this._oMetaData.property.property});return{control:r,onCreate:"_onCreate",params:{type:{type:a.value.type,property:this._oMetaData.property},getValue:"getValue"}}};ot.prototype._createLink=function(t){var e=this,a=this._oParent,o=a.getBindingInfo("url");var i={text:"",href:""};var n=ot.getBoundPropertiesMapInfoForControl(r.getMetadata().getName(),{propertyName:"url"})[0];if(o){i[n]=this._oBinding.toBinding(o)}else{i[n]=a.getUrl()}if(a.hasListeners("press")){i.press=function(t){t.preventDefault();a.firePress(t)}}var s=a.getBindingInfo("value");var l=ot.getBoundPropertiesMapInfoForControl(r.getMetadata().getName(),{propertyName:"value"});if(s){var p=this._oMetaData,u=p.path,h=p.property.property;if(p.annotations.text&&h.type==="Edm.String"){i[l[0]]={parts:[p.path,this._oHelper.getEdmDisplayPath(p)],formatter:this._formatText.bind(e)}}else if(ot.isSpecialLink(h)){var d=ot[ot._getLinkFormatterFunctionName(h)];i[l[0]]={path:u};i[l[1]]={path:u,formatter:null};if(typeof d==="function"){i[l[1]].formatter=d}}else if(t){i[l[0]]={path:u,type:this._getDateFormatType()}}else{i[l[0]]=this._oBinding.toBinding(s)}}else{i[l[0]]=a.getValue()}return{control:new r(a.getId()+"-link",i),onCreate:"_onCreate",params:{noValidation:true}}};ot.prototype._createEdmBoolean=function(t){var e=this._oSelector.checkComboBox(t),a=t.mode==="edit",o=this,i=null,r;if(e.combobox){if(a||this._oParent.getFetchValueListReadOnly()){return this._createComboBox({valueHelp:{annotation:e.annotation,noDialog:true,noTypeAhead:true},edit:a})}}var s,l;if(a){l=ot.getBoundPropertiesMapInfoForControl(n.getMetadata().getName(),{propertyName:"value"})[0];s=this.createAttributes(l,this._oMetaData.property,{},{event:"select",parameter:"selected"});r=new n(this._oParent.getId()+"-cBoxBool",s);i={getValue:"getSelected"}}else{l=ot.getBoundPropertiesMapInfoForControl(c.getMetadata().getName(),{propertyName:"value"})[0];s=this.createAttributes(l,this._oMetaData.property,{width:true,textAlign:true});s[l]={model:this._oMetaData.model,path:this._oMetaData.path,formatter:function(t){return o._formatDisplayBehaviour("defaultCheckBoxDisplayBehaviour",t)}};r=new c(this._oParent.getId()+"-text",s)}return{control:r,onCreate:"_onCreate",params:i}};ot.prototype._createValueHelp=function(){var t=this._oParent.getContent();if(!t){return}var e={annotation:this._oMetaData.annotations.valuelist,noDialog:!this._oParent.getShowValueHelp(),noTypeAhead:!this._oParent.getShowSuggestion(),aggregation:"suggestionRows"};this._getValueHelpDialogTitle(e);e.analyser=this._oHelper.getAnalyzer(this._oModel||this._oMetaData.modelObject);this.createValueHelp({control:t,edmProperty:this.getEdmProperty(),valueHelp:e,model:this._oModel||this._oMetaData.modelObject,onValueListChange:function(t){this._oParent.fireValueListChanged({changes:t.mParameters.changes})}.bind(this)})};ot.prototype.getValueListProviderConfiguration=function(t){var e=M.prototype.getValueListProviderConfiguration.apply(this,arguments);if(this._oHelper.oAnnotation.isUpperCase(this._oMetaData.property.property)){e.displayFormat="UpperCase"}return e};ot.prototype._checkSuppressUnit=function(){if(this._oParent.data("suppressUnit")==="true"){return true}var t=this._oParent.getBindingInfo("uomVisible");return!t&&!this._oParent.getUomVisible()};ot.prototype.getEdmProperty=function(){var t=this._oHelper;if(t){return t.getEdmProperty(this._oMetaData)}return null};ot.prototype.getEntityType=function(){if(this._oMetaData){return this._oMetaData.entityType}return null};ot.prototype._checkLink=function(){var t=this._oParent.getBindingInfo("url"),e=this.getEdmProperty();if(t||this._oParent.getUrl()||ot.isSpecialLink(e)){return true}return this._oParent.hasListeners("press")};ot._getEmbeddedSmartFieldMapSettings=function(){return{uomEditable:"editable",uomEnabled:"enabled",uomVisible:"visible",mandatory:"mandatory",contextEditable:"contextEditable"}};ot.getBoundPropertiesMapInfoForControl=function(t,e){e=e||{};var a=null;switch(t){case"sap.m.Input":case"sap.m.TimePicker":case"sap.m.DatePicker":case"sap.m.DateTimePicker":case"sap.m.TextArea":a={value:["value"]};break;case"sap.m.Text":case"sap.m.ObjectIdentifier":case"sap.ui.comp.navpopover.SmartLink":a={value:["text"]};break;case"sap.m.Link":a={url:["href"],value:["text","href"]};break;case"sap.m.ObjectStatus":a={value:["text","state","icon"]};break;case"sap.m.ObjectNumber":a={value:["number","unit"]};break;case"sap.m.Select":case"sap.m.ComboBox":case"sap.ui.comp.smartfield.DisplayComboBox":a={value:["selectedKey"]};break;case"sap.ui.comp.smartfield.ComboBox":a={value:["enteredValue"],realValue:["realValue"]};break;case"sap.m.CheckBox":a={value:["selected"]};break;case"sap.ui.comp.smartfield.SmartField":var o=Object.keys(at.getMetadata().getProperties());a={};o.forEach(function(t,e,o){a[t]=[o[e]]});break}if(a&&e.propertyName){return a[e.propertyName]||null}return a};ot.isSpecialLink=function(t){return O.isEmailAddress(t)||O.isPhoneNumber(t)||O.isURL(t)};ot._getLinkFormatterFunctionName=function(t){return"_format"+O.getLinkDisplayFormat(t)};ot._formatEmailAddress=function(t){return"mailto:"+t};ot._formatPhoneNumber=function(t){return"tel:"+t};ot._formatURL=function(t){return H.validate(t)?t:""};ot.prototype._formatText=function(t,e){if(t&&e){var a=this._formatDisplayBehaviour("defaultInputFieldDisplayBehaviour",t,e);return W(a)}return t||""};ot.prototype._getCreator=function(t){return this._oSelector.getCreator(t)};ot.prototype._onCreate=function(t,e){var a,o,i,r=true,n=this;if(e){if(e.noValidation){r=false}if(e.valuehelp){this._getValueHelpDialogTitle(e.valuehelp);e.valuehelp.analyser=this._oHelper.getAnalyzer(this._oModel||this._oMetaData.modelObject);this.createValueHelp({control:t,edmProperty:this.getEdmProperty(),valueHelp:e.valuehelp,model:this._oModel||this._oMetaData.modelObject,onValueListChange:function(t){n._oParent.fireValueListChanged({changes:t.mParameters.changes})}})}if(e.getValue){o=e.getValue;e.getValue=function(){return t[o]()}}if(e.type){a=e.type.emptyStringSignificant||false;i=this._oFieldControl.getMandatoryCheck(e.type.property,a);if(i){e.type.type.oFieldControl=i}}}if(r){this.addValidations(t,this._oParent.data("errorCheck")||"setSimpleClientError")}if(!this._checkUOM()){t.addStyleClass("sapUiCompSmartFieldValue")}};ot.prototype._checkUOM=function(){var t=this._oParent.data("configdata");if(t&&t.configdata){if(t.configdata.onInput||t.configdata.onText){return true}}return false};ot.prototype.getValueStateBindingInfoForRecommendationStateAnnotation=function(t,e,a){t=t||this.getEdmProperty();var o=t&&t["com.sap.vocabularies.UI.v1.RecommendationState"];if(!o){return null}U(!(o.Path===undefined),'Missing "Path" attribute of the "com.sap.vocabularies.UI.v1.RecommendationState" annotation for "'+t.name+'" EDM property of "'+this._oMetaData.entityType.name+'" entity type. - '+this.getMetadata().getName());U(!(o.Path===""),'Missing path name of "com.sap.vocabularies.UI.v1.RecommendationState" annotation for "'+t.name+'" EDM property of "'+this._oMetaData.entityType.name+'" entity type. - '+this.getMetadata().getName());e=e||this._oHelper.findProperty(this._oMetaData.entityType.property,o.Path);U(!!e,'The EDM property was not found in the "'+this._oMetaData.entityType.name+'" entity type. - '+this.getMetadata().getName());if(e&&e.type==="Edm.Byte"){return{model:a||this._oMetaData.model,path:o.Path,formatter:ot.formatRecommendationState}}U(e&&e.type==="Edm.Byte",'The EDM property "'+e.name+'" of "'+this._oMetaData.entityType.name+'" entity type must be typed as Edm.Byte. - '+this.getMetadata().getName());return null};ot.formatRecommendationState=function(t){t=String(t);switch(t){case"0":return G.None;case"1":return G.Information;case"2":return G.Warning;default:return G.None}};ot.prototype._updateDynamicAmountInputFlexItemData=function(t,e){var a=t.getLayoutData()||new z,o="sapUiCompSmartFieldFlexItemAmountEdit",i="";if(a){if(e.isfullWidth){o="sapUiCompSmartFieldFlexItemAmountNoUnitEdit";i="100%"}a.setGrowFactor(1);a.setMaxWidth(i);a.setStyleClass(o);a.setMinWidth("0")}t.setLayoutData(a)};ot.prototype._updateStaticAmountInputFlexItemData=function(t){var e=t.getLayoutData()||new z;if(e){e.setGrowFactor(1);e.setMaxWidth("");e.setStyleClass("")}t.setLayoutData(e)};ot.prototype._updateStaticUOMInputFlexItemData=function(t){var e=t.getLayoutData()||new z;if(e){e.setShrinkFactor(1);e.setGrowFactor(0);e.setStyleClass("sapUiCompSmartFieldFlexItemUnitEdit");e.setMinWidth("")}t.setLayoutData(e)};ot.prototype._updateStaticUOMTextFlexItemData=function(t){var e=t.getLayoutData()||new z;if(e){e.setShrinkFactor(0);e.setGrowFactor(0);e.setStyleClass("sapUiCompSmartFieldUOMDisplayText");e.setMinWidth("auto")}t.setLayoutData(e)};ot.prototype._updateInnerControl=function(t,e){var a=e.RTLInTable,o,i;if(t){o=typeof t.getParent==="function"?t.getParent():{};i=o&&o.getInnerControls?o.getInnerControls():[];if(a&&typeof t.setTextDirection==="function"){t.setTextDirection("LTR")}t.addStyleClass("sapUiCompSmartFieldUnit");if(i.length>0&&i[0].getEditable&&i[0].getEditable()===true){t.addStyleClass("sapUiCompSmartFieldFlexItemUnitEdit")}}};ot.prototype._getValueHelpDialogTitle=function(t){t.dialogtitle=this._oParent.getComputedTextLabel();if(!t.dialogtitle){var e=this.getEdmProperty();t.dialogtitle=this._oHelper.oAnnotation.getLabel(e)||e.name}};ot.prototype._onCreateUOM=function(t,e){var a=t.getItems(),o;this.addValidations(a[0],"setComplexClientErrorFirstOperand");if(e&&e.getValue){e.getValue=function(){return a[0].getValue()}}e.uom=function(){return a[1].getValue()};e.uomset=function(t){a[1].setValue(t)};if(e.type){o=this._oFieldControl.getMandatoryCheck(e.type.property);if(o){e.type.type.oFieldControl=o}}};ot.prototype.triggerCreationOfControls=function(){try{this._setUOMEditState();this._oFieldControl.bindProperties({metadata:this._oMetaData});this._addLabelAndQuickInfo();if(this._oParent.isContextTable()&&this._oMetaData._isNumber==undefined){this._oMetaData._isNumber=O.isNumber(this._oMetaData.property.property)}}catch(t){w.error(t,null,this.getMetadata().getName())}};ot.prototype._checkTextInDisplayModeValueList=function(t){var e=this._oHelper.getValueListAnnotationPath(this._oMetaData),a=this.getEdmProperty();return!!(this._oMetaData.annotations&&this._oMetaData.annotations.valuelist!==undefined&&this._getDisplayBehaviourConfiguration()&&(this._oMetaData.property&&(this._oMetaData.property.property.type==="Edm.String"||this._oMetaData.property.property.type==="Edm.Guid"))&&t.mode==="display"&&this._oParent.getFetchValueListReadOnly()&&e&&!(this._oParent.getExpandNavigationProperties&&this._oParent.getExpandNavigationProperties())&&!this._oHelper.startWithNavigationProperty(e,this._oMetaData)&&!this.isValueInitialWithTextArrangement(a)&&this._getDisplayBehaviourConfiguration()!=="idOnly")};ot.prototype.isValueInitialWithTextArrangement=function(t){var e=this._getLocalTextAnnotation();return this._oParent._isValueInitial()&&e};ot.prototype._hasBoundFieldControl=function(){var t=this._oFieldControl.getPropertyNames();for(var e=0;e<t.length;e++){if(this._oParent.getBinding(t[e])){return true}}return false};ot.prototype.bind=function(t){var e=t.mode,t=t||{};this._bTextInDisplayModeValueList=this._checkTextInDisplayModeValueList(t);if(!(!this._bInitialized&&!this.bPending)&&(!t.rebind&&!this._bTextInDisplayModeValueList)){return Promise.resolve({skipInit:this._bInitializeFromConfig})}this._bInitialized=true;var a=this._oParent.data("configdata");if(a&&a.configdata){try{this._init(this._oMeta);if(this._oMetaData&&this._oMetaData.annotations&&typeof a.configdataVL==="function"){this._bInitializeFromConfig=true;return a.configdataVL().then(function(t){this._initValueList(t);return Promise.resolve({fetchIDAndDescription:true})}.bind(this)).catch(function(t){return Promise.resolve()})}}catch(t){if(t){w.error(t,null,this.getMetadata().getName()+".onMetaModelLoaded")}}return Promise.resolve()}if(!this._oModel){return Promise.reject()}var o=!!(this._oParent&&this._oParent.isTextInEditModeSourceNotNone());if(!o&&this._oModel.bMetaModelLoaded&&(e!=="display"||!this._oParent.getFetchValueListReadOnly())){try{this._init(this._oMeta)}catch(t){if(t){w.error(t,null,this.getMetadata().getName()+".onMetaModelLoaded")}}return Promise.resolve()}this.bPending=true;return this._metadataInitialise().then(function t(){if(!this._oParent){this.bPending=false;return Promise.reject()}this._init(this._oMeta);if(e!=="display"&&o||this._bTextInDisplayModeValueList){var a=this._oMetaData.annotations.valuelist;if(typeof a==="string"){var i=this._oParent&&this._oParent.getBindingContext()&&this._oParent.getBindingContext().getPath();return this._oHelper.loadValueListAnnotation(a,i)}else{this.bPending=false;return Promise.reject()}}this.bPending=false}.bind(this)).then(function t(e){var a={fetchIDAndDescription:false};if(!o&&!this._bTextInDisplayModeValueList||!this._oParent){return}this.bPending=false;if(e){this._initValueList(e)}if(e&&this.oTextArrangementDelegate){a.fetchIDAndDescription=true}return a}.bind(this)).catch(function(t){if(t){w.error(t,null,this.getMetadata().getName()+".onMetaModelLoaded");this._oParent._rejectLifecyclePromises("Metadata loading problem.")}}.bind(this))};ot.prototype._metadataInitialise=function(){return Promise.resolve().then(function(){if(this._oParent._bMetaModelLoadAttached){return this._oModel.getMetaModel().loaded()}else{return P.handleModelInit(this._oParent,function(){},true)}}.bind(this)).catch(function(t){w.error("The meta model could not be loaded.",t,this.getMetadata().getName())}.bind(this))};ot.prototype._addLabelAndQuickInfo=function(){var t=this.getDataProperty();t=t.property;var e=this._oHelper.oAnnotation.getLabel(t);var a=this._oHelper.oAnnotation.getQuickInfo(t);if(e){this._oParent._sAnnotationLabel=e}if(a&&this._oParent.isPropertyInitial("tooltipLabel")){this._oParent.setTooltipLabel(a)}};ot.prototype.rebindOnCreated=function(){var t,e=this._oFieldControl.getControlFormatters(this._oMetaData,["editable"]);for(var a in e){t=this._oBinding.fromFormatter(this._oMetaData.model,e[a]);this._oParent.bindProperty(a,t)}};ot.prototype._setUOMEditState=function(){if(this._oFieldControl.hasUomEditState(this._oMetaData)){var t=this._oFieldControl.getUOMEditState(this._oMetaData);if(t){var e=this._oBinding.fromFormatter(this._oMetaData.model,t);this._oParent.bindProperty("uomEditState",e)}}};ot.prototype.getDataProperty=function(){return this._oMetaData.property};ot.prototype.getDropdownItemKeyType=function(t){var e=t.getMetadata().getName();if(e==="sap.ui.comp.smartfield.DisplayComboBox"||e==="sap.m.ComboBox"||e==="sap.ui.comp.smartfield.ComboBox"||e==="sap.m.Select"){var a=ot.getBoundPropertiesMapInfoForControl(e,{propertyName:"value"})[0];var o=t.getBindingInfo(a);return o&&o.type||null}return null};ot.prototype.getMetaData=function(){return this._oMetaData};ot.prototype.getODataHelper=function(){return this._oHelper};ot.prototype._getChangeEventParams=function(t){var e,a={},o=t&&t.getParameters();if(o){e=o.value;a.value=e;a.newValue=e;if(o.validated){a.validated=o.validated}}else{a=t}return a};ot.prototype._getPropertyBindingMode=function(t){var e=typeof this._oParent.getBinding==="function"&&this._oParent.getBinding(t);return e&&typeof e.getBindingMode==="function"&&e.getBindingMode()||"TwoWay"};ot.prototype._getLocalTextAnnotation=function(){var t=this.getMetaData(),e=t&&t.annotations&&t.annotations.text||null;return e};ot.prototype.fetchIDAndDescriptionCollectionIfRequired=function(t){var e=t.mode==="edit"&&this._isFixedList();if(this.oValueListDelegate&&e){this.oValueListDelegate.fetchIDAndDescriptionCollectionIfRequired()}else if(this.oTextArrangementDelegate){this.oTextArrangementDelegate.fetchIDAndDescriptionCollectionIfRequired(t)}};ot.prototype._isFixedList=function(){var t=this.getMetaData();return t&&t.annotations&&t.annotations.valuelistType==="fixed-values"};ot.prototype.destroy=function(){if(this._oFieldControl){this._oFieldControl.destroy()}if(this._oSelector){this._oSelector.destroy()}if(this._oTypes){this._oTypes.destroy()}if(this._oHelper){this._oHelper.destroy()}if(this.oType){this.oType.destroy();this.oType=null}if(this.oValueListDelegate){this.oValueListDelegate.destroy()}if(this.oTextArrangementDelegate){this.oTextArrangementDelegate.destroy()}this._oHelper=null;this._oFieldControl=null;this._oTypes=null;this._oSelector=null;this._oMetaData=null;this.oMeasureField=null;this.oTextArrangementDelegate=null;M.prototype.destroy.apply(this,arguments)};return ot},true);
/*
 * SAPUI5
 * (c) Copyright 2009-2023 SAP SE. All rights reserved.
 */
sap.ui.predefine("sap/ui/comp/smartfield/ODataControlSelector", [],function(){"use strict";var t=function(t,e,a){this._oMetaData=t;this._oParent=e;this._oTypes=a};t.prototype.checkComboBox=function(t){var e={},a;if(typeof t!=="undefined"){a=t.mode}if(a==="display"){e.combobox=false;return e}return this._checkComboBox()};t.prototype._checkComboBox=function(){var t={};if(this._oMetaData.annotations.valuelist){t.valuelistType=this._oMetaData.annotations.valuelistType;t.annotation=this._oMetaData.annotations.valuelist}if(!t.annotation){return t}if(t.valuelistType==="fixed-values"){t.combobox=true}if(!t.combobox){t.annotation=this._oMetaData.annotations.valuelist;t.combobox=this._checkConfig("dropDownList")}return t};t.prototype.checkSelection=function(){var t={};if(this._oMetaData.annotations.valuelist){t.annotation=this._oMetaData.annotations.valuelist;t.selection=this._checkConfig("selection")}return t};t.prototype.checkCheckBox=function(){var t,e;if(this._oMetaData.property&&this._oMetaData.property.property&&this._oMetaData.property.property.type==="Edm.String"){t=this._oParent.getBindingInfo("value");e=this._oTypes.getMaxLength(this._oMetaData.property,t);if(e===1){if(this._checkConfig("checkBox")){return true}}}return false};t.prototype.checkDatePicker=function(){if(this._oMetaData.property&&this._oMetaData.property.property&&(this._oMetaData.property.property["sap:display-format"]==="Date"||this._oTypes.isCalendarDate(this._oMetaData.property))){return true}return this._checkConfig("datePicker")};t.prototype._checkConfig=function(t){var e=this._oParent.getConfiguration();if(e){return e.getControlType()===t}return false};t.prototype.getCreator=function(t){var e,a;if(typeof t!=="undefined"){if(typeof t==="boolean"){e=t}else{e=t.blockSmartLinkCreation;a=t.mode}}var o={"Edm.Decimal":"_createEdmNumeric","Edm.Double":"_createEdmNumeric","Edm.Float":"_createEdmNumeric","Edm.Single":"_createEdmNumeric","Edm.Int16":"_createEdmNumeric","Edm.Int32":"_createEdmNumeric","Edm.Int64":"_createEdmNumeric","Edm.Byte":"_createEdmNumeric","Edm.DateTimeOffset":"_createEdmDateTimeOffset","Edm.DateTime":"_createEdmDateTime","Edm.Boolean":"_createEdmBoolean","Edm.String":"_createEdmString","Edm.Time":"_createEdmTime"};if(this._isUOMDisplayObjectStatus()){return"_createEdmUOMObjectStatus"}if(this._isUOMDisplay()){return"_createEdmUOMObjectNumber"}if(a==="display"){if(this._oMetaData.annotations){if(this.useObjectIdentifier(this.checkDatePicker())&&this._oMetaData.annotations.text&&this._oMetaData.annotations.semanticKeys&&this._oMetaData.annotations.semanticKeys.semanticKeyFields&&this._oMetaData.annotations.semanticKeys.semanticKeyFields.indexOf(this._oMetaData.path)>-1){return"_createEdmDisplay"}if(this._oMetaData.annotations.semantic&&!e){return"_createEdmSemantic"}if(this._oMetaData.annotations.uom){return"_createEdmUOMDisplay"}if(this._isObjectStatusProposed()){return"_createObjectStatus"}return this._oMetaData.property&&this._oMetaData.property.property&&this._oMetaData.property.property.type==="Edm.Boolean"?"_createEdmBoolean":"_createEdmDisplay"}}if(this._oMetaData.annotations&&this._oMetaData.annotations.uom){return"_createEdmUOM"}if(this._oMetaData.property&&this._oMetaData.property.property){if(this._oTypes.isCalendarDate(this._oMetaData.property)){return"_createEdmDateTime"}return o[this._oMetaData.property.property.type]||"_createEdmString"}return null};t.prototype._isUOMDisplay=function(){if(this._oMetaData.annotations.uom){if(this._isObjectNumberProposed()){if(!this._oParent.getContextEditable()||!this._oParent.getEditable()&&!this._oParent.getUomEditable()||!this._oParent.getEnabled()&&!this._oParent.getUomEnabled()){return true}if(this._oParent.getProperty("uomEditState")===0){return true}}}return false};t.prototype._isUOMDisplayObjectStatus=function(){if(this._oMetaData.annotations.uom){if(this._isObjectStatusProposed()){if(!this._oParent.getContextEditable()||!this._oParent.getEditable()&&!this._oParent.getUomEditable()||!this._oParent.getEnabled()&&!this._oParent.getUomEnabled()){return true}if(this._oParent.getProperty("uomEditState")===0){return true}}}return false};t.prototype._isObjectStatusProposed=function(){var t=this._oParent.getControlProposal(),e;if(t){e=t.getObjectStatus();if(e){return true}}return false};t.prototype._isObjectNumberProposed=function(){var t;if(this._oParent.data("suppressUnit")!=="true"){t=this._oParent.getControlProposal();if(t&&t.getControlType()==="ObjectNumber"){return true}if(this._oParent.getProposedControl()==="ObjectNumber"){return true}}return false};t.prototype.useObjectIdentifier=function(t,e){var a;if(this._oMetaData&&this._oMetaData.property&&this._oMetaData.property.property&&this._oMetaData.property.property.type==="Edm.String"){if(!t&&!e){a=this._oParent.getControlProposal();if(a&&a.getControlType()==="ObjectIdentifier"){return true}if(this._oParent.getProposedControl()==="ObjectIdentifier"){return true}}}return false};t.prototype.destroy=function(){this._oParent=null;this._oMetaData=null;this._oTypes=null};return t},true);
/*
 * SAPUI5
 * (c) Copyright 2009-2023 SAP SE. All rights reserved.
 */
sap.ui.predefine("sap/ui/comp/smartfield/ODataHelper", ["sap/ui/comp/library","sap/ui/comp/odata/MetadataAnalyser","sap/ui/comp/odata/AnalyticalAnalyser","sap/ui/comp/smartfield/AnnotationHelper","sap/base/Log","sap/ui/model/odata/_ODataMetaModelUtils","sap/ui/model/odata/ODataUtils","sap/base/assert"],function(t,e,n,i,a,r,o,p){"use strict";var s=t.TextArrangementType;var l=function(t,e,n,a){if(t){this.oMeta=t.getMetaModel()}if(n){this.oMeta=n}this._oModel=t;this._oUtil=e;this.oAnnotation=new i;this.bIsAnalytical=a};l.prototype.getAnalyzer=function(t){if(!this._oAnalyzer){if(this.bIsAnalytical){this._oAnalyzer=new n(this._oModel||t)}else{this._oAnalyzer=new e(this._oModel||t)}}return this._oAnalyzer};l.prototype.checkNavigationProperty=function(t,e){var n,i,a,r;if(e&&t){n=this._oUtil.getNavigationProperties(e);a=n.paths.length;while(a--){i=n.paths.shift();i=this._oUtil.correctPath(i);if(i===""||i===t.entitySet.name){continue}r=this.getNavigationProperty(t.entityType,i);if(r.entitySet){t.entitySet=r.entitySet;t.entityType=r.entityType}}}};l.prototype.getNavigationProperty=function(t,e){var n=this._getNamedProperty(e,"navigationProperty",t),i,a,r={};if(n){i=this.oMeta.getODataAssociationSetEnd(t,n.name);if(i===null){return}a=this.getAssociation(t,n.name);if(a){r.toRoleAssociationEndMultiplicity=this.getToRoleAssociationEndMultiplicity(a.end,n.toRole)}r.entitySet=this.oMeta.getODataEntitySet(i.entitySet);if(r.entitySet){r.entityType=this.oMeta.getODataEntityType(r.entitySet.entityType)}}return r};l.prototype.startWithNavigationProperty=function(t,e){var n=t.split("/"),i;if(n&&n.length>1){i=this._getNamedProperty(n.shift(),"navigationProperty",e.entityType)}if(i){return i.name}return null};l.prototype.getProperty=function(t){var e=[],n,i,a,r,o,p={entityType:t.entityType,entitySet:t.entitySet};if(t){i=t.path.split("/");n=i.length;if(p&&n>1){while(p&&p.entityType){r=i[0];p=this.getNavigationProperty(p.entityType,r);if(p&&p.entityType){t.entityType=p.entityType;t.entitySet=p.entitySet;t.toRoleAssociationEndMultiplicity=p.toRoleAssociationEndMultiplicity;e.push(i.shift());n--}}}t.navigationPath=e.join("/");if(n>1){a=this.oMeta.getODataProperty(t.entityType,i[0]);if(a){t.property=this._getComplex(a,i,n)}return}if(t.navigationPath){o=t.path.replace(t.navigationPath+"/","")}else{o=t.path}a=this.oMeta.getODataProperty(t.entityType,o);t.property={property:a,typePath:t.path,valueListAnnotation:null,valueListKeyProperty:null,valueListEntitySet:null,valueListEntityType:null}}};l.prototype._getComplex=function(t,e,n){var i=t,a,r=[];while(n--){if(i){if(n===0){a=i.name;i=this._getNamedProperty(e[0],"property",i);return{typePath:a+"/"+e[0],property:i,complex:true,parents:r}}i=this.oMeta.getODataComplexType(i.type);if(i){r.push(i)}}e.shift()}};l.prototype._getNamedProperty=function(t,e,n){var i;if(n[e]){for(var a=0;a<n[e].length;a++){if(n[e][a].name===t){i=n[e][a];break}}}return i};l.prototype.getTextProperty2=function(t){var e,n;e=this.oAnnotation.getText(t.property.property);if(e){n=this._preprocAnnotation(e,t);this.getProperty(n);this._postprocAnnotation(n,t)}return n};l.prototype.getUnitOfMeasure2=function(t){var e,n;e=this.oAnnotation.getUnit(t.property.property);if(e){n=this._preprocAnnotation(e,t);this.getProperty(n);this._postprocAnnotation(n,t)}return n};l.prototype._preprocAnnotation=function(t,e){var n,i;i=this.traverseNavigationProperties(t,e.entityType);if(!i.navigationPath){i.entitySet=e.entitySet}if(e.navigationPath){i.path=e.path.replace(e.navigationPath+"/","")}else{i.path=e.path}if(i.navigationPath){n=t.replace(i.navigationPath+"/","")}else{n=t}i.path=i.path.replace(e.property.property.name,n);if(i.navigationPath){i.navigationPathHelp=i.navigationPath}return i};l.prototype._postprocAnnotation=function(t,e){var n;if(t.navigationPathHelp){t.navigationPath=t.navigationPathHelp}if(t.navigationPath){n=t.navigationPath}else{n=""}if(e.navigationPath){if(n){n=e.navigationPath+"/"+n}else{n=e.navigationPath}}t.navigationPath=n;if(t.navigationPath){t.path=t.navigationPath+"/"+t.path}};l.prototype.traverseNavigationProperties=function(t,e){var n={},i={},a,r,o;a=t.split("/");o=a.length;n.entityType=e;i.entityType=e;while(o--){r=a.shift();if(r===""){continue}i=this.getNavigationProperty(n.entityType,r);if(!i.entitySet){break}n.entityType=i.entityType;n.entitySet=i.entitySet;if(n.navigationPath){n.navigationPath=n.navigationPath+"/"+r}else{n.navigationPath=r}}return n};l.prototype.getValueListAnnotationPath=function(t){var e,n,i=this.getEdmProperty(t),a=i?i.name:"";if(t&&t.property&&t.property.complex){n=t.property.parents.length-1;e=t.property.parents[n].namespace;e=e+"."+t.property.typePath}else if(t&&t.entitySet&&i){e=t.entitySet.entityType+"/"+a}return e};l.prototype.getUOMValueListAnnotationPath=function(t){var e;if(t.annotations.uom){e=this.getValueListAnnotationPath(t.annotations.uom)}if(e){t.annotations.valuelistuom=e}};l.prototype.getUOMTextAnnotation=function(t){if(t&&t.annotations&&t.annotations.uom){t.annotations.textuom=this.getTextProperty2(t.annotations.uom)}};l.prototype.geValueListEntitySet=function(t){if(t&&t.annotations&&t.annotations.valuelist){if(t.annotations.valuelist.primaryValueListAnnotation&&t.annotations.valuelist.primaryValueListAnnotation.valueListEntitySetName){t.annotations.valuelistentityset=this.oMeta.getODataEntitySet(t.annotations.valuelist.primaryValueListAnnotation.valueListEntitySetName)}}};l.prototype.getEdmProperty=function(t){var e=t.property;return e&&e.property||null};l.prototype.getValueListData=function(t){var n=this.getEdmProperty(t),i=t.annotations;if(e.isValueList(n)){i.valuelist=this.getValueListAnnotationPath(t);var a=e.getValueListMode(n);if(a){i.valuelistType=a}else{i.valuelistType=this.getAnalyzer().getValueListSemantics(n["com.sap.vocabularies.Common.v1.ValueList"])}}};l.prototype.findProperty=function(t,e){return r.findObject(t,e)};l.prototype.getAssociation=function(t,e){var n;if(t){n=this.findProperty(t.navigationProperty,e)}if(n&&this.oMeta.oModel){return r.getObject(this.oMeta.oModel,"association",n.relationship)}return null};l.prototype.getToRoleAssociationEnd=function(t,e){if(Array.isArray(t)){for(var n=0;n<t.length;n++){var i=t[n];if(i.role===e){return i}}}return null};l.prototype.getToRoleAssociationEndMultiplicity=function(t,e){var n=this.getToRoleAssociationEnd(t,e);return n?n.multiplicity:""};l.prototype.checkNavigationPropertyRequiredMetadata=function(t){var e=t.propertyName,n=t.textAnnotation,i=n?n.Path:"",r=t.entityType,o=r.namespace+"."+r.name,l="sap.ui.comp.smartfield.ODataHelper",y="com.sap.vocabularies.Common.v1.Text";if(!n){a.info('Missing "'+y+'" annotation for "'+e+'" EDM property of "'+o+'" entity type.',l);return false}if(i===undefined){p(false,'Missing "Path" attribute of "'+y+'" annotation for "'+e+'" EDM property of "'+o+'" entity type. - '+l);return false}if(i===""){p(false,'Missing URL path name of "'+y+'" annotation for "'+e+'" EDM property of "'+o+'" entity type. - '+l);return false}var f="com.sap.vocabularies.UI.v1.TextArrangement",u=n[f];if(!u){a.info('Missing "'+f+'" annotation for "'+e+'" EDM property of "'+o+'" entity type.',l);return false}var h=u.EnumMember;if(h===undefined){p(false,'Missing "EnumMember" attribute of "'+f+'" annotation for "'+e+'" EDM property of "'+o+'" entity type. - '+l);return false}if(!(h.split("/")[1]in s)){p(false,'Invalid "'+h+'" Text annotation enumeration member for "'+e+'" EDM property of "'+o+'" entity type. - '+l);return false}if(u.EnumMember===s.TextSeparate){return false}if(i.indexOf("/")===-1){p(false,'Invalid navigation property URL path name specified in the "'+y+'" annotation of the "'+e+'" EDM property of the "'+o+'" entity type. - '+l);return false}var c=i.split("/")[0],g=this.findProperty(r.navigationProperty,c);if(!g){p(false,'The navigation property URL path name "'+c+'" (specified in the Text annotation of the "'+e+'" EDM property) was not found in the "'+o+'" entity type of the service metadata document. - '+l);return false}var v=this.getAssociation(r,c);if(!v){p(false,'Missing "'+g.relationship+'" association for "'+g.name+'" EDM navigation property of the "'+o+'" entity type. - '+l);return false}var d=v.referentialConstraint;if(!d){p(false,'Missing referential constraint for "'+g.relationship+'" association in the service metadata document. - '+l);return false}if(!Array.isArray(v.end)||!(v.end.length>0)){p(false,'Missing association end for "'+g.relationship+'" association in the service metadata document. - '+l);return false}var m=this.getToRoleAssociationEndMultiplicity(v.end,g.toRole);if(m!=="1"){p(false,'Expected multiplicity of 1 for "'+g.toRole+'" association end of the "'+g.relationship+'" association in the service metadata document. - '+l);return false}if(d.principal.propertyRef.length!==1||d.dependent.propertyRef.length!==1){p(false,'Expected the single "'+e+'" foreign key EDM property as '+'referential constraint in the "'+g.relationship+'" association. - '+l);return false}var P=t.entityTypeOfNavigationProperty||this.getNavigationProperty(r,c).entityType;if(P.key.propertyRef.length!==1){p(false,'Expected a single key property in the lookup "'+P.namespace+"."+P.name+'" entity type. - '+l);return false}var A=d.principal.propertyRef[0].name;if(A!==P.key.propertyRef[0].name){p(false,'Expected a property named "'+A+'" to be the single key property in the lookup "'+P.namespace+"."+P.name+'" entity type. - '+l);return false}return true};l.prototype.checkNavigationPropertyRequiredMetadataNoAsserts=function(t){var e=t.textAnnotation,n=e?e.Path:"",i=t.entityType;if(!e){return false}if(n===undefined){return false}if(n===""){return false}var a="com.sap.vocabularies.UI.v1.TextArrangement",r=e[a];if(!r){return false}var o=r.EnumMember;if(o===undefined){return false}if(!(o.split("/")[1]in s)){return false}if(r.EnumMember===s.TextSeparate){return false}if(n.indexOf("/")===-1){return false}var p=n.split("/")[0],l=this.findProperty(i.navigationProperty,p);if(!l){return false}var y=this.getAssociation(i,p);if(!y){return false}var f=y.referentialConstraint;if(!f){return false}if(!Array.isArray(y.end)||!(y.end.length>0)){return false}var u=this.getToRoleAssociationEndMultiplicity(y.end,l.toRole);if(u!=="1"){return false}if(f.principal.propertyRef.length!==1||f.dependent.propertyRef.length!==1){return false}var h=t.entityTypeOfNavigationProperty||this.getNavigationProperty(i,p).entityType;if(h.key.propertyRef.length!==1){return false}var c=f.principal.propertyRef[0].name;if(c!==h.key.propertyRef[0].name){return false}return true};l.prototype.checkValueListRequiredMetadataForTextArrangmentNoAsserts=function(t){var e=t.valueListAnnotation;if(!e){return false}if(!Array.isArray(e.fields)){return false}var n=e.descriptionField,i=this.findProperty(e.fields,n);if(!i){return false}if(i["sap:filterable"]==="false"){return false}return true};l.prototype.checkValueListRequiredMetadataForTextArrangment=function(t){var e=t.valueListAnnotation,n="sap.ui.comp.smartfield.ODataHelper";if(!e){var i=t.entityType,a=i.namespace+"."+i.name;p(false,'Missing "ValueList" annotation for "'+t.propertyName+'" EDM property of "'+a+'" entity type. - '+n);return false}if(!Array.isArray(e.fields)){p(false,'Missing fields for "'+e.valueListEntityName+'" entity. - '+n);return false}var r=e.descriptionField,o=this.findProperty(e.fields,r);if(r!==undefined){if(!o){p(false,'The "'+r+'" description field was not found '+"in the service metadata document. - "+n);return false}if(o["sap:filterable"]==="false"){p(false,'Expected the "'+o.fullName+'" field to be filterable. - '+n);return false}}return true};l.prototype.checkValueListRequiredMetadataForValidation=function(t){var e=t.valueListAnnotation;if(!e){return false}if(!Array.isArray(e.fields)){return false}return true};l.prototype.getEdmDisplayPath=function(t){var e=t.annotations.text;if(e){return e.path}return t.path};l.prototype.getTextAnnotationPropertyPath=function(t){return t?t.path:""};l.prototype.getAbsolutePropertyPathToValueListEntity=function(t){var e=t.property,n=e&&e["com.sap.vocabularies.Common.v1.Text"],i=t.bindingContextPath;if(typeof i==="string"&&i!==""&&n){return i+"/"+n.Path}var a=t.entitySet,r=t.entityID,p;if(r==null||r===""){return""}if(n&&a){if(t.property.type=="Edm.Guid"){p=t.entityID.toLowerCase()}else{p=t.entityID}p=o.formatValue(p,t.property.type,true);return"/"+a.name+"("+encodeURIComponent(p)+")"+"/"+n.Path}return""};l.prototype.getODataValueListKeyProperty=function(t){for(var e=0;e<t.fields.length;e++){var n=t.fields[e];if(n.name===t.keyField){return n}}};l.prototype.getUOMPath=function(t){if(t&&t.annotations&&t.annotations.uom){return t.annotations.uom.path}return null};l.prototype.getUOMTypePath=function(t){if(t.property.complex){return t.property.typePath.replace(t.property.property.name,t.annotations.uom.property.name)}return t.annotations.uom.property.name};l.prototype.getDropdownChangeHandler=function(t,e){return function(n){var i="",r=false;try{if(e){if(t.getFirstInnerControl&&t.getFirstInnerControl().setEnteredValue){t.getFirstInnerControl().setEnteredValue()}i=n.getSource().getSelectedKey();r=i!==null;if(!r){i=n.getSource().getValue()}}else{var o=n.getParameter("selectedItem");if(!o&&n.getSource().getSelectedItem){o=n.getSource().getSelectedItem()}if(o){i=o.getKey();r=i!==null}}t.fireChange({value:i,newValue:i,selectionChange:r})}catch(t){a.warning(t)}}};l.prototype.destroy=function(){if(this._oAnalyzer){this._oAnalyzer.destroy()}if(this.oAnnotation){this.oAnnotation.destroy()}this._oUtil=null;this.oMeta=null;this.oAnalyzer=null;this.oAnnotation=null};l.prototype.getAutoExpandProperties=function(t){var e=[],n=[];for(var i in t){switch(i){case"com.sap.vocabularies.Common.v1.Text":case"Org.OData.Measures.V1.Unit":case"Org.OData.Measures.V1.ISOCurrency":case"com.sap.vocabularies.Common.v1.FieldControl":if(t[i].Path){n=t[i].Path.split("/")}break}if(n.length>1&&e.indexOf(n[0])<0){e.push(n[0])}}return e.join(",")};l.prototype.loadValueListAnnotation=function(t,e){var n=this.getAnalyzer().getValueListAnnotationLazy(t,e);n.catch(function(){a.error("The value list annotation could not be loaded.",undefined,"sap.ui.comp.smartfield.ODataHelper.loadValueListAnnotation")});return n};return l},true);
/*
 * SAPUI5
 * (c) Copyright 2009-2023 SAP SE. All rights reserved.
 */
sap.ui.predefine("sap/ui/comp/smartfield/ODataTypes", ["sap/ui/model/SimpleType","sap/ui/core/format/NumberFormat","sap/ui/model/odata/type/Boolean","sap/ui/comp/smartfield/type/Double","sap/ui/comp/smartfield/type/DateTime","sap/ui/comp/odata/type/StringDate","sap/ui/comp/odata/type/FiscalDate","sap/ui/comp/odata/type/NumericText","sap/ui/comp/smartfield/type/DateTimeOffset","sap/ui/model/odata/type/DateTimeWithTimezone","sap/ui/comp/smartfield/type/Decimal","sap/ui/comp/smartfield/type/Int16","sap/ui/comp/smartfield/type/Int32","sap/ui/comp/smartfield/type/Int64","sap/ui/comp/smartfield/type/Byte","sap/ui/comp/smartfield/type/SByte","sap/ui/comp/smartfield/type/String","sap/ui/comp/smartfield/type/StringNullable","sap/ui/comp/smartfield/type/TextArrangementString","sap/ui/comp/smartfield/type/TextArrangementGuid","sap/ui/comp/smartfield/type/AbapBool","sap/ui/comp/smartfield/type/Currency","sap/ui/comp/smartfield/type/Time","sap/ui/comp/smartfield/type/Guid","sap/ui/comp/odata/MetadataAnalyser","sap/ui/comp/odata/FiscalMetadata","sap/ui/comp/smartfield/type/Unit","sap/ui/comp/smartfield/type/IanaTextArrangement","sap/ui/comp/odata/type/CalendarDate","sap/ui/comp/odata/CalendarMetadata","sap/ui/comp/library"],function(e,t,r,n,a,i,o,s,p,u,l,m,c,f,y,g,d,h,C,v,T,D,F,_,x,w,S,b,O,A,E){"use strict";var I=E.numericEdmTypes;var N=function(e){this._oParent=e};N.prototype.getType=function(t,T,D,S){S=S||{};var E=this._oParent.getBindingInfo("value"),N=E&&E.binding&&E.binding.getType(),L=S.composite&&N instanceof e;if(N&&!L){return B(N)}if(t&&t.property&&t.property.type){if(!N){D=this.getConstraints(t.property,D);T=this.getFormatOptions(t.property,T)}if(I.indexOf(t.property.type)!==-1&&D.nullable===false){T.parseEmptyValueToZero=true}switch(t.property.type){case"Edm.Boolean":return new r(T,D);case"Edm.Double":return new n(T,D);case"Edm.Decimal":case"Edm.Single":return new l(T,this._getDecimalConstraints(t,D));case"Edm.Int16":return new m(T,D);case"Edm.Int32":return new c(T,D);case"Edm.Int64":return new f(T,D);case"Edm.Byte":return new y(T,D);case"Edm.SByte":return new g(T,D);case"Edm.DateTimeOffset":if(this.isWithTimeZone(t)){return new u(T)}return new p(T,D);case"Edm.DateTime":return new a(T,this._getDateTimeConstraints(t,D));case"Edm.String":var P=A.getCalendarAnnotationType(t.property);if(P){return new O(T,D,{calendarType:P})}if(this.isCalendarDate(t)){return new i(T)}var M=w.getFiscalAnnotationType(t.property);if(M){return new o(T,D,{fiscalType:M})}if(!N){D=this._getStringConstraints(t,D)}if(N&&!D){D=N.oConstraints}if(D&&D.isDigitSequence&&!S.composite){return new s(T,D)}if(S.composite&&this.isTimeZone(t)){T=Object.assign({},T,this._getTextArrangementFormatOptions());return new b(T,D,this._getTextArrangementOptions(S))}if(S.composite){T=Object.assign({},T,this._getTextArrangementFormatOptions());return new C(T,D,this._getTextArrangementOptions(S))}if(this.isTimeZone(t)){return new u(T)}if(t.isStringNullable){return new h(T,D)}return new d(T,D);case"Edm.Time":return new F(T,D);case"Edm.Guid":var V={},k=this._getTextArrangementFormatOptions();if(x.hasTextArrangementAnnotation(t.property)&&k&&k.textArrangement==="descriptionOnly"){V={validateException:{resourceBundle:"sap.ui.comp",text:"ENTER_AN_EXISTING_DESCRIPTION"}}}if(S.composite){T=Object.assign({},T,this._getTextArrangementFormatOptions());return new v(T,D,this._getTextArrangementOptions(S))}return new _(T,D,V);default:return null}}return null};function B(e){var t=e.parseValue,r=e.destroy;e.parseValue=function(e,r){var n=t.apply(this,arguments);if(typeof this.oFieldControl==="function"){this.oFieldControl(e,r)}return n};e.destroy=function(){r.apply(this,arguments);this.oFieldControl=null};return e}N.prototype.getConstraints=function(e,t){return Object.assign({},t,{nullable:x.isNullable(e),skipDecimalsValidation:x.isSkippingMeasuredQuantityCheck(e)})};N.prototype.getFormatOptions=function(e,t){var r={};if(x.isUpperCase(e)){r.displayFormat="UpperCase"}return Object.assign({},t,r)};N.prototype._getDateTimeConstraints=function(e,t){var r={},n;if(e.property["sap:display-format"]==="Date"||this.isCalendarDate(e)){r={displayFormat:"Date"}}for(n in t){r[n]=t[n]}return r};N.prototype.getMaxLength=function(e,t){var r=[],n,a=0;if(t&&t.constraints){if(t.constraints.maxLength&&t.constraints.maxLength>-1){r.push(t.constraints.maxLength)}}if(t&&t.type&&t.type.oConstraints){if(t.type.oConstraints.maxLength&&t.type.oConstraints.maxLength>-1){r.push(t.type.oConstraints.maxLength)}}if(e&&e.property&&e.property.maxLength){var i=parseInt(e.property.maxLength);if(i>-1){r.push(i)}}var o=this._oParent.getMaxLength();if(o>0){r.push(o)}var s=r.length;while(s--){n=r[s];if(n>0){if(a>0){if(n<a){a=n}}else{a=n}}}return a};N.prototype._getDecimalConstraints=function(e,t){var r=e.property;t=t||{};if(r.precision){t.precision=parseInt(r.precision)}if(r.scale){t.scale=parseInt(r.scale)}if(r["sap:variable-scale"]){t.variableScale=r["sap:variable-scale"]==="true"}return t};N.prototype._getTextArrangementFormatOptions=function(){return{textArrangement:this._oParent.getControlFactory()._getDisplayBehaviourConfiguration()}};N.prototype._getStringConstraints=function(e,t){t=t||{};var r=this._oParent.getBindingInfo("value"),n=this.getMaxLength(e,r),a;if(r&&r.type&&r.type.oConstraints){if(r.type.oConstraints.equals){a=r.type.oConstraints.equals}}if(n>0||a){if(n>0){t.maxLength=n}if(a){t.equals=a}}if(x.isDigitSequence(e.property)){t.isDigitSequence=true}return t};N.prototype._getTextArrangementOptions=function(e){var t=this._oParent.getControlFactory().oTextArrangementDelegate;return{keyField:e.keyField,descriptionField:e.descriptionField,valueListNoValidation:e.valueListNoValidation,valueList:e.valueList,onBeforeValidateValue:t.onBeforeValidateValue.bind(t),delegate:e.delegate,clientSideMandatoryCheck:this._oParent.getClientSideMandatoryCheck()}};N.prototype.isCalendarDate=function(e){var t=e.property["com.sap.vocabularies.Common.v1.IsCalendarDate"];if(t&&t.Bool){return t.Bool?t.Bool!=="false":true}return false};N.prototype.isTimeZone=function(e){return e.property["com.sap.vocabularies.Common.v1.IsTimezone"]&&e.property["com.sap.vocabularies.Common.v1.IsTimezone"].Bool!=="false"};N.prototype.isWithTimeZone=function(e){return e.property["com.sap.vocabularies.Common.v1.Timezone"]?true:false};N.prototype.getDisplayFormatter=function(e,t){t=t||{};if(t.currency){return this.getCurrencyDisplayFormatter(t)}else if(t.type&&t.type.oConstraints&&t.type.oConstraints.scale&&e.scale){e.scale=t.type.oConstraints.scale}return this.getUOMDisplayFormatter(e,t)};N.prototype.getCurrencyDisplayFormatter=function(e){var t={showMeasure:false,emptyString:NaN},r;this._enhanceFormatOptions(t);r=new D(t);return function(t,n,a){var i,o,s,p,u,l=this&&this.oParent&&this.oParent.oParent,m=l&&l.isA("sap.ui.comp.smartfield.SmartField")&&l.isFormContextType();if(!t||!n||n==="*"){return""}if(!e.currency){i=t+="";return i}if(isNaN(parseFloat(t))){return t.toString()+""}i=r.formatValue([t,n,a],"string");p=a&&a[n]&&a[n].digits;s=r&&r.oOutputFormat&&r.oOutputFormat.oLocaleData.getCurrencyDigits(n);o=p||s;if(o===0&&!m){i+=""}u=3-o;if(u&&!m&&i){i=i.padEnd(i.length+u,"")}else{i+=""}if(e.mask){return N.maskValue(i)}return i}};N.prototype.getUOMDisplayFormatter=function(e,t){var r={showMeasure:false,emptyString:NaN},n;this._enhanceFormatOptions(r);n=new S(r,{scale:e&&e.scale?e.scale:0});return function(e,r,a){var i,o,s=this&&this.oParent&&this.oParent.oParent,p=s&&s.isA("sap.ui.comp.smartfield.SmartField")&&s.isFormContextType();if(!e&&e!==0||!r&&r!==""||r==="*"){return""}if(isNaN(parseFloat(e))){return e.toString()+""}i=n.formatValue([e,r,a],"string");o=a&&a[r]&&a[r].UnitSpecificScale;if((o===0||o===null)&&!p){i+=""}if(!p&&s&&s.getControlContext&&s.getControlContext()===""&&i&&o){i=i.padEnd(i.length+1,"")}if(p){i+=""}if(t&&t.mask){return N.maskValue(i)}return i}};N.maskValue=function(e){if(e){return e.replace(new RegExp(".","igm"),"*")}return e};N.prototype.getCurrencyType=function(e){if(e){var t=this._getDecimalConstraints(e),r=this.getConstraints(e.property,t),n=L(r),a=P(t);this._enhanceFormatOptions(n);return new D(n,this.getConstraints(e.property,a))}return null};N.prototype.getUoMType=function(e){var t=["edm.int16","edm.int32","edm.byte","edm.double"];if(e){var r=this._getDecimalConstraints(e),n=this.getConstraints(e.property,r),a=L(n);if(t.includes(e.property.type.toLowerCase())){a.parseAsString=false;n.type=e.property.type}this._enhanceFormatOptions(a);return new S(a,n)}return null};function L(e){var t=e.nullable?null:0;return{showMeasure:false,parseAsString:true,emptyString:t,precision:e.precision}}function P(e){return{precision:e.precision,scale:e.scale,variableScale:e.variableScale}}N.prototype.getAbapBoolean=function(){return new T};N.prototype.destroy=function(){this._oParent=null};N.prototype._enhanceFormatOptions=function(e){var t=this._getCustomDataConfiguration();if(typeof t.preserveDecimals==="boolean"){e.preserveDecimals=t.preserveDecimals}};N.prototype._getCustomDataConfiguration=function(){var e={},t;if(this._oParent){t=this._oParent.data("preserveDecimals");if(t){e.preserveDecimals=t==="true"}}return e};return N},true);
/*!
 * SAPUI5
 * (c) Copyright 2009-2023 SAP SE. All rights reserved.
 */
sap.ui.predefine("sap/ui/comp/smartfield/ObjectStatus", ["sap/ui/comp/library","sap/ui/core/Element"],function(e,t){"use strict";var i=t.extend("sap.ui.comp.smartfield.ObjectStatus",{metadata:{library:"sap.ui.comp",properties:{criticality:{type:"any",group:"Misc",defaultValue:null},criticalityRepresentationType:{type:"sap.ui.comp.smartfield.CriticalityRepresentationType",group:"Misc",defaultValue:e.smartfield.CriticalityRepresentationType.WithIcon}}}});return i});
/*
 * SAPUI5
 * (c) Copyright 2009-2023 SAP SE. All rights reserved.
 */
sap.ui.predefine("sap/ui/comp/smartfield/SideEffectUtil", ["sap/ui/comp/odata/SideEffects"],function(t){"use strict";var e=function(e){this._oParent=e;this._oSideEffects=new t};e.prototype.getFieldGroupIDs=function(t,e){var i,n,r,o;if(t.property&&t.property.complex){n=t.property.parents[0];r=this._toTypePath(t.path,n)}i={entitySet:t.entitySet,entityType:t.entityType,complexType:n};o=this._oSideEffects.getSideEffects(t.path,r,i);return this._calcFieldGroups(o,t,e)};e.prototype._calcFieldGroups=function(t,e,i){var n,r,o,f,s=[],p;r=this._getSideEffects(t,e,i);f=r.length;p=this._oParent.getBindingContext();n=p.getPath();for(o=0;o<f;o++){this._calcFieldGroups2(r[o],s,i,n,p)}return s.length>0?s:null};e.prototype._calcFieldGroups2=function(t,e,i,n,r){var o,f,s,p=this;t.sideEffects.forEach(function(c){s={name:c.name,originType:c.originType,originName:t.origin.name,originNamespace:t.origin.namespace,context:n};f=JSON.stringify(s);f=f.substring(1,f.length-2);o=i.data(f);if(!o){o=p.createUUID();s.contextObject=r;i.data(o,s);i.data(f,o)}e.push(o)})};e.prototype._getSideEffects=function(t,e){var i=[];var n={};n.sideEffects=this._getSideEffectsFromEntity("entitySet",t);if(n.sideEffects&&n.sideEffects.length){n.origin=e.entitySet;i.push(n)}n={};n.sideEffects=this._getSideEffectsFromEntity("entityType",t);if(n.sideEffects&&n.sideEffects.length){n.origin=e.entityType;i.push(n)}n={};n.sideEffects=this._getSideEffectsFromEntity("complexType",t);if(n.sideEffects&&n.sideEffects.length){n.origin=e.property.parents[0];i.push(n)}return i};e.prototype._getSideEffectsFromEntity=function(t,e){var i,n=[];if(e[t]){for(i in e[t]){n.push({name:i,originType:t,sideEffect:e[t][i]})}}return n};e.prototype._toTypePath=function(t,e){var i=t.split("/");return t.replace(i[0],e.name)};e.prototype.createUUID=function(){var t=(new Date).getTime();var e="xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx".replace(/[x]/g,function(e){var i=(t+Math.random()*16)%16|0;t=Math.floor(t/16);return(e==="x"?i:i&7|8).toString(16)});return e};e.prototype.destroy=function(){if(this._oSideEffects){this._oSideEffects.destroy()}this._oSideEffects=null};return e},true);
/*!
 * SAPUI5
 * (c) Copyright 2009-2023 SAP SE. All rights reserved.
 */
sap.ui.predefine("sap/ui/comp/smartfield/SmartField", ["sap/ui/core/Core","sap/ui/core/library","sap/ui/comp/library","sap/m/library","./JSONControlFactory","./ODataControlFactory","./BindingUtil","./SideEffectUtil","./ODataHelper","./ValidationUtil","./LifecycleUtil","sap/ui/core/Control","sap/ui/model/ParseException","sap/ui/model/ValidateException","sap/ui/comp/smartfield/UoMValidateException","sap/ui/model/json/JSONModel","sap/ui/model/BindingMode","sap/base/strings/capitalize","sap/base/Log","sap/base/util/Deferred","sap/m/DisplayListItem","sap/m/InputListItem","sap/ui/core/message/MessageMixin","./TextArrangementRead","sap/ui/Device","sap/ui/base/ManagedObjectObserver"],function(t,e,i,r,o,n,a,s,l,u,d,p,h,f,c,g,y,_,m,C,b,v,V,S,I,E){"use strict";var P=e.ValueState;var F=i.smartfield.TextInEditModeSource;var M=i.smartfield.Importance;var x=e.TextAlign;var T=r.FlexJustifyContent;var A=e.TextDirection;var D=i.smartfield.ControlContextType;var B=i.smartfield.ControlProposalType;var L=r.EmptyIndicatorMode;var O=p.extend("sap.ui.comp.smartfield.SmartField",{metadata:{interfaces:["sap.ui.core.IFormContent","sap.ui.core.ISemanticFormContent"],library:"sap.ui.comp",designtime:"sap/ui/comp/designtime/smartfield/SmartField.designtime",properties:{value:{type:"any",group:"Misc",defaultValue:null},enabled:{type:"boolean",group:"Misc",defaultValue:true},entitySet:{type:"string",group:"Misc",defaultValue:""},editable:{type:"boolean",group:"Misc",defaultValue:true},contextEditable:{type:"boolean",group:"Misc",defaultValue:true},width:{type:"sap.ui.core.CSSSize",group:"Misc",defaultValue:""},textAlign:{type:"sap.ui.core.TextAlign",group:"Misc",defaultValue:x.Initial},textDirection:{type:"sap.ui.core.TextDirection",group:"Appearance",defaultValue:A.Inherit},placeholder:{type:"string",group:"Misc",defaultValue:""},name:{type:"string",group:"Misc",defaultValue:""},valueState:{type:"sap.ui.core.ValueState",group:"Appearance",defaultValue:P.None},valueStateText:{type:"string",group:"Appearance",defaultValue:""},showValueStateMessage:{type:"boolean",group:"Appearance",defaultValue:true},jsontype:{type:"sap.ui.comp.smartfield.JSONType",group:"Misc",defaultValue:null},mandatory:{type:"boolean",group:"Misc",defaultValue:false},maxLength:{type:"int",group:"Misc",defaultValue:0},showSuggestion:{type:"boolean",group:"Misc",defaultValue:true},showValueHelp:{type:"boolean",group:"Misc",defaultValue:true},showLabel:{type:"boolean",group:"Appearance",defaultValue:true},textLabel:{type:"string",group:"Misc",defaultValue:""},tooltipLabel:{type:"string",group:"Misc",defaultValue:""},uomVisible:{type:"boolean",group:"Misc",defaultValue:true},uomEditable:{type:"boolean",group:"Misc",defaultValue:true},uomEnabled:{type:"boolean",group:"Misc",defaultValue:true},url:{type:"string",group:"Misc",defaultValue:""},uomEditState:{type:"int",group:"Misc",defaultValue:-1},controlContext:{type:"sap.ui.comp.smartfield.ControlContextType",group:"Misc",defaultValue:D.None},proposedControl:{type:"sap.ui.comp.smartfield.ControlProposalType",group:"Misc",defaultValue:B.None},wrapping:{type:"boolean",group:"Misc",defaultValue:true},clientSideMandatoryCheck:{type:"boolean",group:"Misc",defaultValue:true},fetchValueListReadOnly:{type:"boolean",group:"Misc",defaultValue:true},expandNavigationProperties:{type:"boolean",group:"Behavior",defaultValue:false},textInEditModeSource:{type:"sap.ui.comp.smartfield.TextInEditModeSource",group:"Behavior",defaultValue:F.None},historyEnabled:{type:"boolean",group:"Misc",defaultValue:true},importance:{type:"sap.ui.comp.smartfield.Importance",group:"Misc",defaultValue:M.Low},fixedValueListValidationEnabled:{type:"boolean",group:"Misc",defaultValue:false},_internalFieldGroupIds:{type:"string[]",defaultValue:[],visibility:"hidden"}},aggregations:{_content:{type:"sap.ui.core.Control",multiple:false,visibility:"hidden"},configuration:{type:"sap.ui.comp.smartfield.Configuration",multiple:false},controlProposal:{type:"sap.ui.comp.smartfield.ControlProposal",multiple:false},_ariaLabelInvisibleText:{type:"sap.ui.core.InvisibleText",multiple:true,visibility:"hidden"},semanticObjectController:{type:"sap.ui.comp.navpopover.SemanticObjectController",multiple:false}},associations:{ariaLabelledBy:{type:"sap.ui.core.Control",multiple:true,singularName:"ariaLabelledBy"},ariaDescribedBy:{type:"sap.ui.core.Control",multiple:true,singularName:"ariaDescribedBy"}},events:{entitySetFound:{parameters:{entitySet:{type:"string"}}},change:{parameters:{value:{type:"string"},newValue:{type:"string"}}},changeModelValue:{parameters:{valueChanged:{type:"boolean"},valueLastValueState:{type:"boolean"},unitChanged:{type:"boolean"},unitLastValueState:{type:"sap.ui.core.ValueState"}}},initialise:{},visibleChanged:{parameters:{visible:{type:"boolean"}}},editableChanged:{parameters:{editable:{type:"boolean"}}},contextEditableChanged:{parameters:{editable:{type:"boolean"}}},modeToggled:{},innerControlsCreated:{},valueListChanged:{parameters:{changes:{type:"sap.ui.core.Control[]"}}},press:{}}},renderer:{apiVersion:2,render:function(e,i){var r=i.getContent(),o=i.getFirstInnerControl();e.openStart("div",i);e.class("sapUiCompSmartField");e.openEnd();if(r&&i.getMode()==="display"&&i.isFormContextType()&&i._innerControlHasNoValue()&&o!==null&&!o.getMetadata().hasProperty("emptyIndicatorMode")){e.openStart("span");e.class("sapUiPseudoInvisibleText");e.openEnd();e.text(t.getLibraryResourceBundle("sap.ui.comp").getText("NO_VALUE"));e.close("span");e.openStart("span");e.attr("aria-hidden","true");e.class("sapMText");e.class("sapUiSelectable");e.class("sapMTextMaxWidth");e.class("sapUiCompSmartFieldValue");e.class("sapUiCompEmptyValue");e.openEnd();e.close("span")}e.renderControl(r);if(i.getAggregation("_ariaLabelInvisibleText")){i.getAggregation("_ariaLabelInvisibleText").forEach(function(t){e.renderControl(t)})}e.close("div")}}});V.call(O.prototype);var w=O.prototype.refreshDataState;O.prototype.init=function(){this._isInnerControlCreationDelayed=true;this._sAnnotationLabel="";this._bInDestroy=false;this._oSideEffects=new s(this);this._oFactory=null;this._oControl={display:null,edit:null,current:null};this._oValue={display:null,edit:null,uom:null,uomset:null};this._oError={bComplex:false,bFirst:false,bSecond:false};this._oState=this._initState();this._oUtil=new a;this._bSuppressToggleControl=false;this.oValidation=new u(this);this._oLastValidated=null;this.attachModelContextChange(function(){if(this._hasDefaultModel()){d._createICRenderedDeferred.call(this);this.invalidate()}}.bind(this));this._initialStateApplied=new C;this._initialStateApplied.promise.then(function(){var t=this.getBinding("value");if(t){var e=function(){var i=this.getBinding("value").getDataState();if(i.getOriginalValue()!==i.getValue()){this._bValueNotInitial=true;t.detachChange(e)}}.bind(this);t.attachChange(e)}}.bind(this));this._oObserverConfiguration={properties:["visible"]};this._oObserver=new E(function(t){if(!t){return}if(t.type==="property"&&t.name==="visible"&&t.current===false){this._oState._setProperty("VISIBLE",t.current);this.fireVisibleChanged({visible:t.current})}}.bind(this));this._oObserver.observe(this,this._oObserverConfiguration)};O.prototype._getNextModeRenderedPromise=d._getNextModeRenderedPromise;O.prototype._getICRenderedPromise=d._getICRenderedPromise;O.prototype._rejectLifecyclePromises=d._rejectAll;O.prototype._shouldSuppressTextAnnotation=function(){return this.data("suppressCommonText")==="true"};O.prototype._setVisibilityBasedOnImportance=function(t){var e,i,r,o,n,a=this._oFactory,s=this.oParent&&this.oParent.isA("sap.ui.comp.smartform.GroupElement")&&this.oParent.getDomRef();if(!a||!s){return}e=a.getMetaData&&a.getMetaData();i=e&&e.property&&e.property.property;o=a._oHelper&&a._oHelper.oAnnotation;if(o){if(!o.isNullable(i)||o.isStaticMandatory(i)||o.getVisible(i)==="false"){return}}if(this.getMandatory()||!this.getVisible()||this._fieldControlValue===0||this._fieldControlValue===7){return}r=!this.isPropertyInitial("importance")&&this.getImportance()||o&&o.getImportanceAnnotation(i);switch(t){case M.High:n=r===M.High?"":"none";break;case M.Medium:n=r===M.Low?"none":"";break;default:n=""}s.style.display=n};O.prototype.getComputedTextLabel=function(){return this.getProperty("textLabel")||this._sAnnotationLabel};O.prototype.isPropertyBeingUpdatedByModel=function(t){var e=this.getBindingInfo(t);return!!(e&&e.skipModelUpdate)};O.prototype._boundEntityExists=function(t){t=t||this.getBindingContext();return!!(t&&t.getObject())};O.prototype.setShowValueHelp=function(t){var e=this.getShowValueHelp();this.setProperty("showValueHelp",t,true);var i=this.getContent();if(i&&typeof i.setShowValueHelp==="function"){t=this.getShowValueHelp();var r=t!==e,o=this._oFactory;if(r&&o){if(t){o._createValueHelp()}else{o.destroyValueHelp()}}i.setShowValueHelp(t)}return this};O.prototype.setShowSuggestion=function(t){var e=this.getShowSuggestion();this.setProperty("showSuggestion",t,true);var i=this.getContent();if(i&&typeof i.setShowSuggestion==="function"){t=this.getShowSuggestion();var r=t!==e,o=this._oFactory;if(r&&o){if(t){o._createValueHelp()}else{o.destroyValueHelp()}}i.setShowSuggestion(t)}return this};O.prototype.setConfiguration=function(t){var e=this.getConfiguration(),i=this.setAggregation("configuration",t,true);t=this.getConfiguration();var r=!!(t&&e===null||e&&t===null),o=!!this.getContent();if(o&&(r||t&&e&&(t.getControlType()!==e.getControlType()||t.getDisplayBehaviour()!==e.getDisplayBehaviour()))){this._destroyControls();this._toggleInnerControlIfRequired({mode:this.getMode()});if(t&&t.getDisplayBehaviour()){this._onInnerControlToggled({mode:this.getMode(),fetchIDAndDescription:true,forceTextArrangementFetch:true})}}return i};O.prototype.setTooltip=function(t){this._refreshTooltipBaseDelegate(t);this.setAggregation("tooltip",t,true);var e=this.getFirstInnerControl();if(e){e.setTooltip(t)}return this};O.prototype._setOnInnerControl=function(){var t,e,i=this.getContent(),r=this.getFirstInnerControl(),o=this.getTextAlign();if(i){if(typeof i.setWidth==="function"){var n=this.getWidth();if(n){i.setWidth(n)}}this._setPropertyOnControls("wrapping",this.getWrapping());if(typeof i.setName==="function"){i.setName(this.getName())}if(typeof i.setPlaceholder==="function"&&this.getPlaceholder()!==""){i.setPlaceholder(this.getPlaceholder())}if(typeof i.setTextAlign==="function"&&(!i.getTextAlign()||o!==x.Initial)){i.setTextAlign(o)}if(typeof i.setJustifyContent==="function"){e=i.getJustifyContent();if(!e||e===""){if(o===x.Initial||o===x.Begin){t=T.Start}else if(o==="Right"){t=T.End}else{t=o}i.setJustifyContent(t)}}this._setPropertyOnControls("required",this.getMandatory());this._setPropertyOnControls("textDirection",this.getTextDirection());if(r&&r.getMetadata().getProperty("textAlign")&&(!r.getTextAlign()||o!==x.Initial)){this._setPropertyOnControls("textAlign",o)}}return this};O.prototype.getUomProperty=function(t){var e=this._getEmbeddedSmartField(),i=e&&e.getControlFactory(),r=i&&i._oFieldControl,o=_(t),n="getUom"+o,a=this[n]();if(e.isBound(t)&&r){var s=i.getMetaData();if(s){var l=r._oStoredBindings[t],u=r["_get"+o](s,l,t);u.path();var d=u.formatter.call(e,a);return d}}return a};O.prototype._setPropertyOnControls=function(t,e,i){i=i||this.getInnerControls();i.forEach(function(i){var r="set"+_(t);if(typeof i[r]==="function"){i[r](this._convertValueForControl(t,e,i))}},this)};O.prototype._convertValueForControl=function(t,i,r){var o;if(r){o=r.getMetadata().getProperty(t)}if(o){switch(t){case"wrapping":switch(o.type){case"boolean":return i;case"sap.ui.core.Wrapping":var n=e.Wrapping;if(i){return n.Soft}return n.None}}}return i};O.prototype.setEntitySet=function(t){this.setProperty("entitySet",t,true);this.fireEntitySetFound({entitySet:t});return this};O.prototype._setPendingEditState=function(t){this.data("pendingEditableState",!t)};O.prototype.setContent=function(t){return this.setAggregation("_content",t)};O.prototype.getContent=function(){return this.getAggregation("_content")};O.prototype.getControlFactory=function(){return this._oFactory};O.prototype.getValue=function(){var t=this.getInnerValueFunction();if(t){return t()}return this.getProperty("value")};O.prototype.getInnerValueFunction=function(){if(this._oValue&&typeof this._oValue[this.getMode()]==="function"){return this._oValue[this.getMode()]}return null};O.prototype.getValueState=function(){var t=this.getInnerControls(),e=this._getMaxSeverity(t);if(e>-1){return t[e].getValueState()}return P.None};O.prototype.setValueState=function(t){this.setProperty("valueState",t,true);var e=this.getInnerControls(),i,r="setSimpleClientError";if(e&&e.length){i=e[0];if(e.length>1){r="setComplexClientErrorFirstOperand"}}if(i&&typeof i.setValueState==="function"){i.setValueState(t);this[r](t===P.Error)}return this};O.prototype.getValueStateText=function(){var t=this.getInnerControls(),e=this._getMaxSeverity(t);if(e>-1){return t[e].getValueStateText()}return this.getProperty("valueStateText")};O.prototype.setValueStateText=function(t){this.setProperty("valueStateText",t,true);var e=this.getInnerControls(),i;if(e&&e.length){i=e[0]}if(i&&typeof i.setValueStateText==="function"){i.setValueStateText(t)}return this};O.prototype._getMaxSeverity=function(t){var e,i,r,o,n=0,a=-1,s={Error:3,Warning:2,Success:1,None:0};o=t.length;for(r=0;r<o;r++){i=t[r];if(i.getValueState){e=i.getValueState();if(e&&s[e]>n){n=s[e];a=r}}}return a};O.prototype.getFocusDomRef=function(){var t=this.getInnerControls(),e,i=t.length;if(i>0){e=t[0]}if(e&&e.getFocusDomRef){return e.getFocusDomRef()}return p.prototype.getFocusDomRef.apply(this,arguments)};O.prototype.getIdForLabel=function(){var t=this.getInnerControls(),e,i=t.length;if(i>0){e=t[0]}if(e&&typeof e.getIdForLabel==="function"){return e.getIdForLabel()}return this.getId()};O.prototype.unbindProperty=function(t,e){p.prototype.unbindProperty.apply(this,arguments);var i=this.getAllInnerControls();i.forEach(function(i){var r=i.getMetadata().getName();var o=n.getBoundPropertiesMapInfoForControl(r,{propertyName:t});if(Array.isArray(o)){o.forEach(function(t){i.unbindProperty(t,e)})}});return this};O.prototype.getMode=function(){var t=this.getEditable(),e=this.getEnabled(),i=this.getContextEditable();if(this.data("configdata")&&this.data("configdata").configdata&&this.data("configdata").configdata.isUOM&&this.data("configdata").configdata.isInnerControl&&this.data("configdata").configdata.getContextEditable){i=this.data("configdata").configdata.getContextEditable()}return t&&e&&i?"edit":"display"};O.prototype.isInEditMode=function(){return this.getMode()==="edit"};O.prototype._toggleInnerControlIfRequired=function(t){var e=t.mode;if(this._bSuppressToggleControl||(!this._oFactory||this._oFactory.bPending)){return}if(e==="edit"){this._createControlIfRequired(t)}else{var i,r=this.getProperty("value"),o=this._oFactory.getLocalTextPropertyName(),n=this.getBindingContext(),a=true;var s=this.data("configdata");if(n&&o){i=n.getProperty(o)}if(s&&s.configdata&&!s.configdata.isUOM){if(r===null||r===""&&!i){a=false}}if(a){this._createControlIfRequired(t)}else{this.setContent(null);this._oControl.current="display";this._rejectLifecyclePromises("SmartTable context optimisation")}}};O.prototype._propagateToInnerControls=function(){this._propagateFieldGroupIDs(this.getProperty("_internalFieldGroupIds"));this._setOnInnerControl();this._propagateToUoM()};O.prototype._propagateToUoM=function(){var t=this._getEmbeddedSmartField(),e=this.getUomVisible(),i;if(t){if(!this.isPropertyInitial("uomEditable")){t.setEditable(this.getUomEditable())}if(!this.isPropertyInitial("uomEnabled")){t.setEnabled(this.getUomEnabled())}if(!this.isPropertyInitial("uomVisible")){t.setVisible(e);i=t.getFirstInnerControl();if(i){i.toggleStyleClass("smartFieldPaddingRight",e)}}}};O.prototype._propagateFieldGroupIDs=function(t){var e;if(Array.isArray(t)&&t.length){e=this.getFirstInnerControl();if(e){e.setFieldGroupIds(t)}}};O.prototype._onInnerControlToggled=function(t){var e,i=this.getContent(),r,o=false,n=false,a={mode:t.mode,forceTextArrangementFetch:t.forceTextArrangementFetch};if(t&&t.fetchIDAndDescription&&this.getModel()&&this.getBindingContext()&&this.getBinding("value")){this._oFactory.fetchIDAndDescriptionCollectionIfRequired(a)}this._initialStateApplied.resolve();this._propagateToInnerControls();this._processEvents({editableChanged:t.editableChanged,editable:t.editable,contextEditableChanged:t.contextEditableChanged,contextEditable:t.contextEditable,visibleChanged:t.visibleChanged,visible:t.visible});if(t.mode==="display"&&this.isFormContextType()){this._setEmptyIndicator(this.getFirstInnerControl())}if(t.mode==="edit"&&i){i=this.getContent();r=this._oControl.edit;o=r&&i&&r.getId()===i.getId();if(o){this._checkFieldGroups({mode:t.mode})}}e=this._getEmbeddedSmartField();if(e&&e.data("configdata")&&e.data("configdata").configdata.isUOM){e.setClientSideMandatoryCheck(t.clientSideMandatoryCheck);var s=this._oFactory.getMetaData&&this._oFactory.getMetaData();if(e.getBindingInfo("editable")||s&&s.annotations&&s.annotations.uom.property&&s.annotations.uom.property.property&&s.annotations.uom.property.property["sap:updatable"]){n=true}if(t.isFormContextType&&t.contextEditable&&t.contextEditable!==t.editable&&!n&&e.getEditable()!==t.editable){e.setEditable(t.editable)}}};O.prototype._processEvents=function(t){if(t.editableChanged){this.fireEditableChanged({editable:t.editable})}if(t.contextEditableChanged){this.fireContextEditableChanged({editable:t.contextEditable})}if(t.visibleChanged){this.fireVisibleChanged({visible:t.visible})}};O.prototype._forceInitialise=function(){if(this._isBoundToDefaultModel()){return this._processStateHandler()}else if(!this.bIsListeningForDefaultModel){this.bIsListeningForDefaultModel=true;return new Promise(function(t,e){this.attachEvent("modelContextChange",{resolve:t,reject:e},this._forceInitialiseHandler,this)}.bind(this))}};O.prototype._forceInitialiseHandler=function(t,e){if(this._isBoundToDefaultModel()){this.detachEvent("modelContextChange",this._forceInitialiseHandler,this);this._processStateHandler().then(function(){e.resolve()}).catch(function(t){e.reject(t)})}};O.prototype._processStateHandler=function(){var t=this.getMode();return this._processState().then(function(){var e=this._getEmbeddedSmartFieldByMode(t);return e&&e._processState()}.bind(this))};O.prototype._updateInnerControlsIfRequired=function(){var t,e,i={mode:this.getMode(),contextEditable:this.getContextEditable(),editable:this.getEditable(),enabled:this.getEnabled(),visible:this.getVisible()};this._updateInnerControlsIfRequiredHandler(i);t=this._getEmbeddedSmartField();if(t&&t.isA("sap.ui.comp.smartfield.SmartField")){e={mode:t.getMode(),contextEditable:t.getContextEditable(),editable:t.getEditable(),enabled:t.getEnabled(),visible:t.getVisible()};t._updateInnerControlsIfRequiredHandler(e)}};O.prototype._updateInnerControlsIfRequiredHandler=function(t){this._init();if(this._oFactory!==null){this._oFactory._init(this._oFactory._oMeta)}this._toggleInnerControlIfRequired(t)};O.prototype._getInnerControlPropertyBinding=function(t){var e,i,r,o,a,s=this._oControl[t],l=s&&this._getInnerControls(s);if(Array.isArray(l)&&l.length>0){e=l[0];i=e.getMetadata().getName();r=n.getBoundPropertiesMapInfoForControl(i,{propertyName:"value"})}if(Array.isArray(r)&&r.length>0){o=r[0];a=e.getBinding(o)}return a};O.prototype.isTextInEditModeSourceNotNone=function(t){return this._getComputedTextInEditModeSource(false,t)!==F.None};O.prototype._getComputedTextInEditModeSource=function(t,e){var i=e||this.getMode(),r=this.getTextInEditModeSource(),o=this.data("defaultTextInEditModeSource");if(o&&this.isPropertyInitial("textInEditModeSource")&&i==="edit"){r=o}if(!t&&r===F.ValueListWarning){r=F.ValueListNoValidation}return r};O.prototype._isValueListWarning=function(){return this._getComputedTextInEditModeSource(true)===F.ValueListWarning};O.prototype._isValueListValidationMode=function(){var t=this._getComputedTextInEditModeSource(true);if(t===F.ValueList||t===F.ValueListWarning){return true}return false};O.prototype._createControlIfRequired=function(t){if(!this._oFactory){return}var e=t.mode,i=this._oControl[e];if(e!==this._oControl.current||!i){if(!i){var r=this._oFactory.createControl(t);if(r){this._oControl[e]=r.control;this._placeCallBacks(r,e)}}this._oControl.current=e;this.setContent(this._oControl[e]);this._oFactory.updateControl(t);this._setOnInnerControl();this._fireInnerControlsCreated();this.fireModeToggled({mode:t.mode})}else if(!this.getContent()){this._oControl.current=e;this.setContent(this._oControl[e])}};O.prototype._fireInnerControlsCreated=function(){var t=this._getEmbeddedSmartField();if(t&&t.isA("sap.ui.comp.smartfield.SmartField")){t.attachInnerControlsCreated(function(){this.fireInnerControlsCreated(this.getInnerControls())}.bind(this))}else{this.fireInnerControlsCreated(this.getInnerControls())}};O.prototype._placeCallBacks=function(t,e){if(t.params&&t.params.getValue){this._oValue[e]=t.params.getValue}if(t.params&&t.params.uom){this._oValue.uom=t.params.uom}if(t.params&&t.params.uomset){this._oValue.uomset=t.params.uomset}};O.prototype._init=function(t){var e,i,r;if(!this._oFactory){i=this.data("configdata");if(!i){e=this.getModel(t)}r=this.getBindingPath("value");if(t===undefined&&r&&(i||e)){this._oFactory=this._createFactory(t,e,r,i)}}};O.prototype.clone=function(){var t=p.prototype.clone.apply(this,arguments);t.attachModelContextChange(function(){this.invalidate()}.bind(t));d._createICRenderedDeferred.call(t);return t};O.prototype._destroyFactory=function(){this._bSuppressToggleControl=true;this._bSideEffects=false;if(this._oFactory){this._oFactory.destroy()}this._oFactory=null;this._bSuppressToggleControl=false;this._destroyControls()};O.prototype._destroyControls=function(){if(this._oControl){if(this._oControl.display){this._oControl.display.destroy()}if(this._oControl.edit){this._oControl.edit.destroy()}this._oControl.display=null;this._oControl.edit=null;this._oControl.current=null}this._oValue={display:null,edit:null,uom:null,uomset:null};this.destroyAggregation("_content")};O.prototype._createFactory=function(t,e,i,r){if(e&&e instanceof g){return new o(e,this,{model:t,path:i})}var a;if(!r){a=this._getEntitySet(t)}if(a||r){var s;if(r){s=r.configdata;this._enhanceConfigData(s)}else{s={entitySet:a,model:t,path:i}}return new n(e,this,s)}return null};O.prototype._enhanceConfigData=function(t){var e=this.data("ignoreInsertRestrictions");if(typeof e==="boolean"){t.ignoreInsertRestrictions=e}};O.prototype._getEntitySet=function(t,e){var i=this.getEntitySet(),r=i!=="";if(r&&!t){return i}var o=this.getBindingContext(t);if(o){var n=o.getPath();if(n===""||n===undefined||n==="/undefined"){return""}i=this._oUtil.correctPath(n);if(!e){this.fireEntitySetFound({entitySet:i})}return i}return""};O.prototype._getODataEntityType=function(t){var e,i,r,o,n=this.getModel(),a=n&&n.getMetaModel();e=this._getEntitySet(t);if(e===""){return}o=a.getODataEntitySet(e);if(o!==null&&o.entityType){i=o.entityType}if(i===undefined){r=a.getODataFunctionImport(e);if(r!==null&&r.returnType){i=r.returnType}}return i};O.prototype.getDataType=function(){var t;if(this._oFactory){if(this._oFactory.getDataProperty){t=this._oFactory.getDataProperty();if(t){return t.property.type}}return this.getJsonType()}return null};O.prototype.getDataProperty=function(){var t,e,i,r,o,n=this.getModel(),a=n&&n.getMetaModel();if(this._oFactory){if(this._oFactory.getDataProperty){return this._oFactory.getDataProperty()}}else{o=this.data("configdata")&&this.data("configdata").configdata;if(o&&o.property){return o.property}if(!a||!a.oModel){return null}e=this._getODataEntityType();if(e===undefined){return null}t=this.getBindingPath("value");if(t===undefined){return null}i=a.getODataEntityType(e);r=a.getODataProperty(i,t);if(r===null){return null}return{property:r}}};O.prototype.getUnitOfMeasure=function(){if(this._oValue.uom){return this._oValue.uom()}return null};O.prototype.setUnitOfMeasure=function(t){if(t&&this._oValue.uomset){this._oValue.uomset(t)}};O.prototype.setSimpleClientError=function(t){this._oError.bFirst=t};O.prototype.setComplexClientErrorFirstOperand=function(t){this._oError.bComplex=true;this._oError.bFirst=t};O.prototype.setComplexClientErrorSecondOperand=function(t){this._oError.bComplex=true;this._oError.bSecond=t};O.prototype.setComplexClientErrorSecondOperandNested=function(t){var e=this.getParent().getParent();e.setComplexClientErrorSecondOperand(t)};O.prototype._hasClientError=function(){if(this._oError.bComplex){return this._oError.bFirst||this._oError.bSecond}return this._oError.bFirst};O.prototype.checkClientError=function(t){t=Object.assign({handleSuccess:false},t);var e="The sap.ui.comp.smartfield.SmartField#checkClientError method is deprecated. "+"Please use the sap.ui.comp.smartfield.SmartField#checkValuesValidity method instead.";m.warning(e,this.getMetadata().getName());if(this.getMode()==="display"){return false}if(this._hasClientError()&&!t.handleSuccess){return true}this.getInnerControls().forEach(function(e){this._checkErrors(e,{checkClientErrorsOnly:true,handleSuccess:t.handleSuccess})}.bind(this));return this._hasClientError()};O.prototype.checkValuesValidity=function(t){var e,i=this.getControlFactory(),r;if(i&&i.getEdmProperty){r=i.getEdmProperty();if(!r){return Promise.resolve()}e=r.name}if(this.getMode()==="display"){return Promise.resolve({property:e,instance:this})}t=t||{};var o={handleSuccess:true,innerControls:this.getInnerControls(),rawValues:[]};var n=this._getEmbeddedSmartField();t=Object.assign(o,t);if(t.rawValues.length===0&&n&&n.data("configdata")&&n.data("configdata").configdata.isUOM){this._updateCurrencyRawValues(t)}return new Promise(function(i,r){var o={rawValues:t.rawValues,handleSuccess:t.handleSuccess,bCheckValuesValidity:true};var n=t.innerControls.map(function(t){return this._checkErrors(t,o)},this);Promise.all(n).then(function(){i({property:e,instance:this})}.bind(this)).catch(function(t){r({property:e,instance:this})}.bind(this))}.bind(this))};O.prototype.checkUnitValidity=function(t){var e=false;if(this.getMode()==="display"){return true}t=t||{};var i={handleSuccess:true,innerControls:this.getInnerControls(),rawValues:[]};var r=this._getEmbeddedSmartField();t=Object.assign(i,t);if(t.rawValues.length===0&&r&&r.data("configdata")&&r.data("configdata").configdata.isUOM){this._updateCurrencyRawValues(t)}if(i.innerControls.length!==2&&(i.innerControls.length!==1&&!this._oFactory._checkSuppressUnit())){throw new f}r=r?r:i.innerControls[1];var o=i.innerControls[0],a=r?r:this._getUomControl(),s,l,u,d;t=Object.assign({checkClientErrorsOnly:false,handleSuccess:true},t);if(o){var p=n.getBoundPropertiesMapInfoForControl(o.getMetadata().getName(),{propertyName:"value"});u=p&&p[0]}if(a){var g=n.getBoundPropertiesMapInfoForControl(a.getMetadata().getName(),{propertyName:"value"});d=g&&g[0]}if(u){s=o.getBinding(u)}if(d){l=a.getBinding(d)}if(!s||!l&&!this._oFactory._checkSuppressUnit()){return true}try{var y="get"+_(u),m=s.getType(),C=s.sInternalType,b=o[y]();if(C&&m){var v=t.rawValues||s.getValue(),V=m.parseValue(b,s.sInternalType,v);if(V){m.validateValue(V)}if(s.hasValidation()){var S=false,I=true,E={element:o,property:u,type:s.getType(),newValue:b,oldValue:s.getValue(),mParameters:{suppressChangeModelValue:true}};o.fireValidationSuccess(E,S,I);e=true}}}catch(t){var P={element:o,property:u,type:s.getType(),newValue:b,oldValue:s.getValue(),exception:t,message:t.message};if(t instanceof c){P.targetControl=r&&r.getFirstInnerControl()}if(t instanceof h){o.fireParseError(P)}else if(t instanceof f){o.fireValidationError(P)}else{if(t.toString()==="TypeError: Cannot read property 'decimals' of undefined"){t.validationUnitError=true}throw t}}try{if(!d||!a.getVisible()){return e}var F="get"+_(d),M=l.getType(),x=l.sInternalType,b=o[y](),T=a[F]();if(x&&M){var v=t.rawValues||s.getValue(),A=M.parseValue(T,l.sInternalType,v);if(A){M.validateValue(A)}if(l.hasValidation()){var S=false,I=true,D={element:a,property:d,type:l.getType(),newValue:T,oldValue:l.getValue(),mParameters:{suppressChangeModelValue:true}};a.fireValidationSuccess(D,S,I);e&=true}}}catch(t){var B={element:a,property:d,type:l.getType(),newValue:T,oldValue:l.getValue(),exception:t,message:t.message};if(t instanceof h){a.fireParseError(B)}else if(t instanceof f){a.fireValidationError(B)}else{t.validationUnitError=true;throw t}e=false}return e};O.prototype._updateCurrencyRawValues=function(t){t.rawValues=t.innerControls.map(function(t){var e=t.getMetadata(),i=n.getBoundPropertiesMapInfoForControl(e.getName(),{propertyName:"value"});return e.getProperty(i).get(t)})};O.prototype._checkErrors=function(t,e){e=Object.assign({checkClientErrorsOnly:false,handleSuccess:true},e);var i,r,o=this;if(t){var a=n.getBoundPropertiesMapInfoForControl(t.getMetadata().getName(),{propertyName:"value"});r=a&&a[0]}if(r){i=t.getBinding(r)}if(!i){return Promise.resolve()}var s;function l(e){var n,a={element:t,property:r,type:i.getType(),newValue:s,oldValue:i.getValue(),exception:e,message:e.message};if(e instanceof c){n=o._getEmbeddedSmartField();a.targetControl=n&&n.getFirstInnerControl()}if(e instanceof h){t.fireParseError(a)}else if(e instanceof f){t.fireValidationError(a)}else{throw e}}function u(){if(e.handleSuccess&&i.hasValidation()){var o={element:t,property:r,type:i.getType(),newValue:s,oldValue:i.getValue(),mParameters:{suppressChangeModelValue:true}};var n=false,a=true;t.fireValidationSuccess(o,n,a)}}try{var d="get"+_(r),p=i.getType(),g=i.sInternalType;s=t[d]();if(g&&p){if(e.checkClientErrorsOnly&&p.async){var y="The deprecated sap.ui.comp.smartfield.SmartField#checkClientError method can not be "+"used with async types. Please use sap.ui.comp.smartfield.SmartField#checkValuesValidity "+"method instead.";m.error(y,this.getMetadata().getName());this.setSimpleClientError(true);return Promise.reject()}if(p.async){var C=i.getDataState();var b=p.formatValue(C.getValue(),g);if(!C.isControlDirty()&&b===s){u();return Promise.resolve()}}var v=e.rawValues||i.getValue(),V=p.parseValue(s,i.sInternalType,v),S;if(V&&V instanceof Promise){S=V.then(function(t){return p.validateValue(t)}).then(u);S.catch(l);return S}S=p.validateValue(V,e.bCheckValuesValidity);if(S instanceof Promise){S.catch(l);return S.then(u)}}}catch(t){l(t);return Promise.reject()}u();return Promise.resolve()};O.prototype.isContextTable=function(){return this.getControlContext()==="responsiveTable"||this.getControlContext()==="table"};O.prototype.isFormContextType=function(){var t=this.getControlContext(),e=i.smartfield.ControlContextType;return t===e.Form||t===e.SmartFormGrid};O.prototype.isTableContextType=function(){var t=this.getControlContext(),e=i.smartfield.ControlContextType;return t===e.Table||t===e.ResponsiveTable};O.prototype.getInnerControls=function(){var t=this.getContent();return this._getInnerControls(t)};O.prototype._getInnerControls=function(t){var e,i={"sap.m.HBox":function(t){var e,i,r=0;i=t.getItems();if(i){r=i.length}if(r===0){return[]}if(r===1){return[i[0]]}e=i[1].getContent();if(e){return[i[0],e]}return[i[0]]},"sap.ui.comp.navpopover.SmartLink":function(t){var e=t.getAggregation("innerControl");if(e){return[e]}return[t]}};if(t){e=i[t.getMetadata()._sClassName]}if(e){return e(t)}if(t){return[t]}return[]};O.prototype.getAllInnerControls=function(){var t=[],e=this._oControl;if(e){for(var i in e){if(e.hasOwnProperty(i)){var r=e[i];if(r&&r instanceof Object){t.push(r)}}}}return t};O.prototype._getEmbeddedSmartField=function(){var t=this.getContent();return this._getEmbeddedSmartFieldInstace(t)};O.prototype._getEmbeddedSmartFieldByMode=function(t){var e=t==="edit"?this._oControl.edit:this._oControl.display;return this._getEmbeddedSmartFieldInstace(e)};O.prototype._getEmbeddedSmartFieldInstace=function(t){if(t){if(t.isA("sap.m.HBox")){var e=t.getItems();if(e){for(var i=0;i<e.length;i++){if(e[i].isA("sap.ui.comp.smartfield.SmartField")){return e[i]}}}}}return null};O.prototype.onAfterRendering=function t(){p.prototype.onAfterRendering.bind(this,arguments);this._applyPlaceHolder();this._applyAttributes()};O.prototype.onBeforeRendering=function t(){var e;if(!this._hasDefaultModel()||this._bInDestroy){return Promise.resolve()}e=this._processState().then(this.accessibilityAttributesHandler.bind(this)).then(p.prototype.onBeforeRendering.bind(this,arguments)).catch(function(t){m.error(t)});return e};O.prototype._calculateCurrentState=function(){var t,e,i,r=this.getClientSideMandatoryCheck(),o=this._getControlDescriptionPath(this._oControl.edit),n=this._getControlDescriptionPath(this._oControl.display),a=this.getEditable(),s=this.getContextEditable(),l=this.isFormContextType(),u=this.getMode(),d=this.getEnabled(),p=this.getVisible(),h=this.getBinding("value"),f=h&&this._oState.isValuePropertyChanged(h.getValue()),c=this._oState.isValueBindingPathChanged(this.getBindingPath("value")),g=this._oState.isModelChanged(this.getModel()),y=this._oState.isBindingContextChanged(this.getBindingContext()),_=this._oState.isEntitySetChanged(this._getEntitySet(undefined,true)),m=this._oState.isModeChanged(u),C=this._oState.isEditableChanged(a),b=this._oState.isVisibleChanged(p),v=this._oState.isContextEditableChanged(s),V=this._oState.isTextInEditModeSourceChanged(this.getTextInEditModeSource()),S=this._isDescriptionBindingPathDefault(),I=this._getComputedTextInEditModeSource()===F.ValueListNoValidation&&f,E=m&&o!==n,P=c||g||_||V,M=P;if(P){this._oState._resetProperty("EDIT");this._oState._resetProperty("DISPLAY")}t=this._oState.isModeInitialized(u);e=y||!t;i=I||!t||S||f||E;return{mode:u,rebind:i,enabled:d,visible:p,visibleChanged:b,editable:a,editableChanged:C,contextEditable:s,contextEditableChanged:v,forceTextArrangementFetch:e,clientSideMandatoryCheck:r,isFormContextType:l,isFactoryJustCreated:M,destroyFactory:P,bindingContextChanged:y}};O.prototype._processState=function(){var t,e,i,r,o=this._calculateCurrentState();e={mode:o.mode,rebind:o.rebind};i={mode:o.mode,contextEditable:o.contextEditable,editable:o.editable,enabled:o.enabled,visible:o.visible};r={editable:o.editable,editableChanged:o.editableChanged,isFormContextType:o.isFormContextType,contextEditable:o.contextEditable,contextEditableChanged:o.contextEditableChanged,forceTextArrangementFetch:o.forceTextArrangementFetch,clientSideMandatoryCheck:o.clientSideMandatoryCheck,mode:o.mode,visible:o.visible,visibleChanged:o.visibleChanged};if(this.isContextTable()&&(o.editableChanged||o.contextEditableChanged)&&(o.editable&&o.contextEditable)){var n=this._oControl&&this._oControl.edit;if(n){(n.isA("sap.m.HBox")?n.getItems():[n]).forEach(function(t){if(t.getValueState&&(t.getValueState()===P.Error||t.getValueState()===P.Warning)){t.setValueState(P.None)}})}}if(this._oFactory!==null&&o.destroyFactory){this._calculatePlaceHolder();this._destroyFactory()}if(o.bindingContextChanged){this._bSideEffects=false}this._init();if(this._oFactory===null){return Promise.resolve()}else{this._deletePlaceHolder()}t=this._oFactory.bind(e).then(function t(e){if(e&&e.skipInit||this._oFactory===null){return Promise.reject()}r.fetchIDAndDescription=e&&e.fetchIDAndDescription||false;if(o.isFactoryJustCreated&&this._oFactory.isA("sap.ui.comp.smartfield.ODataControlFactory")){this._oFactory.triggerCreationOfControls()}this._toggleInnerControlIfRequired(i);this._onInnerControlToggled(r);if(o.isFactoryJustCreated&&this._oFactory.isA("sap.ui.comp.smartfield.ODataControlFactory")){this._fireInitialise()}}.bind(this));return t};O.prototype._fireInitialise=function(){var t=this._getEmbeddedSmartField();if(t&&t.isA("sap.ui.comp.smartfield.SmartField")){t.attachInitialise(this.fireInitialise.bind(this))}else{this.fireInitialise()}};O.prototype._calculatePlaceHolder=function(){var t=this.getFirstInnerControl(),e=t&&t.getDomRef()||null;this._iInnerControlHeight=e&&e.offsetHeight||null};O.prototype._deletePlaceHolder=function(){this._iInnerControlHeight=null};O.prototype._applyPlaceHolder=function(){var t=this.getDomRef();if(t){if(this._iInnerControlHeight){t.style.minHeight=this._iInnerControlHeight+"px"}else{t.style.minHeight=""}}};O.prototype._applyAttributes=function(){var t=this.getFirstInnerControl()?this.getFirstInnerControl().getDomRef("inner"):null;if(t&&this.isInEditMode()&&(this._isPhone()||this._isTablet())&&this._oFactory&&this._oFactory._oMetaData){if(this._oFactory._oMetaData._isNumber){t.setAttribute("inputmode","decimal");t.setAttribute("pattern","[0-9]+([.,][0-9]+)?")}}};O.prototype._isPhone=function(){return I.system.phone?true:false};O.prototype._isTablet=function(){return I.system.tablet&&!I.system.desktop?true:false};O.prototype.accessibilityAttributesHandler=function(){var t=this._getEmbeddedSmartField();if(this.isContextTable()){this._handleAriaLabelledByInSmartTable(t)}else if(t){this._handleUoMAriaLabelledBy(t)}};O.prototype.getFirstInnerControl=function(){var t=this.getInnerControls();if(t.length){return t[0]||null}return null};O.prototype._checkFieldGroups=function(t){var e,i,r=t.mode;if(this.getBindingContext()&&this._oFactory&&this._oFactory.getMetaData&&r==="edit"&&!this._bSideEffects){i=this._calculateFieldGroupMetaData();e=this._getView();if(e&&i){this._setFieldGroup(i,e)}}};O.prototype._calculateFieldGroupMetaData=function(){var t=this._oFactory.getMetaData();if(t&&(!t.property||t.property&&!t.property.property)){return}return t};O.prototype._setFieldGroup=function(t,e){var i,r=this._oSideEffects.getFieldGroupIDs(t,e);if(r){i=this.getFirstInnerControl();if(i){this._bSideEffects=true;i.setFieldGroupIds(r)}}};O.prototype._getView=function(){var t=this.getParent();while(t){if(t.isA("sap.ui.core.mvc.View")){return t}t=t.getParent()}return null};O.prototype._getUomControl=function(){var t=this.getAllInnerControls();if(this.getUomEnabled()&&t&&t.length===1){var e=t[0].getItems?t[0].getItems():[];for(var i=0;i<e.length;i++){if(e[i].isA("sap.ui.comp.smartfield.SmartField")){return e[i]}}}return null};O.prototype.refreshDataState=function(t,e){var i,r,o,n;if(t==="value"){o=e&&e.getChanges();n=o&&o.value;if(n&&n.value!==n.oldValue){this._oLastValidated=null}w.apply(this,arguments);if(e.isLaundering()){if(this.getEditable()){i=this.getBindingContext();if(i&&i.getObject){r=i.getObject();if(r&&r.__metadata&&r.__metadata.created){this._checkCreated=true;return}}}}if(this._checkCreated&&!e.isLaundering()&&!e.isDirty()){if(this._oFactory){this._oFactory.rebindOnCreated()}this._checkCreated=false}}};O.prototype.onValidation=function(t){var e,i=t.getParameters(),r=i.newValue!==i.oldValue,o=this.data("configdata")&&this.data("configdata").configdata,n=o&&o.smartFieldRootControl?o.smartFieldRootControl:this,a=n._getEmbeddedSmartField(),s=a&&a.getFirstInnerControl(),l=s&&s.getId(),u=n.getModel(),d=t.getSource().getId(),p=i.mParameters,h=p&&p.originSource&&p.originSource.getId(),f=this._oLastValidated!==null&&this._oLastValidated.sourceId===d&&this._oLastValidated.sNewValue===i.newValue,c=p&&p.suppressChangeModelValue||f||false,g=l&&l!==d,_=l&&l===d,m=l&&h&&l!==h,C=l&&h&&l===h;if(h&&h!==d||c||u.getDefaultBindingMode()!==y.TwoWay){return}this._oLastValidated={sourceId:d,sNewValue:i.newValue};if(m||g){e={valueChanged:r,valueLastValueState:n.getValueState(),unitChanged:false,unitLastValueState:a.getValueState()}}else if(C||_){e={valueChanged:false,valueLastValueState:n.getValueState(),unitChanged:r,unitLastValueState:a.getValueState()}}else{e={valueChanged:r,valueLastValueState:n.getValueState()}}n.fireChangeModelValue(e)};O.prototype.exit=function(){this._bInDestroy=true;var t=null;if(this._oSideEffects){this._oSideEffects.destroy()}if(this._oUtil){this._oUtil.destroy()}if(this._oFactory){this._oFactory.destroy()}var e=this._oControl;if(e){if(e.current==="edit"){t=e["display"]}else{t=e["edit"]}if(e[e.current]&&!e[e.current].getParent()){e[e.current].destroy()}}if(t&&typeof t.destroy==="function"){t.destroy()}this._oObserver.unobserve(this,this._oObserverConfiguration);this._oUtil=null;this._oError=null;this._oValue=null;this._oFactory=null;this._oControl=null;this._oSideEffects=null;this._oState=null;this._sAnnotationLabel="";this._oLastValidated=null;this._oObserver=null};O.getSupportedAnnotationPaths=function(t,e,i,r){var o,n,a=[],s;if(t&&e&&i){s={entitySet:e,entityType:t.getODataEntityType(e.entityType),path:i};o={helper:new l(null,null,t)};if(r){o.navigationPathOnly=r}o.helper.getProperty(s);O._getFromEntitySet(a,s,o);O._getFromProperty(a,s,o);n=o.helper.getUnitOfMeasure2(s);if(n){O._getFromProperty(a,n,o)}o.helper.destroy()}return a};O._getFromEntitySet=function(t,e,i){var r;if(e.entitySet){r=i.helper.oAnnotation.getUpdateEntitySetPath(e.entitySet);O._push(r,t,e,i)}};O._push=function(t,e,i,r){var o,n,a,s,l={};if(t){if(r.navigationPathOnly){o=t.split("/");a=o.length;l.entityType=i.entityType;while(a--){n=o.shift();if(n===""){continue}l=r.helper.getNavigationProperty(l.entityType,n);if(!l.entitySet){break}if(s){s=s+"/"+n}else{s=n}}}else{s=t}}if(s){if(i.navigationPath){e.push(i.navigationPath+"/"+s)}else{e.push(s)}}};O._getFromProperty=function(t,e,i){var r;if(e.property.property){r=i.helper.oAnnotation.getText(e.property.property);O._push(r,t,e,i);r=i.helper.oAnnotation.getUnit(e.property.property);O._push(r,t,e,i);r=i.helper.oAnnotation.getFieldControlPath(e.property.property);O._push(r,t,e,i)}};O.prototype.addAssociation=function(t,e,i){if(t==="ariaLabelledBy"&&e){this.getInnerControls().forEach(function(t){if(t.addAriaLabelledBy){t.addAriaLabelledBy(e)}})}else if(t==="ariaDescribedBy"&&e){this.getInnerControls().forEach(function(t){if(t.addAriaDescribedBy){t.addAriaDescribedBy(e)}})}return p.prototype.addAssociation.apply(this,arguments)};O.prototype.removeAssociation=function(t,e,i){var r=p.prototype.removeAssociation.apply(this,arguments);if(t==="ariaLabelledBy"&&r){this.getInnerControls().forEach(function(t){if(t.removeAriaLabelledBy){t.removeAriaLabelledBy(r)}})}else if(t==="ariaDescribedBy"&&r){this.getInnerControls().forEach(function(t){if(t.removeAriaDescribedBy){t.removeAriaDescribedBy(r)}})}return r};O.prototype.getAccessibilityInfo=function(){var t=this.getContent();return t&&t.getAccessibilityInfo?t.getAccessibilityInfo():null};O.prototype.enhanceAccessibilityState=function(t,e){var i=this.getParent();if(i&&i.enhanceAccessibilityState){i.enhanceAccessibilityState(t,e)}};O.prototype._handleAriaLabelledByInSmartTable=function(t){var e,i=this;if(this.getAriaLabelledBy().length>0){this.getInnerControls().forEach(function(r){if(r.addAriaLabelledBy&&r.getAriaLabelledBy){e=r.getAriaLabelledBy().indexOf(i.getAriaLabelledBy()[0])>-1;if(!e){r.addAriaLabelledBy(i.getAriaLabelledBy()[0])}if(t){i._handleUoMAriaLabelledBy(t)}}})}};O.prototype._handleUoMAriaLabelledBy=function(t){var e,i=t.getEditable(),r=t.getEnabled(),o=t.getId(),n=o.includes("text")?o:o+"-text",a=o.includes("sfEdit")?o:o+"-sfEdit";this.getInnerControls().forEach(function(t){if(t.addAriaLabelledBy&&t.getAriaLabelledBy){e=t.getAriaLabelledBy();if(!i&&!(e.indexOf(n)>-1)){t.addAriaLabelledBy(n)}else if(!r&&!(e.indexOf(a)>-1)){t.addAriaLabelledBy(a)}}})};O.prototype._isValueInitial=function(){var t,e=this.getBinding("value"),i=e&&e.getDataState();if(!i||this._bValueNotInitial){t=false}else if(this._isValueInValidation()){t=this._getValueInValidation()===i.getOriginalValue()}else{t=i.getValue()===i.getOriginalValue()}return t};O.prototype._setValueInValidation=function(t){this._vValueInValidation=t};O.prototype._getValueInValidation=function(){return this._vValueInValidation};O.prototype._isValueInValidation=function(){return this._vValueInValidation!==undefined};O.prototype.getRequired=function(){if(this.getContextEditable()&&this.getEditable()){return this.getMandatory()}else{return false}};O.prototype.getBindingMode=function(t){var e=this.getBindingInfo(t);return e?e.parts[0].mode:undefined};O.prototype._innerControlHasNoValue=function(){var t,e,i,r,o,a,s,l,u=this.getInnerControls(),d=false;for(t=0;t<u.length;t++){o=u[t];a=o.getMetadata().getName();if(a==="sap.m.ObjectStatus"&&!(o.getText().trim()||o.getIcon().trim()||o.getTitle().trim())){d=true;break}else{l=n.getBoundPropertiesMapInfoForControl(a,{propertyName:"value"});if(!Array.isArray(l)){return false}i=0;for(e=0;e<l.length;e++){r=undefined;s=l[e];r=o.getProperty(s);if(r===""||r===null){i+=1}}if(i===l.length){d=true;break}}}return d};O.prototype._getHistoryEnabled=function(){return this.getHistoryEnabled()};O.prototype.getFormValueProperty=function(){return"value"};O.prototype.getFormFormattedValue=function(){var t,e=this._forceInitialise();if(e instanceof Promise){return e.then(function(){return this.getInnerControls().map(function(e){if(e.isA("sap.m.Text")){t=e.getText();if(!t&&e.getEmptyIndicatorMode()===L.On){t="-"}return t}}).join("")}.bind(this))}};O.prototype._hasSemanticObject=function(){var t,e=null,i=this.getControlFactory();if(i){t=i._oSelector}if(t){e=t.getCreator({mode:"display"})}return e==="_createEdmSemantic"};O.prototype.getDataSourceLabel=function(){return this._sAnnotationLabel};O.prototype._isAsync=function(){var t=this._getComputedTextInEditModeSource(),e=i.smartfield.TextInEditModeSource,r;if(t===e.ValueList){return true}else if(t===e.NavigationProperty){return true}else if(t===e.ValueListNoValidation){r=this.getControlFactory()._getDisplayBehaviourConfiguration("defaultInputFieldDisplayBehaviour");return r==="descriptionOnly"}return false};O.prototype._getTextArrangementRead=function(){if(!this._oTextArrangementRead){this._oTextArrangementRead=new S}return this._oTextArrangementRead};O.prototype._hasDefaultModel=function(){var t=this.getModel();return t!==undefined};O.prototype._isBoundToDefaultModel=function(){var t=this._hasDefaultModel(),e=this._getEntitySet(undefined,true);return t&&e};O.prototype._isDescriptionBindingPathDefault=function(){var t=this.getFirstInnerControl(),e=t&&t.getBinding("value"),i=e&&e.isA("sap.ui.model.CompositeBinding")&&e.getBindings()[1]&&e.getBindings()[1].getPath()==="__$$SmartFieldNotExistingBindingPath"||false;return i};O.prototype._getControlDescriptionPath=function(t){var e=t&&t.getBindingInfo("value"),i=e&&Array.isArray(e.parts)&&e.parts[1]&&e.parts[1].path;return i};O.prototype._initState=function(){var t=Object.create({_setProperty:function(t,e){if(this.mProperties===undefined||this.mProperties===null){this.mProperties={}}if(this.mProperties[t]===undefined){this.mProperties[t]={}}this.mProperties[t].previous=this.mProperties[t].current;this.mProperties[t].current=e},_getProperty:function(t){return this.mProperties&&this.mProperties[t]&&this.mProperties[t].current},_resetProperty:function(t){if(this.mProperties[t]!==undefined){this.mProperties[t]={}}},_resetProperties:function(){if(this.mProperties){this.mProperties={}}},isModeInitialized:function(t){var e=t==="edit"?"EDIT":"DISPLAY",i=this._getProperty(e);if(!i){this._setProperty(e,true)}return i},isModeChanged:function(t){var e="MODE",i=this._getProperty(e)!==t;if(i){this._setProperty(e,t)}return i},isValuePropertyChanged:function(t){var e="VALUE_PROPERTY_VALUE",i=this._getProperty(e)!==t;if(i){this._setProperty(e,t)}return i},isModelChanged:function(t){var e="MODEL_ID",i=t&&t.getId(),r=this._getProperty(e)!==i;if(r){this._setProperty(e,i)}return r},isValueBindingPathChanged:function(t){var e="VALUE_PROPERTY_BINDING_PATH",i=typeof t!=="undefined"&&this._getProperty(e)!==t;if(i){this._setProperty(e,t)}return i},isEntitySetChanged:function(t){var e="ENTITY_SET",i=this._getProperty(e)!==t;if(i){this._setProperty(e,t)}return i},isBindingContextChanged:function(t){var e="BINDING_CONTEXT_PATH",i=t&&t.getPath(),r=typeof i!=="undefined"&&this._getProperty(e)!==i;if(r){this._setProperty(e,i)}return r},isEditableChanged:function(t){var e="EDITABLE",i=this._getProperty(e)!==t;if(i){this._setProperty(e,t)}return i},isContextEditableChanged:function(t){var e="CONTEXT_EDITABLE",i=this._getProperty(e)!==t;if(i){this._setProperty(e,t)}return i},isVisibleChanged:function(t){var e="VISIBLE",i=this._getProperty(e)!==t;if(i){this._setProperty(e,t)}return i},isTextInEditModeSourceChanged:function(t){var e="TEXT_IN_EDIT_SOURCE_MODE",i=this._getProperty(e)!==t;if(i){this._setProperty(e,t)}return i}});t._setProperty("TEXT_IN_EDIT_SOURCE_MODE",F.None);return t};O.prototype.readODataLabel=function(){return new Promise(function(t,e){var i=this.getModel(),r=this.data("configdata"),o,n=i&&i.getMetaModel(),a,s;if(this._sAnnotationLabel){t(this._sAnnotationLabel);return}if(!i&&!r){e();return}a=new l(i,this._oUtil,n);if(r&&r.configdata){this._sAnnotationLabel=a.oAnnotation.getLabel(a.getEdmProperty(r.configdata));t(this._sAnnotationLabel);return}o=this.getBindingPath("value");s=this._getEntitySet();if(o&&s){n.loaded().then(function(){var e=a.oMeta.getODataEntitySet(s),i={entitySet:e,entityType:a.oMeta.getODataEntityType(e.entityType),path:o};a.getProperty(i);this._sAnnotationLabel=a.oAnnotation.getLabel(a.getEdmProperty(i));t(this._sAnnotationLabel)}.bind(this))}else{e()}}.bind(this))};O.prototype._setEmptyIndicator=function(t){if(t&&t.getEmptyIndicatorMode&&t.getEmptyIndicatorMode()!==L.On){t.setEmptyIndicatorMode(L.On)}};O.prototype._getEditableForNotExpandedNavigation=function(){return false};O.prototype._getComputedMetadata=function(){return this._initialStateApplied.promise.then(function(){return this._oFactory.isA("sap.ui.comp.smartfield.ODataControlFactory")&&this._oFactory.getMetaData()}.bind(this))};O.prototype._calculateFieldGroupIDs=function(t){return this._oSideEffects.getFieldGroupIDs(t,this._getView())};O.prototype._setInternalFieldGroupIds=function(t){this.setProperty("_internalFieldGroupIds",t)};O.prototype._isFixedValueList=function(){var t=this._oFactory.getMetaData();if(t&&t.annotations&&t.annotations.valuelistType==="fixed-values"){return true}return false};return O},true);
/*!
 * SAPUI5
 * (c) Copyright 2009-2023 SAP SE. All rights reserved.
 */
sap.ui.predefine("sap/ui/comp/smartfield/SmartLabel", ["sap/ui/core/Control","sap/m/Label","sap/ui/comp/library","./BindingUtil","./AnnotationHelper","./SmartField","sap/base/strings/capitalize"],function(t,e,i,a,n,s,r){"use strict";var l=e.extend("sap.ui.comp.smartfield.SmartLabel",{metadata:{designtime:"sap/ui/comp/designtime/smartfield/SmartLabel.designtime",interfaces:["sap.ui.core.Label","sap.ui.core.IShrinkable","sap.m.IOverflowToolbarContent","sap.m.IHyphenation"],library:"sap.ui.comp"},renderer:{apiVersion:2}});l.prototype.init=function(){this._sSmartFieldId=null;this._bMetaDataApplied=false;this._fInnerControlsCreatedHandlers=null};l.prototype._bindProperties=function(){var t=this._getField();if(t){var e=new a;var i=null;if(!this.isBound("visible")){this.setVisible(t.getVisible())}if(!this._bTextSetExplicitly){i=t.getBindingInfo("textLabel");if(i){this.bindProperty("text",e.toBinding(i))}else if(!this.getBindingInfo("text")){this._setText(t.getComputedTextLabel())}}i=t.getBindingInfo("tooltipLabel");if(i){this.bindProperty("tooltip",e.toBinding(i))}else{this.setTooltip(t.getTooltipLabel())}}};l.prototype.onFieldVisibilityChange=function(t){if(!this.isBound("visible")){this.setVisible(t.getSource().getVisible())}};l.prototype.getLabelInfo=function(){var t,e;var i=this._getField();if(i){this._bindProperties();t=i.getDataProperty();if(t){e=this._getLabelInfo(t);if(e){if(e.text&&!this._bTextSetExplicitly){this._setProperty(this,"text",e.text)}if(e.quickinfo){this._setProperty(this,"tooltip",e.quickinfo)}}}}};l.prototype._setProperty=function(t,e,i){if(t&&e){if(i.match(/{@i18n>.+}/gi)){t.bindProperty(e,i.slice(1,-1))}else{var a=r(e);if(!t.getBindingInfo(e)&&!t["get"+a]()){t["set"+a](i)}}}};l.prototype.setLabelFor=function(t){var i=this._getField();var a="";if(t){if(typeof t==="string"){a=t}else if(t.getId){a=t.getId()}}if(a.length>0&&a===this._sSmartFieldId){return this}if(i){if(this._fChange){i.detachEvent("_change",this._fChange);this._fChange=null}if(this._fInitialized){i.detachInitialise(this._fInitialized);this._fInitialized=null}this.detachFieldVisibilityChange(i);this._bMetaDataApplied=false}if(a.length>0){this._sSmartFieldId=a;this._setLabelFor()}else{this._sSmartFieldId=null}e.prototype.setLabelFor.apply(this,arguments);var n=sap.ui.getCore().byId(this.getLabelFor());this.detachFieldVisibilityChange(n);this.attachFieldVisibilityChange(n);return this};l.prototype._getField=function(){if(this._sSmartFieldId){return sap.ui.getCore().byId(this._sSmartFieldId)}return null};l.prototype._setLabelFor=function(){var t,e=this._getField();if(e&&!this._bMetaDataApplied){this._bMetaDataApplied=true;if(e.getDataProperty){t=e.getDataProperty();if(t){this.getLabelInfo()}else{if(!this._fInitialized){this._fInitialized=this.getLabelInfo.bind(this);e.attachInitialise(this._fInitialized)}if(!this._fChange){this._fChange=function(t){if(t.getParameter("name")==="textLabel"){this.getLabelInfo()}else if(t.getParameter("name")==="mandatory"){this.invalidate()}}.bind(this);e.attachEvent("_change",this._fChange)}}this._lateUpdateLabelFor(e)}}};l.prototype.updateLabelFor=function(t){var i=t.slice(0);if(i&&i.length>0){this.invalidate();e.prototype.setLabelFor.call(this,i.shift());this.updateAriaLabeledBy(i)}};l.prototype.updateAriaLabeledBy=function(t){if(t){for(var e=0;e<t.length;e++){var i=t[e];if(typeof i.addAriaLabelledBy==="function"){i.removeAriaLabelledBy(this);i.addAriaLabelledBy(this)}}}};l.prototype.setText=function(t){this.setProperty("text",t);this._bTextSetExplicitly=true;return this};l.prototype._setText=function(t){this.setProperty("text",t)};l.prototype._getLabelInfo=function(t){var e=new n;if(t&&t.property){return{text:e.getLabel(t.property),quickinfo:e.getQuickInfo(t.property)}}};l.prototype._delayUpdateLabelFor=function(t){var e=this;if(t.attachInnerControlsCreated&&!this._fInnerControlsCreatedHandlers){this._fInnerControlsCreatedHandlers=function(t){e.updateLabelFor(t.getParameters())};t.attachInnerControlsCreated(this._fInnerControlsCreatedHandlers)}};l.prototype._lateUpdateLabelFor=function(t){var e;if(t&&t instanceof s){e=t.getInnerControls();if(e&&e.length>0){this.updateLabelFor(e)}else{this._delayUpdateLabelFor(t)}var i=sap.ui.getCore().byId(this.getLabelFor());this.detachFieldVisibilityChange(i);this.attachFieldVisibilityChange(i)}};l.prototype.onBeforeRendering=function(){if(this._sSmartFieldId){var t=this._getField();if(!this._bMetaDataApplied){this._setLabelFor();if(t&&t.getId()===this.getLabelFor()){this._lateUpdateLabelFor(t)}}}};l.prototype.attachFieldVisibilityChange=function(t){if(t&&typeof t.attachVisibleChanged==="function"){t.attachVisibleChanged(this.onFieldVisibilityChange,this)}};l.prototype.detachFieldVisibilityChange=function(t){if(t&&typeof t.detachVisibleChanged==="function"){t.detachVisibleChanged(this.onFieldVisibilityChange,this)}};l.prototype.destroy=function(t){var i=this._getField();delete this._bTextSetExplicitly;if(i){if(this._fInnerControlsCreatedHandlers&&i.detachInnerControlsCreated){i.detachInnerControlsCreated(this._fInnerControlsCreatedHandlers);this._fInnerControlsCreatedHandlers=null}if(this._fInitialized&&i.detachInitialise){i.detachInitialise(this._fInitialized);this._fInitialized=null}if(this._fChange){i.detachEvent("_change",this._fChange);this._fChange=null}}this._sSmartFieldId=null;return e.prototype.destroy.apply(this,arguments)};l.prototype.exit=function(){e.prototype.exit.apply(this,arguments);this.detachFieldVisibilityChange(sap.ui.getCore().byId(this.getLabelFor()))};return l});
/*!
 * SAPUI5
 * (c) Copyright 2009-2023 SAP SE. All rights reserved.
 */
sap.ui.predefine("sap/ui/comp/smartfield/TextArrangementDelegate", ["sap/ui/comp/library","sap/ui/core/library","sap/ui/core/Core","sap/ui/base/Object","sap/ui/model/Filter","sap/ui/model/FilterOperator","sap/base/assert","sap/base/util/deepEqual"],function(t,e,i,r,a,o,n,s){"use strict";var l=t.smartfield.TextInEditModeSource;var d=r.extend("sap.ui.comp.smartfield.TextArrangementDelegate",{constructor:function(t){r.apply(this,arguments);this.oFactory=t;this.oSmartField=t._oParent;this.bValidMetadata=false;this.sBindingContextPath="";this.sAbsolutePathToVLProperty="";this._mOneTimeDescriptionCache=new Map;this._sTextArrangementLastReadValue=null;this._mTextArrangementLastReadAdditionalFilters=null}});d.prototype.setValue=function(t,e){var i=this.oSmartField,r=i._oControl;if(this.bValidMetadata&&t!==e&&r){var a=r[r.current],o=a&&a.getBinding("value");if(!o){return}var n=i.isPropertyBeingUpdatedByModel("value");switch(i._getComputedTextInEditModeSource()){case l.NavigationProperty:var s=!!i.getModel().getData(o.getBindings()[1].getPath(),i.getBindingContext(),true);if(n&&!s||!n){a.setValue(t)}return;case l.ValueList:case l.ValueListNoValidation:if(!n){a.setValue(t)}else if(this._sTextArrangementLastReadValue!==t){this.fetchIDAndDescriptionCollectionIfRequired()}return}}};d.getPaths=function(t,e){var i=e.property&&e.property.valueListAnnotation;switch(t){case l.NavigationProperty:var r=e.annotations.text;if(!r){return{}}return{keyField:r.entityType.key.propertyRef[0].name,descriptionField:r.property.typePath,entitySetName:r.entitySet.name};case l.ValueList:if(!i){return{}}return{keyField:i.keyField,descriptionField:i.descriptionField,entitySetName:e.property.valueListEntitySet&&e.property.valueListEntitySet.name};case l.ValueListNoValidation:if(!i){return{}}return{valueListNoValidation:true,keyField:i.keyField,descriptionField:i.descriptionField,entitySetName:e.property.valueListEntitySet.name}}};d.prototype.getBindingInfo=function(t){var e,i=t&&t.type,r=t.valueListNoValidation,a={},o=this.oSmartField,n=this.oFactory,s=n._oMetaData;if(!i||!i.isA("sap.ui.comp.smartfield.type.TextArrangement")&&!i.isA("sap.ui.comp.smartfield.type.TextArrangementString")){var u=o.getBindingInfo("value");i=u&&u.type||{};var p=d.getPaths(n._bTextInDisplayModeValueList?l.ValueList:o._getComputedTextInEditModeSource(),s);i=n._oTypes.getType(s.property,Object.assign(a,i.oFormatOptions),i.oConstraints,{composite:true,keyField:p.keyField,descriptionField:p.descriptionField,valueListNoValidation:r,valueList:o._getComputedTextInEditModeSource()===l.ValueList,delegate:this})}var c=this.oSmartField.getBinding("value").getValue(),y=o._getComputedTextInEditModeSource(),h=d.getPaths(this.oFactory._bTextInDisplayModeValueList?l.ValueList:y,s);var f=this.getTextAnnotationPropertyPath({entitySet:{name:h.entitySetName},entityID:c});if(f===""||f.indexOf("undefined")!==-1){f="__$$SmartFieldNotExistingBindingPath"}e={model:s.model,type:i,parts:[{path:s.path},{path:f}]};return e};d.prototype.getTextAnnotationPropertyPath=function(t){t=t||{};var e=t.textInEditModeSource||this.oSmartField._getComputedTextInEditModeSource(),i=this.oFactory,r=i._oMetaData,a=r.annotations&&r.annotations.text,o=t.textAnnotation||a;if(i._bTextInDisplayModeValueList){e=l.ValueList}switch(e){case l.NavigationProperty:return i._oHelper.getTextAnnotationPropertyPath(o);case l.ValueList:case l.ValueListNoValidation:var n=t.edmValueListKeyProperty||r.property.valueListKeyProperty,s=t.bindingContextPath||this.sBindingContextPath;if(o&&s!=="/undefined"&&this.oSmartField._isValueInitial()){var d=i._oHelper.getTextAnnotationPropertyPath(o);if(d&&d!==this.oFactory.getMetaData().path){return d}}return i._oHelper.getAbsolutePropertyPathToValueListEntity({property:n,bindingContextPath:s,entitySet:t.entitySet,entityID:t.entityID});case l.None:return"";default:return""}};d.prototype.checkRequiredMetadata=function(t,e){var i=this.oFactory,r=i._oMetaData,a=r.property,o=a.property,n=a.valueListKeyProperty,s=this.oSmartField.getTextInEditModeSource(),d=s===l.ValueList||s===l.ValueListWarning,u=o&&o["com.sap.vocabularies.Common.v1.Text"]||n&&n["com.sap.vocabularies.Common.v1.Text"];if(!u&&!d){return false}switch(t){case l.None:return false;case l.NavigationProperty:var p=r.annotations.text,c;if(p){c=p.entityType}var y={propertyName:r.property&&r.property.property&&r.property.property.name,entityType:r.entityType,entityTypeOfNavigationProperty:c,textAnnotation:r.property&&r.property.property&&r.property.property["com.sap.vocabularies.Common.v1.Text"]};if(e){return i._oHelper.checkNavigationPropertyRequiredMetadataNoAsserts(y)}else{return i._oHelper.checkNavigationPropertyRequiredMetadata(y)}case l.ValueList:case l.ValueListNoValidation:var h={propertyName:r.property&&r.property.property&&r.property.property.name,entityType:r.entityType,valueListAnnotation:r.property&&r.property.valueListAnnotation};if(e){return i._oHelper.checkValueListRequiredMetadataForTextArrangmentNoAsserts(h)}else{return i._oHelper.checkValueListRequiredMetadataForTextArrangment(h)}default:return false}};d.prototype.onBeforeValidateValue=function(t,e){var i=this.oSmartField;if(!i.getBindingContext()){return}var r=this.onFetchIDAndDescriptionCollectionSuccess.bind(this,{success:e.success});var a=this.onFetchIDAndDescriptionCollectionError.bind(this,{error:e.error});var o={value:t,success:r,error:a,filterFields:e.filterFields,updateBusyIndicator:true,bCheckValuesValidity:e.bCheckValuesValidity};return this.fetchIDAndDescriptionCollection(o)};d.prototype.fetchIDAndDescriptionCollectionIfRequired=function(t){var e,i,r=this.oSmartField,a=t.mode,o=t.forceTextArrangementFetch,n=r._getInnerControlPropertyBinding(a),d=n&&n.getType(),u=d&&d.isA("sap.ui.comp.smartfield.type.TextArrangement")||false,p=r._getComputedTextInEditModeSource(),c=this.oFactory,y=p===l.ValueList,h=r._isValueInitial();if(c){e=c.getMetaData();i=c._getLocalTextAnnotation()}if(i&&(e&&i.path===e.path||this.sBindingContextPath==="/undefined"||!h)){i=null}if(i&&h&&!r._isValueInValidation()){return}if(y||!i&&p===l.ValueListNoValidation&&this.oFactory._getDisplayBehaviourConfiguration()!=="idOnly"||this.oFactory._bTextInDisplayModeValueList){var f="value",g=r.getModel(),F=r.getBindingContext(),m=r.getBinding(f).getPath(),v=g&&F&&m&&g.getProperty(m,F),V=v===undefined||v===null;var P=this.getAdditionalFiltersData(r,r.getControlFactory().getMetaData(),{});var D=this._mTextArrangementLastReadAdditionalFilters&&!s(this._mTextArrangementLastReadAdditionalFilters,P);if(!V&&(D||this._sTextArrangementLastReadValue!==v||!u||o)){var L=["keyField"];var x={value:v,oldValue:v,initialRendering:true,mode:a};return this.fetchIDAndDescriptionCollection({value:v,filterFields:L,updateBusyIndicator:false,success:this.onFetchIDAndDescriptionCollectionSuccess.bind(this,x)})}}};d.prototype.fetchIDAndDescriptionCollection=function(t){var e=t.value,i=this.oSmartField;if(t.bCheckValuesValidity){t.filterFields=["keyField"]}var r=i._oControl&&i._oControl.edit;if(r&&t.updateBusyIndicator){r.setBusyIndicatorDelay(300);r.setBusy(true)}i._setValueInValidation(e);return this.readODataModel(t).then(function(){i._bValueNotInitial=true}).finally(function(){if(r&&t.updateBusyIndicator){r.setBusyIndicatorDelay(0);r.setBusy(false)}i._setValueInValidation(undefined)})};d.prototype.readODataModel=function(t){var e=this.oSmartField,i,r,a,o,n,s=e._getComputedTextInEditModeSource(),u=e.getControlFactory().getMetaData(),p=d.getPaths(this.oFactory._bTextInDisplayModeValueList?l.ValueList:s,u),c="/"+p.entitySetName,y=u&&u.annotations&&u.annotations.valueListData||null,h=p.keyField,f=p.descriptionField,g=this.oFactory&&this.oFactory.getValueListProvider(),F=y&&y.valueListEntitySetName===p.entitySetName,m=F&&y&&y.outParams?Object.values(y.outParams):[],v=F&&y&&y.fields?y.fields:[],V={success:t.success,error:t.error};if(!f&&(this.oSmartField.getMode()==="display"||!e._isValueListValidationMode())){return Promise.resolve()}this._sTextArrangementLastReadValue=t.value;try{i=this.getAbsolutePathToVLProperty();if(i){r=this.getSelectedEntity(i);if(r){this.clearAbsolutePathToVLProperty();t.success(r);return Promise.resolve()}}}catch(t){return Promise.reject(t)}n=this.getDataForNextDescriptionRequest(t.value);if(n&&n.hasOwnProperty(f)&&g&&g._shouldHaveHistory&&!g._shouldHaveHistory()){t.success(n);return Promise.resolve()}o=this.getAdditionalFiltersData(e,u,n);var P={keyFieldPath:h,aFilterFields:t.filterFields};if(f){P.descriptionFieldPath=f}for(a in o){t.filterFields.push(a)}P.additionalFilters=o;var D=this.getFilters(t.value,P);if(D.length===0){return Promise.resolve()}var L=this.getUrlParameters({keyField:h,descriptionField:f,outParams:m,allFields:v});V.filters=D;V.urlParameters=L;this._mTextArrangementLastReadAdditionalFilters=o;return e._getTextArrangementRead().read(e.getModel(),c,V).then(t.success).catch(t.error)};d.prototype.getSelectedEntity=function(t){return t!==""&&this.oSmartField.getBindingContext().getProperty(t)};d.prototype.clearAbsolutePathToVLProperty=function(){this.sAbsolutePathToVLProperty=""};d.prototype.setAbsolutePathToVLProperty=function(t){this.sAbsolutePathToVLProperty=t};d.prototype.getAbsolutePathToVLProperty=function(){return this.sAbsolutePathToVLProperty};d.prototype.getAdditionalFiltersData=function(t,e,i){var r,a,o,n,s,l={};if(typeof i==="undefined"){i={}}if(e&&e.annotations&&e.annotations.valueListData){a=e.annotations.valueListData.inParams;r=e.annotations.valueListData.constParams}if(r){for(o in r){l[o]=r[o]}}if(a){for(n in a){s=a[n];if(s!==e.annotations.valueListData.keyField){l[s]=i[s]!==undefined?i[s]:t.getBindingContext().getProperty(n)}}}return l};d.prototype._setBindingPath=function(t,e,i,r,a){var o=t.getModel(),s;n(Array.isArray(e)," - "+this.getMetadata().getName());if(o){this.invalidateDescription(i,r,false);if(Array.isArray(e)&&e.length===1){s=o.getKey(e[0])}if(a&&e.length!==1){this.sBindingContextPath="/"+s;this.bindPropertyForValueList(i,r,true)}else if(typeof s==="string"){this.sBindingContextPath="/"+s;this.bindPropertyForValueList(i,r,false,a)}else if(e.length!==1&&i==="text"){this.sBindingContextPath=undefined;this.bindPropertyForValueList(i,r,false)}else if(e.length!==1){this.invalidateDescription(i,r,true)}}};d.prototype.invalidateDescription=function(t,e,i){var r,a=e&&e.getBinding(t),o,n=a&&a.getType();if(!n){o=e&&e.getBindingInfo(t);n=o&&o.type}if(n&&n.isA("sap.ui.comp.smartfield.type.TextArrangement")){r=n.getDescriptionIsInvalid();if(r!==i){n.setDescriptionIsInvalid(i);if(a){a.refresh(true)}}}};d.prototype.onFetchIDAndDescriptionCollectionSuccess=function(t,e,i){var r,a=true,o,n,s,d,u,p,c,y=this.oSmartField;if(!y){return}n=t.mode||y.getMode();r=e&&Array.isArray(e.results)&&e.results.length===1?e.results[0]:null;o=y.getControlFactory()&&y.getControlFactory().getValueListProvider()||null;s=y._oControl.edit;d=y._oControl.display;u=e&&e.results===undefined?[e]:e.results;c=y._getComputedTextInEditModeSource();if(r&&o){o._calculateAndSetODataModelOutputData(r);if(n==="edit"&&!t.initialRendering&&c!==l.NavigationProperty){o._oHistoryValuesProvider&&o._oHistoryValuesProvider.setFieldData([r])}}if(!t.initialRendering){y.oValidation.handleValueListWarning(u)}if(typeof t.success==="function"){a=t.success(u)}if(!a&&c!==l.ValueListNoValidation){return}if(d){this._setBindingPath(y,u,"text",d)}if(s&&y.isTextInEditModeSourceNotNone("edit")){p=c===l.ValueListNoValidation;this._setBindingPath(y,u,"value",s,p)}};d.prototype.onFetchIDAndDescriptionCollectionError=function(t,e){if(typeof t.error==="function"){t.error(e)}};d.prototype.bindPropertyForValueList=function(t,e,i,r){var a=this.oSmartField,o={},n,s,d,u=a._getComputedTextInEditModeSource();if(u===l.ValueList||u===l.ValueListNoValidation||this.oFactory._bTextInDisplayModeValueList){s=e&&e.getBindingInfo(t);if(this.oFactory&&s){d=s.type;if((!d||!d.isA("sap.ui.comp.smartfield.type.TextArrangement"))&&this.oFactory._getTextArrangementType){n=this.oFactory._getTextArrangementType();if(n){d=n}}if(d){o={type:d}}o.skipValidation=i;o.bValueListNoValidation=r;e.bindProperty(t,this.getBindingInfo(o))}}};d.prototype.getUrlParameters=function(t){var e=[t.keyField];if(t.descriptionField){e.push(t.descriptionField)}t.outParams.forEach(function(t){if(e.indexOf(t)===-1){e.push(t)}});if(this.oSmartField._getComputedTextInEditModeSource()!==l.NavigationProperty){e=t.allFields.map(function(t){return t.name})}return{$select:e.join(","),$top:2}};d.prototype.getFilters=function(t,e){this.destroyFilters();var i=e.aFilterFields,r;if(Array.isArray(i)&&i.length===1){switch(i[0]){case"keyField":this.oIDFilter=u(t,e);return[this.oIDFilter];case"descriptionField":this.oDescriptionFilter=p(t,e);return[this.oDescriptionFilter]}}this.oIDFilter=u(t,e);r=this._getAdditionalFilters(e);this.oFilters=new a({and:true,filters:[new a({and:false,filters:[this.oIDFilter]})]});if(r.aFilters.length>0){this.oFilters.aFilters.push(r)}return[this.oFilters]};d.prototype.setDataForNextDescriptionRequest=function(t,e){this._mOneTimeDescriptionCache.set(t,e)};d.prototype.getDataForNextDescriptionRequest=function(t){var e=this._mOneTimeDescriptionCache.get(t);this._mOneTimeDescriptionCache.delete(t);return e};function u(t,e){return new a({value1:t,path:e.keyFieldPath,operator:o.EQ})}function p(t,e){return new a({value1:t,path:e.descriptionFieldPath,operator:o.Contains})}d.prototype._getAdditionalFilters=function(t){var e=[],i=this.oSmartField.getControlFactory().getMetaData(),r=i.annotations&&i.annotations.valueListData,o=r&&r.fields;Object.keys(t.additionalFilters).forEach(function(i){var a=t.additionalFilters[i],n=o.find(function(t){return t.name===i}),s=r.aInitialValueIsSignificantFields.indexOf(i)!==-1,l=this._generateFiltersForField(a,i,n,s);if(l){e.push(l)}}.bind(this));return new a({and:true,filters:e})};d.prototype._generateFiltersForField=function(t,e,i,r){if(t===null||t===undefined||t===""){if(r){return this._generateFiltersForEmptyField(e,i&&i.nullable==="false")}}else{return new a({value1:t,path:e,operator:o.EQ})}};d.prototype._generateFiltersForEmptyField=function(t,e){if(e){return new a({value1:"",path:t,operator:o.EQ})}return new a([new a({value1:"",path:t,operator:o.EQ}),new a({value1:null,path:t,operator:o.EQ})],false)};d.prototype.destroyFilters=function(){if(this.oIDFilter){this.oIDFilter.destroy();this.oIDFilter=null}if(this.oDescriptionFilter){this.oDescriptionFilter.destroy();this.oDescriptionFilter=null}if(this.oFilters){this.oFilters.destroy();this.oFilters=null}};d.prototype.destroy=function(){this.oSmartField=null;this.bValidMetadata=false;this.sBindingContextPath="";this.sAbsolutePathToVLProperty="";this._mOneTimeDescriptionCache=null;this._mTextArrangementLastReadAdditionalFilters=null;this.destroyFilters()};return d});
/*
 * SAPUI5
 * (c) Copyright 2009-2023 SAP SE. All rights reserved.
 */
sap.ui.predefine("sap/ui/comp/smartfield/TextArrangementRead", ["sap/ui/thirdparty/URI"],function(e){"use strict";var t;var r=function(){if(!t){t=this;this.mRequests=new Map;this._iMaxRequests=1e3;if(window.location.search.indexOf("data-sap-ui-xx-disableTextArrangementReadCache=true")!==-1){this.read=function(e,t,r){return this._createReadPromise({model:e,path:t,settings:r})}.bind(this)}}return t};r.prototype.read=function(e,t,r){var s,i={model:e,path:t,settings:r};try{s=this._calculateCacheKey(i)}catch(e){return this._createReadPromise(i)}return this._getPromise(s,i)};r.prototype._getPromise=function(e,t){var r,s;if(this.mRequests.has(e)){r=this.mRequests.get(e);s=this._validateCache(e,r,t);if(s===true){return r.promise}if(s instanceof Promise){return s}}return this._createReadPromise(t,e)};r.prototype._setPromise=function(e,t,r){var s;this.mRequests.set(e,{modelId:r.model.getId(),promise:t});if(this.mRequests.size>this._iMaxRequests){s=this.mRequests.getKeys().next().value;if(s){this.mRequests.delete(s)}}};r.prototype._validateCache=function(e,t,r){if(r&&r.model){if(t.modelId===r.model.getId()){return true}return new Promise(function(s){t.promise.then(function(i){if(i&&Array.isArray(i.results)&&this._probeLocalModelForLoadedData(r,i)){s(t.promise)}else{s(this._createReadPromise(r,e))}}.bind(this))}.bind(this))}return true};r.prototype._probeLocalModelForLoadedData=function(e,t){var r=e.model.getKey(t.results[0]);if(r){return!!e.model.getProperty("/"+r)}return false};r.prototype.exit=function(){this.mRequests.clear()};r.prototype.clearCache=function(){this.mRequests.clear()};r.prototype._createReadPromise=function(e,t){var r=new Promise(function(t,r){e.settings.success=t;e.settings.error=r;e.model.read(e.path,e.settings)}).then(function(e){var r=e&&Array.isArray(e.results)&&e.results.length===1;if(t&&!r){this.mRequests.delete(t)}return e}.bind(this));if(t){this._setPromise(t,r,e)}return r};r.prototype._calculateCacheKey=function(t){var r,s=t.model.sServiceUrl,i=t.model.aUrlParams;if(!s){throw"Can't access service URL. Opt out of value list caching."}s=new e(s).absoluteTo(document.baseURI).pathname().toString();r={path:t.path,service:s,filters:this._flattenFilters(t.settings.filters)};if(Array.isArray(i)&&i.length){r["urlParams"]=i}return JSON.stringify(r)};r.prototype._flattenFilters=function(e){var t=[],r=function(e){if(e.sPath){t.push({p:e.sPath,v:e.oValue1})}if(Array.isArray(e.aFilters)){e.aFilters.forEach(r)}};r(e[0]);return t};return r},false);
/*!
 * SAPUI5
 * (c) Copyright 2009-2023 SAP SE. All rights reserved.
 */
sap.ui.predefine("sap/ui/comp/smartfield/UoMValidateException", ["sap/ui/model/ValidateException"],function(t){"use strict";var e=function(e,i){t.apply(this,arguments)};e.prototype=Object.create(t.prototype);return e});
/*
 * SAPUI5
 * (c) Copyright 2009-2023 SAP SE. All rights reserved.
 */
sap.ui.predefine("sap/ui/comp/smartfield/ValidationUtil",["sap/ui/core/Core","sap/ui/core/library","sap/ui/comp/library","sap/ui/core/message/Message","sap/ui/core/message/ControlMessageProcessor","sap/ui/model/ValidateException"],function(e,t,s,i,o,r){"use strict";var a=s.smartfield.TextInEditModeSource;var n=function(t){this.oSmartField=t;this.oRB=e.getLibraryResourceBundle("sap.ui.comp")};n.prototype._getPropertyName=function(e){if(e.isA("sap.ui.comp.smartfield.ComboBox")){return"enteredValue"}else if(e.isA("sap.m.ComboBox")){return"selectedKey"}else{return"value"}};n.prototype._createMessage=function(t,s,o){var r=this._getPropertyName(s),a;this._removeMessage();a=new i({message:this.oRB.getText(t),type:o,target:s.getId()+"/"+r,processor:this._getMessageProcessor()});this._oCurrentMessage=a;e.getMessageManager().addMessages(a)};n.prototype._removeMessage=function(){if(this._oCurrentMessage){e.getMessageManager().removeMessages(this._oCurrentMessage);this._oCurrentMessage.destroy();this._oCurrentMessage=null}};n.prototype.handleValueListWarning=function(e){var s=this.oSmartField._oControl.edit;if(s&&this.oSmartField._isValueListWarning()){if(e.length===0){this._createMessage("SMARTFIELD_NOT_FOUND",s,t.MessageType.Warning)}else if(e.length>1){this._createMessage("SMARTFIELD_DUPLICATE_VALUES",s,t.MessageType.Warning)}else{this._removeMessage()}}};n.prototype._getMessageProcessor=function(){var t;if(this._oMessageProcessor){return this._oMessageProcessor}t=new o;e.getMessageManager().registerMessageProcessor(t);this._oMessageProcessor=t;return this._oMessageProcessor};n.prototype.handleComboValidation=function(e){if(!this._isComboBoxValidationWarning()){return}if(e.getEnteredValue()&&!e.getSelectedKey()&&e.getValue()!==""){this._createMessage("SMARTFIELD_NOT_FOUND",e,t.MessageType.Warning)}else{this._removeMessage()}};n.prototype.addValidationToType=function(e){var t;if(!e||!this._isComboBoxValidationStrict()){return}t=e.validateValue;e.validateValue=function(e){var s=this.oSmartField._oControl.edit;if(!s.getSelectedItem()&&s.getValue()){throw new r(this.oRB.getText("SMARTFIELD_NOT_FOUND"))}return t.apply(this,arguments)}.bind(this)};n.prototype._isLegacyMode=function(){var e=this.oSmartField;return e._isFixedValueList()&&e.getFixedValueListValidationEnabled()};n.prototype._isComboBoxValidationStrict=function(){if(this._isLegacyMode()){return false}return this.oSmartField._getComputedTextInEditModeSource()===a.ValueList};n.prototype._isComboBoxValidationWarning=function(){if(this._isLegacyMode()){return false}return this.oSmartField._isValueListWarning()};return n},true);
/*!
 * SAPUI5
 * (c) Copyright 2009-2023 SAP SE. All rights reserved.
 */
sap.ui.predefine("sap/ui/comp/smartfield/ValueListDelegate", ["sap/ui/base/Object","sap/base/util/deepEqual"],function(t,i){"use strict";var e=t.extend("sap.ui.comp.smartfield.ValueListDelegate",{constructor:function(i){t.apply(this,arguments);this.oValueListProvider=i}});e.prototype.fetchIDAndDescriptionCollectionIfRequired=function(){if(!this.oValueListProvider.bInitialised){return}this.oValueListProvider._calculateFilterInputData();if(!i(this.oValueListProvider._mLastFilterInputData,this.oValueListProvider.mFilterInputData)){this.oValueListProvider.oControl.setBusy(true);this.oValueListProvider._fetchData();this.oValueListProvider._mLastFilterInputData=this.oValueListProvider.mFilterInputData}};e.prototype.destroy=function(){this.oValueListProvider=null};return e});
/*!
 * SAPUI5
 * (c) Copyright 2009-2023 SAP SE. All rights reserved.
 */
sap.ui.predefine("sap/ui/comp/smartfield/flexibility/ODataV2Delegate", ["sap/ui/model/ListBinding"],function(e){"use strict";var t=true;function n(e){if(e&&e.type){if(e.type.toLowerCase().indexOf("edm")!==0){return true}}return false}function r(e,t){if(!e){return false}var n=e.getBindingInfo(t);var r=n&&n.path;if(!r){return false}return r.indexOf("/")===0}function a(e,t,n){var r;if(t){r=e.getBindingInfo(n);if(typeof r.model==="string"&&r.model!==""){r=undefined}}else{r=e.getBindingContext()}return r}function i(t,n,r,a){var i={name:t.name,bindingPath:t.name,entityType:n.name};var o=t["com.sap.vocabularies.Common.v1.Label"];i.label=o&&o.String;var u=t["com.sap.vocabularies.Common.v1.QuickInfo"];i.tooltip=u&&u.String;var f=t["com.sap.vocabularies.UI.v1.Hidden"];i.hideFromReveal=!!f&&f.Bool==="true";var l;if(!i.hideFromReveal){l=t["com.sap.vocabularies.Common.v1.FieldControl"];if(l&&l.EnumMember){i.hideFromReveal=l.EnumMember==="com.sap.vocabularies.Common.v1.FieldControlType/Hidden"}else{var m=l&&l.Path;if(m){var p=r.getBinding(a)instanceof e;if(!p){var d=r.getBindingContext().getProperty(m);i.hideFromReveal=d===0}}}}return i}function o(e,t,r,a){var o=e.property.map(function(e){return e["sap:field-control"]}).filter(Boolean);var u=function(e){return!o.includes(e.name)};var f=e.property.map(function(o){var f=i(o,e,r,a);if(n(o)){var l=t.getODataComplexType(o.type);if(l){f.properties=l.property.map(function(t){var n=i(t,e,r,a);n.bindingPath=o.name+"/"+t.name;n.referencedComplexPropertyName=f.label||f.name;return n}).filter(u)}}return f});if(e.navigationProperty){var l=e.navigationProperty.map(function(n){var r=t.getODataAssociationEnd(e,n.name)&&t.getODataAssociationEnd(e,n.name).type;return{name:n.name,entityType:r,bindingPath:n.name,unsupported:true}});f=f.concat(l)}return f.filter(u)}function u(e,t,n){if(n.path){return n.path}var i=r(e,t);var o=a(e,i,t);if(o){return i?o.path:o.getPath()}}function f(e,t){return Promise.resolve().then(function(){var n=e.getModel(t.modelName);if(n){var r=n.getMetadata().getName();if(r==="sap.ui.model.odata.ODataModel"||r==="sap.ui.model.odata.v2.ODataModel"){var a=n.getMetaModel();return a.loaded().then(function(){return a})}}})}function l(e,t){var n=e.getMetaContext(t);return n.getObject()}function m(e,t,n){var r=e.getMetadata().getAggregation();if(r){var a=e.getBindingInfo(r.name);var i=a&&a.template;if(i){var o=e.getBindingPath(r.name);var u=t.getODataAssociationEnd(n,o);var f=u&&u.type;if(f){var l=t.getODataEntityType(f);n=l}}}return n}function p(e,t,n){return f(e,n).then(function(r){var a=[];if(r){var i=u(e,t,n);if(i){var f=l(r,i);f=m(e,r,f);a=o(f,r,e,t)}}return a})}function d(e){return e.modifier.createControl("sap.ui.comp.smartfield.SmartLabel",e.appComponent,e.view,e.labelFor+"-label",{labelFor:e.labelFor},t)}function v(e){return e.modifier.createControl("sap.ui.comp.smartfield.SmartField",e.appComponent,e.view,e.fieldSelector,{value:"{"+e.bindingPath+"}"},t)}var c={};c.getPropertyInfo=function(e){return p(e.element,e.aggregationName,e.payload)};c.createLabel=function(e){return d(e)};c.createControlForProperty=function(e){return v(e).then(function(e){return{control:e,valueHelp:undefined}})};return c});
/*!
 * SAPUI5
 * (c) Copyright 2009-2023 SAP SE. All rights reserved.
 */
sap.ui.predefine("sap/ui/comp/smartfield/flexibility/SmartField.flexibility", ["sap/ui/fl/apply/api/DelegateMediatorAPI"],function(e){"use strict";e.registerDefaultDelegate({modelType:"sap.ui.model.odata.v2.ODataModel",delegate:"sap/ui/comp/smartfield/flexibility/ODataV2Delegate",requiredLibraries:{"sap.ui.comp":{minVersion:"1.81",lazy:false}}});e.registerDefaultDelegate({modelType:"sap.ui.model.odata.ODataModel",delegate:"sap/ui/comp/smartfield/flexibility/ODataV2Delegate",requiredLibraries:{"sap.ui.comp":{minVersion:"1.81",lazy:false}}});return{}},true);
/*
 * SAPUI5
 * (c) Copyright 2009-2023 SAP SE. All rights reserved.
 */
sap.ui.predefine("sap/ui/comp/smartfield/type/AbapBool", ["sap/ui/model/FormatException","sap/ui/model/ParseException","sap/ui/model/SimpleType"],function(o,e,t){"use strict";var n=t.extend("sap.ui.comp.smartfield.type.AbapBool",{constructor:function(){t.apply(this,arguments);this.sName="sap.ui.comp.smartfield.type.AbapBool"}});n.prototype.formatValue=function(e,t){if(e===undefined||e===null){return null}switch(t){case"boolean":case"any":return e==="X";default:throw new o("Don't know how to format Boolean to "+t)}};n.prototype.parseValue=function(o,t){switch(t){case"boolean":return o===true?"X":"";default:throw new e("Don't know how to parse Boolean from "+t)}};n.prototype.validateValue=function(o){if(o!==null&&o!==undefined){if(o!=="X"&&o!==""){throw new e("Invalid Boolean "+o)}}};return n});
/*
 * SAPUI5
 * (c) Copyright 2009-2023 SAP SE. All rights reserved.
 */
sap.ui.predefine("sap/ui/comp/smartfield/type/Byte", ["sap/ui/model/odata/type/Byte"],function(t){"use strict";var o=t.extend("sap.ui.comp.smartfield.type.Byte",{constructor:function(o,e){t.apply(this,arguments);this.oFieldControl=null}});o.prototype.parseValue=function(o,e){var p=t.prototype.parseValue.apply(this,arguments);if(typeof this.oFieldControl==="function"){this.oFieldControl(o,e)}return p};o.prototype.destroy=function(){t.prototype.destroy.apply(this,arguments);this.oFieldControl=null};o.prototype.getName=function(){return"sap.ui.comp.smartfield.type.Byte"};return o});
/*
 * SAPUI5
 * (c) Copyright 2009-2023 SAP SE. All rights reserved.
 */
sap.ui.predefine("sap/ui/comp/smartfield/type/Currency", ["sap/ui/core/Core","sap/ui/model/type/Currency","sap/ui/model/odata/type/Currency","sap/ui/model/ValidateException","sap/ui/comp/smartfield/UoMValidateException"],function(t,e,r,i,n){"use strict";var s=/^([-]?)(\d+)(?:\.(\d+))?$/;var o=r.extend("sap.ui.comp.smartfield.type.Currency",{constructor:function(t,e){r.apply(this,[t]);this.oConstraints=e;this.bParseWithValues=true;this.sName="Currency"}});o.prototype.parseValue=function(t,e,i){if(i[1]&&this.shouldConvertUnitToUpperCase(i[1])){arguments[2][1]=arguments[2][1].toUpperCase()}var n=r.prototype.parseValue.apply(this,arguments),s,o,u=Array.isArray(n)&&n[0]&&a(n[0]);if(Array.isArray(u)){s=u[1]+u[2];o=u[3];if(Number.parseInt(o)===0){n[0]=s}}if(n[1]===undefined){n[1]=i[1]}return n};o.prototype.validateValue=function(t){var e,r=t[0],s=t[1],o=r===null,h=0,m=this.oFormatOptions&&this.oFormatOptions.customCurrencies;if(s&&this.shouldConvertUnitToUpperCase(s)){s=s.toUpperCase()}if(this.oConstraints&&this.oConstraints.nullable&&(o||r===this.oFormatOptions.emptyString)){return}if(m&&s&&Object.keys(m).indexOf(s)===-1){throw new n(p("CURRENCY_VALIDATION_FAILS",[s]))}if(typeof r!=="string"||e===null){throw new i(u("EnterNumber"))}e=a(r);if(typeof r!=="string"||e===null){throw new i(u("EnterNumber"))}var c=parseInt(e[2]),l=c===0?0:e[2].length,f=(e[3]||"").length,C=this.oConstraints&&this.oConstraints.precision,y=typeof C==="number"?C:Infinity,d=s,U=this.oOutputFormat.oLocaleData.getCurrencyDigits(d),g=this.mCustomUnits&&this.mCustomUnits[d]&&this.mCustomUnits[d].decimals;if(g||g===0){U=g}if(this.oConstraints&&this.oConstraints.variableScale){h=Math.min(y,U)}else{h=Math.min(this.oConstraints&&this.oConstraints.scale||0,U)}if(h>y){h=y}if(f>h){if(h===0){throw new i(u("EnterInt"))}if(l+h>y){throw new i(u("EnterNumberIntegerFraction",[y-h,h]))}throw new i(u("EnterNumberFraction",[h]))}if(l>y-h){throw new i(u("EnterNumberInteger",[y-h]))}};function a(t){return s.exec(t)}function u(e,r){return t.getLibraryResourceBundle().getText(e,r)}function p(e,r){return t.getLibraryResourceBundle("sap.ui.comp").getText(e,r)}o.prototype.shouldConvertUnitToUpperCase=function(t){return this.mCustomUnits&&!this.mCustomUnits[t]&&this.mCustomUnits[t.toUpperCase()]};o.prototype.getName=function(){return"sap.ui.comp.smartfield.type.Currency"};return o});
/*
 * SAPUI5
 * (c) Copyright 2009-2023 SAP SE. All rights reserved.
 */
sap.ui.predefine("sap/ui/comp/smartfield/type/DateTime", ["sap/ui/model/odata/type/DateTime"],function(t){"use strict";var e=t.extend("sap.ui.comp.smartfield.type.DateTime",{constructor:function(e,o){t.apply(this,arguments);this.oFieldControl=null}});e.prototype.parseValue=function(e,o){var i=t.prototype.parseValue.apply(this,arguments);if(typeof this.oFieldControl==="function"){this.oFieldControl(e,o)}return i};e.prototype.destroy=function(){t.prototype.destroy.apply(this,arguments);this.oFieldControl=null};e.prototype.getName=function(){return"sap.ui.comp.smartfield.type.DateTime"};return e});
/*
 * SAPUI5
 * (c) Copyright 2009-2023 SAP SE. All rights reserved.
 */
sap.ui.predefine("sap/ui/comp/smartfield/type/DateTimeOffset", ["sap/ui/model/odata/type/DateTimeOffset"],function(t){"use strict";var e=t.extend("sap.ui.comp.smartfield.type.DateTimeOffset",{constructor:function(e,o){t.apply(this,arguments);this.oFieldControl=null}});e.prototype.parseValue=function(e,o){var i=t.prototype.parseValue.apply(this,arguments);if(typeof this.oFieldControl==="function"){this.oFieldControl(e,o)}return i};e.prototype.destroy=function(){t.prototype.destroy.apply(this,arguments);this.oFieldControl=null};e.prototype.getName=function(){return"sap.ui.comp.smartfield.type.DateTimeOffset"};return e});
/*
 * SAPUI5
 * (c) Copyright 2009-2023 SAP SE. All rights reserved.
 */
sap.ui.predefine("sap/ui/comp/smartfield/type/Decimal", ["sap/ui/model/odata/type/Decimal"],function(t){"use strict";var o=t.extend("sap.ui.comp.smartfield.type.Decimal",{constructor:function(o,e){t.apply(this,arguments);this.oFieldControl=null}});o.prototype.parseValue=function(o,e){var i=t.prototype.parseValue.apply(this,arguments);if(typeof this.oFieldControl==="function"){this.oFieldControl(o,e)}return i};o.prototype.destroy=function(){t.prototype.destroy.apply(this,arguments);this.oFieldControl=null};o.prototype.getName=function(){return"sap.ui.comp.smartfield.type.Decimal"};return o});
/*
 * SAPUI5
 * (c) Copyright 2009-2023 SAP SE. All rights reserved.
 */
sap.ui.predefine("sap/ui/comp/smartfield/type/Double", ["sap/ui/model/odata/type/Double"],function(t){"use strict";var o=t.extend("sap.ui.comp.smartfield.type.Double",{constructor:function(o,e){t.apply(this,arguments);this.oFieldControl=null}});o.prototype.parseValue=function(o,e){o=t.prototype.parseValue.apply(this,arguments);if(typeof this.oFieldControl==="function"){this.oFieldControl(o,e)}return o};o.prototype.destroy=function(){t.prototype.destroy.apply(this,arguments);this.oFieldControl=null};o.prototype.getName=function(){return"sap.ui.comp.smartfield.type.Double"};return o});
/*
 * SAPUI5
 * (c) Copyright 2009-2023 SAP SE. All rights reserved.
 */
sap.ui.predefine("sap/ui/comp/smartfield/type/Guid", ["sap/ui/model/odata/type/Guid","sap/ui/model/ValidateException"],function(t,e){"use strict";var i=/^[A-F0-9]{8}-([A-F0-9]{4}-){3}[A-F0-9]{12}$/i;function o(t){return sap.ui.getCore().getLibraryResourceBundle(t.resourceBundle).getText(t.text)}function n(t){throw new e(o(t))}var s=t.extend("sap.ui.comp.smartfield.type.Guid",{constructor:function(e,i,o){t.apply(this,arguments);this.oSettings=o;this.oFieldControl=null;this.oValidateExceptionSettings=this.oSettings&&this.oSettings.validateException||{resourceBundle:"",text:"EnterGuid"}}});s.prototype.parseValue=function(e,i){e=t.prototype.parseValue.apply(this,arguments);if(typeof this.oFieldControl==="function"){this.oFieldControl(e,i)}return e};s.prototype.validateValue=function(t){if(t===null){if(this.oConstraints&&this.oConstraints.nullable===false){n.call(this,this.oValidateExceptionSettings)}return}if(typeof t!=="string"){throw new e("Illegal "+this.getName()+" value: "+t)}if(!i.test(t)){n.call(this,this.oValidateExceptionSettings)}};s.prototype.destroy=function(){t.prototype.destroy.apply(this,arguments);this.oFieldControl=null};s.prototype.getName=function(){return"sap.ui.comp.smartfield.type.Guid"};return s});
/*
 * SAPUI5
 * (c) Copyright 2009-2023 SAP SE. All rights reserved.
 */
sap.ui.predefine("sap/ui/comp/smartfield/type/IanaTextArrangement", ["sap/ui/comp/smartfield/type/TextArrangementString","sap/ui/model/odata/type/DateTimeWithTimezone"],function(e,t){"use strict";var a=e.extend("sap.ui.comp.smartfield.type.IanaTextArrangement",{constructor:function(a){a=Object.assign({showDate:false,showTime:false},a);this.DateTimeWithTimezoneType=new t(a);return e.prototype.constructor.apply(this,arguments)}});a.prototype.formatValue=function(t,a){t[0]=this.DateTimeWithTimezoneType.formatValue([null,t[0]],a);return e.prototype.formatValue.call(this,t,a)};a.prototype.getName=function(){return"sap.ui.comp.smartfield.type.IanaTextArrangement"};return a});
/*
 * SAPUI5
 * (c) Copyright 2009-2023 SAP SE. All rights reserved.
 */
sap.ui.predefine("sap/ui/comp/smartfield/type/Int16", ["sap/ui/model/odata/type/Int16"],function(t){"use strict";var o=t.extend("sap.ui.comp.smartfield.type.Int16",{constructor:function(o,e){t.apply(this,arguments);this.oFieldControl=null}});o.prototype.parseValue=function(o,e){var p=t.prototype.parseValue.apply(this,arguments);if(typeof this.oFieldControl==="function"){this.oFieldControl(o,e)}return p};o.prototype.destroy=function(){t.prototype.destroy.apply(this,arguments);this.oFieldControl=null};o.prototype.getName=function(){return"sap.ui.comp.smartfield.type.Int16"};return o});
/*
 * SAPUI5
 * (c) Copyright 2009-2023 SAP SE. All rights reserved.
 */
sap.ui.predefine("sap/ui/comp/smartfield/type/Int32", ["sap/ui/model/odata/type/Int32"],function(t){"use strict";var o=t.extend("sap.ui.comp.smartfield.type.Int32",{constructor:function(o,e){t.apply(this,arguments);this.oFieldControl=null}});o.prototype.parseValue=function(o,e){var p=t.prototype.parseValue.apply(this,arguments);if(typeof this.oFieldControl==="function"){this.oFieldControl(o,e)}return p};o.prototype.destroy=function(){t.prototype.destroy.apply(this,arguments);this.oFieldControl=null};o.prototype.getName=function(){return"sap.ui.comp.smartfield.type.Int32"};return o});
/*
 * SAPUI5
 * (c) Copyright 2009-2023 SAP SE. All rights reserved.
 */
sap.ui.predefine("sap/ui/comp/smartfield/type/Int64", ["sap/ui/model/odata/type/Int64"],function(t){"use strict";var o=t.extend("sap.ui.comp.smartfield.type.Int64",{constructor:function(o,e){t.apply(this,arguments);this.oFieldControl=null}});o.prototype.parseValue=function(o,e){var p=t.prototype.parseValue.apply(this,arguments);if(typeof this.oFieldControl==="function"){this.oFieldControl(o,e)}return p};o.prototype.destroy=function(){t.prototype.destroy.apply(this,arguments);this.oFieldControl=null};o.prototype.getName=function(){return"sap.ui.comp.smartfield.type.Int64"};return o});
/*
 * SAPUI5
 * (c) Copyright 2009-2023 SAP SE. All rights reserved.
 */
sap.ui.predefine("sap/ui/comp/smartfield/type/SByte", ["sap/ui/model/odata/type/SByte"],function(t){"use strict";var o=t.extend("sap.ui.comp.smartfield.type.SByte",{constructor:function(o,e){t.apply(this,arguments);this.oFieldControl=null}});o.prototype.parseValue=function(o,e){var p=t.prototype.parseValue.apply(this,arguments);if(typeof this.oFieldControl==="function"){this.oFieldControl(o,e)}return p};o.prototype.destroy=function(){t.prototype.destroy.apply(this,arguments);this.oFieldControl=null};o.prototype.getName=function(){return"sap.ui.comp.smartfield.type.SByte"};return o});
/*
 * SAPUI5
 * (c) Copyright 2009-2023 SAP SE. All rights reserved.
 */
sap.ui.predefine("sap/ui/comp/smartfield/type/String", ["sap/ui/model/odata/type/String"],function(t){"use strict";var o=t.extend("sap.ui.comp.smartfield.type.String",{constructor:function(o,e){t.apply(this,arguments);this.oFormatOptions=o;this.oFieldControl=null}});o.prototype.parseValue=function(o,e){var i=t.prototype.parseValue.apply(this,arguments);if(this.oFormatOptions&&this.oFormatOptions.displayFormat==="UpperCase"&&i&&i.toUpperCase){i=i.toUpperCase()}if(typeof this.oFieldControl==="function"){this.oFieldControl(o,e)}return i};o.prototype.getName=function(){return"sap.ui.comp.smartfield.type.String"};return o});
/*
 * SAPUI5
 * (c) Copyright 2009-2023 SAP SE. All rights reserved.
 */
sap.ui.predefine("sap/ui/comp/smartfield/type/StringNullable", ["sap/ui/comp/smartfield/type/String"],function(t){"use strict";var e=t.extend("sap.ui.comp.smartfield.type.StringNullable",{constructor:function(e,r){e=Object.assign({parseKeepsEmptyString:true},e);t.call(this,e,r)}});e.prototype.formatValue=function(e,r){if(e===null&&this.getPrimitiveType(r)==="string"){return null}return t.prototype.formatValue.call(this,e,r)};e.prototype.getName=function(){return"sap.ui.comp.smartfield.type.StringNullable"};return e});
/*
 * SAPUI5
 * (c) Copyright 2009-2023 SAP SE. All rights reserved.
 */
sap.ui.predefine("sap/ui/comp/smartfield/type/TextArrangement", ["sap/ui/core/Core","sap/ui/model/CompositeType","sap/ui/comp/util/FormatUtil","sap/ui/model/ParseException","sap/ui/model/ValidateException","sap/base/util/isPlainObject","sap/base/assert"],function(t,e,i,r,n,s,a){"use strict";var o=e.extend("sap.ui.comp.smartfield.type.TextArrangement",{constructor:function(t,i,r){this.getPrimaryType().call(this,t,i);e.call(this,t,i);this.init(t,i,r);a(r.keyField!==undefined,"Missing value for the keyField. - "+this.getName())},metadata:{abstract:true}});o.prototype.init=function(t,e,i){this.sName="TextArrangement";this.bParseWithValues=true;this.async=true;var r={textArrangement:"idOnly"};var n={onBeforeValidateValue:function(){}};this.oSettings=Object.assign(n,i);this.oFormatOptions=Object.assign(r,t);this.fnParser=this.getValidator({textArrangement:this.oFormatOptions.textArrangement,prefix:"parse"});this.fnValidator=this.getValidator({textArrangement:this.oFormatOptions.textArrangement,prefix:"validate"});this.bValueListNoValidation=i.valueListNoValidation;this.bClientSideMandatoryCheck=this.oSettings.clientSideMandatoryCheck!==undefined?this.oSettings.clientSideMandatoryCheck:true;this.bIsInvalid=false;this._sSelectedValue=null};o.prototype.getSettings=function(){return this.oSettings};o.prototype.parseValue=function(t,e,i){var r,n=t===""&&!this._isValueSelected(t),s=this.oFormatOptions.textArrangement;if(n&&(this.bClientSideMandatoryCheck||!this.bClientSideMandatoryCheck&&this.oConstraints.nullable)){t=null}if(typeof t==="string"){t=t.replace(/\u0020+$/,"")}if(s==="idOnly"){r=this.parseIDOnly(t,e)}else{r=this.fnParser(t,e,i,this.oFormatOptions,this.oSettings)}if(r[0]&&r[0].toUpperCase&&this.oFormatOptions.displayFormat==="UpperCase"){r[0]=r[0].toUpperCase()}return r};o.prototype.parseIDOnly=function(t,e){t=this.getPrimaryType().prototype.parseValue.call(this,t,e);return[t,undefined]};o.prototype.setSelectedValue=function(t){this._sSelectedValue=t};o.prototype._isValueSelected=function(t){return this._sSelectedValue===t};o.prototype.parseIDAndDescription=function(t,e,i,r){var n;if(!this._isValueSelected(t)){if(r&&r.textArrangement==="idAndDescription"){n=/^([\S\s]+?)\s\([\S\s]+\)$/.exec(t)}else{n=/^[\S\s]+\s\(([\S\s]+?)\)$/.exec(t)}}this.setSelectedValue(null);if(Array.isArray(n)&&n[1]){t=n[1]}return this.parseIDOnly(t,e)};o.prototype.parseDescriptionOnly=function(t,e,i,r,s){return new Promise(function(i,r){var a=this.oConstraints&&this.oConstraints.maxLength?this.oConstraints.maxLength:0;if(t===null){return i([t,undefined])}if(t&&t.toUpperCase&&this.oFormatOptions.displayFormat==="UpperCase"){t=t.toUpperCase()}if(t&&a&&t.length>a){r(new n(this.getCoreResourceBundleText("EnterTextMaxLength",[a])));return}function o(a){var o,u=s.keyField,p=s.descriptionField;var d=l(t,{key:p,value:u,data:a});var h=d.length;if(h===1){o=this.getPrimaryType().prototype.parseValue.call(this,d[0],e);i([o,undefined]);return}if(h===0){d=l(t,{key:u,value:p,data:a});h=d.length}if(!this.bValueListNoValidation){if(h===0){r(new n(this.getResourceBundleText("SMARTFIELD_NOT_FOUND")));return}if(h>1){r(new n(this.getResourceBundleText("SMARTFIELD_DUPLICATE_VALUES")));return}}o=this.getPrimaryType().prototype.parseValue.call(this,t,e);i([o,undefined])}function u(t){r(new n(this.getResourceBundleText("SMARTFIELD_INVALID_ENTRY")))}var p={filterFields:this.getFilterFields(),success:o.bind(this),error:u.bind(this)};this.onBeforeValidateValue(t,p)}.bind(this))};o.prototype.validateValue=function(t,e){this.validateIDOnly(t);var i=t[0];if(i===null){return}if(this.oFormatOptions.textArrangement==="descriptionOnly"){this.validateDescriptionOnly(t,this.oSettings);return}if(this.oFormatOptions.textArrangement==="idOnly"&&this.bValueListNoValidation){return}var r=new Promise(function(r,s){function a(e){var n=Object.assign({},this.oSettings,{data:e,reject:s});if(i===""&&Array.isArray(e)&&e.length===0&&this.oConstraints.nullable===false&&!this.bClientSideMandatoryCheck){r(t);return true}var a=this.fnValidator(t,n);if(a){r(t)}return a}function o(t){s(new n(this.getResourceBundleText("SMARTFIELD_INVALID_ENTRY")))}var l={filterFields:this.getFilterFields(),success:a.bind(this),error:o.bind(this),bCheckValuesValidity:e};this.onBeforeValidateValue(i,l)}.bind(this));if(this.bValueListNoValidation){return}else{return r}};o.prototype.validateIDOnly=function(t,e){var i=t[0],r,s;this.getPrimaryType().prototype.validateValue.call(this,i);if(this.getSettings().valueList&&e){r=e.data;s=e.reject;if(r.length===0){s(new n(this.getResourceBundleText("SMARTFIELD_NOT_FOUND")));return false}if(r.length>1){s(new n(this.getResourceBundleText("SMARTFIELD_DUPLICATE_VALUES")));return false}}return true};o.prototype.validateIDAndDescription=function(t,e){var i={key:e.keyField,value:e.descriptionField,data:e.data};if(this.oFormatOptions&&this.oFormatOptions.displayFormat){i.displayFormat=this.oFormatOptions.displayFormat}var r=l(t[0],i,this.oConstraints);var s=e.reject;if(!this.bValueListNoValidation){if(r.length===0){s(new n(this.getResourceBundleText("SMARTFIELD_NOT_FOUND")));return false}if(r.length>1){s(new n(this.getResourceBundleText("SMARTFIELD_DUPLICATE_VALUES")));return false}}return true};o.prototype.validateDescriptionOnly=function(t,e){};o.prototype.formatValue=function(t,e){var r;if(!Array.isArray(t)){return t}if(this.bValueListNoValidation&&t[1]===undefined){t.splice(1,1)}r=this.getPrimaryType().prototype.formatValue.call(this,t[0],e);if(r===null){return r}if(r&&this.oFormatOptions.displayFormat==="UpperCase"){r=r.toUpperCase()}var n=t[1];if(n===""&&this.oFormatOptions.textArrangement!=="idOnly"&&this.oSettings.delegate){this.oSettings.delegate._sTextArrangementLastReadValue=null}if(!n&&this.oFormatOptions.textArrangement==="descriptionOnly"){return r}if(s(n)||this.bIsInvalid){n=""}return i.getFormattedExpressionFromDisplayBehaviour(this.oFormatOptions.textArrangement,r,n)};o.prototype.setDescriptionIsInvalid=function(t){this.bIsInvalid=t};o.prototype.getDescriptionIsInvalid=function(){return this.bIsInvalid};o.prototype.destroy=function(){this.oFormatOptions=null;this.oSettings=null;this.fnParser=null;this.fnValidator=null};o.prototype.getName=function(){return"sap.ui.comp.smartfield.type.TextArrangement"};o.prototype.onBeforeValidateValue=function(t,e){this.oSettings.onBeforeValidateValue(t,e)};o.prototype.getResourceBundleText=function(e,i){return t.getLibraryResourceBundle("sap.ui.comp").getText(e,i)};o.prototype.getCoreResourceBundleText=function(e,i){return t.getLibraryResourceBundle("sap.ui.core").getText(e,i)};o.prototype.getPrimaryType=function(){};o.prototype.getValidator=function(t){switch(t.textArrangement){case"idAndDescription":case"descriptionAndId":return this[t.prefix+"IDAndDescription"];case"descriptionOnly":return this[t.prefix+"DescriptionOnly"];default:return this[t.prefix+"IDOnly"]}};o.prototype.getFilterFields=function(t){return["keyField"]};function l(t,e,i){var r=[];if(e.displayFormat==="UpperCase"){t=t.toLowerCase()}e.data.forEach(function(n,s,a){var o=e.displayFormat==="UpperCase"?n[e.key].toLowerCase():n[e.key],l=i&&i.isDigitSequence&&i.maxLength&&t.lastIndexOf(o)!==-1;if(l||o===t){r.push(n[e.value])}});return r}return o});
/*
 * SAPUI5
 * (c) Copyright 2009-2023 SAP SE. All rights reserved.
 */
sap.ui.predefine("sap/ui/comp/smartfield/type/TextArrangementGuid", ["sap/ui/comp/smartfield/type/TextArrangement","sap/ui/comp/smartfield/type/Guid","sap/ui/model/ValidateException","sap/base/assert"],function(t,e,i,r){"use strict";var n=t.extend("sap.ui.comp.smartfield.type.TextArrangementGuid");n.prototype.init=function(){t.prototype.init.apply(this,arguments);if(this.oFormatOptions&&this.oFormatOptions.textArrangement==="descriptionOnly"){this.oValidateExceptionSettings={resourceBundle:"sap.ui.comp",text:"ENTER_AN_EXISTING_DESCRIPTION"}}else{this.oValidateExceptionSettings={resourceBundle:"",text:"EnterGuid"}}};n.prototype.parseDescriptionOnly=function(n,s,p,a,u){var l=e.prototype.parseValue.call(this,n,s);if(o(l)){return new Promise(function(t,e){function n(n){if(n.length===1){this.sDescription=n[0][u.descriptionField];t([l,undefined]);return}if(n.length===0){e(new i(this.getResourceBundleText("SMARTFIELD_NOT_FOUND")));return}r(false,"Duplicate GUID. - "+this.getName())}function o(t){e(new i(this.getResourceBundleText("SMARTFIELD_INVALID_ENTRY")))}var s={filterFields:this.getFilterFields(l),success:n.bind(this),error:o.bind(this)};this.onBeforeValidateValue(l,s)}.bind(this))}else{n=n.trim();return t.prototype.parseDescriptionOnly.call(this,n,s,p,a,u)}};n.prototype.getFilterFields=function(t){if(this.oFormatOptions.textArrangement==="descriptionOnly"){if(o(t)){return["keyField"]}return["descriptionField"]}return["keyField","descriptionField"]};n.prototype.getName=function(){return"sap.ui.comp.smartfield.type.TextArrangementGuid"};n.prototype.getPrimaryType=function(){return e};n.prototype.formatValue=function(e){var i=t.prototype.formatValue.apply(this,arguments);if(this.oFormatOptions.textArrangement==="descriptionOnly"&&i==="00000000-0000-0000-0000-000000000000"){i=""}return i};function o(t){var e=/^[A-F0-9]{8}-([A-F0-9]{4}-){3}[A-F0-9]{12}$/i;return e.test(t)}return n});
/*
 * SAPUI5
 * (c) Copyright 2009-2023 SAP SE. All rights reserved.
 */
sap.ui.predefine("sap/ui/comp/smartfield/type/TextArrangementString", ["sap/ui/comp/smartfield/type/TextArrangement","sap/ui/comp/smartfield/type/StringNullable","sap/ui/model/ValidateException"],function(t,e,r){"use strict";var i=t.extend("sap.ui.comp.smartfield.type.TextArrangementString");i.prototype.getName=function(){return"sap.ui.comp.smartfield.type.TextArrangementString"};i.prototype.validateValue=function(e){var i=this.oConstraints||{},n=i.maxLength,a=e[0];if(this.oFormatOptions.textArrangement==="descriptionOnly"&&(a&&a.length>n)){throw new r(sap.ui.getCore().getLibraryResourceBundle("sap.ui.comp").getText("ENTER_A_VALID_VALUE"))}else{return t.prototype.validateValue.apply(this,arguments)}};i.prototype.getPrimaryType=function(){return e};return i});
/*
 * SAPUI5
 * (c) Copyright 2009-2023 SAP SE. All rights reserved.
 */
sap.ui.predefine("sap/ui/comp/smartfield/type/Time", ["sap/ui/model/odata/type/Time"],function(t){"use strict";var o=t.extend("sap.ui.comp.smartfield.type.Time",{constructor:function(o,e){t.apply(this,arguments);this.oFieldControl=null}});o.prototype.parseValue=function(o,e){var i=t.prototype.parseValue.apply(this,arguments);if(typeof this.oFieldControl==="function"){this.oFieldControl(o,e)}return i};o.prototype.destroy=function(){t.prototype.destroy.apply(this,arguments);this.oFieldControl=null};o.prototype.getName=function(){return"sap.ui.comp.smartfield.type.Time"};return o});
/*
 * SAPUI5
 * (c) Copyright 2009-2023 SAP SE. All rights reserved.
 */
sap.ui.predefine("sap/ui/comp/smartfield/type/Unit", ["sap/ui/core/Core","sap/ui/model/odata/type/Unit","sap/ui/comp/smartfield/type/Decimal","sap/ui/comp/smartfield/type/Int16","sap/ui/comp/smartfield/type/Int32","sap/ui/comp/smartfield/type/Int64","sap/ui/comp/smartfield/type/Byte","sap/ui/comp/smartfield/type/SByte","sap/ui/comp/smartfield/type/Double","sap/ui/model/ValidateException","sap/ui/comp/smartfield/UoMValidateException"],function(t,i,e,s,n,a,o,r,p,u,m){"use strict";var l=/^([-]?)(\d+)(?:\.(\d+))?$/;var c=i.extend("sap.ui.comp.smartfield.type.Unit",{constructor:function(t,e){t.decimals=e.scale;i.apply(this,[t,{skipDecimalsValidation:e.skipDecimalsValidation}]);this.oConstraints=e;this.sName="Unit"}});c.prototype.parseValue=function(t,e,s){var n=i.prototype.parseValue.apply(this,arguments),a,o,r=Array.isArray(n)&&n[0]&&h(n[0]);if(Array.isArray(r)){a=r[1]+r[2];o=r[3];if(Number.parseInt(o)===0){n[0]=a}}if(n[1]===undefined&&s){n[1]=s[1]}if(n[1]&&this.shouldConvertUnitToUpperCase(n[1])){n[1]=n[1].toUpperCase()}return n};c.prototype.validateValue=function(t){var e,s=t[0],n=t[1],a=s===null,o=this.oFormatOptions&&this.oFormatOptions.customUnits;if(o&&n&&Object.keys(o).indexOf(n)===-1){throw new m(f("UNIT_VALIDATION_FAILS",[n]))}i.prototype.validateValue.apply(this,arguments);if(this.oConstraints.nullable&&(a||s===this.oFormatOptions.emptyString)){return}e=h(s);if(e===null){throw new u(d("EnterNumber"))}if(this.oConstraints&&!this.oConstraints.scale&&this.oConstraints.skipDecimalsValidation){return}y.call(this,this.oConstraints.type,s);var r=parseInt(e[2]),p,l=this.oConstraints&&this.oConstraints.scale,c=l,C=r===0?0:e[2].length,b=(e[3]||"").length,w=this.oConstraints&&this.oConstraints.precision,U=typeof w==="number"?w:Infinity,I=this.mCustomUnits&&this.mCustomUnits[n]&&this.mCustomUnits[n].decimals;if((I||I===0)&&!this.oConstraints.skipDecimalsValidation){c=I}if(this.oConstraints&&this.oConstraints.variableScale){p=Math.min(U,c);l=p}else{p=Math.min(l||0,c)}if(p>U){p=U}if(b>p){if(p===0){throw new u(d("EnterInt"))}if(C+p>U){throw new u(d("EnterNumberIntegerFraction",[U-p,p]))}throw new u(d("EnterNumberFraction",[p]))}if(C>U-l){throw new u(d("EnterNumberInteger",[U-l]))}};function h(t){return l.exec(t)}function d(i,e){return t.getLibraryResourceBundle().getText(i,e)}function f(i,e){return t.getLibraryResourceBundle("sap.ui.comp").getText(i,e)}function y(t,i){if(t){var u;switch(t){case"Edm.Double":u=new p({},this.oConstraints);break;case"Edm.Decimal":u=new e({},this.oConstraints);break;case"Edm.Int16":u=new s({},this.oConstraints);break;case"Edm.Int32":u=new n({},this.oConstraints);break;case"Edm.Int64":u=new a({},this.oConstraints);break;case"Edm.Byte":u=new o({},this.oConstraints);break;case"Edm.SByte":u=new r({},this.oConstraints);break}u.validateValue(i)}}c.prototype.shouldConvertUnitToUpperCase=function(t){return this.mCustomUnits&&!this.mCustomUnits[t]&&this.mCustomUnits[t.toUpperCase()]};c.prototype.getName=function(){return"sap.ui.comp.smartfield.type.Unit"};return c});
/*!
 * SAPUI5
 * (c) Copyright 2009-2023 SAP SE. All rights reserved.
 */
sap.ui.predefine("sap/ui/comp/smartfilterbar/AdditionalConfigurationHelper", ["sap/ui/comp/library"],function(t){"use strict";var e=function(t,e){this.controlConfiguration=[];this.groupConfiguration=[];this._initialize(t,e)};e.prototype._initialize=function(e,i){var n,o,a,r,l,g,u,p,s,f;if(!e){e=[]}if(!i){i=[]}o=e.length;for(n=0;n<o;n++){r=e[n];l={};l.key=r.getKey();l.groupId=r.getGroupId();l.index=r.getIndex();l.label=r.getLabel();l.isVisible=r.getVisible();l.mandatory=r.getMandatory();l.width=r.getWidth();l.hasValueHelpDialog=r.getHasValueHelpDialog();l.hasValidation=r.getHasValidation();l.hasTypeAhead=r.getHasTypeAhead();l.controlType=r.getControlType();l.filterType=r.getFilterType();l.customControl=r.getCustomControl();l.visibleInAdvancedArea=r.getVisibleInAdvancedArea();l.preventInitialDataFetchInValueHelpDialog=r.getPreventInitialDataFetchInValueHelpDialog();l.isSetPreventInitialDataFetchInValueHelpDialog=r.isPropertyInitial("preventInitialDataFetchInValueHelpDialog");l.displayBehaviour=r.getDisplayBehaviour();l.defaultFilterValues=[];l.conditionType=r.getConditionType();l.historyEnabled=r.getHistoryEnabled();l.historyEnabledInitial=r.isPropertyInitial("historyEnabled");l.conditionPanelDefaultOperation=!r.isPropertyInitial("conditionPanelDefaultOperation")&&t.valuehelpdialog.ValueHelpRangeOperation[r.getConditionPanelDefaultOperation()]?r.getConditionPanelDefaultOperation():null;l.timezone=r.getTimezone();g=r.getDefaultFilterValues();if(g&&g.length){s=g.length;for(p=0;p<s;p++){u=g[p];f={};f.sign=u.getSign();f.operator=u.getOperator();f.low=u.getLow();f.high=u.getHigh();l.defaultFilterValues.push(f)}}this.controlConfiguration.push(l)}o=i.length;for(n=0;n<o;n++){a=i[n];l={key:a.getKey(),index:a.getIndex(),label:a.getLabel()};this.groupConfiguration.push(l)}};e.prototype.getControlConfigurationByKey=function(t){var e,i;i=this.controlConfiguration.length;for(e=0;e<i;e++){if(this.controlConfiguration[e].key===t){return this.controlConfiguration[e]}}return undefined};e.prototype.getControlConfiguration=function(){return this.controlConfiguration};e.prototype.getGroupConfiguration=function(){return this.groupConfiguration};e.prototype.getGroupConfigurationByKey=function(t){var e,i;i=this.groupConfiguration.length;for(e=0;e<i;e++){if(this.groupConfiguration[e].key===t){return this.groupConfiguration[e]}}return undefined};return e},true);
/*!
 * SAPUI5
 * (c) Copyright 2009-2023 SAP SE. All rights reserved.
 */
sap.ui.predefine("sap/ui/comp/smartfilterbar/ControlConfiguration", ["sap/ui/comp/library","sap/ui/core/Element"],function(e,t){"use strict";var a=t.extend("sap.ui.comp.smartfilterbar.ControlConfiguration",{metadata:{library:"sap.ui.comp",properties:{key:{type:"string",group:"Misc",defaultValue:null},groupId:{type:"string",group:"Misc",defaultValue:null},label:{type:"string",group:"Misc",defaultValue:null},visible:{type:"boolean",group:"Misc",defaultValue:true},hasValueHelpDialog:{type:"boolean",group:"Misc",defaultValue:true},hasValidation:{type:"boolean",group:"Misc",defaultValue:true},controlType:{type:"sap.ui.comp.smartfilterbar.ControlType",group:"Misc",defaultValue:"auto"},filterType:{type:"sap.ui.comp.smartfilterbar.FilterType",group:"Misc",defaultValue:"auto"},index:{type:"int",group:"Misc",defaultValue:-1},hasTypeAhead:{type:"boolean",group:"Misc",defaultValue:true},mandatory:{type:"sap.ui.comp.smartfilterbar.MandatoryType",group:"Misc",defaultValue:"auto"},width:{type:"string",group:"Misc",defaultValue:null},visibleInAdvancedArea:{type:"boolean",group:"Misc",defaultValue:false},preventInitialDataFetchInValueHelpDialog:{type:"boolean",group:"Misc",defaultValue:false},displayBehaviour:{type:"sap.ui.comp.smartfilterbar.DisplayBehaviour",group:"Misc",defaultValue:"auto"},conditionType:{type:"any",group:"Misc",defaultValue:null},historyEnabled:{type:"boolean",group:"Misc",defaultValue:true},conditionPanelDefaultOperation:{type:"sap.ui.comp.valuehelpdialog.ValueHelpRangeOperation",group:"Misc",defaultValue:null},timezone:{type:"string",group:"Misc",defaultValue:null}},aggregations:{defaultFilterValues:{type:"sap.ui.comp.smartfilterbar.SelectOption",multiple:true,singularName:"defaultFilterValue"},customControl:{type:"sap.ui.core.Control",multiple:false}},events:{change:{parameters:{propertyName:{type:"string"}}}}}});a.prototype.setVisible=function(e){this.setProperty("visible",e);this.fireChange({propertyName:"visible"});return this};a.prototype.setLabel=function(e){this.setProperty("label",e);this.fireChange({propertyName:"label"});return this};a.prototype.setVisibleInAdvancedArea=function(e){this.setProperty("visibleInAdvancedArea",e);this.fireChange({propertyName:"visibleInAdvancedArea"});return this};a.FILTERTYPE=e.smartfilterbar.FilterType;a.CONTROLTYPE=e.smartfilterbar.ControlType;a.MANDATORY=e.smartfilterbar.MandatoryType;a.DISPLAYBEHAVIOUR=e.smartfilterbar.DisplayBehaviour;return a});
/*!
 * SAPUI5
 * (c) Copyright 2009-2023 SAP SE. All rights reserved.
 */
sap.ui.predefine("sap/ui/comp/smartfilterbar/FilterProvider", ["sap/ui/core/date/UI5Date","sap/ui/comp/util/DateTimeUtil","sap/m/DateTimePicker","sap/m/Select","sap/ui/core/Item","sap/ui/comp/odata/ComboBox","sap/m/DatePicker","sap/m/DateRangeSelection","sap/m/TimePicker","sap/m/Input","sap/ui/comp/smartfilterbar/SFBMultiComboBox","sap/ui/comp/smartfilterbar/SFBMultiInput","sap/ui/comp/smartfilterbar/SortingUtil","sap/m/SearchField","sap/m/Token","sap/ui/comp/odata/MetadataAnalyser","sap/ui/comp/odata/FiscalMetadata","sap/ui/comp/providers/ValueHelpProvider","sap/ui/comp/providers/ValueListProvider","sap/ui/model/json/JSONModel","sap/ui/comp/odata/ODataType","sap/ui/comp/util/FormatUtil","sap/ui/base/EventProvider","sap/ui/comp/util/IdentifierUtil","sap/ui/comp/providers/TokenParser","sap/ui/core/format/DateFormat","sap/ui/comp/library","sap/ui/core/library","sap/ui/model/analytics/odata4analytics","sap/ui/model/FilterOperator","sap/base/Log","sap/base/security/encodeURL","sap/base/util/merge","sap/ui/comp/smartfilterbar/FilterProviderUtils","sap/ui/comp/filterbar/VariantConverterFrom","sap/ui/comp/odata/CalendarMetadata"],function(e,t,i,a,n,r,l,o,s,d,u,f,h,p,c,m,g,_,y,F,v,T,D,C,S,V,A,M,P,I,N,E,B,b,x,w){"use strict";var O=A.smartfilterbar.ControlType;var L=A.smartfilterbar.DisplayBehaviour;var R=A.smartfilterbar.FilterType;var k=M.ValueState;var H=A.smartfilterbar.MandatoryType;var U=function(e){this._bInitialized=false;this._bPending=true;this._bConsiderAnalyticalParameters=false;this._bAttachInitializedDone=false;this.aFilterAnnotations=[];if(e){this._sSmartContainerId=e.smartContainerId;this._sContext=e.context;this._oParentODataModel=e.model;this._sServiceURL=e.serviceUrl;this._sBasicSearchFieldName=e.basicSearchFieldName;this._isBasicSearchEnabled=e.enableBasicSearch;this._bUseContainsAsDefault=e.useContainsAsDefaultFilter==="true";this.sEntityType=e.entityType;this.sEntitySet=e.entitySet;this._isRunningInValueHelpDialog=e.isRunningInValueHelpDialog;this._oAdditionalConfiguration=e.additionalConfiguration;this.sDefaultDropDownDisplayBehaviour=e.defaultDropDownDisplayBehaviour;this.sDefaultTokenDisplayBehaviour=e.defaultTokenDisplayBehaviour;this.mDefaultFilterBarExpanded=e.defaultFilterBarExpanded;this.mDefaultShowAllFilters=e.defaultShowAllFilters;this.sDefaultSingleFieldDisplayBehaviour=e.defaultSingleFieldDisplayBehaviour;if(typeof e.dateFormatSettings==="string"){try{this._oDateFormatSettings=e.dateFormatSettings?JSON.parse(e.dateFormatSettings):undefined}catch(e){}}else{this._oDateFormatSettings=e.dateFormatSettings}if(!this._oDateFormatSettings){this._oDateFormatSettings={}}if(!this._oDateFormatSettings.hasOwnProperty("UTC")){this._oDateFormatSettings["UTC"]=true}if(typeof e.calendarWeekSettings==="string"){this._oCalendarWeekSettings=e.calendarWeekSettings?e.calendarWeekSettings:undefined}if(!this._oCalendarWeekSettings){this._oCalendarWeekSettings=undefined}this._oSmartFilter=e.smartFilter;this.filterBarClass=e.filterBarClass;this._bConsiderAnalyticalParameters=e.considerAnalyticalParameters;this._bUseDateRangeType=e.useDateRangeType;this._bConsiderSelectionVariants=e.considerSelectionVariants;this._aConsiderNavigations=e.considerNavigations;this._bSuppressValueListsAssociation=e.suppressValueListsAssociation;this._aConstParams=this._getConstParams();this._aSignificantParams=this._getSignificantParams()}this.sFilterModelName=b.FILTER_MODEL_NAME;this._sBasicFilterAreaID=b.BASIC_FILTER_AREA_ID;this._aAnalyticalParameters=[];this._aFilterBarViewMetadata=[];this._oFilterBarViewMetadataExtend={};this._aFilterBarFieldNames=[];this._aFilterBarMultiValueFieldMetadata=[];this._aFilterBarSingleValueWithValueListFieldMetadata=[];this._aFilterBarDropdownFieldMetadata=[];this._aFilterBarStringDateFieldNames=[];this._aFilterBarDateFieldNames=[];this._aFilterBarTimeFieldNames=[];this._aFilterBarTimeIntervalFieldNames=[];this._aFilterBarDateTimeMultiValueFieldNames=[];this._aFilterBarStringFieldNames=[];this._aFilterBarDateTimeFieldNames=[];this._aFilterBarDateTimeOffsetWithTimezoneFieldNames=[];this._aFilterBarNumericFieldMetadata=[];this._sSingleInputsTextArrangementData={};this._oNotValidatedSingleFields={};this._oSingleFieldSetFromFilterData={};this._aFieldGroupAnnotation=[];this._oMetadataAnalyser=new m(this._oParentODataModel||this._sServiceURL);this.oModel=new F;this._aValueListProvider=[];this._aValueHelpDialogProvider=[];this._mTokenHandler={};this._mConditionTypeFields={};this._aSelectionVariants=[];this._oParameterization=null;this._oNonAnaParameterization=null;this._aPromises=[]};U._reduceRangesForParameters=function(e){if(e.ranges&&e.ranges.length>1){var t=e.ranges.find(function(e){return e.semantic!==undefined});if(t){e.ranges=[t]}if(e.ranges.length>1){e.ranges=[e.ranges[0]]}}};U.prototype._getConstParams=function(){return this._oSmartFilter&&this._oSmartFilter.data&&this._oSmartFilter.data("hiddenFields")||null};U.prototype._getSignificantParams=function(){return this._oSmartFilter&&this._oSmartFilter.data&&this._oSmartFilter.data("significantFields")||null};U._createFilterProvider=function(e){var t=new U(e);return t._intialiseMetadata()};U.prototype._intialiseMetadata=function(){var e,t,i,a,n,r,l,o,s,d,u,f,h;this._aPromises=[];this._aFilterBarViewMetadata.push({groupName:this._sBasicFilterAreaID,index:0,fields:[]});if(!this.sEntitySet&&this.sEntityType){(function(){this.sEntitySet=this._oMetadataAnalyser.getEntitySetNameFromEntityTypeName(this.sEntityType)}).bind(this)()}this.sEntityType=this._oMetadataAnalyser.getEntityTypeNameFromEntitySetName(this.sEntitySet);r=this._oMetadataAnalyser.getAllFilterableFieldsByEntitySetName(this.sEntitySet,this._bConsiderAnalyticalParameters,this._aConsiderNavigations);this.aAllFields=this._oMetadataAnalyser.getFieldsByEntitySetName(this.sEntitySet);if(r){this._updateDisplayBehaviour();this._aFieldGroupAnnotation=this._oMetadataAnalyser.getFieldGroupsByFilterFacetsAnnotation(this.sEntityType);a=this._oMetadataAnalyser.getSelectionFieldsAnnotation(this.sEntityType);if(a&&a.selectionFields){this._aSelectionFields=a.selectionFields}if(this._aFieldGroupAnnotation){e=this._aFieldGroupAnnotation.length;for(l=0;l<e;l++){n=this._aFieldGroupAnnotation[l];u=this._createGroupMetadata(n);u.index=this._aFilterBarViewMetadata.length;this._aFilterBarViewMetadata.push(u)}}e=r.length;for(l=0;l<e;l++){n=r[l];t=n.fields.length;u=this._createGroupMetadata(n);this._aFilterBarViewMetadata.push(u);for(o=0;o<t;o++){s=n.fields[o];if(s.type.indexOf("Edm.")===0){d=this._createFieldMetadata(s);u.fields.push(d);this._aFilterBarFieldNames.push(d.fieldName)}}i=n.hiddenFields&&n.hiddenFields.length;if(this._isRunningInValueHelpDialog&&i){for(o=0;o<i;o++){s=n.hiddenFields[o];if(s.type.indexOf("Edm.")===0){d=this._createFieldMetadata(s);u.hiddenFields.push(d)}}}}}h=this._getAdditionalConfigurationForCustomGroups(r);e=h.length;for(o=0;o<e;o++){u=this._createGroupMetadataForCustomGroup(h[o]);if(u){this._aFilterBarViewMetadata.push(u)}}f=this._getAdditionalConfigurationForCustomFilterFields();t=f.length;for(o=0;o<t;o++){d=this._createFieldMetadataForCustomFilterFields(f[o]);if(d){this._aFilterBarViewMetadata[0].fields.push(d)}}if(this._hasBasicSearch()){d=this._createBasicSearchFieldMetadata();this._aFilterBarViewMetadata[0].fields.push(d)}if(this._bConsiderAnalyticalParameters||!this._isRunningInValueHelpDialog){this._createParameters()}return new Promise(function(e){Promise.all(this._aPromises).then(function(){if(this._bConsiderSelectionVariants){this._createSelectionVariants()}this._applyGroupId();this._applyIndexes();this._createInitialModel(true);this._initializeConditionTypeFields();this.setPending(this.isPending());this._bInitialized=true;e(this)}.bind(this))}.bind(this))};U.prototype._createSelectionVariants=function(){this._aSelectionVariants=this._oMetadataAnalyser.getSelectionVariantAnnotationList(this.sEntityType)};U.prototype._createParameters=function(){if(this._oMetadataAnalyser.isSemanticAggregation(this.sEntityType)){if(this._bConsiderAnalyticalParameters){var e=sap.ui.require("sap/ui/model/analytics/odata4analytics");if(e){this._createAnalyticalParameters(e)}else{var t=new Promise(function(e){sap.ui.require(["sap/ui/model/analytics/odata4analytics"],function(t){this._createAnalyticalParameters(t);e()}.bind(this))}.bind(this));this._aPromises.push(t)}}}else{this._createNonAnalyticalParameters()}};U.prototype._createAnalyticalParameters=function(e){this._oParameterization=this._getAnalyticParameterization(e);this._createAnalyticParameters(this._oParameterization)};U.prototype._getAnalyticParameterization=function(e){var t,i;try{t=new e.Model(new e.Model.ReferenceByModel(this._oParentODataModel))}catch(e){throw"Failed to instantiate analytical extensions for given OData model: "+e.message}i=t&&t.findQueryResultByName(this.sEntitySet);return i&&i.getParameterization()};U.prototype._createNonAnalyticalParameters=function(){if(this.sEntitySet){this._oNonAnaParameterization=this._oMetadataAnalyser.getParametersByEntitySetName(this.sEntitySet);if(this._oNonAnaParameterization){this._createParametersByEntitySetName(this._oNonAnaParameterization.entitySetName,this._oNonAnaParameterization.parameters)}}};U.prototype.attachPendingChange=function(e){this._attachEvent("PendingChange",e)};U.prototype.detachPendingChange=function(e){this._detachEvent("PendingChange",e)};U.prototype.setPending=function(e){var t=this._bPending!==e;this._bPending=e;if(t){var i={};i.pending=e;this._fireEvent("PendingChange",i)}};U.prototype.isPending=function(){if(!this._bInitialized){return true}for(var e in this._mConditionTypeFields){if(this._mConditionTypeFields[e].conditionType.isPending()){return true}}return false};U.prototype._updateDisplayBehaviour=function(){this._sTextArrangementDisplayBehaviour=this._oMetadataAnalyser.getTextArrangementValue(this.sEntityType);if(!this.sDefaultDropDownDisplayBehaviour){if(this._sTextArrangementDisplayBehaviour){this.sDefaultDropDownDisplayBehaviour=this._sTextArrangementDisplayBehaviour}else{this.sDefaultDropDownDisplayBehaviour=L.descriptionAndId}}if(!this.sDefaultTokenDisplayBehaviour){if(this._sTextArrangementDisplayBehaviour){this.sDefaultTokenDisplayBehaviour=this._sTextArrangementDisplayBehaviour}else{this.sDefaultTokenDisplayBehaviour=L.descriptionAndId}}if(!this.sDefaultSingleFieldDisplayBehaviour){if(this._sTextArrangementDisplayBehaviour){this.sDefaultSingleFieldDisplayBehaviour=this._sTextArrangementDisplayBehaviour}else{this.sDefaultSingleFieldDisplayBehaviour=L.descriptionAndId}}};U.prototype._hasBasicSearch=function(){return this._isBasicSearchEnabled};U.prototype._getAdditionalConfigurationForCustomFilterFields=function(){var e,t,i,a;if(!this._oAdditionalConfiguration){return[]}e=this._oAdditionalConfiguration.getControlConfiguration();if(!this._aFilterBarFieldNames||!this._aFilterBarFieldNames.length){return e}a=[];t=e.length;for(i=0;i<t;i++){if(this._aFilterBarFieldNames.indexOf(e[i].key)<0){a.push(e[i])}}return a};U.prototype._getAdditionalConfigurationForCustomGroups=function(e){var t,i,a,n,r,l,o,s;if(!this._oAdditionalConfiguration){return[]}t=this._oAdditionalConfiguration.getGroupConfiguration();if(!e||!e.length){return t}r=[];a=e.length;i=t.length;for(n=0;n<i;n++){o=false;for(l=0;l<a;l++){s=e[l].groupName||e[l].groupEntitySetName;if(s===t[n].key){o=true;break}}if(!o){r.push(t[n])}}return r};U.prototype._createInitialModelForField=function(t,i,a){var n=false,r,l,o=false,s=false,d=null,u=null,f,h=null,p=[],c=[];if(!i||i.isCustomFilterField){return}if(i.filterRestriction!==R.multiple){s=true}if((i.filterType==="date"||i.filterType==="time"||i.filterType==="datetime")&&!i.isFiscalDate&&!i.isCalendarType){n=true}if(a){r=i.defaultFilterValues;o=r&&r.length;if(!o){if(i.defaultPropertyValue&&i.isParameter){l=i.defaultPropertyValue;if(i.filterType==="numeric"){l=this._getType(i).parseValue(l,"string")}r=[{low:l}];o=true}else if(i.defaultFilterValue){l=i.defaultFilterValue;r=[{low:l,high:l,operator:"EQ",sign:"I"}];o=true}}}var m=this._oAdditionalConfiguration?this._oAdditionalConfiguration.getControlConfigurationByKey(i.fieldName):null;if(i.hasFixedValues||m&&m.controlType===O.dropDownList){this._aFilterBarDropdownFieldMetadata.push(i)}if(i.filterRestriction===R.single&&!this._isSingleDynamicDateEnabled(i)){if(o){l=r[0];d=n?this._createDateTimeValue(i,l.low):l.low}if(i.type==="Edm.String"&&i.hasValueListAnnotation&&!i.hasFixedValues&&i.controlType!=="dropDownList"){this._aFilterBarSingleValueWithValueListFieldMetadata.push(i);if(!o&&i.control){i.control.setValue("")}}t[i.fieldName]=d}else if(i.filterRestriction===R.interval&&i.type!=="Edm.Time"){if(o){l=r[0];d=n?this._createDateTimeValue(i,l.low):l.low;u=n?this._createDateTimeValue(i,l.high):l.high}t[i.fieldName]={low:d,high:u}}else{if(o){f=r.length;while(f--){l=r[f];if(s){h={exclude:l.sign==="E",operation:l.operator==="CP"?"Contains":l.operator,keyField:i.fieldName,value1:n?this._createDateTimeValue(i,l.low):l.low,value2:n?null:l.high};if(i.filterType==="time"&&l.high){h.value2=e.getInstance(l.high)}}else{h={key:n?this._createDateTimeValue(i,l.low):l.low,text:n?"":l.low}}p.push(h)}}this._aFilterBarMultiValueFieldMetadata.push(i);t[i.fieldName]={value:null};if(s){c=p.slice(0);p=[];t[i.fieldName].ranges=c}t[i.fieldName].items=p;this._updateMultiValueControl(i.control,p,c)}};U.prototype._createDateTimeValue=function(t,i){switch(t.type){case"Edm.Time":if(i.indexOf("PT")===0){return this._getTime(i)}else{N.error("Default value for "+t.fieldName+" could not be parsed.")}break;case"Edm.DateTime":if(typeof i=="string"&&t.displayFormat&&t.displayFormat.toLowerCase()=="date"){var a=i.split("T");i=a[0]+"T00:00:00";return e.getInstance(i)}else{N.error("Default value for "+t.fieldName+" could not be parsed.")}break;case"Edm.DateTimeOffset":return e.getInstance(i);default:N.error("Default value for "+t.fieldName+" could not be parsed.")}};U.prototype._createInitialModel=function(e){var t,i,a,n,r,l,o,s;t={};this._bCreatingInitialModel=true;this._aFilterBarMultiValueFieldMetadata=[];this._aFilterBarSingleValueWithValueListFieldMetadata=[];this._aFilterBarDropdownFieldMetadata=[];if(this._aFilterBarViewMetadata){i=this._aFilterBarViewMetadata.length;for(o=0;o<i;o++){r=this._aFilterBarViewMetadata[o];a=r.fields.length;for(l=0;l<a;l++){this._createInitialModelForField(t,r.fields[l],e)}n=r.hiddenFields&&r.hiddenFields.length;if(this._isRunningInValueHelpDialog&&n){for(l=0;l<n;l++){this._createInitialModelForField(t,r.hiddenFields[l],e)}}}}if(this._aCustomFieldMetadata){for(s=0;s<this._aCustomFieldMetadata.length;s++){this._createInitialModelForField(t,this._aCustomFieldMetadata[s],false)}}if(this._aAnalyticalParameters){a=this._aAnalyticalParameters.length;for(l=0;l<a;l++){this._createInitialModelForField(t,this._aAnalyticalParameters[l],e)}}this.oModel&&this.oModel.setData(t);if(!e){this._clearConditionTypeFields()}this._updateConditionTypeFields();this._bCreatingInitialModel=false};U.prototype._setTokenTooltip=function(e,t){if(!e||!t){return}if(typeof t!=="string"){try{t=t.toString()}catch(e){}}e.setTooltip(t)};U.prototype._updateMultiValueControl=function(e,i,a,n){var r=0,l=null,o=null,s=null,d=null,h=null,p,m,g,_;if(e&&i){r=i.length;if(e instanceof f){l=[];while(r--){d=i[r].text||i[r].key;var o=new c;o.setKey(i[r].key);o.setText(d);this._setTokenTooltip(o,d);l.push(o)}if(a){r=a.length;while(r--){s=a[r];if((s.value1===""||s.value1===null)&&s.operation===I.EQ){_=x.convertOption(s.operation,s.value1);s.operation=_.op;s.tokenText=T.getFormattedRangeText(s.operation,null,null,s.exclude);s.value1=_.v}if(s.tokenText){d=s.tokenText}else{p=s.value1;m=s.value2;if(n){var y=true;var F=["date","datetime","time"];if(F.indexOf(n.filterType)>-1){g=this._getType(n);if(g){if(p){if(n.filterType==="time"){p=t.dateToEdmTime(t.localToUtc(p))}p=g.formatValue(p,"string",y)}if(m){if(n.filterType==="time"){m=t.dateToEdmTime(t.localToUtc(m))}m=g.formatValue(m,"string",y)}}}else if(n.filterType==="numeric"){g=this._getType(n);if(g){if(p!==""&&p!==undefined){if(typeof p==="string"&&!isNaN(p)){p=parseFloat(p);s.value1=p}p=g.formatValue(p,"string")}if(m!==""&&m!==undefined){if(typeof m==="string"&&!isNaN(m)){m=parseFloat(m);s.value2=m}m=g.formatValue(m,"string")}}}else if(n.filterType==="boolean"){g=this._getType(n);if(g){if(p!==""&&p!==undefined&&p==="false"){p=g.formatValue(false,"string")}else{p=g.formatValue(p,"string")}if(m!==""&&m!==undefined&&m==="false"){m=g.formatValue(false,"string")}else{m=g.formatValue(p,"string")}}}else{var v=n.isCalendarDate||n.isFiscalDate||n.isCalendarType||(p instanceof Date||m instanceof Date);if(v){g=this._getType(n);if(p){p=g.formatValue(p,"string")}if(m){m=g.formatValue(m,"string")}}}}d=T.getFormattedRangeText(s.operation,p,m,s.exclude)}o=new c;o.setText(d);this._setTokenTooltip(o,d);o.data("range",s);l.push(o)}}e.setTokens(l);e.fireTokenUpdate()}if(e instanceof u){h=[];while(r--){h.push(i[r].key)}e.setSelectedKeys(h)}}};U.prototype._updateSingleValueControl=function(e){var t=e.control,i=e.fieldName,a=e.displayBehaviour||this.sDefaultSingleFieldDisplayBehaviour,n=this.oModel.getData(),r=n[i],l=r,o=this._getSingleInputsTextArrangementData(i);if(o&&o.key===r&&o.key!==o.text){l=T.getFormattedExpressionFromDisplayBehaviour(a,o.key,o.text);delete this._oNotValidatedSingleFields[i]}t.setValue(l);if(r&&r===l){this._oSingleFieldSetFromFilterData[i]=true;var s=this._aValueListProvider.find(function(e){return e.sFieldName===i});if(s&&s.bInitialised){s._validateInput(r);delete this._oNotValidatedSingleFields[i]}else{this._oNotValidatedSingleFields[i]=r}}};U.prototype._applyIndexes=function(){if(!this._aFilterBarViewMetadata){return}this._aFilterBarViewMetadata=h.groupSorting(this._aFilterBarViewMetadata)};U.prototype._applyGroupId=function(){var e=Array.isArray(this._aFilterBarViewMetadata)?this._aFilterBarViewMetadata.length:0,t,i,a,n,r,l;for(n=0;n<e;n++){if(!this._aFilterBarViewMetadata[n].fields){continue}t=this._aFilterBarViewMetadata[n].fields.length;for(r=0;r<t;r++){a=this._aFilterBarViewMetadata[n].fields[r];if(a&&a.groupId&&a.groupId!==this._aFilterBarViewMetadata[n].groupName){i=undefined;for(l=0;l<e;l++){if(this._aFilterBarViewMetadata[l].groupName===a.groupId){i=this._aFilterBarViewMetadata[l];break}}if(i){this._aFilterBarViewMetadata[n].fields.splice(r,1);r--;t--;i.fields=i.fields||[];i.fields.push(a)}}}}};U.prototype._createFilterControlId=function(e){var t=this._oSmartFilter?this._oSmartFilter.getId():"FilterPanel";var i=C.replace(e.groupId||"");var a=C.replace(e.fieldName);var n=e.customColumnKey&&C.replace(e.customColumnKey);if(n){a+=n}if(this._sSmartContainerId){a=this._sSmartContainerId+"-"+a}return t+"-filterItemControl"+i+"-"+a};U.prototype._createGroupMetadata=function(e){var t,i=null,a;a=e.groupName||e.groupEntitySetName;if(this._oAdditionalConfiguration){i=this._oAdditionalConfiguration.getGroupConfigurationByKey(a)}t={};t.groupName=a;t.groupLabel=this._getGroupLabel(e,i);t.fields=[];t.hiddenFields=[];t.index=this._getGroupIndex(i);return t};U.prototype._createGroupMetadataForCustomGroup=function(e){var t;t={};t.groupName=e.key;t.groupLabel=e.label;t.fields=[];t.index=this._getGroupIndex(e);return t};U.prototype._getTime=function(e){var t=V.getTimeInstance({pattern:"'PT'hh'H'mm'M'ss'S'"});return t.parse(e)};U.prototype._checkMetadataDefaultValue=function(e){var t=e.defaultFilterValue||e.defaultPropertyValue;if(t){try{if(e.type==="Edm.Time"&&t.indexOf("PT")===0){this._getTime(t)}else{this._getType(e)}}catch(t){e.defaultPropertyValue=null;e.defaultFilterValue=null;N.error("default value for "+e.fieldName+" could not be parsed.")}}};U.prototype._getType=function(e){var t,i={},a={},n={};if(e.ui5Type){return e.ui5Type}if(e.precision||e.scale){a.precision=e.precision;a.scale=e.scale}if(e.maxLength){a.maxLength=e.maxLength}if(e.displayFormat){a.displayFormat=e.displayFormat}if(e.isDigitSequence){a.isDigitSequence=e.isDigitSequence}if(e.isCalendarDate){n.isCalendarDate=true}if(e.isCalendarType&&!e.isCalendarDate){n.isCalendarType=true;n.calendarType=e.calendarType}if(e.isFiscalDate&&e.fiscalType){n.isFiscalDate=true;n.fiscalType=e.fiscalType}if(e.filterType==="date"||e.filterType==="time"||e.filterType==="datetime"||e.isCalendarDate){i=Object.assign({},this._oDateFormatSettings,{UTC:false})}t=v.getType(e.type,i,a,n);return t};U.prototype._setControlDisplayFormat=function(e,t){var i;if(!t){return}i=t.style||t.pattern;if(!i){return}e.setDisplayFormat(i)};U.prototype._setControlCalendarWeekSetting=function(e,t){if(!t){return}if(typeof e.setCalendarWeekNumbering==="function"){e.setCalendarWeekNumbering(t)}};U.prototype._createControl=function(e){var t,h,p=false,c,m,g=e.type!=="Edm.String"||e.isFiscalDate||e.isCalendarType||e.isDigitSequence;if(e.customControl){return e.customControl}h=this._getType(e);t=new e.fControlConstructor(this._createFilterControlId(e));t._oFieldViewMetadata=e;if(e.fControlConstructor===o){this._setControlDisplayFormat(t,this._oDateFormatSettings);this._setControlCalendarWeekSetting(t,this._oCalendarWeekSettings);if(e.isCalendarDate){t.bindProperty("dateValue",{path:this.sFilterModelName+">/"+e.fieldName+"/low",type:h});t.bindProperty("secondDateValue",{path:this.sFilterModelName+">/"+e.fieldName+"/high",type:h})}else{t.bindProperty("dateValue",this.sFilterModelName+">/"+e.fieldName+"/low");t.bindProperty("secondDateValue",this.sFilterModelName+">/"+e.fieldName+"/high")}}else if(e.fControlConstructor===r||e.fControlConstructor===a){if(t.setForceSelection){t.setForceSelection(true)}if(e.fControlConstructor===a){t.addItem(new n({key:"",text:""}));t.addItem(new n({key:false,text:h.formatValue(false,"string")}));t.addItem(new n({key:true,text:h.formatValue(true,"string")}))}else{this._associateValueList(t,"items",e,false,this._getSuppressValueListsAssociation());t.attachSelectionChange(function(){if(this._bUpdatingFilterData||this._bCreatingInitialModel){return}t.fireChange({filterChangeReason:e.fieldName,value:""})}.bind(this));if(t.isA("sap.ui.comp.odata.ComboBox")){t.useHighlightItemsWithContains=function(){return true};t.attachSelectedKeyChange(function(){if(t.data("__validationError")){t.data("__validationError",null);t.setValueState(k.None)}})}}t.bindProperty("selectedKey",this.sFilterModelName+">/"+e.fieldName)}else if(e.fControlConstructor===u){this._associateValueList(t,"items",e,false,this._getSuppressValueListsAssociation());t.attachSelectionChange(function(t){if(this._bUpdatingFilterData||this._bCreatingInitialModel){return}var i=t.getSource(),a=null,n=[],r;a=i.getSelectedItems();if(a){r=a.length;while(r--){n.push({key:a[r].getKey(),text:a[r].getText()})}}if(this.oModel){this.oModel.setProperty("/"+e.fieldName+"/items",n)}i.fireChange({filterChangeReason:e.fieldName,value:""})}.bind(this));t.bindProperty("value",this.sFilterModelName+">/"+e.fieldName+"/value")}else if(e.fControlConstructor===f){if(e.controlType===O.date||e.type==="Edm.Time"||e.type==="Edm.DateTimeOffset"){t.setValueHelpOnly&&t.setValueHelpOnly(true);if(e.filterRestriction===R.interval){this._associateValueHelpDialog(t,e,false,false)}else{this._associateValueHelpDialog(t,e,true,true)}this._setControlCalendarWeekSetting(t,this._oCalendarWeekSettings)}else{if(e.hasValueHelpDialog){this._associateValueHelpDialog(t,e,e.filterRestriction!==R.multiple,true)}else{t.setShowValueHelp(false)}t.bindProperty("value",{path:this.sFilterModelName+">/"+e.fieldName+"/value",type:h})}this._handleMultiInput(t,e,h)}else if(e.fControlConstructor===d){if(e.filterRestriction===R.interval){p=true;t.bindProperty("value",this.sFilterModelName+">/"+e.fieldName+"/low");if(!this.oResourceBundle){this.oResourceBundle=sap.ui.getCore().getLibraryResourceBundle("sap.ui.comp")}if(!this.sIntervalPlaceholder){this.sIntervalPlaceholder=this.oResourceBundle.getText("INTERVAL_PLACEHOLDER_TEXT")}t.setPlaceholder(this.sIntervalPlaceholder)}else if(e.hasValueListAnnotation){t.attachChange(function(i){var a=i.getParameter("value");t.__sValidationText="";if(!a){this.oModel.setProperty("/"+e.fieldName,"")}}.bind(this))}else{t.bindProperty("value",{path:this.sFilterModelName+">/"+e.fieldName,type:h})}if(e.hasValueHelpDialog){t.setShowValueHelp(true);if(p&&g){t.setValueHelpOnly&&t.setValueHelpOnly(true)}this._associateValueHelpDialog(t,e,false,false)}}else if(e.isCalendarDate){this._setControlDisplayFormat(t,this._oDateFormatSettings);this._setControlCalendarWeekSetting(t,this._oCalendarWeekSettings);t.bindProperty("dateValue",{path:this.sFilterModelName+">/"+e.fieldName,type:h})}else if(e.fControlConstructor===l){t.bindProperty("dateValue",this.sFilterModelName+">/"+e.fieldName);this._setControlDisplayFormat(t,this._oDateFormatSettings);this._setControlCalendarWeekSetting(t,this._oCalendarWeekSettings)}else if(e.fControlConstructor===s||e.fControlConstructor===i){t.bindProperty("dateValue",this.sFilterModelName+">/"+e.fieldName);if(this._oDateFormatSettings&&this._oDateFormatSettings.style){t.setDisplayFormat(this._oDateFormatSettings.style)}this._setControlCalendarWeekSetting(t,this._oCalendarWeekSettings)}if(t instanceof l){t.attachChange(function(e){var i=e.getParameter("valid");t.data("__mandatoryEmpty",null);if(i){t.setValueState(k.None);t.setValueStateText()}else{var a=t._parseValue(e.getParameter("newValue")),n=this._getSelectedDateRange(a);t.setValueState(k.Error);if(n[0]&&n[1]){var r=sap.ui.getCore().getLibraryResourceBundle("sap.ui.comp"),l=this._getDateFieldOutOfRangeErrorText(t,n,h,r);t.setValueStateText(l)}else if(h){try{h.parseValue("foo","string")}catch(e){t.setValueStateText(e.message)}}}}.bind(this))}if(e.hasTypeAhead){if(e.hasValueListAnnotation){t.setShowSuggestion(true)}t.setFilterSuggests(false);this._associateValueList(t,"suggestionRows",e,true,this._getSuppressValueListsAssociation())}if(e.displayFormat==="UpperCase"&&e.controlType!==O.dropDownList&&t.attachChange&&t.getValue&&t.setValue){t.attachChange(function(i){var a=t.getValue();if(a&&!e.hasValueListAnnotation){t.setValue(a.toUpperCase())}});if(this._mTokenHandler[t.getId()]&&this._mTokenHandler[t.getId()].parser){var _=this._mTokenHandler[t.getId()].parser;_.getKeyFields()[0].displayFormat=e.displayFormat}}if(t instanceof d){if(e.maxLength){c=parseInt(e.maxLength);if(!isNaN(c)){if(this._mTokenHandler[t.getId()]&&this._mTokenHandler[t.getId()].parser){var _=this._mTokenHandler[t.getId()].parser;_.getKeyFields()[0].maxLength=c}else{if(!e.hasValueListAnnotation&&!p){t.setMaxLength(c)}}}}if(e.isCalendarType&&e.calendarType){t.setPlaceholder(h.formatter.getPattern())}if(e.isFiscalDate){t.setPlaceholder(h.formatter.getPattern())}var y=e.filterRestriction==="auto"||e.filterRestriction==="multi-value"||e.filterRestriction==="multiple";if(e.type==="Edm.String"&&y&&(this._oSmartFilter&&!this._oSmartFilter.getDisableSearchMatchesPatternWarning())){t.attachLiveChange(this._oSmartFilter._onLiveChangeValidateSymbols.bind(this._oSmartFilter))}}m=function(e){var i=e.getParameter("exception");var a=e.getParameter("element");if(t&&a&&t.getId()===a.getId()){if(i){if(t.setValueStateText){t.setValueStateText(i.message)}}if(t.setValueState){t.setValueState(k.Error)}t.data("__mandatoryEmpty",null)}};t.attachParseError(m);t.attachFormatError(m);t.attachValidationError(m);t.attachValidationSuccess(function(e){var i=e.getParameter("element");if(t&&i&&t.getId()===i.getId()){if(t.setValueState){t.setValueState(k.None)}if(t.setValueStateText){t.setValueStateText()}t.data("__mandatoryEmpty",null);delete t.__sValidationText}});if(e.fControlConstructor===r||e.fControlConstructor===u){t.setFilterFunction(function(e,t){RegExp.escape=function(e){return e.replace(/[-/\\^$*+?.()|[\]{}]/g,"\\$&")};var i=RegExp.escape(e);var a=new RegExp(i,"i");return t.getText().match(new RegExp(a,"i"))||t.getKey().match(new RegExp(a,"i"))})}return t};U.prototype._getControlConstructor=function(e,t){var n=d,h,p,c;c=t?t+e.fieldName:e.fieldName;if(e.isCustomFilterField){n=undefined}else{h=e.filterRestriction===R.single;p=e.filterRestriction===R.interval;if(e.controlType===O.date){if(h&&!this._isSingleDynamicDateEnabled(e)){n=l}else{n=p?o:f}if(e.isCalendarDate){this._aFilterBarStringDateFieldNames.push(c)}else{this._aFilterBarDateFieldNames.push(c)}if(e.filterRestriction===R.multiple){this._aFilterBarDateTimeMultiValueFieldNames.push(c)}}else if(e.controlType===O.dropDownList){if(h){n=this._isBooleanWithFixedValuedButWithoutValueListAnnotation(e)?a:r}else{n=u}if(!h){e.filterRestriction=R.multiple}}else if(e.type==="Edm.Time"){if(h){n=s}else{n=f}this._aFilterBarTimeFieldNames.push(c);if(p){this._aFilterBarTimeIntervalFieldNames.push(c)}else if(e.filterRestriction===R.multiple){this._aFilterBarDateTimeMultiValueFieldNames.push(c)}}else if(!p&&e.controlType===O.dateTimePicker){if(h){n=i}else{n=f}this._aFilterBarDateTimeFieldNames.push(c);if(e.filterRestriction===R.multiple){this._aFilterBarDateTimeMultiValueFieldNames.push(c)}}else if(p&&e.type==="Edm.DateTimeOffset"){var g=this._getFilterTimeZone(c);if(g){var _={key:c,value:g};this._aFilterBarDateTimeOffsetWithTimezoneFieldNames.push(_)}this._aFilterBarDateTimeFieldNames.push(c)}else if(h&&m.isNumber(e)){this._aFilterBarNumericFieldMetadata.push(c)}else if(!h&&!p){n=f}}return n};U.prototype._handleTokenUpdate=function(e,t){this._tokenUpdate({control:t.control,fieldViewMetadata:t.fieldViewMetadata,removedTokens:e&&e.getParameter("removedTokens")})};U.prototype._tokenUpdate=function(e){var i=e.removedTokens,a=e.control,n=e.fieldViewMetadata,r,l=[],o,s,d,u=[],f="/"+n.fieldName;if(this._bUpdatingFilterData||this._bCreatingInitialModel){return}r=a.getTokens();if(i){r=r.filter(function(e){return i.indexOf(e)===-1})}if(Array.isArray(r)&&r.length>0){o=r.length;while(o--){s=r[o];d=s.data("range");if(d){d.tokenText=s.getText();if(n.customColumnKey){d.customColumnKey=n.customColumnKey}if(d&&s.getKey().indexOf("range_")===0){if(n.type==="Edm.Time"){if(d.value1&&(d.value1.ms||d.value1.ms===0)){d.value1=t.utcToLocal(t.edmTimeToDate(d.value1))}if(d.value2&&(d.value2.ms||d.value2.ms===0)){d.value2=t.utcToLocal(t.edmTimeToDate(d.value2))}}}u.push(d)}else{l.push({key:s.getKey(),text:s.getText()})}}}if(this.oModel){this.oModel.setProperty(f+"/items",l);this.oModel.setProperty(f+"/ranges",u)}if(a.__bValidatingToken){delete a.__bValidatingToken}if(!a._pendingAutoTokenGeneration){a.fireChange({filterChangeReason:n.fieldName,value:""})}};U.prototype._handleMultiInput=function(e,t,i){e._setFilterProvider(this);e._setFieldViewMetadata(t);e.attachTokenUpdate({control:e,fieldViewMetadata:t},this._handleTokenUpdate,this);var a,n=t.type==="Edm.DateTime"&&t.displayFormat==="Date";if(t.hasValueListAnnotation||t.type==="Edm.String"||n){e.attachEvent("_validateOnPaste",function(r){var l=r.getParameter("texts"),o,s,d,u,f;s=l?l.length:0;if(s>1){r.preventDefault();o=this.oModel.getProperty("/"+t.fieldName);f=o.ranges||[];e.setValue("");while(s--){d=l[s];if(d){u=null;if(t.isUpperCase){d=d.toUpperCase()}if(n){a=this._getDateValue(d,i);if(isNaN(a.getDate())){continue}else{u=d;d=a}}var h=S._createRangeByText(d);f.push(Object.assign({keyField:t.fieldName,tokenText:u,value1:d,value2:null},h))}}this.oModel.setProperty("/"+t.fieldName+"/ranges",f);this._updateMultiValueControl(e,o.items,f,t)}}.bind(this))}};U.prototype._associateValueHelpDialog=function(e,t,i,a){var n=t.visibleInAdvancedArea||t.groupId===b.BASIC_FILTER_AREA_ID;if(this._getSuppressValueListsAssociation()&&n){this._attachEventOnce(b.ASSOCIATE_VALUE_LISTS,function(){this._associateValueHelpDialogHandler(e,t,i,a)}.bind(this))}else{this._associateValueHelpDialogHandler(e,t,i,a)}};U.prototype._addToParams=function(e,t,i){if(t==="true"||t==="false"){e[i]=t==="true"}else if(typeof t==="object"&&t!==null&&Object.keys(t).length>0){e[i]=t[e.fieldName]==="true"}else if(t!==undefined&&t!==null){N.error("customData for "+i+" is not of type boolean or object")}};U.prototype._associateValueHelpDialogHandler=function(e,t,i,a){var n,r,l={fieldName:t.fieldName,control:e,model:this._oParentODataModel,filterModel:this.oModel,filterProvider:this,dateFormatSettings:this._oDateFormatSettings,calendarWeekSettings:this._oCalendarWeekSettings,fieldViewMetadata:t,displayFormat:t.displayFormat,displayBehaviour:t.displayBehaviour,loadAnnotation:t.hasValueListAnnotation,fullyQualifiedFieldName:t.fullName,metadataAnalyser:this._oMetadataAnalyser,preventInitialDataFetchInValueHelpDialog:t.preventInitialDataFetchInValueHelpDialog,supportMultiSelect:a,supportRanges:i,isSingleIntervalRange:t.filterRestriction===R.interval,isSearchExpressionFilterRestriction:t.filterRestriction===R.searchExpression,isUnrestrictedFilter:t.filterRestriction!==R.multiple,type:t.filterType,maxLength:t.maxLength,scale:t.scale,precision:t.precision,context:this._oSmartFilter?"SmartFilterBar":"mdcFilterPanel",filterBarClass:this.filterBarClass,defaultOperation:t.conditionPanelDefaultOperation,enabledMultiSelectionPlugin:true,_onBeforeOpenValueHelpDialog:function(e){if(this._oSmartFilter){this._oSmartFilter.fireEvent("_beforeOpenVHD",e)}}.bind(this)};if(l.isSearchExpressionFilterRestriction){r={defaultOperation:m._getSearchExpressionTypeOperations().string[0],typeOperations:m._getSearchExpressionTypeOperations(),rangeOperationsKeys:m._getSearchExpressionRangeOperationsKeys()}}if(t.isCalendarDate){l.oType=this._getType(t)}if(this.mDefaultFilterBarExpanded){this._addToParams(l,this.mDefaultFilterBarExpanded,"defaultFilterBarExpanded")}if(this.mDefaultShowAllFilters){this._addToParams(l,this.mDefaultShowAllFilters,"defaultShowAllFilters")}var o=new _(l);o.attachValueListChanged(function(e){if(this._oSmartFilter){this._oSmartFilter.fireFilterChange(e);this._oSmartFilter.validateMandatoryFields()}}.bind(this));if(t.visibleInAdvancedArea||t.groupId===b.BASIC_FILTER_AREA_ID){this.aFilterAnnotations.push(o.loadAnnotation().then(function(e){this._enrichFieldViewMetadata(t,e)}.bind(this)))}this._aValueHelpDialogProvider.push(o);if(i&&e.addValidator){n=new S(r);n.addKeyField({key:t.fieldName,label:t.label,type:t.filterType,oType:t.ui5Type});if(t.filterType==="numeric"){n.setDefaultOperation("EQ")}n.associateInput(e);this._mTokenHandler[e.getId()]={parser:n}}};U.prototype._determineFieldLabel=function(e){var t,i=e.label;if(this._oSmartFilter&&this._oSmartFilter.determineFilterItemByName){t=this._oSmartFilter.determineFilterItemByName(e.name,e.groupName);if(t){i=t.getLabel()}}return i};U.prototype._associateValueList=function(e,t,i,a,n){var r=i.visibleInAdvancedArea||i.groupId===b.BASIC_FILTER_AREA_ID,l={control:e,aggregation:t,fieldViewMetadata:i,hasTypeAhead:a,annotaionIsToBeLoaded:r};if(n&&r){this._attachEventOnce(b.ASSOCIATE_VALUE_LISTS,function(){this._associateValueListHandler(l)}.bind(this))}else{this._associateValueListHandler(l)}};U.prototype._associateValueListHandler=function(e){var t,i=e.control,a=e.aggregation,n=e.fieldViewMetadata,r=e.hasTypeAhead,l=e.annotaionIsToBeLoaded;if(this._oSmartFilter&&!this._bAttachInitializedDone&&new URLSearchParams(window.location.search).get("sap-ui-comp-filterbar-data-defer")){var o=this._oParentODataModel;this._sDeferredGroupId="sapUiCompFilterBarData";var s=o.getDeferredGroups?this._oParentODataModel.getDeferredGroups():null;if(s!==null){s.push(this._sDeferredGroupId);o.setDeferredGroups(s);var d=function(){o.submitChanges({groupId:this._sDeferredGroupId});var e=o.getDeferredGroups().filter(function(e){return e!==this._sDeferredGroupId}.bind(this));o.setDeferredGroups(e);delete this._sDeferredGroupId;this._oSmartFilter.detachInitialized(d)}.bind(this);this._oSmartFilter.attachInitialized(d);this._bAttachInitializedDone=true}}if(n.hasValueListAnnotation){t=new y({fieldName:n.fieldName,control:i,model:this._oParentODataModel,filterModel:this.oModel,filterProvider:this,displayFormat:n.displayFormat,dateFormatSettings:this._oDateFormatSettings,fieldViewMetadata:n,displayBehaviour:n.displayBehaviour,loadAnnotation:true,fullyQualifiedFieldName:n.fullName,metadataAnalyser:this._oMetadataAnalyser,type:n.filterType,aggregation:a,typeAheadEnabled:r,enableShowTableSuggestionValueHelp:n.hasValueHelpDialog,deferredGroupId:this._sDeferredGroupId,context:this._sContext?this._sContext:"SmartFilterBar",fieldHistoryEnabled:n.historyEnabled!==undefined?n.historyEnabled:true,fieldHistoryEnabledInitial:n.historyEnabledInitial!==undefined?n.historyEnabledInitial:true});t.attachValueListChanged(function(e){if(this._oSmartFilter){this._oSmartFilter.fireFilterChange(e);this._oSmartFilter.validateMandatoryFields()}}.bind(this));if(l){this.aFilterAnnotations.push(t.loadAnnotation().then(function(e){this._enrichFieldViewMetadata(n,e)}.bind(this)))}this._aValueListProvider.push(t)}else if(this._mTokenHandler[i.getId()]&&this._mTokenHandler[i.getId()].parser&&n.filterRestriction!=="searchExpression"){this._mTokenHandler[i.getId()].parser.setDefaultOperation("EQ")}};U.prototype._createAnalyticParameters=function(e){var t,i;if(e){i=e.getAllParameterNames();t=e.getEntitySet();if(t){this._createParametersByEntitySetName(t.getQName(),i)}}};U.prototype._createParametersByEntitySetName=function(e,t){var i,a=this._oMetadataAnalyser.getFieldsByEntitySetName(e);for(var n=0;n<a.length;n++){if(t.indexOf(a[n].name)>=0){i=this._createAnalyticParameterMetadata(a[n]);if(i&&i.visible){if(this._oNonAnaParameterization&&i.isCustomFilterField){continue}this._aAnalyticalParameters.push(i)}}}};U.prototype._createAnalyticParameterMetadata=function(e){var t,i=A.ANALYTICAL_PARAMETER_PREFIX,a=function(e){return e.type==="Edm.String"&&e["sap:parameter"]==="optional"};e.filterRestriction="single-value";t=this._createFieldMetadata(e,i);if(t){t.fieldName=i+e.name;t.isMandatory=a(t)?false:true;t.isParameter=true;t.visibleInAdvancedArea=true}else{N.error("_createAnalyticParameterMetadata issue with property: "+e.name)}return t};U.prototype.getAnalyticParameters=function(){return this._aAnalyticalParameters};U.prototype.getSelectionVariants=function(){return this._aSelectionVariants};U.prototype.getAnalyticBindingPath=function(){var e,t=[],i=this.getAnalyticParameters();i.forEach(function(e){t.push(e.fieldName)});e=this.getFilledFilterData(t);if(this._oParameterization){return this._createAnalyticBindingPath(i,e)}else{return this._createNonAnalyticBindingPath(i,e)}};U.prototype._createAnalyticBindingPath=function(e,i){var a,n="",r;r=this._getParameterizationRequest(this._oParameterization);if(r){e.forEach(function(e){a=i[e.fieldName];if(!a){a=""}else if(e.type==="Edm.Time"&&a instanceof Date){if(this._oDateFormatSettings&&!this._oDateFormatSettings.UTC){a=t.utcToLocal(a)}a=t.localToUtc(a);a={__edmType:"Edm.Time",ms:a.valueOf()}}else if(e.type==="Edm.DateTime"&&i[e.fieldName]&&i[e.fieldName].conditionTypeInfo&&i[e.fieldName].ranges&&i[e.fieldName].ranges[0]){a=i[e.fieldName].ranges[0].value1;if(this._oDateFormatSettings&&this._oDateFormatSettings.UTC&&a instanceof Date){a=t.localToUtc(a)}}else if(e.type!=="Edm.DateTimeOffset"&&this._oDateFormatSettings&&this._oDateFormatSettings.UTC&&a instanceof Date){a=t.localToUtc(a)}r.setParameterValue(e.name,a)}.bind(this));n=r.getURIToParameterizationEntry()+"/"+this._oParameterization.getNavigationPropertyToQueryResult()}return n};U.prototype._createNonAnalyticBindingPath=function(e,i){var a,n="",r="";if(this._oNonAnaParameterization){n="/"+this._oNonAnaParameterization.entitySetName+"(";e.forEach(function(e){a=i[e.fieldName];if(!a){a=""}else if(e.type==="Edm.Time"&&a instanceof Date){a=t.localToUtc(a);a={__edmType:"Edm.Time",ms:a.valueOf()}}else if(e.type==="Edm.DateTime"&&i[e.fieldName]&&i[e.fieldName].conditionTypeInfo&&i[e.fieldName].ranges&&i[e.fieldName].ranges[0]){a=i[e.fieldName].ranges[0].value1;if(this._oDateFormatSettings&&this._oDateFormatSettings.UTC&&a instanceof Date){a=t.localToUtc(a)}}else if(e.type!=="Edm.DateTimeOffset"&&this._oDateFormatSettings&&this._oDateFormatSettings.UTC&&a instanceof Date){a=t.localToUtc(a)}n+=r+e.name+"="+E(this._oParentODataModel.formatValue(a,e.type));r=","}.bind(this));n+=")/"+this._oNonAnaParameterization.navPropertyName}return n};U.prototype._getParameterizationRequest=function(){return this._oParameterization?new P.ParameterizationRequest(this._oParameterization):null};U.prototype._constructContextUrl=function(e,t){var i=e._getServerUrl();if(i&&i.lastIndexOf("/")===i.length-1){i=i.substr(0,i.length-1)}return i+e.sServiceUrl+"/$metadata#"+t};U.prototype.getFilterContextUrl=function(){var e,t=null;if(this._oParentODataModel&&this._oParentODataModel.isA("sap.ui.model.odata.v2.ODataModel")&&this._oParentODataModel.getMetaModel()){e=this._oParentODataModel.getMetaModel().getODataEntitySet(this.sEntitySet);if(e){t=this._constructContextUrl(this._oParentODataModel,e.name)}}return t};U.prototype.getParameterContextUrl=function(){var e,t=null;if(this._oParentODataModel&&this._oParentODataModel.isA("sap.ui.model.odata.v2.ODataModel")&&this._oParentODataModel.getMetaModel()){if(this._oParameterization&&this._oParameterization.getEntitySet()){e=this._oParameterization.getEntitySet().getQName()}else if(this._oNonAnaParameterization){e=this._oNonAnaParameterization.entitySetName}if(e){t=this._constructContextUrl(this._oParentODataModel,e)}}return t};U.prototype._createFieldMetadata=function(t,i){var a,n,r,l,s;t.fieldName=this._getFieldName(t);t.fieldNameOData=t.fieldName.replace(b.FIELD_NAME_REGEX,"/");n=this._oAdditionalConfiguration?this._oAdditionalConfiguration.getControlConfigurationByKey(t.fieldName):null;a=Object.assign({},t);a.filterRestriction=this._getFilterRestriction(t.filterRestriction,n);this._updateValueListMetadata(a,t);a.hasValueHelpDialog=this._hasValueHelpDialog(a,n);a.isConstant=Array.isArray(this._aConstParams)&&this._aConstParams.indexOf(t.fieldName)!==-1;a.isInitialValueSignificant=Array.isArray(this._aSignificantParams)&&this._aSignificantParams.indexOf(t.fieldName)!==-1;if(n){a.preventInitialDataFetchInValueHelpDialog=this._getPreventInitialDataFetchInValueHelpDialog(a,n);a.conditionPanelDefaultOperation=n.conditionPanelDefaultOperation;if(n.displayBehaviour&&n.displayBehaviour!=="auto"){a.displayBehaviour=n.displayBehaviour}a.isCustomFilterField=!!n.customControl;a.visibleInAdvancedArea=!!n.visibleInAdvancedArea;a.defaultFilterValues=n.defaultFilterValues;a.customControl=n.customControl;r=n.conditionType;a.width=this._getWidth(n);a.isVisible=this._isVisible(n);a.historyEnabled=n.historyEnabled;a.historyEnabledInitial=n.historyEnabledInitial;a.hasValidation=n.hasValidation}else{a.preventInitialDataFetchInValueHelpDialog=this._getPreventInitialDataFetchInValueHelpDialog(a);a.isVisible=true;a.isCustomFilterField=false;a.visibleInAdvancedArea=false}a.controlType=this._getControlType(a,n);a.label=this._getLabel(t,n);a.isMandatory=this._isMandatory(t,n);a.groupId=this._getGroupID(t,n);a.index=this._getIndex(t,n);a.fControlConstructor=this._getControlConstructor(a,i);a.isFiscalDate=g.isFiscalValue(a);a.isCalendarType=w.isCalendarValue(a);a.fiscalType=g.getFiscalAnnotationType(a);a.calendarType=w.getCalendarAnnotationType(a);if(a.isFiscalDate){g.updateViewMetadata(a)}if(a.isCalendarType&&a.calendarType){w.updateViewMetadata(a)}a.filterType=this._getFilterType(a);a.hasTypeAhead=this._hasTypeAhead(a,t,n);a.ui5Type=this._getType(a);if(a.ui5Type&&a.ui5Type.isA("sap.ui.model.odata.type.DateTime")){a.ui5Type.formatValue(e.getInstance(),"string");a.ui5Type.oFormat.oFormatOptions.UTC=false}a.fCreateControl=function(e){var t;e.control=this._createControl(e);t=this.oModel.getData()[e.fieldName];if(t){this._updateMultiValueControl(e.control,t.items,t.ranges,e);var i=this._aFilterBarSingleValueWithValueListFieldMetadata.some(function(t){return t.name===e.fieldName||A.ANALYTICAL_PARAMETER_PREFIX+t.name===a.fieldName});if(i){this._updateSingleValueControl(e)}}}.bind(this);this._applyWidth(a);if(a.type==="Edm.String"){this._aFilterBarStringFieldNames.push(a.fieldName)}a.conditionType=null;var d=a.filterRestriction===R.single&&(a.type==="Edm.DateTime"&&a.displayFormat==="Date"||a.type==="Edm.String"&&a.isCalendarDate);var u=a.type==="Edm.DateTimeOffset"&&a.filterRestriction==="interval";if(!r&&this._bUseDateRangeType&&(a.fControlConstructor===o||d||u)){r="sap.ui.comp.config.condition.DateRangeType"}if(r){l="";if(typeof r==="object"){if(this._bUseDateRangeType&&!r.module&&a.fControlConstructor===o||d||u){r.module="sap.ui.comp.config.condition.DateRangeType"}l=r.module}else{l=r;r=null}try{l=l.replace(/\./g,"/");var f=sap.ui.require(l);if(f){this._enhanceConditionTypeInfo(f,l,r,a,i)}else{s=new Promise(function(e){sap.ui.require([l],function(t){this._enhanceConditionTypeInfo(t,l,r,a,i);e()}.bind(this))}.bind(this));this._aPromises.push(s)}}catch(e){N.error("Module "+l+" could not be loaded")}}else{this._checkMetadataDefaultValue(a)}return a};U.prototype._requireConditionType=function(e,t,i){var e=e.replace(/\./g,"/");var a=sap.ui.require(e);if(a){this._enhanceConditionTypeInfo(a,e,t,i)}else{sap.ui.require([e],function(a){this._enhanceConditionTypeInfo(a,e,t,i)}.bind(this))}};U.prototype._enhanceConditionTypeInfo=function(e,t,i,a,n){var r=e;var l=n===A.ANALYTICAL_PARAMETER_PREFIX&&a.fieldName.indexOf(A.ANALYTICAL_PARAMETER_PREFIX)===-1?n+a.fieldName:a.fieldName;a.conditionType=new r(l,this,a);this._mConditionTypeFields[l]=a;a.calendarWeekNumbering=this._oCalendarWeekSettings;if(i&&!this._bUseDateRangeType){if(a.defaultValue&&n===A.ANALYTICAL_PARAMETER_PREFIX){i=Object.assign({},i,{defaultDate:a.defaultValue})}a.conditionType.applySettings(i)}if(this._bUseDateRangeType&&i&&n!==A.ANALYTICAL_PARAMETER_PREFIX){a.conditionType.applySettings(i)}if(this._bUseDateRangeType&&n===A.ANALYTICAL_PARAMETER_PREFIX&&(a.defaultValue||i&&i.defaultOperation)){var o={defaultDate:a.defaultValue};i=Object.assign({},o,i);a.conditionType.applySettings(i)}this._checkMetadataDefaultValue(a)};U.prototype._getFilterType=function(e){return T._getFilterType(e)};U.prototype._updateValueListMetadata=function(e,t){e.hasValueListAnnotation=t["sap:value-list"]!==undefined;if(e.hasValueListAnnotation){e.hasFixedValues=t["sap:value-list"]==="fixed-values"}else if(t["com.sap.vocabularies.Common.v1.ValueList"]){e.hasValueListAnnotation=true;e.hasFixedValues=this._oMetadataAnalyser.getValueListSemantics(t["com.sap.vocabularies.Common.v1.ValueList"])==="fixed-values";if(!e.hasFixedValues){e.hasFixedValues=m.isValueListWithFixedValues(t)}}};U.prototype._createBasicSearchFieldMetadata=function(){var e;var t=sap.ui.getCore().getLibraryResourceBundle("sap.ui.comp");e={};e.filterRestriction=R.single;e.name=b.BASIC_SEARCH_FIELD_ID;e.fieldName=b.BASIC_SEARCH_FIELD_ID;e.label=undefined;e.isMandatory=false;e.isVisible=true;e.groupId=b.BASIC_FILTER_AREA_ID;e.index=-1;e.control=new p(this._oSmartFilter.getId()+"-btnBasicSearch",{showSearchButton:true});if(!this._isRunningInValueHelpDialog){e.control.setPlaceholder(t.getText("FILTER_BAR_BSEARCH_PLACE_HOLDER"))}e.control.bindProperty("value",this.sFilterModelName+">/"+e.fieldName);this._oBasicSearchControl=e.control;return e};U.prototype._applyWidth=function(e){if(e&&e.width&&e.control&&typeof e.control.setWidth==="function"){e.control.setWidth(e.width)}};U.prototype._createFieldMetadataForCustomFilterFields=function(e){var t;if(!e||!e.customControl){return undefined}t={};t.name=e.key;t.fieldName=e.key;t.label=e.label;t.visibleInAdvancedArea=!!(e&&e.visibleInAdvancedArea);t.isVisible=this._isVisible(e);t.groupId=e.groupId;t.isMandatory=this._isMandatory(undefined,e);t.index=e.index;t.width=this._getWidth(e);t.control=e.customControl;t.isCustomFilterField=true;this._applyWidth(t);return t};U.prototype._getFieldName=function(e){if(!e.parentPropertyName){return e.name}else{return e.parentPropertyName+"."+e.name}};U.prototype._getPreventInitialDataFetchInValueHelpDialog=function(e,t){if(t&&!t.isSetPreventInitialDataFetchInValueHelpDialog){return t.preventInitialDataFetchInValueHelpDialog}if(m.isValueList(e)&&e["com.sap.vocabularies.Common.v1.ValueList"]&&e["com.sap.vocabularies.Common.v1.ValueList"].FetchValues){return e["com.sap.vocabularies.Common.v1.ValueList"].FetchValues.Int!=="1"}return false};U.prototype._hasValueHelpDialog=function(e,t){var i=true;if(t){if(t.controlType===O.dropDownList){i=false}else if(t.hasValueHelpDialog!==true){i=false}}if(e&&!e.hasValueListAnnotation){if(e.filterRestriction===R.single||e.filterRestriction===R.multiple){i=false}}return i};U.prototype._isVisible=function(e){if(e&&e.isVisible===false){return false}return true};U.prototype._getWidth=function(e){if(e&&e.width){return e.width}return undefined};U.prototype._isMandatory=function(e,t){if(t&&t.mandatory!==H.auto){return t.mandatory===H.mandatory}if(e){return e.requiredFilterField}return false};U.prototype._getFilterRestriction=function(e,t){if(t&&t.filterType&&t.filterType!==R.auto){return t.filterType}switch(e){case"single-value":return R.single;case"multi-value":return R.multiple;case"interval":return R.interval;case"search-expression":return R.searchExpression;default:return R.auto}};U.prototype._getControlType=function(e,t){var i;if(t&&t.controlType&&t.controlType!==O.auto){i=t.controlType}else if(e.type==="Edm.DateTime"&&e.displayFormat==="Date"||e.isCalendarDate){i=O.date}else if(e.type==="Edm.DateTimeOffset"){i=O.dateTimePicker}else if(e.hasValueListAnnotation&&e.hasFixedValues){i=O.dropDownList}else if(this._isBooleanWithFixedValuedButWithoutValueListAnnotation(e)){i=O.dropDownList}else{i=O.input}return i};U.prototype._isBooleanWithFixedValuedButWithoutValueListAnnotation=function(e){if(e.type==="Edm.Boolean"&&!e.hasFixedValues&&!e.hasValueListAnnotation&&e.filterRestriction==="single"){return true}return false};U.prototype._getGroupID=function(e,t){if(t&&t.groupId){return t.groupId}else if(e&&(e.requiredFilterField||this._aSelectionFields&&this._aSelectionFields.indexOf(e.fieldNameOData)>-1)){return this._sBasicFilterAreaID}return this._getGroupIDFromFieldGroup(e)};U.prototype._getGroupIDFromFieldGroup=function(e){var t=0,i=null,a;if(e&&this._aFieldGroupAnnotation&&this._aFieldGroupAnnotation.length){t=this._aFieldGroupAnnotation.length;while(t--){i=this._aFieldGroupAnnotation[t];if(i&&i.fields&&i.fields.indexOf(e.fieldNameOData)>-1){a=i.groupName;break}}}return a};U.prototype._getLabel=function(e,t){if(t&&t.label){return t.label}return this._getLabelFromFieldGroup(e)||e.fieldLabel||e.fieldName};U.prototype._getLabelFromFieldGroup=function(e){var t=0,i=null,a;if(e&&this._aFieldGroupAnnotation&&this._aFieldGroupAnnotation.length){t=this._aFieldGroupAnnotation.length;while(t--){i=this._aFieldGroupAnnotation[t];if(i&&i.fields&&i.fields.indexOf(e.fieldNameOData)>-1){a=i.labels[e.fieldNameOData];break}}}return a};U.prototype._getIndex=function(e,t){if(t&&t.index>=0){return t.index}else if(this._aSelectionFields&&this._aSelectionFields.indexOf(e.fieldNameOData)>-1){return this._aSelectionFields.indexOf(e.fieldNameOData)}return this._getIndexFromFieldGroup(e)};U.prototype._getIndexFromFieldGroup=function(e){var t=0,i=null,a;if(e&&this._aFieldGroupAnnotation&&this._aFieldGroupAnnotation.length){t=this._aFieldGroupAnnotation.length;while(t--){i=this._aFieldGroupAnnotation[t];if(i&&i.fields){a=i.fields.indexOf(e.fieldNameOData);if(a>-1){break}a=undefined}}}return a};U.prototype._getGroupIndex=function(e){if(e&&(e.index||e.index===0)){return e.index}};U.prototype._getGroupLabel=function(e,t){if(t&&t.label){return t.label}return e.groupLabel||e.groupName||e.groupEntitySetName};U.prototype._hasTypeAhead=function(e,t,i){var a;a=true;if(i){a=i.hasTypeAhead}else if(t.type!=="Edm.String"){return false}if(!(e.fControlConstructor===d||e.fControlConstructor===f)){return false}return a};U.prototype.getModel=function(){return this.oModel};U.prototype.getFilterBarViewMetadata=function(){return this._aFilterBarViewMetadata};U.prototype._getFilterBarViewMetadataExtend=function(){return this._oFilterBarViewMetadataExtend};U.prototype.getAssociatedValueHelpProviders=function(){return this._aValueHelpDialogProvider};U.prototype.getAssociatedValueListProviders=function(){return this._aValueListProvider};U.prototype.getParameters=function(){var e,t=null;if(this.oModel){t=this.oModel.getProperty("/"+b.BASIC_SEARCH_FIELD_ID)}if(this._sBasicSearchFieldName||t){e={custom:{}};if(this._sBasicSearchFieldName){e.custom["search-focus"]=this._sBasicSearchFieldName}e.custom["search"]=t||""}return e};U.prototype.getFilters=function(e){var t=null;if(this.oModel){t=this.oModel.getData()}return b.generateFilters(e,t,{dateSettings:this._oDateFormatSettings,useContainsAsDefault:this._bUseContainsAsDefault,stringFields:this._aFilterBarStringFieldNames,timeFields:this._aFilterBarTimeFieldNames,dateTimeOffsetValueFields:this._aFilterBarDateTimeFieldNames,dateTimeOffsetWithTimeZone:this._aFilterBarDateTimeOffsetWithTimezoneFieldNames,viewMetadataData:this._aFilterBarViewMetadata})};U.prototype.getFilterData=function(){return this.oModel?this.oModel.getData():null};U.prototype.getFilterDataAsString=function(){return this.oModel?this.oModel.getJSON():null};U.prototype.getFilledFilterData=function(e){var t,i={},a,n,r;t=this.oModel?this.oModel.getData():null;if(t&&e){a=e.length;while(a--){n=e[a];if(n&&n!==b.BASIC_SEARCH_FIELD_ID){r=t[n];if(r&&r.hasOwnProperty("low")){if(r.low){i[n]=r}}else if(r&&r.hasOwnProperty("items")){if(r.value&&typeof r.value==="string"){r.value=r.value.trim()}if(r.items.length||r.ranges&&r.ranges.length||r.value||typeof r.value==="boolean"){i[n]=r}}else if(r){if(typeof r==="string"){r=r.trim()}if(r){i[n]=r}}}if(a===0){n=b.CUSTOM_FIELDS_MODEL_PROPERTY;r=t[n];if(r){i[n]=r}}}}return B({},i)};U.prototype.getFilledFilterDataAsString=function(e){return JSON.stringify(this.getFilledFilterData(e))};U.prototype.setFilterData=function(e,t){var i=null,a=null,n=null;if(this.oModel&&e){this._bUpdatingFilterData=true;try{if(t){this._createInitialModel(false)}i=this._parseFilterData(e,t);if(i){this.oModel.setData(i,true);a=[];var r=arguments[2];if(r){a.push(r)}for(n in i){a.push(n)}this._handleFilterDataUpdate(a,arguments[3])}}finally{this._bUpdatingFilterData=false}}};U.prototype.setFilterDataAsString=function(e,t){if(e){this.setFilterData(JSON.parse(e),t)}};U.prototype._parseFilterData=function(e,t){return U.parseFilterData(this.oModel.getData(),e,{stringDateFields:this._aFilterBarStringDateFieldNames,dateFields:this._aFilterBarDateFieldNames,timeFields:this._aFilterBarTimeFieldNames,timeIntervalFields:this._aFilterBarTimeIntervalFieldNames,dateTimeMultiValueFields:this._aFilterBarDateTimeMultiValueFieldNames,conditionTypeFields:this._mConditionTypeFields,dateTimeOffsetValueFields:this._aFilterBarDateTimeFieldNames,dateTimeOffsetWithTimeZone:this._aFilterBarDateTimeOffsetWithTimezoneFieldNames,viewMetadataData:this._aFilterBarViewMetadata,filterProvider:this},t)};U.prototype._handleFilterDataUpdate=function(e,t){var i=0,a,n,t=t===undefined?false:t,r=this.oModel.getData();var l=function(e,t){var i=t;e.forEach(function(e){t.forEach(function(a){if(a.operation===I.EQ&&a.value1===e.key){i.splice(t.indexOf(a),1)}})});return i};if(this._aFilterBarMultiValueFieldMetadata){i=this._aFilterBarMultiValueFieldMetadata.length;while(i--){if(r){a=this._aFilterBarMultiValueFieldMetadata[i];if(e.indexOf(a.fieldName)>-1){n=r[a.fieldName];if(n){if(n.items&&n.items.length>0&&n.ranges&&n.ranges.length>0){n.ranges=l(n.items,n.ranges)}this._updateMultiValueControl(a.control,n.items,n.ranges,a)}}}}this._updateConditionTypeFields()}if(this._aFilterBarSingleValueWithValueListFieldMetadata&&r&&!t){this._aFilterBarSingleValueWithValueListFieldMetadata.forEach(function(t){var i=t.control,a=t.fieldName;if(!i||m.isHiddenFilter(t)){return}if(e.includes(a)){this._updateSingleValueControl(t)}else if(!r[a]){i.setValue("");i.__sValidationText=""}}.bind(this))}};U.prototype.clear=function(){this._createInitialModel(false)};U.prototype.reset=function(){this._createInitialModel(true)};U.prototype._initializeConditionTypeFields=function(){var e=function(e){this.setPending(this.isPending())}.bind(this);for(var t in this._mConditionTypeFields){this._mConditionTypeFields[t].conditionType.initialize(this.oModel.getData()[t]);if(this._mConditionTypeFields[t].conditionType.getAsync()){this._mConditionTypeFields[t].conditionType.attachPendingChange(e)}}};U.prototype._updateConditionTypeFields=function(){var e=this._oldData;var t=this.oModel.getData();this._oldData=B({},t);if(e!==undefined){var i=[],a;for(a in t){var n=JSON.stringify(t[a]);var r=JSON.stringify(e[a]);if(n!==r){i.push(a)}}if(i.length>0){for(a in this._mConditionTypeFields){this._mConditionTypeFields[a].conditionType.providerDataUpdated(i,t)}}}};U.prototype._clearConditionTypeFields=function(){var e=this.oModel.getData();for(var t in this._mConditionTypeFields){if(!e[t]){this._mConditionTypeFields[t].conditionType.initialize({})}else{this._mConditionTypeFields[t].conditionType.initialize(e[t])}}};U.prototype._validateConditionTypeFields=function(){var e=false;for(var t in this._mConditionTypeFields){var i=this._mConditionTypeFields[t].conditionType.validate();if(!i&&!e){e=true}}return e};U.prototype._getFieldMetadata=function(e){return b._getFieldMetadata(this.getFilterBarViewMetadata(),e)};U.prototype._getSelectedDateRange=function(e){if(!Array.isArray(e)){e=[e,e]}return e};U.prototype._getDateFieldOutOfRangeErrorText=function(e,t,i,a){var n=e.getMinDate()||e._oMinDate,r=e.getMaxDate()||e._oMaxDate;if(t[0].getTime()<n.getTime()){return a.getText("FILTER_BAR_DATE_FIELD_MIN_DATE_ERROR",[i.formatValue(n,"string")])}if(t[1].getTime()>r.getTime()){return a.getText("FILTER_BAR_DATE_FIELD_MAX_DATE_ERROR",[i.formatValue(r,"string")])}};U.generateFilters=function(e,t,i){return b.generateFilters(e,t,i)};U.parseFilterData=function(t,i,a,n){var r={},l=null,o=null,s=null,d,u,f,h,p,c,m,g,_,y,F,v,T,D,C;if(a){c=a.stringDateFields;m=a.dateFields;g=a.timeFields;_=a.timeIntervalFields;y=a.dateTimeMultiValueFields;l=a.conditionTypeFields||{};F=a.dateTimeOffsetValueFields;v=a.viewMetadataData||[];D=a.filterProvider||null}if(!c){c=[]}if(!m){m=[]}if(!g){g=[]}if(!_){_=[]}if(!y){y=[]}if(!F){F=[]}if(t&&i){u=Object.assign({},i,true);for(o in u){T=b._getFieldMetadata(v,o);if(t.hasOwnProperty(o)&&o!==b.CUSTOM_FIELDS_MODEL_PROPERTY){s=t[o];d=u[o];if(o in l){if(l[o]&&typeof d==="string"){var S=e.getInstance(d);if(S instanceof Date&&!isNaN(S)){l[o].conditionType.initialize({value1:S})}else if(l[o].type==="Edm.String"&&l[o].ui5Type&&typeof l[o].ui5Type.formatValue==="function"){var S=l[o].ui5Type.formatValue(d);l[o].conditionType.initialize({value1:S})}}else if(d&&(d.low||d.low===0)&&(d.high||d.high===0)){var V=e.getInstance(d.low),A=e.getInstance(d.high);if(V instanceof Date&&!isNaN(V)&&A instanceof Date&&!isNaN(A)){l[o].conditionType.initialize({value1:V,value2:A})}else if(l[o].type==="Edm.String"&&l[o].ui5Type&&typeof l[o].ui5Type.formatValue==="function"){var V=l[o].ui5Type.formatValue(d.low),A=l[o].ui5Type.formatValue(d.high);l[o].conditionType.initialize({value1:V,value2:A})}}else if(d&&"conditionTypeInfo"in d){if(l[o].isParameter){this._reduceRangesForParameters(d)}else if(d.ranges&&d.ranges.length>0){p=d.ranges[d.ranges.length-1];if(p){if(d.conditionTypeInfo.data.operation==="DATE"){d.conditionTypeInfo.data.value1=p.value1}else if(d.conditionTypeInfo.data.operation==="DATERANGE"){d={value1:p.value1,value2:p.value2}}}}l[o].conditionType.initialize(d)}else if(d&&!("conditionTypeInfo"in d)&&d.ranges){if(l[o].isParameter){this._reduceRangesForParameters(d)}l[o].conditionType.initialize(d)}}else if(s&&s.hasOwnProperty("low")){r[o]=d;if(d){if((d.low||d.low===0)&&(d.high||d.high===0)){if(m.indexOf(o)>-1||g.indexOf(o)>-1){if(!(d.low instanceof Date)){r[o].low=e.getInstance(d.low)}if(!(d.high instanceof Date)){r[o].high=e.getInstance(d.high)}}else if(D&&T&&F.indexOf(o)>-1){r[o].low=T.ui5Type.formatValue(e.getInstance(d.low),"string")+"-"+T.ui5Type.formatValue(e.getInstance(d.high),"string");r[o].high=null}else if(c.indexOf(o)===-1){r[o].low=d.low+"-"+d.high;r[o].high=null}}else if((d.low||d.low===0||d.value)&&!d.high){if(!d.low&&d.value){d.low=d.value}if((m.indexOf(o)>-1||g.indexOf(o)>-1||F.indexOf(o)>-1)&&!(d.low instanceof Date)){C=Date.parse(d.low);if(!Number.isNaN(C)){r[o].low=e.getInstance(C)}}r[o].low=d.low;r[o].high=null}}}else if(s&&s.hasOwnProperty("items")){if(d&&(d.items||d.ranges)){if(d.ranges&&d.ranges.length){if(_.indexOf(o)>-1){h=d.ranges.length;for(f=0;f<h;f++){p=d.ranges[f];if(!p.exclude&&(p.operation==="EQ"||p.operation==="BT")){break}p=null}if(p){if(p.value1&&typeof p.value1==="string"){p.value1=e.getInstance(p.value1)}if(p.value2&&typeof p.value2==="string"){p.value2=e.getInstance(p.value2)}r[o]={ranges:[p],items:[],value:""}}continue}else if(m.indexOf(o)>-1||g.indexOf(o)>-1||F.indexOf(o)>-1){h=d.ranges.length;for(f=0;f<h;f++){p=d.ranges[f];if(p.value1&&typeof p.value1==="string"){p.value1=e.getInstance(p.value1)}if(p.value2&&typeof p.value2==="string"){p.value2=e.getInstance(p.value2)}}}else if(T&&T.isCalendarDate){h=d.ranges.length;for(f=0;f<h;f++){p=d.ranges[f];if(p.value1&&typeof p.value1==="string"&&!p.value1.match(/([1-9][0-9]{3,}|0[0-9]{3})(0[1-9]|1[0-2])(0[1-9]|[12][0-9]|3[01])/)){p.value1=T.ui5Type.parseValue(e.getInstance(p.value1),"date")}if(p.value2&&typeof p.value2==="string"&&!p.value2.match(/([1-9][0-9]{3,}|0[0-9]{3})(0[1-9]|1[0-2])(0[1-9]|[12][0-9]|3[01])/)){p.value2=T.ui5Type.parseValue(e.getInstance(p.value2),"date")}}}else if(T&&T.filterType==="boolean"){h=d.ranges.length;for(f=0;f<h;f++){p=d.ranges[f];if(p.hasOwnProperty("value1")){if(typeof p.value1==="string"){p.value1=p.value1==="true"}}if(p.hasOwnProperty("value2")){if(typeof p.value2==="string"){p.value2=p.value2==="true"}}}}}r[o]=d;if(!n&&r[o].ranges){for(f=0;f<r[o].ranges.length;f++){r[o].ranges[f].tokenText=null}}}else if(typeof d==="string"||typeof d==="boolean"||typeof d==="number"||d instanceof Date){if(d&&(m.indexOf(o)>-1||g.indexOf(o)>-1)){if(typeof d==="string"){d=e.getInstance(d)}r[o]={ranges:[{exclude:false,operation:"EQ",keyField:o,value1:d,value2:null}],items:[],value:""}}else{r[o]={value:d,items:[]}}}}else{r[o]=null;if(typeof d==="string"||typeof d==="boolean"||typeof d==="number"||d instanceof Date){if(typeof d==="string"&&(m.indexOf(o)>-1||g.indexOf(o)>-1||F.indexOf(o)>-1)){r[o]=e.getInstance(d)}else{r[o]=d}}else if(d&&(d.value||d.value===0||d.value===false)){r[o]=d.value}else if(d&&d.items&&d.items.length){r[o]=d.items[0].key}else if(d&&d.ranges&&d.ranges.length){h=d.ranges.length;for(f=0;f<h;f++){p=d.ranges[f];if(!p.exclude&&p.operation==="EQ"){break}p=null}if(p&&p.value1){if(typeof p.value1==="string"&&(m.indexOf(o)>-1||g.indexOf(o)>-1||F.indexOf(o)>-1)){r[o]=e.getInstance(p.value1)}else{r[o]=p.value1}}}}}else if(n||o===b.CUSTOM_FIELDS_MODEL_PROPERTY){r[o]=u[o]}}}return r};U.prototype._attachEvent=function(e,t){if(!this._oEventProvider){this._oEventProvider=new D}this._oEventProvider.attachEvent(e,t)};U.prototype._attachEventOnce=function(e,t){if(!this._oEventProvider){this._oEventProvider=new D}this._oEventProvider.attachEventOnce(e,t)};U.prototype._detachEvent=function(e,t){if(!this._oEventProvider){return}this._oEventProvider.detachEvent(e,t)};U.prototype._fireEvent=function(e,t){if(!this._oEventProvider){return}this._oEventProvider.fireEvent(e,t||{})};U.prototype._getSuppressValueListsAssociation=function(){return this._bSuppressValueListsAssociation};U.prototype._getCurrentValidationPromises=function(){return this._aValueListProvider.concat(this._aValueHelpDialogProvider).reduce(function(e,t){return e.concat(t._getCurrentValidationPromises())},[])};U.prototype._enrichFieldViewMetadata=function(e,t){var i,a,n,r,l,o,s={},d="com.sap.vocabularies.Common.v1.ValueList";if(t===undefined||e===undefined){return}a=e["groupName"];n=e["fullName"];r=t.primaryValueListAnnotation!==undefined;l=Array.isArray(t.additionalAnnotations)&&t.additionalAnnotations.length>0;if(r){s[d]=t.primaryValueListAnnotation.annotation}if(l){for(i=0;i<t.additionalAnnotations.length;i++){o=t.additionalAnnotations[i];s[d+"#"+o.qualifier]=o.annotation}}if(r||l){if(this._oFilterBarViewMetadataExtend[a]===undefined){this._oFilterBarViewMetadataExtend[a]={}}if(this._oFilterBarViewMetadataExtend[a][n]===undefined){this._oFilterBarViewMetadataExtend[a][n]={}}this._oFilterBarViewMetadataExtend[a][n]=s}};U.prototype._isSingleDynamicDateEnabled=function(e){var t=this._bUseDateRangeType&&(e.type==="Edm.DateTime"&&e.displayFormat==="Date"||e.type==="Edm.String"&&e.isCalendarDate);if(t){return true}var i=this._oAdditionalConfiguration?this._oAdditionalConfiguration.getControlConfigurationByKey(e.fieldName)||this._oAdditionalConfiguration.getControlConfigurationByKey(e.name):null;var a=i&&(i.conditionType==="sap.ui.comp.config.condition.DateRangeType"||i.conditionType&&i.conditionType&&typeof i.conditionType==="object"&&i.conditionType.module==="sap.ui.comp.config.condition.DateRangeType")&&(e.type==="Edm.DateTime"||e.type==="Edm.String"&&e.isCalendarDate);return a};U.prototype._setSingleInputsTextArrangementData=function(e){this._sSingleInputsTextArrangementData=Object.assign({},e);return this};U.prototype._setSingleInputsTextArrangementFieldData=function(e,t,i){this._sSingleInputsTextArrangementData[e]={key:t,text:i};return this};U.prototype._getSingleInputsTextArrangementData=function(e){if(e){return this._sSingleInputsTextArrangementData[e]}return this._sSingleInputsTextArrangementData};U.prototype._getFilterTimeZone=function(e){var t=this._oAdditionalConfiguration,i=t?t.getControlConfigurationByKey(e):null,a=null;if(i){a=i.timezone}return a};U.prototype.destroy=function(){var e=function(e){var t;if(e){t=e.length;while(t--){e[t].destroy()}}};this._oParentODataModel=null;this._aAnalyticalParameters=null;this._aFilterBarViewMetadata=null;this._oFilterBarViewMetadataExtend=null;this._oParameterization=null;this._oNonAnaParameterization=null;this._aFilterBarFieldNames=null;this._aFilterBarStringDateFieldNames=null;this._aFilterBarDateFieldNames=null;this._aFilterBarTimeFieldNames=null;this._aFilterBarTimeIntervalFieldNames=null;this._aFilterBarDateTimeMultiValueFieldNames=null;this._aFilterBarStringFieldNames=null;this._aFilterBarMultiValueFieldMetadata=null;this._aFilterBarDropdownFieldMetadata=null;this._aFilterBarNumericFieldMetadata=null;this._sSingleInputsTextArrangementData=null;this._oNotValidatedSingleFields={};this._oSingleFieldSetFromFilterData={};this._aFilterBarDateTimeFieldNames=null;this._aFilterBarDateTimeOffsetWithTimezoneFieldNames=null;this._aFieldGroupAnnotation=null;this._aSelectionFields=null;this._aSelectionVariants=null;if(this._oBasicSearchControl&&this._oBasicSearchControl.destroy){this._oBasicSearchControl.destroy()}this._oBasicSearchControl=null;if(this._oMetadataAnalyser&&this._oMetadataAnalyser.destroy){this._oMetadataAnalyser.destroy()}this._oMetadataAnalyser=null;e(this._aValueHelpDialogProvider);this._aValueHelpDialogProvider=null;e(this._aValueListProvider);this._aValueListProvider=null;if(this._mTokenHandler){for(var t in this._mTokenHandler){var i=this._mTokenHandler[t];if(i.parser){i.parser.destroy();i.parser=null}}delete this._mTokenHandler}this.oResourceBundle=null;this.sIntervalPlaceholder=null;this.sDefaultDropDownDisplayBehaviour=null;this.sDefaultTokenDisplayBehaviour=null;this.sDefaultSingleFieldDisplayBehaviour=null;this._oSmartFilter=null;if(this._oEventProvider){if(this._oEventProvider.destroy){this._oEventProvider.destroy()}this._oEventProvider=null}for(var a in this._mConditionTypeFields){this._mConditionTypeFields[a].conditionType.destroy()}this._mConditionTypeFields=null;if(this.oModel){this.oModel.destroy();this.oModel=null}this._aPromises=[];this.bIsDestroyed=true};return U},true);
/*!
 * SAPUI5
 * (c) Copyright 2009-2023 SAP SE. All rights reserved.
 */
sap.ui.predefine("sap/ui/comp/smartfilterbar/FilterProviderUtils", ["sap/ui/base/Object","sap/ui/core/date/UI5Date","sap/ui/model/Filter","sap/ui/model/FilterOperator","sap/ui/comp/util/DateTimeUtil","sap/ui/comp/util/FormatUtil","sap/ui/comp/util/FilterUtil","sap/ui/comp/library","sap/ui/core/Configuration"],function(e,i,t,a,n,l,s,o,r){"use strict";var f=o.smartfilterbar.FilterType,u=o.valuehelpdialog.ValueHelpRangeOperation;var c=e.extend("sap.ui.comp.smartfilterbar.FilterProviderUtils");c.FIELD_NAME_REGEX=/\./g;c.BASIC_SEARCH_FIELD_ID="_BASIC_SEARCH_FIELD";c.BASIC_FILTER_AREA_ID="_BASIC";c.FILTER_MODEL_NAME="fi1t3rM0d31";c.CUSTOM_FIELDS_MODEL_PROPERTY="_CUSTOM";c.ASSOCIATE_VALUE_LISTS="AssociateValueLists";c.INTL_TIMEZONE=Intl.DateTimeFormat().resolvedOptions().timeZone;c.UI_TIMEZONE=r.getTimezone();c._getStringEmptyFilter=function(e,i,n){var l=n?a.NE:a.EQ,s=i&&i.type==="Edm.Guid"?"00000000-0000-0000-0000-000000000000":"";if(i&&i.nullable==="false"){return new t(e,l,s)}else{return new t({and:!!n,filters:[new t(e,l,s),new t(e,l,null)]})}};c._getFieldMetadata=function(e,i){var t=null;e.some(function(e){if(e&&e.fields){e.fields.some(function(e){if(e&&e.fieldName===i){t=e}return t!==null})}return t!==null});return t};c._getAnalyticalFieldMetadata=function(e,i){var t=null;e.some(function(e){if(e&&e.fieldName===i){t=e}return t!==null});return t};c._getTimezone=function(e,i){var t=e&&e.find(function(e){return e.key===i});if(t){return t.value}return null};c.adaptTime=function(e,i){var t;if(!(e instanceof Date)||!i){return e}if(i.filterRestriction===f.single&&i.control&&i.control.isA("sap.m.DynamicDateRange")){return n.normalizeDate(e,true)}if(i.displayFormat==="Date"){return n.normalizeDate(e,true)}t=parseInt(i.precision);return n.adaptPrecision(e,t)};c.generateFilters=function(e,o,r){var f=[],p=null,m=null,T=null,d=null,E=c.FIELD_NAME_REGEX,g=null,I,h,w=null,D=0,_=0,C,v,F,O,U,S,y,L,N,A,M,V=[],R,x,z,B,Q;if(r){C=r.dateSettings;v=r.useContainsAsDefault;F=r.stringFields;O=r.timeFields;y=r.dateTimeOffsetValueFields;V=r.viewMetadataData||[];L=r.dateTimeOffsetWithTimeZone}if(e){if(o){_=e.length;while(_--){S=false;N=false;d=e[_];A=this._getTimezone(L,d);M=c._getFieldMetadata(V,d);if(M&&M.isCustomFilterField){continue}if(M){B=M.isConstant;Q=M.isInitialValueSignificant}if(d&&d!==c.BASIC_SEARCH_FIELD_ID){w=null;U=false;if(v&&F){if(F.indexOf(d)>-1){U=true}}else if(O&&O.indexOf(d)>-1){S=true}else if(y&&y.indexOf(d)>-1){N=true}g=o[d];d=d.replace(E,"/");if(g&&g.hasOwnProperty("low")){if(g.low&&g.high){I=g.low;h=g.high;if(!N&&C&&C.UTC&&I instanceof Date&&h instanceof Date){I=n.localToUtc(I);h=n.localToUtc(h)}I=c.adaptTime(I,M);h=c.adaptTime(h,M);f.push(new t(d,a.BT,I,h))}else if(g.low){if(g.low instanceof Date){I=g.low;if(!N&&C&&C.UTC){I=n.localToUtc(I)}I=c.adaptTime(I,M);f.push(new t(d,a.EQ,I))}else if(typeof g.low==="string"){if(N&&M){w=l.parseDateTimeOffsetInterval(g.low);w[0]=M.ui5Type.parseValue(w[0],"string");if(w.length===2){w[1]=M.ui5Type.parseValue(w[1],"string")}}else{w=l.parseFilterNumericIntervalData(g.low)}if(w&&w.length===2){g[0]=c.adaptTime(g[0],M);g[1]=c.adaptTime(g[1],M);f.push(new t(d,a.BT,w[0],w[1]))}else if(w&&w.length===1){g[0]=c.adaptTime(g[0],M);f.push(new t(d,a.EQ,w[0]))}else{f.push(new t(d,U?a.Contains:a.EQ,g.low))}}}}else if(g&&g.hasOwnProperty("items")){p=[];T=[];m=null;if(g&&g.hasOwnProperty("ranges")){w=g.ranges;D=w.length;while(D--){R=w[D];I=R.value1;h=R.value2;if(S){if(I instanceof Date){I=l.getEdmTimeFromDate(I)}if(h instanceof Date){h=l.getEdmTimeFromDate(h)}}else if(M&&M.isCalendarDate){if(I instanceof Date){I=M.ui5Type.parseValue(I)}if(h instanceof Date){h=M.ui5Type.parseValue(h)}}else if(!N&&C&&C.UTC){if(I instanceof Date){I=n.localToUtc(I)}if(h instanceof Date){h=n.localToUtc(h)}}else if(N&&A){if(I){I=n.toTimezone(I,A);if(c.UI_TIMEZONE!==c.INTL_TIMEZONE){I=i.getInstance(I)}I=n.localToUtc(I)}if(h){h=n.toTimezone(h,A);if(c.UI_TIMEZONE!==c.INTL_TIMEZONE){h=i.getInstance(h)}h=n.localToUtc(h)}}else if(N&&!A){if(I){if(C&&C.UTC){I=n.uiTimezoneToUtc(I);I=n.localToUtc(I)}else{I=n.toTimezone(I,c.INTL_TIMEZONE)}}if(h){if(C&&C.UTC){h=n.uiTimezoneToUtc(h);h=n.localToUtc(h)}else{h=n.toTimezone(h,c.INTL_TIMEZONE)}}}I=c.adaptTime(I,M);h=c.adaptTime(h,M);x=R.exclude?T:p;if(R.operation===u.Empty){if(M&&["Edm.DateTime","Edm.DateTimeOffset"].indexOf(M.type)>-1){x.push(new t(d,R.exclude?a.NE:a.EQ,null))}else{x.push(c._getStringEmptyFilter(d,M,R.exclude))}}else{if(R.operation!==a.BT&&R.operation!==a.NB){h=undefined}z=R.exclude?s.getTransformedExcludeOperation(R.operation):R.operation;x.push(new t(d,z,I,h))}}if(T.length){m=new t(T,true)}}w=g.items;D=w.length;while(D--){p.push(new t(d,a.EQ,w[D].key))}if(g.value||g.value===0||g.value===false){if(typeof g.value==="string"){g.value=g.value.trim()}p.push(new t(d,U?a.Contains:a.EQ,g.value))}else if(g.value===""&&B&&Q){p.push(new t(d,U?a.Contains:a.EQ,g.value))}if(p.length){if(m){f.push(new t([new t(p,false),m],true))}else{f.push(new t(p,false))}}else if(m){f.push(m)}}else if(M&&M.control&&M.control.isA("sap.m.ComboBox")&&this.isValueSignificant(M)){if(g===null&&M.control.getSelectedKey()===""){g=""}if(M.control.getSelectedItem()){g=c.adaptTime(g,M);f.push(new t(d,U?a.Contains:a.EQ,g))}}else if(g||g===0||g===false){if(typeof g==="string"){g=g.trim()}if(g&&g instanceof Date){if(S){g=l.getEdmTimeFromDate(g)}else if(!N&&C&&C.UTC){g=n.localToUtc(g)}}if(g||g===0||g===false){g=c.adaptTime(g,M);f.push(new t(d,U?a.Contains:a.EQ,g))}}else if(g===""&&B&&Q){f.push(new t(d,U?a.Contains:a.EQ,g))}}}}}return f.length>1?[new t(f,true)]:f};c.isValueSignificant=function(e){var i=e["com.sap.vocabularies.Common.v1.ValueList"]&&e["com.sap.vocabularies.Common.v1.ValueList"].Parameters,t;if(i){t=i.find(function(e){return e.hasOwnProperty("InitialValueIsSignificant")})}if(t&&t["InitialValueIsSignificant"]){return t["InitialValueIsSignificant"].Bool.toLocaleLowerCase()==="true"}return false};return c});
/*!
 * SAPUI5
 * (c) Copyright 2009-2023 SAP SE. All rights reserved.
 */
sap.ui.predefine("sap/ui/comp/smartfilterbar/GroupConfiguration", ["sap/ui/comp/library","sap/ui/core/Element"],function(e,t){"use strict";var r=t.extend("sap.ui.comp.smartfilterbar.GroupConfiguration",{metadata:{library:"sap.ui.comp",properties:{key:{type:"string",group:"Misc",defaultValue:null},index:{type:"any",group:"Misc",defaultValue:undefined},label:{type:"any",group:"Misc",defaultValue:undefined}},events:{change:{parameters:{propertyName:{type:"string"}}}}}});r.prototype.setLabel=function(e){this.setProperty("label",e);this.fireChange({propertyName:"label"});return this};return r});
/*!
 * SAPUI5
 * (c) Copyright 2009-2023 SAP SE. All rights reserved.
 */
sap.ui.predefine("sap/ui/comp/smartfilterbar/SFBMultiComboBox", ["sap/m/MultiComboBox","sap/m/MultiComboBoxRenderer","sap/ui/comp/util/ComboBoxUtils","sap/m/inputUtils/ListHelpers"],function(e,t,r,i){"use strict";var o=i.CSS_CLASS+"Token";var n=e.extend("sap.ui.comp.smartfilterbar.SFBMultiComboBox",{metadata:{library:"sap.ui.comp",interfaces:["sap.ui.comp.IDropDownTextArrangement"],properties:{textArrangement:{type:"string",group:"Misc",defaultValue:""}}},renderer:t});n.prototype.onBeforeRendering=function(){e.prototype.onBeforeRendering.apply(this,arguments);this._parseCurrentValue();this._processTextArrangement()};n.prototype._processTextArrangement=function(){var e,t,i,n,s,a=this.getSelectedKeys(),p=this.getTextArrangement();if(!p||a.length===0){return}for(e=0;e<a.length;e++){i=a[e];n=this.getItemByKey(""+i);s=r.formatDisplayBehaviour(n,p);if(s){t=n.data(o);if(t&&t.isA("sap.m.Token")){t.setText(s)}}}};n.prototype._parseCurrentValue=function(){var e=this.getValue();if(e){this.addSelectedKeys([e]);this.setValue("")}};n.prototype.useHighlightItemsWithContains=function(){return true};return n});
/*!
 * SAPUI5
 * (c) Copyright 2009-2023 SAP SE. All rights reserved.
 */
sap.ui.predefine("sap/ui/comp/smartfilterbar/SFBMultiInput", ["sap/m/MultiInput","sap/m/MultiInputRenderer","sap/base/strings/whitespaceReplacer"],function(t,e,i){"use strict";var n=t.extend("sap.ui.comp.smartfilterbar.SFBMultiInput",{metadata:{library:"sap.ui.comp"},renderer:e});n.prototype.setTokens=function(e){e.map(function(t){return t.setText(i(t.getText()))});t.prototype.setTokens.apply(this,arguments);this._pendingAutoTokenGeneration=true;this._getFilterProvider()._tokenUpdate({control:this,fieldViewMetadata:this._getFieldViewMetadata()});this._pendingAutoTokenGeneration=false;this._isOninputTriggered=false};n.prototype._setFilterProvider=function(t){this.oFilterProvider=t};n.prototype._getFilterProvider=function(){return this.oFilterProvider};n.prototype._setFieldViewMetadata=function(t){this.oFieldViewMetadata=t};n.prototype._getFieldViewMetadata=function(){return this.oFieldViewMetadata};n.prototype.oninput=function(){t.prototype.oninput.apply(this,arguments);this._isOninputTriggered=true};n.prototype.addToken=function(){t.prototype.addToken.apply(this,arguments);this._isOninputTriggered=false;return this};n.prototype.insertToken=function(){t.prototype.insertToken.apply(this,arguments);this._isOninputTriggered=false;return this};n.prototype.onBeforeRendering=function(){t.prototype.onBeforeRendering.apply(this,arguments);if(!this._isOninputTriggered&&this.getValue()){this._pendingAutoTokenGeneration=true;this._validateCurrentText(true);this._pendingAutoTokenGeneration=false}};return n});
/*!
 * SAPUI5
 * (c) Copyright 2009-2023 SAP SE. All rights reserved.
 */
sap.ui.predefine("sap/ui/comp/smartfilterbar/SelectOption", ["sap/ui/comp/library","sap/ui/core/Element","sap/ui/model/FilterOperator"],function(e,t,r){"use strict";var i=t.extend("sap.ui.comp.smartfilterbar.SelectOption",{metadata:{library:"sap.ui.comp",properties:{sign:{type:"sap.ui.comp.smartfilterbar.SelectOptionSign",group:"Misc",defaultValue:"I"},operator:{type:"sap.ui.model.FilterOperator",group:"Misc",defaultValue:"EQ"},low:{type:"string",group:"Misc",defaultValue:null},high:{type:"string",group:"Misc",defaultValue:null}}}});i.SIGN=e.smartfilterbar.SelectOptionSign;i.OPERATOR=r;return i});
/*!
 * SAPUI5
 * (c) Copyright 2009-2023 SAP SE. All rights reserved.
 */
sap.ui.predefine("sap/ui/comp/smartfilterbar/SmartFilterBar", ["sap/m/MessageBox","sap/ui/comp/util/DateTimeUtil","sap/ui/base/ManagedObjectObserver","sap/ui/comp/filterbar/FilterBar","sap/ui/comp/smartfilterbar/SmartFilterBarFilterGroupItem","sap/ui/comp/filterbar/FilterItem","sap/ui/comp/library","./AdditionalConfigurationHelper","./ControlConfiguration","./FilterProvider","sap/ui/comp/smartfilterbar/FilterProviderUtils","./GroupConfiguration","sap/ui/comp/util/FormatUtil","sap/ui/comp/smartvariants/PersonalizableInfo","sap/ui/comp/smartvariants/SmartVariantManagement","sap/ui/comp/odata/ODataModelUtil","sap/ui/core/library","sap/ui/core/date/UI5Date","sap/ui/comp/variants/VariantItem","sap/ui/model/odata/AnnotationHelper","sap/ui/model/Context","sap/ui/comp/filterbar/VariantConverterFrom","sap/base/Log","sap/base/util/merge","sap/ui/Device","sap/ui/performance/trace/FESRHelper","sap/ui/comp/rules/RulesLog","sap/ui/comp/odata/MetadataAnalyser"],function(e,t,i,r,a,n,o,s,l,d,u,h,f,p,c,g,_,m,y,F,S,v,V,b,C,P,A,M){"use strict";var I=_.ValueState;var T=o.smartfilterbar.FilterType;var E=o.ANALYTICAL_PARAMETER_PREFIX;var B=r.extend("sap.ui.comp.smartfilterbar.SmartFilterBar",{metadata:{library:"sap.ui.comp",designtime:"sap/ui/comp/designtime/smartfilterbar/SmartFilterBar.designtime",properties:{entityType:{type:"string",group:"Misc",defaultValue:null,deprecated:true},entitySet:{type:"string",group:"Misc",defaultValue:null},resourceUri:{type:"string",group:"Misc",defaultValue:null},basicSearchFieldName:{type:"string",group:"Misc",defaultValue:null},enableBasicSearch:{type:"boolean",group:"Misc",defaultValue:false},liveMode:{type:"boolean",group:"Misc",defaultValue:false},showMessages:{type:"boolean",group:"Misc",defaultValue:false},considerAnalyticalParameters:{type:"boolean",group:"Misc",defaultValue:false},useDateRangeType:{type:"boolean",group:"Misc",defaultValue:null},suppressSelection:{type:"boolean",group:"Misc",defaultValue:false},considerSelectionVariants:{type:"boolean",group:"Misc",defaultValue:false},defaultSelectionVariantName:{type:"string",group:"Misc",defaultValue:null},useProvidedNavigationProperties:{type:"boolean",group:"Misc",defaultValue:false},navigationProperties:{type:"string",group:"Misc",defaultValue:""}},associations:{smartVariant:{type:"sap.ui.comp.smartvariants.SmartVariantManagement",multiple:false}},aggregations:{controlConfiguration:{type:"sap.ui.comp.smartfilterbar.ControlConfiguration",multiple:true,singularName:"controlConfiguration"},groupConfiguration:{type:"sap.ui.comp.smartfilterbar.GroupConfiguration",multiple:true,singularName:"groupConfiguration"}},events:{pendingChange:{parameters:{pendingValue:{type:"boolean"}}}}},renderer:{apiVersion:2}});B.LIVE_MODE_INTERVAL=300;B.SELECTION_VARIANT_KEY_PREFIX="#";B.prototype.init=function(){if(!d){d=sap.ui.require("sap/ui/comp/smartfilterbar/FilterProvider")}this._oResourceBundle=sap.ui.getCore().getLibraryResourceBundle("sap.ui.comp");this._bCreateFilterProviderCalled=false;this._aFilterBarViewMetadata=null;this._oFilterBarViewMetadataExtend=null;this._bSetFilterDataSuspended=false;this._oStoredFilterData={};this._oObservers=[];r.prototype.init.apply(this);sap.ui.getCore().getMessageManager().registerObject(this,true);this.getMetadata().addPublicMethods(["suspendSelection","resumeSelection"]);this._oRulesLog=new A};B.prototype._applyFESRSemantic=function(e,t,i){if(!e||!t){return}if(!i){i="press"}t=t.slice(0,20);P.setSemanticStepname(e,i,t)};B.prototype.onBeforeRendering=function(){this._applyFESRSemantic(this._oSearchButton,"sc:sfbGo");this._applyFESRSemantic(this._oHideShowButton,"sc:sfbShowHideToggle");this._applyFESRSemantic(this._oClearButtonOnFB,"sc:sfbClear");this._applyFESRSemantic(this._oRestoreButtonOnFB,"sc:sfbRestore");this._applyFESRSemantic(this._oFiltersButton,"sc:sfbAdaptFilters");r.prototype.onBeforeRendering.apply(this,arguments)};B.prototype._initializeMetadata=function(){if(!this.bIsInitialised){g.handleModelInit(this,this._onMetadataInitialised,!this.getIsRunningInValueHelpDialog())}};B.prototype._onMetadataInitialised=function(){var e,t,i,r;this._bMetaModelLoadAttached=false;if(!this.bIsInitialised&&!this._bCreateFilterProviderCalled){t=this.getModel();e=this.getResourceUri();i=this.getEntityType();r=this.getEntitySet();if((t||e)&&(i||r)){this._bCreateFilterProviderCalled=true;this._createFilterProvider(t,e,i,r).then(function(e){if(!e){return}if(this.bIsDestroyed){e.destroy();return}this._oFilterProvider=e;this._aFilterBarViewMetadata=e.getFilterBarViewMetadata();this._aAnalyticalFilterBarViewMetadata=e.getAnalyticParameters();this._oFilterBarViewMetadataExtend=e._getFilterBarViewMetadataExtend();if(this._aFilterBarViewMetadata){this._attachAdditionalConfigurationChanged();this.bIsInitialised=true;this.setModel(e.oModel,e.sFilterModelName);this.registerGetFiltersWithValues(this.getFiltersWithValues.bind(this));this.registerFetchData(function(e){return this.getFilterDataAsStringForVariant(true,e)}.bind(this));this.registerApplyData(function(e,t){this.setFilterDataAsStringFromVariant(e,true,t)}.bind(this));this._initializeVariantManagement()}e.attachPendingChange(function(e){this.firePendingChange({pendingValue:e.getParameter("pending")})}.bind(this))}.bind(this))}}};B.prototype._setInitialFocus=function(){var e=this.getAssociation("smartVariant")||this.getConsiderSelectionVariants(),t=this.getBasicSearchControl(),i=this.getAllFilterItems(true),r;if(!e){if(this.getEnableBasicSearch()){this._onAfterRenderingBasicSearchDelegate={onAfterRendering:function(){setTimeout(function(){t.focus();t.removeDelegate(this._onAfterRenderingBasicSearchDelegate)}.bind(this))}.bind(this)};t.addDelegate(this._onAfterRenderingBasicSearchDelegate,this)}else if(i.length>0){r=i[0]._getControl();this._onAfterRenderingFirstFilterVisibleFieldDelegate={onAfterRendering:function(){setTimeout(function(){r.focus();r.removeDelegate(this._onAfterRenderingFirstFilterVisibleFieldDelegate)}.bind(this))}.bind(this)};r.addDelegate(this._onAfterRenderingFirstFilterVisibleFieldDelegate,this)}}};B.prototype.getModelData=function(){return this._oFilterProvider?this._oFilterProvider.getModel().getData():null};B.prototype.getFilterContextUrl=function(){return this._oFilterProvider?this._oFilterProvider.getFilterContextUrl():null};B.prototype.getParameterContextUrl=function(){return this._oFilterProvider?this._oFilterProvider.getParameterContextUrl():null};B.prototype.getFilterBarViewMetadata=function(e){var t;if(this._aFilterBarViewMetadata===null){return[]}t=Object.assign({},this._aFilterBarViewMetadata);t=this._aFilterBarViewMetadata.map(function(t){var i=Object.assign({},t);if(e&&this._oFilterBarViewMetadataExtend!==null){i.fields=i.fields.map(function(e){var t,i=e.groupName,r=e.fullName,a=this._oFilterBarViewMetadataExtend[i]&&this._oFilterBarViewMetadataExtend[i][r];if(a!==undefined){t=Object.assign({},e,a)}else{t=Object.assign({},e)}return t}.bind(this))}return i}.bind(this));return t};B.prototype.getAnalyticalParameters=function(){return this._oFilterProvider?this._oFilterProvider.getAnalyticParameters():[]};B.prototype.getSelectionVariants=function(){var e=null;if(this._oFilterProvider){e=this._oFilterProvider.getSelectionVariants();if(Object.keys(e).length<1){e=null}}return e};B.prototype._createFilterProvider=function(e,t,i,r){return d._createFilterProvider({basicSearchFieldName:this.getBasicSearchFieldName(),enableBasicSearch:this.getEnableBasicSearch(),entityType:i,entitySet:r,serviceUrl:t,isRunningInValueHelpDialog:this.getIsRunningInValueHelpDialog(),model:e,additionalConfiguration:this.getAdditionalConfiguration(),defaultDropDownDisplayBehaviour:this.data("defaultDropDownDisplayBehaviour"),defaultTokenDisplayBehaviour:this.data("defaultTokenDisplayBehaviour"),defaultSingleFieldDisplayBehaviour:this.data("defaultSingleFieldDisplayBehaviour"),defaultFilterBarExpanded:this.data("defaultFilterBarExpanded"),defaultShowAllFilters:this.data("defaultShowAllFilters"),dateFormatSettings:this.data("dateFormatSettings"),calendarWeekSettings:this.data("calendarWeekSettings"),useContainsAsDefaultFilter:this.data("useContainsAsDefaultFilter"),smartFilter:this,filterBarClass:B,considerAnalyticalParameters:this.getConsiderAnalyticalParameters(),useDateRangeType:this.getUseDateRangeType(),considerSelectionVariants:this.getConsiderSelectionVariants(),considerNavigations:this.getUseProvidedNavigationProperties()?this._createArrayFromString(this.getNavigationProperties()):null,suppressValueListsAssociation:this.getSuppressValueListsAssociation()})};B.prototype._createArrayFromString=function(e){return!e?[]:e.split(",").filter(function(e){return e!==""?e.trim():false})};B.prototype._attachAdditionalConfigurationChanged=function(){var e,t,i,r;t=this.getGroupConfiguration();r=t.length;for(i=0;i<r;i++){t[i].attachChange(this._handleGroupConfigurationChanged.bind(this))}e=this.getControlConfiguration();r=e.length;for(i=0;i<r;i++){e[i].attachChange(this._handleControlConfigurationChanged.bind(this))}};B.prototype._handleControlConfigurationChanged=function(e){var t,i,r,a,n;t=e.getParameter("propertyName");i=e.oSource;if(!i){return}a=i.getKey();r=this._getFilterItemByName(a);if(!r){this._handleControlConfigurationChangedForDelayedFilterItems(a,i,t);return}if(t==="visible"){n=i.getVisible();r.setVisible(n)}else if(t==="label"){n=i.getLabel();r.setLabel(n)}else if(t==="visibleInAdvancedArea"){n=i.getVisibleInAdvancedArea();if(r.setVisibleInAdvancedArea){r.setVisibleInAdvancedArea(n)}}};B.prototype._handleControlConfigurationChangedForDelayedFilterItems=function(e,t,i){var r,a;if(this._aFilterBarViewMetadata){this._aFilterBarViewMetadata.some(function(t){t.fields.some(function(t){if(t.fieldName===e){a=t}return!!a});return!!a})}if(a){if(i==="visible"){r=t.getVisible();a.isVisible=r}else if(i==="label"){r=t.getLabel();a.label=r}else if(i==="visibleInAdvancedArea"){r=t.getVisibleInAdvancedArea();a.visibleInAdvancedArea=r}}};B.prototype._handleGroupConfigurationChanged=function(e){var t,i;t=e.getParameter("propertyName");i=e.oSource;if(t==="label"){this._handleGroupConfigurationLabelChanged(i)}};B.prototype._handleGroupConfigurationLabelChanged=function(e){var t,i,r;if(!e){return}r=e.getLabel();i=e.getKey();t=this._getFilterGroupItemByGroupName(i);if(t){t.setGroupTitle(r)}else{this._handleGroupConfigurationLabelChangedForDelayedFilterItems(i,r)}};B.prototype._handleGroupConfigurationLabelChangedForDelayedFilterItems=function(e,t){var i=null;if(this._aFilterBarViewMetadata){this._aFilterBarViewMetadata.some(function(t){if(t.groupName===e){i=t}return!!i})}if(i){i.groupLabel=t}};B.prototype._getFilterItemByName=function(e){return this.determineFilterItemByName(e)};B.prototype._getFilterGroupItemByGroupName=function(e){return this.determineFilterItemByName(e)};B.prototype.determineControlByFilterItem=function(e,t){V.warning("Using deprecated method: sap.ui.comp.smartfilterbar.SmartFilterBar#determinControlByFilterItem. Consider changing it with proper one.");return this._determineControlByFilterItem.apply(this,arguments)};B.prototype._determineControlByFilterItem=function(e,t){return r.prototype.determineControlByFilterItem.apply(this,arguments)};B.prototype.determineControlByName=function(e,t){V.warning("Using deprecated method: sap.ui.comp.smartfilterbar.SmartFilterBar#determineControlByName. Consider changing it with proper one.");return this._determineControlByName.apply(this,arguments)};B.prototype._determineControlByName=function(e,t){return r.prototype.determineControlByName.apply(this,arguments)};B.prototype.getAdditionalConfiguration=function(){return new s(this.getControlConfiguration(),this.getGroupConfiguration())};B.prototype.setEntityType=function(e){this.setProperty("entityType",e);this._initializeMetadata();return this};B.prototype.setEntitySet=function(e){this.setProperty("entitySet",e);this._initializeMetadata();return this};B.prototype.setResourceUri=function(e){this.setProperty("resourceUri",e);this._initializeMetadata();return this};B.prototype.propagateProperties=function(){r.prototype.propagateProperties.apply(this,arguments);this._initializeMetadata()};B.prototype._getFilterInformation=function(){var e=this.data("hiddenFields"),t,i,a,n=0,o=0,s,l=[],d;if(this._aFilterBarViewMetadata){n=this._aFilterBarViewMetadata.length;for(i=0;i<n;i++){t=this._aFilterBarViewMetadata[i];s=t.fields;o=s.length;for(a=0;a<o;a++){d=s[a];if(Array.isArray(e)&&e.indexOf(d.name)!==-1){continue}else if(d.name===u.BASIC_SEARCH_FIELD_ID){this.setBasicSearch(d.control);this._attachToBasicSearch(d.control);continue}else if(t.groupName===u.BASIC_FILTER_AREA_ID){this._createFieldInAdvancedArea({groupName:r.INTERNAL_GROUP,groupLabel:""},d)}else{this._createFieldInAdvancedArea(t,d)}l.push(d)}}var h=this.getAnalyticalParameters();n=h.length;for(i=0;i<n;i++){d=h[i];this._createAnalyticParameter(d);l.push(d)}}return l};B.prototype._validateState=function(){var e,t,i,r=false;e=this.getAllFilterItems(true);if(Array.isArray(e)){t=e.length;while(t--){i=this._determineControlByFilterItem(e[t],true);if(i){if(i.__bValidatingToken){this.bIsSearchPending=true;r=true;break}else if(i.getValueState&&i.getValueState()===I.Error&&!i.data("__mandatoryEmpty")){r=true;break}}}}if(this._oFilterProvider&&this._oFilterProvider._mConditionTypeFields){var a=Object.keys(this._oFilterProvider._mConditionTypeFields);for(var n=0;n<a.length;n++){var o=a[n];var s=this._oFilterProvider._mConditionTypeFields[o].conditionType;i=s&&s._oInput;if(i&&i.getValueState&&i.getValueState()===I.Error&&!i.data("__mandatoryEmpty")){r=true;break}}}if(this._oFilterProvider){return!r&&!this._oFilterProvider._validateConditionTypeFields()}else{return!r}};B.prototype._isDateRangeTypeFilter=function(e){return!!(this._oFilterProvider&&this._oFilterProvider._mConditionTypeFields[e])};B.prototype._specialControls=function(e,t){return!!(e.setValue&&(this._isDateRangeTypeFilter(t)||e.isA("sap.m.DatePicker")))};B.prototype._clearErroneusControlValues=function(){var e,t,i,r,a,n=null,o=false;e=this.getAllFilterItems(false);if(e){t=e.length;while(t--){i=this._determineControlByFilterItem(e[t],true);if(i){if(i.getValueState&&i.getValueState()===I.Error){r=i.getBinding("value");a=this._oFilterProvider.oModel;if(a){n=a.getProperty("/"+e[t].getName())}o=n!==null&&n!==undefined&&(n===i.getValue()||typeof n.hasOwnProperty==="function"&&n.hasOwnProperty("value")&&n.value===i.getValue());if(r&&!o&&!this._specialControls(i,e[t].getName())){r.checkUpdate(true)}else if(i.data("__validationError")){if(i.isA("sap.m.MultiInput")){i.setValueState(I.None);i.setValue("")}else if(i.isA("sap.m.Input")){i.setValueState(I.None);i.setValue(n);if(n!==null){i.fireChange({value:n,newValue:n})}}}else if(i.setValue){i.resetProperty("value");i.setValueState(I.None)}}}}}};B.prototype._attachToBasicSearch=function(e){if(e){e.attachSearch(function(e){if(e&&e.getParameter("clearButtonPressed")){return}if(!this.isDialogOpen()){this._searchFromFilterBar()}}.bind(this));e.attachChange(this._onChange.bind(this))}};B.prototype._onLiveChange=function(e){var t=e.getSource();if(t.data("__validationError")&&!t.getValue()){t.data("__validationError",null);t.setValueState(I.None);delete t.__sValidationText}};B.prototype._onChange=function(e){var t=e.getSource(),i=t._oFieldViewMetadata,r=this._oFilterProvider._oMetadataAnalyser,a=this._oFilterProvider._bUpdatingFilterData||this._oFilterProvider._bCreatingInitialModel;if(t.data("__mandatoryEmpty")){t.data("__mandatoryEmpty",null);t.setValueState(I.None)}if(t.data("__validationError")&&!t.getValue()){t.data("__validationError",null);t.setValueState(I.None)}if(t.isA("sap.m.ComboBox")&&t.getValue()){this._filterSetInErrorState(t);if(!t.getSelectedItem()){t.data("__validationError",true);t.setValueState(I.Error);if(!a){this.fireFilterChange(e)}return}if(t.data("__validationError")){t.data("__validationError",null);t.setValueState(I.None)}}if(i&&r&&r.getMultiUnitBehaviorEnabled()){if(i.isMeasureField){this._setWarningState(t)}if(M.isUnitOfMeasure(i)||M.isCurrencyCode(i)){this._clearWarningState(t)}}if(a){return}if(!t||t&&!t.__bValidatingToken){this.fireFilterChange(e);this._oFilterProvider._updateConditionTypeFields(e.getParameter("filterChangeReason"))}else{this._filterSetInErrorState(t)}if(this.isLiveMode()){if(e.getSource().isA("sap.m.MultiComboBox")||e.getSource().isA("sap.m.ComboBox")){this.triggerSearch()}else{this._searchFromFilterBar()}}};B.prototype._setWarningState=function(e){var t=e._oFieldViewMetadata,i=this._oFilterProvider&&this._oFilterProvider._getFieldMetadata(t.unit),r=i&&i.label,a=this._oResourceBundle.getText("UNIT_WARNING_TEXT",r),n=this._checkIfFilterHasValue(t.name),o=i&&this._checkIfFilterHasValue(i.name);if(!i||i.filterRestriction==="single"||M.isHidden(i)||M.isHiddenFilter(i)){return}if(!o&&n){setTimeout(function(){e.setValueState(I.Warning);e.setValueStateText(a)})}if(!n){e.setValueState(I.None)}};B.prototype._clearWarningState=function(e){var t=e._oFieldViewMetadata,i=t&&t.name,r=t&&t.label,a=this._oResourceBundle.getText("UNIT_WARNING_TEXT",r),n,o=this._checkIfFilterHasValue(t.name),s;if(t.filterRestriction==="single"){return}this._oFilterProvider.aAllFields.forEach(function(e){if(e.isCurrencyField&&e["Org.OData.Measures.V1.ISOCurrency"].Path===i||e.isMeasureField&&e["Org.OData.Measures.V1.Unit"]&&e["Org.OData.Measures.V1.Unit"].Path===i){n=this.getControlByKey(e.name);if(n){s=this._checkIfFilterHasValue(e.name);if(o&&n.getValueState()===I.Warning){n.setValueState(I.None)}if(!o&&s&&n.getValueState()===I.None){n.setValueState(I.Warning);n.setValueStateText(a)}}}}.bind(this))};B.prototype._handleChange=function(e){if(e){if(e.attachChange){e.attachChange(this._onChange.bind(this))}if(e.attachLiveChange){e.attachLiveChange(this._onLiveChange.bind(this))}}};B.prototype._handleSelectionChange=function(e){if(e){if(e.attachSelectionChange){e.attachSelectionChange(this._onChange.bind(this))}}};B.prototype._handleEnter=function(e){if(this.isLiveMode()){return}e.attachBrowserEvent("keydown",function(t){if(t.which===13){e.__bSuggestInProgress=e._oSuggestionPopup&&e._oSuggestionPopup.isOpen()}});e.attachBrowserEvent("keyup",function(t){if(t.which===13&&!e.__bSuggestInProgress&&(e.isA("sap.m.InputBase")||e.isA("sap.m.Select")||e.isA("sap.m.DynamicDateRange"))){this._searchFromFilterBar()}}.bind(this))};B.prototype._createFilterFieldControl=function(e){if(e.conditionType){e.control=e.conditionType.initializeFilterItem()}else if(!e.control&&e.fCreateControl){e.fCreateControl(e);delete e.fCreateControl}this._handleEnter(e.control);this._handleChange(e.control);if(e.isCustomFilterField&&e.control.isA("sap.m.MultiComboBox")){this._handleSelectionChange(e.control)}};B.prototype._createAnalyticParameter=function(e){e.factory=function(){this._createFilterFieldControl(e);if(!e.control){return}var t=new a({controlTooltip:e.quickInfo,name:e.fieldName,mandatory:e.isMandatory,visible:e.isVisible,control:e.control,hiddenFilter:false});this._setLabel(t,e.label);this._addParameter(t)}.bind(this);e.groupName=r.INTERNAL_GROUP;return e};B.prototype._createFieldInAdvancedArea=function(e,t){t.factory=function(){this._createFilterFieldControl(t);var i=new a({controlTooltip:t.quickInfo,name:t.fieldName,groupName:e.groupName,groupTitle:e.groupLabel,entitySetName:t.groupEntitySet,entityTypeName:t.groupEntityType,mandatory:t.isMandatory,visible:t.isVisible,visibleInAdvancedArea:t.visibleInAdvancedArea||e.groupName===r.INTERNAL_GROUP,control:t.control,hiddenFilter:t.hiddenFilter});if(t.isCustomFilterField){i.data("isCustomField",true);this._attachCustomControlCustomDataChange(i._getControl().getCustomData())}if(t.control&&t.control.getTooltip&&t.control.getTooltip()){i.setControlTooltip(t.control.getTooltip())}if(t.quickInfo){this._setLabelTooltip(i,t.quickInfo)}this._setLabel(i,t.label);this.addFilterGroupItem(i)}.bind(this);t.groupName=e.groupName;t.groupTitle=e.groupLabel;return t};B.prototype._setLabel=function(e,t){if(t.match(/{@i18n>.+}/gi)){e.bindProperty("label",t.substring(1,t.length-1))}else{e.setLabel(t)}};B.prototype._setLabelTooltip=function(e,t){var i=/{(@?i18n>.+)}/i.exec(t);if(i&&i[1]){e.bindProperty("labelTooltip",i[1])}else{e.setLabelTooltip(t)}};B.prototype._logAccessWhenNotInitialized=function(e){if(!this.bIsInitialised){V.error("SmartFilterBar."+e+": called before the SmartFilterBar is initialized")}};B.prototype.ensureLoadedValueHelp=function(e){this._logAccessWhenNotInitialized("ensureLoadedValueHelp");if(this._oFilterProvider){this._oFilterProvider.getAssociatedValueHelpProviders().some(function(t){if(t.sFieldName===e){this._ensureLoadedValueHelpList(t);return true}}.bind(this))}};B.prototype.ensureLoadedValueList=function(e){if(this._oFilterProvider){this._oFilterProvider.getAssociatedValueListProviders().some(function(t){if(t.sFieldName===e){this._ensureLoadedValueHelpList(t);return true}}.bind(this))}};B.prototype._ensureLoadedValueHelpList=function(e){if(!e._bValueListRequested){e.loadAnnotation()}};B.prototype._getValueListHelpProvider=function(e){var t=null;if(this._oFilterProvider){this._oFilterProvider.getAssociatedValueListProviders().some(function(i){if(i.sFieldName===e){t=i}return t!=null});if(!t){this._oFilterProvider.getAssociatedValueHelpProviders().some(function(i){if(i.sFieldName===e){t=i}return t!=null})}}return t};B.prototype.getDescriptionForKeys=function(e){var t=[];if(e){e.forEach(function(e){var i=this._getValueListHelpProvider(e.filterName);if(i){if(!i._bValueListRequested){i.loadAnnotation()}e.provider=i;t.push(e)}}.bind(this));if(t&&t.length>0){t.forEach(function(e){if(e.provider){e.provider.readData(e.keys)}})}}};B.prototype.ensureLoadedValueHelpList=function(e){this.ensureLoadedValueHelp(e);this.ensureLoadedValueList(e)};B.prototype.getFilters=function(e){this._logAccessWhenNotInitialized("getFilters");if(!e||!e.length){if(this.getIsRunningInValueHelpDialog()){e=this._getAllFieldNames()}else{e=this._getVisibleFieldNames(true)}}return this._oFilterProvider?this._oFilterProvider.getFilters(e):[]};B.prototype.getParameters=function(){this._logAccessWhenNotInitialized("getParameters");return this._oFilterProvider?this._oFilterProvider.getParameters():{}};B.prototype.getAnalyticBindingPath=function(){var e="";this._logAccessWhenNotInitialized("getAnalyticBindingPath");if(this._oFilterProvider){e=this._oFilterProvider.getAnalyticBindingPath()}return e};B.prototype.getParameterBindingPath=function(){return this.getAnalyticBindingPath()};B.prototype.getControlByKey=function(e){V.warning("Using deprecated method: sap.ui.comp.smartfilterbar.SmartFilterBar#getControlByKey. Consider changing it with proper one.");this._logAccessWhenNotInitialized("getControlByKey");if(this._oRulesLog){this._oRulesLog.setInvokedMethod("getControlByKey",true)}return this._determineControlByName(e)};B.prototype._getAllFieldNames=function(){var e,t=[],i,r,a;if(this._oFilterProvider&&this._oFilterProvider._oMetadataAnalyser){e=this._oFilterProvider._oMetadataAnalyser.getFieldsByEntitySetName(this.getEntitySet())}if(e){r=e.length;for(i=0;i<r;i++){a=e[i];if(a){t.push(a.name)}}}return t};B.prototype._getAllFilterAndParameterNames=function(e){var t=[],i=this.getAllFilterItems(false),r=i.length,a;while(r--){a=i[r];if(a){if(e&&a._isParameter()){continue}t.push(a.getName())}}return t};B.prototype._getVisibleFieldNames=function(e,t){var i=[],r=this.getAllFilterItems(true),a=r.length,n,o,s,l=false;if(t===undefined){t=true}while(a--){n=r[a];if(!n){continue}o=n._getControl&&n._getControl();s=n._isParameter()&&e;if(!t&&o&&o.getValueState&&o.getValueState()===I.Error){l=true}if(s||l){l=false;continue}i.push(n.getName())}return i};B.prototype._checkHasValueData=function(e){if(!e||e==="false"){return false}if(typeof e==="boolean"){return e}else if(typeof e==="string"&&e.toLowerCase()==="true"){return true}return false};B.prototype._checkForValues=function(e,t,i){var r,a=true,n=null,o;if(e&&t&&i){r=t.getName();if(!t.data("isCustomField")){n=e[r];if(!n&&i.getSelectedItem&&i.getSelectedItem()){o=u._getFieldMetadata(this._aFilterBarViewMetadata,r);if(o&&o.type==="Edm.Boolean"){if(i.getSelectedItem().getKey()===""){return false}}return true}if(!n&&i.getSelectedKey&&i.getSelectedKey()){return true}if(r.indexOf(E)===0&&Array.isArray(this._aAnalyticalFilterBarViewMetadata)){o=u._getAnalyticalFieldMetadata(this._aAnalyticalFilterBarViewMetadata,r)}else if(Array.isArray(this._aFilterBarViewMetadata)){o=u._getFieldMetadata(this._aFilterBarViewMetadata,r)}if(o&&o.hasValidation===false){a=o.hasValidation}if(n&&i.isA("sap.m.ComboBox")&&a&&!i.getItemByKey(n.toString())){return false}if(n===undefined){return false}}else{var s=i.data("hasValue");if(s!==undefined&&s!=null){return this._checkHasValueData(s)}else{if(i.getValue){if(i.getValue()){return true}}if(i.getSelectedItem&&i.getSelectedItem()){return true}if(i.getSelectedKey&&i.getSelectedKey()){return true}if(i.getSelectedKeys&&i.getSelectedKeys().length>0){return true}if(i.getTokens&&i.getTokens().length>0){return true}}}}return!!n};B.prototype.getFiltersWithValues=function(){this._logAccessWhenNotInitialized("getFiltersWithValues");return this._getFiltersWithAssignedValues(true)};B.prototype.getAllFiltersWithValues=function(){return this._getFiltersWithAssignedValues(false)};B.prototype._getFiltersWithAssignedValues=function(e){var t=[];var i=this.getAllFilterItems(e),r,a,n=0,o;if(e){r=this.getFilterData()}else if(this._oFilterProvider){r=this._bSetFilterDataSuspended?this._oStoredFilterData:this._oFilterProvider.getFilledFilterData(this._getAllFilterAndParameterNames())}if(i&&r){n=i.length;while(n--){a=i[n];o=this._determineControlByFilterItem(a,true);if(this._checkForValues(r,a,o)){t.push(a)}}}return t.reverse()};B.prototype._checkIfFilterHasValue=function(e,t){var i=t||this._oFilterProvider.getFilterData();var r=i[e]||i._CUSTOM&&i._CUSTOM[e];if(r===null||typeof r==="undefined"){return false}if(typeof r==="string"&&r){return true}if(typeof r==="number"){return true}if(typeof r==="object"&&Object.prototype.toString.call(r)==="[object Date]"){return true}if(typeof r==="object"&&(r.hasOwnProperty("low")||r.hasOwnProperty("high"))){return!!r.low||!!r.high}if(typeof r==="object"&&(r.hasOwnProperty("value")||r.hasOwnProperty("items")||r.hasOwnProperty("ranges"))){return!!r.value||r.items&&!!r.items.length||r.ranges&&!!r.ranges.length}return false};B.prototype._checkIfCustomControlFilterHasValue=function(e){if(!e.control){return false}return e.control.data("hasValue")};B.prototype._removeEmptyFilters=function(e){var t=JSON.parse(e);var i={};Object.keys(t).forEach(function(e){if(e==="_CUSTOM"||this._checkIfFilterHasValue(e)){i[e]=t[e]}}.bind(this));return JSON.stringify(i)};B.prototype._removeValuesForNonPartOfCurrentVariants=function(e){var t=[];if(this._oFilterProvider&&e&&e.length>0){var i=this._oFilterProvider.getFilterData();e.forEach(function(e){var r=e.getName();if(!e.data("isCustomField")){var a=this._oFilterProvider._getFieldMetadata(r);if(a.conditionType){t.push(a)}this._oFilterProvider._createInitialModelForField(i,a,false)}else if(i._CUSTOM&&i._CUSTOM[r]){delete i._CUSTOM[r]}},this);this.setFilterData(i);t.forEach(function(e){var t=e.fieldName;this._oFilterProvider._mConditionTypeFields[t].conditionType.initialize(i[t])},this)}};B.prototype.getFilterDataAsStringForVariant=function(e,t){var i={},r=this._oFilterProvider._aFilterBarDateTimeFieldNames;i=b(i,this.getFilterData(e));r.forEach(function(e){var t,r,a=u._getFieldMetadata(this._aFilterBarViewMetadata,e);if(a&&a.type==="Edm.DateTimeOffset"){r=i[e];if(r&&r.low){if(a.filterRestriction===T.interval){t=f.parseDateTimeOffsetInterval(r.low);if(t&&t.length===2){r.low=a.ui5Type.parseValue(t[0],"string");r.high=a.ui5Type.parseValue(t[1],"string")}}}}}.bind(this));this._oFilterProvider._aFilterBarDateFieldNames.concat(this._oFilterProvider._aFilterBarTimeFieldNames).forEach(function(e){var t,r=u._getFieldMetadata(this._aFilterBarViewMetadata,e);if(!r){r=this.getParameterMetadata(e)}if(r&&(r.filterType==="date"||r.filterType==="time")){t=i[e];var a=this._oFilterProvider._isSingleDynamicDateEnabled(r);if(t){var n=t.conditionTypeInfo;if(r.filterRestriction===T.multiple||r.filterRestriction===T.auto){this._processDateRanges(t.ranges)}else if(r.filterRestriction===T.single&&a){this._processDateRanges(t.ranges)}else if(r.filterRestriction===T.single){i[e]=this._dateConvert(t)}else if(r.filterRestriction===T.interval){if(t.ranges){this._processDateRanges(t.ranges)}else{if(t.low){t.low=this._dateConvert(t.low)}if(t.high){t.high=this._dateConvert(t.high)}}}if(n&&n.data){if(n.data.value1&&n.data.value1 instanceof Date){n.data.value1=this._dateConvert(n.data.value1)}if(n.data.value2&&n.data.value2 instanceof Date){n.data.value2=this._dateConvert(n.data.value2)}}}}}.bind(this));return JSON.stringify(i)};B.prototype._dateConvert=function(e){if(this.isInUTCMode()){if(typeof e==="string"){e=m.getInstance(e)}e=t.localToUtc(e).toJSON()}if(e.indexOf&&e.indexOf("Z")===e.length-1){e=e.substr(0,e.length-1)}return e};B.prototype._processDateRanges=function(e){if(!Array.isArray(e)){return}e.forEach(function(e){e.tokenText=null;if(e.value1){e.value1=this._dateConvert(e.value1)}if(e.value2){e.value2=this._dateConvert(e.value2)}}.bind(this))};B.prototype.getFilterData=function(e,t){if(this._bSetFilterDataSuspended){return Object.assign({},this._oStoredFilterData)}var i=this._oFilterProvider;this._logAccessWhenNotInitialized("getFilterData");if(!i){return null}if(t===undefined){t=false}return e?i.getFilterData():i.getFilledFilterData(this._getVisibleFieldNames(false,t))};B.prototype.getFilterDataAsString=function(e){var t=this._oFilterProvider;this._logAccessWhenNotInitialized("getFilterDataAsString");if(!t){return null}return e?t.getFilterDataAsString():t.getFilledFilterDataAsString(this._getVisibleFieldNames(false,false))};B.prototype.getParameterMetadata=function(e){var t=null,i=this.getAnalyticalParameters();if(e.indexOf(o.ANALYTICAL_PARAMETER_PREFIX)===0){e=e.substring(o.ANALYTICAL_PARAMETER_PREFIX.length)}if(Array.isArray(i)){i.some(function(i){if(i.name===e){t=i}return t!==null})}return t};B.prototype.setFilterDataAsStringFromVariant=function(e,t,i){var r,a=this._oFilterProvider._aFilterBarDateTimeFieldNames;if(e){r=JSON.parse(e);a.forEach(function(e){var t,i=u._getFieldMetadata(this._aFilterBarViewMetadata,e);if(i&&i.type==="Edm.DateTimeOffset"){t=r[e];if(t&&(i.filterRestriction===T.multiple||i.filterRestriction===T.auto)){if(t.ranges){for(var a=0;a<t.ranges.length;a++){delete t.ranges[a].tokenText}}}}}.bind(this));this._oFilterProvider._aFilterBarDateFieldNames.concat(this._oFilterProvider._aFilterBarTimeFieldNames).forEach(function(e){var t,i=u._getFieldMetadata(this._aFilterBarViewMetadata,e);if(!i){i=this.getParameterMetadata(e)}if(i&&(i.filterType==="date"||i.filterType==="time")){t=r[e];if(t){if(t.ranges){for(var a=0;a<t.ranges.length;a++){delete t.ranges[a].tokenText}}}}}.bind(this));this.setFilterData(r,t)}};B.prototype.setFilterData=function(e,t){if(this._bSetFilterDataSuspended){if(t){this._oStoredFilterData=e}else{this._oStoredFilterData=Object.assign({},this._oStoredFilterData,e)}return}this._setFilterData(e,t)};B.prototype.suspendSetFilterData=function(){this._bSetFilterDataSuspended=true};B.prototype.resumeSetFilterData=function(){if(this._bSetFilterDataSuspended){this._bSetFilterDataSuspended=false;this.setFilterData(this._oStoredFilterData,true);this._oStoredFilterData={}}};B.prototype._setFilterData=function(e,t){var i;this._logAccessWhenNotInitialized("setFilterData");if(e){Object.keys(e).forEach(function(t){i=this._getFilterMetadata(t);if(i&&this._checkIfFilterHasValue(t,e)){this._instanciateFilterItem(i)}}.bind(this))}if(this._oFilterProvider){this._oFilterProvider.setFilterData(e,t)}if(e&&Object.keys(e).length===1&&e._CUSTOM){return}this.fireFilterChange({afterFilterDataUpdate:true})};B.prototype.setFilterDataAsString=function(e,t){if(e){this.setFilterData(JSON.parse(e),t)}};B.prototype._isFilterBarContext=function(){return false};B.prototype.fireClear=function(){this._clearFilterFields();this.fireEvent("clear",arguments)};B.prototype._clearFilterFields=function(){if(this._oFilterProvider){this._oFilterProvider.clear();this._clearErroneusControlValues()}this.fireFilterChange({afterFilterDataUpdate:true})};B.prototype.fireReset=function(){this._resetFilterFields();this.fireEvent("reset",arguments)};B.prototype._resetFilterFields=function(){if(this._oFilterProvider){this._oFilterProvider.reset();this._clearErroneusControlValues()}this.fireFilterChange({afterFilterDataUpdate:true})};B.prototype._suspendedTriggerSearch=function(e){if(this.getSuppressSelection()){return}this._oSuspendedTriggerSearch={delay:e};return true};B.prototype._regularTriggerSearch=function(e){if(this.getSuppressSelection()){return}this._clearDelayedSearch();this._iDelayedSearchId=setTimeout(function(){var e=this._getVisibleControlsLoadingPromises();if(!this._bSearchTriggeredOnce&&e.length){Promise.all(e).then(this._search.bind(this)).catch(this._search.bind(this))}else{this._search()}}.bind(this),e||0)};B.prototype.suspendSelection=function(){this.triggerSearch=this._suspendedTriggerSearch};B.prototype.resumeSelection=function(){this.triggerSearch=this._regularTriggerSearch;if(this._oSuspendedTriggerSearch){this.triggerSearch(this._oSuspendedTriggerSearch.delay);this._oSuspendedTriggerSearch=undefined}};B.prototype.triggerSearch=B.prototype._regularTriggerSearch;B.prototype._getVisibleControlsLoadingPromises=function(){var e=[];this.determineMandatoryFilterItems().forEach(function(t){var r=t._getControl();if(r&&!t.data("isCustomField")&&r.isA("sap.m.ComboBox")&&!r.getItems().length){e.push(new Promise(function(e){var t=r.getBinding("items"),a;if(t){t.attachEventOnce("dataReceived",e);return}a=new i(function(t){if(t&&t.mutation==="ready"){r.getBinding("items").attachEventOnce("dataReceived",e);a.unobserve(r,{bindings:["items"]})}});a.observe(r,{bindings:["items"]});this._oObservers.push(a)}.bind(this)))}}.bind(this));return e};B.prototype.search=function(e){if(this.getSuppressSelection()){return undefined}this._logAccessWhenNotInitialized("search");if(e&&!this.isLiveMode()){return this._search()}this.triggerSearch(0);return true};B.prototype._search=function(){var t=true,i=false,r,a,n;this._bSearchTriggeredOnce=true;a=this.verifySearchAllowed();if(a.hasOwnProperty("pending")){if(this._iDelayedSearchId&&!this.getSuppressSelection()){this.triggerSearch()}return undefined}else if(a.hasOwnProperty("error")){t=false;i=true}else if(a.hasOwnProperty("mandatory")){t=false}if(this.isPending()&&!this._bIsPendingChangeAttached){n=function(e){if(e.getParameter("pendingValue")===false){this.detachPendingChange(n);this._bIsPendingChangeAttached=false;this.triggerSearch()}}.bind(this);this._bIsPendingChangeAttached=true;this.attachPendingChange(n);return undefined}this._clearDelayedSearch();if(t){if(this._isTablet()&&this.getUseToolbar()&&!this.getAdvancedMode()){this.setFilterBarExpanded(false)}this.fireSearch([{selectionSet:this._retrieveCurrentSelectionSet(false,true),firedFromFilterBar:this._bSearchFiredFromFilterBar}]);this._bSearchFiredFromFilterBar=false}else{if(!i){if(!this._sMandatoryErrorMessage){this._sMandatoryErrorMessage=this._oResourceBundle.getText("EMPTY_MANDATORY_MESSAGE")}r=this._sMandatoryErrorMessage}else{if(!this._sValidationErrorMessage){this._sValidationErrorMessage=this._oResourceBundle.getText("VALIDATION_ERROR_MESSAGE")}r=this._sValidationErrorMessage}if(this.getShowMessages()&&!this.getLiveMode()){try{e.error(r,{styleClass:this.$()&&this.$().closest(".sapUiSizeCompact").length?"sapUiSizeCompact":"",onClose:this._setFocusOnFirstErroneousField.bind(this)})}catch(e){return undefined}}else{this._setFocusOnFirstErroneousField();V.warning("search was not triggered. "+r);if(C.system.desktop){this.setFilterBarExpanded(true)}}if(this._bExpandAdvancedFilterArea&&this.rerenderFilters){this.rerenderFilters(true)}}return t};B.prototype.validateMandatoryFields=function(){this._logAccessWhenNotInitialized("validateMandatoryFields");return this._validateMandatoryFields()};B.prototype.verifySearchAllowed=function(){this._logAccessWhenNotInitialized("verifySearchAllowed");this.bIsSearchPending=false;if(this._validateState()){if(this.validateMandatoryFields()){return{}}return{mandatory:true}}if(this.bIsSearchPending){return{pending:true}}return{error:true}};B.prototype.checkSearchAllowed=function(){this._logAccessWhenNotInitialized("checkSearchAllowed");var e=false,t=null;this.bIsSearchPending=false;if(this._validateState()){t=this._checkMandatoryFields();if(!t.emptyMandatory&&!t.valueStateInError){e=true}}if(this.bIsSearchPending){e=false}return e};B.prototype._setFocusOnFirstErroneousField=function(){var e,t,i,r;e=this.getAllFilterItems(true);if(Array.isArray(e)){t=e.length;for(r=0;r<t;r++){i=this._determineControlByFilterItem(e[r],true);if(i&&i.getValueState&&i.getValueState()===I.Error){setTimeout(i["focus"].bind(i),0);break}}}};B.prototype.setLiveMode=function(e){if(!this._isPhone()){if(e){this.hideGoButton()}else{this.restoreGoButton()}}if(this._oSmartVariantManagement){if(e){if(this._bShowShareState===undefined){this._bShowShareState=this._oSmartVariantManagement.getShowExecuteOnSelection()}this._oSmartVariantManagement.setShowExecuteOnSelection(false)}else if(this._bShowShareState!==undefined){this._oSmartVariantManagement.setShowExecuteOnSelection(this._bShowShareState)}}return this.setProperty("liveMode",e)};B.prototype.isLiveMode=function(){return this._isPhone()?false:this.getLiveMode()};B.prototype._clearDelayedSearch=function(){if(this._iDelayedSearchId){clearTimeout(this._iDelayedSearchId);this._iDelayedSearchId=null}};B.prototype.isPending=function(){return!this._oFilterProvider?false:this._oFilterProvider.isPending()};B.prototype._validateMandatoryFields=function(){var e=true,t=this.determineMandatoryFilterItems(),i,r=this.getFilterData(false,true),a=0,n;this._bExpandAdvancedFilterArea=false;if(t&&r){a=t.length;while(a--){i=t[a];n=this._determineControlByFilterItem(i,true);if(n&&n.setValueState){if(this._checkForValues(r,i,n)){if(n.data("__mandatoryEmpty")){n.data("__mandatoryEmpty",null);n.setValueState(I.None)}}else{e=false;if(n.setValueStateText){if(i.getLabel&&i.getLabel()){n.setValueStateText(this._oResourceBundle.getText("MANDATORY_FIELD_WITH_LABEL_ERROR",[i.getLabel()]))}else{n.setValueStateText(this._oResourceBundle.getText("MANDATORY_FIELD_ERROR"))}}n.setValueState(I.Error);n.data("__mandatoryEmpty",true);if(i.getGroupName){this._bExpandAdvancedFilterArea=true}}}}}return e};B.prototype._checkMandatoryFields=function(){this._logAccessWhenNotInitialized("checkMandatoryFields");var e=false,t=false,i=this.determineMandatoryFilterItems(),r,a=this.getFilterData(),n=0,o;if(i&&a){n=i.length;while(n--){r=i[n];o=this._determineControlByFilterItem(r,true);if(o){if(!this._checkForValues(a,r,o)){e=true}if(o.getValueState&&o.getValueState()===I.Error){t=true}}}}return{emptyMandatory:e,valueStateInError:t}};B.prototype._setSmartVariant=function(e){var t;if(!e){return}t=sap.ui.getCore().byId(e);if(t){if(t.isA("sap.ui.comp.smartvariants.SmartVariantManagement")){if(this._oVariantManagement&&!this._oVariantManagement.isPageVariant()){this._replaceVariantManagement(t);this._oSmartVariantManagement=t}}else{V.error("Control with the id="+e+" not of expected type")}}else{V.error("Control with the id="+e+" not found")}};B.prototype.setSmartVariant=function(e){if(this.getAdvancedMode()){V.error("not supported for the advanced mode");return this}this.setAssociation("smartVariant",e);this._setSmartVariant(e);return this};B.prototype.getSmartVariant=function(){if(this.getAdvancedMode()){V.error("not supported for the advanced mode");return null}var e=this.getAssociation("smartVariant");if(e){return sap.ui.getCore().byId(e)}return this._oSmartVariantManagement};B.prototype._createVariantManagement=function(){if(this.getAdvancedMode()){return r.prototype._createVariantManagement.apply(this)}this._setSmartVariant(this.getSmartVariant());if(!this._oSmartVariantManagement){this._oSmartVariantManagement=new c(this.getId()+"-variant",{showExecuteOnSelection:true,showShare:true})}return this._oSmartVariantManagement};B.prototype._initializeVariantManagement=function(){if(!this.getIsRunningInValueHelpDialog()&&this._oSmartVariantManagement&&this.getPersistencyKey()){var e=new p({type:"filterBar",keyName:"persistencyKey",dataSource:this.getEntitySet()||this.getEntityType()});e.setControl(this);if(this.getConsiderSelectionVariants()&&!this._oSmartVariantManagement.isPageVariant()){this._oSmartVariantManagement._createMetadataPromise();this._prepareSelectionVariants();this._oSmartVariantManagement._resolveMetadataPromise()}this._oSmartVariantManagement.addPersonalizableControl(e);if(this._checkHasValueData(this.data("executeStandardVariantOnSelect"))){this._oSmartVariantManagement._executeOnSelectForStandardVariantByXML(true)}r.prototype._initializeVariantManagement.apply(this,arguments)}else{this.fireInitialise();this.fireInitialized()}};B.prototype.fireInitialized=function(){var e=this._getVisibleControlsLoadingPromises();if(e.length&&this.getDomRef()&&!this.getSuppressValueListsAssociation()){Promise.all(e).then(this._fireInitialized.bind(this)).catch(this._fireInitialized.bind(this))}else{this._fireInitialized()}};B.prototype._fireInitialized=function(){if(this.getConsiderSelectionVariants()&&this._oSmartVariantManagement&&!this._oSmartVariantManagement.isPageVariant()){if(this._oStandardSelectionVariant){this._oSmartVariantManagement._oStandardVariant=b({},this._defaultSelectionVariantHandling(this._oStandardSelectionVariant))}if(!this._oSmartVariantManagement._getDefaultVariantKey()){if(this.getDefaultSelectionVariantName()){var e=B.SELECTION_VARIANT_KEY_PREFIX+this.getDefaultSelectionVariantName();this._oSmartVariantManagement.setInitialSelectionKey(e);this._oSmartVariantManagement.fireSelect({key:e})}else if(this._oStandardSelectionVariant){this._oSmartVariantManagement.fireSelect({key:this._oSmartVariantManagement.STANDARDVARIANTKEY})}}this._oStandardSelectionVariant=null}r.prototype.fireInitialized.apply(this,arguments)};B.prototype._prepareSelectionVariants=function(){var e,t=B.SELECTION_VARIANT_KEY_PREFIX,i=[],r=this._oSmartVariantManagement;e=this.getSelectionVariants();if(e){var a={callback:this.getSelectionVariant,handler:this};e.forEach(function(e){var r=t+e.qualifier;if(e.qualifier){i.push({id:r,favorite:true,name:e.annotation.Text.String})}else{this._oStandardSelectionVariant=e}}.bind(this));if(i.length>0){a.variants=i;r.registerSelectionVariantHandler(a,t)}}};B.prototype._defaultSelectionVariantHandling=function(e){var t={},i=this._oSmartVariantManagement,r,a;if(!i||i._sAppStandardVariantKey||!(e&&e.annotation)){return t}t=this.convertSelectionVariantToInternalVariant(e.annotation);if(!t){return t}if(!i.isPageVariant()){t.version="V1";a=JSON.parse(t.filterBarVariant);if(i._oStandardVariant){r=JSON.parse(i._oStandardVariant.filterBarVariant);if(r._CUSTOM){a._CUSTOM=r._CUSTOM;t.filterBarVariant=JSON.stringify(a)}}}return t};B.prototype._adaptFilterVisibilityProperties=function(e){var t,i=[];if(this._oSmartVariantManagement&&this._oSmartVariantManagement._oStandardVariant&&this._oSmartVariantManagement._oStandardVariant.filterbar){b(i,this._oSmartVariantManagement._oStandardVariant.filterbar)}Object.keys(e).forEach(function(e){t=false;i.some(function(i){if(i.name===e){t=true;i.partOfCurrentVariant=true}return t});if(!t){i.push({group:this._determineGroupNameByName(e),name:e,partOfCurrentVariant:true,visibleInFilterBar:false,visible:true})}}.bind(this));return i};B.prototype.getSelectionVariant=function(e){var t=null,i=null,r=e.substring(B.SELECTION_VARIANT_KEY_PREFIX.length);this.getSelectionVariants().some(function(e){if(e.qualifier===r){i=e;return true}return false});if(i){if(i.variantContent){t=i.variantContent}else{t=this.convertSelectionVariantToInternalVariant(i.annotation);i.variantContent=t}}return t};B.prototype.convertSelectionVariantToInternalVariant=function(e){var t=JSON.parse(JSON.stringify(e)),i,r,a,n=t.SelectOptions,o=t.Parameters,s;if(n||o){a=new S(null,"/")}if(n){n.forEach(function(e){e.PropertyName=e.PropertyName.PropertyPath;e.Ranges.forEach(function(e){e.Sign=e.Sign.EnumMember.split("/")[1];e.Option=e.Option.EnumMember.split("/")[1];e.Low=e.Low&&F.format(a,e.Low)||null;e.High=e.High&&F.format(a,e.High)||null})})}if(o){o.forEach(function(e){e.PropertyName=e.PropertyName.PropertyPath.split("/")[1]||e.PropertyName.PropertyPath;e.PropertyValue=F.format(a,e.PropertyValue)||null})}s=new v;i=s.convert(JSON.stringify(t),this,true);r=JSON.parse(i.payload);i={version:"V2",filterbar:this._adaptFilterVisibilityProperties(r),filterBarVariant:JSON.stringify(r)};return i};B.prototype.getBasicSearchControl=function(){return sap.ui.getCore().byId(this.getBasicSearch())};B.prototype.addFieldToAdvancedArea=function(e){var t;this._logAccessWhenNotInitialized("addFieldToAdvancedArea");t=this._getFilterItemByName(e);if(t&&t.setVisibleInAdvancedArea){t.setVisibleInAdvancedArea(true)}};B.prototype._onCustomFieldCustomDataChange=function(e){var t=e.getParameter("newValue"),i=e.getParameter("oldValue"),r=e.getParameter("name");if(i!==t&&r==="value"){this._updateToolbarText()}};B.prototype._attachCustomControlCustomDataChange=function(e){var t,i;for(i=0;i<e.length;i++){t=e[i];if(t.getKey()==="hasValue"){t.attachEvent("_change",this._onCustomFieldCustomDataChange,this);break}}};B.prototype.getConditionTypeByKey=function(e){if(this._oFilterProvider&&this._oFilterProvider._mConditionTypeFields[e]){return this._oFilterProvider._mConditionTypeFields[e].conditionType}if(this._oFilterProvider&&e.indexOf(E)===-1&&this._oFilterProvider._mConditionTypeFields[E+e]){return this._oFilterProvider._mConditionTypeFields[E+e].conditionType}};B.prototype.getDateRangeTypeByKey=function(e){return this.getInitializedPromise().then(function(){if(this._oFilterProvider._mConditionTypeFields[e]){return this._oFilterProvider._mConditionTypeFields[e].conditionType}if(e.indexOf(E)===-1&&this._oFilterProvider._mConditionTypeFields[E+e]){return this._oFilterProvider._mConditionTypeFields[E+e].conditionType}}.bind(this))};B.prototype.setDateRangeTypeOperationByKey=function(e,t){return this.getDateRangeTypeByKey(e).then(function(e){if(e&&typeof e.setOperation==="function"){e.setOperation(t)}})};B.prototype.isInUTCMode=function(){if(this._oFilterProvider&&this._oFilterProvider._oDateFormatSettings){return this._oFilterProvider._oDateFormatSettings.UTC}return false};B.prototype.isInitialised=function(){return!!this.bIsInitialised};B.prototype.associateValueLists=function(){if(this.getSuppressValueListsAssociation()&&this._oFilterProvider){this._oFilterProvider._fireEvent(u.ASSOCIATE_VALUE_LISTS);this._oFilterProvider._bSuppressValueListsAssociation=false;this._valueListAnnotationsLoaded();if(typeof this._enhanceFilterItemsWithTextOnValueListAssociation==="function"){this._enhanceFilterItemsWithTextOnValueListAssociation()}}};B.prototype._refreshFiltersCountOnValueListAnnotationLoaded=function(){for(var e=0;e<this._oFilterProvider._aFilterBarDropdownFieldMetadata.length;e++){var t=this._oFilterProvider._aFilterBarDropdownFieldMetadata[e].control;if(t&&t.isA("sap.m.ComboBox")){t.addEventDelegate({onAfterRendering:function(){this.refreshFiltersCount()}.bind(this)})}}};B.prototype._enhanceFilterItemsWithTextValue=function(e,t){if(!this._enhanceFilterItemsWithTextOnValueListAssociation&&this.getSuppressValueListsAssociation()){this._enhanceFilterItemsWithTextOnValueListAssociation=function(){var e=this.getUiState();r.prototype._enhanceFilterItemsWithTextValue.call(this,e.getValueTexts(),e.getSelectionVariant())}.bind(this)}else{r.prototype._enhanceFilterItemsWithTextValue.apply(this,arguments)}};B.prototype._createVisibleFilters=function(){r.prototype._createVisibleFilters.apply(this,arguments);if(!this.getSuppressValueListsAssociation()&&this._oFilterProvider){this._valueListAnnotationsLoaded()}if(!this.getIsRunningInValueHelpDialog()){this._setInitialFocus()}};B.prototype._valueListAnnotationsLoaded=function(){return this._fireValueListAnnotationLoaded().then(this._refreshFiltersCountOnValueListAnnotationLoaded.bind(this))};B.prototype._attachValueListAnnotationLoaded=function(e,t,i){this.attachEvent("valueListAnnotationLoaded",e,t,i)};B.prototype._fireValueListAnnotationLoaded=function(e){var t=this._oFilterProvider&&Array.isArray(this._oFilterProvider.aFilterAnnotations)?this._oFilterProvider.aFilterAnnotations:[];return Promise.all(t).then(function(){this.fireEvent("valueListAnnotationLoaded",e)}.bind(this))};B.prototype.getSuppressValueListsAssociation=function(){return false};B.prototype.setCustomFilterData=function(e){if(this._oFilterProvider&&this._oFilterProvider.getModel()){this._oFilterProvider.getModel().setProperty("/"+u.CUSTOM_FIELDS_MODEL_PROPERTY,e)}};B.prototype.getCustomFilterData=function(){if(this._oFilterProvider&&this._oFilterProvider.getModel()){return this._oFilterProvider.getModel().getProperty("/"+u.CUSTOM_FIELDS_MODEL_PROPERTY)}};B.prototype.refreshFiltersCount=function(){return Promise.all(this._oFilterProvider._getCurrentValidationPromises()).then(function(){return this._updateToolbarText()}.bind(this))};B.prototype.hasDateRangeTypeFieldsWithValue=function(){var e=this._oFilterProvider,t=this.getFilterData(),i=Object.keys(e._mConditionTypeFields).some(function(e){return!!t[e]});return this.getInitializedPromise().then(function(){return i})};B.prototype.destroy=function(){this._clearDelayedSearch();if(this._oFilterProvider&&this._oFilterProvider.destroy){this._oFilterProvider.destroy()}this._oFilterProvider=null;if(this._oSmartVariantManagement&&this.getConsiderSelectionVariants()){this._oSmartVariantManagement.unregisterSelectionVariantHandler(this)}r.prototype.destroy.apply(this,arguments);sap.ui.getCore().getMessageManager().unregisterObject(this);this._oObservers.forEach(function(e){e.disconnect();e.destroy()});this._aFilterBarViewMetadata=null;this._oFilterBarViewMetadataExtend=null;this._bExpandAdvancedFilterArea=null;this._oResourceBundle=null;this._sMandatoryErrorMessage=null;this._sValidationErrorMessage=null;this._oSmartVariantManagement=null;this._oRulesLog.destroy()};return B});
/*!
 * SAPUI5
 * (c) Copyright 2009-2023 SAP SE. All rights reserved.
 */
sap.ui.predefine("sap/ui/comp/smartfilterbar/SmartFilterBarFilterGroupItem", ["sap/ui/comp/filterbar/FilterGroupItem","sap/ui/comp/library","sap/base/Log"],function(t,r,e){"use strict";var o=t.extend("sap.ui.comp.smartfilterbar.SmartFilterBarFilterGroupItem",{metadata:{library:"sap.ui.comp"}});o.prototype.getControl=function(){e.warning("Using deprecated method: sap.ui.comp.smartfilterbar.SmartFilterBarFilterGroupItem#getControl. Use sap.ui.core.Core.byId instead.");return o.prototype._getControl.apply(this,arguments)};o.prototype._getControl=function(){return t.prototype.getControl.apply(this,arguments)};return o});
/*
 * SAPUI5
 * (c) Copyright 2009-2023 SAP SE. All rights reserved.
 */
sap.ui.predefine("sap/ui/comp/smartfilterbar/SortingUtil", [],function(){"use strict";var e={sortByIndex:function(e){var n,r,t,i;if(!e||!e.length){return e}r=[];n=[];for(var s=0;s<e.length;s++){i=e[s];t=i.index;if(t>=0){n.push(i)}else{r.push(i)}}if(n.length){n=n.sort(function(e,n){return e.index-n.index});if(!r.length){r=n}else{for(var f=0;f<n.length;f++){i=n[f];if(i.index>=r.length){r.push(i)}else{r.splice(i.index,0,i)}}}}return r},groupSorting:function(e){var n=[];n=this.sortByIndex(e);for(var r=0;r<n.length;r++){if(n[r].fields){n[r].fields=this.sortByIndex(n[r].fields)}}return n},destroy:function(){}};return e},true);
/*!
 * SAPUI5
 * (c) Copyright 2009-2023 SAP SE. All rights reserved.
 */
sap.ui.predefine("sap/ui/comp/smartform/ColumnLayout", ["sap/ui/comp/library","sap/ui/layout/library","sap/ui/core/Element"],function(a,e,u){"use strict";var p=u.extend("sap.ui.comp.smartform.ColumnLayout",{metadata:{interfaces:["sap.ui.comp.smartform.SmartFormLayout"],library:"sap.ui.comp",properties:{columnsXL:{type:"sap.ui.layout.form.ColumnsXL",group:"Appearance",defaultValue:2},columnsL:{type:"sap.ui.layout.form.ColumnsL",group:"Appearance",defaultValue:2},columnsM:{type:"sap.ui.layout.form.ColumnsM",group:"Appearance",defaultValue:1},labelCellsLarge:{type:"sap.ui.layout.form.ColumnCells",group:"Appearance",defaultValue:4},emptyCellsLarge:{type:"sap.ui.layout.form.EmptyCells",group:"Appearance",defaultValue:0}}}});return p});
/*!
 * SAPUI5
 * (c) Copyright 2009-2023 SAP SE. All rights reserved.
 */
sap.ui.predefine("sap/ui/comp/smartform/Group", ["sap/ui/comp/library","sap/ui/core/Element","sap/ui/layout/library","sap/ui/layout/form/FormContainer","sap/base/Log","sap/m/Label","sap/m/Button","sap/m/Text"],function(t,e,i,r,o,a,s,n){"use strict";var l;var u=r.extend("sap.ui.comp.smartform.Group",{metadata:{library:"sap.ui.comp",designtime:"sap/ui/comp/designtime/smartform/Group.designtime",properties:{useHorizontalLayout:{type:"boolean",group:"Misc",defaultValue:null,deprecated:true},horizontalLayoutGroupElementMinWidth:{type:"int",group:"Misc",defaultValue:null,deprecated:true},label:{type:"string",group:"Misc",defaultValue:null,deprecated:true}},defaultAggregation:"groupElements",aggregations:{groupElements:{type:"sap.ui.comp.IFormGroupElement",multiple:true,singularName:"groupElement"},layout:{type:"sap.ui.layout.GridData",multiple:false}},_bVisibleElements:false}});u.prototype.init=function(){r.prototype.init.apply(this,arguments);this._oObserver.observe(this,{properties:["useHorizontalLayout","horizontalLayoutGroupElementMinWidth","label"]})};function p(t){var e=this.getGroupElements();for(var i=0;i<e.length;i++){if(e[i].isA("sap.ui.comp.smartform.SemanticGroupElement")){o.error("useHorizontalLayout can't be used for SemanticGroupElement",this)}else if(e[i].getUseHorizontalLayout()!=t){e[i].setUseHorizontalLayout(t)}}this._updateLayoutData()}u.prototype._updateLayoutData=function(){if(this.getUseHorizontalLayout()){var t=this.getParent();while(t&&!t.addGroup&&t.getParent){t=t.getParent()}if(t){var e=t.getLayout();if(!e||!e.getGridDataSpan()){if(!this.getLayoutData()){if(!l&&!this._bResponsiveFlowLayoutDataRequested){l=sap.ui.require("sap/ui/layout/ResponsiveFlowLayoutData");if(!l){sap.ui.require(["sap/ui/layout/ResponsiveFlowLayoutData"],h.bind(this));this._bResponsiveFlowLayoutDataRequested=true}}if(l&&!this._bResponsiveFlowLayoutDataRequested){var i=new l({linebreak:true,linebreakable:true});i._bCreatedByGroup=true;this.setLayoutData(i)}}}else{this._updateLineBreaks()}}}else{var r=this.getLayoutData();if(r&&r._bCreatedByGroup){this.destroyLayoutData()}}};function h(t){l=t;this._bResponsiveFlowLayoutDataRequested=false;if(!this._bIsBeingDestroyed){this._updateLayoutData()}}function m(t){o.error("HorizontalLayoutGroupElementMinWidth is deprecated",this);var e=this.getGroupElements();for(var i=0;i<e.length;i++){e[i].setHorizontalLayoutGroupElementMinWidth(t)}}u.prototype.setEditMode=function(t){this._setEditable(t);return this};u.prototype._updateLineBreaks=function(){if(this.getUseHorizontalLayout&&!this.getUseHorizontalLayout()){return}var t=this.getParent();if(!t){return}while(t&&!t._getGridDataSpanNumbers&&t.getParent){t=t.getParent()}if(t&&!t._getGridDataSpanNumbers){return}var e=t&&t._getGridDataSpanNumbers();if(!e){return}var i=this.getGroupElements();i=i.filter(function(t){return t.isVisible()});var r=0;var o=0;var a=0;var s=0;var n=false;var l=false;var u=false;var p=false;for(var h=0;h<i.length;h++){var m=i[h];r++;o++;a++;s++;if(e.XL*r>12){n=true;r=1}else{n=false}if(e.L*o>12){l=true;o=1}else{l=false}if(e.M*a>12){u=true;a=1}else{u=false}if(e.S*s>12){p=true;s=1}else{p=false}m._setLinebreak(n,l,u,p)}};u.prototype._updateGridDataSpan=function(){if(this.getUseHorizontalLayout&&!this.getUseHorizontalLayout()){return}var t=this.getGroupElements();for(var e=0;e<t.length;e++){t[e]._updateGridDataSpan()}};u.prototype._updateFormContainerVisibility=function(){var t=this.getGroupElements();var e=false;e=t.some(function(t){return t.isVisible()});if(this._bVisibleElements!==e){this._bVisibleElements=e;if(this.isPropertyInitial("visible")){this.fireEvent("_visibleChanged")}}};function y(t){var e=this.getTitle();if(e&&typeof e!=="string"){o.error("Title already set, Label can not be set",this)}else{this.setTitle(t)}}u.prototype.setVisible=function(t){var e=this.getVisible();r.prototype.setVisible.apply(this,arguments);if(t!=e||t!=this._bVisibleElements){this.fireEvent("_visibleChanged")}return this};u.prototype.isVisible=function(){if(this.isPropertyInitial("visible")){return this._bVisibleElements}else{return this.getVisible()}};u.prototype.addGroupElement=function(t){return this.addFormElement(t)};u.prototype.insertGroupElement=function(t,e){return this.insertFormElement(t,e)};u.prototype.getGroupElements=function(){return this.getFormElements()};u.prototype.indexOfGroupElement=function(t){return this.indexOfFormElement(t)};u.prototype.removeGroupElement=function(t){return this.removeFormElement(t)};u.prototype.removeAllGroupElements=function(){return this.removeAllFormElements()};u.prototype.destroyGroupElements=function(){return this.destroyFormElements()};u.prototype.addFormElement=function(t){if(!t){return this}t=this.validateAggregation("groupElements",t,true);f.call(this,t);r.prototype.addFormElement.apply(this,arguments);d.call(this,t);return this};u.prototype.insertFormElement=function(t,e){if(!t){return this}t=this.validateAggregation("groupElements",t,true);f.call(this,t);r.prototype.insertFormElement.apply(this,arguments);d.call(this,t);return this};u.prototype.removeFormElement=function(t){var e=r.prototype.removeFormElement.apply(this,arguments);if(e){e.detachVisibleChanged(this._updateFormContainerVisibility,this);c.call(this,e);this._updateFormContainerVisibility();this._updateLineBreaks()}return e};u.prototype.removeAllFormElements=function(){var t=r.prototype.removeAllFormElements.apply(this,arguments);for(var e=0;e<t.length;e++){var i=t[e];i.detachVisibleChanged(this._updateFormContainerVisibility,this);c.call(this,i)}this._updateFormContainerVisibility();this._updateLineBreaks();return t};u.prototype.destroyFormElements=function(){r.prototype.destroyFormElements.apply(this,arguments);this._updateFormContainerVisibility();this._updateLineBreaks();return this};function f(t){var e,i;if(!t.isA("sap.ui.comp.smartform.SemanticGroupElement")){e=this.getUseHorizontalLayout();i=this.getHorizontalLayoutGroupElementMinWidth();if(i!=t.getHorizontalLayoutGroupElementMinWidth){t.setHorizontalLayoutGroupElementMinWidth(i)}if(e!=t.getUseHorizontalLayout()){t.setUseHorizontalLayout(e)}}t.attachVisibleChanged(this._updateFormContainerVisibility,this);g.call(this,t)}function d(t){this._updateFormContainerVisibility();if(this.getUseHorizontalLayout()&&this.getUseHorizontalLayout()){t._updateGridDataSpan();this._updateLineBreaks()}}u.prototype.setLayout=function(t){t=this.validateAggregation("layout",t,false);return this.setLayoutData(t)};u.prototype.getLayout=function(){return this.getLayoutData()};u.prototype.destroyLayout=function(t){return this.destroyLayoutData()};u.prototype.addCustomData=function(t){if(!t){return this}r.prototype.addCustomData.apply(this,arguments);var e=this.getGroupElements();for(var i=0;i<e.length;i++){v.call(this,e[i],t)}return this};u.prototype.insertCustomData=function(t,e){if(!t){return this}r.prototype.insertCustomData.apply(this,arguments);var i=this.getGroupElements();for(var o=0;o<i.length;o++){v.call(this,i[o],t)}return this};u.prototype.removeCustomData=function(t){var e=r.prototype.removeCustomData.apply(this,arguments);if(e){var i=this.getGroupElements();for(var o=0;o<i.length;o++){c.call(this,i[o],e.getId())}}return e};u.prototype.removeAllCustomData=function(){var t=r.prototype.removeAllCustomData.apply(this,arguments);if(t.length>0){var e=this.getGroupElements();for(var i=0;i<e.length;i++){c.call(this,e[i])}}return t};u.prototype.destroyCustomData=function(){r.prototype.destroyCustomData.apply(this,arguments);var t=this.getGroupElements();for(var e=0;e<t.length;e++){c.call(this,t[e])}return this};function g(t){var e=this.getCustomData();for(var i=0;i<e.length;i++){v.call(this,t,e[i])}}function v(e,i){if(t.smartform.inheritCostomDataToFields(i)){var r=i.clone();r._bFromGroup=true;r._sOriginalId=i.getId();e.addCustomData(r)}}function c(t,e){var i=t.getCustomData();for(var r=0;r<i.length;r++){var o=i[r];if(o._bFromGroup&&(!e||e==o._sOriginalId)){t.removeCustomData(o)}}}u.prototype.clone=function(t,e){var i=this.removeAllGroupElements();var o=r.prototype.clone.apply(this,arguments);for(var a=0;a<i.length;a++){var s=i[a];var n=s.clone(t,e);this.addGroupElement(s);o.addGroupElement(n)}return o};u.prototype._observeChanges=function(t){r.prototype._observeChanges.apply(this,arguments);if(t.name=="label"){y.call(this,t.current)}else if(t.name=="useHorizontalLayout"){p.call(this,t.current)}else if(t.name=="horizontalLayoutGroupElementMinWidth"){m.call(this,t.current)}};return u});
/*!
 * SAPUI5
 * (c) Copyright 2009-2023 SAP SE. All rights reserved.
 */
sap.ui.predefine("sap/ui/comp/smartform/GroupElement", ["sap/ui/comp/library","sap/ui/core/Element","sap/ui/core/Control","sap/ui/layout/form/FormElement","sap/m/Label","sap/m/Button","sap/m/Text","sap/ui/comp/smartfield/SmartLabel","sap/ui/comp/smartfield/SmartField","sap/base/Log"],function(e,t,i,a,l,s,r,o,n,u){"use strict";var f;var h;var p;var b;var d;var m=e.smartfield.ControlContextType;var g=a.extend("sap.ui.comp.smartform.GroupElement",{metadata:{library:"sap.ui.comp",interfaces:["sap.ui.comp.IFormGroupElement"],properties:{useHorizontalLayout:{type:"boolean",group:"Misc",defaultValue:null,deprecated:true},horizontalLayoutGroupElementMinWidth:{type:"int",group:"Misc",defaultValue:null,deprecated:true},elementForLabel:{type:"int",group:"Misc",defaultValue:0}},defaultAggregation:"elements",aggregations:{elements:{type:"sap.ui.core.Control",multiple:true,singularName:"element"}},events:{visibleChanged:{}},designtime:"sap/ui/comp/designtime/smartform/GroupElement.designtime"},_bVisibleElements:false,_bHorizontalLayoutUsed:false});g._myVBox=undefined;g.prototype.init=function(){a.prototype.init.apply(this,arguments);this._oObserver.observe(this,{properties:["useHorizontalLayout","horizontalLayoutGroupElementMinWidth","elementForLabel","_editable"]})};g.prototype._getFieldRelevantForLabel=function(){var e=this.getElements();var t=this.getElementForLabel();if(e.length>t&&e[t]instanceof n){return e[t]}return null};g.prototype._extractFields=function(e,t){var i=[];e.forEach(function(e){if(e instanceof f||e instanceof h){i=i.concat(e.getItems())}else{i.push(e)}});if(i.some(function(e){return e instanceof f||e instanceof h})){i=this._extractFields(i)}if(t){i=i.filter(function(e){return!(e instanceof l)})}return i};g.prototype.setTooltip=function(e){a.prototype.setTooltip.apply(this,[e]);var t=this._getFieldRelevantForLabel();var i=this._getLabel();c.call(this,i,t);return this};function c(e,t){if(e==this._oSetLabel){return}var a;if(this._oSetLabel&&this._oSetLabel instanceof i){a=W.call(this._oSetLabel)}if(!a){a=W.call(this)}if(a){if(e instanceof o){if(t&&t.setTooltipLabel){t.setTooltipLabel(a)}}else{e.setTooltip(a)}}}g.prototype.setLabel=function(e){if(!e&&this._bMoveLabelToVBox){return this.setAggregation("label",e)}if(this._oSetLabel&&typeof this._oSetLabel!=="string"){this._oSetLabel.detachEvent("_change",L,this)}var t;var i;var l;if(typeof e==="string"){t=this._getLabel();if(t){i=t.getText()}}else if(!e&&this._oSetLabel){i=this.getLabelText()}a.prototype.setLabel.apply(this,[e]);this._oSetLabel=e;y.call(this);if(typeof e==="string"){if(this._oLabel instanceof o&&e!=i&&(e.length>0||i.length>0)){l=this._getFieldRelevantForLabel();if(l&&e!=null){if(l.getComputedTextLabel){if(!l._oTextLabelSetByGroupElement){l._oTextLabelSetByGroupElement={oldText:l.getComputedTextLabel()}}l.setTextLabel(e)}}}if(!this._bHorizontalLayoutUsed){this.setAggregation("_label",this._oLabel,true)}this._oLabel.isRequired=v;this._oLabel.isDisplayOnly=_}else{if(e){if(e.isRequired){e.isRequired=v}if(e.isDisplayOnly){e.isDisplayOnly=_}e.attachEvent("_change",L,this)}else{l=this._getFieldRelevantForLabel();if(l){k.call(this,l,i)}}this.updateLabelOfFormElement()}return this};g.prototype.destroyLabel=function(){var e=this.getLabelText();a.prototype.destroyLabel.apply(this);delete this._oSetLabel;y.call(this);var t=this._getFieldRelevantForLabel();if(t){k.call(this,t,e)}this.updateLabelOfFormElement();return this};function L(e){if(e.getParameter("name")=="text"){var t=e.oSource;var i=t.getText();if(this._oLabel){this._oLabel.setText(i)}var a=this._getFieldRelevantForLabel();if(a&&a.getComputedTextLabel){if(!a._oTextLabelSetByGroupElement){a._oTextLabelSetByGroupElement={oldText:a.getComputedTextLabel()}}a.setTextLabel(i)}}}function y(){if(!this._bHorizontalLayoutUsed){return}var e=this.getFields();var t;if(e.length>0){var i=this.getFields()[0];if(i instanceof f){var a=i.getItems();var s=this._getLabel();if(a.length>0&&a[0]instanceof l){t=a[0]}this._bMoveLabelToVBox=true;if(t&&t!=s){i.removeItem(0);if(t._bCreatedByGroupElement){this.setAggregation("_label",t,true)}else{this.setAggregation("label",t)}}if(s&&t!=s){i.insertItem(s,0)}this._bMoveLabelToVBox=false;E.call(this)}}}function v(){if(this.getRequired&&this.getRequired()){return true}var e=this.getParent();if(e&&e.isA("sap.m.VBox")){e=e.getParent()}var t=e.getElements();for(var i=0;i<t.length;i++){var a=t[i];if(a.getRequired&&a.getRequired()===true&&(!a.getEditable||a.getEditable())&&(!a.getContextEditable||a.getContextEditable())){return true}}return false}function _(){if(this.getDisplayOnly){if(!this.isPropertyInitial("displayOnly")){return this.getDisplayOnly()}var e=this.getParent();if(e&&e.isA("sap.m.VBox")){e=e.getParent()}var t=e.getParent();if(t){var i=t.getParent();if(i){return!i.getEditable()}}}return false}function F(){var e=this.getParent();if(e&&e.isA("sap.m.VBox")){e=e.getParent()}if(e._oSetLabel&&!(typeof e._oSetLabel==="string")&&e._oSetLabel.getWrapping&&!e._oSetLabel.isPropertyInitial("wrapping")){return e._oSetLabel.getWrapping()}return true}function E(){var e=this._getFieldRelevantForLabel();if(e){if(this._oLabel){this._oLabel.setLabelFor(e)}return}var t=this.getFields();e=t.length>0?t[0]:null;if(e instanceof f){var a=e.getItems();if(a[1]instanceof h){e=a[1].getItems()[0]}else{e=a[1]}}var l=this._oLabel;if(l){l.setLabelFor(e)}else{l=this.getLabel();if(l instanceof i){l.setAlternativeLabelFor(e)}}}g.prototype.getLabel=function(){return this._oSetLabel};g.prototype._getLabel=function(){if(this._oLabel){return this._oLabel}else{return this._oSetLabel}};g.prototype.getLabelControl=function(){if(this._bHorizontalLayoutUsed){return null}else{return this._getLabel()}};g.prototype.getLabelText=function(){var e="";var t=this._getLabel();if(t){e=t.getText()}return e};g.prototype.getDataSourceLabel=function(){var e=this._getFieldRelevantForLabel();if(e&&e.isA("sap.ui.comp.smartfield.SmartField")){return e.getDataSourceLabel()}};g.prototype._createLabel=function(e){var t=null;var i=this._getFieldRelevantForLabel();if(i){if(i.getShowLabel&&i.getShowLabel()){t=new o(i.getId()+"-label");if(e){if(!i._oTextLabelSetByGroupElement){i._oTextLabelSetByGroupElement={oldText:i.getComputedTextLabel()}}i.setTextLabel(e);t.setText(e)}t.setLabelFor(i)}}else{t=new l(this.getId()+"-label",{text:e})}if(t){t._bCreatedByGroupElement=true;t.isRequired=v;t.isDisplayOnly=_;t.isWrapping=F;this._oLabel=t;if(!this._bHorizontalLayoutUsed){this.setAggregation("_label",t,true)}if(this._oSetLabel&&typeof this._oSetLabel!=="string"){this._oSetLabel.setAlternativeLabelFor(null)}}return t};g.prototype.updateLabelOfFormElement=function(){var e=false,t=null;var i=this.getElements();var l=this._getFieldRelevantForLabel();var s=this._getLabel();var r=false;if(s&&s._bCreatedByGroupElement){if(s instanceof o){if(!l||s._sSmartFieldId&&s._sSmartFieldId!=l.getId()){r=true}}else if(l){r=true}if(r){s.destroy();delete this._oLabel;s=null;if(this._oSetLabel&&!l){if(typeof this._oSetLabel==="string"){a.prototype.setLabel.apply(this,[this._oSetLabel]);s=this._oLabel;this._oLabel.isRequired=v;this._oLabel.isDisplayOnly=_}else{s=this._oSetLabel}y.call(this)}}}else if(s&&l){if(s==this._oLabel){s.destroy();delete this._oLabel}s=null}if(!s){if(this._oSetLabel){if(typeof this._oSetLabel==="string"){t=this._oSetLabel}else{t=this._oSetLabel.getText()}}else{t=""}}if(!s&&i.length>0){s=this._createLabel(t);e=true}if(s){if(s instanceof o){if(l&&l.setTextLabel&&l.getComputedTextLabel()){s.setText(l.getComputedTextLabel())}}c.call(this,s,l)}if(e){y.call(this);if(s&&s.setLabelFor&&!(s instanceof o)&&!l&&i.length>0){s.setLabelFor(i[0])}}};g.prototype.setEditMode=function(e){this._setEditable(e);return this};function x(e){var t=this.getElements();for(var i=0;i<t.length;i++){var a=t[i];C.call(this,a,e)}}function C(e,t){if(e instanceof n){if(!(e.data("editable")===false)){e.setContextEditable(t)}}}g.prototype.invalidateLabel=function(){var e=this._getLabel();if(e){e.invalidate()}};g.prototype._updateFormElementVisibility=function(){var e=this.getVisibleBasedOnElements();if(this._bVisibleElements!==e){this._bVisibleElements=e;if(this.isPropertyInitial("visible")){O.call(this);this.invalidate()}}};g.prototype._updateLayout=function(){var e=null;var t=null;var i=null;var a=this.getUseHorizontalLayout();var l;var s=0;var r;if(a==this._bHorizontalLayoutUsed){return}if(a&&!S.call(this)){return}var o=this.getElements();var n=this._getLabel();this._bNoObserverChange=true;if(a){if(o.length>0){if(o[0].getLayoutData()){i=o[0].getLayoutData()}this.removeAllFields();if(o.length>1){for(s=0;s<o.length;s++){r=o[s];if(s>0){D.call(this,r)}}t=V.call(this,o.slice(0))}if(t){l=[t]}else{l=o.slice(0)}e=B.call(this,l,n,i);this.addField(e);if(n){E.call(this)}}}else{var u=this.getFields();if(u[0]instanceof f){e=u[0];l=e.getItems();if(o.length>1&&l.length>0){if(n){if(l.length>1&&l[1]instanceof h){t=l[1]}}else if(l[0]instanceof h){t=l[0]}if(t){t.removeAllItems();t.destroy()}}e.removeAllItems();e.destroy()}this.removeAllFields();for(s=0;s<o.length;s++){r=o[s];T.call(this,r);this.addField(r)}if(n){if(n==this._oLabel){this.setAggregation("_label",n,true)}else{this.setAggregation("label",n)}}}this._bHorizontalLayoutUsed=a;this._bNoObserverChange=false};function S(){if((!f||!h||!p||!b||!d)&&!this._bVBoxRequested){f=sap.ui.require("sap/m/VBox");h=sap.ui.require("sap/m/HBox");p=sap.ui.require("sap/m/FlexItemData");b=sap.ui.require("sap/ui/core/VariantLayoutData");d=sap.ui.require("sap/ui/layout/GridData");if(!f||!h||!p||!b||!d){sap.ui.require(["sap/m/VBox","sap/m/HBox","sap/m/FlexItemData","sap/ui/core/VariantLayoutData","sap/ui/layout/GridData"],I.bind(this));this._bVBoxRequested=true}}if(f&&h&&p&&b&&d&&!this._bVBoxRequested){return true}else{return false}}function I(e,t,i,a,l){f=e;h=t;p=i;b=a;d=l;this._bVBoxRequested=false;if(!this._bIsBeingDestroyed){this._updateLayout()}}function D(e){var t=e.getLayoutData();if(t){if(t.getStyleClass&&!t.getStyleClass()){t.setStyleClass("sapUiCompGroupElementHBoxPadding")}}else{t=new p({styleClass:"sapUiCompGroupElementHBoxPadding"});t._bCreatedByGroupElement=true;e.setLayoutData(t)}}function T(e){var t=e.getLayoutData();if(t){if(t._bCreatedByGroupElement){t.destroy()}else if(t.getStyleClass&&t.getStyleClass()=="sapUiCompGroupElementHBoxPadding"){t.setStyleClass()}}}function B(e,t,i){if(!g._myVBox){g._myVBox=f.extend("SmartFormVBox",{metadata:{interfaces:["sap.ui.core.IFormContent"]},enhanceAccessibilityState:G,renderer:{apiVersion:2}})}this._bMoveLabelToVBox=true;var a=e.slice(0);if(t){a.splice(0,0,t)}var l=new g._myVBox(this.getId()+"--VBox",{items:a});this._bMoveLabelToVBox=false;l.addStyleClass("sapUiCompGroupElementVBox");l._oGroupElement=this;if(i&&(i instanceof d||i instanceof b||i.isA("sap.ui.layout.ResponsiveFlowLayoutData"))){l.setLayoutData(i.clone())}A.call(this,l);return l}function V(e){var t=new h(this.getId()+"--HBox",{items:e});t._oGroupElement=this;t.enhanceAccessibilityState=G;return t}function G(e,t){var i=this._oGroupElement._getLabel();if(i&&i!=e&&!(e instanceof h)){var a=t["labelledby"];if(!a){a=i.getId()}else{var l=a.split(" ");if((l?Array.prototype.indexOf.call(l,i.getId()):-1)<0){l.splice(0,0,i.getId());a=l.join(" ")}}t["labelledby"]=a}}g.prototype._updateGridDataSpan=function(){if(!this._bHorizontalLayoutUsed){return}var e=this.getFields();if(e.length>0){var t=e[0];if(t instanceof f){A.call(this,t)}}};function A(e){var t=this.getParent();if(!t||!t.addGroupElement){return}var i=t.getParent();while(i&&!i.addGroup&&i.getParent){i=i.getParent()}if(!i){return}var a="";var l=i.getLayout();if(l){a=l.getGridDataSpan()}var s=e.getLayoutData();var r;if(s){if(!(s instanceof d)&&!(s instanceof b)&&a){r=new d({span:a});r._bFromGroupElement=true;var o=new b({multipleLayoutData:[s,r]});o._bFromGroupElement=true;e.setLayoutData(o)}else if(s instanceof d){if(s._bFromGroupElement){if(!a){s.destroy()}else{s.setSpan(a)}}}else if(s instanceof b){var n=false;s.getMultipleLayoutData().forEach(function(e){if(e instanceof d){n=true;if(e._bFromGroupElement){if(!a){e.destroy()}else{e.setSpan(a)}}}});if(!n&&a){r=new d({span:a});r._bFromGroupElement=true;s.addMultipleLayoutData(r)}if(s._bFromGroupElement&&s.getMultipleLayoutData().length==1){r=s.getMultipleLayoutData()[0];e.setLayoutData(r);s.destroy()}}}else if(a){r=new d({span:a});r._bFromGroupElement=true;e.setLayoutData(r)}var u=this.getElements();for(var f=0;f<u.length;f++){var h=u[f];if(h&&h.setControlContext){if(a){h.setControlContext(m.SmartFormGrid)}else{h.setControlContext(m.Form)}}}}g.prototype._setLinebreak=function(e,t,i,a){if(!this._bHorizontalLayoutUsed){return}var l=this.getFields();if(l.length>0){var s=l[0];if(!(s instanceof f)){return}var r=s.getLayoutData();if(r){if(r instanceof b){var o=r.getMultipleLayoutData();for(var n=0;n<o.length;n++){r=o[n];if(r instanceof d){r.setLinebreakXL(e);r.setLinebreakL(t);r.setLinebreakM(i);r.setLinebreakS(a)}}}else if(r instanceof d){r.setLinebreakXL(e);r.setLinebreakL(t);r.setLinebreakM(i);r.setLinebreakS(a)}}}};g.prototype.setVisible=function(e){var t=this.isVisible();a.prototype.setVisible.apply(this,arguments);if(t!=e){O.call(this)}return this};g.prototype.isVisible=function(){if(this.isPropertyInitial("visible")){return this._bVisibleElements}else{return this.getVisible()}};function O(){this.fireVisibleChanged({visible:this.isVisible()});if(this.getParent()){this.getParent()._updateLineBreaks()}}g.prototype.getFormElement=function(){return this};g.prototype.addElement=function(e){if(!e){return this}e=this.validateAggregation("elements",e,true);P.call(this,e);var t;if(this._oLabel&&this._oLabel._bCreatedByGroupElement&&this._oLabel._sSmartFieldId){t=this._oLabel._sSmartFieldId}if(this._bHorizontalLayoutUsed){H.call(this,e,undefined,true)}else{this.addField(e)}if(t&&t!=this._oLabel._sSmartFieldId){this._oLabel.setLabelFor(t)}this.updateLabelOfFormElement();this._updateFormElementVisibility();return this};g.prototype.insertElement=function(e,t){if(!e){return this}e=this.validateAggregation("elements",e,true);P.call(this,e);var i;if(this._oLabel&&this._oLabel._bCreatedByGroupElement&&this._oLabel._sSmartFieldId){i=this._oLabel._sSmartFieldId}if(this._bHorizontalLayoutUsed){H.call(this,e,t,false)}else{this.insertField(e,t)}if(i&&i!=this._oLabel._sSmartFieldId){this._oLabel.setLabelFor(i)}this.updateLabelOfFormElement();this._updateFormElementVisibility();return this};g.prototype.getElements=function(){var e;var t;if(this._bHorizontalLayoutUsed){e=this.getFields();t=this._extractFields(e,true)}else{t=this.getFields()}return t};g.prototype.indexOfElement=function(e){var t=-1;if(this._bHorizontalLayoutUsed){var i=this.getElements();for(var a=0;a<i.length;a++){if(e==i[a]){t=a;break}}}else{t=this.indexOfField(e)}return t};g.prototype.removeElement=function(e){var t;var i;if(this._oLabel&&this._oLabel._bCreatedByGroupElement&&this._oLabel._sSmartFieldId){i=this._oLabel._sSmartFieldId}if(this._bHorizontalLayoutUsed){t=U.call(this,e,false)}else{t=this.removeField(e)}if(t){q.call(this,t)}if(i&&i!=this._oLabel._sSmartFieldId){this._oLabel.setLabelFor(i)}this.updateLabelOfFormElement();this._updateFormElementVisibility();return t};g.prototype.removeAllElements=function(){var e;if(this._bHorizontalLayoutUsed){e=U.call(this,undefined,true)}else{e=this.removeAllFields()}if(e&&Array.isArray(e)){for(var t=0;t<e.length;t++){q.call(this,e[t])}}this.updateLabelOfFormElement();this._updateFormElementVisibility();return e};g.prototype.destroyElements=function(){if(this._bHorizontalLayoutUsed){var e=this.getFields();if(e.length>0){var t=this._getLabel();if(t){e[0].removeItem(t);if(t==this._oLabel){this.setAggregation("_label",t,true)}else{this.setAggregation("label",t)}}this.destroyFields()}}else{this.destroyFields()}this.updateLabelOfFormElement();this._updateFormElementVisibility();return this};g.prototype._observeChanges=function(e){a.prototype._observeChanges.apply(this,arguments);if(e.object==this){switch(e.name){case"useHorizontalLayout":this._updateLayout();break;case"horizontalLayoutGroupElementMinWidth":u.error("HorizontalLayoutGroupElementMinWidth is deprecated",this);this._updateLayout();break;case"elementForLabel":this.updateLabelOfFormElement();break;case"_editable":x.call(this,e.current);break;default:break}}else{M.call(this,e)}};function H(e,t,i){var a=this._getLabel();var l=this.getFields();var s;var r;var o;if(l.length>0){s=l[0]}else{o=[e];var n=e.getLayoutData();s=B.call(this,o,a,n);this.addField(s);if(a){E.call(this)}return}if(!(s instanceof f)){return}o=s.getItems();if(a){if(o.length>1){r=o[1]}}else if(o.length>0){r=o[0]}if(r instanceof h){o=r.getItems();if((i||t>0)&&o.length>0){D.call(this,e)}if(i){r.addItem(e)}else{if(t==0&&o.length>0){D.call(this,o[0])}r.insertItem(e,t)}}else{var u=r;o=[];if(u){s.removeItem(u);if(i||t>0){o.push(u);o.push(e);D.call(this,e)}else{o.push(e);o.push(u);D.call(this,u)}r=V.call(this,o);s.addItem(r)}else{s.addItem(e)}if(a){E.call(this)}}}function P(e){if(e.getEditable){if(!e.getEditable()){e.data("editable",false)}}this._oObserver.observe(e,{properties:["visible"]});if(e.attachInnerControlsCreated){e.attachInnerControlsCreated(this._updateFormElementLabel,this)}if(e.setControlContext){e.setControlContext(m.Form)}if(e.getMetadata().getProperty("mandatory")){this._oObserver.observe(e,{properties:["mandatory"]})}C.call(this,e,this.getProperty("_editable"));R.call(this,e)}function R(e){if(e instanceof n){var t=this.getCustomData();for(var i=0;i<t.length;i++){z.call(this,e,t[i])}}}function z(t,i){if(t instanceof n&&e.smartform.inheritCostomDataToFields(i)&&!t.data(i.getKey())){var a=i.clone();a._bFromGroupElement=true;a._sOriginalId=i.getId();t.addCustomData(a)}}function M(e){if(e.name=="mandatory"){this.invalidateLabel()}else if(e.name=="visible"){this._updateFormElementVisibility()}}function U(e,t){var i=this._getLabel();var a=this.getFields();var l;var s;var r;var o;var n=false;var u;if(a.length>0){l=a[0]}if(!(l instanceof f)){return null}r=l.getItems();if(i){if(r.length>1){s=r[1]}}else if(r.length>0){s=r[0]}if(s instanceof h){if(t){o=s.removeAllItems();n=true}else{o=s.removeItem(e);r=s.getItems();if(r.length>0){T.call(this,r[0]);if(r.length==1){u=r[0];s.removeAllItems();l.removeItem(s);s.destroy();l.addItem(u)}}}}else{if(t){o=l.removeAllItems()}else{o=l.removeItem(e)}if(o){n=true}}if(n){if(i){l.removeItem(i);if(i==this._oLabel){this.setAggregation("_label",i,true)}else{this.setAggregation("label",i)}}this.removeField(l);l.destroy()}if(o){if(Array.isArray(o)){for(var p=0;p<o.length;p++){u=o[p];T.call(this,u)}}else{T.call(this,o)}}return o}function q(e){if(e.detachInnerControlsCreated){e.detachInnerControlsCreated(this._updateFormElementLabel,this)}if(e.setControlContext){e.setControlContext(m.None)}w.call(this,e);k.call(this,e,this.getLabelText())}function k(e,t){if(e._oTextLabelSetByGroupElement){if(e.getComputedTextLabel()==t){e.setTextLabel(e._oTextLabelSetByGroupElement.oldText)}delete e._oTextLabelSetByGroupElement}}function w(e,t){if(e instanceof n){var i=e.getCustomData();for(var a=0;a<i.length;a++){var l=i[a];if(l._bFromGroupElement&&(!t||t==l._sOriginalId)){e.removeCustomData(l);l.destroy()}}}}g.prototype._updateFormElementLabel=function(e){var t=this._getFieldRelevantForLabel();var i=this._getLabel();var a=e.oSource;var l=e.getParameters();if(i instanceof o&&a&&l&&a===t){i.updateLabelFor(l)}};g.prototype.addCustomData=function(e){if(!e){return this}a.prototype.addCustomData.apply(this,arguments);var t=this.getElements();for(var i=0;i<t.length;i++){z.call(this,t[i],e)}return this};g.prototype.insertCustomData=function(e,t){if(!e){return this}a.prototype.insertCustomData.apply(this,arguments);var i=this.getElements();for(var l=0;l<i.length;l++){z.call(this,i[l],e)}return this};g.prototype.removeCustomData=function(e){var t=a.prototype.removeCustomData.apply(this,arguments);if(t){var i=this.getElements();for(var l=0;l<i.length;l++){w.call(this,i[l],t.getId())}}return t};g.prototype.removeAllCustomData=function(){var e=a.prototype.removeAllCustomData.apply(this,arguments);if(e.length>0){var t=this.getElements();for(var i=0;i<t.length;i++){w.call(this,t[i])}}return e};g.prototype.destroyCustomData=function(){a.prototype.destroyCustomData.apply(this,arguments);var e=this.getElements();for(var t=0;t<e.length;t++){w.call(this,e[t])}return this};g.prototype.getVisibleBasedOnElements=function(){var e=false;var t=this.getElements();if(t&&t.length>0){e=t.some(function(e){return e.getVisible()})}return e};function W(){var e=this.getTooltip();if(!e||typeof e==="string"||e instanceof String){return e}else{return e.getText()}}g.prototype.clone=function(e,t){var i=this.removeAllElements();var l=a.prototype.clone.apply(this,arguments);for(var s=0;s<i.length;s++){var r=i[s];var o=r.clone(e,t);this.addElement(r);l.addElement(o)}return l};return g});
/*!
 * SAPUI5
 * (c) Copyright 2009-2023 SAP SE. All rights reserved.
 */
sap.ui.predefine("sap/ui/comp/smartform/Layout", ["sap/ui/comp/library","sap/ui/layout/library","sap/ui/core/Element"],function(t,a,e){"use strict";var u=e.extend("sap.ui.comp.smartform.Layout",{metadata:{interfaces:["sap.ui.comp.smartform.SmartFormLayout"],library:"sap.ui.comp",properties:{labelSpanXL:{type:"int",group:"Misc",defaultValue:null},labelSpanL:{type:"int",group:"Misc",defaultValue:null},labelSpanM:{type:"int",group:"Misc",defaultValue:null},labelSpanS:{type:"int",group:"Misc",defaultValue:null},emptySpanXL:{type:"int",group:"Misc",defaultValue:null},emptySpanL:{type:"int",group:"Misc",defaultValue:null},emptySpanM:{type:"int",group:"Misc",defaultValue:null},emptySpanS:{type:"int",group:"Misc",defaultValue:null},columnsXL:{type:"int",group:"Misc",defaultValue:null},columnsL:{type:"int",group:"Misc",defaultValue:null},columnsM:{type:"int",group:"Misc",defaultValue:null},singleGroupFullSize:{type:"boolean",group:"Misc",defaultValue:true},breakpointXL:{type:"int",group:"Misc",defaultValue:null},breakpointL:{type:"int",group:"Misc",defaultValue:null},breakpointM:{type:"int",group:"Misc",defaultValue:null},gridDataSpan:{type:"sap.ui.layout.GridSpan",group:"Misc",defaultValue:""}}},_oSpan:{XL:0,L:0,M:0,S:0}});u.prototype.setGridDataSpan=function(t){var a=[];var e=/XL([1-9]|1[0-2])(?:\s|$)/i;a=e.exec(t);if(a&&a[1]){this._oSpan.XL=parseInt(a[1])}else{this._oSpan.XL=0}e=/\bL([1-9]|1[0-2])(?:\s|$)/i;a=e.exec(t);if(a&&a[1]){this._oSpan.L=parseInt(a[1]);if(!this._oSpan.XL){this._oSpan.XL=this._oSpan.L}}e=/M([1-9]|1[0-2])(?:\s|$)/i;a=e.exec(t);if(a&&a[1]){this._oSpan.M=parseInt(a[1])}e=/S([1-9]|1[0-2])(?:\s|$)/i;a=e.exec(t);if(a&&a[1]){this._oSpan.S=parseInt(a[1])}this.setProperty("gridDataSpan",t);return this};u.prototype._getGridDataSpanNumbers=function(){return this._oSpan};return u});
/*!
 * SAPUI5
 * (c) Copyright 2009-2023 SAP SE. All rights reserved.
 */
sap.ui.predefine("sap/ui/comp/smartform/SemanticGroupElement", ["sap/ui/comp/library","sap/ui/core/Control","sap/ui/layout/form/SemanticFormElement","sap/ui/layout/form/FormHelper","sap/m/Label","sap/m/Button","sap/m/Text","sap/ui/comp/smartfield/SmartLabel","sap/ui/comp/smartfield/SmartField","sap/base/Log"],function(e,t,i,a,r,o,l,s,n,u){"use strict";var f;var h;var p=e.smartfield.ControlContextType;var m=i.extend("sap.ui.comp.smartform.SemanticGroupElement",{metadata:{library:"sap.ui.comp",interfaces:["sap.ui.comp.IFormGroupElement"],properties:{elementForLabel:{type:"int",group:"Misc",defaultValue:0}},defaultAggregation:"elements",aggregations:{elements:{type:"sap.ui.core.Control",multiple:true,singularName:"element"}},events:{visibleChanged:{}}},_bVisibleElements:false});function d(e,i){if(e==this._oSetLabelFromOutside){return}var a;if(this._oSetLabelFromOutside&&this._oSetLabelFromOutside instanceof t){a=b.call(this._oSetLabelFromOutside)}if(!a){a=b.call(this)}if(a){if(e instanceof s){if(i&&i.setTooltipLabel){i.setTooltipLabel(a)}}else{e.setTooltip(a)}}}function b(){var e=this.getTooltip();if(!e||typeof e==="string"||e instanceof String){return e}else{return e.getText()}}function g(e){if(e.getParameter("name")=="text"){var t=e.oSource;var i=t.getText();if(this._oLabel){this._oLabel.setText(i)}var a=this._getFieldRelevantForLabel();if(a&&a.getComputedTextLabel){if(!a._oTextLabelSetBySemanticGroupElement){a._oTextLabelSetBySemanticGroupElement={oldText:a.getComputedTextLabel()}}a.setTextLabel(i)}}}function c(){if(this.getRequired&&this.getRequired()){return true}var e=this.getParent();var t=e.getElements();for(var i=0;i<t.length;i++){var a=t[i];if(a.getRequired&&a.getRequired()===true&&(!a.getEditable||a.getEditable())&&(!a.getContextEditable||a.getContextEditable())){return true}}return false}function y(){if(this.getDisplayOnly){if(!this.isPropertyInitial("displayOnly")){return this.getDisplayOnly()}var e=this.getParent();var t=e.getParent();if(t){var i=t.getParent();if(i){return!i.getEditable()}}}return false}function L(){var e=this.getParent();if(e._oSetLabelFromOutside&&!(typeof e._oSetLabelFromOutside==="string")&&e._oSetLabelFromOutside.getWrapping&&!e._oSetLabelFromOutside.isPropertyInitial("wrapping")){return e._oSetLabelFromOutside.getWrapping()}return true}function _(e,t){if(e._oTextLabelSetBySemanticGroupElement){if(e.getComputedTextLabel()==t){e.setTextLabel(e._oTextLabelSetBySemanticGroupElement.oldText)}delete e._oTextLabelSetBySemanticGroupElement}}function v(e){e._bCreatedBySemanticGroupElement=true;e.isRequired=c;e.isDisplayOnly=y;e.isWrapping=L;return e}function F(e){if(e.getEditable){if(!e.getEditable()){e.data("editable",false)}}this._oObserver.observe(e,{properties:["visible"]});if(e.attachInnerControlsCreated){e.attachInnerControlsCreated(this._updateFormElementLabel,this)}if(e.setControlContext){e.setControlContext(p.Form)}if(e.getMetadata().getProperty("mandatory")){this._oObserver.observe(e,{properties:["mandatory"]})}x.call(this,e,this.getProperty("_editable"));O.call(this,e);if(e.isA("sap.ui.comp.smartfield.SmartField")&&e._isInnerControlCreationDelayed&&e.getMode()==="display"){e._forceInitialise()}if(e.isA("sap.ui.comp.smartfield.SmartField")){e.attachInnerControlsCreated(function(){this._observeChanges({object:e,name:"visible"});e.getInnerControls().forEach(function(t){var i=t.getBinding("text");if(i){i.attachChange(function(){this._observeChanges({object:e,name:"visible"})}.bind(this))}}.bind(this))}.bind(this))}}function S(e){if(e.name=="mandatory"){this.invalidateLabel()}else if(e.name=="visible"){this._updateFormElementVisibility()}}function E(){this.fireVisibleChanged({visible:this.isVisible()});if(this.getParent()){this.getParent()._updateLineBreaks()}}function C(e){var t=this.getElements();for(var i=0;i<t.length;i++){var a=t[i];x.call(this,a,e)}}function x(e,t){if(e instanceof n){if(!(e.data("editable")===false)){e.setContextEditable(t)}}}function O(e){if(e instanceof n){var t=this.getCustomData();for(var i=0;i<t.length;i++){T.call(this,e,t[i])}}}function D(e,t){if(e instanceof n){var i=e.getCustomData();for(var a=0;a<i.length;a++){var r=i[a];if(r._bFromSemanticGroupElement&&(!t||t==r._sOriginalId)){e.removeCustomData(r);r.destroy()}}}}function T(t,i){if(t instanceof n&&e.smartform.inheritCostomDataToFields(i)&&!t.data(i.getKey())){var a=i.clone();a._bFromSemanticGroupElement=true;a._sOriginalId=i.getId();t.addCustomData(a)}}function I(e){if(e.detachInnerControlsCreated){e.detachInnerControlsCreated(this._updateFormElementLabel,this)}if(e.setControlContext){e.setControlContext(p.None)}D.call(this,e);_.call(this,e,this.getLabelText())}m.prototype.init=function(){i.prototype.init.apply(this,arguments);this._oObserver.observe(this,{properties:["elementForLabel","_editable","delimiter"]})};m.prototype._getFieldRelevantForLabel=function(){var e=this.getElements();var t=this.getElementForLabel();if(e.length>t&&e[t]instanceof n){return e[t]}return null};m.prototype._extractFields=function(e,t){var i=[];e.forEach(function(e){i.push(e)});if(t){i=i.filter(function(e){return!(e instanceof r)})}return i};m.prototype._observeChanges=function(e){i.prototype._observeChanges.apply(this,arguments);if(e.object==this){switch(e.name){case"useHorizontalLayout":u.error("useHorizontalLayout can't be used with SemanticGroupElement",this);break;case"elementForLabel":this.updateLabelOfFormElement();break;case"_editable":C.call(this,e.current);break;default:break}}else{S.call(this,e)}};m.prototype._getLabel=function(){if(this._oLabel){return this._oLabel}else{return this._oSetLabelFromOutside}};m.prototype._createLabel=function(e){var t=null;var i=this._getFieldRelevantForLabel();if(i){if(i.getShowLabel&&i.getShowLabel()){t=new s(i.getId()+"-label");if(e){if(!i._oTextLabelSetBySemanticGroupElement){i._oTextLabelSetBySemanticGroupElement={oldText:i.getComputedTextLabel()}}i.setTextLabel(e);t.setText(e)}t.setLabelFor(i)}}else{t=new r(this.getId()+"-label",{text:e})}if(t){t=v(t);this._oLabel=t;this.setAggregation("_label",t,true);if(this._oSetLabelFromOutside&&typeof this._oSetLabelFromOutside!=="string"){this._oSetLabelFromOutside.setAlternativeLabelFor(null)}}return t};m.prototype._updateFormElementLabel=function(e){var t=this._getFieldRelevantForLabel();var i=this._getLabel();var a=e.oSource;var r=e.getParameters();if(i instanceof s&&a&&r&&a===t){i.updateLabelFor(r)}};m.prototype._updateFormElementVisibility=function(){var e=this.getVisibleBasedOnElements();if(this._bVisibleElements!==e){this._bVisibleElements=e;if(this.isPropertyInitial("visible")){E.call(this);this.invalidate()}}};m.prototype._updateGridDataSpan=function(){};m.prototype._setLinebreak=function(e,t,i,a){var r=this.getFields();if(r.length>0){var o=r[0];if(!(o instanceof f)){return}var l=o.getLayoutData();if(l instanceof h){l.setLinebreakXL(e);l.setLinebreakL(t);l.setLinebreakM(i);l.setLinebreakS(a)}}};m.prototype.getFieldsForRendering=function(){var e,t,i,r,o=this.getDelimiter(),l=this.getId()+"-delimiter-",s=true,n=true,u=false,f=true,h=true,p=[],m=this.getFields();for(e=0;e<m.length;e++){r=m[e];if(!r.isA("sap.ui.core.ISemanticFormContent")){s=false;break}if(n){var d=r.isA("sap.ui.comp.smartfield.SmartField"),b=r._getEmbeddedSmartField(),g=d&&!!b;if(d&&!r.getEditable()){n=g?!b.getEditable():true}else{n=false}if(!n){h=false}}if(!u){u=r._hasSemanticObject();if(!u){f=false}}if(!f&&!h){break}}if(!s){return}if(!this._bLayoutDataCreated){V.call(this)}if(this.getProperty("_editable")&&!h||f){i=this.getAggregation("_delimiters",[]);for(var c=0;c<m.length;c++){r=m[c];if(r.getVisible()){if(p.length>0){t=i[c-1];if(t===undefined){t=a.createDelimiter(o,l+c);t.addStyleClass("sapUiFormDelimiter");this.addAggregation("_delimiters",t)}p.push(t)}p.push(r)}}}else{var y=this.getAggregation("_displayField");if(!y){G.call(this,true);y=this.getAggregation("_displayField")}p.push(y)}return p};function V(){var e=this.getFields().filter(function(e){return e.getVisible()});var t=this.getAggregation("_delimiters",[]);var i=this.getParent();var a=i&&i.getParent();var r=a&&a.getLayout();var o;var l=0;if(!r||!r.getLayoutDataForDelimiter){return}if(this.getProperty("_editable")){for(l=0;l<t.length;l++){var s=t[l];if(!s.getLayoutData()){o=r.getLayoutDataForDelimiter();if(o){if(o instanceof Promise){o.then(function(e){e._bSetBySemanticFormElement=true;this.setLayoutData(e)}.bind(s))}else if(o.isA("sap.ui.core.LayoutData")){o._bSetBySemanticFormElement=true;s.setLayoutData(o)}}}}if(e.length>1){for(l=0;l<e.length;l++){var n=e[l];o=n.getLayoutData();if(!o||o._bSetBySemanticFormElement){o=r.getLayoutDataForSemanticField(e.length,l+1,o);if(o){if(o instanceof Promise){o.then(function(e){e._bSetBySemanticFormElement=true;this.setLayoutData(e)}.bind(n))}else if(o.isA("sap.ui.core.LayoutData")&&!o._bSetBySemanticFormElement){o._bSetBySemanticFormElement=true;n.setLayoutData(o)}}}}}this._bLayoutDataCreated=true}}var A={onBeforeRendering:function(){P.call(this,true)}};function G(e){var t=this.getAggregation("_displayField");if(t){P.call(this,false)}else{var i=this.getId()+"-display";t=a.createSemanticDisplayControl("",i);t.addDelegate(A,true,this);this.setAggregation("_displayField",t)}}function P(e){var t=this.getAggregation("_displayField");if(t&&(t.getDomRef()||e)){if(e&&t._bNoForceUpdate){t._bNoForceUpdate=false;return}var i=this.getFields();var r=[];var o=false;for(var l=0;l<i.length;l++){var s=i[l];if(s.getVisible()){var n=s.getFormValueProperty?s.getFormValueProperty():null;var u;if(s.getFormFormattedValue){u=s.getFormFormattedValue();if(u instanceof Promise){o=true}}else if(n){u=s.getProperty(n)}else if(s.getMetadata().getProperty("value")){u=s.getValue()}else if(s.getMetadata().getProperty("text")){u=s.getText()}r.push(u)}}t._bNoForceUpdate=true;if(o){Promise.all(r).then(function(e){var t=this.getAggregation("_displayField");var i=B.call(this,e);t._bNoForceUpdate=true;a.updateSemanticDisplayControl(t,i)}.bind(this))}else{var f=B.call(this,r);a.updateSemanticDisplayControl(t,f)}}else if(t&&t._bNoForceUpdate){t._bNoForceUpdate=false}}function B(e){var t=this.getDelimiter();var i="";for(var a=0;a<e.length;a++){i=i+e[a];if(a<e.length-1){i=i+" "+t+" "}}return i}m.prototype.setTooltip=function(e){i.prototype.setTooltip.apply(this,[e]);var t=this._getFieldRelevantForLabel();var a=this._getLabel();d.call(this,a,t);return this};m.prototype.setLabel=function(e){if(this._oSetLabelFromOutside&&typeof this._oSetLabelFromOutside!=="string"){this._oSetLabelFromOutside.detachEvent("_change",g,this)}var t;var a;var r;if(typeof e==="string"){t=this._getLabel();if(t){a=t.getText()}}else if(!e&&this._oSetLabelFromOutside){a=this.getLabelText()}i.prototype.setLabel.apply(this,[e]);this._oSetLabelFromOutside=e;if(typeof e==="string"){if(this._oLabel instanceof s&&e!=a&&(e.length>0||a.length>0)){r=this._getFieldRelevantForLabel();if(r&&e!=null){if(r.getComputedTextLabel){if(!r._oTextLabelSetBySemanticGroupElement){r._oTextLabelSetBySemanticGroupElement={oldText:r.getComputedTextLabel()}}r.setTextLabel(e)}}}this.setAggregation("_label",this._oLabel,true);this._oLabel.isRequired=c;this._oLabel.isDisplayOnly=y}else{if(e){if(e.isRequired){e.isRequired=c}if(e.isDisplayOnly){e.isDisplayOnly=y}e.attachEvent("_change",g,this)}else{r=this._getFieldRelevantForLabel();if(r){_.call(this,r,a)}}this.updateLabelOfFormElement()}return this};m.prototype.destroyLabel=function(){var e=this.getLabelText();i.prototype.destroyLabel.apply(this);delete this._oSetLabelFromOutside;var t=this._getFieldRelevantForLabel();if(t){_.call(this,t,e)}this.updateLabelOfFormElement();return this};m.prototype.getLabel=function(){return this._oSetLabelFromOutside};m.prototype.getLabelControl=function(){return this._getLabel()};m.prototype.getLabelText=function(){var e="";var t=this._getLabel();if(t){e=t.getText()}return e};m.prototype.getDataSourceLabel=function(){var e=this._getFieldRelevantForLabel();if(e&&e.isA("sap.ui.comp.smartfield.SmartField")){return e.getDataSourceLabel()}};m.prototype.updateLabelOfFormElement=function(){var e=false,t=null;var a=this.getElements();var r=this._getFieldRelevantForLabel();var o=this._getLabel();var l=false;if(o&&o._bCreatedBySemanticGroupElement){if(o instanceof s){if(!r||o._sSmartFieldId&&o._sSmartFieldId!=r.getId()){l=true}}else if(r){l=true}if(l){o.destroy();delete this._oLabel;o=null;if(this._oSetLabelFromOutside&&!r){if(typeof this._oSetLabelFromOutside==="string"){i.prototype.setLabel.apply(this,[this._oSetLabelFromOutside]);o=this._oLabel;this._oLabel.isRequired=c;this._oLabel.isDisplayOnly=y}else{o=this._oSetLabelFromOutside}}}}else if(o&&r){if(o==this._oLabel){o.destroy();delete this._oLabel}o=null}if(!o){if(this._oSetLabelFromOutside){if(typeof this._oSetLabelFromOutside==="string"){t=this._oSetLabelFromOutside}else{t=this._oSetLabelFromOutside.getText()}}else{t=""}}if(!o&&a.length>0){o=this._createLabel(t);e=true}if(o){if(o instanceof s){if(r&&r.setTextLabel&&r.getComputedTextLabel()){o.setText(r.getComputedTextLabel())}}d.call(this,o,r)}if(e){if(o&&o.setLabelFor&&!(o instanceof s)&&!r&&a.length>0){o.setLabelFor(a[0])}}};m.prototype.invalidateLabel=function(){var e=this._getLabel();if(e){e.invalidate()}};m.prototype.getUseHorizontalLayout=function(){u.error("getUseHorizontalLayout can't be used with SemanticGroupElement",this)};m.prototype.setUseHorizontalLayout=function(e){u.error("setUseHorizontalLayout can't be used with SemanticGroupElement",this)};m.prototype.getHorizontalLayoutGroupElementMinWidth=function(){u.error("getHorizontalLayoutGroupElementMinWidth can't be used with SemanticGroupElement",this)};m.prototype.setHorizontalLayoutGroupElementMinWidth=function(e){u.error("setHorizontalLayoutGroupElementMinWidth can't be used with SemanticGroupElement",this)};m.prototype.setVisible=function(e){var t=this.isVisible();i.prototype.setVisible.apply(this,arguments);if(t!=e){E.call(this)}return this};m.prototype.isVisible=function(){if(this.isPropertyInitial("visible")){return this._bVisibleElements}else{return this.getVisible()}};m.prototype.getVisibleBasedOnElements=function(){var e=false;var t=this.getElements();if(t&&t.length>0){e=t.some(function(e){return e.getVisible()})}return e};m.prototype.getFormElement=function(){return this};m.prototype.addElement=function(e){if(!e){return this}e=this.validateAggregation("elements",e,true);F.call(this,e);var t;if(this._oLabel&&this._oLabel._bCreatedBySemanticGroupElement&&this._oLabel._sSmartFieldId){t=this._oLabel._sSmartFieldId}this.addField(e);if(t&&t!=this._oLabel._sSmartFieldId){this._oLabel.setLabelFor(t)}this.updateLabelOfFormElement();this._updateFormElementVisibility();return this};m.prototype.insertElement=function(e,t){if(!e){return this}e=this.validateAggregation("elements",e,true);F.call(this,e);var i;if(this._oLabel&&this._oLabel._bCreatedBySemanticGroupElement&&this._oLabel._sSmartFieldId){i=this._oLabel._sSmartFieldId}this.insertField(e,t);if(i&&i!=this._oLabel._sSmartFieldId){this._oLabel.setLabelFor(i)}this.updateLabelOfFormElement();this._updateFormElementVisibility();return this};m.prototype.getElements=function(){var e;e=this.getFields();return e};m.prototype.indexOfElement=function(e){var t=-1;t=this.indexOfField(e);return t};m.prototype.removeElement=function(e){var t;var i;if(this._oLabel&&this._oLabel._bCreatedBySemanticGroupElement&&this._oLabel._sSmartFieldId){i=this._oLabel._sSmartFieldId}t=this.removeField(e);if(t){I.call(this,t)}if(i&&i!=this._oLabel._sSmartFieldId){this._oLabel.setLabelFor(i)}this.updateLabelOfFormElement();this._updateFormElementVisibility();return t};m.prototype.removeAllElements=function(){var e=this.removeAllFields();if(e&&Array.isArray(e)){for(var t=0;t<e.length;t++){I.call(this,e[t])}}this.updateLabelOfFormElement();this._updateFormElementVisibility();return e};m.prototype.destroyElements=function(){this.destroyFields();this.updateLabelOfFormElement();this._updateFormElementVisibility();return this};m.prototype.addCustomData=function(e){if(!e){return this}i.prototype.addCustomData.apply(this,arguments);var t=this.getElements();for(var a=0;a<t.length;a++){T.call(this,t[a],e)}return this};m.prototype.insertCustomData=function(e,t){if(!e){return this}i.prototype.insertCustomData.apply(this,arguments);var a=this.getElements();for(var r=0;r<a.length;r++){T.call(this,a[r],e)}return this};m.prototype.removeCustomData=function(e){var t=i.prototype.removeCustomData.apply(this,arguments);if(t){var a=this.getElements();for(var r=0;r<a.length;r++){D.call(this,a[r],t.getId())}}return t};m.prototype.removeAllCustomData=function(){var e=i.prototype.removeAllCustomData.apply(this,arguments);if(e.length>0){var t=this.getElements();for(var a=0;a<t.length;a++){D.call(this,t[a])}}return e};m.prototype.destroyCustomData=function(){i.prototype.destroyCustomData.apply(this,arguments);var e=this.getElements();for(var t=0;t<e.length;t++){D.call(this,e[t])}return this};m.prototype.clone=function(e,t){var a=this.removeAllElements();var r=i.prototype.clone.apply(this,arguments);for(var o=0;o<a.length;o++){var l=a[o];var s=l.clone(e,t);this.addElement(l);r.addElement(s)}return r};return m});
/*!
 * SAPUI5
 * (c) Copyright 2009-2023 SAP SE. All rights reserved.
 */
sap.ui.predefine("sap/ui/comp/smartform/SmartForm", ["sap/ui/comp/library","sap/ui/core/Control","sap/ui/core/theming/Parameters","sap/ui/layout/form/Form","sap/ui/base/ManagedObjectObserver","sap/base/Log","sap/m/Label","sap/m/Button","sap/m/Text"],function(t,e,i,o,s,a,r,n,l){"use strict";var u;var h;var p;var c;var f;var n;var g;var d;var m=t.smartform.SmartFormValidationMode;var y=t.smartform.Importance;var b={ResponsiveGridLayout:{layout:undefined,path:"sap/ui/layout/form/ResponsiveGridLayout",name:"sap.ui.layout.form.ResponsiveGridLayout",requested:false,loaded:lt,promise:undefined},ResponsiveLayout:{layout:undefined,path:"sap/ui/layout/form/ResponsiveLayout",name:"sap.ui.layout.form.ResponsiveLayout",requested:false,loaded:ut,promise:undefined},ColumnLayout:{layout:undefined,path:"sap/ui/layout/form/ColumnLayout",name:"sap.ui.layout.form.ColumnLayout",requested:false,loaded:ht,promise:undefined}};var _={apiVersion:2,render:function(t,e){t.openStart("div",e);t.class("sapUiCompSmartForm");t.openEnd();var i=e.getAggregation("content");t.renderControl(i);t.close("div")}};var v=e.extend("sap.ui.comp.smartform.SmartForm",{metadata:{library:"sap.ui.comp",designtime:"sap/ui/comp/designtime/smartform/SmartForm.designtime",properties:{title:{type:"string",group:"Misc",defaultValue:null},useHorizontalLayout:{type:"boolean",group:"Misc",defaultValue:null,deprecated:true},horizontalLayoutGroupElementMinWidth:{type:"int",group:"Misc",defaultValue:null,deprecated:true},checkButton:{type:"boolean",group:"Misc",defaultValue:false},entityType:{type:"string",group:"Misc",defaultValue:null},expandable:{type:"boolean",group:"Misc",defaultValue:false},expanded:{type:"boolean",group:"Misc",defaultValue:null},editTogglable:{type:"boolean",group:"Misc",defaultValue:false},editable:{type:"boolean",group:"Misc",defaultValue:false},ignoredFields:{type:"string",group:"Misc",defaultValue:null},flexEnabled:{type:"boolean",group:"Misc",defaultValue:true},validationMode:{type:"sap.ui.comp.smartform.SmartFormValidationMode",group:"Misc",defaultValue:m.Standard},importance:{type:"sap.ui.comp.smartform.Importance",group:"Misc",defaultValue:y.Low}},defaultAggregation:"groups",aggregations:{groups:{type:"sap.ui.comp.smartform.Group",multiple:true,singularName:"group"},content:{type:"sap.ui.core.Control",multiple:false,visibility:"hidden"},layout:{type:"sap.ui.comp.smartform.SmartFormLayout",multiple:false},semanticObjectController:{type:"sap.ui.comp.navpopover.SemanticObjectController",multiple:false},customToolbar:{type:"sap.m.Toolbar",multiple:false},toolbar:{type:"sap.m.Toolbar",multiple:false,visibility:"hidden"}},associations:{ariaLabelledBy:{type:"sap.ui.core.Control",multiple:true,singularName:"ariaLabelledBy"}},events:{editToggled:{parameters:{editable:{type:"boolean"}}},checked:{parameters:{erroneousFields:{type:"sap.ui.comp.smartfield.SmartField[]"}}}}},renderer:_});v.prototype.init=function(){this._oForm=new o(this.getId()+"--Form");this._oForm.getToolbar=function(){var t=this.getParent();if(t&&!t.getExpandable()){return t._getToolbar()}};this.setAggregation("content",this._oForm);this._oRb=sap.ui.getCore().getLibraryResourceBundle("sap.ui.comp");this._oObserver=new s(B.bind(this));this._oObserver.observe(this,{properties:["editTogglable","title","checkButton","useHorizontalLayout","horizontalLayoutGroupElementMinWidth","expandable","expanded"],aggregations:["layout","customData"],associations:["ariaLabelledBy"]})};v.prototype.onBeforeRendering=function(){rt.call(this)};v.prototype.onAfterRendering=function(){var t=this.getSmartFields(false,false),e=this.getImportance();if(!this.isPropertyInitial("importance")){t.forEach(function(t){t._setVisibilityBasedOnImportance(e)})}};v.prototype.addGroup=function(t){var e=this,i,o,s;if(!t){return this}s=this._getSmartFieldsByGroup(t,false);s.forEach(function(t){i=t.setImportance;t.setImportance=function(){i.apply(this,arguments);o=e.getImportance();this._setVisibilityBasedOnImportance(o)}});t=this.validateAggregation("groups",t,true);z.call(this,t);this._oForm.addFormContainer(t);L.call(this,t);return this};v.prototype.getGroups=function(){return this._oForm.getFormContainers()};v.prototype.indexOfGroup=function(t){return this._oForm.indexOfFormContainer(t)};v.prototype.insertGroup=function(t,e){if(!t){return this}t=this.validateAggregation("groups",t,true);z.call(this,t);this._oForm.insertFormContainer(t,e);L.call(this,t);return this};v.prototype.removeGroup=function(t){var e=this._oForm.removeFormContainer(t);if(e){e.detachEvent("_visibleChanged",ft,this);H.call(this,e);ft.call(this)}return e};v.prototype.removeAllGroups=function(){var t=this._oForm.removeAllFormContainers();for(var e=0;e<t.length;e++){t[e].detachEvent("_visibleChanged",ft,this);H.call(this,t[e])}ft.call(this);return t};v.prototype.destroyGroups=function(){var t=this.getGroups();for(var e=0;e<t.length;e++){t[e].detachEvent("_visibleChanged",ft,this)}this._oForm.destroyFormContainers();ft.call(this);return this};function L(t){var e=this.getUseHorizontalLayout();var i=this.getHorizontalLayoutGroupElementMinWidth();t.attachEvent("_visibleChanged",ft,this);if(i!=t.getHorizontalLayoutGroupElementMinWidth){t.setHorizontalLayoutGroupElementMinWidth(i)}if(e!=t.getUseHorizontalLayout()){t.setUseHorizontalLayout(e)}if(e){t._updateGridDataSpan();t._updateLineBreaks()}else{ft.call(this)}}v.prototype._getToolbar=function(){var t=this.getCustomToolbar();return t||this.getAggregation("toolbar")};v.prototype.propagateGridDataSpan=function(){var t=this.getGroups();for(var e=0;e<t.length;e++){var i=t[e];i._updateGridDataSpan();i._updateLineBreaks()}return this};v.prototype._getGridDataSpanNumbers=function(){var t=this.getLayout();var e;if(t&&t._getGridDataSpanNumbers){e=t._getGridDataSpanNumbers()}return e};v.prototype._toggleEditMode=function(){var t=this.getEditable();this.setEditable(!t)};v.prototype.check=function(t){var e={considerOnlyVisible:true,handleSuccess:false};if(typeof t==="boolean"){e.considerOnlyVisible=t}else{e=Object.assign(e,t)}if(this.getValidationMode()===m.Standard){return this._checkClientError(e)}else{return this._checkClientErrorAsync(e)}};v.prototype._checkClientError=function(t){if(t.considerOnlyVisible===undefined){t.considerOnlyVisible=true}var e=this.getSmartFields(t.considerOnlyVisible,t.considerOnlyVisible);var i=[];var o=null;e.forEach(function(e){if(e.checkClientError&&e.checkClientError({handleSuccess:t.handleSuccess})){if(t.considerOnlyVisible&&e.getVisible){if(!e.getVisible()){return}}o=e.getParent();while(o.getParent){o=o.getParent();if(o.isA("sap.ui.comp.smartform.Group")){if(!o.getExpanded()){o.setExpanded(true)}break}}i.push(e.getId())}});return i};v.prototype._checkClientErrorAsync=function(t){var e=this.getSmartFields(t.considerOnlyVisible,t.considerOnlyVisible),i,o=[],s;this.setBusy(true);if(t.considerOnlyVisible===undefined){t.considerOnlyVisible=true}i=e.map(function(e){if(t.considerOnlyVisible&&!e.getVisible()){return false}return e.checkValuesValidity({handleSuccess:t.handleSuccess}).catch(function(){s=e.getParent();while(s.getParent){s=s.getParent();if(s.isA("sap.ui.comp.smartform.Group")){if(!s.getExpanded()){s.setExpanded(true)}break}}o.push(e.getId())})});return Promise.all(i).then(function(){this.setBusy(false);return o}.bind(this))};v.prototype._displayError=function(t){var e=this._oRb.getText("FORM_CLIENT_CHECK_ERROR_TITLE");var i=this._oRb.getText("FORM_CLIENT_CHECK_ERROR");if(!g&&!this._bMessageBoxRequested){g=sap.ui.require("sap/m/MessageBox");if(!g){sap.ui.require(["sap/m/MessageBox"],C.bind(this));this._bMessageBoxRequested=true}}if(g){g.show(i,{icon:g.Icon.ERROR,title:e,styleClass:this.$()&&this.$().closest(".sapUiSizeCompact").length?"sapUiSizeCompact":""})}};function C(t){g=t;this._bMessageBoxRequested=false;if(!this._bIsBeingDestroyed){T.call(this)}}function T(){var t=this.check(true);if(t&&t.length>0){this._displayError(t);return true}return false}function E(){return this.check(true).then(function(t){if(t&&t.length){this._displayError(t)}return t}.bind(this))}v.prototype.setEditable=function(t){var e=this.getEditable();t=this.validateProperty("editable",t);if(e===t){return this}if(!t&&this.hasListeners("editToggled")){if(this.getValidationMode()===m.Standard){if(T.call(this)){return this}}else{E.call(this).then(function(e){if(e.length){return this.setProperty("editable",true)}S.call(this,t)}.bind(this));return this.setProperty("editable",t)}}this.setProperty("editable",t);S.call(this,t);return this};function S(t){if(this._oForm){this._oForm.setEditable(t)}this.fireEditToggled({editable:t});if(this._oEditToggleButton){this._oEditToggleButton.setIcon(t?"sap-icon://display":"sap-icon://edit");var e=this._oRb.getText(t?"FORM_TOOLTIP_DISPLAY":"FORM_TOOLTIP_EDIT");this._oEditToggleButton.setTooltip(e)}if(this.getCheckButton()&&t){Z.call(this)}else{tt.call(this)}}function B(t){if(t.object==this){if(t.name=="editTogglable"){F.call(this,t.current)}else if(t.name=="title"){M.call(this,t.current)}else if(t.name=="checkButton"){k.call(this,t.current)}else if(t.name=="useHorizontalLayout"){I.call(this,t.current)}else if(t.name=="horizontalLayoutGroupElementMinWidth"){G.call(this,t.current)}else if(t.name=="expanded"){V.call(this,t.current)}else if(t.name=="expandable"){O.call(this,t.current)}else if(t.name=="layout"){R.call(this,t.child,t.mutation)}else if(t.name=="customData"){x.call(this,t.child,t.mutation)}else if(t.name=="ariaLabelledBy"){X.call(this,t.ids,t.mutation)}}else if(t.object.isA("sap.ui.comp.smartform.SmartFormLayout")){mt.call(this,t.object,t.name,t.current,t.old)}}function F(t){if(t){J.call(this)}else{Q.call(this)}N.call(this)}function M(t){if(this._oPanel){this._oPanel.setHeaderText(t)}N.call(this)}function k(t){if(t){Z.call(this)}else{tt.call(this)}N.call(this)}function I(t){if(t){this.addStyleClass("sapUiCompSmartFormHorizontalLayout")}else{this.removeStyleClass("sapUiCompSmartFormHorizontalLayout")}var e=this.getGroups();if(e){e.forEach(function(e){if(e.getUseHorizontalLayout()!=t){e.setUseHorizontalLayout(t)}})}var i=this.getLayout();if(t){pt.call(this,i)}else{rt.call(this);pt.call(this,i)}}function R(t,e){if(e==="remove"){this._oObserver.unobserve(t)}else{this._oObserver.observe(t,{properties:true})}if(t.isA("sap.ui.comp.smartform.Layout")){this.propagateGridDataSpan()}rt.call(this);pt.call(this,e==="insert"?t:null)}function G(t){a.error("HorizontalLayoutGroupElementMinWidth is deprecated",this);var e=this.getGroups();if(e){e.forEach(function(e){e.setHorizontalLayoutGroupElementMinWidth(t)})}}v.prototype.getVisibleProperties=function(){var t=[];var e=this.getGroups();if(e){e.forEach(function(e){var i=e.getGroupElements();if(i.length>0){i.forEach(function(e){var i=e.getElements();if(i.length>0){i.forEach(function(e){if(e.getVisible()){var i=e.getBindingPath("value");if(i){t.push(i)}}})}})}})}return t};v.prototype.setCustomToolbar=function(t){var e=this.getCustomToolbar();if(e==t){return this}K.call(this);Q.call(this);tt.call(this);this.setAggregation("customToolbar",t);if(this.getTitle()){N.call(this)}if(this.getEditTogglable()){J.call(this)}if(this.getCheckButton()){Z.call(this)}return this};v.prototype.destroyCustomToolbar=function(){var t=this.getCustomToolbar();if(t){K.call(this);Q.call(this);tt.call(this)}this.destroyAggregation("customToolbar");if(this.getTitle()){N.call(this)}if(this.getEditTogglable()){J.call(this)}if(this.getCheckButton()){Z.call(this)}return this};function O(t){if(t){if(!u&&!this._bPanelRequested){u=sap.ui.require("sap/m/Panel");if(!u){sap.ui.require(["sap/m/Panel"],q.bind(this));this._bPanelRequested=true}}if(u){P.call(this)}}else if(this._oPanel){this.setAggregation("content",this._oForm);this._oPanel.destroy();this._oPanel=null}N.call(this)}function P(){this._oPanel=new u(this.getId()+"--Panel",{expanded:this.getExpanded(),expandable:true,headerText:this.getTitle(),expandAnimation:false});this._oPanel.getHeaderToolbar=function(){var t=this.getParent();if(t){return t._getToolbar()}};this._oPanel.attachExpand(A,this);this.setAggregation("content",this._oPanel);this._oPanel.addContent(this._oForm)}function q(t){u=t;this._bPanelRequested=false;if(this.getExpandable()&&!this._bIsBeingDestroyed){P.call(this)}}function A(t){this.setProperty("expanded",t.getParameter("expand"),true)}function V(t){if(this._oPanel){this._oPanel.setExpanded(t)}}function x(t,e){var i=this.getGroups();for(var o=0;o<i.length;o++){if(e==="insert"){D.call(this,i[o],t)}else{H.call(this,i[o],t.getId())}}}function z(t){var e=this.getCustomData();for(var i=0;i<e.length;i++){D.call(this,t,e[i])}}function D(e,i){if(t.smartform.inheritCostomDataToFields(i)){var o=i.clone();o._bFromSmartForm=true;o._sOriginalId=i.getId();e.addCustomData(o)}}function H(t,e){var i=t.getCustomData();for(var o=0;o<i.length;o++){var s=i[o];if(s._bFromSmartForm&&(!e||e==s._sOriginalId)){t.removeCustomData(s)}}}function X(t,e){var i;if(Array.isArray(t)){i=t}else{i=[t]}for(var o=0;o<i.length;o++){var s=i[o];if(e==="insert"){this._oForm.addAriaLabelledBy(s)}else{this._oForm.removeAriaLabelledBy(s)}}}v.prototype._getSmartFieldsByGroup=function(t,e){var i=[],o=[],s=[];i=t.getGroupElements();for(var a=0;a<i.length;a++){var r=i[a];if(!e||e&&r.isVisible()){o=r.getElements();for(var n=0;n<o.length;n++){var l=o[n];if(l.isA("sap.ui.comp.smartfield.SmartField")){s.push(l)}}}}return s};v.prototype.getSmartFields=function(t,e){var i=[],o,s=[];if(t===undefined){t=true}i=this.getGroups();for(var a=0;a<i.length;a++){var r=i[a];if(!t||t&&r.isVisible()){o=this._getSmartFieldsByGroup(r,e);s=s.concat(o)}}return s};v.prototype.setFocusOnEditableControl=function(){var t=[];this.getGroups().forEach(function(e){if(e.isVisible()){e.getGroupElements().forEach(function(e){if(e.isVisible()){t=t.concat(e.getElements())}})}});t.some(function(t){if(t.getEditable&&t.getEditable()&&t.focus&&t.getVisible()){if(t.isA("sap.ui.comp.smartfield.SmartField")){t.attachEventOnce("innerControlsCreated",function(t){setTimeout(t.oSource._oControl[t.oSource._oControl.current]["focus"].bind(t.oSource._oControl[t.oSource._oControl.current]),0)})}else{t.focus()}return true}})};v.prototype.clone=function(t,i){this.setAggregation("content",null);var o=this.getAggregation("toolbar");var s=this.getCustomToolbar();var a=this.getCustomData();var r=this.getGroups();var n=0;if(s){K.call(this);Q.call(this);tt.call(this)}else if(o){this.setAggregation("toolbar",null)}if(a.length>0){for(n=0;n<r.length;n++){H.call(this,r[n])}}var l=e.prototype.clone.apply(this,arguments);for(n=0;n<r.length;n++){var u=r[n].clone(t,i);l.addGroup(u)}if(this.getExpandable()&&this._oPanel){this.setAggregation("content",this._oPanel)}else{this.setAggregation("content",this._oForm)}if(s){if(this.getTitle()){N.call(this)}if(this.getEditTogglable()){J.call(this)}if(this.getCheckButton()){Z.call(this)}}else if(o){this.setAggregation("toolbar",o)}if(a.length>0){for(n=0;n<r.length;n++){z.call(this,r[n])}}return l};v.prototype.exit=function(){if(this._oForm){this._oForm.destroy()}if(this._oPanel){this._oPanel.destroy()}if(this._oTitle){this._oTitle.destroy()}if(this._oEditToggleButton){this._oEditToggleButton.destroy()}this._oForm=null;this._oPanel=null;this._oTitle=null;this._oRb=null;this._oEditToggleButton=null;this._oObserver.disconnect();this._oObserver=undefined};function w(){var t=this.getAggregation("toolbar");if(!t){t=new p(this.getId()+"-toolbar-sfmain",{height:"3rem",design:d.ToolbarDesign.Transparent});t._bCreatedBySmartForm=true;this.setAggregation("toolbar",t)}return t}function U(t){var e=this.getAggregation("toolbar");if(e){if(t){var i=e.getContent();if(i.length>0){return}}this.destroyAggregation("toolbar")}}function N(){var t=this.getTitle();if(t){if(!this.getCustomToolbar()&&!this.getCheckButton()&&!this.getEditTogglable()){if(this._oTitle){if(this._getToolbar()){K.call(this)}this._oForm.removeAriaLabelledBy(this._oTitle);this._oTitle.destroy();this._oTitle=null}if(!this._oPanel){this._oForm.setTitle(t)}}else{this._oForm.setTitle();if(!this._oTitle){if((!h||!p||!c||!f||!d)&&!this._bTitleRequested){h=sap.ui.require("sap/m/Title");p=sap.ui.require("sap/m/OverflowToolbar");c=sap.ui.require("sap/m/ToolbarSpacer");f=sap.ui.require("sap/m/ToolbarSeparator");d=sap.ui.require("sap/m/library");if(!h||!p||!c||!f||!d){sap.ui.require(["sap/m/Title","sap/m/OverflowToolbar","sap/m/ToolbarSpacer","sap/m/ToolbarSeparator","sap/m/library"],W.bind(this));this._bTitleRequested=true}}if(h&&!this._bTitleRequested){var e=i.get("sap.ui.layout.FormLayout:_sap_ui_layout_FormLayout_FormTitleSize");this._oTitle=new h(this.getId()+"-title-sfmain",{level:e.toUpperCase()})}}if(this._oTitle){this._oTitle.setText(t);this._oForm.addAriaLabelledBy(this._oTitle);j.call(this)}}}else{if(this._oTitle){K.call(this);this._oForm.removeAriaLabelledBy(this._oTitle);this._oTitle.destroy();this._oTitle=null}else{this._oForm.setTitle()}}}function W(t,e,i,o,s){h=t;p=e;c=i;f=o;d=s;this._bTitleRequested=false;if(!this._bIsBeingDestroyed){N.call(this)}}function j(){if(!this._oTitle){return}var t=this._getToolbar();if(!t){t=w.call(this)}t.insertContent(this._oTitle,0)}function K(){if(!this._oTitle){return}var t=this._getToolbar();t.removeContent(this._oTitle);U.call(this,true)}function Y(){if((!n||!p||!c||!f||!d)&&!this._bButtonRequested){n=sap.ui.require("sap/m/Button");p=sap.ui.require("sap/m/OverflowToolbar");c=sap.ui.require("sap/m/ToolbarSpacer");f=sap.ui.require("sap/m/ToolbarSeparator");d=sap.ui.require("sap/m/library");if(!n||!p||!c||!f||!d){sap.ui.require(["sap/m/Button","sap/m/OverflowToolbar","sap/m/ToolbarSpacer","sap/m/ToolbarSeparator","sap/m/library"],$.bind(this));this._bButtonRequested=true}}if(n&&!this._bButtonRequested){return true}return false}function $(t,e,i,o,s){n=t;p=e;c=i;f=o;d=s;this._bButtonRequested=false;if(!this._bIsBeingDestroyed){if(this._bEditRequested){this._bEditRequested=false;J.call(this)}if(this._bCheckRequested){this._bCheckRequested=false;Z.call(this)}}}function J(){if(!this.getEditTogglable()){return}if(!Y.call(this)){this._bEditRequested=true;return}var t=this._getToolbar();if(!t){t=w.call(this)}if(!this._oCheckButton){ot.call(this,t)}if(!this._oEditToggleButton){var e=this.getEditable()?"sap-icon://display":"sap-icon://edit";var i=this._oRb.getText(this.getEditable()?"FORM_TOOLTIP_DISPLAY":"FORM_TOOLTIP_EDIT");this._oEditToggleButton=new n(t.getId()+"-button-sfmain-editToggle",{icon:e,tooltip:i});this._oEditToggleButton.attachPress(this._toggleEditMode,this)}var o=t.getContent().length;if(this._oCheckButton){o--}t.insertContent(this._oEditToggleButton,o)}function Q(){if(!this._oEditToggleButton){return}var t=this._getToolbar();t.removeContent(this._oEditToggleButton);this._oEditToggleButton.destroy();this._oEditToggleButton=null;st.call(this,t);U.call(this,true)}function Z(){if(!this.getCheckButton()||!this.getEditable()){return}if(!Y.call(this)){this._bCheckRequested=true;return}var t=this._getToolbar();if(!t){t=w.call(this)}if(!this._oEditToggleButton){ot.call(this,t)}if(!this._oCheckButton){this._oCheckButton=new n(this.getId()+"-"+t.getId()+"-button-sfmain-check",{text:this._oRb.getText("SMART_FORM_CHECK")});this._oCheckButton.attachPress(this.getValidationMode()===m.Standard?et:it,this)}var e=t.getContent().length;t.insertContent(this._oCheckButton,e)}function tt(){if(!this._oCheckButton){return}var t=this._getToolbar();t.removeContent(this._oCheckButton);this._oCheckButton.destroy();this._oCheckButton=null;st.call(this,t);U.call(this,true)}function et(t){var e=[];e=this.check(true);this.fireChecked({erroneousFields:e})}function it(t){this.check(true).then(function(t){this.fireChecked({erroneousFields:t})}.bind(this))}function ot(t){var e;if(!t._bCreatedBySmartForm){var i=t.getContent();var o=false;for(var s=0;s<i.length;s++){if(i[s]instanceof c){o=true;break}}if(!o){e=new c(this.getId()+"-"+t.getId()+"-spacer");e._bCreatedBySmartForm=true;t.addContent(e)}if(!(i[i.length-1]instanceof f)){var a=new f(this.getId()+"-"+t.getId()+"-separator");a._bCreatedBySmartForm=true;t.addContent(a)}}else{e=new c(t.getId()+"-spacer");e._bCreatedBySmartForm=true;t.addContent(e)}}function st(t){var e=t.getContent();var i;if(!t._bCreatedBySmartForm){i=e[e.length-1];if(i instanceof f&&i._bCreatedBySmartForm){i.destroy()}e=t.getContent()}i=e[e.length-1];if(i instanceof c&&i._bCreatedBySmartForm){i.destroy()}}function at(t,e){if(!t.layout&&!t.requested){t.layout=sap.ui.require(t.path);if(!t.layout){t.promise=new Promise(function(e){sap.ui.require([t.path],t.loaded.bind(this));t.resolve=e;t.requestIds=[this.getId()]}.bind(this));t.requested=true}}else if(!t.layout&&t.requested&&t.promise&&t.requestIds.indexOf(this.getId())<0){t.promise.then(function(){if(!this._bIsBeingDestroyed){rt.call(this)}}.bind(this));t.requestIds.push(this.getId())}if(t.layout&&!t.requested&&!(e instanceof t.layout)){if(e){e.destroy()}e=new t.layout(this._oForm.getId()+"-layout");this._oForm.setLayout(e);return true}return false}function rt(){var t=this.getLayout();var e=this._oForm.getLayout();var i=this.getUseHorizontalLayout();var o=false;if(t&&t.isA("sap.ui.comp.smartform.ColumnLayout")){if(i){throw new Error("ColumnLayout and useHorizontalLayout must not ne used at the same time on "+this)}o=at.call(this,b.ColumnLayout,e);if(o){dt.call(this,t)}}else if(i&&(!t||!t.getGridDataSpan())){o=at.call(this,b.ResponsiveLayout,e)}else if(!e||!b.ResponsiveGridLayout.layout||!(e instanceof b.ResponsiveGridLayout.layout)){o=at.call(this,b.ResponsiveGridLayout,e);if(o){this._oFormLayoutNotInitial=true;ct.call(this,t)}}if(o){var s=this.getGroups();for(var a=0;a<s.length;a++){var r=s[a];r._updateLayoutData()}}}function nt(t,e){t.layout=e;t.requested=false;t.resolve();delete t.resolve;delete t.requestIds;t.promise=undefined;if(!this._bIsBeingDestroyed){rt.call(this)}}function lt(t){nt.call(this,b.ResponsiveGridLayout,t)}function ut(t){nt.call(this,b.ResponsiveLayout,t)}function ht(t){nt.call(this,b.ColumnLayout,t)}function pt(t){if(!t||t.isA("sap.ui.comp.smartform.Layout")){ct.call(this,t)}else if(t.isA("sap.ui.comp.smartform.ColumnLayout")){dt.call(this,t)}}function ct(t){var e=this._oForm.getLayout();if(!e||!e.isA(b.ResponsiveGridLayout.name)){return}if(this.getUseHorizontalLayout()){if(t&&t.getGridDataSpan()){gt.call(this,e);e.setColumnsL(1);e.setColumnsM(1);if(t.getBreakpointM()>0){e.setBreakpointM(t.getBreakpointM())}if(t.getBreakpointL()>0){e.setBreakpointL(t.getBreakpointL())}if(t.getBreakpointXL()>0){e.setBreakpointXL(t.getBreakpointXL())}this._oFormLayoutNotInitial=true}}else{if(t){e.setLabelSpanXL(t.getLabelSpanXL()?t.getLabelSpanXL():-1);e.setLabelSpanL(t.getLabelSpanL()?t.getLabelSpanL():4);e.setLabelSpanM(t.getLabelSpanM()?t.getLabelSpanM():4);e.setLabelSpanS(t.getLabelSpanS()?t.getLabelSpanS():12);e.setEmptySpanXL(t.getEmptySpanXL()?t.getEmptySpanXL():-1);e.setEmptySpanL(t.getEmptySpanL()?t.getEmptySpanL():0);e.setEmptySpanM(t.getEmptySpanM()?t.getEmptySpanM():0);e.setColumnsXL(t.getColumnsXL()?t.getColumnsXL():-1);e.setColumnsL(t.getColumnsL()?t.getColumnsL():3);e.setColumnsM(t.getColumnsM()?t.getColumnsM():2);e.setSingleContainerFullSize(t.getSingleGroupFullSize());e.setBreakpointXL(t.getBreakpointXL()?t.getBreakpointXL():1440);e.setBreakpointL(t.getBreakpointL()?t.getBreakpointL():1024);e.setBreakpointM(t.getBreakpointM()?t.getBreakpointM():600);this._oFormLayoutNotInitial=true}else{gt.call(this,e)}ft.call(this,t,e)}}function ft(t,e){if(this.getUseHorizontalLayout()){return}if(!e){e=this._oForm.getLayout();t=this.getLayout()}if(!e||!e.isA(b.ResponsiveGridLayout.name)){return}var i=this.getGroups();var o=-1;var s=3;var a=true;var r=0;for(var n=0;n<i.length;n++){if(i[n].isVisible()){r++}}if(t){s=t.getColumnsL()?t.getColumnsL():3;o=t.getColumnsXL()>0?t.getColumnsXL():-1;a=t.getSingleGroupFullSize()}if(i&&r>0&&r<o&&a){e.setColumnsXL(r)}else if(e.getColumnsXL()!=o){e.setColumnsXL(o)}if(i&&r>0&&r<s&&a){e.setColumnsL(r)}else if(e.getColumnsL()!=s){e.setColumnsL(s)}}function gt(t){if(this._oFormLayoutNotInitial){t.setLabelSpanXL(-1);t.setLabelSpanL(4);t.setLabelSpanM(4);t.setLabelSpanS(12);t.setEmptySpanXL(-1);t.setEmptySpanL(0);t.setEmptySpanM(0);t.setColumnsXL(-1);t.setColumnsL(3);t.setColumnsM(2);t.setSingleContainerFullSize(true);t.setBreakpointXL(1440);t.setBreakpointL(1024);t.setBreakpointM(600);this._oFormLayoutNotInitial=false}}function dt(t){var e=this._oForm.getLayout();if(!e||!e.isA(b.ColumnLayout.name)){return}if(this.getUseHorizontalLayout()){throw new Error("ColumnLayout and useHorizontalLayout must not ne used at the same time on "+this)}else{e.setColumnsXL(t.getColumnsXL());e.setColumnsL(t.getColumnsL());e.setColumnsM(t.getColumnsM());e.setLabelCellsLarge(t.getLabelCellsLarge());e.setEmptyCellsLarge(t.getEmptyCellsLarge())}}function mt(t,e,i,o){pt.call(this,t);if(e==="gridDataSpan"){this.propagateGridDataSpan();if(i===""||o===""){rt.call(this)}}}v.prototype._suggestTitleId=function(t){this._oForm._suggestTitleId(t);return this};return v});
/*!
 * SAPUI5
 * (c) Copyright 2009-2023 SAP SE. All rights reserved.
 */
sap.ui.predefine("sap/ui/comp/smartform/flexibility/SmartForm.flexibility", ["sap/ui/comp/smartform/flexibility/changes/RemoveGroup","sap/ui/comp/smartform/flexibility/changes/AddGroup","sap/ui/comp/smartform/flexibility/changes/MoveGroups","sap/ui/comp/smartform/flexibility/changes/RenameTitle","sap/ui/comp/smartform/flexibility/changes/CombineFields","sap/ui/comp/smartform/flexibility/changes/SplitField","sap/ui/comp/smartform/flexibility/changes/MoveFields"],function(i,e,o,s,m,r,a){"use strict";return{removeGroup:i,addGroup:e,moveGroups:o,renameField:s,combineFields:m,splitField:r,moveControls:a}},true);
/*!
 * SAPUI5
 * (c) Copyright 2009-2023 SAP SE. All rights reserved.
 */
sap.ui.predefine("sap/ui/comp/smartform/flexibility/changes/AddField", ["sap/ui/fl/changeHandler/Base","sap/ui/core/util/reflection/JsControlTreeModifier","sap/ui/comp/smartform/flexibility/changes/AddFields"],function(e,r,t){"use strict";var i={};i.applyChange=function(r,i,n){var l=r.getTexts();var o=r.getContent();var a=function(){var e=l&&l.fieldLabel&&l.fieldLabel.value;var r=o;var t=false;if(r){t=o.field&&(o.field.selector||o.field.id)&&o.field.jsType&&o.field.value&&o.field.valueProperty}return e&&r&&t};var f=n.modifier;var d=n.appComponent;var u=n.view;if(a()){var s=o.field.selector;var p=o.field.id;var c=l.fieldLabel.value;var v=o.field.jsType;var C=o.field.valueProperty;var g=o.field.value;var h=o.field.entitySet;var y=o.field.index;if(f.bySelector(s||p,d,u)){return e.markAsNotApplicable("Control to be created already exists:"+s||p,true)}return Promise.resolve().then(f.createControl.bind(f,"sap.ui.comp.smartform.GroupElement",d,u,s||p)).then(function(e){if(!s){s=f.getSelector(p,d)}r.setRevertData({newFieldSelector:s});f.setProperty(e,"label",undefined);f.setProperty(e,"label",c);return Promise.resolve().then(f.insertAggregation.bind(f,i,"groupElements",e,y,u)).then(function(){return t.addElementIntoGroupElement(f,u,e,v,C,g,h,y,d)})})}return Promise.resolve()};i.completeChangeContent=function(e,t,i){var n=i.appComponent;if(t.fieldLabel){e.setText("fieldLabel",t.fieldLabel,"XFLD")}else{throw new Error("oSpecificChangeInfo.fieldLabel attribute required")}var l={field:{}};if(t.fieldValue){l.field.value=t.fieldValue}else{throw new Error("oSpecificChangeInfo.fieldValue attribute required")}if(t.valueProperty){l.field.valueProperty=t.valueProperty}else{throw new Error("oSpecificChangeInfo.valueProperty attribute required")}if(t.newControlId){l.field.selector=r.getSelector(t.newControlId,n,{index:t.index})}else{throw new Error("oSpecificChangeInfo.newControlId attribute required")}if(t.jsType){l.field.jsType=t.jsType}else{throw new Error("oSpecificChangeInfo.jsType attribute required")}if(t.index===undefined){throw new Error("oSpecificChangeInfo.index attribute required")}else{l.field.index=t.index}if(t.entitySet){l.field.entitySet=t.entitySet}e.setContent(l)};i.revertChange=function(e,r,i){return t.revertChange(e,r,i)};i.getChangeVisualizationInfo=function(e){return{affectedControls:[e.getContent().field.selector]}};return i},true);
/*!
 * SAPUI5
 * (c) Copyright 2009-2023 SAP SE. All rights reserved.
 */
sap.ui.predefine("sap/ui/comp/smartform/flexibility/changes/AddFields", ["sap/ui/fl/changeHandler/Base","sap/ui/fl/apply/api/DelegateMediatorAPI","sap/ui/core/util/reflection/JsControlTreeModifier","sap/base/util/merge","sap/base/util/ObjectPath","sap/ui/fl/changeHandler/condenser/Classification"],function(e,t,r,n,o,i){"use strict";function a(e){return typeof e==="function"}function l(e,t){return e+"-element"+t}function u(e){var t=false;t=e.field&&(e.field.selector||e.field.id)&&e.field.jsTypes&&e.field.value&&e.field.valueProperty;if(!t){throw new Error("Change does not contain sufficient information to be applied.")}}function f(e,t){var r=n({},e);r.fieldSelector.id=l(r.fieldSelector.id,0);return t.createControlForProperty(r).then(function(r){var n=e.modifier.getId(r.control);e.labelFor=n;return t.createLabel(e).then(function(e){return{label:e,control:r.control}})})}function d(e,t){var r=n({aggregationName:"formElements",payload:e.payload||{}},t);var i=e.instance;return Promise.resolve().then(function(){if(a(i.createLayout)){return i.createLayout(r)}}).then(function(e){if(o.get("control",e)){e.layoutControl=true;return e}return f(r,i)})}var s={};s.applyChange=function(t,r,n){var o=t.getContent();var i=n.modifier;var a=n.appComponent;var l=o.field.selector;var f=n.view;var d=o.field.id;if(i.bySelector(l||d,a,f)){return e.markAsNotApplicable("Control to be created already exists:"+l||d,true)}var c=o.field.index;var g=t.getDependentControl("form",n);var p=g&&i.getFlexDelegate(g);if(!p){u(o);var v;return Promise.resolve().then(i.createControl.bind(i,"sap.ui.comp.smartform.GroupElement",a,f,l||d)).then(function(e){v=e;if(!l){l=i.getSelector(d,a)}t.setRevertData({newFieldSelector:l});return o.field.jsTypes.reduce(function(e,t,r){var n=o.field.valueProperty[r];var l=o.field.value[r];var u=o.field.entitySet;return e.then(this.addElementIntoGroupElement.bind(this,i,f,v,t,n,l,u,r,a))}.bind(this),Promise.resolve())}.bind(this)).then(function(){return i.insertAggregation(r,"groupElements",v,c)})}return s._addFieldFromDelegate(g,r,l,d,c,o.field.value[0],t,i,f,a)};s._addFieldFromDelegate=function(e,r,n,o,i,a,l,u,f,s){var c;var g;return t.getDelegateForControl({control:e,modifier:u}).then(function(t){var r={appComponent:s,view:f,fieldSelector:n||o,bindingPath:a,modifier:u,element:e};return d(t,r)}).then(function(e){g=e;if(!g.layoutControl){return Promise.resolve().then(u.createControl.bind(u,"sap.ui.comp.smartform.GroupElement",s,f,n||o)).then(function(e){c=e;return Promise.resolve().then(u.insertAggregation.bind(u,c,"label",g.label,0,f)).then(u.insertAggregation.bind(u,c,"fields",g.control,0,f)).then(function(){return c})})}return g.control}).then(function(e){return u.insertAggregation(r,"groupElements",e,i,f)}).then(function(){if(g.valueHelp){return u.insertAggregation(e,"dependents",g.valueHelp,0,f)}}).then(function(){if(!n){n=u.getSelector(o,s)}l.setRevertData({newFieldSelector:n,valueHelpSelector:g.valueHelp&&u.getSelector(g.valueHelp,s)})})};s.addElementIntoGroupElement=function(t,r,n,o,i,a,u,f,d){var s;var c=t.getId(n);var g=l(c,f);return Promise.resolve().then(t.createControl.bind(t,o,d,r,g)).then(function(e){s=e;t.bindProperty(s,i,a);t.setProperty(s,"expandNavigationProperties",true);return t.insertAggregation(n,"elements",s,f,r,true)}).then(function(){if(u){t.setProperty(s,"entitySet",u)}}).catch(function(t){return e.markAsNotApplicable(t&&t.message||"Control couldn't be created",true)})};s.completeChangeContent=function(e,t,n){var o=n.appComponent;var i={field:{}};if(t.fieldValues){i.field.value=t.fieldValues}else if(t.bindingPath){i.field.value=[t.bindingPath]}else{throw new Error("oSpecificChangeInfo.fieldValue or bindingPath attribute required")}if(t.valueProperty){i.field.valueProperty=t.valueProperty}else if(t.bindingPath){i.field.valueProperty=["value"]}else{throw new Error("oSpecificChangeInfo.valueProperty or bindingPath attribute required")}if(t.newControlId){i.field.selector=r.getSelector(t.newControlId,o)}else{throw new Error("oSpecificChangeInfo.newControlId attribute required")}if(t.jsTypes){i.field.jsTypes=t.jsTypes}else if(t.bindingPath){i.field.jsTypes=["sap.ui.comp.smartfield.SmartField"]}else{throw new Error("oSpecificChangeInfo.jsTypes or bindingPath attribute required")}if(t.index===undefined){throw new Error("oSpecificChangeInfo.index attribute required")}else{i.field.index=t.index}if(t.entitySet){i.field.entitySet=t.entitySet}e.setContent(i);if(t.relevantContainerId){e.addDependentControl(t.relevantContainerId,"form",n)}};s.revertChange=function(e,t,r){var n=r.appComponent;var o=r.view;var i=r.modifier;var a=e.getRevertData();var l=a.newFieldSelector;var u=i.bySelector(l,n,o);return Promise.resolve().then(i.removeAggregation.bind(i,t,"groupElements",u)).then(function(){i.destroy(u);var t=a.valueHelpSelector;if(t){var l=i.bySelector(t,n,o);var f=e.getDependentControl("form",r);return Promise.resolve().then(i.removeAggregation.bind(i,f,"dependents",l)).then(function(){i.destroy(l)})}}).then(function(){e.resetRevertData()})};s.getCondenserInfo=function(e){return{affectedControl:e.getContent().field.selector,classification:i.Create,targetContainer:e.getSelector(),targetAggregation:"groupElements",setTargetIndex:function(e,t){e.getContent().field.index=t},getTargetIndex:function(e){return e.getContent().field.index}}};s.getChangeVisualizationInfo=function(e){return{affectedControls:[e.getContent().field.selector]}};return s},true);
/*!
 * SAPUI5
 * (c) Copyright 2009-2023 SAP SE. All rights reserved.
 */
sap.ui.predefine("sap/ui/comp/smartform/flexibility/changes/AddGroup", ["sap/ui/core/util/reflection/JsControlTreeModifier"],function(e){"use strict";var r={};r.applyChange=function(e,r,o){var t=o.modifier;var n=o.appComponent;var i=o.view;var a=e.getContent();var u=e.getTexts();if(u&&u.groupLabel&&u.groupLabel.value&&a&&a.group&&(a.group.selector||a.group.id)){var p=u.groupLabel.value;var l=a.group.index;var g=a.group.selector;return Promise.resolve().then(t.createControl.bind(t,"sap.ui.comp.smartform.Group",n,i,a.group.selector||a.group.id)).then(function(o){if(!g){g=t.getSelector(a.group.id,n)}e.setRevertData({newGroupSelector:g});t.setProperty(o,"visible",true);t.setProperty(o,"label",p);return t.insertAggregation(r,"groups",o,l,i)})}return Promise.resolve()};r.completeChangeContent=function(r,o,t){var n=t.appComponent;var i={group:{}};if(o.newLabel){r.setText("groupLabel",o.newLabel,"XFLD")}else{throw new Error("oSpecificChangeInfo.groupLabel attribute required")}if(o.index===undefined){throw new Error("oSpecificChangeInfo.index attribute required")}else{i.group.index=o.index}if(o.newControlId){i.group.selector=e.getSelector(o.newControlId,n)}else{throw new Error("oSpecificChangeInfo.newControlId attribute required")}r.setContent(i)};r.revertChange=function(e,r,o){var t=o.appComponent;var n=o.view;var i=o.modifier;var a=e.getRevertData().newGroupSelector;var u=i.bySelector(a,t,n);return Promise.resolve().then(i.removeAggregation.bind(i,r,"groups",u)).then(function(){i.destroy(u);e.resetRevertData()})};r.getChangeVisualizationInfo=function(e){var r=e.getText("groupLabel");return{affectedControls:[e.getContent().group.selector],descriptionPayload:{originalLabel:r}}};return r},true);
/*!
 * SAPUI5
 * (c) Copyright 2009-2023 SAP SE. All rights reserved.
 */
sap.ui.predefine("sap/ui/comp/smartform/flexibility/changes/CombineFields", ["sap/ui/comp/smartform/flexibility/changes/RenameField","sap/ui/core/Configuration"],function(e,n){"use strict";var t={};function r(e,n,t){return Promise.all(n.map(function(n){if(!t.found){t.index++;return e.getProperty(n,"mandatory").then(function(e){t.found=t.found||e})}return undefined}))}function o(e,n){var t={found:false,index:-1};return n.reduce(function(n,o){return n.then(e.getAggregation.bind(e,o,"fields")).then(function(n){if(!t.found){return r(e,n,t)}return undefined})},Promise.resolve()).then(function(){return t.found?t.index:-1})}t._getPreviousLabelPropertyOnControl=function(e,n,t){return Promise.resolve().then(n.getProperty.bind(n,e,t)).then(function(r){if(r&&typeof r!=="string"){t="text";e=r}return n.getPropertyBindingOrProperty(e,t)}).then(function(e){return e?e:"$$Handled_Internally$$"})};function i(e){return!!e.newElementId}function l(e,n,t){var r=e.modifier;var o=e.appComponent;var l=e.view;if(i(n)){return r.getAggregation(t,"dependents").then(function(i){var u=i.find(function(e){return r.bySelector(n.newElementId,o,l)});if(u){return r.removeAggregation(t,"dependents",u).then(function(){return u})}return r.createControl("sap.ui.comp.smartform.GroupElement",e.appComponent,e.view,n.newElementId)})}return Promise.resolve(r.bySelector(n.sourceSelector,o,l))}function u(e,n,t,r){return r.getAggregation(e,"groupElements").then(function(e){var r=e.indexOf(n);return t.reduce(function(n,t){var o=e.indexOf(t);if(o>-1&&o<r){n=n-1}return n},r)})}function a(e,n,t,r,o,i,l){if(o.newElementId||e!==n){var u=t.getParent(e);return l.reduce(function(o,l,u){return o.then(t.removeAggregation.bind(t,e,"elements",l)).then(t.insertAggregation.bind(t,n,"elements",l,i+u,r))},Promise.resolve()).then(t.removeAggregation.bind(t,u,"groupElements",e)).then(t.insertAggregation.bind(t,u,"dependents",e,0,r)).then(function(){return i+(l.length||0)})}return Promise.resolve(0)}t.applyChange=function(t,r,g){var c=t.getContent();var s=g.modifier;var d=g.appComponent;var f=g.view;var m=s.bySelector(c.sourceSelector,d,f);var v=s.getParent(m);var p=[];var h;var b;var S;var P;var C=c.combineFieldSelectors.map(function(e){return s.bySelector(e,d,f)});return l(g,c,v).then(function(e){if(e){return u(v,m,C,s).then(function(n){if(n>-1){P=n;m=e}}).then(this._collectRevertDataForElements.bind(this,s,C,d,e,v))}return this._collectRevertDataForElements(s,C,d)}.bind(this)).then(function(e){S=e}).then(function(){return o(s,C).then(function(e){if(e>0){s.setProperty(m,"elementForLabel",e)}})}).then(function(){var e=n.getRTL();var r=0;return C.reduce(function(n,o,i){return n.then(function(n){r=r+n;var l="fieldLabel"+i.toString();b=t.getText(l);if(b&&b!==h){if(e){p.unshift(b)}else{p.push(b)}h=b}return s.getAggregation(o,"elements")}).then(function(e){return a(o,m,s,f,c,r,e)})},Promise.resolve(0))}).then(function(){return e.setLabelPropertyOnControl(m,p.join("/"),s,"label")}).then(function(){if(i(c)){return s.insertAggregation(v,"groupElements",m,P,f)}return undefined}).then(function(){t.setRevertData(S)})};t._collectRevertDataForElements=function(e,n,t,r,o){var i={elementStates:[]};var l=0;var u=0;var a=[];if(r){a.push(r);a=a.concat(n)}return Promise.all(a.map(function(n){var r=e.getParent(n)||o;return Promise.all([e.getAggregation(n,"elements"),e.getAggregation(r,"groupElements"),this._getPreviousLabelPropertyOnControl(n,e,"label"),e.getProperty(n,"elementForLabel")]).then(function(o){u=l+o[0].length-1;i.elementStates.push({groupElementSelector:e.getSelector(e.getId(n),t),parentSelector:e.getSelector(e.getId(r),t),groupElementIndex:o[1].indexOf(n),firstFieldIndex:l,lastFieldIndex:u,label:o[2],elementForLabel:o[3]});l=u+1})}.bind(this))).then(function(){return i})};t.revertChange=function(n,t,r){var o=n.getRevertData();var l=r.modifier;var u=r.appComponent;var a=[];o.elementStates=o.elementStates.sort(function(e,n){return e.groupElementIndex-n.groupElementIndex});return o.elementStates.reduce(function(e,t){var r=l.bySelector(t.parentSelector,u);var o=l.bySelector(t.groupElementSelector,u);return e.then(l.getAggregation.bind(l,r,"groupElements")).then(function(e){if(e.indexOf(o)===-1){return Promise.resolve().then(l.removeAggregation.bind(l,r,"dependents",o)).then(l.insertAggregation.bind(l,r,"groupElements",o,t.groupElementIndex))}else{return Promise.resolve().then(l.getAggregation.bind(l,o,"elements")).then(function(e){a=e;return l.removeAllAggregation(o,"elements")}).then(function(){if(i(n.getContent())){return l.removeAggregation(r,"groupElements",o).then(l.insertAggregation.bind(l,r,"dependents",o))}return undefined})}})},Promise.resolve()).then(function(){return o.elementStates.reduce(function(n,t){var r;var o;return n.then(function(){r=l.bySelector(t.groupElementSelector,u);var e=[];for(var n=t.firstFieldIndex;n<=t.lastFieldIndex;n++){e.push(l.insertAggregation(r,"elements",a[n],a.length))}return Promise.all(e)}).then(function(){o=t.label;if(o==="$$Handled_Internally$$"){o=undefined;return l.getAggregation(r,"fields")}return undefined}).then(function(n){if(n&&n.length){var i=n[t.elementForLabel];l.setProperty(i,"textLabel",undefined)}l.setProperty(r,"elementForLabel",t.elementForLabel);return e.setLabelPropertyOnControl(r,o,l,"label")})},Promise.resolve())}).then(n.resetRevertData.bind(n))};t.completeChangeContent=function(e,n,t){var r=t.modifier;var o=t.view;var i=t.appComponent;var l={};if(n.newElementId){l.newElementId=n.newElementId}var u=n.combineElementIds;if(u&&u.length>=2){l.combineFieldSelectors=u.map(function(e){return r.getSelector(e,i)});e.addDependentControl(u,"combinedFields",t)}else{throw new Error("oSpecificChangeInfo.combineElementIds attribute required")}if(n.sourceControlId){l.sourceSelector=r.getSelector(n.sourceControlId,i);e.addDependentControl(n.sourceControlId,"sourceControl",t)}else{throw new Error("oSpecificChangeInfo.sourceControlId attribute required")}var a;var g;var c;for(var s=0;s<l.combineFieldSelectors.length;s++){var d=l.combineFieldSelectors[s];c=r.bySelector(d,i,o);a=c.getLabelText();if(a){g="fieldLabel"+s;e.setText(g,a,"XFLD")}}e.setContent(l)};t.getChangeVisualizationInfo=function(e){var n=e.getContent();return{displayControls:[n.newElementId],affectedControls:[n.sourceSelector],descriptionPayload:{originalSelectors:n.combineFieldSelectors}}};return t},true);
/*!
 * SAPUI5
 * (c) Copyright 2009-2023 SAP SE. All rights reserved.
 */
sap.ui.predefine("sap/ui/comp/smartform/flexibility/changes/MoveFields", ["sap/ui/fl/changeHandler/MoveControls"],function(e){"use strict";var n=Object.assign({},e);n.applyChange=function(n,t,r){var g=Object.assign({},r,{targetAggregation:"groupElements",sourceAggregation:"groupElements"});return e.applyChange.call(this,n,t,g)};n.getCondenserInfo=function(n){var t=e.getCondenserInfo.call(this,n);t.targetAggregation="groupElements";return t};return n},true);
/*!
 * SAPUI5
 * (c) Copyright 2009-2023 SAP SE. All rights reserved.
 */
sap.ui.predefine("sap/ui/comp/smartform/flexibility/changes/MoveGroups", ["sap/base/Log","sap/ui/core/util/reflection/JsControlTreeModifier"],function(e,n){"use strict";var r={};r._checkCompleteChangeContentConditions=function(e){if(!e.movedElements){throw new Error("oSpecificChangeInfo.movedElements attribute required")}if(e.movedElements.length===0){throw new Error("MovedElements array is empty")}e.movedElements.forEach(function(e){if(!e.id){throw new Error("MovedElements element has no id attribute")}if(typeof e.targetIndex!=="number"){throw new Error("Index attribute at MovedElements element is no number")}})};r._buildStableChangeInfo=function(e){var n=e.source.id;var r=e.target.id;var t={changeType:e.changeType,selector:{id:n},targetId:r!==n?r:null};t[e.changeType]=[];e.movedElements.forEach(function(n){t[e.changeType].push({id:n.id,sourceIndex:n.sourceIndex,index:n.targetIndex})});return t};r.applyChange=function(n,r,t){function o(n,t){if(!n){return Promise.reject(new Error("No change instance"))}var o=n.getContent();return Promise.resolve().then(t.getAggregation.bind(t,r,"groups")).then(function(n){if(!n){e.error("Object has no smartform elements aggregation",t.getId(r))}if(!o||!o.moveGroups||o.moveGroups.length===0){return Promise.reject(new Error("Change format invalid"))}return undefined})}function i(e,n,r,t){if(!e.selector&&!e.id){return Promise.reject(new Error("Change format invalid - moveGroups element has no id attribute"))}if(typeof e.index!=="number"){return Promise.reject(new Error("Change format invalid - moveGroups element index attribute is no number"))}return Promise.resolve(n.bySelector(e.selector||e.id,r,t))}var u=t.modifier;var a=t.view;var s=t.appComponent;var d=[];function c(n,t){if(!t){return Promise.resolve(e.warning("Group to move not found"))}return Promise.resolve().then(u.findIndexInParentAggregation.bind(u,t)).then(function(e){if(e===n.index&&typeof n.sourceIndex==="number"){e=n.sourceIndex}d.push({selector:u.getSelector(t,s),index:e})}).then(u.removeAggregation.bind(u,r,"groups",t,a)).then(u.insertAggregation.bind(u,r,"groups",t,n.index))}return o(n,u).then(function(){var e=n.getContent();return e.moveGroups.reduce(function(e,n){return e.then(i.bind(null,n,u,s,a)).then(function(e){return c(n,e)})},Promise.resolve())}).then(function(){n.setRevertData({movedGroups:d})})};r.completeChangeContent=function(e,r,t){this._checkCompleteChangeContentConditions(r);r=this._buildStableChangeInfo(r);var o={moveGroups:[]};var i=r.moveGroups.map(function(e){var r=sap.ui.getCore().byId(e.id);var i=n.getSelector(r,t.appComponent);o.moveGroups.push({selector:i,sourceIndex:e.sourceIndex,index:e.index});return r});e.addDependentControl(i,"movedGroups",t);e.setContent(o)};r.revertChange=function(e,n,r){var t=r.appComponent;var o=r.view;var i=r.modifier;var u=e.getRevertData().movedGroups;return u.reduce(function(e,r){var u=i.bySelector(r.selector,t,o);return e.then(i.removeAggregation.bind(i,n,"groups",u,o)).then(i.insertAggregation.bind(i,n,"groups",u,r.index))},Promise.resolve()).then(function(){e.resetRevertData()})};r.getChangeVisualizationInfo=function(e){var n=e.getContent();return{affectedControls:[n.moveGroups[0].selector],dependentControls:[n.moveGroups[0].selector.source||e.getSelector()]}};return r},true);
/*!
 * SAPUI5
 * (c) Copyright 2009-2023 SAP SE. All rights reserved.
 */
sap.ui.predefine("sap/ui/comp/smartform/flexibility/changes/RemoveField", [],function(){"use strict";var e={};e.applyChange=function(e,r,n){var t=n.modifier;var i=n.view;var a=t.getParent(r);if(a){return Promise.resolve().then(t.findIndexInParentAggregation.bind(t,r)).then(function(n){e.setRevertData({fieldIndex:n});return t.removeAggregation(a,"groupElements",r,i)})}return Promise.resolve()};e.completeChangeContent=function(e,r){};e.revertChange=function(e,r,n){var t=n.view;var i=n.modifier;var a=e.getRevertData().fieldIndex;var o=i.getParent(r);return Promise.resolve().then(i.insertAggregation.bind(i,o,"groupElements",r,a,t)).then(e.resetRevertData.bind(e))};return e},true);
/*!
 * SAPUI5
 * (c) Copyright 2009-2023 SAP SE. All rights reserved.
 */
sap.ui.predefine("sap/ui/comp/smartform/flexibility/changes/RemoveGroup", [],function(){"use strict";var e={};e.applyChange=function(e,n,r){var t=r.modifier;var a=r.view;var o=t.getParent(n);var i;var g;return Promise.resolve().then(t.findIndexInParentAggregation(n)).then(function(e){g=e;if(t.getControlType(o)==="sap.ui.layout.form.Form"){i="formContainers";return t.removeAggregation(o,"formContainers",n,a)}i="groups";return t.removeAggregation(o,"groups",n,a)}).then(t.insertAggregation.bind(t,o,"dependents",n,0,a)).then(function(){e.setRevertData({groupIndex:g,aggregation:i})})};e.completeChangeContent=function(e,n){};e.revertChange=function(e,n,r){var t=r.view;var a=r.modifier;var o=e.getRevertData();var i=a.getParent(n);return Promise.resolve().then(a.removeAggregation.bind(a,i,"dependents",n)).then(a.insertAggregation.bind(a,i,o.aggregation,n,o.groupIndex,t)).then(e.resetRevertData.bind(e))};return e},true);
/*!
 * SAPUI5
 * (c) Copyright 2009-2023 SAP SE. All rights reserved.
 */
sap.ui.predefine("sap/ui/comp/smartform/flexibility/changes/RenameField", ["sap/ui/fl/changeHandler/BaseRename","sap/base/Log","sap/ui/core/util/reflection/JsControlTreeModifier"],function(e,t,r){"use strict";var n="label";var a="fieldLabel";var i="XFLD";var o=e.createRenameChangeHandler({changePropertyName:a,translationTextType:i});o.applyChange=function(e,t,r){var i=e.getText(a);if(typeof i==="string"){return this.setLabelPropertyOnControl(t,i,r.modifier,n).then(function(t){e.setRevertData(t)})}return Promise.resolve()};o.revertChange=function(e,r,a){var i=e.getRevertData();if(i||i===""){if(i==="$$Handled_Internally$$"){i=undefined}return this.setLabelPropertyOnControl(r,i,a.modifier,n).then(function(){e.resetRevertData()})}t.error("Change doesn't contain sufficient information to be reverted. Most Likely the Change didn't go through applyChange.");return Promise.resolve()};o.setLabelPropertyOnControl=function(e,t,r,n){return Promise.resolve().then(r.getProperty.bind(r,e,n)).then(function(t){if(t&&typeof t!=="string"){n="text";e=t}}).then(r.getPropertyBindingOrProperty.bind(r,e,n)).then(function(a){r.setPropertyBindingOrProperty(e,n,t);return a||"$$Handled_Internally$$"})};o.getChangeVisualizationInfo=function(e,t){var n=e.getText(a),i=e.getRevertData(),o,l,s;if(i==="$$Handled_Internally$$"){i=undefined;o=e.getSelector();l=r.bySelector(o,t);if(l.isA("sap.ui.comp.smartform.GroupElement")){s=l.getDataSourceLabel();if(s){i=s}}}return{descriptionPayload:{originalLabel:i,newLabel:n}}};return o},true);
/*!
 * SAPUI5
 * (c) Copyright 2009-2023 SAP SE. All rights reserved.
 */
sap.ui.predefine("sap/ui/comp/smartform/flexibility/changes/RenameGroup", ["sap/ui/fl/changeHandler/BaseRename","sap/base/Log"],function(e,t){"use strict";var r="label";var n="groupLabel";var a="XFLD";var i=e.createRenameChangeHandler({propertyName:r,changePropertyName:n,translationTextType:a});i.applyChange=function(e,t,a){var i=e.getText(n);if(typeof i==="string"){return this.setLabelOrTitleOnControl(t,i,a.modifier,r).then(function(t){e.setRevertData(t)})}return Promise.resolve()};i.revertChange=function(e,n,a){var i=e.getRevertData();if(i||i===""){return this.setLabelOrTitleOnControl(n,i,a.modifier,r).then(e.resetRevertData())}t.error("Change doesn't contain sufficient information to be reverted. Most Likely the Change didn't go through applyChange.");return Promise.resolve()};i.setLabelOrTitleOnControl=function(e,t,r,n){return Promise.all([r.getProperty(e,n),r.getAggregation(e,"title")]).then(function(t){var a=t[0];var i=t[1];if(!a&&i){if(typeof i==="string"){n="title"}else{n="text";e=i}}return r.getPropertyBindingOrProperty(e,n)}).then(function(a){r.setPropertyBindingOrProperty(e,n,t);return a})};return i},true);
/*!
 * SAPUI5
 * (c) Copyright 2009-2023 SAP SE. All rights reserved.
 */
sap.ui.predefine("sap/ui/comp/smartform/flexibility/changes/RenameTitle", ["sap/ui/fl/changeHandler/BaseRename"],function(e){"use strict";var a=e.createRenameChangeHandler({propertyName:"title",changePropertyName:"fieldLabel",translationTextType:"XFLD"});return a},true);
/*!
 * SAPUI5
 * (c) Copyright 2009-2023 SAP SE. All rights reserved.
 */
sap.ui.predefine("sap/ui/comp/smartform/flexibility/changes/SplitField", [],function(){"use strict";var e={};e.applyChange=function(e,t,r){var n=e.getContent();var o=r.modifier;var i=r.appComponent;var l=r.view;var a=o.bySelector(n.sourceSelector,i,l);var s;var u=function(e,t){if(e.index>t.index){return 1}else if(e.index<t.index){return-1}};var g=o.bySelector(n.parentSelector,i,l);var c=n.newElementIds.slice();var p=[];var d;var f;var m;var v;return Promise.all([o.getAggregation(a,"elements"),o.getProperty(a,"elementForLabel"),o.getAggregation(g,"groupElements")]).then(function(e){d=e[0];f=e[1];m=e[2];v=m.indexOf(a);return o.getProperty(a,"label")}).then(function(e){if(e&&typeof e!=="string"){return o.getProperty(e,"text")}return e}).then(function(e){s=e;return d.reduce(function(e,t,n){if(n!==f){var u=c.pop();var d;return e.then(o.createControl.bind(o,"sap.ui.comp.smartform.GroupElement",r.appComponent,l,u)).then(function(e){d=e;p.push({groupElementSelector:o.getSelector(d,i),index:n});return Promise.resolve().then(o.removeAggregation.bind(o,a,"elements",t)).then(o.insertAggregation.bind(o,d,"elements",t,0,l)).then(o.insertAggregation.bind(o,g,"groupElements",d,v+n,l)).then(o.getProperty.bind(o,d,"label")).then(function(e){if(e&&typeof e!=="string"){o.setProperty(e,"text",s)}else{o.setProperty(d,"label",s)}})})}else{p.push({groupElementSelector:o.getSelector(a,i),index:n});if(f!==0){o.setProperty(a,"elementForLabel",0)}return e.then(o.removeAggregation.bind(o,a,"elements",t)).then(o.insertAggregation.bind(o,a,"elements",t,0,l)).then(o.getProperty.bind(o,a,"label")).then(function(e){if(e&&typeof e!=="string"){o.setProperty(e,"text",s)}else{o.setProperty(a,"label",s)}})}},Promise.resolve())}).then(function(){e.setRevertData({sourceControlSelector:n.sourceSelector,labelText:s,splittedFields:p.sort(u)})})};e.completeChangeContent=function(e,t,r){var n=r.modifier;var o=r.appComponent;var i={};if(t.newElementIds){i.newElementIds=t.newElementIds.slice(0,-1)}else{throw new Error("oSpecificChangeInfo.newElementIds attribute required")}if(t.sourceControlId){i.sourceSelector=n.getSelector(t.sourceControlId,o);e.addDependentControl(t.sourceControlId,"sourceControl",r)}else{throw new Error("oSpecificChangeInfo.sourceControlId attribute required")}if(t.parentId){i.parentSelector=n.getSelector(t.parentId,o);e.addDependentControl(t.parentId,"parent",r)}else{throw new Error("oSpecificChangeInfo.parentId attribute required")}e.setContent(i)};e.revertChange=function(e,t,r){var n=r.view;var o=r.modifier;var i=r.appComponent;var l=e.getRevertData();var a=l.splittedFields;var s=o.bySelector(l.sourceControlSelector,i,n);return a.reduce(function(e,t){var r=o.bySelector(t.groupElementSelector,i,n);return e.then(o.getAggregation.bind(o,r,"elements")).then(function(e){var i=e[0];return Promise.resolve().then(o.removeAggregation.bind(o,r,"elements",i)).then(o.insertAggregation.bind(o,s,"elements",i,t.index,n))}).then(function(){if(r!==s){o.destroy(r)}})},Promise.resolve()).then(o.getProperty.bind(o,s,"label")).then(function(t){if(t&&typeof t!=="string"){o.setProperty(t,"text",l.labelText)}else{o.setProperty(s,"label",l.labelText)}e.resetRevertData()})};e.getChangeVisualizationInfo=function(e){return{affectedControls:[e.getContent().sourceSelector],dependentControls:e.getContent().newElementIds}};return e},true);
/*!
 * SAPUI5
 * (c) Copyright 2009-2023 SAP SE. All rights reserved.
 */
sap.ui.predefine("sap/ui/comp/smartform/flexibility/changes/UnhideControl", ["sap/ui/fl/changeHandler/condenser/Classification"],function(e){"use strict";var t={};t.applyChange=function(e,t,n){var i=n.modifier;var r;var s=[];return Promise.resolve().then(i.getAggregation.bind(i,t,"elements")).then(function(e){s=e;return s.reduce(function(e,t){return e.then(function(e){return e||i.getVisible(t)})},Promise.resolve(false))}).then(function(e){r=e;if(!r){s.forEach(function(e){i.setVisible(e,true)})}return i.getAggregation(t,"label")}).then(function(n){var s=false;if(n&&typeof n!=="string"){i.setVisible(n,true);s=true}i.setVisible(t,true);e.setRevertData({partiallyVisible:r,visibleLabel:s})})};t.completeChangeContent=function(e,t){};t.revertChange=function(e,t,n){var i=n.modifier;var r=e.getRevertData();return Promise.resolve().then(i.getAggregation.bind(i,t,"elements")).then(function(e){if(!r.partiallyVisible){e.forEach(function(e){i.setVisible(e,false)})}if(r.visibleLabel){return Promise.resolve().then(i.getAggregation.bind(i,t,"label")).then(function(e){i.setVisible(e,false)})}}).then(function(){i.setVisible(t,false);e.resetRevertData()})};t.getCondenserInfo=function(t){return{affectedControl:t.getSelector(),classification:e.Reverse,uniqueKey:"visible"}};return t},true);
/*!
 * SAPUI5
 * (c) Copyright 2009-2023 SAP SE. All rights reserved.
 */
sap.ui.predefine("sap/ui/comp/smartlist/SmartList", ["sap/ui/comp/library","sap/m/library","sap/m/VBox","sap/m/FlexItemData","sap/m/List","sap/m/Tree","sap/m/Title","sap/m/Toolbar","sap/m/OverflowToolbar","sap/m/ToolbarSpacer","sap/m/OverflowToolbarButton","sap/ui/comp/odata/ODataModelUtil","sap/ui/comp/util/FullScreenUtil","sap/ui/core/format/NumberFormat","sap/base/util/deepEqual"],function(t,e,i,s,o,r,a,n,l,h,u,d,p,_,c){"use strict";var g=e.ToolbarDesign;var f=i.extend("sap.ui.comp.smartlist.SmartList",{metadata:{library:"sap.ui.comp",properties:{entitySet:{type:"string",group:"Misc",defaultValue:null},selectFields:{type:"string",group:"Misc",defaultValue:null},expandFields:{type:"string",group:"Misc",defaultValue:null},showRowCount:{type:"boolean",group:"Misc",defaultValue:true},header:{type:"string",group:"Misc",defaultValue:null},enableAutoBinding:{type:"boolean",group:"Misc",defaultValue:false},listBindingPath:{type:"string",group:"Misc",defaultValue:null},listType:{type:"sap.ui.comp.smartlist.ListType",group:"Misc",defaultValue:null},showFullScreenButton:{type:"boolean",group:"Misc",defaultValue:false}},associations:{smartFilter:{type:"sap.ui.core.Control"}},aggregations:{listItemTemplate:{type:"sap.m.ListItemBase",multiple:false}},events:{initialise:{},beforeRebindList:{},dataReceived:{}}},renderer:{apiVersion:2},constructor:function(){i.apply(this,arguments);this.addStyleClass("sapUiCompSmartList");this._createToolbar();this._createList();this.attachModelContextChange(this._initialiseMetadata,this)}});f.prototype._sAggregation="items";f.prototype.setHeader=function(t){this.setProperty("header",t,true);this._refreshHeaderText();return this};f.prototype.setShowRowCount=function(t){this.setProperty("showRowCount",t,true);this._refreshHeaderText();return this};f.prototype.setShowFullScreenButton=function(t){this.setProperty("showFullScreenButton",t,true);if(this._oFullScreenButton){this._oFullScreenButton.setVisible(this.getShowFullScreenButton())}return this};f.prototype.setEntitySet=function(t){this.setProperty("entitySet",t);this._initialiseMetadata();return this};f.prototype._refreshHeaderText=function(){if(!this._headerText){return}var t=this.getHeader();var e=!!t;this._headerText.setVisible(e);if(e&&this.getShowRowCount()){var i=parseInt(this._getRowCount(true));if(i>0){if(!this._oNumberFormatter){this._oNumberFormatter=_.getFloatInstance()}var s=this._oNumberFormatter.format(i);t+=" ("+s+")"}}this._headerText.setText(t)};f.prototype._addFullScreenButton=function(){if(this._oFullScreenButton){this._oToolbar.removeContent(this._oFullScreenButton)}if(this.getShowFullScreenButton()){if(!this._oFullScreenButton){this._oFullScreenButton=new u(this.getId()+"-btnFullScreen",{press:function(){this._toggleFullScreen(!this.bFullScreen)}.bind(this)})}this._toggleFullScreen(this.bFullScreen,true);this._oToolbar.addContent(this._oFullScreenButton)}};f.prototype._createToolbar=function(){var t,e,i;if(!this._oToolbar){t=this.getItems();e=t?t.length:0;while(e--){i=t[e];if(i instanceof n){break}i=null}if(i){this._oToolbar=i}else{this._oToolbar=new l(this.getId()+"-toolbar",{design:g.Transparent});this.insertItem(this._oToolbar,0)}if(!this._oToolbar.getLayoutData()){this._oToolbar.setLayoutData(new s({shrinkFactor:0}))}}};f.prototype._toggleFullScreen=function(t,e){var i=sap.ui.getCore().getLibraryResourceBundle("sap.ui.comp"),s;if(!this._oFullScreenButton||t===this.bFullScreen&&!e){return}this.bFullScreen=t;p.toggleFullScreen(this,this.bFullScreen,this._oFullScreenButton,this._toggleFullScreen);s=this.bFullScreen?i.getText("CHART_MINIMIZEBTN_TOOLTIP"):i.getText("CHART_MAXIMIZEBTN_TOOLTIP");this._oFullScreenButton.setTooltip(s);this._oFullScreenButton.setText(s);this._oFullScreenButton.setIcon(this.bFullScreen?"sap-icon://exit-full-screen":"sap-icon://full-screen")};f.prototype._createToolbarContent=function(){if(!this._oToolbar){this._createToolbar()}this._addHeaderToToolbar();this._addSpacerToToolbar();this._addFullScreenButton();this._oToolbar.addStyleClass("sapMTBHeader-CTX")};f.prototype._addHeaderToToolbar=function(){if(this._headerText){this._oToolbar.removeContent(this._headerText)}if(!this._headerText){this._headerText=new a(this.getId()+"-header");this._headerText.addStyleClass("sapMH4Style");this._headerText.addStyleClass("sapUiCompSmartTableHeader")}this._refreshHeaderText();this._oToolbar.insertContent(this._headerText,0)};f.prototype._addSpacerToToolbar=function(){var t=false,e=this._oToolbar.getContent(),i,s;if(e){s=e.length;i=0;for(i;i<s;i++){if(e[i]instanceof h){t=true;break}}}if(!t){this._oToolbar.addContent(new h(this.getId()+"-toolbarSpacer"))}};f.prototype._getRowCount=function(t){var e=this._getRowBinding();if(!e){return t?undefined:0}var i;if(!t){i=e.getLength()}else{if(typeof e.getCount==="function"){i=e.getCount()}else if(!e.isA("sap.ui.model.TreeBinding")&&typeof e.isLengthFinal==="function"&&e.isLengthFinal()){i=e.getLength()}}if(i<0||i==="0"){i=0}return i};f.prototype._getRowBinding=function(){if(this._oList){return this._oList.getBinding(this._sAggregation)}};f.prototype._initialiseMetadata=function(){if(!this.bIsInitialised){d.handleModelInit(this,this._onMetadataInitialised)}};f.prototype._onMetadataInitialised=function(){this._bMetaModelLoadAttached=false;if(!this.bIsInitialised){this.detachModelContextChange(this._initialiseMetadata,this);this.bIsInitialised=true;this._listenToSmartFilter();this._createToolbarContent();this._createContent();this.fireInitialise();this._checkAndTriggerBinding()}};f.prototype._checkAndTriggerBinding=function(){if(!this._bAutoBindingTriggered){this._bAutoBindingTriggered=true;if(this.getEnableAutoBinding()){if(this._oSmartFilter){this._oSmartFilter.search()}else{this._reBindList()}}}};f.prototype._listenToSmartFilter=function(){var t=null;t=this.getSmartFilter();if(typeof t==="string"){this._oSmartFilter=sap.ui.getCore().byId(t)}else{this._oSmartFilter=t}if(this._oSmartFilter){this._oSmartFilter.attachSearch(this._reBindList,this);this._oSmartFilter.attachFilterChange(this._filterChangeEvent,this);this._oSmartFilter.attachCancel(this._cancelEvent,this);this._setNoDataText(sap.ui.getCore().getLibraryResourceBundle("sap.ui.comp").getText("SMARTTABLE_NO_DATA"))}};f.prototype._filterChangeEvent=function(){if(this._isListBound()&&this._oSmartFilter&&!this._oSmartFilter.getLiveMode()){this._showOverlay(true)}};f.prototype._cancelEvent=function(){if(this._oSmartFilter&&!this._oSmartFilter.getLiveMode()){this._showOverlay(false)}};f.prototype._showOverlay=function(t){};f.prototype.rebindList=function(t){this._reBindList(null,t)};f.prototype._reBindList=function(t,e){var i,s,o,r,a,n={},l={preventListBind:false};if(this._oSmartFilter){o=this._oSmartFilter.getFilters();n=this._oSmartFilter.getParameters()||{}}r=o;if(!a){a=[]}n["select"]=this.getSelectFields();if(this.getExpandFields()){n["expand"]=this.getExpandFields()}n["useBatchRequests"]=true;l.filters=r;l.sorter=a;l.parameters=n;l.length=undefined;l.startIndex=undefined;this.fireBeforeRebindList({bindingParams:l});if(!l.preventListBind){a=l.sorter;r=l.filters;n=l.parameters;s=this.getListBindingPath()||"/"+this.getEntitySet();this._bDataLoadPending=true;this._bIgnoreChange=false;if(!e){i=this._oList.getBinding(this._sAggregation);if(i&&i.mParameters){e=!(c(n,i.mParameters,true)&&c(n.custom,i.mParameters.custom)&&!l.length&&!l.startIndex&&s===i.getPath())}}if(!i||!this._bIsListBound||e){this._oList.bindItems({path:s,filters:r,sorter:a,parameters:n,length:l.length,startIndex:l.startIndex,template:this._oTemplate,events:{dataRequested:function(){this._bIgnoreChange=true}.bind(this),dataReceived:function(t){this._bIgnoreChange=false;this._onDataLoadComplete(t,true);this.fireDataReceived(t)}.bind(this),change:function(t){if(this._bIgnoreChange){return}var e,i=false;e=t&&t.getParameter?t.getParameter("reason"):undefined;if(!e||e==="filter"||e==="context"){i=true}if(e==="change"||i){this._onDataLoadComplete(t,i)}}.bind(this)}});this._bIsListBound=true}else{i.sort(a);i.filter(r,"Application")}this._showOverlay(false)}};f.prototype._onDataLoadComplete=function(t,e){if(this._bDataLoadPending||e){this._bDataLoadPending=false;if(!this._bNoDataUpdated&&!this._getRowCount()){this._bNoDataUpdated=true;this._setNoDataText()}this._refreshHeaderText()}};f.prototype._isListBound=function(){if(this._bIsListBound){return true}if(this._oList){return this._oList.isBound(this._sAggregation)}return false};f.prototype._setNoDataText=function(t){if(this._oList){if(!t){t=sap.ui.getCore().getLibraryResourceBundle("sap.ui.comp").getText("SMARTTABLE_NO_RESULTS")}this._oList.setNoDataText(t)}};f.prototype._createContent=function(){if(!this._oTemplate){this._oTemplate=this.getListItemTemplate()}};f.prototype._createList=function(){var t=this.getItems(),e=t?t.length:0,i,a;while(e--){i=t[e];if(i instanceof o||i instanceof r){break}i=null}if(i){this._oList=i;if(i instanceof r){this._isTree=true}else{this._isList=true}this._oTemplate=i.getItems()&&i.getItems().length>0?i.getItems()[0]:this.getListItemTemplate();i.removeAllItems()}else{a=this.getId()+"-ui5list";if(this.getListType()==="Tree"){this._oList=new r(a);this._isTree=true}else{this._oList=new o(a,{growing:true,growingScrollToLoad:true});this._isList=true}this.insertItem(this._oList,2)}if(!this._oList.getLayoutData()){this._oList.setLayoutData(new s({growFactor:1,baseSize:"auto"}))}};f.prototype.getList=function(){return this._oList};f.prototype.isInitialised=function(){return!!this.bIsInitialised};f.prototype.exit=function(){if(this._oSmartFilter){this._oSmartFilter.detachSearch(this._reBindList,this);this._oSmartFilter.detachFilterChange(this._filterChangeEvent,this);this._oSmartFilter.detachCancel(this._cancelEvent,this);this._oSmartFilter=null}p.cleanUpFullScreen(this);if(!this._bIsListBound&&this._oTemplate){this._oTemplate.destroy()}this._oTemplate=null;this._oToolbar=null;this._headerText=null;this._oFullScreenButton=null;this._oNumberFormatter=null;this._oList=null};return f});
/*!
 * SAPUI5
 * (c) Copyright 2009-2023 SAP SE. All rights reserved.
 */
sap.ui.predefine("sap/ui/comp/smartmicrochart/SmartAreaMicroChart", ["sap/ui/comp/library","sap/suite/ui/microchart/AreaMicroChart","sap/suite/ui/microchart/AreaMicroChartPoint","sap/suite/ui/microchart/AreaMicroChartItem","sap/suite/ui/microchart/AreaMicroChartLabel","sap/ui/core/Control","sap/m/library","sap/ui/model/odata/CountMode","sap/ui/comp/smartmicrochart/SmartMicroChartBase","./SmartMicroChartRenderer"],function(t,e,a,r,i,o,n,h,s,c){"use strict";var g=n.ValueColor;var l=s.extend("sap.ui.comp.smartmicrochart.SmartAreaMicroChart",{metadata:{library:"sap.ui.comp",designtime:"sap/ui/comp/designtime/smartmicrochart/SmartAreaMicroChart.designtime",properties:{enableAutoBinding:{type:"boolean",group:"Misc",defaultValue:true}}},renderer:c});l.prototype._CHART_TYPE=["Area","Line"];l.prototype.init=function(){this._bIsInitialized=false;this._bMetaModelLoadAttached=false;this.setProperty("chartType","Area",true);this.setAggregation("_chart",new e,true)};l.prototype.onBeforeRendering=function(){var t=this.getAggregation("_chart");t.setWidth(this.getWidth(),true);t.setHeight(this.getHeight(),true);t.setSize(this.getSize(),true)};l.prototype.setShowLabel=function(t){if(this.getShowLabel()!==t){this.setProperty("showLabel",t,true);this.getAggregation("_chart").setProperty("showLabel",t,true);this.invalidate()}return this};l.prototype.setEnableAutoBinding=function(){return this.setProperty("enableAutoBinding",true,true)};l.prototype.bindElement=function(){return this};l.prototype._createAndBindInnerChart=function(){this._createChartLabels();this._createChartItem("chart",this._oDataPointAnnotations.Value.Path);this._createChartItem("target",this._oDataPointAnnotations.TargetValue.Path);this._buildThreshold()};l.prototype._buildThreshold=function(){var t=this._oDataPointAnnotations.CriticalityCalculation;if(this._hasMember(t,"ImprovementDirection.EnumMember")){switch(t.ImprovementDirection.EnumMember){case s._MINIMIZE:this._createChartItem("minThreshold",t.ToleranceRangeHighValue.Path,g.Good);this._createChartItem("maxThreshold",t.DeviationRangeHighValue.Path,g.Error);break;case s._MAXIMIZE:this._createChartItem("minThreshold",t.DeviationRangeLowValue.Path,g.Error);this._createChartItem("maxThreshold",t.ToleranceRangeLowValue.Path,g.Good);break;case s._TARGET:this._createChartItem("minThreshold",t.DeviationRangeLowValue.Path,g.Error);this._createChartItem("maxThreshold",t.DeviationRangeHighValue.Path,g.Error);this._createChartItem("innerMinThreshold",t.ToleranceRangeLowValue.Path,g.Good);this._createChartItem("innerMaxThreshold",t.ToleranceRangeHighValue.Path,g.Good);break;default:break}}};l.prototype._createChartLabels=function(){var t,e=this._getLabelsMap();for(var a in e){t=new i;this.getAggregation("_chart").setAggregation(e[a],t,true)}};l.prototype._createChartItem=function(t,e,i){var o,n;o=new a({x:{path:this._oChartViewMetadata.dimensionFields[0],formatter:this._formatDimension.bind(this)},y:{path:e,type:"sap.ui.model.odata.type.Decimal"}});n=new r({points:{path:this._getBindingPath(),template:o,parameters:{countMode:h.None},events:{change:this._onBindingDataChange.bind(this)}},color:i});this.getAggregation("_chart").setAggregation(t,n,true)};l.prototype._onBindingDataChange=function(){var t=this.getAggregation("_chart").getAggregation("chart").getBinding("points");this._updateAssociations(t);this.updateChartLabels.call(this,t)};l.prototype._updateLabel=function(t,e){var a=this.getAggregation("_chart").getAggregation(t);a.setProperty("label",e.text,true);if(e.color){a.setProperty("color",e.color,true)}};l.prototype._getLabelsMap=function(){return{leftTop:"firstYLabel",rightTop:"lastYLabel",leftBottom:"firstXLabel",rightBottom:"lastXLabel"}};return l});
/*!
 * SAPUI5
 * (c) Copyright 2009-2023 SAP SE. All rights reserved.
 */
sap.ui.predefine("sap/ui/comp/smartmicrochart/SmartBulletMicroChart", ["sap/ui/comp/library","sap/ui/core/Control","sap/suite/ui/microchart/library","sap/suite/ui/microchart/BulletMicroChart","sap/suite/ui/microchart/BulletMicroChartData","sap/m/library","sap/ui/comp/smartmicrochart/SmartMicroChartBase","./SmartMicroChartRenderer"],function(t,a,e,i,o,n,r,s){"use strict";var h=n.ValueColor;var l=r.extend("sap.ui.comp.smartmicrochart.SmartBulletMicroChart",{metadata:{library:"sap.ui.comp",designtime:"sap/ui/comp/designtime/smartmicrochart/SmartBulletMicroChart.designtime",properties:{enableAutoBinding:{type:"boolean",group:"Misc",defaultValue:false}}},renderer:s});l._CRITICAL_COLOR=h.Critical;l._ERROR_COLOR=h.Error;l.prototype._CHART_TYPE=["Bullet"];l.prototype.init=function(){this._bIsInitialized=false;this._bMetaModelLoadAttached=false;this.setProperty("chartType","Bullet",true);this.setAggregation("_chart",new i({showValueMarker:true}),true)};l.prototype.setShowLabel=function(t){if(this.getShowLabel()!==t){this.setProperty("showLabel",t,true);var a=this.getAggregation("_chart");a.setProperty("showActualValue",t,true);a.setProperty("showTargetValue",t,true);a.setProperty("showDeltaValue",t,true);a.setProperty("showValueMarker",t,true);this.invalidate()}return this};l.prototype.onBeforeRendering=function(){var t=this.getAggregation("_chart");t.setSize(this.getSize(),true);t.setWidth(this.getWidth(),true);t.setHeight(this.getHeight(),true)};l.prototype._createAndBindInnerChart=function(){this._bindValueProperties();this._bindActualValue();this._bindChartThresholds();this._updateAssociations.call(this);this._setMode()};l.prototype._setMode=function(){if(this._hasMember(this,"_oDataPointAnnotations.Visualization.EnumMember")){if(this._oDataPointAnnotations.Visualization.EnumMember===r._DELTABULLET){this.getAggregation("_chart").setMode(e.BulletMicroChartModeType.Delta)}}};l.prototype._bindValueProperties=function(){var t,a,e=this.getAggregation("_chart");if(this._hasMember(this,"_oDataPointAnnotations.TargetValue.Path")){e.bindProperty("targetValue",{path:this._oDataPointAnnotations.TargetValue.Path,type:"sap.ui.model.odata.type.Decimal"});var i=this._getLabelNumberFormatter.call(this,this._oDataPointAnnotations.TargetValue.Path);e.bindProperty("targetValueLabel",{path:this._oDataPointAnnotations.TargetValue.Path,formatter:i.format.bind(i)})}if(this._hasMember(this,"_oDataPointAnnotations.ForecastValue.Path")){e.bindProperty("forecastValue",{path:this._oDataPointAnnotations.ForecastValue.Path,type:"sap.ui.model.odata.type.Decimal"})}if(this._oDataPointAnnotations.MaximumValue){if(this._oDataPointAnnotations.MaximumValue.hasOwnProperty("Path")){e.bindProperty("maxValue",{path:this._oDataPointAnnotations.MaximumValue.Path,type:"sap.ui.model.odata.type.Decimal"})}else if(this._oDataPointAnnotations.MaximumValue.hasOwnProperty("Decimal")){t=parseFloat(this._oDataPointAnnotations.MaximumValue.Decimal);e.setMaxValue(t,true)}}if(this._oDataPointAnnotations.MinimumValue){if(this._oDataPointAnnotations.MinimumValue.hasOwnProperty("Path")){e.bindProperty("minValue",{path:this._oDataPointAnnotations.MinimumValue.Path,type:"sap.ui.model.odata.type.Decimal"})}else if(this._oDataPointAnnotations.MinimumValue.hasOwnProperty("Decimal")){a=parseFloat(this._oDataPointAnnotations.MinimumValue.Decimal);e.setMinValue(a,true)}}};l.prototype._bindActualValue=function(){var t=this.getAggregation("_chart"),a=this._getLabelNumberFormatter.call(this,this._oDataPointAnnotations.Value.Path);var e=new o({value:{path:this._oDataPointAnnotations.Value.Path,type:"sap.ui.model.odata.type.Decimal"},color:{parts:[this._oDataPointAnnotations.Value&&this._oDataPointAnnotations.Value.Path||"",this._oDataPointAnnotations.Criticality&&this._oDataPointAnnotations.Criticality.Path||""],formatter:this._getValueColor.bind(this)}});t.setAggregation("actual",e,true);t.bindProperty("actualValueLabel",{path:this._oDataPointAnnotations.Value.Path,formatter:a.format.bind(a)})};l.prototype._bindChartThresholds=function(){var t,a;if(this._hasMember(this._oDataPointAnnotations,"CriticalityCalculation.ImprovementDirection.EnumMember")){a=this._oDataPointAnnotations.CriticalityCalculation;t=a.ImprovementDirection.EnumMember;if(t!==r._MINIMIZE&&a.DeviationRangeLowValue&&a.DeviationRangeLowValue.Path){this._bindThresholdAggregation(a.DeviationRangeLowValue.Path,l._ERROR_COLOR)}if(t!==r._MINIMIZE&&a.ToleranceRangeLowValue&&a.ToleranceRangeLowValue.Path){this._bindThresholdAggregation(a.ToleranceRangeLowValue.Path,l._CRITICAL_COLOR)}if(t!==r._MAXIMIZE&&a.ToleranceRangeHighValue&&a.ToleranceRangeHighValue.Path){this._bindThresholdAggregation(a.ToleranceRangeHighValue.Path,l._CRITICAL_COLOR)}if(t!==r._MAXIMIZE&&a.DeviationRangeHighValue&&a.DeviationRangeHighValue.Path){this._bindThresholdAggregation(a.DeviationRangeHighValue.Path,l._ERROR_COLOR)}}};l.prototype._bindThresholdAggregation=function(t,a){var e=new o({value:{path:t,type:"sap.ui.model.odata.type.Decimal"},color:a});this.getAggregation("_chart").addAggregation("thresholds",e,true)};return l});
/*!
 * SAPUI5
 * (c) Copyright 2009-2023 SAP SE. All rights reserved.
 */
sap.ui.predefine("sap/ui/comp/smartmicrochart/SmartColumnMicroChart", ["sap/ui/comp/library","sap/suite/ui/microchart/library","sap/ui/core/Control","sap/ui/model/odata/CountMode","sap/ui/core/format/DateFormat","sap/m/library","sap/base/Log","sap/suite/ui/microchart/ColumnMicroChart","sap/suite/ui/microchart/ColumnMicroChartData","sap/suite/ui/microchart/ColumnMicroChartLabel","sap/ui/comp/smartmicrochart/SmartMicroChartBase","./SmartMicroChartRenderer"],function(t,a,i,e,o,r,n,s,h,l,c,p){"use strict";var u=c.extend("sap.ui.comp.smartmicrochart.SmartColumnMicroChart",{metadata:{library:"sap.ui.comp",designtime:"sap/ui/comp/designtime/smartmicrochart/SmartColumnMicroChart.designtime"},renderer:p});u.prototype._CHART_TYPE=["Column"];u.prototype.init=function(){this._bIsInitialized=false;this._bMetaModelLoadAttached=false;this.setProperty("chartType","Column",true);this.setAggregation("_chart",new s,true)};u.prototype.onBeforeRendering=function(){var t=this.getAggregation("_chart");t.setSize(this.getSize(),true);t.setWidth(this.getWidth(),true);t.setHeight(this.getHeight(),true)};u.prototype.setShowLabel=function(t){var a;if(this.getShowLabel()!==t){a=this.getAggregation("_chart");this.setProperty("showLabel",t,true);a.setProperty("showTopLabels",t,true);a.setProperty("showBottomLabels",t,true);a.invalidate()}return this};u.prototype._createAndBindInnerChart=function(){if(this._aDataPointAnnotations.length===0){n.error("DataPoint annotation missing! Cannot create the SmartColumnMicroChart");return}if(!(this._aDataPointAnnotations[0].Value&&this._aDataPointAnnotations[0].Value.Path)){n.error("Value DataPoint annotation missing! Cannot create the SmartColumnMicroChart");return}var t=this.getAggregation("_chart"),a=new h({value:{path:this._aDataPointAnnotations[0].Value.Path,type:"sap.ui.model.odata.type.Decimal"}});if(this._aDataPointAnnotations[0].Criticality&&this._aDataPointAnnotations[0].Criticality.Path){a.bindProperty("color",{path:this._aDataPointAnnotations[0].Criticality.Path,formatter:this._mapCriticalityTypeWithColor.bind(this)})}if(this._aDataPointAnnotations[0].Title&&this._aDataPointAnnotations[0].Title.Path){a.bindProperty("label",this._aDataPointAnnotations[0].Title.Path)}var i=this._getPropertyAnnotation.call(this,this._aDataPointAnnotations[0].Value.Path);var e=i["com.sap.vocabularies.Common.v1.Text"];if(e&&e.Path){t.setAllowColumnLabels(true);a.bindProperty("displayValue",e.Path)}t.bindAggregation("columns",{path:this._getBindingPath(),template:a,events:{change:this._onBindingDataChange.bind(this)}});this._createChartLabels()};u.prototype._createChartLabels=function(){var t,a=this._getLabelsMap();for(var i in a){t=new l;this.getAggregation("_chart").setAggregation(a[i],t,true)}};u.prototype._onBindingDataChange=function(){var t=this.getAggregation("_chart").getBinding("columns");this._updateAssociations(t);this.updateChartLabels.call(this,t)};u.prototype._updateLabel=function(t,a){var i=this.getAggregation("_chart").getAggregation(t);if(i!==null){i.setProperty("label",a.text,true);if(a.color){i.setProperty("color",a.color,true)}}};u.prototype._getLabelsMap=function(){return{leftTop:"leftTopLabel",rightTop:"rightTopLabel",leftBottom:"leftBottomLabel",rightBottom:"rightBottomLabel"}};return u});
/*!
 * SAPUI5
 * (c) Copyright 2009-2023 SAP SE. All rights reserved.
 */
sap.ui.predefine("sap/ui/comp/smartmicrochart/SmartComparisonMicroChart", ["sap/ui/comp/library","sap/suite/ui/microchart/ComparisonMicroChart","sap/suite/ui/microchart/ComparisonMicroChartData","sap/ui/core/Control","sap/ui/model/odata/CountMode","sap/ui/core/format/DateFormat","sap/m/library","sap/base/Log","sap/ui/comp/smartmicrochart/SmartMicroChartBase","./SmartMicroChartRenderer"],function(t,a,i,o,n,e,r,s,h,p){"use strict";var c=h.extend("sap.ui.comp.smartmicrochart.SmartComparisonMicroChart",{metadata:{library:"sap.ui.comp",designtime:"sap/ui/comp/designtime/smartmicrochart/SmartComparisonMicroChart.designtime"},renderer:p});c.prototype._CHART_TYPE=["Comparison"];c.prototype.init=function(){this._bIsInitialized=false;this._bMetaModelLoadAttached=false;this.setProperty("chartType","Comparison",true);this.setAggregation("_chart",new a,true)};c.prototype.onBeforeRendering=function(){var t=this.getAggregation("_chart");t.setSize(this.getSize(),true);t.setWidth(this.getWidth(),true);t.setHeight(this.getHeight(),true)};c.prototype._createAndBindInnerChart=function(){if(!(this._oDataPointAnnotations.Value&&this._oDataPointAnnotations.Value.Path)){s.error("Value DataPoint annotation missing! Cannot create the SmartComparisonMicroChart");return}var t=this.getAggregation("_chart"),a=new i({value:{path:this._oDataPointAnnotations.Value.Path,type:"sap.ui.model.odata.type.Decimal"}});if(this._oDataPointAnnotations.Criticality&&this._oDataPointAnnotations.Criticality.Path){a.bindProperty("color",{path:this._oDataPointAnnotations.Criticality.Path,formatter:this._mapCriticalityTypeWithColor.bind(this)})}if(this._oDataPointAnnotations.Title&&this._oDataPointAnnotations.Title.Path){a.bindProperty("title",this._oDataPointAnnotations.Title.Path)}var o=this._getPropertyAnnotation.call(this,this._oDataPointAnnotations.Value.Path);var n=o["com.sap.vocabularies.Common.v1.Text"];if(n&&n.Path){a.bindProperty("displayValue",n.Path)}t.bindAggregation("data",{path:this._getBindingPath(),template:a,events:{change:this._onBindingDataChange.bind(this)}})};c.prototype._onBindingDataChange=function(){var t=this.getAggregation("_chart").getBinding("data");this._updateAssociations(t)};return c});
/*!
 * SAPUI5
 * (c) Copyright 2009-2023 SAP SE. All rights reserved.
 */
sap.ui.predefine("sap/ui/comp/smartmicrochart/SmartDeltaMicroChart", ["sap/ui/comp/library","sap/ui/core/Control","sap/suite/ui/microchart/DeltaMicroChart","sap/ui/comp/smartmicrochart/SmartMicroChartBase","sap/base/Log","./SmartMicroChartRenderer"],function(t,a,i,n,e,o){"use strict";var r=n.extend("sap.ui.comp.smartmicrochart.SmartDeltaMicroChart",{metadata:{library:"sap.ui.comp",designtime:"sap/ui/comp/designtime/smartmicrochart/SmartDeltaMicroChart.designtime",properties:{enableAutoBinding:{type:"boolean",group:"Misc",defaultValue:false}}},renderer:o});r.prototype._CHART_TYPE=["Delta"];r.prototype.init=function(){this._bIsInitialized=false;this._bMetaModelLoadAttached=false;this.setProperty("chartType",this._CHART_TYPE,true);this.setAggregation("_chart",new i,true)};r.prototype.onBeforeRendering=function(){var t=this.getAggregation("_chart");t.setSize(this.getSize(),true);t.setWidth(this.getWidth(),true)};r.prototype._createAndBindInnerChart=function(){if(this._aDataPointAnnotations.length<2){e.error("Two DataPoint annotation are needed! Cannot create the SmartColumnMicroChart");return}if(!(this._aDataPointAnnotations[0].Value&&this._aDataPointAnnotations[0].Value.Path&&this._aDataPointAnnotations[1].Value&&this._aDataPointAnnotations[1].Value.Path)){e.error("Value DataPoint annotation missing! Cannot create the SmartColumnMicroChart");return}this.bindProperties();this._updateAssociations()};r.prototype.bindProperties=function(){var t=this.getAggregation("_chart"),a=this._getLabelNumberFormatter.call(this,this._aDataPointAnnotations[0].Value.Path),i=this._getLabelNumberFormatter.call(this,this._aDataPointAnnotations[1].Value.Path);t.bindProperty("value1",{path:this._aDataPointAnnotations[0].Value.Path,type:"sap.ui.model.odata.type.Decimal",events:{change:this._onBindingDataChange.bind(this)}});t.bindProperty("value2",{path:this._aDataPointAnnotations[1].Value.Path,type:"sap.ui.model.odata.type.Decimal",events:{change:this._onBindingDataChange.bind(this)}});t.bindProperty("displayValue1",{path:this._aDataPointAnnotations[0].Value.Path,formatter:a.format.bind(a)});t.bindProperty("displayValue2",{path:this._aDataPointAnnotations[1].Value.Path,formatter:a.format.bind(i)});if(this._aDataPointAnnotations[0].Title&&this._aDataPointAnnotations[0].Title.Path){t.bindProperty("title1",{path:this._aDataPointAnnotations[0].Title.Path})}if(this._aDataPointAnnotations[1].Title&&this._aDataPointAnnotations[1].Title.Path){t.bindProperty("title2",{path:this._aDataPointAnnotations[1].Title.Path})}if(this._aDataPointAnnotations[0].Criticality&&this._aDataPointAnnotations[0].Criticality.Path){t.bindProperty("color",{path:this._aDataPointAnnotations[0].Criticality.Path,formatter:this._mapCriticalityTypeWithColor.bind(this)})}};r.prototype._onBindingDataChange=function(){var t=this.getAggregation("_chart"),a=this._getLabelNumberFormatter.call(this,this._aDataPointAnnotations[0].Value.Path);t.setDeltaDisplayValue(a.format(t._getDeltaValue()));this._updateAssociations()};return r});
/*!
 * SAPUI5
 * (c) Copyright 2009-2023 SAP SE. All rights reserved.
 */
sap.ui.predefine("sap/ui/comp/smartmicrochart/SmartHarveyBallMicroChart", ["sap/ui/comp/library","sap/ui/core/Control","sap/suite/ui/microchart/library","sap/m/library","sap/ui/comp/smartmicrochart/SmartMicroChartBase","sap/suite/ui/microchart/HarveyBallMicroChart","sap/suite/ui/microchart/HarveyBallMicroChartItem","sap/base/Log","./SmartMicroChartRenderer"],function(t,a,i,e,o,r,n,s,h){"use strict";var l=o.extend("sap.ui.comp.smartmicrochart.SmartHarveyBallMicroChart",{metadata:{library:"sap.ui.comp",designtime:"sap/ui/comp/designtime/smartmicrochart/SmartHarveyBallMicroChart.designtime",properties:{enableAutoBinding:{type:"boolean",group:"Misc",defaultValue:false}},associations:{freeText:{type:"sap.m.Label",group:"Misc",multiple:false}}},renderer:h});l._CHART_TYPE=["Pie"];l.prototype.init=function(){this._bIsInitialized=false;this._bMetaModelLoadAttached=false;this.setProperty("chartType","Pie",true);this.setAggregation("_chart",new r,true)};l.prototype.onBeforeRendering=function(){var t=this.getAggregation("_chart");t.setSize(this.getSize(),true);t.setWidth(this.getWidth(),true);t.setHeight(this.getHeight(),true)};l.prototype._createAndBindInnerChart=function(){if(!(this._oDataPointAnnotations.Value&&this._oDataPointAnnotations.Value.Path)){s.error("Value DataPoint annotation missing! Cannot create the SmartHarveyBallMicroChart");return}var t=this.getAggregation("_chart"),a=new n({fraction:{path:this._oDataPointAnnotations.Value.Path,type:"sap.ui.model.odata.type.Decimal"}});var i=this._getLabelNumberFormatter.call(this,this._oDataPointAnnotations.Value.Path);a.bindProperty("fractionLabel",{path:this._oDataPointAnnotations.Value.Path,formatter:i.format.bind(i)});var e=this._getLabelNumberFormatter.call(this,this._oDataPointAnnotations.MaximumValue.Path);if(this._oDataPointAnnotations.MaximumValue&&this._oDataPointAnnotations.MaximumValue.Path){t.bindProperty("total",{path:this._oDataPointAnnotations.MaximumValue.Path,type:"sap.ui.model.odata.type.Decimal"});t.bindProperty("totalLabel",{path:this._oDataPointAnnotations.MaximumValue.Path,formatter:e.format.bind(e)})}if(this._getAnnotation("unitOfMeasure").Path){t.bindProperty("totalScale",{path:this._getAnnotation("unitOfMeasure").Path});a.bindProperty("fractionScale",{path:this._getAnnotation("unitOfMeasure").Path})}if(this._oDataPointAnnotations.Criticality&&this._oDataPointAnnotations.Criticality.Path){a.bindProperty("color",{path:this._oDataPointAnnotations.Criticality.Path,formatter:this._mapCriticalityTypeWithColor.bind(this)})}t.addItem(a);this._updateAssociations()};l.prototype._getSupportedChartTypes=function(){return l._CHART_TYPE};return l});
/*!
 * SAPUI5
 * (c) Copyright 2009-2023 SAP SE. All rights reserved.
 */
sap.ui.predefine("sap/ui/comp/smartmicrochart/SmartLineMicroChart", ["sap/ui/comp/library","sap/suite/ui/microchart/library","sap/ui/core/Control","sap/ui/model/odata/CountMode","sap/ui/core/format/DateFormat","sap/m/library","sap/base/Log","sap/suite/ui/microchart/LineMicroChart","sap/suite/ui/microchart/LineMicroChartLine","sap/suite/ui/microchart/LineMicroChartPoint","sap/ui/comp/smartmicrochart/SmartMicroChartBase","./SmartMicroChartRenderer"],function(t,i,e,a,r,o,n,s,h,c,g,p){"use strict";var u=g.extend("sap.ui.comp.smartmicrochart.SmartLineMicroChart",{metadata:{library:"sap.ui.comp",designtime:"sap/ui/comp/designtime/smartmicrochart/SmartLineMicroChart.designtime"},renderer:p});u.prototype._CHART_TYPE=["Line"];u.prototype.init=function(){this._bIsInitialized=false;this._bMetaModelLoadAttached=false;this.setProperty("chartType","Line",true);this.setAggregation("_chart",new s({showThresholdLine:false}),true)};u.prototype.onBeforeRendering=function(){var t=this.getAggregation("_chart");t.setSize(this.getSize(),true);t.setWidth(this.getWidth(),true);t.setHeight(this.getHeight(),true)};u.prototype.setShowLabel=function(t){var i;if(this.getShowLabel()!==t){i=this.getAggregation("_chart");this.setProperty("showLabel",t,true);i.setProperty("showTopLabels",t,true);i.setProperty("showBottomLabels",t,true);i.invalidate()}return this};u.prototype._createAndBindInnerChart=function(){if(this._aDataPointAnnotations.length===0){n.error("DataPoint annotation missing! Cannot create the SmartLineMicroChart");return}for(var t=0;t<this._aDataPointAnnotations.length;t++){if(!(this._aDataPointAnnotations[t].Value&&this._aDataPointAnnotations[t].Value.Path)){n.error("Value DataPoint annotation missing! Cannot create the SmartLineMicroChart");return}}var i=this.getAggregation("_chart"),e;this._aDataPointAnnotations.forEach(function(t,a){e=new h(this.getId()+"-line-"+a,{points:{path:this._getBindingPath(),factory:this._pointFactory.bind(this),events:{change:this._onBindingDataChange.bind(this)}}});i.addLine(e)},this)};u.prototype._pointFactory=function(t,i){var e,a,r,o=t.split("-").slice(-2,-1),n=this.getAggregation("_chart").getLines()[o],s=this._aDataPointAnnotations[o],h;e=i.getProperty(this._oChartViewMetadata.dimensionFields[o]);e=this._formatDimension.call(this,e);a=i.getProperty(s.Value.Path);a=Number(a);r=new c({x:e,y:a});if(n&&s.Criticality&&s.Criticality.Path){h=this._mapCriticalityTypeWithColor(i.getProperty(s.Criticality.Path));this.getAggregation("_chart").getLines()[o].setColor(h)}return r};u.prototype._onBindingDataChange=function(){var t=this.getAggregation("_chart").getLines()[0].getBinding("points");this._updateAssociations(t);this.updateChartLabels.call(this,t)};u.prototype._updateLabel=function(t,i){this.getAggregation("_chart").setProperty(t,i.text,true)};u.prototype._getLabelsMap=function(){return{leftTop:"leftTopLabel",rightTop:"rightTopLabel",leftBottom:"leftBottomLabel",rightBottom:"rightBottomLabel"}};return u});
/*!
 * SAPUI5
 * (c) Copyright 2009-2023 SAP SE. All rights reserved.
 */
sap.ui.predefine("sap/ui/comp/smartmicrochart/SmartMicroChart", ["sap/ui/comp/library","sap/ui/core/Control","sap/ui/comp/providers/ChartProvider","sap/suite/ui/microchart/library","sap/m/library","sap/ui/core/CustomData","sap/ui/comp/smartmicrochart/SmartMicroChartBase","sap/base/Log","./SmartMicroChartRenderer"],function(t,a,e,i,r,o,s,n,h){"use strict";var l=r.Size;var c=a.extend("sap.ui.comp.smartmicrochart.SmartMicroChart",{metadata:{library:"sap.ui.comp",designtime:"sap/ui/comp/designtime/smartmicrochart/SmartMicroChart.designtime",properties:{entitySet:{type:"string",group:"Misc",defaultValue:null},showLabel:{type:"boolean",group:"Appearance",defaultValue:true},enableAutoBinding:{type:"boolean",group:"Misc",defaultValue:false},chartBindingPath:{type:"string",group:"Misc",defaultValue:null},chartType:{type:"string",group:"Misc",defaultValue:null},width:{type:"sap.ui.core.CSSSize",group:"Misc"},height:{type:"sap.ui.core.CSSSize",group:"Misc"},size:{type:"sap.m.Size",group:"Misc",defaultValue:"Auto"},isResponsive:{type:"boolean",group:"Appearance",defaultValue:false}},defaultAggregation:"_chart",aggregations:{_chart:{type:"sap.ui.core.Control",multiple:false,visibility:"hidden"}},associations:{chartTitle:{type:"sap.m.Label",group:"Misc",multiple:false},chartDescription:{type:"sap.m.Label",group:"Misc",multiple:false},unitOfMeasure:{type:"sap.m.Label",group:"Misc",multiple:false},freeText:{type:"sap.m.Label",group:"Misc",multiple:false},ariaLabelledBy:{type:"sap.ui.core.Control",multiple:true,singularName:"ariaLabelledBy"}},events:{initialize:{}}},renderer:h});c.prototype.init=function(){this._bIsInitialized=false;this._bMetaModelLoadAttached=false};c.prototype.setChartType=function(){return this};c.prototype.getChartType=function(){return this.getAggregation("_chart").getChartType()};c.prototype.propagateProperties=function(){if(a.prototype.propagateProperties){a.prototype.propagateProperties.apply(this,arguments)}this._initializeMetadata()};c.prototype.onBeforeRendering=function(){var t=this.getAggregation("_chart");if(t){if(t.getMetadata().hasProperty("height")){t.setHeight(this.getHeight(),true)}if(t.getMetadata().hasProperty("width")){t.setWidth(this.getWidth(),true)}if(t.getMetadata().hasProperty("size")){t.setSize(this.getSize(),true)}i._passParentContextToChild(this,t);if(t.getMetadata().hasProperty("showLabel")){t.setShowLabel(this.getShowLabel(),true)}if(t.getMetadata().hasAssociation("chartTitle")){t.setAssociation("chartTitle",this.getChartTitle(),true)}if(t.getMetadata().hasAssociation("chartDescription")){t.setAssociation("chartDescription",this.getChartDescription(),true)}if(t.getMetadata().hasAssociation("unitOfMeasure")){t.setAssociation("unitOfMeasure",this.getUnitOfMeasure(),true)}if(t.getMetadata().hasAssociation("freeText")){t.setAssociation("freeText",this.getFreeText(),true)}}};c.prototype.setSize=function(t){if(this.getSize()!==t){this.setProperty("size",t)}return this};c.prototype.addAriaLabelledBy=function(t){this.addAssociation("ariaLabelledBy",t,true);this.getAggregation("_chart").addAriaLabelledBy(t);return this};c.prototype.removeAriaLabelledBy=function(t){this.removeAssociation("ariaLabelledBy",t,true);this.getAggregation("_chart").removeAriaLabelledBy(t);return this};c.prototype.removeAllAriaLabelledBy=function(){this.removeAllAssociation("ariaLabelledBy",true);this.getAggregation("_chart").removeAllAriaLabelledBy();return this};c.prototype._initializeMetadata=function(){if(!this._bIsInitialized){var t=this.getModel();if(t&&(t.getMetadata().getName()==="sap.ui.model.odata.v2.ODataModel"||t.getMetadata().getName()==="sap.ui.model.odata.ODataModel")){if(!this._bMetaModelLoadAttached){t.getMetaModel().loaded().then(this._onMetadataInitialized.bind(this));this._bMetaModelLoadAttached=true}}else if(t){this._onMetadataInitialized()}}};c.prototype._createChartProvider=function(){var t=this.getEntitySet(),a=this.getModel();if(a&&t){this._oChartProvider=new e({entitySet:t,model:a,chartQualifier:this.data("chartQualifier")})}};c.prototype._onMetadataInitialized=function(){var t,a;this._bMetaModelLoadAttached=false;if(!this._bIsInitialized){this._createChartProvider();if(this._oChartProvider){this._oChartViewMetadata=this._oChartProvider.getChartViewMetadata();if(this._oChartViewMetadata){this._bIsInitialized=true;this._createInnerChart()}else{t=this.data("chartQualifier");a=this._oChartProvider.getChartDataPointMetadata();if(a){a=t?a.additionalAnnotations[t]:a.primaryAnnotation;if(a){this._bIsInitialized=true;this._createInnerChartFromDataPoint(a)}else{n.error("There is no UI.Chart annotation nore DataPoint annotation. We cannot initialize SmartMicroChart.")}}else{n.error("There is no UI.Chart annotation nore DataPoint annotation. We cannot initialize SmartMicroChart.")}}}}};c.prototype._createInnerChartFromDataPoint=function(t){var a=t.Visualization.EnumMember;if(s._isBulletVizualizationType(a)){this._buildSmartBulletMicroChart()}else{n.error("Only Bullet chart can be initialize with just DataPoint annotation. Type: "+a+" is not a Bullet chart type.");return}this.invalidate()};c.prototype._createInnerChart=function(){if(!this._checkChartMetadata()){n.error("Created annotations not valid. Please review the annotations and metadata.");return}var t=this._oChartViewMetadata.chartType;switch(t){case"line":case"area":var a=this._oChartViewMetadata.annotation.ChartType.EnumMember.split("/").pop().toLowerCase();if(a==="area"){this._buildSmartAreaMicroChart()}else if(a==="line"){this._buildSmartLineMicroChart()}else{n.error("Not supported chart type used.");return}break;case"bullet":this._buildSmartBulletMicroChart();break;case"donut":this._buildSmartRadialMicroChart();break;case"stacked_bar":this._buildSmartStackedBarMicroChart();break;case"column":this._buildSmartColumnMicroChart();break;case"pie":this._buildSmartHarveyBallMicroChart();break;default:n.error("Not supported chart type used.");return}this.invalidate()};c.prototype._buildSmartLineMicroChart=function(){this._buildSmartMicroChart(t.smartmicrochart.SmartLineMicroChart)};c.prototype._buildSmartAreaMicroChart=function(){this._buildSmartMicroChart(t.smartmicrochart.SmartAreaMicroChart)};c.prototype._buildSmartBulletMicroChart=function(){this._buildSmartMicroChart(t.smartmicrochart.SmartBulletMicroChart)};c.prototype._buildSmartRadialMicroChart=function(){this._buildSmartMicroChart(t.smartmicrochart.SmartRadialMicroChart)};c.prototype._buildSmartStackedBarMicroChart=function(){this._buildSmartMicroChart(t.smartmicrochart.SmartStackedBarMicroChart)};c.prototype._buildSmartColumnMicroChart=function(){this._buildSmartMicroChart(t.smartmicrochart.SmartColumnMicroChart)};c.prototype._buildSmartHarveyBallMicroChart=function(){this._buildSmartMicroChart(t.smartmicrochart.SmartHarveyBallMicroChart)};c.prototype._buildSmartMicroChart=function(t){var a=new t({entitySet:this.getEntitySet(),chartBindingPath:this.getChartBindingPath(),initialize:[this._onChartInitialized,this],customData:[new o({key:"chartQualifier",value:this.data("chartQualifier")})]});if(a.getMetadata().hasProperty("enableAutoBinding")){a.setProperty("enableAutoBinding",this.getEnableAutoBinding(),true)}this.setAggregation("_chart",a,true)};c.prototype._onChartInitialized=function(){this.fireInitialize()};c.prototype._checkChartMetadata=function(){if(this._oChartViewMetadata.chartType&&this._oChartViewMetadata.annotation&&this._oChartViewMetadata.annotation.ChartType&&this._oChartViewMetadata.annotation.ChartType.EnumMember&&this._oChartViewMetadata.annotation.ChartType.EnumMember.length>0){return true}else{return false}};c.prototype.getAccessibilityInfo=function(){var t={};var a=this.getAggregation("_chart");if(a&&a.getAccessibilityInfo){t=a.getAccessibilityInfo()}return t};c.prototype._isResponsive=function(){return this.getSize()===l.Responsive};return c});
/*!
 * SAPUI5
 * (c) Copyright 2009-2023 SAP SE. All rights reserved.
 */
sap.ui.predefine("sap/ui/comp/smartmicrochart/SmartMicroChartBase", ["sap/ui/thirdparty/jquery","sap/ui/comp/library","sap/m/library","sap/ui/comp/providers/ChartProvider","sap/ui/core/format/NumberFormat","sap/ui/core/format/DateFormat","sap/ui/model/BindingMode","sap/ui/model/type/Date","sap/base/Log","sap/ui/core/Control","./SmartMicroChartRenderer","sap/ui/core/Core"],function(jQuery,t,e,a,i,r,o,n,s,l,h,p){"use strict";var u=e.ValueColor;var c=e.Size;var y=l.extend("sap.ui.comp.smartmicrochart.SmartMicroChartBase",{metadata:{abstract:true,library:"sap.ui.comp",properties:{entitySet:{type:"string",group:"Misc",defaultValue:null},chartType:{type:"string",group:"Misc"},chartBindingPath:{type:"string",group:"Misc",defaultValue:null},showLabel:{type:"boolean",group:"Appearance",defaultValue:true},width:{type:"sap.ui.core.CSSSize",group:"Misc"},height:{type:"sap.ui.core.CSSSize",group:"Misc"},size:{type:"sap.m.Size",group:"Misc",defaultValue:"Auto"},isResponsive:{type:"boolean",group:"Appearance",defaultValue:false}},defaultAggregation:"_chart",aggregations:{_chart:{type:"sap.ui.core.Control",multiple:false,visibility:"hidden"}},associations:{chartTitle:{type:"sap.m.Label",group:"Misc",multiple:false},chartDescription:{type:"sap.m.Label",group:"Misc",multiple:false},unitOfMeasure:{type:"sap.m.Label",group:"Misc",multiple:false},ariaLabelledBy:{type:"sap.ui.core.Control",multiple:true,singularName:"ariaLabelledBy"}},events:{initialize:{}}},renderer:h});y._MINIMIZE="com.sap.vocabularies.UI.v1.ImprovementDirectionType/Minimize";y._MAXIMIZE="com.sap.vocabularies.UI.v1.ImprovementDirectionType/Maximize";y._TARGET="com.sap.vocabularies.UI.v1.ImprovementDirectionType/Target";y._DELTABULLET="com.sap.vocabularies.UI.v1.VisualizationType/DeltaBulletChart";y._BULLET="com.sap.vocabularies.UI.v1.VisualizationType/BulletChart";y._CALENDAR_TERMS_PATTERNS={"com.sap.vocabularies.Common.v1.IsCalendarYear":"yyyy","com.sap.vocabularies.Common.v1.IsCalendarQuarter":"Q","com.sap.vocabularies.Common.v1.IsCalendarMonth":"MM","com.sap.vocabularies.Common.v1.IsCalendarWeek":"ww","com.sap.vocabularies.Common.v1.IsCalendarDate":"yyyyMMdd","com.sap.vocabularies.Common.v1.IsCalendarYearMonth":"yyyyMM"};y._ASSOCIATIONS=["chartTitle","chartDescription","unitOfMeasure","freeText"];y._ASSOCIATIONS_ANNOTATIONS_MAP={chartDescription:"Description",chartTitle:"Title",unitOfMeasure:{propertyAnnotationPath:"Value",propertyAnnotationProperties:["ISOCurrency","Unit"]},freeText:{propertyAnnotationPath:"Value",propertyAnnotationProperties:["Label"]}};y._isBulletVizualizationType=function(t){return t===y._BULLET||t===y._DELTABULLET};y.prototype._initializeMetadata=function(){if(!this._bIsInitialized){var t=this.getModel();if(t&&(t.getMetadata().getName()==="sap.ui.model.odata.v2.ODataModel"||t.getMetadata().getName()==="sap.ui.model.odata.ODataModel")){if(!this._bMetaModelLoadAttached){t.getMetaModel().loaded().then(this._onMetadataInitialized.bind(this));this._bMetaModelLoadAttached=true}}else if(t){this._onMetadataInitialized.call(this)}}};y.prototype._onMetadataInitialized=function(){this._bMetaModelLoadAttached=false;if(this._bIsInitialized){return}this._createChartProvider.call(this);this._oChartViewMetadata=this._oChartProvider.getChartViewMetadata();this._oDataPointMetadata=this._oChartProvider.getChartDataPointMetadata();this._bIsInitialized=true;this.fireInitialize();if(this.getEnableAutoBinding&&this.getEnableAutoBinding()){if(this.getChartBindingPath()){this.bindElement(this.getChartBindingPath())}else{s.error("The property chartBindingPath needs to be set in order for property enableAutoBinding to be applied.")}}if(this._checkChartMetadata.call(this)){this._aDataPointAnnotations=this._getDataPointAnnotations.call(this);this._oDataPointAnnotations=this._aDataPointAnnotations[0];if(this._aDataPointAnnotations.every(this._checkDataPointAnnotation.bind(this))){this._createAndBindInnerChart()}}else{s.error("Created annotations not valid. Please review the annotations and metadata.")}};y.prototype._getDataPointAnnotations=function(){var t=[],e;if(this._oChartViewMetadata&&this._oChartViewMetadata.measureFields){for(var a=0;a<this._oChartViewMetadata.measureFields.length;a++){e=this._getDataPointAnnotation.call(this,this._oChartViewMetadata.measureFields[a]);t.push(e)}}else{e=this._getDataPointAnnotation.call(this);t.push(e)}return t};y.prototype._cleanup=function(){if(this._oDateType){this._oDateType.destroy();this._oDateType=null}};y.prototype._createChartProvider=function(){var t,e;e=this.getEntitySet();t=this.getModel();if(t&&e){this._oChartProvider=new a({entitySet:e,model:t,chartQualifier:this.data("chartQualifier")})}else{s.error("Property entitySet is not set or no model has been attached to the control.")}};y.prototype._checkChartMetadata=function(){if(jQuery.isEmptyObject(this._oChartViewMetadata)){if(jQuery.isEmptyObject(this._oDataPointMetadata)){s.error("DataPoint annotation must be provided if chart annotation is missing.");return false}return true}else{if(!this._oChartViewMetadata.fields||this._oChartViewMetadata.fields.length===0){s.error("No fields exist in the metadata.");return false}if(this._hasMember(this,"_oChartViewMetadata.annotation.ChartType")){return this._checkChartType.call(this)}else if(this.getChartType()==="Comparison"||this.getChartType()==="Delta"){return true}else{s.error("The Chart annotation is invalid.");return false}}};y.prototype._checkChartType=function(){var t=this._getSupportedChartTypes();for(var e=0;e<t.length;e++){if(this._oChartViewMetadata.annotation.ChartType.EnumMember==="com.sap.vocabularies.UI.v1.ChartType/"+t[e]){return true}}s.error('The ChartType property in the Chart annotation is not part of the list of valid types: "'+t.toString()+'".');return false};y.prototype._getDataPointQualifier=function(t){var e;if(!this._oChartViewMetadata&&this._oDataPointMetadata){return this.data("chartQualifier")}if(!this._hasMember(this,"_oChartViewMetadata.annotation.MeasureAttributes.length")||!this._oChartViewMetadata.annotation.MeasureAttributes.length){return""}if(t&&this._oChartViewMetadata.measureAttributes&&this._oChartViewMetadata.measureAttributes[t]){return(this._oChartViewMetadata.measureAttributes[t].dataPoint.match(/\#([^\#]*)$/)||[])[1]||""}e=this._oChartViewMetadata.annotation.MeasureAttributes[0];if(this._hasMember(e,"DataPoint.AnnotationPath")){return(e.DataPoint.AnnotationPath.match(/\#([^\#]*)$/)||[])[1]||""}};y.prototype._getDataPointAnnotation=function(t){var e=this._getDataPointQualifier.call(this,t),a;if(e){a=this._oDataPointMetadata.additionalAnnotations[e]}else{a=this._oDataPointMetadata.primaryAnnotation}return a};y.prototype._checkDataPointAnnotation=function(t){var e=null;if(jQuery.isEmptyObject(t)){s.error("The DataPoint annotation is empty. Please check it!");return false}if(this._hasMember(t,"Visualization.EnumMember")){e=t.Visualization.EnumMember;if(!y._isBulletVizualizationType(e)){s.error("The only support visualization types for micro charts are BulletChart and DeltaBulletChart.");return false}}if(jQuery.isEmptyObject(this._oChartViewMetadata)&&e===null){s.error("If only DataPoint annotation is provided the VisualizationType is expected to be set.");return false}if(this._hasMember(t,"Value.Path")){if(jQuery.isEmptyObject(t.Criticality)){this._checkCriticalityMetadata(t.CriticalityCalculation)}return true}else{s.error("The Value property does not exist in the DataPoint annotation. This property is essential for creating the smart chart.");return false}};y.prototype._checkCriticalityMetadata=function(t){if(jQuery.isEmptyObject(t)){s.warning("The CriticalityCalculation property in DataPoint annotation is not provided.");return false}if(this._hasMember(t,"ImprovementDirection.EnumMember")){var e=t.ImprovementDirection.EnumMember;switch(e){case y._MINIMIZE:return this._checkCriticalityMetadataForMinimize(t);case y._MAXIMIZE:return this._checkCriticalityMetadataForMaximize(t);case y._TARGET:return this._checkCriticalityMetadataForTarget(t);default:s.warning("The improvement direction in DataPoint annotation must be either Minimize, Maximize or Target.")}}else{s.warning("The ImprovementDirection property in DataPoint annotation is not provided.")}return false};y.prototype._checkCriticalityMetadataForMinimize=function(t){if(!this._hasMember(t,"ToleranceRangeHighValue.Path")){s.warning("The ToleranceRangeHighValue property in DataPoint annotation is missing for Minimize improvement direction.");return false}if(!this._hasMember(t,"DeviationRangeHighValue.Path")){s.warning("The DeviationRangeHighValue property in DataPoint annotation is missing for Minimize improvement direction.");return false}return true};y.prototype._checkCriticalityMetadataForMaximize=function(t){if(!this._hasMember(t,"ToleranceRangeLowValue.Path")){s.warning("The ToleranceRangeLowValue property in DataPoint annotation is missing for Minimize improvement direction.");return false}if(!this._hasMember(t,"DeviationRangeLowValue.Path")){s.warning("The DeviationRangeLowValue property in DataPoint annotation is missing for Minimize improvement direction.");return false}return true};y.prototype._checkCriticalityMetadataForTarget=function(t){if(!this._hasMember(t,"ToleranceRangeLowValue.Path")){s.warning("The DeviationRangeLowValue property in DataPoint annotation is missing for Target improvement direction.");return false}if(!this._hasMember(t,"ToleranceRangeHighValue.Path")){s.warning("The ToleranceRangeHighValue property in DataPoint annotation is missing for Target improvement direction.");return false}if(!this._hasMember(t,"DeviationRangeLowValue.Path")){s.warning("The ToleranceRangeLowValue property in DataPoint annotation is missing for Target improvement direction.");return false}if(!this._hasMember(t,"DeviationRangeHighValue.Path")){s.warning("The DeviationRangeHighValue property in DataPoint annotation is missing for Target improvement direction.");return false}return true};y.prototype._mapCriticalityTypeWithColor=function(t){var e;if(!t){return u.Neutral}else{e=t.toString()}e=(e.match(/(?:CriticalityType\/)?([^\/]*)$/)||[])[1]||"";switch(e){case"Negative":case"1":return u.Error;case"Critical":case"2":return u.Critical;case"Positive":case"3":return u.Good;default:return u.Neutral}};y.prototype._getThresholdValues=function(t){var e={},a=this.getBindingContext();for(var i in t){if(t.hasOwnProperty(i)&&i!=="ImprovementDirection"){e[i]=t[i].Path&&a&&a.getProperty(t[i].Path)||t[i].Decimal||0}}return e};y.prototype._getValueColorForMinimize=function(t,e,a){if(t<=e){return this._mapCriticalityTypeWithColor("Positive")}else if(t>e&&t<=a){return this._mapCriticalityTypeWithColor("Critical")}else if(t>a){return this._mapCriticalityTypeWithColor("Negative")}};y.prototype._getValueColorForMaximize=function(t,e,a){if(t>=e){return this._mapCriticalityTypeWithColor("Positive")}else if(t<e&&t>=a){return this._mapCriticalityTypeWithColor("Critical")}else if(t<a){return this._mapCriticalityTypeWithColor("Negative")}};y.prototype._getValueColorForTarget=function(t,e,a,i,r){if(t>=e&&t<=i){return this._mapCriticalityTypeWithColor("Positive")}else if(t>=a&&t<e||t>i&&t<=r){return this._mapCriticalityTypeWithColor("Critical")}else if(t<a||t>r){return this._mapCriticalityTypeWithColor("Negative")}};y.prototype._getValueColor=function(t,e){var a=this._oDataPointAnnotations.CriticalityCalculation,i,r;t=parseFloat(t)||0;if(typeof e==="string"){r=this._mapCriticalityTypeWithColor(e)}else if(a&&typeof t!=="undefined"&&t!==null){i=this._getThresholdValues.call(this,a);r=this._criticalityCalculation(t,a.ImprovementDirection.EnumMember,i)}return r||this._mapCriticalityTypeWithColor()};y.prototype._getTopLabelColor=function(t,e,a){var i=this._aDataPointAnnotations[a].CriticalityCalculation,r=parseFloat(t)||0,o={},n;for(var s in i){if(i.hasOwnProperty(s)&&s!=="ImprovementDirection"){o[s]=e[i[s].Path]}}if(i&&typeof r!=="undefined"&&r!==null){n=this._criticalityCalculation(r,i.ImprovementDirection.EnumMember,o)}return n};y.prototype._criticalityCalculation=function(t,e,a){var i;switch(e){case y._MINIMIZE:i=this._getValueColorForMinimize(t,a.ToleranceRangeHighValue,a.DeviationRangeHighValue);break;case y._MAXIMIZE:i=this._getValueColorForMaximize(t,a.ToleranceRangeLowValue,a.DeviationRangeLowValue);break;case y._TARGET:i=this._getValueColorForTarget(t,a.ToleranceRangeLowValue,a.DeviationRangeLowValue,a.ToleranceRangeHighValue,a.DeviationRangeHighValue);break;default:s.warning("The improvement direction in DataPoint annotation must be either Minimize, Maximize or Target.")}return i};y.prototype._getAnnotation=function(t){var e=y._ASSOCIATIONS_ANNOTATIONS_MAP[t];if(!e){s.warning('No annotation connected to association "'+t+'".');return{}}if(!jQuery.isEmptyObject(this._oChartViewMetadata)&&typeof e==="string"){return this._oChartViewMetadata.annotation[e]}if(!jQuery.isEmptyObject(this._oDataPointAnnotations)&&this._hasMember(e,"propertyAnnotationPath")&&this._hasMember(e,"propertyAnnotationProperties")){var a;if(this._hasMember(this._oDataPointAnnotations,e.propertyAnnotationPath+".Path")){a=this._getPropertyAnnotation.call(this,this._oDataPointAnnotations[e.propertyAnnotationPath].Path)}if(a){return this._getValueFromPropertyAnnotation(a,e.propertyAnnotationProperties)}}return{}};y.prototype._getValueFromPropertyAnnotation=function(t,e){for(var a in t){for(var i=0;i<e.length;i++){if(a.indexOf(e[i])>-1){return t[a]}}}return{}};y.prototype._updateAssociation=function(t,e){var a,i;if(this.getMetadata().hasAssociation(t)){a=p.byId(this.getAssociation(t));if(a&&a.getMetadata().hasProperty("text")){i=this._getAnnotation.call(this,t);this._setAssociationText(a,i,e)}}};y.prototype._updateAssociations=function(t){var e=t&&t.getContexts(0,1)[0],a=e&&e.getObject();var i=y._ASSOCIATIONS.length;for(var r=0;r<i;r++){this._updateAssociation.call(this,y._ASSOCIATIONS[r],a)}};y.prototype.updateChartLabels=function(t){var e={value:Infinity},a={value:-Infinity},i={value:Infinity},r={value:-Infinity},o,n,s,l,h;h=t.getContexts();h.forEach(function(t){for(var h=0;h<this._oChartViewMetadata.dimensionFields.length;h++){s=this._oChartViewMetadata.dimensionFields[h];o=t.getProperty(s);l=this._oChartViewMetadata.measureFields[h];n=t.getProperty(l);e=o<e.value?{context:t,value:o,index:h}:e;a=o>a.value?{context:t,value:o,index:h}:a;i=n<i.value?{context:t,value:n,index:h}:i;r=n>r.value?{context:t,value:n,index:h}:r}},this);if(i.context&&e.context&&r.context&&a.context){this._updateTopLabel.call(this,this._getLabelsMap()["leftTop"],i.context.getObject(),i.index);this._updateBottomLabel.call(this,this._getLabelsMap()["leftBottom"],e.context.getObject(),e.index);this._updateTopLabel.call(this,this._getLabelsMap()["rightTop"],r.context.getObject(),r.index);this._updateBottomLabel.call(this,this._getLabelsMap()["rightBottom"],a.context.getObject(),a.index)}};y.prototype._updateTopLabel=function(t,e,a){var i=e[this._aDataPointAnnotations[a].Value.Path],r=this._getTopLabelColor.call(this,i,e,a),o=this._getLabelNumberFormatter.call(this,this._aDataPointAnnotations[a].Value.Path),n;n=o.format(i);this._updateLabel(t,{text:n,color:r})};y.prototype._updateBottomLabel=function(t,e,a){var i,r,o,n;i=this._oChartViewMetadata.dimensionFields[a];if(i){o=e[i];r=this._getPropertyAnnotation.call(this,this._oChartViewMetadata.dimensionFields[a]);if(r.hasOwnProperty("sap:text")||r.hasOwnProperty("com.sap.vocabularies.Common.v1.Text")){var s=r["sap:text"]||r["com.sap.vocabularies.Common.v1.Text"].Path;n=e[s]}else{n=this._formatBottomLabel.call(this,o,r)}if(n){this._updateLabel(t,{text:n})}}};y.prototype._formatBottomLabel=function(t,e){var a=this._getSemanticsPattern.call(this,e);if(a){return this._formatSemanticsValue.call(this,t,a)}a=this._getCalendarPattern.call(this,e);if(a){return this._formatSemanticsValue.call(this,t,a)}return this._formatDateAndNumberValue.call(this,t)};y.prototype._formatSemanticsValue=function(t,e){if(e){if(!this._oDateType){this._oDateType=new n({style:"short",source:{pattern:e}})}return this._oDateType.formatValue(t,"string")}return null};y.prototype._formatDateAndNumberValue=function(t){if(t instanceof Date){return this._getLabelDateFormatter.call(this).format(t)}else if(!isNaN(t)){return this._getLabelNumberFormatter.call(this,this._oChartViewMetadata.dimensionFields[0]).format(t)}else{return null}};y.prototype._getSemanticsPattern=function(t){if(t.hasOwnProperty("sap:semantics")){switch(t["sap:semantics"]){case"yearmonthday":return"yyyyMMdd";case"yearmonth":return"yyyyMM";case"year":return"yyyy";default:return null}}return null};y.prototype._getCalendarPattern=function(t){for(var e in y._CALENDAR_TERMS_PATTERNS){if(t.hasOwnProperty(e)){return y._CALENDAR_TERMS_PATTERNS[e]}}return null};y.prototype._getLabelNumberFormatter=function(t){var e=this._getPropertyAnnotation.call(this,t).precision||null;return i.getFloatInstance({style:"short",showScale:true,precision:e})};y.prototype._getLabelDateFormatter=function(){return r.getInstance({style:"short"})};y.prototype._setAssociationText=function(t,e,a){if(!e){return}if(e.Path&&a){t.setProperty("text",a[e.Path],false)}else if(e.Path){t.bindProperty("text",{path:e.Path,mode:o.OneWay});t.invalidate()}else if(e.String){if(e.String.indexOf("{")===0){var i=e.String.split(">");t.bindProperty("text",{path:i[1].substr(0,i[1].length-1),model:i[0].substr(1),mode:o.OneWay});t.invalidate()}else{t.setProperty("text",e.String,false)}}};y.prototype._getPropertyAnnotation=function(t){var e,a,i,r;e=this.getModel().getMetaModel();a=this._oChartProvider._oMetadataAnalyser.getEntityTypeNameFromEntitySetName(this.getEntitySet());i=e.getODataEntityType(a);r=e.getODataProperty(i,t);return r};y.prototype._hasMember=function(t,e){var a=".",i=e.split(a),r=i.shift();return!!t&&(i.length>0?this._hasMember(t[r],i.join(a)):t.hasOwnProperty(r))};y.prototype.getAccessibilityInfo=function(){var t={};var e=this.getAggregation("_chart");if(e&&e.getAccessibilityInfo){t=e.getAccessibilityInfo()}return t};y.prototype._formatDimension=function(t){if(typeof t==="string"){var e=this._getPropertyAnnotation.call(this,this._oChartViewMetadata.dimensionFields[0]),a=this._getSemanticsPattern.call(this,e);if(a){t=r.getInstance({pattern:a}).parse(t)}}if(t instanceof Date){return parseFloat(t.getTime())}else if(!isNaN(t)){return parseFloat(t)}else{this.getAggregation("_chart").enableXIndexing(true);return 0}};y.prototype.exit=function(){this._cleanup.call(this)};y.prototype.setEntitySet=function(t){if(this.getProperty("entitySet")!==t){this.setProperty("entitySet",t,true);this._initializeMetadata.call(this)}return this};y.prototype.addAriaLabelledBy=function(t){this.addAssociation("ariaLabelledBy",t,true);this.getAggregation("_chart").addAriaLabelledBy(t);return this};y.prototype.removeAriaLabelledBy=function(t){this.removeAssociation("ariaLabelledBy",t,true);this.getAggregation("_chart").removeAriaLabelledBy(t);return this};y.prototype.removeAllAriaLabelledBy=function(){this.removeAllAssociation("ariaLabelledBy",true);this.getAggregation("_chart").removeAllAriaLabelledBy();return this};y.prototype.setChartType=function(){return this};y.prototype.propagateProperties=function(){if(l.prototype.propagateProperties){l.prototype.propagateProperties.apply(this,arguments)}this._initializeMetadata.call(this)};y.prototype._getBindingPath=function(){if(this.getChartBindingPath()){return this.getChartBindingPath()}else if(this.getEntitySet()){return"/"+this.getEntitySet()}else{return""}};y.prototype._getSupportedChartTypes=function(){return this._CHART_TYPE};y.prototype.setSize=function(t){if(this.getSize()!==t){this.setProperty("size",t)}return this};y.prototype.setAssociation=function(t,e,a){if(l.prototype.setAssociation){l.prototype.setAssociation.apply(this,arguments)}this._updateAssociation.call(this,t);return this};y.prototype._isResponsive=function(){return this.getSize()===c.Responsive};return y});
/*!
 * SAPUI5
 * (c) Copyright 2009-2023 SAP SE. All rights reserved.
 */
sap.ui.predefine("sap/ui/comp/smartmicrochart/SmartMicroChartRenderer", [],function(){"use strict";var e={apiVersion:2};e.render=function(e,i){if(i._bIsInitialized){e.openStart("div",i);if(i._isResponsive()){e.class("sapSuiteUiSmartMicroChartResponsive")}e.openEnd();e.renderControl(i.getAggregation("_chart"));e.close("div")}};return e},true);
/*!
 * SAPUI5
 * (c) Copyright 2009-2023 SAP SE. All rights reserved.
 */
sap.ui.predefine("sap/ui/comp/smartmicrochart/SmartRadialMicroChart", ["sap/ui/comp/library","sap/ui/core/Control","sap/suite/ui/microchart/library","sap/suite/ui/microchart/RadialMicroChart","sap/m/library","sap/ui/comp/smartmicrochart/SmartMicroChartBase","./SmartMicroChartRenderer"],function(t,a,i,e,o,r,n){"use strict";var s=r.extend("sap.ui.comp.smartmicrochart.SmartRadialMicroChart",{metadata:{library:"sap.ui.comp",designtime:"sap/ui/comp/designtime/smartmicrochart/SmartRadialMicroChart.designtime",properties:{enableAutoBinding:{type:"boolean",group:"Misc",defaultValue:false}},associations:{freeText:{type:"sap.m.Label",group:"Misc",multiple:false}}},renderer:n});s.prototype._CHART_TYPE=["Donut"];s.prototype.init=function(){this._bIsInitialized=false;this._bMetaModelLoadAttached=false;this.setProperty("chartType","Donut",true);this.setAggregation("_chart",new e,true)};s.prototype.onBeforeRendering=function(){var t=this.getAggregation("_chart");t.setSize(this.getSize(),true);i._passParentContextToChild(this,t)};s.prototype._createAndBindInnerChart=function(){this._bindProperties();this._updateAssociations.call(this)};s.prototype._bindProperties=function(){var t=this.getAggregation("_chart");if(this._oDataPointAnnotations.Value&&!this._oDataPointAnnotations.TargetValue){if(this._hasMember(this._oDataPointAnnotations.Value,"Path")){t.bindProperty("percentage",{path:this._oDataPointAnnotations.Value.Path,type:"sap.ui.model.odata.type.Decimal"})}}else if(this._hasMember(this,"_oDataPointAnnotations.TargetValue.Path")&&this._hasMember(this,"_oDataPointAnnotations.Value.Path")){t.bindProperty("total",{path:this._oDataPointAnnotations.TargetValue.Path,type:"sap.ui.model.odata.type.Decimal"});t.bindProperty("fraction",{path:this._oDataPointAnnotations.Value.Path,type:"sap.ui.model.odata.type.Decimal"})}t.bindProperty("valueColor",{parts:[this._oDataPointAnnotations.Value&&this._oDataPointAnnotations.Value.Path||"",this._oDataPointAnnotations.Criticality&&this._oDataPointAnnotations.Criticality.Path||""],formatter:this._getValueColor.bind(this)})};return s});
/*!
 * SAPUI5
 * (c) Copyright 2009-2023 SAP SE. All rights reserved.
 */
sap.ui.predefine("sap/ui/comp/smartmicrochart/SmartStackedBarMicroChart", ["sap/ui/comp/library","sap/suite/ui/microchart/StackedBarMicroChart","sap/suite/ui/microchart/StackedBarMicroChartBar","sap/ui/core/Control","sap/ui/model/odata/CountMode","sap/ui/core/format/DateFormat","sap/m/library","sap/base/Log","sap/ui/comp/smartmicrochart/SmartMicroChartBase","./SmartMicroChartRenderer"],function(t,a,i,e,r,o,n,s,h,c){"use strict";var p=h.extend("sap.ui.comp.smartmicrochart.SmartStackedBarMicroChart",{metadata:{library:"sap.ui.comp",designtime:"sap/ui/comp/designtime/smartmicrochart/SmartStackedBarMicroChart.designtime"},renderer:c});p.prototype._CHART_TYPE=["BarStacked"];p.prototype.init=function(){this._bIsInitialized=false;this._bMetaModelLoadAttached=false;this.setProperty("chartType","BarStacked",true);this.setAggregation("_chart",new a,true)};p.prototype.onBeforeRendering=function(){var t=this.getAggregation("_chart");t.setSize(this.getSize(),true);t.setWidth(this.getWidth(),true);t.setHeight(this.getHeight(),true)};p.prototype._createAndBindInnerChart=function(){if(!(this._oDataPointAnnotations.Value&&this._oDataPointAnnotations.Value.Path)){s.error("Value DataPoint annotation missing! Cannot create the SmartStackedBarMicroChart");return}var t=this.getAggregation("_chart"),a=new i({value:{path:this._oDataPointAnnotations.Value.Path,type:"sap.ui.model.odata.type.Decimal"}});if(this._oDataPointAnnotations.Criticality&&this._oDataPointAnnotations.Criticality.Path){a.bindProperty("valueColor",{path:this._oDataPointAnnotations.Criticality.Path,formatter:this._mapCriticalityTypeWithColor.bind(this)})}var e=this._getPropertyAnnotation.call(this,this._oDataPointAnnotations.Value.Path);var r=e["com.sap.vocabularies.Common.v1.Text"];if(r&&r.Path){a.bindProperty("displayValue",r.Path)}t.bindAggregation("bars",{path:this._getBindingPath(),template:a,events:{change:this._onBindingDataChange.bind(this)}})};p.prototype._onBindingDataChange=function(){var t=this.getAggregation("_chart").getBinding("bars");this._updateAssociations(t)};return p});
/*!
 * SAPUI5
 * (c) Copyright 2009-2023 SAP SE. All rights reserved.
 */
sap.ui.predefine("sap/ui/comp/smartmultiedit/Container", ["sap/ui/thirdparty/jquery",".././library","sap/ui/core/Control","sap/ui/comp/smartmultiedit/Field","sap/ui/model/Context","sap/base/Log"],function(jQuery,t,e,i,a,o){"use strict";var r=e.extend("sap.ui.comp.smartmultiedit.Container",{metadata:{library:"sap.ui.comp",properties:{entitySet:{type:"string",defaultValue:null},contexts:{type:"sap.ui.model.Context[]",defaultValue:[]}},defaultAggregation:"layout",aggregations:{layout:{type:"sap.ui.comp.smartform.SmartForm",multiple:false}},designTime:"sap/ui/comp/designtime/smartmultiedit/Container.designtime"},renderer:{apiVersion:2,render:function(t,e){t.openStart("div",e);t.class("sapUiCompSmartMultiEditContainer");t.openEnd();if(e._bReadyToRender){t.renderControl(e.getLayout())}t.close("div")}}});r.prototype.init=function(){this._bIsInitialized=false;this._bReadyToRender=false;this._aFields=null;this.attachEvent("modelContextChange",this._initializeMetadata,this)};r.prototype.setEntitySet=function(t){if(t!==this.getProperty("entitySet")){this.setProperty("entitySet",t,true);if(t){this._initializeMetadata()}}return this};r.prototype.setContexts=function(t){if(Array.isArray(t)){for(var e=0;e<t.length;e++){if(!(t[e]instanceof a)){return this}}this.setProperty("contexts",t,true);this._getFields().forEach(function(t){t._updateContextItems()})}else{o.error("Parameter contexts is expected to be an array.")}return this};r.prototype.setLayout=function(t){this.setAggregation("layout",t,true);this._refreshFields();return this};r.prototype.addCustomData=function(t){var i;if(!t){return this}e.prototype.addCustomData.apply(this,arguments);this._getFields().forEach(function(e){i=t.clone();e._oSmartField.addCustomData(i)});return this};r.prototype.insertCustomData=function(t,i){var a;if(!t){return this}e.prototype.insertCustomData.apply(this,arguments);this._getFields().forEach(function(e){a=t.clone();e._oSmartField.addCustomData(a)});return this};r.prototype.removeCustomData=function(t){var i=e.prototype.removeCustomData.apply(this,arguments);if(i){this._getFields().forEach(function(t){t._oSmartField.removeCustomData(i)})}return i};r.prototype.removeAllCustomData=function(){var t=e.prototype.removeAllCustomData.apply(this,arguments);if(t.length>0){this._getFields().forEach(function(e){t.forEach(function(t){e._oSmartField.removeCustomData(t)})})}return t};r.prototype.destroyCustomData=function(){e.prototype.destroyCustomData.apply(this,arguments);this._getFields().forEach(function(t){t._oSmartField.destroyCustomData()});return this};r.prototype.getAllUpdatedContexts=function(t){var e=this.getContexts(),i=[],a=this,o=0,r=10;if(e.length===0){return Promise.resolve(i)}return new Promise(function(n){function s(u,l,d){for(o=l;o<Math.min(d,u.length);o++){i.push({context:u[o],data:a._getUpdatedDataObject(u[o].getObject(),t)})}if(o<u.length){setTimeout(s.bind(null,e,o,o+r),0)}else{n(i)}}s(e,o,o+r)})};r.prototype.getErroneousFields=function(){return this._getFields().filter(function(t){t._performValidation();return t.hasClientError()})};r.prototype.getErroneousFieldsAndTokens=function(){var t=this._getFields().map(function(t){return t._performValidation()});return Promise.all(t).then(function(){var t=this._getFields().filter(function(t){return t.hasClientError()});return t}.bind(this))};r.prototype.indexField=function(t){var e;if(!(t instanceof i)){o.error("Container.indexField","Element '"+JSON.stringify(t)+"' must be of type sap.ui.comp.smartmultiedit.Field","sap.ui.comp.smartmultiedit.Container");return}this._aFields.push(t);t._setContainer(this);this.getCustomData().forEach(function(i){if(t.getSmartField()){e=i.clone();t.getSmartField().addCustomData(e)}})};r.prototype._getUpdatedDataObject=function(t,e){var i=e?Object.assign({},t):{},a,r,n,s;this._getFields().forEach(function(e){a=e.getPropertyName();r=e.getUnitOfMeasurePropertyName();s=e.getRawValue();if(s.hasOwnProperty(a)){if(e.isDate()||e.isDateTime()){if(!t[a]){if(s[a]){i[a]=s[a]}}else if(!s[a]){i[a]=null}else if(!t[a].getTime){o.error("Container._getUpdatedDataObject","Field "+a+" has incompatible data and metadata, expected: Date/DateTime, but found "+typeof i[a],"sap.ui.comp.smartmultiedit.Container");return}else if(s[a].getTime()!==t[a].getTime()){i[a]=s[a]}}else{if(s[a]!==t[a]&&(s[a]!==""&&s[a]!=null||t[a]!==""&&t[a]!=null)){i[a]=s[a]}}}if(e.isComposite()&&s.hasOwnProperty(r)&&s[r]!==t[r]){i[r]=s[r]}else if(e.isComboBox()){n=e.getRecordTextPath();if(s.hasOwnProperty(n)&&s[n]!==t[n]){i[n]=s[n]}}});return i};r.prototype.getFields=function(t){return this._getFields(t)};r.prototype._getFields=function(t){var e=[];if((t||!this._aFields||Array.isArray(this._aFields)&&!this._aFields.length)&&this.getLayout()){this._aFields=[];this.getLayout().getGroups().forEach(function(a){a.getGroupElements().forEach(function(a){a.getElements().forEach(function(a){if(a instanceof i){this.indexField(a)}else if(t){e.push(a)}}.bind(this))}.bind(this))}.bind(this))}return e.concat(this._aFields||[])};r.prototype._initializeMetadata=function(){var t=this.getModel();if(!this._bIsInitialized&&this.getEntitySet()&&t&&t.getMetadata().getName()==="sap.ui.model.odata.v2.ODataModel"){if(!this.getBindingContext()){var e=t.createEntry("/"+this.getEntitySet());this.setBindingContext(e);this.getModel().resetChanges([e.getPath()],undefined,true)}t.getMetaModel().loaded().then(this._onMetadataInitialized.bind(this))}};r.prototype._onMetadataInitialized=function(){if(this._bIsInitialized){return}this._bIsInitialized=true;this._bReadyToRender=true;this.invalidate()};r.prototype.resetContainer=function(){this._aFields.forEach(function(t){t.resetField()});this._bIsInitialized=false};r.prototype._refreshFields=function(){this._aFields=null;this._getFields()};return r});
/*!
 * SAPUI5
 * (c) Copyright 2009-2023 SAP SE. All rights reserved.
 */
sap.ui.predefine("sap/ui/comp/smartmultiedit/Field", ["../library","sap/ui/core/library","sap/ui/core/Control","sap/ui/core/Item","sap/m/Select","sap/ui/comp/smartfield/SmartField","sap/ui/comp/smartfield/SmartLabel","sap/ui/comp/smartfield/ODataControlFactory","sap/ui/model/BindingMode","sap/ui/model/Filter","sap/ui/model/FilterOperator","sap/m/HBox","sap/ui/core/format/NumberFormat","sap/ui/core/format/DateFormat","sap/m/CheckBox","sap/m/Label","sap/m/Input","sap/base/Log","sap/ui/comp/odata/MetadataAnalyser","sap/ui/comp/smartfield/ComboBox","sap/ui/comp/smartfield/type/Decimal","sap/ui/core/Lib"],function(t,e,i,o,s,a,n,r,l,u,p,h,d,m,c,_,f,g,y,S,C,I){"use strict";var F=e.ValueState;var T=r.extend("sap.ui.comp.smartmultiedit.HackedControlFactory");T.prototype.createAttributes=function(t,e,i,o){var s=r.prototype.createAttributes.apply(this,arguments);if(t&&s[t]){s[t].mode=l.OneWay}return s};T.prototype._createEdmUOMAttributes=function(){var t=r.prototype._createEdmUOMAttributes.apply(this,arguments);if(t.value){t.value.mode=l.OneWay}return t};T.prototype._createEdmDateTime=function(){var t=r.prototype._createEdmDateTime.apply(this);t.params.getValue=function(){if(t.control.getDateValue()){return t.params.type.type.parseValue(t.control.getValue(),"string")}else{return null}};return t};T.prototype._createEdmDateTimeOffset=function(){var t=r.prototype._createEdmDateTimeOffset.apply(this);t.params.getValue=function(){if(t.control.getDateValue()){return t.params.type.type.parseValue(t.control.getValue(),"string")}else{return null}};return t};T.prototype._onCreate=function(t,e){var i;if(e&&typeof e.getValue==="function"){i=e.getValue;e.getValue=null}if(r.prototype._onCreate){r.prototype._onCreate.call(this,t,e)}if(i){e.getValue=i}};T.createFromFactory=function(t){if(!t){return null}return new T(t._oModel,t._oParent,t._oMeta)};var E=10;var V=i.extend("sap.ui.comp.smartmultiedit.Field",{metadata:{library:"sap.ui.comp",designtime:"sap/ui/comp/designtime/smartmultiedit/Field.designtime",properties:{propertyName:{type:"string",defaultValue:null},useApplyToEmptyOnly:{type:"boolean",defaultValue:false},applyToEmptyOnly:{type:"boolean",defaultValue:false},description:{type:"string",defaultValue:null},validateTokenExistence:{type:"boolean",defaultValue:true}},aggregations:{configuration:{type:"sap.ui.comp.smartfield.Configuration",multiple:false}},associations:{},events:{change:{parameters:{selectedItem:{type:"sap.ui.core.Item"}}}}},renderer:{apiVersion:2,render:function(t,e){t.openStart("div",e);t.class("sapUiCompSmartMultiEditField");t.openEnd();t.renderControl(e._oSelect);t.openStart("div");t.class("sapUiCompSmartMultiEditFieldSFWrapper");t.openEnd();if(e._oSmartField&&e._oSmartField.aCustomStyleClasses.indexOf("sapUiCompSmartMultiEditSmartField")>=0){t.renderControl(e._oSmartField)}t.close("div");if(e.getDescription()){t.openStart("div");t.class("sapUiCompSmartMultiEditSmartFieldDescription");t.openEnd();e._oDescription.setText(e.getDescription());t.renderControl(e._oDescription);t.close("div")}if(e.getUseApplyToEmptyOnly()){t.renderControl(e._oApplyToEmptyOnlyCheckBox)}t.close("div")}}});V.ACTION_ITEM_KEY={KEEP:"keep",BLANK:"blank",NEW:"new",TRUE:"true",FALSE:"false"};V.prototype.init=function(){this._createSelect();this._createSpecialSelectItems();this._createDescription();this._createApplyToEmptyOnlyCheckBox();this._oContainer=null;this._bNullable=true;this._bShowValueHelp=true;this._bClientError=null;this._oAnnotations=null;this._aDistinctValues=[];this._mRecordKeyTextMap={}};V.prototype.onBeforeRendering=function(){this._updateSpecialSelectItems()};V.prototype.getNullable=function(){return this._bNullable};V.prototype.getShowValueHelp=function(){return this._bShowValueHelp};V.prototype.getLabel=function(){if(this.getParent()&&this.getParent().getLabel){return this.getParent().getLabel()}else{return null}};V.prototype.getSmartField=function(){return this._oSmartField};V.prototype.getValue=function(){return this._oSmartField?this._oSmartField.getValue():null};V.prototype.getDataType=function(){if(!this._oSmartField){return null}try{return this._oSmartField.getDataType()}catch(t){return null}};V.prototype.isComposite=function(){return!!(this._oAnnotations&&this._oAnnotations.uom)};V.prototype.isString=function(){return this.getDataType()==="Edm.String"};V.prototype.isInteger=function(){return this.getDataType()==="Edm.Byte"||this.getDataType()==="Edm.Int16"||this.getDataType()==="Edm.Int32"||this.getDataType()==="Edm.Int64"||this.getDataType()==="Edm.SByte"};V.prototype.isFloat=function(){return this.getDataType()==="Edm.Decimal"||this.getDataType()==="Edm.Double"||this.getDataType()==="Edm.Float"||this.getDataType()==="Edm.Single"};V.prototype.isDate=function(){return this.getDataType()==="Edm.DateTime"};V.prototype.isDateTime=function(){return this.getDataType()==="Edm.DateTimeOffset"};V.prototype.isTime=function(){return this.getDataType()==="Edm.Time"};V.prototype.isBoolean=function(){return this.getDataType()==="Edm.Boolean"};V.prototype.isComboBox=function(){var t=this._getCurrentValueControl();return t&&t.isA("sap.m.ComboBox")||false};V.prototype.getRecordTextPath=function(){if(this._oAnnotations&&this._oAnnotations.text){return this._oAnnotations.text.path}else{return null}};V.prototype.getUnitOfMeasure=function(){return this._oSmartField?this._oSmartField.getUnitOfMeasure():null};V.prototype.getUnitOfMeasurePropertyName=function(){return this._oAnnotations&&this._oAnnotations.uom?this._oAnnotations.uom.path:null};V.prototype.setParent=function(t,e,o){i.prototype.setParent.call(this,t,e,o);if(t&&t.getLabel&&!t.getLabel()){this._oLabel=new n(this.getId()+"-SmartLabel");this._oLabel.onFieldVisibilityChange=function(){};this._oLabel.setLabelFor(this._oSmartField.getId());t.setLabel(this._oLabel);this._oSelect.addAriaLabelledBy(this._oLabel);if(this.getDescription()){this._oSelect.addAriaLabelledBy(this._oDescription)}}return this};V.prototype.addCustomData=function(t){var e;if(!t){return this}i.prototype.addCustomData.apply(this,arguments);e=t.clone();this._oSmartField.addCustomData(e);return this};V.prototype.insertCustomData=function(t,e){var o;if(!t){return this}i.prototype.insertCustomData.apply(this,arguments);o=t.clone();this._oSmartField.addCustomData(o);return this};V.prototype.removeCustomData=function(t){var e=i.prototype.removeCustomData.apply(this,arguments);if(e){this._oSmartField.removeCustomData(e)}return e};V.prototype.removeAllCustomData=function(){var t=i.prototype.removeAllCustomData.apply(this,arguments);if(t.length>0){t.forEach(function(t){this._oSmartField.removeCustomData(t)}.bind(this))}return t};V.prototype.destroyCustomData=function(){i.prototype.destroyCustomData.apply(this,arguments);this._oSmartField.destroyCustomData();return this};V.prototype.setPropertyName=function(t){this.setProperty("propertyName",t,true);this._createSmartField();return this};V.prototype.setConfiguration=function(t){var e;this.setAggregation("configuration",t,true);if(this._oSmartField){e=t?t.clone():null;this._oSmartField.setConfiguration(e)}return this};V.prototype.getSelectedItem=function(){return this._oSelect.getSelectedItem()};V.prototype.setSelectedItem=function(t,e){this._handleSelectionChange(t,e);return this};V.prototype.setSelectedIndex=function(t){this.setSelectedItem(this._oSelect.getItems()[t]);return this};V.prototype.exit=function(){this._getKeep().destroy();this._getBlank().destroy();this._getValueHelp().destroy();this._getBoolTrueItem().destroy();this._getBoolFalseItem().destroy()};V.prototype.isBlankSelected=function(){return this._oSelect.getSelectedItem()===this._getBlank()};V.prototype.isKeepExistingSelected=function(){return this._oSelect.getSelectedItem()===this._getKeep()};V.prototype.isValueHelpSelected=function(){return this._oSelect.getSelectedItem()===this._getValueHelp()};V.prototype.getRawValue=function(){var t={},e,i,o,s=this.getSelectedItem(),a=this.getPropertyName();if(s===this._getBoolTrueItem()){e=true}else if(s===this._getBoolFalseItem()){e=false}else if(this.isBlankSelected()){e=null}else if(s===this._getValueHelp()){if(this.isComposite()){i=this.getValue();if(i==null||typeof i==="string"&&!i.trim()){e={value:null}}else{e={value:d.getFloatInstance().parse(i).toString()}}o=this.getUnitOfMeasure();if(o==null||typeof o==="string"&&!o.trim()){e.unit=null}else{e.unit=o}}else if(this.isInteger()&&this.getDataType()!=="Edm.Int64"){e=d.getIntegerInstance().parse(this.getValue())}else if(this.getDataType()==="Edm.Decimal"){e=C.prototype.parseValue(this.getValue(),"string")}else{e=this.getValue()}}else if(s){e=this._mContextItemsData[s.getKey()]}if(!this.isKeepExistingSelected()&&typeof e!=="undefined"){if(this.isComposite()){if(e!=null){t[a]=e.value;t[this.getUnitOfMeasurePropertyName()]=e.unit}else{t[a]=null;t[this.getUnitOfMeasurePropertyName()]=null}}else{t[a]=e;if(this.isComboBox()&&this.getRecordTextPath()){if(e!=null){t[this.getRecordTextPath()]=this._mRecordKeyTextMap[e]}else{t[this.getRecordTextPath()]=null}}}}return t};V.prototype.hasClientError=function(){return this._bClientError};V.prototype._setNullable=function(t){if(t!==this._bNullable){this._bNullable=t;this._updateSpecialSelectItems();this.getLabel().setRequired(true);this._oSelect.setRequired(!t)}return this};V.prototype._setShowValueHelp=function(t){if(t!==this._bShowValueHelp){this._bShowValueHelp=t;this._updateSpecialSelectItems()}return this};V.prototype._isSpecialValueItem=function(t){return t===this._getKeep()||t===this._getBlank()||t===this._getValueHelp()};V.prototype._handleSelectionChangeEvent=function(t){var e=t.getParameter("selectedItem");this._handleSelectionChange(e)};V.prototype._handleSelectionChange=function(t,e){this._oSelect.setSelectedItem(t);if(this.isKeepExistingSelected()||this.isBlankSelected()){this.getSmartField().removeStyleClass("sapUiCompSmartMultiEditSmartField");this.getSmartField().addStyleClass("sapUiCompSmartMultiEditSmartFieldHidden")}else{this.getSmartField().addStyleClass("sapUiCompSmartMultiEditSmartField");this.getSmartField().removeStyleClass("sapUiCompSmartMultiEditSmartFieldHidden")}if(e){return}var i=this.isValueHelpSelected();this._oSmartField.setContextEditable(i);this._oSmartField._updateInnerControlsIfRequired();this._oApplyToEmptyOnlyCheckBox.setVisible(i);this._bClientError=null;if(this._isSpecialValueItem(t)){this._setSmartFieldDisplayText(null,null)}else{this._oApplyToEmptyOnlyCheckBox.setVisible(true);if(!this.isBoolean()){this._oSmartField.setContextEditable(true);this._oSmartField._updateInnerControlsIfRequired()}var o=this._mContextItemsData[t.getKey()];if(this.isComposite()){if(this._isCurrencyValue()){this._setSmartFieldDisplayText(this._formatCurrencyValue(d.getFloatInstance().format(o.value),o.unit,true),o.unit)}else{this._setSmartFieldDisplayText(d.getFloatInstance().format(o.value),o.unit)}}else if(this.isBoolean()){this._setSmartFieldDisplayText(t.getText())}else if(this.isDate()){this._setSmartFieldDisplayText(m.getDateInstance().format(o))}else if(this.isDateTime()){this._setSmartFieldDisplayText(m.getDateTimeInstance().format(o))}else if(this.isInteger()){this._setSmartFieldDisplayText(d.getIntegerInstance().format(o))}else if(this.isFloat()){this._setSmartFieldDisplayText(d.getFloatInstance().format(o))}else{this._setSmartFieldDisplayText(o.toString())}if(!this.isBoolean()){this.setSelectedItem(this._getValueHelp(),true)}this._performValidation()}this.fireChange({selectedItem:t});this.invalidate()};V.prototype._extractValueDisplayText=function(t){var e;if(t==null||t==undefined){return null}if(this.isComposite()){if(this._isCurrencyValue()){e=this._formatCurrencyValue(d.getFloatInstance().format(t.value),t.unit)}else{e=d.getFloatInstance().format(t.value)+" "+t.unit}}else if(this.isBoolean()){e=t?this._getBoolTrueItem().getText():this._getBoolFalseItem().getText()}else if(this.isDate()){e=m.getDateInstance().format(t)}else if(this.isDateTime()){e=m.getDateTimeInstance().format(t)}else if(this.isInteger()){e=d.getIntegerInstance().format(t)}else if(this.isFloat()){e=d.getFloatInstance().format(t)}else{e=String(t)}return e};V.prototype._createSelect=function(){this._oSelect=new s(this.getId()+"-select");this._oSelect.setWidth("100%");this._oSelect.attachChange(this._handleSelectionChangeEvent,this);this.addDependent(this._oSelect)};V.prototype._getResourceBundle=function(){if(this._oRb==null){this._oRb=I.getResourceBundleFor("sap.ui.comp")}return this._oRb};V.prototype._createSpecialSelectItems=function(){var t=new o({key:V.ACTION_ITEM_KEY.KEEP,text:"< "+this._getResourceBundle().getText("MULTI_EDIT_KEEP_TEXT")+" >"});this._getKeep=function(){return t};var e=new o({key:V.ACTION_ITEM_KEY.BLANK,text:"< "+this._getResourceBundle().getText("MULTI_EDIT_BLANK_TEXT")+" >"});this._getBlank=function(){return e};var i=new o({key:V.ACTION_ITEM_KEY.NEW,text:"< "+this._getResourceBundle().getText("MULTI_EDIT_NEW_TEXT")+" >"});this._getValueHelp=function(){return i};var s=new o({key:V.ACTION_ITEM_KEY.TRUE,text:this._getResourceBundle().getText("SMARTFIELD_CB_YES")});this._getBoolTrueItem=function(){return s};var a=new o({key:V.ACTION_ITEM_KEY.FALSE,text:this._getResourceBundle().getText("SMARTFIELD_CB_NO")});this._getBoolFalseItem=function(){return a}};V.prototype._createDescription=function(){if(!this._oDescription){this._oDescription=new _;this.addDependent(this._oDescription)}};V.prototype._createApplyToEmptyOnlyCheckBox=function(){this._oApplyToEmptyOnlyCheckBox=new c(this.getId()+"-ApplyToEmptyOnly");this._oApplyToEmptyOnlyCheckBox.setText(this._getResourceBundle().getText("MULTI_EDIT_APPLY_TO_EMPTY_ONLY"));this._oApplyToEmptyOnlyCheckBox.attachSelect(function(t){this.setApplyToEmptyOnly(t.getSource().getSelected())}.bind(this));this.addDependent(this._oApplyToEmptyOnlyCheckBox)};V.prototype._createSmartField=function(){this._bIsSmartFieldInitialized=false;this._oSmartField=new a({id:this.getId()+"-SmartField",value:{path:this.getPropertyName(),mode:"OneWay"}});this._oSmartField.addStyleClass("sapUiCompSmartMultiEditSmartFieldHidden");this._oSmartField._createFactory=function(){var t=a.prototype._createFactory.apply(this,arguments);return T.createFromFactory(t)};this.addDependent(this._oSmartField);this._oSmartField.setValue=this._handleSmartFieldSetValue;this._pInitialised=new Promise(function(t,e){this._oSmartField.attachInitialise({resolve:t,reject:e},this._handleSmartFieldInitialized,this)}.bind(this));this._oSmartField.attachInnerControlsCreated(this._handleInnerControlsCreation.bind(this),this);if(this.getConfiguration()){this._oSmartField.setConfiguration(this.getConfiguration().clone())}this._oSmartFieldValue=null};V.prototype._getCurrentValueControl=function(){return this._oSmartField?this._oSmartField._oControl[this._oSmartField._oControl.current]:null};V.prototype._setSmartFieldDisplayText=function(t,e){var i,o;this._oSmartFieldValue=t;this._oSmartField.setValue(t);var s=this._getCurrentValueControl();if(s){if(this.isComboBox()){s.setSelectedKey(t)}else if(this.isComposite()&&s.getItems){i=s.getItems()[0];if(i.setValue){i.setValue(t)}else if(i.setText){i.setText(t)}else if(i.setSelectedKey){i.setSelectedKey(t)}i=s.getItems()[1];if(i._oControl.current==="display"){o=i._oControl.display;if(o.setText){o.setText(e)}}else if(i._oControl.current==="edit"){o=i._oControl.edit;if(o.setEnteredValue){o.setEnteredValue(e)}else if(o.setValue){o.setValue(e)}}}else if(s.setText){s.setText(t)}else if(s.setValue){s.setValue(t)}}};V.prototype._getSmartFieldDisplayText=function(){var t=this._oSmartField._oControl.display,e="";if(t){if(this.isComposite()&&t.getItems){if(t.getItems()[0].getText){e+=t.getItems()[0].getText()}var i=t.getItems()[1]._oControl.display;if(i&&i.getText){e+=t.getItems()[1]._oControl.display.getText()}return e}else if(t.isA("sap.m.ComboBox")){return this._mRecordKeyTextMap[t.getSelectedKey()]||""}else if(t.getText){return t.getText()}else{return null}}else{return null}};V.prototype._handleSmartFieldSetValue=function(t){if(t===this.getParent()._oSmartFieldValue){a.prototype.setValue.call(this.getParent()._oSmartField,t)}};V.prototype._setSFUserInteraction=function(){if(this._oSmartField._oControl.edit&&this._oSmartField._oControl.edit._setPreferUserInteraction){this._oSmartField._oControl.edit._setPreferUserInteraction(false)}};V.prototype._handleSmartFieldInitialized=function(t,e){if(this.isTime()){g.error("Field._handleSmartFieldInitialized","Edm.Time data type is not supported, field: '"+this.getPropertyName()+"'","sap.ui.comp.smartmultiedit.Field");return}this._oAnnotations=this._oSmartField._oFactory._oMetaData.annotations;this._bIsSmartFieldInitialized=true;this._oSmartField.setContextEditable(false);this._oSmartField._updateInnerControlsIfRequired();this._updateContextItems();this._setSFUserInteraction();this._oApplyToEmptyOnlyCheckBox.setVisible(false);e.resolve()};V.prototype._handleInnerControlsCreation=function(t){var e;t.mParameters.forEach(function(t){if(t.getParent()&&t.getParent()._oControl){if(t.getParent()._oControl.display===t){if(t.mBindingInfos.text){t.mBindingInfos.text.skipModelUpdate=true}}else if(t.getParent()._oControl.edit===t){if(t.mBindingInfos.value){t.mBindingInfos.value.skipModelUpdate=true;t.setValue(null)}else if(t.mBindingInfos.selected){t.mBindingInfos.selected.skipModelUpdate=true;t.setSelected(false)}}}if(t===this._oSmartField._oControl.display){return}if(t.attachChange){t.attachChange(this._performValidation,this)}if(t.getParent()&&t.getParent().getParent()instanceof a&&t.getParent().getParent()._oControl.edit instanceof h&&this._oAnnotations&&this.isComposite()){var e=t.getParent().getParent()._oControl.edit;var i=e.getItems();i[0].attachChange(this._handleCompositeInputChange,this);if(i[1]&&i[1]._oControl&&i[1]._oControl.edit){i[1]._oControl.edit.attachChange(this._handleCompositeInputChange,this)}}else if(t.getParent()instanceof a&&!(t.getParent().getParent()instanceof h)&&t.getParent()._oControl.edit instanceof f){t.getParent()._oControl.edit.attachChange(this._handleInputChange,this)}}.bind(this));e=this._oSmartField.getMandatory();this._setNullable(!e)};V.prototype._getInnerEdit=function(){return this._oSmartField._oControl.edit};V.prototype._getFirstInnerEdit=function(){return this._oSmartField._oControl.edit?this._oSmartField._oControl.edit.getItems()[0]:null};V.prototype._getSecondInnerEdit=function(){return this._oSmartField._oControl.edit?this._oSmartField._oControl.edit.getItems()[1]._oControl.edit:null};V.prototype._getSecondInnerDisplay=function(){return this._oSmartField._oControl.edit?this._oSmartField._oControl.edit.getItems()[1]._oControl.display:null};V.prototype._performTokenValidation=function(t,e,i){return new Promise(function(o,s){var a=new y(i.getModel());a.getValueListAnnotationLazy(e).then(function(e){var a=e.primaryValueListAnnotation;if(!a){o();return}i.getModel().read("/"+a.valueListEntitySetName,{success:function(e){if(e.results&&e.results.length===0&&t._oControl.edit){var s=i.getNullable()&&i.getValue()==="";t._oControl.edit.setValueState(s?F.None:F.Error);i._bClientError=!s}else if(!i._bClientError){t._oControl.edit.setValueState(F.None);i._bClientError=null}o()},filters:[new u({path:a.keyField,operator:p.EQ,value1:t.getValue()})],error:function(t){s(t)}})})})};V.prototype._fnGetInnerValuesHelper=function(){var t=[this._getFirstInnerEdit().getValue()];var e=this._getSecondInnerEdit();if(e instanceof S){t.push(e.getSelectedKey())}else{if(e){t.push(e.getValue())}else{var i=this._getSecondInnerDisplay();if(i){t.push(i.getText())}}}return t};V.prototype._performValidation=function(){var t=this._oSmartField._oError;t.bComplex=false;t.bFirst=false;t.bSecond=false;var e=this._oSmartField.getInnerControls();if(this.isComposite()&&e.length===2&&e[0].getBinding("value")){var i=e[0].getBinding("value");var o=i.getValue;i.getValue=this._fnGetInnerValuesHelper.bind(this);this._oSmartField.checkValuesValidity({handleSuccess:true}).then(function(){this._bClientError=false}.bind(this)).catch(function(){this._bClientError=true}.bind(this));i.getValue=o}else{this._oSmartField.checkValuesValidity({handleSuccess:true}).then(function(){this._bClientError=false}.bind(this)).catch(function(){this._bClientError=true}.bind(this))}if(this.isKeepExistingSelected()||this.isBlankSelected()){return}if(this.getValidateTokenExistence()){var s=[];if("valuelist"in this._oAnnotations){s.push(this._performTokenValidation(this.getSmartField(),this._oAnnotations.valuelist,this))}if(this.isComposite()&&"valuelistuom"in this._oAnnotations&&this.getSmartField()._oControl.edit){s.push(this._performTokenValidation(this.getSmartField()._oControl.edit.getItems()[1],this._oAnnotations.valuelistuom,this))}return Promise.all(s)}else{return Promise.resolve()}};V.prototype._handleCompositeInputChange=function(t){var e=this._fnGetInnerValuesHelper(),i=e[0],o=e[1]||"",s;if(this._isCurrencyValue()){s=this._formatCurrencyValue(i,o,true)}else{var a=d.getFloatInstance({parseAsString:true}).parse(i);s=d.getFloatInstance().format(a)}if(!this._oSmartField._oError.bFirst&&!this._oSmartField._oError.bSecond){this._setSmartFieldDisplayText(s,o)}};V.prototype._handleInputChange=function(){var t=this._getInnerEdit().getValue();if(!this.isString()){var e=d.getFloatInstance({parseAsString:true}).parse(t);t=d.getFloatInstance().format(e)}if(!this._oSmartField._oError.bFirst){this._setSmartFieldDisplayText(t,this._getInnerEdit().getValue())}};V.prototype._formatCurrencyValue=function(t,e,i){var o=d.getFloatInstance().parse(t),s=d.getCurrencyInstance().format(o,e);if(i){s=s.replace(e,"").trim()}return s};V.prototype._updateSpecialSelectItems=function(){this._oSelect.removeAggregation("items",this._getKeep(),true);this._oSelect.removeAggregation("items",this._getBlank(),true);this._oSelect.removeAggregation("items",this._getValueHelp(),true);this._oSelect.insertAggregation("items",this._getKeep(),0,true);if(this.getShowValueHelp()){this._oSelect.insertAggregation("items",this._getValueHelp(),1,true)}if(this.getNullable()){this._oSelect.insertAggregation("items",this._getBlank(),this.getShowValueHelp()?2:1,true)}this.invalidate()};V.prototype._removeContextItems=function(){this._oSelect.removeAllItems();this._updateSpecialSelectItems()};V.prototype._updateContextItems=function(){var t,e,i,o;if(!this._oContainer||!this.getDataType()||!this._bIsSmartFieldInitialized){return}this._removeContextItems();if(this.isBoolean()){this._oSelect.addAggregation("items",this._getBoolTrueItem(),true);this._oSelect.addAggregation("items",this._getBoolFalseItem(),true);this._setShowValueHelp(false)}this._aDistinctValues=[];this._mContextItemsData={};this._mValueOccurences={};this._oContainer.getContexts().forEach(function(o){t=this.getModel().getObject(o.getPath())[this.getPropertyName()];if(typeof t==="undefined"||t==null||typeof t==="string"&&!t.trim()){return}if(this.isComposite()){e=this.getModel().getObject(o.getPath())[this.getUnitOfMeasurePropertyName()]||"";i={value:t,unit:e};if(this._aDistinctValues.map(JSON.stringify).indexOf(JSON.stringify(i))===-1){this._aDistinctValues.push(i);this._mValueOccurences[i.unit+i.value]={count:1,value:i,context:o}}else{this._mValueOccurences[i.unit+i.value].count++}}else if(this.isDate()||this.isDateTime()){if(this._aDistinctValues.map(Number).indexOf(+t)===-1){this._aDistinctValues.push(t);this._mValueOccurences[t]={count:1,value:t,context:o}}else{this._mValueOccurences[t].count++}}else if(this._aDistinctValues.indexOf(t)===-1){this._aDistinctValues.push(t);this._mValueOccurences[t]={count:1,value:t,context:o}}else{this._mValueOccurences[t].count++}}.bind(this));o=Object.keys(this._mValueOccurences).map(function(t){return[t,this._mValueOccurences[t]]}.bind(this));o.sort(function(t,e){if(e[1].count!==t[1].count){return e[1].count-t[1].count}else if(this.isComposite()){return e[1].value.value-t[1].value.value}else if(this.isInteger()||this.isFloat()){return e[1].value-t[1].value}else if(this.isDate()||this.isDateTime()){return e[1].value.getTime()-t[1].value.getTime()}else if(t[1].value.localeCompare&&e[1].value.localeCompare){return t[1].value.localeCompare(e[1].value)}else{return 0}}.bind(this));o=o.slice(0,E);this._aDistinctValues=[];o.forEach(function(t){this._addInnerSelectItem(t[1].value,t[1].context);this._aDistinctValues.push(t[1].value)}.bind(this));this._setSmartFieldDisplayText(null,null)};V.prototype._addInnerSelectItem=function(t,e){var i,s;if(typeof t==="undefined"||t==null||this.isBoolean()){return}if(this.isComposite()){i=JSON.stringify([t.value,t.unit])}else if(this.isDate()){i=m.getDateInstance().format(t)}else if(this.isDateTime()){i=m.getDateTimeInstance().format(t)}else{i=String(t)}if(this.isComboBox()){var a=this.getRecordTextPath();s=a?e.getObject(a):i;this._mRecordKeyTextMap[i]=s}else{s=this._extractValueDisplayText(t)}this._oSelect.addItem(new o({key:i,text:s}),true);this._mContextItemsData[i]=t};V.prototype._setContainer=function(t){this._oContainer=t;this._oSmartField.setEntitySet(t.getEntitySet());this._oSmartField._forceInitialise();this._updateContextItems()};V.prototype._isCurrencyValue=function(){return this._oAnnotations&&this._oAnnotations.uom&&this._oAnnotations.uom.property.property["sap:semantics"]=="currency-code"};V.prototype.resetField=function(){this._oSelect.setSelectedItem(this._getKeep());this.getSmartField().setValue("");this.getSmartField().setValueStateText("");this.getSmartField().setValueState(F.None);this.getSmartField().removeStyleClass("sapUiCompSmartMultiEditSmartField");this.getSmartField().addStyleClass("sapUiCompSmartMultiEditSmartFieldHidden")};return V});
/*!
 * SAPUI5
 * (c) Copyright 2009-2023 SAP SE. All rights reserved.
 */
sap.ui.predefine("sap/ui/comp/smartmultiedit/flexibility/changes/AddMultiEditFields", ["sap/ui/core/util/reflection/JsControlTreeModifier","sap/ui/comp/smartmultiedit/Container","sap/ui/comp/smartform/flexibility/changes/AddFields"],function(e,t,n){"use strict";var r={};r.applyChange=function(e,t,r){var i=e.getContent();var o=r.modifier;var a=r.appComponent;var d=i.field.selector;var l=r.view;var f=i.field.id;var p=i.field.index;var s=i.field.propertyName;var u=e.getDependentControl("form",r);var c=u&&o.getFlexDelegate(u);if(!c){if(this._checkChangeContent(i)){var g=i.field.jsType;var v=i.field.entitySet;var m;var h;return Promise.resolve().then(o.createControl.bind(o,"sap.ui.comp.smartform.GroupElement",r.appComponent,r.view,d||f)).then(function(e){m=e;return this._createGroupElementField(o,r.view,m,g,s,v,r.appComponent)}.bind(this)).then(function(e){h=e;return o.insertAggregation(t,"groupElements",m,p,r.view)}).then(function(){var n=this._getContainerFromGroup(t);if(n){n.indexField(h)}e.setRevertData({newFieldSelector:o.getSelector(m,r.appComponent)})}.bind(this))}}return n._addFieldFromDelegate(u,t,d,f,p,s,e,o,l,a)};r.revertChange=function(e,t,n){var r=e.getRevertData(),i=r.newFieldSelector,o=n.modifier;if(i){var a=o.bySelector(i,n.appComponent,n.view);return Promise.resolve().then(o.removeAggregation.bind(o,t,"groupElements",a)).then(function(){o.destroy(a);var i=this._getContainerFromGroup(t);if(i){i._refreshFields()}var d=r.valueHelpSelector;if(d){var l=n.appComponent;var f=n.view;var p=o.bySelector(d,l,f);var s=e.getDependentControl("form",n);return Promise.resolve().then(o.removeAggregation.bind(o,s,"dependents",p)).then(o.destroy.bind(o,p))}}.bind(this)).then(function(){e.resetRevertData()})}else{return Promise.resolve()}};r.completeChangeContent=function(t,n,r){var i=r.appComponent;var o={field:{}};if(n.bindingPath){o.field.propertyName=n.bindingPath}else{throw new Error("oSpecificChangeInfo.bindingPath or bindingPath attribute required")}if(n.newControlId){o.field.selector=e.getSelector(n.newControlId,i)}else{throw new Error("oSpecificChangeInfo.newControlId attribute required")}if(n.jsTypes){o.field.jsType=n.jsType}else if(n.bindingPath){o.field.jsType="sap.ui.comp.smartmultiedit.Field"}else{throw new Error("oSpecificChangeInfo.jsTypes or bindingPath attribute required")}if(n.index===undefined){throw new Error("oSpecificChangeInfo.index attribute required")}else{o.field.index=n.index}if(n.entitySet){o.field.entitySet=n.entitySet}if(n.relevantContainerId){t.addDependentControl(n.relevantContainerId,"form",r)}t.setContent(o)};r._checkChangeContent=function(e){var t=e,n=false;if(t){n=e.field&&(e.field.selector||e.field.id)&&e.field.jsType&&e.field.propertyName}return t&&n};r._createGroupElementField=function(e,t,n,r,i,o,a){return Promise.resolve().then(e.createControl.bind(e,r,a,t)).then(function(r){e.setProperty(r,"propertyName",i);if(o){e.setProperty(r,"entitySet",o)}return Promise.resolve().then(e.insertAggregation.bind(e,n,"elements",r,0,t,true)).then(function(){return r})})};r._getContainerFromGroup=function(e){if(e&&typeof e.getParent==="function"&&typeof e.getParent().getParent==="function"&&typeof e.getParent().getParent().getParent==="function"){var n=e.getParent().getParent().getParent();if(n instanceof t){return n}}};return r},true);
/*!
 * SAPUI5
 * (c) Copyright 2009-2023 SAP SE. All rights reserved.
 */
sap.ui.predefine("sap/ui/comp/smartmultiinput/SmartMultiInput", ["sap/ui/core/Core","sap/m/library","sap/m/List","sap/m/Popover","sap/m/StandardListItem","sap/m/MultiInput","sap/m/MultiComboBox","sap/m/Select","sap/m/Token","sap/m/Tokenizer","sap/ui/comp/smartfield/SmartField","sap/ui/comp/odata/MetadataAnalyser","sap/ui/model/ParseException","sap/ui/model/ValidateException","sap/ui/model/BindingMode","sap/ui/comp/odata/ODataType","sap/ui/comp/providers/ValueHelpProvider","sap/ui/comp/util/FormatUtil","sap/ui/core/format/DateFormat","sap/ui/comp/smartfilterbar/FilterProvider","sap/base/Log","sap/base/util/deepEqual","sap/ui/comp/library","sap/ui/core/library","sap/ui/core/ResizeHandler","sap/m/Link","sap/m/Text","sap/m/FlexBox","sap/m/HBox","sap/base/util/isEmptyObject","sap/base/security/sanitizeHTML","sap/ui/thirdparty/jquery","sap/ui/core/date/UI5Date","sap/ui/core/Lib"],function(t,e,i,o,a,n,r,s,h,l,u,p,d,g,_,f,c,y,m,v,T,x,M,b,k,I,B,C,D,S,E,P,F,R){"use strict";var H=M.valuehelpdialog.ValueHelpRangeOperation;var V=M.smartfilterbar.DisplayBehaviour;var L=M.smartfield.TextInEditModeSource;var N=b.ValueState;var w=e.PlacementType;var O="-mInput";var A="-mInputTokenizer";var z="-mInputHBox";var W="-mMoreLink";var K=R.getResourceBundleFor("sap.ui.comp");var U=u.extend("sap.ui.comp.smartmultiinput.SmartMultiInput",{metadata:{library:"sap.ui.comp",properties:{supportRanges:{type:"boolean",defaultValue:false},supportMultiSelect:{type:"boolean",defaultValue:true},enableODataSelect:{type:"boolean",defaultValue:false},requestAtLeastFields:{type:"string",defaultValue:""},textSeparator:{type:"string",defaultValue:null},singleTokenMode:{type:"boolean",defaultValue:false}},aggregations:{_initialTokens:{type:"sap.m.Token",multiple:true,visibility:"hidden"}},events:{beforeCreate:{allowPreventDefault:true,parameters:{oData:{type:"object"},mParameters:{type:"object"}}},beforeRemove:{allowPreventDefault:true,parameters:{mParameters:{type:"object"}}},tokenUpdate:{parameters:{type:{type:"string"},addedTokens:{type:"sap.m.Token[]"},removedTokens:{type:"sap.m.Token[]"}}},selectionChange:{parameters:{changedItem:{type:"sap.ui.core.Item"},selected:{type:"boolean"}}},selectionFinish:{parameters:{selectedItems:{type:"sap.ui.core.Item[]"}}}}},renderer:function(t,e){u.getMetadata().getRenderer().render(t,e);if(e._oEmptyDash){var i=e.getTokens().length>0?false:true;e._oEmptyDash.setVisible(i);if(i&&e._oMoreLink){e._oMoreLink.setVisible(false)}}}});U.prototype.getTokens=function(){if(this._isReadMode()&&this._oTokenizer){return this._oTokenizer.getTokens()}else if(this._oMultiComboBox&&this._oMultiComboBox.getAggregation("tokenizer")){return this._oMultiComboBox.getAggregation("tokenizer").getTokens()}else if(this._oMultiInput){return this._oMultiInput.getTokens()}return[]};U.prototype.getValue=function(){return this.getTokens()};U.prototype._createMultiInput=function(){var t=this._createAttributes(),e;if(this._oMultiComboBox){this._oMultiComboBox.destroy();this._oMultiComboBox=null}if(this.getSingleTokenMode()&&!this.getBindingContext()){t["maxTokens"]=1}this._oMultiInput=new n(this.getId()+O,t);this._oMultiInput.attachChange(function(t){this._validateValueOnChange(t.getParameter("value"))},this);if(this.getBindingContext()){this._bindMultiInput()}else{e=this.getAggregation("_initialTokens")||[];e.forEach(function(t){this._oMultiInput.addToken(t)}.bind(this))}this._oMultiInput.attachTokenUpdate(function(t){this._validateValueOnChange(this._oMultiInput.getValue());var e=t.getParameters();delete e.id;if(this.getBinding("value").getBindingMode()!=="TwoWay"||!this.getBindingContext()){if(t.getParameter("removedTokens")){t.getParameter("removedTokens").forEach(function(t){t.destroy()})}}this.fireTokenUpdate(e)},this);var i={control:this._oMultiInput,onCreate:"_onMultiInputCreate",params:{type:{type:this._getType(),property:this._oFactory._oMetaData.property}}};this._initMultiInputValueHelp(i);return i};U.prototype._createMultiComboBox=function(){var t=this._createAttributes();if(this.getSingleTokenMode()&&!this.getBindingContext()){t["width"]="100%";delete t["placeholder"]}this._oMultiComboBox=this.getSingleTokenMode()&&!this.getBindingContext()?new s(this.getId()+"mComboBox",t):new r(this.getId()+"mComboBox",t);if(this.getBindingContext()){this._bindMultiComboBox()}else{this._oMultiInput=this._oMultiComboBox._oTokenizer}if(!this.getSingleTokenMode()){this._oMultiComboBox.attachSelectionChange(function(t){var e=t.getParameters();delete e.id;this.fireSelectionChange(e)},this);this._oMultiComboBox.attachSelectionFinish(function(t){var e=t.getParameters();delete e.id;this.oLocalContext=[];this.fireSelectionFinish(e)},this)}else if(this.getSingleTokenMode()&&!this.getBindingContext()){this._oMultiComboBox.attachChange(function(t){var e=t.getParameters();delete e.id;this.fireSelectionChange(e)},this)}var e={control:this._oMultiComboBox,onCreate:"_onCreate",params:{type:{type:this._getType(),property:this._oFactory._oMetaData.property},valuehelp:{annotation:this._getValueListAnnotation(),aggregation:"items",noDialog:true,noTypeAhead:true}}};return e};U.prototype._createAttributes=function(){var t={width:true,textAlign:true,placeholder:true,tooltip:true,name:true,valueState:true,valueStateText:true};var e=this._oFactory.createAttributes(null,this._oFactory._oMetaData.property,t,{event:"change",parameter:"value"});return e};function G(t){var e=t.getParameter("tokens"),i,o,a=0,r=[],s=null,h;this._onCancel();if(this.oControl instanceof n){this.oControl.setValue("");var l=this.oControl.getTokens();var u=[];var p=[];var d=[];l.forEach(function(t){var i=e.some(function(e){return t.getKey()===e.getKey()});if(!i){p.push(t)}else{var o=e.filter(function(e){return t.getKey()===e.getKey()})[0];if(!this.oControl.getBindingContext()&&this.bSupportRanges&&o.getKey().startsWith("range_")){d.push(o)}else{t.setText(o.getText());d.push(t)}}}.bind(this));e.forEach(function(t){var e=l.some(function(e){return e.getKey()===t.getKey()});if(!e){u.push(t);d.push(t)}});this.oControl.setTokens(d);var g=this.oControl.getParent();if(g&&g.getBindingContext()&&g.getBinding("value").getBindingMode()==="TwoWay"){var _=g._getModel(),f=g._getEntitySetName(),c=_._resolveGroup(f),y=_.getDeferredGroups().indexOf(c.groupId)>=0;if(!y&&(p.length||u.length)&&d.length){g.setBusyIndicatorDelay(g.getBusyIndicatorDelay());g.setBusy(true)}}this.oControl.fireTokenUpdate({type:"tokensChanged",removedTokens:p,addedTokens:u});a=e.length;while(a--){s=e[a].data("row");if(s){r.push(s)}}}else{if(e[0]){if(this.bIsSingleIntervalRange){i=e[0].data("range");if(i){if(this._sType==="datetime"){h=m.getDateTimeInstance(Object.assign({},this._oDateFormatSettings,{UTC:false}));if(typeof i.value1==="string"){i.value1=F.getInstance(i.value1)}if(i.operation==="BT"){if(typeof i.value2==="string"){i.value2=F.getInstance(i.value2)}o=h.format(i.value1)+"-"+h.format(i.value2)}else{o=h.format(i.value1)}}else{if(i.operation==="BT"){o=i.value1+"-"+i.value2}else{o=i.value1}}}}else{o=e[0].getKey()}s=e[0].data("row");if(s){r.push(s)}}this.oControl.setValue(o);this.oControl.fireChange({value:o,validated:true})}this._calculateAndSetFilterOutputData(r)}function q(t){var e,i,o,a={};if(t&&this.mOutParams){for(e in this.mOutParams){if(e){i=this.mOutParams[e];if(i!==this.sKey){o=t[i];a[e]=o}}}if(a&&!S(a)){this.fireEvent("valueListChanged",{changes:a})}}}function j(t,e){var i=document.createElement("span");i.style.whiteSpace="nowrap";i.style.maxWidth="fit-content";i.innerHTML=t;i.className="sapMText";e.appendChild(i);var o=e.childNodes;var a=o[o.length-1].offsetWidth;e.removeChild(e.childNodes[o.length-1]);return a}U.prototype._initMultiInputValueHelp=function(t){var e=this._getFilterType(this._oFactory._oMetaData.property.property),i={},o=this._getDateFormatSettings(),a;this._oFactory._getValueHelpDialogTitle(i);if(this._getValueListAnnotation()){t.params.valuehelp={annotation:this._getValueListAnnotation(),aggregation:"suggestionRows",noDialog:false,noTypeAhead:false,supportMultiSelect:this.getSingleTokenMode()?false:this.getSupportMultiSelect(),supportRanges:this.getBindingContext()?false:this.getSupportRanges(),type:e,displayBehaviour:this._getDisplayBehaviour()}}else if(this.getSupportRanges()&&!this.getBindingContext()){a=new c({fieldName:this._getPropertyName(),preventInitialDataFetchInValueHelpDialog:true,model:this.getModel(),control:this._oMultiInput,title:i.dialogtitle,supportMultiSelect:this.getSingleTokenMode()?false:this.getSupportMultiSelect(),supportRanges:true,type:e,dateFormatSettings:o,isUnrestrictedFilter:this._isTimeType(e),displayBehaviour:this._getDisplayBehaviour()});a._onOK=G;a._calculateAndSetODataModelOutputData=q;this._oMultiInput.addValidator(this._validateToken.bind(this))}else{this._oMultiInput.setShowValueHelp(false);this._oMultiInput.addValidator(this._validateToken.bind(this))}};U.prototype._bindMultiInput=function(){var t=this.getBinding("value").getBindingMode();switch(t){case _.OneTime:this._bindMultiInputOneTime();break;case _.OneWay:this._bindMultiInputOneWay();break;case _.TwoWay:default:this._bindMultiInputTwoWay()}};U.prototype._bindMultiInputOneTime=function(){var t=this;this._readNavigationPropertySet().then(function(e){e.results.forEach(function(e){var i=e[t._getPropertyName()];var o=t._getDescriptionFieldName();var a=o?e[o]:"";t._oMultiInput.addToken(t._createToken(i,a))})})};U.prototype._bindMultiInputOneWay=function(){this._bindMultiInputTokens(this._oMultiInput)};U.prototype._bindMultiInputTwoWay=function(){this._bindMultiInputTokens(this._oMultiInput);this._oMultiInput.attachTokenUpdate(function(t){t.getParameter("addedTokens").forEach(this._addToken.bind(this));t.getParameter("removedTokens").forEach(this._removeToken.bind(this))},this)};U.prototype._bindMultiInputTokens=function(t){var e=this._getNavigationPath(),i=this._getSelectExpandParameter();if(!S(i)){t.bindAggregation("tokens",{path:e,parameters:i,factory:this._tokensFactory.bind(this),events:{aggregatedDataStateChange:this._processDataState.bind(this)}})}else{t.bindAggregation("tokens",{path:e,factory:this._tokensFactory.bind(this),events:{aggregatedDataStateChange:this._processDataState.bind(this)}})}};U.prototype._processDataState=function(e){var i=e.getParameter("dataState"),o=this.getBinding("value");if(!i||!i.getChanges().messages){return}if(o&&o.bIsBeingDestroyed){return}var a=i.getMessages();if(a.length){var n=false;var r=a[0];a.forEach(function(t){if(t.getControlIds().indexOf(this.getId())==-1){t.addControlId(this.getId());n=true}}.bind(this));this.setValueState(r.getType());this.setValueStateText(r.getMessage());if(n){t.getMessageManager().getMessageModel().checkUpdate(false,true)}}else{this.setValueState(N.None);this.setValueStateText("")}};U.prototype._getSelectExpandParameter=function(){var t={};if(this.getEnableODataSelect()){t.select=this._addODataSelectParameters()}if(this._oFactory._oMetaData.annotations.text&&this._oFactory._oMetaData.annotations.text.navigationPathHelp){t.expand=this._oFactory._oMetaData.annotations.text.navigationPathHelp}return t};U.prototype._addODataSelectParameters=function(t){var e=this._getPropertyName();if(this._getDescriptionFieldName()){e=e+","+this._getDescriptionFieldName()}if(this.getRequestAtLeastFields()){e=e+","+this.getRequestAtLeastFields()}return e};U.prototype._calculateFieldGroupMetaData=function(){var t,e,i,o;if(this._oFactory._oMeta){e=this._oFactory._oMeta.entitySet;i=this.getModel().getMetaModel().getODataEntitySet(e);o=this.getModel().getMetaModel().getODataEntityType(i.entityType);t={entitySet:i,entityType:o,path:this._getNavigationPath()}}return t};U.prototype._bindMultiComboBox=function(){var t=this.getBinding("value").getBindingMode();switch(t){case _.OneTime:this._bindMultiComboBoxOneTime();break;case _.OneWay:this._bindMultiComboBoxOneWay();break;case _.TwoWay:default:this._bindMultiComboBoxTwoWay()}};U.prototype._bindMultiComboBoxOneTime=function(){var t=this;this._readNavigationPropertySet().then(function(e){var i=e.results.map(function(e){return e[t._getPropertyName()]});t._oMultiComboBox.setSelectedKeys(i)})};U.prototype._bindMultiComboBoxOneWay=function(){this._createAndAttachHelperMultiInput()};U.prototype._bindMultiComboBoxTwoWay=function(){this._createAndAttachHelperMultiInput();this.oLocalContext=[];this._oMultiComboBox.attachSelectionChange(function(t){var e=t.getParameter("selected"),i=t.getParameter("changedItem"),o={},a,n,r;this.setValueState(N.None);this.setValueStateText("");if(e){o[this._getPropertyName()]=i.getKey();r=i.getBindingContext("list")||i.getBindingContext();a=r.getProperty();this._getEntityType().key.propertyRef.forEach(function(t){if(a&&a[t.name]){o[t.name]=a[t.name]}})}else{n=this._oMultiInput.getTokens().filter(function(t){return t.getKey()===i.getKey()})[0]}if(e){this.oLocalContext.push(this._createEntity(o))}else{if(n){this._removeEntity(n.getBindingContext())}else{this.oLocalContext.forEach(function(t,e){if(t.getProperty(this._getPropertyName())===i.getKey()){this._getModel().resetChanges([t.getPath()],undefined,true);this.oLocalContext.splice(e,1)}}.bind(this))}}},this)};U.prototype._readNavigationPropertySet=function(){var t=this;return new Promise(function(e,i){var o=t.getBindingContext(),a=t._getModel(),n=t._getNavigationPath();a.read(n,{context:o,success:function(t){e(t)},error:function(e){t.setValueState(N.Error);t.setValueStateText(e.responseText);i(e)}})})};U.prototype._createAndAttachHelperMultiInput=function(){this._oMultiInput=new n({maxTokens:this.getSingleTokenMode()?1:undefined});this._oMultiInput.setBindingContext(this.getBindingContext());this._oMultiInput.setModel(this._getModel());this._bindMultiInputTokens(this._oMultiInput);var t=this._oMultiInput.getBinding("tokens");this._updateSelectedKeys.call(this);t.attachChange(this._updateSelectedKeys,this)};U.prototype._updateSelectedKeys=function(){var t=this._oMultiInput.getTokens().map(function(t){return t.getKey()});if(this._oMultiComboBox){var e=this.getBinding("value").getBindingMode();if(e==_.TwoWay){if(this._oFactory){var i=this._oFactory.getValueListProvider();if(i&&i.bInitialised){i._calculateFilterInputData();if(i._mLastFilterInputData&&!x(i._mLastFilterInputData,i.mFilterInputData)){i._filterDropdownRowsByInParameters()}}}}this._oMultiComboBox.setSelectedKeys(t)}};U.prototype._getReadTokenList=function(){if(!this.oReadTokenList){this.oReadTokenList=new i;this.addDependent(this.oReadTokenList)}return this.oReadTokenList};U.prototype._getReadTokenListPopover=function(){if(!this.oReadTokenListPopover){this.oReadTokenListPopover=new o({showArrow:true,placement:w.Auto,showHeader:false,contentMinWidth:"auto",content:[this.oReadTokenList]});this.addDependent(this.oReadTokenListPopover)}return this.oReadTokenListPopover};U.prototype._handleNMoreIndicatorPress=function(){var t=this.getTokens();if(!t){return}var e=this._getReadTokenList();var i=this._getReadTokenListPopover();e.removeAllItems();for(var o=0,n=t.length;o<n;o++){var r=t[o],s=new a({title:r.getText()});e.addItem(s)}if(this._oMoreLink.getDomRef()){i.openBy(this._oMoreLink.getDomRef())}};U.prototype._onResize=function(){if(this._isReadMode()&&this._oTokenizer){this._deregisterResizeHandler();this._oTokenizer.setMaxWidth(this.$().width()+"px");this._oTokenizer.setRenderMode("Narrow");this._oTokenizer.scrollToEnd();if(this.getMode()==="display"&&this.getTokens().length>0){this._onDisplayResize()}this._registerResizeHandler()}};U.prototype._onDisplayResize=function(){if(this.getDomRef()&&this.getDomRef().offsetWidth>0){var t=this.getDomRef().clientWidth,e=this._iHiddenLabelsCount?j("999 "+K.getText("POPOVER_DEFINE_MORE_LINKS"),this.getDomRef()):0,i=!this._iHBoxWidth||this._iHBoxWidth+e>t,o=this._iHiddenLabelsCount>0&&this._iHBoxWidth+e+this._iFirstHiddenTokenLength<t;if(i||o){this._oHBox.removeAllItems();this.getTokens().forEach(function(t){this._oHBox.addItem(this._generateDisplayText(t.getText()))}.bind(this))}}};U.prototype.onBeforeRendering=function(){if(u.prototype.onBeforeRendering){u.prototype.onBeforeRendering.apply(this,arguments)}this._deregisterResizeHandler()};U.prototype.onAfterRendering=function(){if(u.prototype.onAfterRendering){u.prototype.onAfterRendering.apply(this,arguments)}if(this.getMode()==="display"&&this.bControlNotRendered){this._oHBox.removeAllItems();this._oMoreLink.setVisible(false);this.getTokens().forEach(function(t){var e=this._generateDisplayText(t.getText());this._oHBox.addItem(e)},this)}if(this._oMultiComboBox&&this._oMultiInput&&this._oMultiInput.getBindingContext()&&this.getBindingContext()){var t=this.getBindingContext().getPath();var e=this._oMultiInput.getBindingContext().getPath();if(e!==t){this._oMultiInput.setBindingContext(this.getBindingContext())}else{if(this.getBinding("value").getBindingMode()==="TwoWay"){this._createAndAttachHelperMultiInput()}}var i=this._oMultiInput.getTokens().map(function(t){return t.getKey()});this._oMultiComboBox.setSelectedKeys(i)}this._registerResizeHandler()};U.prototype._registerResizeHandler=function(){if(!this._iResizeHandlerId){this._iResizeHandlerId=k.register(this,this._onResize.bind(this))}};U.prototype._deregisterResizeHandler=function(){if(this._iResizeHandlerId){k.deregister(this._iResizeHandlerId);this._iResizeHandlerId=null}};U.prototype._hasHTML=function(t){var e=/<[a-z][\s\S]*>/i;return e.test(t)};U.prototype._createTokenizer=function(){this._oTokenizer=new l(this.getId()+A,{editable:false,visible:false,width:"100%"});this._oHBox=new D(this.getId()+z);this._oMoreLink=new I(this.getId()+W,{press:this._handleNMoreIndicatorPress.bind(this),ariaLabelledBy:this.getId()+"-label"});this._oEmptyDash=new B({text:"",visible:true});var t=this._getNavigationPath(),e=this._getSelectExpandParameter();if(this.getBindingContext()){this._bindMultiInputTokens(this._oTokenizer);this._oHBox.bindAggregation("items",{path:t,parameters:e,factory:this._textFactory.bind(this)})}else{this.attachInnerControlsCreated(this._mirrorTokensToDisplayTokenizer,this)}var i=new C({height:"100%",items:[this._oEmptyDash,this._oHBox,this._oMoreLink,this._oTokenizer]});return{control:i,onCreate:"_onCreate"}};U.prototype._textFactory=function(t,e){var i=e.getProperty(this._getPropertyName()),o=i instanceof Date?this._formatValue(i):i.toString(),a=this._getDescriptionFieldName(),n=a?e.getProperty(a):"",r=this._getFormattedText(o,n),s;if(this.getDomRef()&&this.getDomRef().offsetWidth){this.bControlNotRendered=false;s=this._generateDisplayText(r)}else{this.bControlNotRendered=true;s=new B({text:r})}if(this._oEmptyDash){this._oEmptyDash.setVisible(false)}return s};U.prototype._generateDisplayText=function(t){var e=this.getDomRef(),i=e.offsetWidth,o=j("999 "+K.getText("POPOVER_DEFINE_MORE_LINKS"),e),a=new B,n,r,s;t=this._hasHTML(t)?E(t):t;if(this._oHBox.getItems().length===0){this._iHBoxWidth=0;this._iHiddenLabelsCount=0;this._iFirstHiddenTokenLength=0}this._oHBox.getItems().filter(function(t){return!t.getVisible()}).forEach(function(t){this._oHBox.removeItem(t)}.bind(this));a.setTooltip(t);t=this._iHBoxWidth===0?t:""+this.getTextSeparator()+""+t;a.setText(t);var h=j(t,e);this._iHBoxWidth+=h;if(this._iHiddenLabelsCount===0&&this._iHBoxWidth<=i){this._oMoreLink.setVisible(false)}else{while(this._iHBoxWidth&&this._iHBoxWidth>i-o){this._iHiddenLabelsCount+=1;if(this._oHBox.getItems()[0]){this._iFirstHiddenTokenLength=j(this._oHBox.getItems()[0].getText(),e);this._iHBoxWidth-=this._iFirstHiddenTokenLength;this._oHBox.removeItem(0)}else{this._iHBoxWidth-=h;a.setVisible(false)}}if(this._oHBox.getItems().length===0&&this._iHiddenLabelsCount===1&&!a.getVisible()){this._iHiddenLabelsCount=0;this._iHBoxWidth+=h;a.setVisible(true);this._oMoreLink.setVisible(false)}else{if(this._oHBox.getItems().length>0){n=this._oHBox.getItems()[0];n.setText(n.getTooltip());if(this._oHBox.getItems().length-1>0){r=this._oHBox.getItems()[this._oHBox.getItems().length-1];s=""+this.getTextSeparator()+""+r.getTooltip();r.setText(s)}a.setText(a.getText()+""+this.getTextSeparator()+"")}else{a.setText(a.getTooltip()+""+this.getTextSeparator()+"")}this._oMoreLink.setVisible(true);this._oMoreLink.setText(this._iHiddenLabelsCount+" "+K.getText("POPOVER_DEFINE_MORE_LINKS"))}}return a};U.prototype._mirrorTokensToDisplayTokenizer=function(){if(this.getMode()==="display"){var t=this._oMultiInput&&this._oMultiInput.getTokens();this._oTokenizer.removeAllTokens();this._oHBox.removeAllItems();this._oMoreLink.setVisible(false);if(!t){t=this.getAggregation("_initialTokens")||[]}t.forEach(function(t){var e=new h({text:t.getText(),key:t.getKey()});this._oTokenizer.addToken(e);var i=this._generateDisplayText(t.getText());this._oHBox.addItem(i)},this)}};U.prototype.getTextSeparator=function(){var t=this.getProperty("textSeparator");if(t){return t}return K.getText("SMARTMULTIINPUT_SEPARATOR")};U.prototype._tokensFactory=function(t,e){var i;this.setBusy(false);if(this._oFactory){var o=e.getProperty(this._getPropertyName());var a=o instanceof Date?this._formatValue(o):o.toString();var n=this._getDescriptionFieldName();var r=n?e.getProperty(n):"";i=this._createToken(a,r,e)}else{i=new h}return i};U.prototype._createToken=function(t,e,i){var o=this._getFormattedText(t,e);var a;a=new h;a.setKey(t);a.setText(o);return a};U.prototype._addToken=function(t){var e={},i,o,a,n=t.data("row"),r=t.data("range");e[this._getPropertyName()]=t.getKey();if(n){this._getEntityType().key.propertyRef.forEach(function(t){var i=n[t.name];if(i||i===0){e[t.name]=i}});if(this._oFactory._aProviders&&this._oFactory._aProviders[0].mOutParams){var s=this._oFactory._aProviders[0].mOutParams;for(o in s){if(o&&o!==this._getPropertyName()){a=s[o];e[o]=n[a]}}}}if(r){e["range"]=r}this.setValueState(N.None);this.setValueStateText("");i=this._createEntity(e);t.setBindingContext(i)};U.prototype._createEntity=function(t){var e=this._getModel(),i=this._getEntitySetName(),o=e._resolveGroup(i),a=this._getNavigationPath(),n=this.fireBeforeCreate({oData:t,mParameters:o});o.refreshAfterChange=true;o.context=this.getBindingContext();if(n){o.properties=t;var r=e.createEntry(a,o);return r}};U.prototype._removeToken=function(t){this._removeEntity(t.getBindingContext());t.destroy()};U.prototype._removeEntity=function(t){var e=this._getModel(),i=this._getEntitySetName(),o=e._resolveGroup(i),a=this.fireBeforeRemove({mParameters:o});var n=e.getDeferredGroups().indexOf(o.groupId)>=0;if(n&&this._entityHasPendingCreateChange(e,t)){e.deleteCreatedEntry(t);a=false}o.refreshAfterChange=true;o.context=t;if(a){var r="";e.remove(r,o)}};U.prototype._entityHasPendingCreateChange=function(t,e){var i=t.getPendingChanges();var o=t.getKey(e);return!!i[o]&&x(i[o],e.getObject())};U.prototype._getEntityKeyProperties=function(t){var e=this._getModel(),i=e.oMetadata._getEntityTypeByPath(t.getPath()),o={};i.key.propertyRef.forEach(function(e){var i=e.name;o[i]=t.getProperty(i)});return o};U.prototype.checkClientError=function(){if(this.getMode()==="display"){return false}return!this._validateMultiInput()};U.prototype.getRangeData=function(){var t=this.getTokens(),e=[];t.forEach(function(t){var i;if(t.data("range")){i=t.data("range")}else{i=this._getDefaultTokenRangeData(t)}e.push(i)},this);return e};U.prototype.setRangeData=function(t){if(!this.getBindingContext()){var e=Array.isArray(t)?t:[t];if(!this._oMultiInput){var i=this.getEditable(),o=this.getEnabled(),a=this.getContextEditable();this.setEditable(true);this.setEnabled(true);this.setContextEditable(true);this._updateInnerControlsIfRequired();this.setEditable(i);this.setEnabled(o);this.setContextEditable(a);this._updateInnerControlsIfRequired()}this._oMultiInput.removeAllTokens();e.forEach(function(t){var e=this._getTokenTextFromRangeData(t);var i=new h({text:e,key:e});i.data("range",t);this._oMultiInput.addToken(i)},this);this._mirrorTokensToDisplayTokenizer()}else{T.warning("setRangeData can only be used without property binding")}};U.prototype._getTokenTextFromRangeData=function(t){var e="";switch(t.operation){case H.EQ:e="="+t.value1;break;case H.GT:e=">"+t.value1;break;case H.GE:e=">="+t.value1;break;case H.LT:e="<"+t.value1;break;case H.LE:e="<="+t.value1;break;case H.Contains:e="*"+t.value1+"*";break;case H.StartsWith:e=t.value1+"*";break;case H.EndsWith:e="*"+t.value1;break;case H.BT:e=t.value1+"...";if(t.value2){e+=t.value2}break;default:e=""}if(t.exclude&&e!==""){e="!("+e+")"}return e};U.prototype._getComputedTextInEditModeSource=function(){var t=this.getTextInEditModeSource();if(this.isPropertyInitial("textInEditModeSource")&&this.getMode()==="edit"){t=L.None}return t};U.prototype.getFilter=function(){var t=[this._getPropertyName()],e={},i=this.getRangeData(),o;e[this._getPropertyName()]={ranges:i,items:[]};o=v.generateFilters(t,e);return o&&o.length===1&&o[0]};U.prototype._getDefaultTokenRangeData=function(t){var e={exclude:false,operation:H.EQ,value1:this._parseValue(t.getKey()),value2:"",keyField:this._getPropertyName()};return e};U.prototype._validateToken=function(t){var e=t.text;var i=this._validateValue(e);if(i){var o=new h({key:e,text:e});if(this.getSupportRanges()){var a=this._getDefaultTokenRangeData(o);o.data("range",a);o.setText("="+e)}return o}};U.prototype._validateMultiInput=function(){if(this._oMultiInput.getValueState()!==N.None){return false}if(this.getRequired()&&this.getTokens().length===0){this.setValueStateText(R.getResourceBundleFor("sap.ui.comp").getText("VALUEHELPVALDLG_FIELDMESSAGE"));this.setValueState(N.Error);return false}else{this.setValueState(N.None);this.setValueStateText("");return true}};U.prototype._validateValueOnChange=function(t){if(t===""){this.setValueState(N.None);this.setValueStateText("");this._validateMultiInput()}else{this._validateValue(t)}};U.prototype._parseValue=function(t){return this._getType().parseValue(t,"string")};U.prototype._formatValue=function(t){return this._getType().formatValue(t,"string")};U.prototype._validateValue=function(t){try{var e=this._parseValue(t);this._getType().validateValue(e);this.setValueState(N.None);this.setValueStateText("");return true}catch(e){this.setValueState(N.Error);this.setValueStateText(e.message);var i={element:this._oMultiInput,property:"value",type:this._getType(),newValue:t,oldValue:null,exception:e,message:e.message};if(e instanceof d){this.fireParseError(i)}else if(e instanceof g){this.fireValidationError(i)}return false}};U.prototype._getModel=function(){if(this._oFactory){return this._oFactory._oModel}};U.prototype._getDateFormatSettings=function(){var t=this.data("dateFormatSettings");if(typeof t==="string"){try{t=JSON.parse(t)}catch(t){}}return t};U.prototype._getNavigationPath=function(){return this._oFactory._oMetaData.navigationPath};U.prototype._getDescriptionFieldName=function(){var t=this._oFactory._oMetaData.annotations.text;if(t){if(t.navigationPathHelp){return t.navigationPathHelp+"/"+t.property.property.name}return t.property.property.name}};U.prototype._getType=function(){if(!this._oType){var t;if(this._isEdmTimeType()){t=this._getDateFormatSettings()}this._oType=this._oFactory._oTypes.getType(this._oFactory._oMetaData.property,t)}return this._oType};U.prototype._isEdmTimeType=function(){var t=["Edm.DateTime","Edm.DateTimeOffset","Edm.Time"];return t.indexOf(this._oFactory._oMetaData.property.property.type)>-1};U.prototype._isTimeType=function(t){var e=["date","datetime","time"];return e.indexOf(t)>-1};U.prototype._getPropertyName=function(){return this._oFactory._oMetaData.property.property.name};U.prototype._getEntitySetName=function(){return this._oFactory._oMetaData.entitySet.name};U.prototype._getEntityType=function(){return this._oFactory._oMetaData.entityType};U.prototype._getValueListAnnotation=function(){return this._oFactory._oMetaData.annotations.valuelist};U.prototype._getDisplayBehaviour=function(){var t=this._oFactory._getDisplayBehaviourConfiguration("defaultInputFieldDisplayBehaviour");if(!t||t===V.auto){t=V.descriptionAndId}return t};U.prototype._getFormattedText=function(t,e){var i=this._getDisplayBehaviour();var o=y.getFormattedExpressionFromDisplayBehaviour(i,t,e);return this._hasHTML(o)?E(o):o};U.prototype._getFilterType=function(t){if(f.isNumeric(t.type)){return"numeric"}else if(t.type==="Edm.DateTime"&&t["sap:display-format"]==="Date"){return"date"}else if(t.type==="Edm.String"){return"string"}else if(t.type==="Edm.Boolean"){return"boolean"}else if(t.type==="Edm.Time"){return"time"}else if(t.type==="Edm.DateTimeOffset"){return"datetime"}return undefined};U.prototype.setEntitySet=function(){u.prototype.setEntitySet.apply(this,arguments);this.updateBindingContext(false,this._getModel());return this};U.prototype.bindProperty=function(t,e){u.prototype.bindProperty.apply(this,arguments);if(t==="value"){this.updateBindingContext(false,this._getModel())}return this};U.prototype._checkComboBox=function(){var t=this._oFactory._oSelector.checkComboBox();return t&&t.combobox};U.prototype._isReadMode=function(){return!this.getEditable()||!this.getEnabled()||!this.getContextEditable()};function Q(){this._onCreate.apply(this,arguments);if(this._aProviders.length>0){this._aProviders[0]._onOK=G;this._aProviders.forEach(function(t){t._calculateAndSetODataModelOutputData=q})}}U.prototype._init=function(){var t=this;u.prototype._init.apply(this,arguments);if(this._oFactory){this._oFactory._createMultiInput=this._createMultiInput.bind(this);this._oFactory._createMultiComboBox=this._createMultiComboBox.bind(this);this._oFactory._createTokenizer=this._createTokenizer.bind(this);this._oFactory._onMultiInputCreate=Q;this._oFactory._oSelector.getCreator=function(e){var i=e!==undefined&&e.mode!==undefined?e.mode==="display":t._isReadMode();if(i){return"_createTokenizer"}else if(t._checkComboBox()){return"_createMultiComboBox"}else{return"_createMultiInput"}}}};U.prototype._getEditableForNotExpandedNavigation=function(){return true};U.prototype.exit=function(){u.prototype.exit.apply(this,arguments);this._deregisterResizeHandler();if(this._oMultiInput){this._oMultiInput.destroy()}if(this._oMultiComboBox){this._oMultiComboBox.destroy()}if(this._oTokenizer){this._oTokenizer.destroy()}if(this._oHBox){this._oHBox.destroy()}this._oMultiInput=null;this._oMultiComboBox=null;this._oTokenizer=null;this._oHBox=null};return U});
/*!
 * SAPUI5
 * (c) Copyright 2009-2023 SAP SE. All rights reserved.
 */
sap.ui.predefine("sap/ui/comp/smarttable/SmartTable", ["sap/m/library","sap/ui/core/library","sap/ui/core/Core","sap/ui/core/ShortcutHintsMixin","sap/ui/core/format/ListFormat","sap/ui/events/KeyCodes","sap/ui/comp/util/DateTimeUtil","sap/ui/comp/util/FilterUtil","sap/m/Column","sap/m/ColumnListItem","sap/m/Label","sap/m/MessageBox","sap/m/Table","sap/m/Text","sap/m/Title","sap/m/OverflowToolbar","sap/m/OverflowToolbarLayoutData","sap/m/ToolbarSpacer","sap/m/OverflowToolbarButton","sap/m/ToolbarSeparator","sap/m/VBox","sap/m/FlexItemData","sap/ui/comp/library","sap/ui/comp/providers/TableProvider","sap/ui/comp/smartvariants/SmartVariantManagement","sap/ui/model/Sorter","sap/ui/model/Filter","sap/ui/model/FilterOperator","sap/ui/model/json/JSONModel","sap/ui/table/AnalyticalColumn","sap/ui/table/AnalyticalTable","sap/ui/table/Column","sap/ui/table/Table","sap/ui/table/TreeTable","sap/ui/comp/personalization/Controller","sap/ui/comp/personalization/Util","sap/ui/comp/util/FormatUtil","sap/ui/comp/util/FullScreenUtil","sap/ui/comp/odata/ODataModelUtil","sap/ui/comp/odata/ODataType","sap/ui/comp/state/UIState","sap/ui/comp/smartvariants/PersonalizableInfo","sap/ui/core/format/NumberFormat","sap/ui/Device","sap/base/Log","sap/base/util/deepEqual","sap/base/util/merge","sap/m/ColumnHeaderPopover","sap/m/ColumnPopoverActionItem","sap/m/Menu","sap/m/OverflowToolbarMenuButton","sap/m/MenuItem","sap/m/Button","sap/m/Link","sap/m/MessageStrip","sap/ui/core/InvisibleMessage","sap/ui/util/openWindow","sap/ui/core/theming/Parameters","sap/m/plugins/ColumnResizer","sap/m/ColumnPopoverSelectListItem","sap/m/table/Util","sap/m/SegmentedButton","sap/m/SegmentedButtonItem","sap/m/table/columnmenu/Menu","sap/m/table/columnmenu/ActionItem","sap/m/table/columnmenu/QuickActionContainer","sap/m/table/columnmenu/ItemContainer","sap/m/table/columnmenu/QuickAction","sap/m/table/columnmenu/QuickSort","sap/m/table/columnmenu/QuickSortItem","sap/m/table/columnmenu/QuickGroup","sap/m/table/columnmenu/QuickGroupItem","sap/m/table/columnmenu/QuickTotal","sap/m/table/columnmenu/QuickTotalItem","./flexibility/Utils","sap/base/util/isEmptyObject","sap/ui/performance/trace/FESRHelper"],function(t,e,i,o,a,n,r,s,l,u,h,d,p,f,g,_,c,m,b,y,T,C,S,v,P,I,E,M,x,A,D,B,F,w,V,L,R,O,U,H,W,k,K,N,z,G,Q,j,q,X,$,Y,Z,J,tt,et,it,ot,at,nt,rt,st,lt,ut,ht,dt,pt,ft,gt,_t,ct,mt,bt,yt,Tt,Ct,St){"use strict";var vt=t.ButtonType;var Pt=t.MenuButtonMode;var It=t.ToolbarDesign;var Et=t.ToolbarStyle;var Mt=e.SortOrder;var xt=e.TitleLevel;var At=S.smarttable.InfoToolbarBehavior;var Dt=T.extend("sap.ui.comp.smarttable.SmartTable",{metadata:{library:"sap.ui.comp",designtime:"sap/ui/comp/designtime/smarttable/SmartTable.designtime",properties:{entitySet:{type:"string",group:"Misc",defaultValue:null},smartFilterId:{type:"string",group:"Misc",defaultValue:null},ignoredFields:{type:"string",group:"Misc",defaultValue:null},initiallyVisibleFields:{type:"string",group:"Misc",defaultValue:null},requestAtLeastFields:{type:"string",group:"Misc",defaultValue:null},ignoreFromPersonalisation:{type:"string",group:"Misc",defaultValue:null},tableType:{type:"sap.ui.comp.smarttable.TableType",group:"Misc",defaultValue:null},useVariantManagement:{type:"boolean",group:"Misc",defaultValue:true},useColumnLabelsAsTooltips:{type:"boolean",group:"Misc",defaultValue:true},showVariantManagement:{type:"boolean",group:"Misc",defaultValue:true},useExportToExcel:{type:"boolean",group:"Misc",defaultValue:true},enableExport:{type:"boolean",group:"Misc",defaultValue:true},exportType:{type:"sap.ui.comp.smarttable.ExportType",group:"Misc",defaultValue:"UI5ClientPDF"},useTablePersonalisation:{type:"boolean",group:"Misc",defaultValue:true},showTablePersonalisation:{type:"boolean",group:"Misc",defaultValue:true},customizeConfig:{type:"object",group:"Misc",defaultValue:null},showRowCount:{type:"boolean",group:"Misc",defaultValue:true},header:{type:"string",group:"Misc",defaultValue:null},headerLevel:{type:"sap.ui.core.TitleLevel",group:"Appearance",defaultValue:xt.Auto},headerStyle:{type:"sap.ui.core.TitleLevel",group:"Appearance"},toolbarStyleClass:{type:"string",group:"Misc",defaultValue:null},enableCustomFilter:{type:"boolean",group:"Misc",defaultValue:true},persistencyKey:{type:"string",group:"Misc",defaultValue:null},useOnlyOneSolidToolbar:{type:"boolean",group:"Misc",defaultValue:false},placeToolbarInTable:{type:"boolean",group:"Misc",defaultValue:false},currentVariantId:{type:"string",group:"Misc",defaultValue:null},editable:{type:"boolean",group:"Misc",defaultValue:false},enableAutoBinding:{type:"boolean",group:"Misc",defaultValue:false},tableBindingPath:{type:"string",group:"Misc",defaultValue:null},editTogglable:{type:"boolean",group:"Misc",defaultValue:false},demandPopin:{type:"boolean",group:"Misc",defaultValue:false},showFullScreenButton:{type:"boolean",group:"Misc",defaultValue:false},initialNoDataText:{type:"string",group:"Misc",defaultValue:null},useInfoToolbar:{type:"sap.ui.comp.smarttable.InfoToolbarBehavior",group:"Behavior",defaultValue:At.Auto},showDetailsButton:{type:"boolean",group:"Misc",defaultValue:false},detailsButtonSetting:{type:"sap.ui.core.Priority[]",group:"Behavior"},enableAutoColumnWidth:{type:"boolean",group:"Misc",defaultValue:false},showPasteButton:{type:"boolean",group:"Behavior",defaultValue:false},enablePaste:{type:"boolean",group:"Behavior",defaultValue:true}},associations:{smartVariant:{type:"sap.ui.core.Control",multiple:false}},aggregations:{customToolbar:{type:"sap.m.Toolbar",multiple:false},semanticObjectController:{type:"sap.ui.comp.navpopover.SemanticObjectController",multiple:false},noData:{type:"sap.ui.core.Control",altTypes:["string"],multiple:false},semanticKeyAdditionalControl:{type:"sap.ui.core.Control",multiple:false},dataStateIndicator:{type:"sap.m.plugins.DataStateIndicator",multiple:false},copyProvider:{type:"sap.m.plugins.CopyProvider",multiple:false}},events:{initialise:{},beforeRebindTable:{},editToggled:{},dataRequested:{},dataReceived:{},afterVariantInitialise:{},afterVariantSave:{parameters:{currentVariantId:{type:"string"}}},afterVariantApply:{parameters:{currentVariantId:{type:"string"}}},showOverlay:{},fieldChange:{},fullScreenToggled:{parameters:{fullScreen:{type:"boolean"}}},beforeExport:{parameters:{exportSettings:{type:"object"},userExportSettings:{type:"object"},filterSettings:{type:"object[]"}}},beforePaste:{allowPreventDefault:true,parameters:{columnInfos:{type:"object[]"}}},paste:{parameters:{result:{type:"object"}}},uiStateChange:{}}},renderer:{apiVersion:2},constructor:function(){this._oTableReady=function(){var t={};t.promise=new Promise(function(e){t.resolve=e});return t}();T.apply(this,arguments);this._aExistingColumns=[];this._aAlwaysSelect=[];this._oTemplate=null;this._mFieldMetadataByKey={};this._bUseLegacyMenu=false;this._createToolbar();this._updateP13nDialogSettings();this._createTable();this.attachModelContextChange(this._initialiseMetadata,this)}});Dt.prototype._getP13nDialogSettings=function(){var t=this.data("p13nDialogSettings");if(typeof this._oP13nDialogSettings==="string"){try{t=JSON.parse(this._oP13nDialogSettings)}catch(e){t=null}}return t};["DataStateIndicator","CopyProvider","CellSelector"].forEach(t=>{Dt.prototype[`get${t}PluginOwner`]=function(){return this._oTable||this._oTableReady?.promise}});Dt.prototype.setDataStateIndicator=function(t){this._handeDataStateEvents(this.getDataStateIndicator(),"detach");this.setAggregation("dataStateIndicator",t,true);this._handeDataStateEvents(this.getDataStateIndicator(),"attach");return this};Dt.prototype.setCopyProvider=function(t){this.setAggregation("copyProvider",t,true);if(window.isSecureContext&&t&&this._bToolbarInsertedIntoItems){this._createToolbarContent()}return this};Dt.prototype.getColumnClipboardSettings=function(t){var e=t.data("p13nData");var i=this._getColumnLeadingProperty(t,e);if(!e||!i){return null}var o,a;var n=[i];var r="{0}";if(e.unit){r="{0} {1}";n.push(e.unit);a=R[e.isCurrency?"getAmountCurrencyFormatter":"getMeasureUnitFormatter"](this._bPreserveDecimals)}else{o=e.typeInstance||(this._oTableProvider.getFieldMetadata(i)||{}).modelType;if(e.description){r=R.getFormattedExpressionFromDisplayBehaviour(e.displayBehaviour,"{0}","{1}");n.push(e.description)}}return{types:[o],properties:n,unitFormatter:a,template:r}};Dt.prototype.setCustomizeConfig=function(t){this.setProperty("customizeConfig",t,true);return this};Dt.prototype.setUseExportToExcel=function(t){var e=this.getUseExportToExcel();this.setProperty("useExportToExcel",t,true);if(e!==this.getUseExportToExcel()){this.setEnableExport(t)}return this};Dt.prototype.setEnableExport=function(t){var e=this.getEnableExport();this.setProperty("enableExport",t,true);if(e!==this.getEnableExport()){this.setUseExportToExcel(t)}return this};Dt.prototype._validateCustomizeConfig=function(t){if(!t){return}if(t.isA){z.error("Invalid config property. Provided configuration has been deleted from the customizeConfig property - "+this.getId());this.setCustomizeConfig(null);return}for(var e in t){switch(e){case"textInEditModeSource":this._validateTextInEditModeSource(t);break;case"ignoreInsertRestrictions":this._validateIgnoreInsertRestrictions(t);break;case"autoColumnWidth":this._validateAutoColumnWidth(t);break;case"clientSideMandatoryCheck":this._validateClientSideMandatoryCheck(t);break;default:z.error(e+" is not a supported configuration for the customizeConfig property - "+this.getId());delete t[e];break}}};Dt.prototype._validateTextInEditModeSource=function(t){if(this._validateCustomizeConfigObjectType(t["textInEditModeSource"])){delete t.textInEditModeSource;z.error("Invalid config property textInEditModeSource. Provided configuration has been deleted from the customizeConfig property - "+this.getId());return}this._checkAllowedValuesForCustomizeConfig(t["textInEditModeSource"],Object.keys(S.smartfield.TextInEditModeSource),"textInEditModeSource")};Dt.prototype._validateCustomizeConfigObjectType=function(t){if(typeof t!=="object"||!Object.keys(t).length||t.isA){return true}return false};Dt.prototype._checkAllowedValuesForCustomizeConfig=function(t,e,i){for(var o in t){if(!e.includes(t[o])){z.error("Invalid config property '"+o+"' for the "+i+" property of the customizeConfig - "+this.getId());delete t[o]}}};Dt.prototype._validateIgnoreInsertRestrictions=function(t){if(this._validateCustomizeConfigObjectType(t["ignoreInsertRestrictions"])){delete t.ignoreInsertRestrictions;z.error("Invalid config property ignoreInsertRestrictions. Provided configuration has been deleted from the customizeConfig property - "+this.getId());return}this._checkAllowedValuesForCustomizeConfig(t["ignoreInsertRestrictions"],[true,false],"ignoreInsertRestrictions")};Dt.prototype._validateClientSideMandatoryCheck=function(t){if(this._validateCustomizeConfigObjectType(t["clientSideMandatoryCheck"])){delete t.clientSideMandatoryCheck;z.error("Invalid config property clientSideMandatoryCheck. Provided configuration has been deleted from the customizeConfig property - "+this.getId());return}this._checkAllowedValuesForCustomizeConfig(t["clientSideMandatoryCheck"],[true,false],"clientSideMandatoryCheck")};Dt.prototype._validateAutoColumnWidth=function(t){if(!this.getEnableAutoColumnWidth()&&t.hasOwnProperty("autoColumnWidth")){delete t.autoColumnWidth;z.error("The autoColumnWidth property is deleted from the customizeConfig, since enableAutoColumnWidth=false on the SmartTable - "+this.getId())}if(this._validateCustomizeConfigObjectType(t["autoColumnWidth"])){delete t.autoColumnWidth;z.error("Invalid config property autoColumnWidth. Provided configuration has been deleted from the customizeConfig property - "+this.getId());return}if(typeof t["autoColumnWidth"]==="boolean"||typeof t["autoColumnWidth"]==="object"){var e=t["autoColumnWidth"];for(var i in e){if(typeof e[i]==="boolean"){continue}if(typeof e[i]!=="object"){z.error("Expected 'object' or 'boolean', instead "+typeof e[i]+" was passed for '"+i+"' autoColumnWidth customizeConfig property - "+this.getId());delete e[i];continue}var o=e[i];for(var a in o){var n=null;switch(a){case"truncateLabel":n=typeof o[a];if(n!=="boolean"){z.error("The "+a+" property must be of type boolean, instead "+n+" was passed - "+this.getId());delete o[a]}break;case"min":case"max":case"gap":n=typeof o[a];if(n!=="number"){z.error("The "+a+" property must be of type number, instead "+n+" was passed - "+this.getId());delete o[a]}break;default:z.error("Invalid config property '"+a+"' for the autoColumnWidth property of the customizeConfig - "+this.getId());delete o[a]}}}}};Dt.prototype._handeDataStateEvents=function(t,e){if(t){t[e+"ApplyFilter"](this._onApplyMessageFilter,this);t[e+"ClearFilter"](this._onClearMessageFilter,this);t[e+"Event"]("filterInfoPress",this._handleInfoToolbarPress,this)}};Dt.prototype.setHeaderLevel=function(t){if(this.getHeaderLevel()===t){return this}this.setProperty("headerLevel",t,true);this._headerText&&this._headerText.setLevel(t);return this};Dt.prototype.setHeaderStyle=function(t){if(this.getHeaderStyle()===t){return this}this.setProperty("headerStyle",t,true);this._headerText&&this._headerText.setTitleStyle(t||xt.H4);return this};Dt.prototype._getP13nFilterMessageStrip=function(){var t,e;if(this._oMessageFilter){e=i.getLibraryResourceBundle("sap.ui.comp");t=new tt({text:e.getText("SMARTTABLE_P13N_FILTER_MESSAGESTRIP"),link:new J({text:e.getText("SMARTTABLE_MESSAGESTRIP_CLEAR_FILTER"),press:[function(){this._fnClearMessageFilter();t.setVisible(false)},this]})})}return t};Dt.prototype._onApplyMessageFilter=function(t){this._fnClearMessageFilter=t.getParameter("revert");this._oMessageFilter=t.getParameter("filter");t.preventDefault();this._reBindTable()};Dt.prototype._onClearMessageFilter=function(t){this._oMessageFilter=null;t.preventDefault();this._reBindTable()};Dt.prototype.init=function(){T.prototype.init.call(this);this.addStyleClass("sapUiCompSmartTable");this.setFitContainer(true);this._aColumnKeys=[];this._aDeactivatedColumns=[];this._mLazyColumnMap={};this._mMenuShowEntryMap=new window.WeakMap};Dt.prototype._getVariantManagementControl=function(t){var e=null;if(t){if(typeof t==="string"){e=i.byId(t)}else{e=t}if(e){if(!(e instanceof P)){z.error("Control with the id="+t.getId?t.getId():t+" not of expected type");return null}}}return e};Dt.prototype._createVariantManagementControl=function(){if(this._oVariantManagement||!this.getUseVariantManagement()&&!this.getUseTablePersonalisation()||!this.getPersistencyKey()){return}var t=new k({type:"table",keyName:"persistencyKey",dataSource:"TODO"});t.setControl(this);var e=this.getSmartVariant();if(e){this._oVariantManagement=this._getVariantManagementControl(e)}else if(this._oSmartFilter&&this._oSmartFilter.data("pageVariantPersistencyKey")){e=this._oSmartFilter.getSmartVariant();if(e){this._oVariantManagement=this._getVariantManagementControl(e)}}else{this._oVariantManagement=new P(this.getId()+"-variant",{showShare:true})}if(this._oVariantManagement){this._oVariantManagement.addPersonalizableControl(t);this._oVariantManagement.attachSave(this._variantSaved,this);this._oVariantManagement.attachAfterSave(this._variantAfterSave,this);this._oVariantManagement.initialise(this._variantInitialised,this)}};Dt.prototype._variantInitialised=function(){if(!this._oCurrentVariant){this._oCurrentVariant="STANDARD"}this.fireAfterVariantInitialise();if(this._oVariantManagement&&!this._oVariantManagement.getEnabled()){this._checkAndTriggerBinding()}};Dt.prototype._variantSaved=function(){if(this._oPersController){this._oPersController.setPersonalizationData(this._oCurrentVariant,true)}};Dt.prototype._variantAfterSave=function(){this.fireAfterVariantSave({currentVariantId:this.getCurrentVariantId()})};Dt.prototype.setTableBindingPath=function(t){this.setProperty("tableBindingPath",t,true);return this};Dt.prototype.setTableType=function(t){if(this.getTableType()===t){return this}if(this._bInitialising){throw new Error("tableType changed while SmartTable control was initializing - "+this.getId())}this.setProperty("tableType",t);return this};Dt.prototype.setShowTablePersonalisation=function(t){this.setProperty("showTablePersonalisation",t,true);if(this._oTablePersonalisationButton){this._oTablePersonalisationButton.setVisible(t)}return this};Dt.prototype.setUseVariantManagement=function(t){this.setProperty("useVariantManagement",t,true);if(this._oPersController){this._oPersController.setResetToInitialTableState(!t)}return this};Dt.prototype.setShowVariantManagement=function(t){this.setProperty("showVariantManagement",t,true);if(this._oVariantManagement&&!this._oVariantManagement.isPageVariant()){this._oVariantManagement.setVisible(t);if(this._oSeparator){this._oSeparator.setVisible(t)}}return this};Dt.prototype.setToolbarStyleClass=function(t){this.setProperty("toolbarStyleClass",t,true);return this};Dt.prototype.setCustomToolbar=function(t){this._oCustomToolbar=t;return this};Dt.prototype.getCustomToolbar=function(){return this._oCustomToolbar};Dt.prototype.setHeader=function(t){var e=this.getProperty("header"),i;this.setProperty("header",t,true);if(this.bIsInitialised&&this._oToolbar){i=!e===!t;if(!i){this._createToolbarContent()}else{this._refreshHeaderText()}}return this};Dt.prototype.setShowRowCount=function(t){this.setProperty("showRowCount",t,true);this._refreshHeaderText();return this};Dt.prototype.setEditable=function(t){if((t=!!t)==this.getEditable()){return this}this.setProperty("editable",t,true);if(this._oEditModel){this._oEditModel.setProperty("/editable",t)}if(this._oEditButton){this._oEditButton.setIcon(t?"sap-icon://display":"sap-icon://edit")}if(this._isMobileTable&&this._oTable.setKeyboardMode){this._oTable.setKeyboardMode(t?"Edit":"Navigation")}this._updateVisibleColumnsWidthForEdit();return this};Dt.prototype.setDemandPopin=function(t){var e=this.getDemandPopin();if(e===t){return this}this.setProperty("demandPopin",t,true);if(this.bIsInitialised){if(t){this._updateColumnsPopinFeature()}else{this._deactivateColumnsPopinFeature()}}return this};Dt.prototype._refreshHeaderText=function(){if(!this._headerText){return}if(!this._oNumberFormatInstance){this._oNumberFormatInstance=K.getFloatInstance()}var t;var e=this.getHeader();this._headerText.setVisible(!!e);if(this.getShowRowCount()){var i=this._getRowBinding();t=i?i.getCount():0;if(t>0){var o=this._oNumberFormatInstance.format(t);e+=" ("+o+")"}}this._headerText.setText(e);this._updateAriaLabelledByInfo();if(this._bDataLoadPending===false&&this._bUpdateTableAnnouncement){this._bUpdateTableAnnouncement=false;rt.announceTableUpdate(this.getHeader(),t)}};Dt.prototype._updateAriaLabelledByInfo=function(){var t=this._headerText.getId();if(this._oTable&&this._oTable.addAriaLabelledBy){if(this._headerText.getVisible()){if(this._oTable.getAriaLabelledBy().indexOf(t)===-1){this._oTable.addAriaLabelledBy(t)}}else{this._oTable.removeAriaLabelledBy(t)}}};Dt.prototype._addFullScreenButton=function(){if(this._oFullScreenButton){this._oToolbar.removeContent(this._oFullScreenButton)}if(this.getShowFullScreenButton()){if(!this._oFullScreenButton){this._oFullScreenButton=new b(this.getId()+"-btnFullScreen",{press:[function(){this._toggleFullScreen(!this.bFullScreen)},this]});this._oFullScreenButton.addStyleClass("sapUiCompSmartTableToolbarContent");if(N.system.phone){this._oFullScreenButton.setLayoutData(new c({priority:"NeverOverflow"}))}}this._renderFullScreenButton();this._oToolbar.addContent(this._oFullScreenButton)}};Dt.prototype._addCopyButton=function(){var t=this.getId()+"-btnCopy";var e=i.byId(t);if(e){this._oToolbar.removeContent(e)}var o=this.getCopyProvider();if(o&&window.isSecureContext){if(!e){e=o.getCopyButton({id:t});e.addStyleClass("sapUiCompSmartTableToolbarContent")}this._oToolbar.addContent(e)}};Dt.prototype._addPasteButton=function(){var t=this.getId()+"-btnPaste";var e=i.byId(t);if(e){this._oToolbar.removeContent(e)}if(this.getShowPasteButton()){if(!e){e=new b(t);St.setSemanticStepname(e,"press","sc:tbl:paste");e.addStyleClass("sapUiCompSmartTableToolbarContent");sap.ui.require(["sap/m/plugins/PasteProvider"],function(t){e.addDependent(new t({pasteFor:this._oTable.getId()}))}.bind(this))}e.setEnabled(this.getEnablePaste());this._oToolbar.addContent(e)}};Dt.prototype._createToolbar=function(){var t=null;if(!this._oToolbar){t=this.getCustomToolbar();if(t){this._oToolbar=t}else{this._oToolbar=new _({design:It.Transparent,style:this.getTableType()==="ResponsiveTable"?Et.Standard:Et.Clear});this._oToolbar.addStyleClass("sapUiCompSmartTableToolbar");if(this.getToolbarStyleClass()){this._oToolbar.addStyleClass(this.getToolbarStyleClass())}}this._oToolbar.setLayoutData(new C({shrinkFactor:0}))}};Dt.prototype._toggleShowHideDetails=function(t){if(!this._oShowHideDetailsButton||t===this.bHideDetails){return}this.bHideDetails=t;if(this.bHideDetails){this._oTable.setHiddenInPopin(this._getImportanceToHide());this._oShowHideDetailsButton.setSelectedKey("hideDetails")}else{this._oTable.setHiddenInPopin([]);this._oShowHideDetailsButton.setSelectedKey("showDetails")}};Dt.prototype._getImportanceToHide=function(){var t=this.getDetailsButtonSetting()||[];var e=[];if(t.length){e=t}else{e=N.system.phone?["Low","Medium"]:["Low"]}return e};Dt.prototype._toggleFullScreen=function(t,e){if(!this._oFullScreenButton||t===this.bFullScreen&&!e){return}this.bFullScreen=t;O.toggleFullScreen(this,this.bFullScreen,this._oFullScreenButton,this._toggleFullScreen);this._renderFullScreenButton();this.fireFullScreenToggled({fullScreen:t})};Dt.prototype._renderFullScreenButton=function(){var t=i.getLibraryResourceBundle("sap.ui.comp"),e;e=this.bFullScreen?t.getText("CHART_MINIMIZEBTN_TOOLTIP"):t.getText("CHART_MAXIMIZEBTN_TOOLTIP");this._oFullScreenButton.setTooltip(e);this._oFullScreenButton.setText(e);this._oFullScreenButton.setIcon(this.bFullScreen?"sap-icon://exit-full-screen":"sap-icon://full-screen")};Dt.prototype._createToolbarContent=function(){if(!this._oToolbar){this._createToolbar()}this._addVariantManagementToToolbar();this._addSeparatorToToolbar();this._addHeaderToToolbar();this._addSpacerToToolbar();this._addCopyButton();this._addPasteButton();this._addEditTogglableToToolbar();this._addShowHideDetailsButton();this._addTablePersonalisationToToolbar();this._addExportToExcelToToolbar();this._addFullScreenButton();this._bToolbarInsertedIntoItems=true;this._placeToolbar()};Dt.prototype._applyToolbarContentOrder=function(){if(!this.bIsInitialised||!this.getCustomToolbar()){return}var t=this.data("p13nData_ToolbarContentMove");if(!t){return}t=Tt.parseChangeContent(t,function(t){this.data("p13nData_ToolbarContentMove",t)}.bind(this));if(!t||!t.order){return}var e=Tt.getAppComponentForControl(this)||null;var i=-1;var o=t.order;var a=[];var n=this._oToolbar.getContent();for(var r=0;r<o.length;r++){for(var s=0;s<n.length;s++){if(o[r].id===Tt.getSelectorForControl(n[s],e)?.id){if(i<0||i>s){i=s}a.push(n[s])}}}for(var s=0;s<a.length;s++){this._oToolbar.removeContent(a[s]);this._oToolbar.insertContent(a[s],i);i++}};Dt.prototype._placeToolbar=function(){if(!this.getPlaceToolbarInTable()){this.insertItem(this._oToolbar,0)}else if(this._isMobileTable){this._oTable.setHeaderToolbar(this._oToolbar)}else{this._oTable.addExtension(this._oToolbar)}};Dt.prototype.getToolbar=function(){return this._oToolbar};Dt.prototype._addEditTogglableToToolbar=function(){var t;if(this._oEditButton){this._oToolbar.removeContent(this._oEditButton)}if(this.getEditTogglable()){if(!this._oEditButton){t=i.getLibraryResourceBundle("sap.ui.comp").getText("TABLE_EDITTOGGLE_TOOLTIP");this._oEditButton=new b(this.getId()+"-btnEditToggle",{icon:this.getEditable()?"sap-icon://display":"sap-icon://edit",text:t,tooltip:t,press:[function(){var t=this.getEditable();t=!t;this.setEditable(t,true);this.fireEditToggled({editable:t})},this]});this._oEditButton.addStyleClass("sapUiCompSmartTableToolbarContent");St.setSemanticStepname(this._oEditButton,"press","sc:tbl:edit")}this._oToolbar.addContent(this._oEditButton)}};Dt.prototype._addHeaderToToolbar=function(){if(this._headerText){this._oToolbar.removeContent(this._headerText)}if(!this._headerText){this._headerText=new g(this.getId()+"-header");this._headerText.addStyleClass("sapUiCompSmartTableHeader");this._headerText.addStyleClass("sapUiCompSmartTableToolbarContent");this._headerText.setLevel(this.getHeaderLevel());this._headerText.setTitleStyle(this.getHeaderStyle()||xt.H4)}this._refreshHeaderText();this._oToolbar.insertContent(this._headerText,0)};Dt.prototype._addSeparatorToToolbar=function(){if(this._oSeparator){this._oToolbar.removeContent(this._oSeparator)}if(this.getHeader()&&this.getUseVariantManagement()&&this._oVariantManagement&&!this._oVariantManagement.isPageVariant()){if(!this._oSeparator){this._oSeparator=new y(this.getId()+"-toolbarSeperator");if(!this.getShowVariantManagement()){this._oSeparator.setVisible(false)}this._oSeparator.addStyleClass("sapUiCompSmartTableToolbarContent")}this._oToolbar.insertContent(this._oSeparator,0)}if(this._oToolbar){this._oToolbar.addStyleClass("sapMTBHeader-CTX")}};Dt.prototype._addVariantManagementToToolbar=function(){if(this._oVariantManagement&&!this._oVariantManagement.isPageVariant()){this._oToolbar.removeContent(this._oVariantManagement);if(this.getUseVariantManagement()){this._oToolbar.insertContent(this._oVariantManagement,0);this._oVariantManagement.addStyleClass("sapUiCompSmartTableToolbarContent");this._oVariantManagement.addStyleClass("sapUiCompSmartTableToolbarContentAllowAdaption");if(!this._oVariantManagement.isPageVariant()){this._oVariantManagement.setVisible(this.getShowVariantManagement())}}}};Dt.prototype._addSpacerToToolbar=function(){var t=false,e=this._oToolbar.getContent(),i,o;if(e){o=e.length;i=0;for(i;i<o;i++){if(e[i]instanceof m){t=true;break}}}if(!t){this._oToolbar.addContent(new m(this.getId()+"-toolbarSpacer").addStyleClass("sapUiCompSmartTableToolbarContent"))}};Dt.prototype._createShowHideDetailsButton=function(){var t=i.getLibraryResourceBundle("sap.ui.comp");this._oShowHideDetailsButton=new st(this.getId()+"-btnShowHideDetails",{visible:false,items:[new lt({icon:"sap-icon://detail-more",key:"showDetails",tooltip:t.getText("TABLE_SHOWDETAILS_TEXT"),press:[function(){this._toggleShowHideDetails(false)},this]}),new lt({icon:"sap-icon://detail-less",key:"hideDetails",tooltip:t.getText("TABLE_HIDEDETAILS_TEXT"),press:[function(){this._toggleShowHideDetails(true)},this]})]});this._oShowHideDetailsButton.addStyleClass("sapUiCompSmartTableToolbarContent");this._oShowHideDetailsButton.setSelectedKey("hideDetails")};Dt.prototype._addShowHideDetailsButton=function(){if(this._oShowHideDetailsButton){this._oToolbar.removeContent(this._oShowHideDetailsButton)}if(this.getShowDetailsButton()&&this._isMobileTable){if(this.bHideDetails===undefined){this.bHideDetails=true}if(!this._oShowHideDetailsButton){this._createShowHideDetailsButton()}this._oToolbar.addContent(this._oShowHideDetailsButton)}};Dt.prototype._addTablePersonalisationToToolbar=function(){var t;if(this._oTablePersonalisationButton){this._oToolbar.removeContent(this._oTablePersonalisationButton)}if(this.getUseTablePersonalisation()){if(!this._oTablePersonalisationButton){t=i.getLibraryResourceBundle("sap.ui.comp").getText("TABLE_PERSOBTN_TOOLTIP");this._oTablePersonalisationButton=new b(this.getId()+"-btnPersonalisation",{icon:"sap-icon://action-settings",text:t,tooltip:t,press:[function(t){if(!this._bPersDialogOpen){this._bPersDialogOpen=true;this._bMissingColumnsCreated=true;this._oPersController.openDialog()}},this]});o.addConfig(this._oTablePersonalisationButton,{messageBundleKey:N.os.macintosh?"SMARTTABLE_SHORTCUT_SHOW_SETTINGS_MAC":"SMARTTABLE_SHORTCUT_SHOW_SETTINGS"},this);this._oTablePersonalisationButton.addStyleClass("sapUiCompSmartTableToolbarContent");this._oTablePersonalisationButton.setVisible(this.getShowTablePersonalisation());St.setSemanticStepname(this._oTablePersonalisationButton,"press","sc:tbl:p13n")}this._oToolbar.addContent(this._oTablePersonalisationButton)}};Dt.prototype._triggerGWExport=function(){var t=i.getLibraryResourceBundle("sap.ui.comp");var e=function(){var t=this._getRowBinding();var e=t.getDownloadUrl("xlsx");e=this._removeExpandParameter(e);var i={url:e};this.fireBeforeExport({exportSettings:i});it(i.url)}.bind(this);var o=this._getRowBinding();var a=o?o.getCount():0;if(a>1e4){d.confirm(t.getText("DOWNLOAD_CONFIRMATION_TEXT",a),{actions:[d.Action.YES,d.Action.NO],onClose:function(t){if(t===d.Action.YES){e()}}})}else{e()}};Dt.prototype._addExportToExcelToToolbar=function(){if(this._oExportButton){this._oToolbar.removeContent(this._oExportButton)}if(!this.getEnableExport()){return}if(!this._oExportButton){var t=this.getId()+"-btnExcelExport";var e="sap-icon://excel-attachment";var o=i.getLibraryResourceBundle("sap.ui.comp");if(this.getExportType().indexOf("UI5Client")>-1){this._oExportButton=this._createClientExportButton(t,e)}else if(this._bTableSupportsExcelExport&&this.getExportType()=="GW"){var a;a=o.getText("TABLE_EXPORT_TEXT");this._oExportButton=new b(t,{icon:e,text:a,tooltip:a,press:[this._triggerGWExport,this]});St.setSemanticStepname(this._oExportButton,"press","OI:QE")}this._setExcelExportEnableState();if(this._oExportButton){this._oExportButton.addStyleClass("sapUiCompSmartTableToolbarContent")}}this._oToolbar.addContent(this._oExportButton)};Dt.prototype._createClientExportButton=function(t,e){var a=i.getLibraryResourceBundle("sap.ui.comp");var n={fileName:this.getHeader()};if(!this._cachedExcelSettings){this._cachedExcelSettings=n}var r=new $(t,{icon:e,tooltip:a.getText("TABLE_EXPORT_TEXT"),type:vt[ot.get({name:"_sap_ui_comp_SmartTable_ExportButton"})],buttonMode:Pt.Split,useDefaultActionOnly:true,text:a.getText("QUICK_EXPORT"),defaultAction:[function(){this._triggerUI5ClientExport()},this],menu:[new X({items:[new Y({text:a.getText("QUICK_EXPORT"),press:[function(){this._triggerUI5ClientExport()},this]}),new Y({text:a.getText("EXPORT_WITH_SETTINGS"),press:[function(){this._triggerUI5ClientExport(true)},this]})]})]});St.setSemanticStepname(r,"defaultAction","OI:QE");St.setSemanticStepname(r.getMenu().getItems()[0],"press","OI:QE");St.setSemanticStepname(r.getMenu().getItems()[1],"press","OI:EXP:SETTINGS");o.addConfig(r._getButtonControl(),{addAccessibilityLabel:true,messageBundleKey:N.os.macintosh?"SMARTTABLE_SHORTCUT_EXPORT_TO_EXCEL_MAC":"SMARTTABLE_SHORTCUT_EXPORT_TO_EXCEL"},this);return r};Dt.prototype.onkeydown=function(t){if(t.isMarked()){return}if((t.metaKey||t.ctrlKey)&&t.shiftKey&&t.which===n.E){if(this.getUseExportToExcel()&&this.getExportType().indexOf("UI5Client")>-1&&this._oExportButton&&this._oExportButton.getEnabled()){this._triggerUI5ClientExport(true);t.setMarked();t.preventDefault()}}else if((t.metaKey||t.ctrlKey)&&t.which===n.COMMA){if(this.getUseTablePersonalisation()&&this._oTablePersonalisationButton&&this._oTablePersonalisationButton.getVisible()){this._oPersController.openDialog();t.setMarked();t.preventDefault()}}};Dt.prototype.onThemeChanged=function(){if(this._oExportButton){var t=vt[ot.get({name:"_sap_ui_comp_SmartTable_ExportButton"})];this._oExportButton.setType(t)}};Dt.prototype._getColumnLabel=function(t){var e,i;if(typeof t==="string"){e=t;t=this._getColumnByKey(t)}if(!t){var o=this._oTableProvider.getFieldLabel(this.getEntitySet(),e);if(o&&o.match(/{@i18n>.+}/gi)){var a=this.getModel("@i18n");if(a&&a.isA("sap.ui.model.resource.ResourceModel")){return a.getProperty(o.slice(1,-1).substring(6))||o}}if(!o){var n=this._mFieldMetadataByKey[e];if(n){o=n.label}}return o}if(t.getLabel){i=t.getLabel()}else if(t.getHeader){i=t.getHeader()}return i&&i.getText?i.getText():null};Dt.prototype._getColumnLeadingProperty=function(t,e){var i;if(t.getLeadingProperty){i=t.getLeadingProperty()}if(!i){var o=e||t.data("p13nData");if(o){i=o["leadingProperty"]}}return i};Dt.prototype._triggerUI5ClientExport=function(t){var e=this;var o,a,n,r,s,l;s=i.loadLibrary("sap.ui.export",true);s.catch(function(){d.error(i.getLibraryResourceBundle("sap.ui.comp").getText("SMARTTABLE_ERROR_MISSING_EXPORT_LIBRARY"))});o=this._createExportColumnConfiguration();if(!o||!o.length){d.error(i.getLibraryResourceBundle("sap.ui.comp").getText("SMARTTABLE_NO_COLS_EXPORT"),{styleClass:this.$()&&this.$().closest(".sapUiSizeCompact").length?"sapUiSizeCompact":""});return}l=this._getRowBinding();n=this._getColumnLabel.bind(this);r={workbook:{columns:o,context:{title:this.getHeader()}},dataSource:l,fileName:this.getHeader()};a=function(t){var i=t.getParameter("filterSettings");i.forEach(function(t){var i=t.getProperty();var o=e._getColumnByKey(i)||e._getColumnFromP13nMap(i);t.setLabel(n(i));if(o?.data("p13nData")){t.setType(o.data("p13nData").typeInstance)}});e.fireBeforeExport({exportSettings:t.getParameter("exportSettings"),userExportSettings:t.getParameter("userExportSettings"),filterSettings:i})};s.then(function(){sap.ui.require(["sap/ui/export/ExportHandler"],function(i){var o,s,l;if(!e._oExportHandler){s=e._oTableProvider.getExportCapabilities(e.getExportType());o=new i(s);o.attachBeforeExport(a);e._oExportHandler=o}l=(t?e._oExportHandler.exportAs:e._oExportHandler.export).bind(e._oExportHandler);l(r,n)})})};Dt.prototype._createExportColumnConfiguration=function(){const t=[];const e=this.data("useUTCDateTime");let i;if(e!=null){if(typeof e==="string"){i=e==="true"}else if(typeof e==="boolean"){i=e}}const o=this._oTable.getColumns(!!this._isMobileTable);o.filter(t=>t.getVisible()).forEach(e=>{const o=this._getExportColumnConfiguration(e,i);if(o){t.push(o)}});return t};Dt.prototype._getExportColumnConfiguration=function(t,e){let i=this._getColumnLeadingProperty(t);if(Array.isArray(i)){i=i[0]}if(!i){return undefined}const o=t.data("p13nData");const a=this._getColumnLabel(t);const n=t.getWidth().toLowerCase()||o.width;let r=o.typeInstance;let s=o.type==="numeric"?"Number":o.type;let l,u,h,d;if(o.unit){s=o.isCurrency?"Currency":"Number";d=o.unit}else if(r&&(r.isA("sap.ui.comp.odata.type.FiscalDate")||r.isA("sap.ui.comp.odata.type.CalendarDate"))){var p=r.getFormatter();u=p.getTemplate().replace(/\$(\d)/g,(t,e)=>`{${parseInt(e)-1}}`);l=p.getRegExPattern().toString().slice(1,-1);s="String"}else if(s!="date"&&H.isDateOrTime(o.edmType)){s=H.getTypeName(o.edmType);if(s==="DateTimeOffset"){s="DateTime";e=false;if(o.timezone){h=o.timezone}else if(typeof o.additionalProperty==="string"){[h]=o.additionalProperty.split(",")}}}else if(s==="stringdate"){s="Date";l="YYYYMMDD"}else if(s==="boolean"){s="Boolean";r=r?r:H.getType(o.edmType)}else if(o.description){s="String";u=R.getFormattedExpressionFromDisplayBehaviour(o.displayBehaviour,"{0}","{1}");if(o.displayBehaviour==="descriptionOnly"){i=o.description}else if(o.displayBehaviour!=="idOnly"){i=[i,o.description]}}else if(o.isDigitSequence){s="Number"}else if(o.isTimezone){s="Timezone"}else if(s){s=s.slice(0,1).toUpperCase()+s.slice(1)}else{s="String"}return{columnId:t.getId(),property:i,type:s,inputFormat:l,label:a,width:n,textAlign:t.getHAlign(),template:u,trueValue:s==="Boolean"&&r?r.formatValue(true,"string"):undefined,falseValue:s==="Boolean"&&r?r.formatValue(false,"string"):undefined,unitProperty:d,displayUnit:s==="Currency"?true:undefined,precision:o.precision,scale:o.scale,autoScale:s==="Number",utc:s==="DateTime"&&e!=null?e:undefined,timezoneProperty:h}};Dt.prototype._removeExpandParameter=function(t){var e=t.replace(new RegExp("([\\?&]\\$expand=[^&]+)(&?)"),function(t,e,i){return i?e.substring(0,1):""});return e};Dt.prototype._setExcelExportEnableState=function(){if(this._oExportButton){this._oExportButton.setEnabled(!rt.isEmpty(this._getRowBinding()))}};Dt.prototype._createPersonalizationController=function(){if(this._oPersController||!this.getUseTablePersonalisation()){return}var t=this._oP13nDialogSettings;t=this._setIgnoreFromPersonalisationToSettings(t);t=t||{};if(this._isTreeTable){t.stableColumnKeys=[];t.stableColumnKeys.push(this._aColumnKeys[0])}if(this._bIsFilterPanelEnabled){t.filter=t.filter?t.filter:{};t.filter.createMessageStrip=this._getP13nFilterMessageStrip.bind(this)}this._oPersController=new V(this.getId()+"-persoController",{table:this._oTable,columnKeys:this._aColumnKeys,setting:t,resetToInitialTableState:!this.getUseVariantManagement(),beforePotentialTableChange:[this._beforePersonalisationModelDataChange,this],afterPotentialTableChange:[this._afterPersonalisationModelDataChange,this],afterP13nModelDataChange:[this._personalisationModelDataChange,this],requestColumns:[this._personalisationRequestColumns,this]});this._oPersController.attachDialogAfterClose(function(t){if(this._fGetDataForKeyUser){if(t.getParameter("cancel")){this._fGetDataForKeyUser([])}this._cleanUpKeyUser()}this._bPersDialogOpen=false}.bind(this));if(this._aDeactivatedColumns.length>0){this._oPersController.addToSettingIgnoreColumnKeys(this._aDeactivatedColumns)}};Dt.prototype.getVariantManagement=function(){return this._oVariantManagement};Dt.prototype.openDialogForKeyUser=function(t,e){this._fGetDataForKeyUser=e;return this._oPersController.openDialog({showReset:false,useAvailablePanels:true,styleClass:t}).then(function(t){if(t){return sap.ui.getCore().loadLibrary("sap.ui.mdc",{async:true}).then(function(){sap.ui.require(["sap/ui/mdc/p13n/P13nBuilder"],function(e){return e.addRTACustomFieldButton(t,this)}.bind(this))}.bind(this))}}.bind(this))};Dt.prototype._cleanUpKeyUser=function(){this._fGetDataForKeyUser=null};Dt.prototype._createKeyUserChange=function(){return[{selectorControl:this._oVariantManagement._getPersoController(),changeSpecificData:{changeType:"variantContent",content:{key:this._oVariantManagement.getSelectionKey(),persistencyKey:this.getPersistencyKey(),content:this.fetchVariant()}}}]};Dt.prototype._setIgnoreFromPersonalisationToSettings=function(t){var e=L.createArrayFromString(this.getIgnoreFromPersonalisation());if(e.length){if(!t){t={}}var i=function(i){if(!t[i]){t[i]={}}t[i].ignoreColumnKeys=e};i("filter");i("sort");i("group");i("columns")}return t};Dt.prototype._getRowBinding=function(){if(this._oTable){return this._oTable.getBinding(this._sAggregation)}};Dt.prototype.setEntitySet=function(t){if(this.getEntitySet()===t){return this}if(this._bInitialising){throw new Error("entitySet changed while SmartTable control was initializing - "+this.getId())}this.setProperty("entitySet",t,true);this._initialiseMetadata();return this};Dt.prototype._initialiseMetadata=function(t){var e=this,i=e;if(t){i=t.getSource()}if(!i.bIsInitialised){U.handleModelInit(i,i._onMetadataInitialised,[{selector:i},{selector:i._oTable,changeTypes:["addXML","addXMLAtExtensionPoint"]}])}};function Bt(t){var e=Object.assign({},t);delete e.binding;delete e.modelChangeHandler;delete e.dataStateChangeHandler;delete e.modelRefreshHandler;return e}Dt.prototype._onMetadataInitialised=function(){this._bMetaModelLoadAttached=false;if(this.bIsInitialised){return}this._bUseColumnLabelsAsTooltips=this.getUseColumnLabelsAsTooltips();this._updateInitialColumns();this._fireBeforeInitialiseAndValidate();this._validateCustomizeConfig(this.getCustomizeConfig());this._createTableProvider();if(!this._oTableProvider){return}this._aTableViewMetadata=this._oTableProvider.getTableViewMetadata();if(!this._aTableViewMetadata){return}if(this._bUseColumnLabelsAsTooltips){this._oTable.getColumns().forEach(function(t){var e=null;if(t.getHeader){e=t.getHeader()}else if(t.getLabel){e=t.getLabel()}var i=e&&e.isA&&(e.isA("sap.m.Label")||e.isA("sap.m.Text"))?e:null;var o=this._isMobileTable?i:t;var a=o?o.getTooltip():null;if(o&&i&&!a&&!o.isBound("tooltip")){if(i.isBound("text")){var n=Bt(i.getBindingInfo("text"));o.bindProperty("tooltip",n)}else{o.setTooltip(i.getText())}}},this)}if(this.getEnableAutoColumnWidth()){this._oTable.getColumns().forEach(this._setWidthForCustomColumn,this)}if(!this._isMobileTable&&this.getDemandPopin()){this.setDemandPopin(false);z.error("use SmartTable property 'demandPopin' only  with responsive table, property has been set to false")}this.detachModelContextChange(this._initialiseMetadata,this);this.bIsInitialised=true;delete this._bInitialising;this._updateP13nDialogSettings(true);this._bTableSupportsExcelExport=this._oTableProvider.getSupportsExcelExport();this._bMultiUnitBehaviorEnabled=this._oTableProvider.getMultiUnitBehaviorEnabled();this._listenToSmartFilter();this._createVariantManagementControl();this._createToolbarContent();this._applyToolbarContentOrder();this._aAlwaysSelect=this._oTableProvider.getRequestAtLeastFields();this._createContent();this._createPersonalizationController();this._oEditModel=new x({editable:this.getEditable()});this.setModel(this._oEditModel,"sm4rtM0d3l");this.attachEvent("_change",this._onPropertyChange,this);this.fireInitialise();if(!this._oVariantManagement||this._oVariantManagement&&this._bVariantInitialised){this._checkAndTriggerBinding()}};Dt.prototype._fireBeforeInitialiseAndValidate=function(){if(!this.hasListeners("beforeInitialise")){return}this._bInitialising=true;this.fireEvent("beforeInitialise");this._validateControlConfig();this._updateInitialColumns()};Dt.prototype._validateControlConfig=function(){var t=this.getItems();if(!t.length){throw new Error("Internals of the SmartTable control changed via beforeInitialise event - "+this.getId())}var e=t.find(function(t){return t.isA(["sap.m.Table","sap.ui.table.Table"])});if(!e){throw new Error("Inner Table removed via beforeInitialise event - "+this.getId())}if(e!==this._oTable){throw new Error("Inner table changed via beforeInitialise event for SmartTable - "+this.getId())}};Dt.prototype._updateP13nDialogSettings=function(t){this._oP13nDialogSettings=this._getP13nDialogSettings();this._bIsFilterPanelEnabled=this._oP13nDialogSettings&&this._oP13nDialogSettings.filter?this._oP13nDialogSettings.filter.visible!==false:true;this._bIsSortPanelEnabled=this._oP13nDialogSettings&&this._oP13nDialogSettings.sort?this._oP13nDialogSettings.sort.visible!==false:true;this._bIsGroupPanelEnabled=this._oP13nDialogSettings&&this._oP13nDialogSettings.group?this._oP13nDialogSettings.group.visible!==false:true;this._bIsColumnsPanelEnabled=this._oP13nDialogSettings&&this._oP13nDialogSettings.columns?this._oP13nDialogSettings.columns.visible!==false:true;if(t){this._attachTableCustomFilter()}};Dt.prototype._checkAndTriggerBinding=function(){if(!this._bAutoBindingTriggered){this._bAutoBindingTriggered=true;if(this.getEnableAutoBinding()){if(this._oSmartFilter){if(this._oSmartFilter.isInitialised()){this._oSmartFilter.search()}else{this._oSmartFilter.attachEventOnce("initialise",function(){this._oSmartFilter.search()},this)}}else{this._reBindTable()}}}};Dt.prototype._aStaticProperties=["entitySet","ignoredFields","initiallyVisibleFields","ignoreFromPersonalisation","tableType","useTablePersonalisation","enableAutoBinding","persistencyKey","smartFilterId","showDetailsButton","enableAutoColumnWidth","customizeConfig","useColumnLabelsAsTooltips"];Dt.prototype._aToolbarRelatedProperties=["enableExport","exportType","showFullScreenButton","showPasteButton","editTogglable","placeToolbarInTable"];Dt.prototype._onPropertyChange=function(t){var e=t.getParameter("name");if(this._aStaticProperties.indexOf(e)>-1){z.error("Property "+e+" cannot be changed after the SmartTable with id "+this.getId()+" is initialised")}if(this._oToolbar&&this._aToolbarRelatedProperties.indexOf(e)>-1){if(e==="exportType"&&this._oExportButton){this._oExportButton.destroy();this._oExportButton=null}this._createToolbarContent()}};Dt.prototype._createTableProvider=function(){var t,e,i,o,a;e=this.getEntitySet();i=this.getIgnoredFields();t=this.getModel();o=this.data("preserveDecimals");a=this.getCustomizeConfig();if(a){for(var n in a){this["_oCustomizeConfig"+n.charAt(0).toUpperCase()+n.slice(1)]=a[n]}}if(o!=null){if(o==false||typeof o==="string"&&o==="false"){this._bPreserveDecimals=false}else{this._bPreserveDecimals=true}}else{this._bPreserveDecimals=true}if(t&&e){if(this._aExistingColumns.length){if(i){i+=","+this._aExistingColumns.toString()}else{i=this._aExistingColumns.toString()}}this._oTableProvider=new v({entitySet:e,ignoredFields:i,initiallyVisibleFields:this.getInitiallyVisibleFields(),isEditableTable:this.getEditable(),smartTableId:this.getId(),isAnalyticalTable:!!this._isAnalyticalTable,isMobileTable:!!this._isMobileTable,dateFormatSettings:this.data("dateFormatSettings"),useUTCDateTime:this.data("useUTCDateTime"),currencyFormatSettings:this.data("currencyFormatSettings"),defaultDropDownDisplayBehaviour:this.data("defaultDropDownDisplayBehaviour"),useSmartField:this.data("useSmartField"),useSmartToggle:this.data("useSmartToggle"),skipAnnotationParse:this.data("skipAnnotationParse"),lineItemQualifier:this.data("lineItemQualifier"),presentationVariantQualifier:this.data("presentationVariantQualifier"),enableInResultForLineItem:this.data("enableInResultForLineItem"),defaultFilterBarExpanded:this.data("defaultFilterBarExpanded"),defaultShowAllFilters:this.data("defaultShowAllFilters"),_semanticKeyAdditionalControl:this.getAggregation("semanticKeyAdditionalControl"),model:t,semanticObjectController:this.getSemanticObjectController(),showDetailsButton:this.getShowDetailsButton(),enableAutoColumnWidth:this.getEnableAutoColumnWidth(),preserveDecimals:this._bPreserveDecimals,textInEditModeSource:this._oCustomizeConfigTextInEditModeSource,ignoreInsertRestrictions:this._oCustomizeConfigIgnoreInsertRestrictions,clientSideMandatoryCheck:this._oCustomizeConfigClientSideMandatoryCheck})}};Dt.prototype._listenToSmartFilter=function(){var t,e,o=false;t=this.getSmartFilterId();this._oSmartFilter=this._findControl(t,"sap.ui.comp.filterbar.FilterBar");if(this._oSmartFilter){this._oSmartFilter.attachSearch(this._reBindTable,this);this._oSmartFilter.attachFilterChange(this._filterChangeEvent,this);o=true}var a=i.getLibraryResourceBundle("sap.ui.comp"),n,r,s={SMARTTABLE_NO_DATA:a.getText("SMARTTABLE_NO_DATA"),SMARTTABLE_NO_DATA_WITHOUT_FILTERBAR:a.getText("SMARTTABLE_NO_DATA_WITHOUT_FILTERBAR"),SMARTTABLE_NO_RESULTS:a.getText("SMARTTABLE_NO_RESULTS")};if(this._oTable){n=!this._isMobileTable&&this._oTable.getNoData;r="noData";if(!n){n=this._oTable.getNoDataText;r="noDataText"}}if(n){var l=n.call(this._oTable);if(l&&(!this._isMobileTable||!this._oTable.isPropertyInitial(r))){if(Object.values(s).indexOf(l)==-1){this._vCustomNoData=l}}}e=this.getInitialNoDataText();if(e){o=e==="$FILTERBAR";if(!o&&e!=="$NO_FILTERBAR"){this._setNoDataText(e);return}}if(o){this._setNoDataText(s["SMARTTABLE_NO_DATA"])}else{this._setNoDataText(s["SMARTTABLE_NO_DATA_WITHOUT_FILTERBAR"])}};Dt.prototype._filterChangeEvent=function(){if(this._isTableBound()&&this._oSmartFilter&&!this._oSmartFilter.getLiveMode()&&!this._oSmartFilter.isDialogOpen()){this._showOverlay(true)}};Dt.prototype._showOverlay=function(t){if(t){var e={show:true};this.fireShowOverlay({overlay:e});t=e.show}this._oTable.setShowOverlay(t)};Dt.prototype._findControl=function(t,e){var o,a;if(t){o=i.byId(t);if(!o||!o.isA(e)){a=this._getView();if(a){o=a.byId(t)}}if(o&&!o.isA(e)){o=undefined}}return o};Dt.prototype._getView=function(){if(!this._oView){var t=this.getParent();while(t){if(t.isA("sap.ui.core.mvc.View")){this._oView=t;break}t=t.getParent()}}return this._oView};Dt.prototype.rebindTable=function(t){if(this.isInitialised()){this._reBindTable(null,t);return}z.error("rebindTable method called before the SmartTable is initialized. Please execute the UI5 Support Assistant 'SmartTable' rules to get more information",this.getId(),"sap.ui.comp.smarttable.SmartTable")};Dt.prototype._reBindTable=function(t,e){var o,a,n,r,s,l,u=[],h,p,f,g,_,c,m,b={},y={preventTableBind:false};this._bUpdateTableAnnouncement=t&&t.getId&&t.getId()==="search";n=this._getTablePersonalisationData()||{};if(this._oMessageFilter){h=this._oMessageFilter}else{h=n.filters;p=n.excludeFilters}m=n.sorters;if(this._oSmartFilter){l=this._oSmartFilter.getFilters();b=this._oSmartFilter.getParameters()||{}}if(l&&l.length){if(p){u=[new E([l[0],p],true)]}else{u=l}}else if(p){u=[p]}if(h){h=u.concat(h)}else{h=u}f=this._getRequestAtLeastFields();_=this._getRelevantColumnPaths();g=_["select"];g=this._getSemanticObjectBindingPaths(g);if(!g||!g.length){g=f}else{s=f.length;for(r=0;r<s;r++){if(g.indexOf(f[r])<0){g.push(f[r])}}}if(this._mSelectExpandForGroup&&this._mSelectExpandForGroup.select){this._mSelectExpandForGroup.select.forEach(function(t){if(g.indexOf(t)<0){g.push(t)}})}o=this._oTable.getBinding(this._sAggregation);if(g.length){this._adaptTreeBindingParameters(g,b,o);b["select"]=g.toString();c=_["expand"]||[];if(this._mSelectExpandForGroup&&this._mSelectExpandForGroup.expand){this._mSelectExpandForGroup.expand.forEach(function(t){if(c.indexOf(t)<0){c.push(t)}})}if(c.length){b["expand"]=c.join(",")}}b["useBatchRequests"]=true;if(!m){m=[]}y.filters=h;y.sorter=m;y.parameters=b;y.length=undefined;y.startIndex=undefined;y.events={};this.fireBeforeRebindTable({bindingParams:y,messageFilterActive:!!this._oMessageFilter});if(!y.preventTableBind){m=y.sorter;h=y.filters;b=y.parameters;g=y.parameters["select"];if(!g||!g.length){d.error(i.getLibraryResourceBundle("sap.ui.comp").getText("SMARTTABLE_NO_COLS"),{styleClass:this.$()&&this.$().closest(".sapUiSizeCompact").length?"sapUiSizeCompact":""});return}a=this.getTableBindingPath()||"/"+this.getEntitySet();if(this._oTable.resumeUpdateAnalyticalInfo){this._oTable.resumeUpdateAnalyticalInfo(true,false)}this._bDataLoadPending=true;this._bIgnoreChange=false;if(this._bForceTableUpdate){e=true;this._bForceTableUpdate=false}if(!e){if(o&&o.mParameters){var T=b["select"];b["select"]="";var C=o.mParameters["select"];o.mParameters["select"]="";e=!(G(b,o.mParameters,true)&&G(b.custom,o.mParameters.custom)&&!y.length&&!y.startIndex&&a===o.getPath());if(!e){e=!G(T.split(",").sort(),C.split(",").sort())}b["select"]=T;o.mParameters["select"]=C}}if(!this._bNoDataUpdated){this._bNoDataUpdated=true;this._setNoDataText()}else{this._setNoDataText(undefined,(this.getSmartFilterId()||this._bIsFilterPanelEnabled)&&h&&h.length)}if(!o||!this._bIsTableBound||e){Dt._addBindingListener(y,"change",this._onBindingChange,this);Dt._addBindingListener(y,"dataRequested",this._onDataRequested,this);Dt._addBindingListener(y,"dataReceived",this._onDataReceived,this);if(this._isMobileTable){var S=this._oTable?this._oTable.getColumns():[];var v=this._oTemplate?this._oTemplate.getCells():[];if(S.length===v.length){S.forEach(function(t,e){v[e].setBindingContext(t.getVisible()?undefined:null)})}}this._oTable.bindRows({path:a,filters:h,sorter:m,parameters:b,length:y.length,startIndex:y.startIndex,template:this._oTemplate,events:y.events});this._bIsTableBound=true}else{o.sort(m);o.filter(h,"Application")}this._showOverlay(false)}};Dt.prototype._adaptTreeBindingParameters=function(t,e,i){if(!this._isTreeTable){return}if(this._oTable.getExpandFirstLevel){e["numberOfExpandedLevels"]=this._oTable.getExpandFirstLevel()?1:0}if(this._oTable.getRootLevel){e["rootLevel"]=this._oTable.getRootLevel()}if(this._oTable.getCollapseRecursive){e["collapseRecursive"]=this._oTable.getCollapseRecursive()}if(!i||!i.getTreeAnnotation){return}var o={"hierarchy-level-for":i.getTreeAnnotation("hierarchy-level-for"),"hierarchy-parent-node-for":i.getTreeAnnotation("hierarchy-parent-node-for"),"hierarchy-node-for":i.getTreeAnnotation("hierarchy-node-for"),"hierarchy-drill-state-for":i.getTreeAnnotation("hierarchy-drill-state-for")};for(var a in o){if(o[a]&&t.indexOf(o[a])===-1){t.push(o[a])}}};Dt.prototype._onDataRequested=function(t){if(t&&t.getParameter&&t.getParameter("__simulateAsyncAnalyticalBinding")){return}this._bIgnoreChange=true;this.fireDataRequested(t.getParameters())};Dt.prototype._onDataReceived=function(t){if(t&&t.getParameter&&t.getParameter("__simulateAsyncAnalyticalBinding")){return}this._bIgnoreChange=false;this._onDataLoadComplete(t,true);this.fireDataReceived(t)};Dt.prototype._onBindingChange=function(t){if(this._bIgnoreChange){return}var e,i=false;e=t&&t.getParameter?t.getParameter("reason"):undefined;if(!e||e==="filter"||e==="context"||!this._bDataLoadPending&&e==="change"||e==="add"||e==="remove"){i=true}if(e==="change"||i){this._onDataLoadComplete(t,i)}};Dt._addBindingListener=function(t,e,i,o){if(!t.events){t.events={}}if(!t.events[e]){t.events[e]=i.bind(o)}else{var a=t.events[e];t.events[e]=function(){i.apply(o,arguments);a.apply(o,arguments)}}};Dt.prototype._onDataLoadComplete=function(t,e){if(this._bDataLoadPending||e){this._bDataLoadPending=false;this.updateTableHeaderState()}};Dt.prototype._isTableBound=function(){if(this._bIsTableBound){return true}if(this._oTable){return this._oTable.isBound(this._sAggregation)}return false};Dt.prototype.setNoData=function(t){this._oNoData=t;if(this._bNoDataUpdated||this._isTableBound()){this._setNoDataText()}return this};Dt.prototype.getNoData=function(){return this._oNoData};Dt.prototype._setNoDataText=function(t,e){var o=!this._isMobileTable&&this._oTable.setNoData;if(!o){o=this._oTable.setNoDataText}if(!o){return}if(this._bNoDataUpdated&&this._vCustomNoData){o.call(this._oTable,this._vCustomNoData,true);return}var a=t;if(!a){a=this.getNoData()}if(!a){if(e){a=i.getLibraryResourceBundle("sap.ui.comp").getText("SMARTTABLE_NO_RESULTS")}else{a=i.getLibraryResourceBundle("sap.ui.comp").getText("SMARTTABLE_NO_DATA_WITHOUT_FILTERBAR")}}o.call(this._oTable,a,true)};Dt.prototype.updateTableHeaderState=function(){this._refreshHeaderText();this._setExcelExportEnableState()};Dt.prototype._createContent=function(){var t,e=0,i,o,a,n=[];if(this._aExistingColumns&&this._aExistingColumns.length){this._aColumnKeys=[].concat(this._aExistingColumns.reverse())}if(!this._bUseLegacyMenu){if(this.getUseTablePersonalisation()){this._oColumnHeaderPopover=new ut({id:this.getId()+"-columnHeaderMenu"});St.setSemanticStepname(this._oColumnHeaderPopover,"beforeOpen","sc:tbl:p13n:col");this._oQuickActionContainer=new dt;this._oColumnHeaderPopover.addAggregation("_quickActions",this._oQuickActionContainer);this._oItemContainer=new pt;this._oColumnHeaderPopover.addAggregation("_items",this._oItemContainer);this._bMissingColumnsCreated=false;this._oColumnHeaderPopover.attachBeforeOpen(this._createColumnMenuContent,this)}}o=this._parseIndexedColumns();e=this._aTableViewMetadata.length;for(t=0;t<e;t++){i=this._aTableViewMetadata[t];if(i.isInitiallyVisible){this._aColumnKeys.push(i.name)}else{n.push(i.name)}if(!(i.isInitiallyVisible||i.inResult)){this._mLazyColumnMap[i.name]=i}else{a=this._createColumnForField(i);this._oTable.addColumn(a)}this._mFieldMetadataByKey[i.name]=i}this._insertIndexedColumns(o);this._aColumnKeys=this._aColumnKeys.concat(n);if(this._isMobileTable&&this.getEnableAutoColumnWidth()){this.setDemandPopin(true);this._oTable.setFixedLayout("Strict");this._oTable.setContextualWidth("auto");this._oTable.addDependent(new at)}if(!this._isMobileTable){this._oTable._setHideStandardTooltips(true)}this._updateColumnsPopinFeature();if(this.getShowDetailsButton()){this._oTable.setHiddenInPopin(this._getImportanceToHide())}this._storeInitialColumnSettings()};Dt.prototype._createColumnForField=function(t){var e,i;i=this.getId()+"-"+t.name.replace(/[^A-Za-z0-9_.:-]+/g,"_");e=this._createColumn(t,i);t.isColumnCreated=true;e.data("p13nData",{columnKey:t.name,leadingProperty:t.name,additionalProperty:t.additionalProperty,additionalSortProperty:undefined,navigationProperty:t.navigationProperty,sortProperty:t.sortable?t.name:undefined,filterProperty:t.filterable?t.name:undefined,isGroupable:t.sortable&&t.filterable&&t.aggregationRole==="dimension",fullName:t.hasValueListAnnotation?t.fullName:null,type:t.filterType,typeInstance:t.modelType,maxLength:t.maxLength,precision:t.precision,scale:t.scale,align:t.align,edmType:t.type,displayBehaviour:t.displayBehaviour,description:t.description,isDigitSequence:t.isDigitSequence,isCurrency:t.isCurrencyField,isTimezone:t.isTimezone,ignorePaste:false,unit:t.unit,width:t.width,aggregationRole:t.aggregationRole,nullable:t.nullable!=="false",timezone:t.timezone||null});if(t.filterable&&e.setFilterProperty){e.setFilterProperty(t.name)}if(t.sortable&&e.setSortProperty){e.setSortProperty(t.name)}if(!this._bUseLegacyMenu&&!e.getAssociation("headerMenu")){e.setAssociation("headerMenu",this.getId()+"-columnHeaderMenu")}if(this.getEnableAutoColumnWidth()){t.width=e.getWidth();if(this.getEditable()){this._updateColumnWidthForEdit(e,t)}}this._registerContentTemplateEvents(t.template);return e};Dt.prototype._parseIndexedColumns=function(){var t,e,i,o,a,n,r,s,l;var u=this._oTable.getColumns();var h=null;if(this._oTemplate&&this._oTemplate.getCells){h=this._oTemplate.getCells()}if(!u){return null}o=[];e=u.length;for(t=0;t<e;t++){i=u[t];a=i.data("p13nData");n=null;r=null;if(a){n=a.columnIndex;r=a.columnKey}s=-1;if(n!==null&&n!==undefined){s=parseInt(n)}if(!isNaN(s)&&s>-1){if(h){l=h[t];this._oTemplate.removeCell(l)}else{l=null}this._aColumnKeys.splice(t-o.length,1);o.push({index:s,columnKey:r,column:i,template:l});this._oTable.removeColumn(i)}}o.sort(function(t,e){return t.index-e.index});return o};Dt.prototype._insertIndexedColumns=function(t){var e,i,o;if(!t){return}i=t.length;for(e=0;e<i;e++){o=t[e];this._aColumnKeys.splice(o.index,0,o.columnKey);this._oTable.insertColumn(o.column,o.index);if(o.template){this._oTemplate.insertCell(o.template,o.index)}}};Dt.prototype._updateColumnsPopinFeature=function(){if(!this._isMobileTable||!this.getDemandPopin()){return}if(!this._oTable.getAutoPopinMode()){this._oTable.setAutoPopinMode(true)}var t=this._oTable.getColumns(true);if(!t){return}t=t.filter(function(t){return t.getVisible()});t.forEach(function(t){if(t.getPopinDisplay()!="WithoutHeader"){t.setPopinDisplay("Inline")}})};Dt.prototype._storeInitialColumnSettings=function(){var t=L.createArrayFromString(this.getIgnoreFromPersonalisation());this._aInitialSorters=[];L.createSort2Json(this._oTable,this._aInitialSorters,t,this._aTableViewMetadata)};Dt.prototype._deactivateColumnsPopinFeature=function(){if(!this._isMobileTable){return}if(this._oTable.getAutoPopinMode()){this._oTable.setAutoPopinMode(false)}var t=this._oTable.getColumns();if(!t){return}var e,i=t.length;for(var o=0;o<i;o++){e=t[o];e.setDemandPopin(false);e.setMinScreenWidth("1px")}};Dt.prototype._registerContentTemplateEvents=function(t){if(t.isA("sap.ui.comp.SmartToggle")){t=t.getEdit()}if(t&&t.attachChange){t.attachChange(function(t){this.fireFieldChange({changeEvent:t})},this)}};Dt.prototype._updateInitialColumns=function(){var t=this._oTable.getColumns(),e=t.length,i,o;var a=this.getEnableAutoColumnWidth();while(e--){i=t[e];o=i.data("p13nData");if(o&&o.columnKey&&this._aExistingColumns.indexOf(o.columnKey)>=0){continue}if(typeof o==="string"){try{o=JSON.parse(o);i.data("p13nData",o)}catch(t){}}if(o&&o.columnKey){this._aExistingColumns.push(o.columnKey);if(!this._bUseLegacyMenu&&!i.getAssociation("headerMenu")){i.setAssociation("headerMenu",this.getId()+"-columnHeaderMenu");if(!this._isMobileTable){this._mMenuShowEntryMap.set(i,{sort:i.getShowSortMenuEntry(),filter:i.getShowFilterMenuEntry()});i.setShowSortMenuEntry(false);i.setShowFilterMenuEntry(false)}}}if(a&&this._isMobileTable){var n=i.getHeader();if(n&&n.isPropertyInitial("wrapping")&&n.getMetadata().getProperty("wrapping")){n.setWrapping(false)}}}};Dt.prototype._getRelevantColumnPaths=function(){var t={},e=[],i=[],o=this._oTable.getColumns(),a,n=o?o.length:0,r,s,l,u,h;var d=function(t,e,i){var o,a;if(t){a=t.split(",");o=a.length;while(o--){t=a[o];if(t&&e.indexOf(t)<0){e.push(t);if(!this._isAnalyticalTable){var n=this._getColumnFromP13nMap(t);if(n){var r=i?"additionalProperty":"navigationProperty",s=n.data("p13nData"),l=s[r];if(l){d.call(this,l,e,i)}}}}}}};for(a=0;a<n;a++){r=o[a];l=null;if(r.getVisible()||r.getInResult&&r.getInResult()){s=r.data("p13nData");l=this._getColumnLeadingProperty(r,s);if(s){u=s["additionalProperty"];h=s["navigationProperty"]}if(l&&e.indexOf(l)<0){e.push(l)}d.call(this,u,e,true);d.call(this,h,i,false)}}t["select"]=e;t["expand"]=i;return t};Dt.prototype._createTable=function(){var t=this.getItems(),e=t?t.length:0,i,o;this._sAggregation="rows";while(e--){i=t[e];if(i instanceof F||i instanceof p){break}i=null}if(i){this._oTable=i;if(i instanceof D){this._isAnalyticalTable=true}else if(i instanceof p){this._isMobileTable=true;this._oTemplate=i.getItems()&&i.getItems().length>0?i.getItems()[0]:new u;i.removeAllItems()}else if(i instanceof w){this._isTreeTable=true}this._updateInitialColumns()}else{o=this.getId()+"-ui5table";if(this.getTableType()==="AnalyticalTable"){this._isAnalyticalTable=true;this._oTable=new D(o,{enableCustomFilter:true})}else if(this.getTableType()==="ResponsiveTable"){this._isMobileTable=true;this._oTable=new p(o,{growing:true,autoPopinMode:this.getDemandPopin()});this._oTemplate=new u}else if(this.getTableType()==="TreeTable"){this._isTreeTable=true;this._oTable=new w(o,{selectionMode:"MultiToggle"})}else{this._oTable=new F(o,{selectionMode:"MultiToggle"})}if(!this._isMobileTable){Ft(this._oTable)}this.insertItem(this._oTable,2)}this._oTableReady.resolve(this._oTable);this._fColumnPaddingBorder=this._isMobileTable?1:1.1875;if(!this._oTable.getLayoutData()){let t=false;if(!this._isMobileTable){const e=this._oTable.getRowMode();if(!e){t=this._oTable.getVisibleRowCountMode()==="Auto"}if(e){t=e==="Auto"||e.isA("sap.ui.table.rowmodes.Auto")}}if(this._oTable instanceof p||t){this._oTable.setLayoutData(new C({growFactor:1,baseSize:"auto"}))}else{this._oTable.setLayoutData(new C({growFactor:1,baseSize:"0%"}))}}this._oTable.addStyleClass("sapUiCompSmartTableInnerTable");this._oTable.setEnableBusyIndicator(true);this._oTable.setBusyIndicatorDelay(100);if(this._oTable.setEnableCustomFilter){this._oTable.setEnableCustomFilter(this.getEnableCustomFilter())}if(this._oTable.setShowColumnVisibilityMenu){this._oTable.setShowColumnVisibilityMenu(false)}this._attachTableCustomFilter();if(this._isAnalyticalTable){this._createColumn=this._createAnalyticalColumn}else if(this._isMobileTable){if(this.getUseTablePersonalisation()){this._oTable.bActiveHeaders=true;this._oTable.attachEvent("columnPress",this._onColumnPress,this)}this._sAggregation="items";this._createColumn=this._createMobileColumn;this._oTable.bindRows=this._oTable.bindItems;if(this.getShowDetailsButton()){this._oTable.attachEvent("popinChanged",this._onPopinChanged,this)}}if(!this._isMobileTable){this._oTable.attachRowsUpdated(function(){this._setExcelExportEnableState()},this)}if(this._oTable._setLargeDataScrolling){this._oTable._setLargeDataScrolling(true)}this._oTable.attachPaste(this._onInnerTablePaste,this)};function Ft(t){if(t.setVisibleRowCountMode){t.setVisibleRowCountMode("Auto");return}t.setRowMode("Auto")}Dt.prototype._attachTableCustomFilter=function(){if(this._oTable.detachCustomFilter){this._oTable.detachCustomFilter(this._onCustomFilter,this)}if(this._oTable.getEnableCustomFilter&&this._oTable.getEnableCustomFilter()&&this._bIsFilterPanelEnabled){if(this._oTable.setEnableCellFilter){this._oTable.setEnableCellFilter(false)}if(this._oTable.attachCustomFilter){this._oTable.attachCustomFilter(this._onCustomFilter,this)}}};Dt.prototype._createResponsivePopover=function(t){this._oFilterButton=new q({text:i.getLibraryResourceBundle("sap.ui.comp").getText("SMARTTABLE_RP_FILTER"),icon:"sap-icon://filter",press:[function(t){this._onCustomFilter(t)},this]});var e=i.getLibraryResourceBundle("sap.ui.comp");this._aSortButton=[new nt({label:e.getText("SMARTTABLE_RP_SORT_ASCENDING"),icon:"sap-icon://sort-ascending",action:[true,this._onCustomSort,this]}),new nt({label:e.getText("SMARTTABLE_RP_SORT_DESCENDING"),icon:"sap-icon://sort-descending",action:[false,this._onCustomSort,this]})];this._oColumnHeaderPopover=new j({items:[this._aSortButton,this._oFilterButton]});if(t){this._oColumnHeaderPopover.addItem(new q({text:i.getLibraryResourceBundle("sap.ui.comp").getText("SMARTTABLE_RP_RESIZE"),icon:"sap-icon://resize-horizontal",press:[function(){at.getPlugin(this._oTable).startResizing(this._oColumnClicked.getDomRef())},this]}))}};Dt.prototype._createColumnMenuContent=function(t){var e=i.getLibraryResourceBundle("sap.ui.comp");var o=t.getParameter("openBy");var a=o.data("p13nData");var n;var r=window.matchMedia("(hover:none)").matches&&this._isMobileTable&&this.getEnableAutoColumnWidth();this._oColumnClicked=o;this._oQuickActionContainer.removeAllAggregation("quickActions");this._oItemContainer.removeAllAggregation("items");if(!this._bMissingColumnsCreated){this._oPersController&&this._oPersController.preparePersonalization();this._bMissingColumnsCreated=true}if(this.getUseTablePersonalisation()){n=this._mMenuShowEntryMap.get(o);if(this._isMobileTable||!this._aExistingColumns.includes(a.columnKey)||n&&n.sort){if(!this._oQuickSort){this._oQuickSort=this._createQuickSort(o)}this._updateQuickSort(o);this._oQuickActionContainer.addQuickAction(this._oQuickSort)}if(this._isMobileTable){if(!this._oQuickGroup){this._oQuickGroup=this._createQuickGroup(o)}this._updateQuickGroup(o);this._oQuickActionContainer.addQuickAction(this._oQuickGroup)}var s=this._oPersController.getColumnMap();if(this._bIsSortPanelEnabled&&L.hasSortableColumns(s)){if(!this._oSortItem){this._oSortItem=this._createSortItem(e)}this._oItemContainer.addItem(this._oSortItem)}if(this._bIsFilterPanelEnabled&&L.hasFilterableColumns(s)&&(this._isMobileTable||!this._aExistingColumns.includes(a.columnKey)||n&&n.filter)){if(!this._oFilterItem){this._oFilterItem=this._createFilterItem(e)}this._oItemContainer.addItem(this._oFilterItem)}if((this._isAnalyticalTable||this._isMobileTable)&&this._bIsGroupPanelEnabled&&L.hasGroupableColumns(s)){if(!this._oGroupItem){this._oGroupItem=this._createGroupItem(e)}this._oItemContainer.addItem(this._oGroupItem)}if(this._bIsColumnsPanelEnabled){if(!this._oColumnsItem){this._oColumnsItem=this._createColumnsItem(e)}this._oItemContainer.addItem(this._oColumnsItem)}if(r){if(!this._oQuickResize){this._oQuickResize=this._createQuickResize(e)}this._oQuickActionContainer.addQuickAction(this._oQuickResize)}}};Dt.prototype._createQuickGroup=function(t){return new ct({items:[],change:[function(t){var e=t.getParameter("item"),i=this._getColumnFromP13nMap(e.getKey());if(!i){return}this._onCustomGroup(t,e.getGrouped(),i)},this]})};Dt.prototype._createQuickSort=function(t){return new gt({items:[],change:[function(t){var e=t.getParameter("item"),i=e.getSortOrder(),o=this._getColumnFromP13nMap(e.getKey());if(!o){return}if(i===Mt.None){var a=o.data("p13nData");this._onCustomSort(t,a.sorted&&a.sorted.ascending,o)}else{this._onCustomSort(t,i===Mt.Ascending,o)}},this]})};Dt.prototype._updateQuickGroup=function(t){var e=t.data("p13nData");var i;this._oQuickGroup.destroyItems();if(e.unit||e.displayBehaviour!=="descriptionOnly"){var o=this._getColumnSortProperty(t);i=this._getColumnFromP13nMap(o);if(o&&i){this._oQuickGroup.addItem(new mt({key:o,label:this._getColumnLabel(t),grouped:e.grouped}))}}if(e.displayBehaviour!=="idOnly"&&e.description){i=this._getColumnFromP13nMap(e.description);if(i){this._oQuickGroup.addItem(new mt({key:e.description,label:this._getColumnLabel(i),grouped:i.data("p13nData").grouped}))}}if(e.unit){i=this._getColumnFromP13nMap(e.unit);if(i){this._oQuickGroup.addItem(new mt({key:e.unit,label:this._getColumnLabel(i),grouped:i.data("p13nData").grouped}))}}};Dt.prototype._updateQuickSort=function(t){var e=t.data("p13nData");var i;this._oQuickSort.destroyItems();if(e.unit||e.displayBehaviour!=="descriptionOnly"){var o=this._getColumnSortProperty(t);i=this._getColumnFromP13nMap(o);if(o&&i){this._oQuickSort.addItem(new _t({key:o,label:this._getColumnLabel(t),sortOrder:wt(i.data("p13nData"))}))}}if(e.displayBehaviour!=="idOnly"&&e.description){i=this._getColumnFromP13nMap(e.description);if(i&&this._getColumnSortProperty(i)){this._oQuickSort.addItem(new _t({key:e.description,label:this._getColumnLabel(i),sortOrder:wt(i.data("p13nData"))}))}}if(e.unit){i=this._getColumnFromP13nMap(e.unit);if(i&&this._getColumnSortProperty(i)){this._oQuickSort.addItem(new _t({key:e.unit,label:this._getColumnLabel(i),sortOrder:wt(i.data("p13nData"))}))}}if(e.additionalProperty&&e.additionalSortProperty){var a=e.additionalProperty.split(",");var n=e.additionalSortProperty.split(",");n.forEach(function(t){t=t.trim();if(a.indexOf(t)===-1){return}i=this._getColumnFromP13nMap(t);if(i&&this._getColumnSortProperty(i)){this._oQuickSort.addItem(new _t({key:t,label:this._getColumnLabel(i),sortOrder:wt(i.data("p13nData"))}))}}.bind(this))}};Dt.prototype._getColumnSortProperty=function(t){if(!t){return}var e;if(t.getSortProperty){e=t.getSortProperty()}if(!e){var i=t.data("p13nData");if(!i){return}e=i.sortProperty}return e};Dt.prototype._createQuickResize=function(t){return new ft({label:t.getText("SMARTTABLE_RP_RESIZE"),content:new Z({icon:"sap-icon://resize-horizontal",press:[function(){this._oColumnHeaderPopover.close();at.getPlugin(this._oTable).startResizing(this._oColumnClicked.getDomRef())},this]})})};Dt.prototype._createSortItem=function(t){return new ht({label:t.getText("SMARTTABLE_RP_SORT"),icon:"sap-icon://sort",press:[this._showTableSortDialog,this]})};Dt.prototype._createFilterItem=function(t){return new ht({label:t.getText("SMARTTABLE_RP_FILTER"),icon:"sap-icon://filter",press:[this._onCustomFilter,this]})};Dt.prototype._createGroupItem=function(t){return new ht({label:t.getText("SMARTTABLE_RP_GROUP"),icon:"sap-icon://group-2",press:[this._showTableGroupDialog,this]})};Dt.prototype._createColumnsItem=function(t){return new ht({label:t.getText("SMARTTABLE_RP_COLUMNS"),icon:"sap-icon://table-column",press:[this._showTableColumnsDialog,this]})};function wt(t){var e=Mt.None;if(t.sorted){e=t.sorted.ascending?Mt.Ascending:Mt.Descending}return e}Dt.prototype._onColumnPress=function(t){if(!this._bUseLegacyMenu){return}this._oColumnClicked=t.getParameter("column");var e=this._oColumnClicked.data("p13nData");var i=window.matchMedia("(hover:none)").matches&&this._isMobileTable&&this.getEnableAutoColumnWidth();if(!e&&!i){return}var o=e.filterProperty;var a=e.sortProperty;if(!this._oColumnHeaderPopover){this._createResponsivePopover(i)}this._oFilterButton.setVisible(!!o&&this._bIsFilterPanelEnabled);var n=!!a&&this._bIsSortPanelEnabled;this._aSortButton.forEach(function(t){t.setVisible(n)});if(o&&this._bIsFilterPanelEnabled||a&&this._bIsSortPanelEnabled||i){this._oColumnHeaderPopover.removeAllAriaLabelledBy();this._oColumnHeaderPopover.addAriaLabelledBy(this._oColumnClicked.getHeader());this._oColumnHeaderPopover.openBy(this._oColumnClicked)}};Dt.prototype._onCustomSort=function(t,e,i){if(!i){i=this._oColumnClicked}var o=i.data("p13nData");var a,n;if(o){if(o.sorted&&o.sorted.ascending===e){delete o.sorted;n=Mt.None;if(this._isMobileTable){i.setSortIndicator(n)}}else{o.sorted={ascending:e};a=o.sorted;n=a&&a.ascending?Mt.Ascending:Mt.Descending}var r=this._isMobileTable?"_sort":"sort";this._oTable.fireEvent(r,{column:i,sortOrder:n,columnAdded:false})}};Dt.prototype._onCustomGroup=function(t,e,i){if(!i){i=this._oColumnClicked}var o=i.data("p13nData");if(o){o.grouped=e;this._oTable.fireEvent("_group",{groupedColumns:e?[i]:[]})}};Dt.prototype._onCustomFilter=function(t){this._showTableFilterDialog(t.getParameter("column")||this._oColumnClicked)};Dt.prototype._onPopinChanged=function(t){if(!this._oShowHideDetailsButton){this._createShowHideDetailsButton()}var e=t.getParameter("visibleInPopin");var i=t.getParameter("hiddenInPopin");var o=t.getSource().getVisibleItems();var a=e.some(function(t){return this._getImportanceToHide().indexOf(t.getImportance())>-1},this);if(o.length&&(i.length||a)){this._oShowHideDetailsButton.setVisible(true)}else{this._oShowHideDetailsButton.setVisible(false)}};Dt.prototype.getTable=function(){return this._oTable};Dt.prototype._showTableFilterDialog=function(t){if(this._oPersController){var e={filter:{visible:true}};if(t){e.filter["payload"]={column:t}}this._oPersController.openDialog(e)}};Dt.prototype._showTableSortDialog=function(){if(this._oPersController){var t={sort:{visible:true}};this._oPersController.openDialog(t)}};Dt.prototype._showTableGroupDialog=function(){if(this._oPersController){var t={group:{visible:true}};this._oPersController.openDialog(t)}};Dt.prototype._showTableColumnsDialog=function(){if(this._oPersController){var t={columns:{visible:true}};this._oPersController.openDialog(t)}};Dt.prototype._calcColumnWidth=function(t,e,i){var o;if(i===false){o=true}i=Object.assign({label:e?false:true,defaultWidth:e?4:8,padding:this._fColumnPaddingBorder},i);if(!t||o){return i.defaultWidth}var a=0,n=0,r=Math.max(i.min||0,e?1:2),s=Math.max(r,i.max||19),l=t.additionalProperty||"",u=t.displayBehaviour,h=t.modelType,d=t.type||"";if(s<r){return s}if(e||t.unit||!l||u!="descriptionOnly"){if(t.isImageURL||d=="Edm.Byte"||d=="Edm.SByte"){a+=r}else if(h){a+=rt.calcTypeWidth(h,{defaultWidth:i.defaultWidth,maxWidth:i.max})}else{a+=i.defaultWidth}}if(this._isTreeTable&&t.hierarchy&&t.index==0){a+=3}if(!e){t.ownWidth=a=Math.min(a,s)}if(!e&&u!="idOnly"&&l&&this._oTableProvider&&a<s){l.split(",").forEach(function(e){if(e==t.fieldControlProperty){return}var i=this._oTableProvider.getFieldMetadata(e);var o=Object.assign({padding:.4,max:s-a-.4},t.vertical&&{padding:0,max:s});if(e==t.unit){o.min=3}var n=this._calcColumnWidth(i,true,o);if(t.vertical){a=Math.max(n,a)}else{a+=n}},this);if(u=="descriptionOnly"){t.ownWidth=a}else{t.additionalWidth=a-t.ownWidth}}a=a+(i.gap||0);if(i.label){var p=t.label||t.fieldLabel||"";t.labelWidth=n=rt.calcHeaderWidth(p,i.truncateLabel!=false?a:0,s,r)}a=Math.max(r,a,n);a=Math.min(a,s)+i.padding;a=Math.round(a*100)/100;return a};Dt.prototype._fetchAutoColumnWidthConfig=function(t){var e=null;if(this._oCustomizeConfigAutoColumnWidth){if(this._oCustomizeConfigAutoColumnWidth.hasOwnProperty(t.name)){e=this._oCustomizeConfigAutoColumnWidth[t.name]}else if(this._oCustomizeConfigAutoColumnWidth.hasOwnProperty("*")){e=this._oCustomizeConfigAutoColumnWidth["*"]}}if(e&&e===true){e=null}return e};Dt.prototype._setWidthForCustomColumn=function(t){var e=t.data("p13nData");if(!this._oTableProvider||!e||!e.autoColumnWidth||t.getWidth()){return}var i=e.autoColumnWidth;var o=i.visibleProperty||typeof e.additionalProperty==="string";var a=i.visibleProperty||[this._getColumnLeadingProperty(t,e),e.additionalProperty].join(",");var n=a.split(",");var r=this._oTableProvider.getFieldMetadata(n.shift(),true);if(!r){return}var s=Object.assign({},r);s.label=this._getColumnLabel(t);if(o){s.additionalProperty=n?n.join(","):""}var l=this._calcColumnWidth(s,false,{truncateLabel:i.truncateLabel,min:i.min,max:i.max,gap:i.gap});r.width=l+"rem";t.setWidth(r.width);if(this.getEditable()){this._updateColumnWidthForEdit(t,r,i)}};Dt.prototype._updateColumnWidthForEdit=function(t,e){if(!e||!e.isColumnCreated||e.type=="Edm.Boolean"||e.semanticObjects){return}var i=this.data("useSmartField")=="true"||this.data("useSmartField")===true;if(i&&e["sap:updatable"]=="false"){return}var o=t.getWidth();if(!this.getEditable()){if(e.editWidth==o){t.setWidth(e.width)}}else if(e.width==o){if(e.editWidth){return t.setWidth(e.editWidth)}if(!this._aEditableColumnAdditionalWidth){var a=this._fColumnPaddingBorder;var n=this.$().closest(".sapUiSizeCompact").length?"_Compact":"";var r=parseFloat(ot.get({name:"_sap_m_InputBase"+n+"_IconWidth"}));a+=parseFloat(ot.get({name:"_sap_m_InputBaseWrapper_Sum_Border"}));a+=parseFloat(ot.get({name:"_sap_m_InputBase"+n+"_InnerPadding"}).split(" ").pop())*2;this._aEditableColumnAdditionalWidth=[a,a+r-.25]}var s=(e.displayBehaviour||"").includes("And");var l=(e.labelWidth||0)+this._fColumnPaddingBorder;if(i&&s&&e.additionalWidth&&e.hasValueListAnnotation&&!e.hasFixedValues){e.editWidth=Math.max(e.ownWidth+this._aEditableColumnAdditionalWidth[1],l)+"rem";return t.setWidth(e.editWidth)}var u=e.isCalendarDate||H.isDateOrTime(e.type);var h=e.hasValueListAnnotation||u;var d=this._aEditableColumnAdditionalWidth[+h];if(i&&s&&!e.additionalWidth&&e.hasValueListAnnotation&&e.hasFixedValues){d=Math.max(e.ownWidth+3+d,l)}else if(e.ownWidth<4||u){d+=e.ownWidth}else{d+=2}var p=parseFloat(o);if(p<d){e.editWidth=d+"rem";t.setWidth(e.editWidth)}}};Dt.prototype._updateVisibleColumnsWidthForEdit=function(){if(this._oTable&&this._oTableProvider&&this.getEnableAutoColumnWidth()){this._oTable.getColumns().forEach(function(t){if(t.getVisible()){var e=this._getColumnLeadingProperty(t);if(e){var i=this._oTableProvider.getFieldMetadata(e);i&&this._updateColumnWidthForEdit(t,i)}}},this)}};Dt.prototype._getColumnTooltip=function(t){return this._bUseColumnLabelsAsTooltips?t.quickInfo||t.label:t.quickInfo};Dt.prototype._createColumn=function(t,e){var i=new B(e,{autoResizable:true,hAlign:t.align,width:t.width,visible:t.isInitiallyVisible,label:new h(e+"-header",{textAlign:t.align,text:t.label}),sorted:t.sorted,sortOrder:t.sortOrder,tooltip:this._getColumnTooltip(t),showSortMenuEntry:this._bUseLegacyMenu?t.sortable&&this._bIsSortPanelEnabled:!this.getUseTablePersonalisation(),showFilterMenuEntry:this._bUseLegacyMenu?t.filterable&&this._bIsFilterPanelEnabled:!this.getUseTablePersonalisation(),name:t.fieldName,template:t.template});if(!t.width&&this.getEnableAutoColumnWidth()){var o=this._fetchAutoColumnWidthConfig(t);i.setWidth(this._calcColumnWidth(t,false,o)+"rem")}return i};Dt.prototype._createAnalyticalColumn=function(t,e){if(t.aggregationRole!=="measure"&&t.isMeasureField&&t.unit&&t.template.addStyleClass){t.template.addStyleClass("sapUiAnalyticalTableSumCellHidden sapUiAnalyticalTableGroupCellHidden")}else if(t.isCurrencyField&&t.template.addStyleClass){t.template.addStyleClass("sapUiCompCurrencyBold")}var i=this.getModel(),o=i&&i.getMetaModel();var a=new A(e,{autoResizable:true,hAlign:t.align,width:t.width,visible:t.isInitiallyVisible,inResult:t.inResult,label:new h(e+"-header",{textAlign:t.align,text:t.label}),tooltip:this._getColumnTooltip(t),sorted:t.sorted,sortOrder:t.sortOrder,grouped:t.grouped,showIfGrouped:t.grouped,showSortMenuEntry:this._bUseLegacyMenu?t.sortable&&this._bIsSortPanelEnabled:!this.getUseTablePersonalisation(),showFilterMenuEntry:this._bUseLegacyMenu?t.filterable&&this._bIsFilterPanelEnabled:!this.getUseTablePersonalisation(),summed:t.summed,leadingProperty:t.name,template:t.template,groupHeaderFormatter:R.getInlineGroupFormatterFunction(t,true,this._getDateFormatSettings(),this._bPreserveDecimals,true,o)});if(!t.width&&this.getEnableAutoColumnWidth()){var n=this._fetchAutoColumnWidthConfig(t);a.setWidth(this._calcColumnWidth(t,false,n)+"rem")}return a};Dt.prototype._createMobileColumn=function(e,i){var o=new l(i,{hAlign:e.align,visible:e.isInitiallyVisible,header:new h(i+"-header",{textAlign:e.align,text:e.label,tooltip:this._getColumnTooltip(e),wrapping:!this.getEnableAutoColumnWidth(),wrappingType:t.WrappingType.Hyphenated}),tooltip:this._getColumnTooltip(e)});if(e.importance&&!this._oTableProvider.isLineItemDefaultImportance(e)){o.setImportance(e.importance)}if(this._oTemplate){this._oTemplate.addCell(e.template)}if(e.width){return o.setWidth(e.width)}if(!this.getEnableAutoColumnWidth()){return o.setWidth(e.isImageURL?"3em":"auto")}var a=this._fetchAutoColumnWidthConfig(e);return o.setWidth(this._calcColumnWidth(e,false,a)+"rem")};Dt.prototype.fetchVariant=function(){if(this._oCurrentVariant==="STANDARD"||this._oCurrentVariant===null){return{}}var t=this._processDateFiltersForVariant(this._oCurrentVariant);return t};Dt.prototype.applyVariant=function(t,e){this._oCurrentVariant=t;if(this._oCurrentVariant==="STANDARD"){this._oCurrentVariant=null}this._bApplyingVariant=true;if(this._oTable._setSuppressRefresh){this._oTable._setSuppressRefresh(true)}if(this._oPersController){if(this._oCurrentVariant===null||Ct(this._oCurrentVariant)){this._oPersController.resetPersonalization("ResetFull")}else{this._oPersController.setPersonalizationData(this._oCurrentVariant,true)}}this._bApplyingVariant=false;this.fireAfterVariantApply({currentVariantId:this.getCurrentVariantId()})};Dt.prototype._processDateFiltersForVariant=function(t){if(!this._oPersController){return t}var e=L.getColumnKeysOfType("date",this._oPersController.getColumnMap()),i=L.getColumnKeysOfType("time",this._oPersController.getColumnMap());if(e.length===0||!(t&&t.filter&&t.filter.filterItems)){return t}var o=t.filter.filterItems.map(function(t){if(e.concat(i).includes(t.columnKey)&&this._oTableProvider&&this._oTableProvider.getIsUTCDateHandlingEnabled()){t=Object.assign({},t);if(t.value1 instanceof Date){t.value1=r.localToUtc(t.value1).toISOString();t.value1=t.value1.slice(0,-1)}if(t.value2 instanceof Date){t.value2=r.localToUtc(t.value2).toISOString();t.value2=t.value2.slice(0,-1)}}return t},this);t=Object.assign({},t,{filter:Object.assign({},t.filter,{filterItems:o})});return t};Dt.prototype.variantsInitialized=function(){this._bVariantInitialised=true;this._checkAndTriggerBinding()};Dt.prototype.getUiState=function(){var t=this._oPersController?this._oPersController.getDataSuiteFormatSnapshot():null;return new W({presentationVariant:{SortOrder:t?t.SortOrder:[],GroupBy:t?t.GroupBy:[],Total:t?t.Total:[],RequestAtLeast:this._getRequestAtLeastFields(),Visualizations:t?t.Visualizations:[]},selectionVariant:{SelectOptions:t?t.SelectOptions:[]},variantName:this.getCurrentVariantId()})};Dt.prototype.setUiState=function(t){this._setUiState(t,false)};Dt.prototype.setUiStateAsVariant=function(t){this._setUiState(t,true)};Dt.prototype._setUiState=function(t,e){var i=t.getPresentationVariant()&&t.getPresentationVariant().RequestAtLeast?[].concat(t.getPresentationVariant().RequestAtLeast):[];if(!G(i,this._getRequestAtLeastFields())){this._aAlwaysSelect=i}if(this._oPersController){if(e){this._oPersController.setPersonalizationDataAsDataSuiteFormat(Q({},t.getPresentationVariant(),t.getSelectionVariant()),true)}else{var o=this._oVariantManagement&&t.getVariantName()?this._oVariantManagement.getVariantContent(this,t.getVariantName()):{};this._oPersController.setDataSuiteFormatSnapshot(Q({},t.getPresentationVariant(),t.getSelectionVariant()),o,true)}}};Dt.prototype._getRequestAtLeastFields=function(){var t=this.getRequestAtLeastFields();var e=t?t.split(","):[];return e.concat(this._aAlwaysSelect)};Dt.prototype._personalisationRequestColumns=function(t){var e=t.getParameter("columnKeys"),i,o,a,n,r,s={};a=e.length;for(o=0;o<a;o++){i=e[o];n=this._mLazyColumnMap[i];if(n){r=this._createColumnForField(n);if(this._isMobileTable){this._oTable.addColumn(r)}s[n.name]=r}}this._oPersController.addColumns(s)};Dt.prototype._beforePersonalisationModelDataChange=function(t){if(this._oTable.suspendUpdateAnalyticalInfo){this._oTable.suspendUpdateAnalyticalInfo()}};Dt.prototype._afterPersonalisationModelDataChange=function(t){this._updateColumnsPopinFeature();this._createInfoToolbar();if(this.getEditable()){this._updateVisibleColumnsWidthForEdit()}};Dt.prototype._personalisationModelDataChange=function(t){this._oCurrentVariant=t.getParameter("persistentData");if(this._fGetDataForKeyUser){this._fGetDataForKeyUser(this._createKeyUserChange())}var e=t.getParameter("runtimeDeltaDataChangeType");var i=this._getChangeStatus(e);if(i==="Unchanged"){return}if(!(this._bApplyingVariant||this._bDeactivatingColumns)){if(!this.getUseVariantManagement()){this._persistPersonalisation()}else if(this._oVariantManagement){this._oVariantManagement.currentVariantSetModified(true)}}if(this._isTableBound()){if(i==="ModelChanged"){if(e&&e.columns==="ModelChanged"){this._bForceTableUpdate=true;var o;if(this._isMobileTable&&this._oTable.getHiddenInPopin()){o=t.getParameter("runtimeDeltaData").columns.columnsItems.some(function(t){var e=this._getColumnByKey(t.columnKey);if(e&&t.visible){return this._oTable.getHiddenInPopin().includes(e.getImportance())}},this)}if(o){this._toggleShowHideDetails(false)}}if(this._oSmartFilter){this._oSmartFilter.search()}else{this._reBindTable(null)}}else if(i==="TableChanged"&&this._isMobileTable&&this.getEditable()){this._updateMobileHiddenCellBindingContext(t)}}this._adaptCustomSort();this._adaptCustomGroup();this._createInfoToolbar();this.fireUiStateChange()};Dt.prototype._updateMobileHiddenCellBindingContext=function(t){var e=i.getMessageManager().getMessageModel().getData();if(!e.length){return}var o=e.filter(function(t){return t.validation===true});if(!o.length){return}var a=t.getParameter("runtimeDeltaData").columns.columnsItems.filter(function(t){return t.visible===false});a.forEach(function(t){var o=this._getColumnByKey(t.columnKey),a=this._oTemplate.getCells()[this._oTable.indexOfColumn(o)],n;if(a.isA("sap.ui.comp.SmartToggle")){var r=a.getEdit();n=r.getId()}else{n=a.getId()}if(n){var s=e.find(function(t){var e=t.getControlId();if(e){return e.includes(n)}});if(s){var l=i.byId(s.getControlId());if(l){l.setBindingContext(null)}}}},this)};Dt.prototype._updateSortIndicator=function(t,e,i){var o=this._getSortItemsFromVariant();var a=o.find(function(t){return!!e&&t.sortProperty===e});if(a){if(i){t.setSortIndicator(a.operation)}else{t.setSorted(true);t.setSortOrder(a.operation)}return true}if(!t.data("p13nData").sorted){if(i){t.setSortIndicator(Mt.None)}else{t.setSorted(false);t.setSortOrder(Mt.None)}}return false};Dt.prototype._getSortItemsFromVariant=function(){var t,e=[];if(this._oCurrentVariant.sort&&this._oCurrentVariant.sort.sortItems){this._oCurrentVariant.sort.sortItems.forEach(function(i){t=this._getColumnSortProperty(this._getColumnByKey(i.columnKey));if(t){e.push({sortProperty:t,operation:i.operation})}},this)}return e};Dt.prototype._adaptAdditionalProperties=function(t){var e=t.data("p13nData"),i;if(e.unit||e.displayBehaviour!=="descriptionOnly"){i=this._getColumnSortProperty(t);this._updateSortIndicator(t,i,this._isMobileTable)}if(e.displayBehaviour!=="idOnly"&&e.description){var o=this._getColumnFromP13nMap(e.description);if(this._getColumnSortProperty(o)){i=e.description;this._updateSortIndicator(t,i,this._isMobileTable)}}if(e.unit){var o=this._getColumnFromP13nMap(e.unit);if(this._getColumnSortProperty(o)){i=e.unit;this._updateSortIndicator(t,i,this._isMobileTable)}}if(e.additionalProperty&&e.additionalSortProperty){var a=e.additionalProperty.split(",");var n=e.additionalSortProperty.split(",");n.every(function(e){if(a.indexOf(e)===-1){return false}return!this._updateSortIndicator(t,e,this._isMobileTable)}.bind(this))}};Dt.prototype._updateColumnInfoSort=function(t,e){if(t){if(!e.sorted){e.sorted={ascending:false}}if(t.operation===Mt.None){delete e.sorted}else{e.sorted={ascending:t.operation!==Mt.Descending}}}else if(e&&e.sorted){e.sorted=null}};Dt.prototype._updateColumnInfoGroup=function(t,e){e.grouped=t?true:false};Dt.prototype._adaptCustomSort=function(){if(this._oCurrentVariant){var t,e,i;var o=this._getSortItemsFromVariant();this._oTable.getColumns().forEach(function(a){e=a.data("p13nData");t=e&&e.sortProperty;if(t){if(o.length){i=o.find(function(e){return t===e.sortProperty})}this._updateColumnInfoSort(i,e);this._updateSortIndicator(a,t,this._isMobileTable)}this._adaptAdditionalProperties(a)},this)}};Dt.prototype._adaptCustomGroup=function(){if(this._oCurrentVariant){var t,e,i,o;if(this._oCurrentVariant.group&&this._oCurrentVariant.group.groupItems){o=this._oCurrentVariant.group.groupItems}this._oTable.getColumns().forEach(function(a){e=a.data("p13nData");t=e&&e.sortProperty;if(t){if(o){i=o.find(function(e){return t===e.columnKey})}this._updateColumnInfoGroup(i,e)}},this)}};Dt.prototype.setUseInfoToolbar=function(t){this.setProperty("useInfoToolbar",t,true);if(this.getTable()){this._createInfoToolbar()}return this};Dt.prototype._updateInfoToolbar=function(t){if(!this._oInfoToolbar){this._oInfoToolbar=new _({active:true,visible:true,design:It.Info,content:[new f({id:this.getId()+"-infoToolbarText",text:t,wrapping:false}),new m,new Z({id:this.getId()+"-infoToolbarClearButton",icon:"sap-icon://decline",type:vt.Transparent,press:[this._handleClearAllFilterButtonPress,this],tooltip:sap.ui.getCore().getLibraryResourceBundle("sap.ui.mdc").getText("infobar.REMOVEALLFILTERS")})],ariaLabelledBy:this.getId()+"-infoToolbarText",press:[this._handleInfoToolbarPress,this]})}else{this._oInfoToolbar.setVisible(true);this._oInfoToolbar.getContent()[0].setText(t)}};Dt.prototype._handleInfoToolbarPress=function(t){this._showTableFilterDialog()};Dt.prototype._handleClearAllFilterButtonPress=function(){var t=this._oPersController;var e=t.getDataSuiteFormatSnapshot();e=e||{};e.SelectOptions=undefined;t.setPersonalizationDataAsDataSuiteFormat(e,false);this._updateP13nDialogSettings()};Dt.prototype._createInfoToolbar=function(){var t=this.getUseInfoToolbar(),e=this.getTable(),o=this.getId()+"-infoToolbarText",n,r=i.getLibraryResourceBundle("sap.ui.comp");var s=this._oCurrentVariant?.filter?.filterItems;var l=s&&s.length;if(t===At.Off||!this._isMobileTable&&t===At.Auto){if(this._oInfoToolbar&&this._oInfoToolbar.getVisible()){this._oInfoToolbar.setVisible(false);e.removeAriaLabelledBy(o)}if(l){s.forEach(t=>{n=this._getColumnByKey(t.columnKey);if(n&&n.setFiltered){n.setFiltered(true)}})}return}var u,h;if(this._isMobileTable){u=e.getInfoToolbar();h=e.setInfoToolbar}else{u=e.getExtension().find(t=>t.getDesign&&t.getDesign()===It.Info);h=e.addExtension}if(u&&!this._oInfoToolbar){z.error("Custom infoToolbar is used, hence set useInfoToolbar property on the SmartTable with id='"+this.getId()+"' to Off");return}if(l){var d=[],p=a.getInstance();s.forEach(function(t){n=this._getColumnByKey(t.columnKey);if(n){var e=this._getColumnLabel(t.columnKey);if(e&&d.indexOf(e)===-1){d.push(e)}if(!this._isMobileTable&&n.setFiltered){n.setFiltered(false)}}},this);var f=r.getText("SMARTTABLE_INFOTOOLBAR_FILTER"+(d.length>1?"S":"")+"_ACTIVE",[d.length,p.format(d)]);this._updateInfoToolbar(f);if(!u){h.call(e,this._oInfoToolbar)}if(e.getAriaLabelledBy().indexOf(o)===-1){e.addAriaLabelledBy(o)}}else if(this._oInfoToolbar&&this._oInfoToolbar.getVisible()){this._oInfoToolbar.setVisible(false);e.removeAriaLabelledBy(o)}};Dt.prototype._getChangeStatus=function(t){if(!t){return"ModelChanged"}if(t.sort==="ModelChanged"||t.filter==="ModelChanged"||t.columns==="ModelChanged"||t.group==="ModelChanged"){return"ModelChanged"}if(t.sort==="TableChanged"||t.filter==="TableChanged"||t.columns==="TableChanged"||t.group==="TableChanged"){return"TableChanged"}return"Unchanged"};Dt.prototype._getDateFormatSettings=function(){if(this._oTableProvider&&this._oTableProvider._oDateFormatSettings){return this._oTableProvider._oDateFormatSettings}return undefined};Dt.prototype._getTablePersonalisationData=function(){this._mSelectExpandForGroup=null;if(!this._oCurrentVariant){return null}var t=[],e=[],i=[],o,a,n,l,u,h,d,p,f,g,_={},c={},m="",b;if(this._isMobileTable&&this._oCurrentVariant.group&&this._oCurrentVariant.group.groupItems){a=this._oCurrentVariant.group.groupItems[0];if(this._aDeactivatedColumns.indexOf(a.columnKey)<0){u=this._getColumnByKey(a.columnKey);if(u){m=u.getHeader().getText()}g=this._getPathFromColumnKeyAndProperty(a.columnKey,"sortProperty")}if(g){d=g;p=null;var y=this._mFieldMetadataByKey[a.columnKey],T;if(y){p=y.unit||y.description;var C=this.getModel(),S=C&&C.getMetaModel();T=R.getInlineGroupFormatterFunction(y,false,this._getDateFormatSettings(),this._bPreserveDecimals,true,S)}n=new I(d,a.operation==="GroupDescending",function(t){var e=t.getProperty(d),i;if(T){if(p){i=t.getProperty(p)}e=T(e,i)}if(e===undefined||e===null){e=""}return{key:e,text:m?m+": "+e:e}});this._mSelectExpandForGroup={select:[d]};if(y){if(y.additionalProperty){this._mSelectExpandForGroup.select.push(y.additionalProperty)}if(y.navigationProperty){this._mSelectExpandForGroup.expand=[y.navigationProperty]}}t.push(n)}}if(this._oCurrentVariant.sort){l=this._oCurrentVariant.sort.sortItems}else{l=this._aInitialSorters}if(l){l.forEach(function(e,i){var o=e.operation==="Descending";g=null;f=null;if(this._aDeactivatedColumns.indexOf(e.columnKey)<0){g=this._getPathFromColumnKeyAndProperty(e.columnKey,"sortProperty");if(!g&&e.initiallyNotVisibleColumn){g=e.columnKey}}if(g){if(n&&n.sPath===g){n.bDescending=o}else{var a=this._mFieldMetadataByKey[g];if(!a){u=this._getColumnByKey(e.columnKey);h=u.data("p13nData")}if(this._bMultiUnitBehaviorEnabled&&(a&&a.isCurrencyField||h&&h.isCurrency)){f=a?a.unit:h.unit;var r=this._mFieldMetadataByKey[f];var s,l;if(!r){s=this._getColumnByKey(f);l=s&&s.data("p13nData")}if(f&&(r&&r.sortable||l&&l.sortProperty===f||s&&s.getSortProperty&&s.getSortProperty()===f)&&!_[f]){_[f]={index:i,descending:o}}}c[g]={};if(c[f]){delete _[f]}else if(_[g]){delete _[g]}t.push(new I(g,o))}}},this);var v=Object.keys(_),P;if(v.length){v.reverse().forEach(function(e){P=n?_[e].index+1:_[e].index;t.splice(P,0,new I(e,_[e].descending))})}}if(this._oCurrentVariant.filter){this._oCurrentVariant.filter.filterItems.forEach(function(t){var o=t.value1,a=t.value2,n;g=null;b=false;u=null;if(this._aDeactivatedColumns.indexOf(t.columnKey)<0){u=this._getColumnByKey(t.columnKey)}if(u){if(u.getFilterProperty){g=u.getFilterProperty()}h=u.data("p13nData");if(h){b=h.type==="time";if(!g){g=h["filterProperty"]}}}if(g){try{var l=this._oTableProvider&&this._oTableProvider.getFieldMetadata(g)}catch(t){}if(b){if(o instanceof Date){o=R.getEdmTimeFromDate(o)}if(a instanceof Date){a=R.getEdmTimeFromDate(a)}}else{var d=h&&h.typeInstance&&h.typeInstance.getName()==="sap.ui.model.odata.type.DateTimeOffset";if(o instanceof Date&&!d&&this._oTableProvider&&this._oTableProvider.getIsUTCDateHandlingEnabled()){o=r.localToUtc(o);if(a){var p=parseInt(l&&l.precision);a=r.localToUtc(a);a=r.adaptPrecision(a,p)}}}var f=t.exclude?i:e;if(t.operation==="Empty"){var _=t.exclude?M.NE:M.EQ,c=false,m=false;if(h.nullable===true||h.nullable==="true"){m=true}else if(h.nullable===undefined&&l&&l.nullable!=="false"){m=true}if(h.edmType==="Edm.String"||h.type==="string"){c=true}else if(!h.edmType&&!h.type&&l&&l.type==="Edm.String"){c=true}if(c){f.push(new E(g,_,""))}if(m){f.push(new E(g,_,null))}}else{n=t.exclude?s.getTransformedExcludeOperation(t.operation):t.operation;f.push(new E(g,n,o,a))}}},this);if(i.length){o=new E(i,true)}}return{filters:e,excludeFilters:o,sorters:t}};Dt.prototype._getColumnByKey=function(t){var e,i,o,a,n;if(this._oTable){e=this._oTable.getColumns();o=e.length;for(a=0;a<o;a++){i=e[a];n=i.data("p13nData");if(n&&n.columnKey===t){return i}}}return null};Dt.prototype._getColumnFromP13nMap=function(t){if(!this._oPersController){return null}const e=this._oPersController.getColumnMap();let i=null;for(const o in e){if(o===t){i=e[o];break}else if(e[o].getLeadingProperty&&e[o].getLeadingProperty()===t){i=e[o];break}else if(e[o].data("p13nData").leadingProperty===t){i=e[o];break}}return i};Dt.prototype._getPathFromColumnKeyAndProperty=function(t,e){var i=null,o,a;o=this._getColumnByKey(t)||this._getColumnFromP13nMap(t);if(o){if(e=="sortProperty"&&o.getSortProperty){i=o.getSortProperty()}else if(e=="filterProperty"&&o.getFilterProperty){i=o.getFilterProperty()}else if(e=="leadingProperty"&&o.getLeadingProperty){i=o.getLeadingProperty()}if(!i){a=o.data("p13nData");if(a){i=a[e]}}}return i};Dt.prototype._persistPersonalisation=function(){var t="Personalisation";if(!i.getConfiguration().getDesignMode()&&this._oVariantManagement&&!this._oVariantManagement.isPageVariant()){var e=this._oVariantManagement.getViewIdByName(t);if(e===null){e=this.getCurrentVariantId()}if(!this._bSaving){this._bSaving=true;this._oVariantManagement.fireSave({name:t,implicit:true,global:false,overwrite:!!e,key:e,def:true});delete this._bSaving}}};Dt.prototype.getCurrentVariantId=function(){return this._oVariantManagement?this._oVariantManagement.getCurrentVariantId():""};Dt.prototype.setCurrentVariantId=function(t){if(this._oVariantManagement&&!this._oVariantManagement.isPageVariant()){this._oVariantManagement.setCurrentVariantId(t)}else{z.error("sap.ui.comp.smarttable.SmartTable.prototype.setCurrentVariantId: VariantManagement does not exist, or is a page variant")}return this};Dt.prototype.setDetailsButtonSetting=function(t){this.setProperty("detailsButtonSetting",t,true);return this};Dt.prototype.setEnablePaste=function(t){this.setProperty("enablePaste",t,true);var e=i.byId(this.getId()+"-btnPaste");if(e){e.setEnabled(this.getEnablePaste())}return this};Dt.prototype.isInitialised=function(){return!!this.bIsInitialised};Dt.prototype._aAvailablePanels=["Columns","Sort","Filter","Group"];Dt.prototype.openPersonalisationDialog=function(t){if(!t||this._aAvailablePanels.indexOf(t)<0){z.warning("sap.ui.comp.smarttable.SmartTable.prototype.openPersonalisationDialog: "+t+" is not a valid panel!");return}if(this._oPersController){var e={};e[t.toLowerCase()]={visible:true};this._oPersController.openDialog(e)}};Dt.prototype.deactivateColumns=function(t){this._aDeactivatedColumns=t||[];this._bDeactivatingColumns=true;if(this._oPersController){this._oPersController.addToSettingIgnoreColumnKeys(this._aDeactivatedColumns)}this._bDeactivatingColumns=false};Dt.prototype.getDeactivatedColumns=function(){return this._aDeactivatedColumns?this._aDeactivatedColumns.slice():[]};Dt.prototype._onInnerTablePaste=function(t){if(!this.getEnablePaste()||!this.hasListeners("beforePaste")&&!this.hasListeners("paste")){return}var e=t.getParameter("data");var i=e.slice(0);var o=this._getColumnInfoForPaste();if(this.fireBeforePaste({columnInfos:o})){sap.ui.require(["sap/ui/core/util/PasteHelper"],function(t){t.parse(i,o).then(function(t){this.firePaste({result:t})}.bind(this))}.bind(this))}};Dt.prototype._getColumnInfoForPaste=function(){var t=[],e=[],i=this._oTable.getColumns(),o,a=i.length,n,r,s,l,u,h,d;if(this._isMobileTable&&i.length){i=i.sort(function(t,e){return t.getOrder()-e.getOrder()})}for(o=0;o<a;o++){n=i[o];s=null;h=null;u=null;d=true;if(n.getVisible()){r=n.data("p13nData");s=this._getColumnLeadingProperty(n,r);l=r.type==="numeric"?"number":r.type;d=!s||r.ignorePaste;if(r.type==="date"){var p=this._getDateFormatSettings();if(p&&p["UTC"]){var f={displayFormat:"Date"};u=H.getType("Edm.DateTime",p,f)}}if(!u){u=r["typeInstance"]}if(r.isCurrency||l==="number"){h=r.unit}else if(r.description&&r.displayBehaviour!=="idOnly"){h=r.description}}var g={columnId:n.getId(),property:s,ignore:d,type:u};if(s){t.push(g)}else{e.push(g)}u=H.getType("Edm.String");if(h){t.push({columnId:n.getId(),additionalProperty:true,property:h,type:u})}}return t.concat(e)};Dt.prototype._getSemanticObjectBindingPaths=function(t){if(!t||!t.length){return t}var e=[];t.forEach(function(i){var o=this._aTableViewMetadata&&this._aTableViewMetadata.find(function(t){return t.name==i});if(o&&o.semanticObjectPath){if(!t.includes(o.semanticObjectPath)){e.push(o.semanticObjectPath)}}},this);return t.concat(e)};Dt.prototype.exit=function(){var t,e;this.detachEvent("_change",this._onPropertyChange,this);if(this._oSmartFilter){this._oSmartFilter.detachSearch(this._reBindTable,this);this._oSmartFilter.detachFilterChange(this._filterChangeEvent,this);this._oSmartFilter=null}if(this._oTableProvider&&this._oTableProvider.destroy){this._oTableProvider.destroy()}this._oTableProvider=null;if(this._oPersController&&this._oPersController.destroy){this._oPersController.destroy()}this._oPersController=null;if(this._oVariantManagement){this._oVariantManagement.detachSave(this._variantSaved,this);this._oVariantManagement.detachAfterSave(this._variantAfterSave,this);if(!this._oVariantManagement.isPageVariant()&&this._oVariantManagement.destroy){this._oVariantManagement.destroy()}}this._oNumberFormatInstance=null;O.cleanUpFullScreen(this);if(this._oEditModel){this._oEditModel.destroy()}if(this._oNoData&&this._oNoData.destroy){this._oNoData.destroy()}this._oNoData=null;if(this._aTableViewMetadata){t=this._aTableViewMetadata.length;while(t--){e=this._aTableViewMetadata[t];if(e&&!e.isColumnCreated&&e.template){e.template.destroy()}}}if(this._oShowHideDetailsButton){this._oShowHideDetailsButton.destroy()}this._oShowHideDetailsButton=null;this._aTableViewMetadata=null;this._mFieldMetadataByKey=null;this._mSelectExpandForGroup=null;this._oEditModel=null;this._oVariantManagement=null;this._oCurrentVariant=null;this._aExistingColumns=null;this._mLazyColumnMap=null;this._aColumnKeys=null;this._aDeactivatedColumns=null;this._aAlwaysSelect=null;this._oCustomToolbar=null;if(this._oToolbar&&!this._bToolbarInsertedIntoItems){this._oToolbar.destroy()}this._oToolbar=null;if(this._oSeparator){this._oSeparator.destroy()}this._oSeparator=null;if(this._oExportButton){this._oExportButton.destroy()}this._oExportButton=null;if(this._oExportHandler){this._oExportHandler.destroy()}this._oExportHandler=null;if(this._oTablePersonalisationButton){this._oTablePersonalisationButton.destroy()}this._oTablePersonalisationButton=null;this._oP13nDialogSettings=null;if(this._oTemplate){this._oTemplate.destroy()}this._oTemplate=null;if(this._oColumnHeaderPopover){this._oColumnHeaderPopover.destroy()}this._oColumnHeaderPopover=null;this._bMissingColumnsCreated=null;this._oFilterButton=null;this._aSortButton=null;this._oInfoToolbar=null;this._oTableReady=null;this._oView=null;this._oTable=null};return Dt});
/*!
 * SAPUI5
 * (c) Copyright 2009-2023 SAP SE. All rights reserved.
 */
sap.ui.predefine("sap/ui/comp/smarttable/flexibility/ToolbarContentMove", ["sap/ui/core/CustomData","sap/ui/fl/changeHandler/condenser/Classification","./Utils"],function(e,t,n){"use strict";function o(e,t,n,o){return new Promise(function(r,a){var i=[];for(var u=0;u<t.length;u++){i.push(e.getProperty(t[u],n))}Promise.all(i).then(function(e){var n=[];for(var a=0;a<e.length;a++){if(e[a]==o){n.push(t[a])}}r(n)})})}function r(e,t,r,a){return new Promise(function(i,u){var s=a?e.getRevertData():e.getContent();var f=r.modifier;f.getAggregation(t,"customData").then(function(u){o(f,u,"key","p13nData_ToolbarContentMove").then(function(o){var u=function(n){f.setProperty(n,"value",s);if(a){e.resetRevertData()}if(t._applyToolbarContentOrder){t._applyToolbarContentOrder()}i()};var l=o.length>0?o[0]:null;if(!l){f.createControl("sap.ui.core.CustomData",r.appComponent,r.view,"testid",{key:"p13nData_ToolbarContentMove",value:null}).then(function(e){var n=f.insertAggregation(t,"customData",e,0,r.view);if(!(n instanceof Promise)){n=Promise.resolve()}n.then(function(){u(e)})})}else{f.getProperty(l,"value").then(function(t){if(!a){e.setRevertData(n.parseChangeContent(t))}u(l)})}})})})}return{applyChange:function(e,t,n){return r(e,t,n,false)},revertChange:function(e,t,n){return r(e,t,n,true)},completeChangeContent:function(e,t,n){},getCondenserInfo:function(e,n){return{affectedControl:e.getSelector(),classification:t.LastOneWins,uniqueKey:"p13nData_ToolbarContentMove"}}}});
/*!
 * SAPUI5
 * (c) Copyright 2009-2023 SAP SE. All rights reserved.
 */
sap.ui.predefine("sap/ui/comp/smarttable/flexibility/Utils", ["sap/ui/fl/Utils","sap/ui/core/util/reflection/JsControlTreeModifier","sap/ui/base/ManagedObjectMetadata"],function(e,t,n){"use strict";var r={getAppComponentForControl:function(t){return e.getAppComponentForControl(t)},getSelectorForControl:function(e,o){if(!o&&!(o===null)){o=r.getAppComponentForControl(e)}if(e&&e.isA&&e.isA("sap.ui.core.Control")&&!n.isGeneratedId(e.getId())){return t.getSelector(e,o)}else{return null}},parseChangeContent:function(e,t){if(typeof e==="string"){try{e=e.replace(/(\\{)/g,"{").replace(/(\\})/g,"}");e=JSON.parse(e);if(t){t(e)}}catch(t){e=null}}return e}};return r});
/*!
 * SAPUI5
 * (c) Copyright 2009-2023 SAP SE. All rights reserved.
 */
sap.ui.predefine("sap/ui/comp/smartvariants/PersonalizableInfo", ["sap/ui/comp/library","sap/ui/core/Element"],function(e,a){"use strict";var t=a.extend("sap.ui.comp.smartvariants.PersonalizableInfo",{metadata:{library:"sap.ui.comp",properties:{type:{type:"string",group:"Misc",defaultValue:null},dataSource:{type:"string",group:"Misc",defaultValue:null},keyName:{type:"string",group:"Misc",defaultValue:null}},associations:{control:{type:"sap.ui.core.Control",multiple:false}}}});return t});
/*!
 * SAPUI5
 * (c) Copyright 2009-2023 SAP SE. All rights reserved.
 */
sap.ui.predefine("sap/ui/comp/smartvariants/SmartVariantManagement", ["sap/ui/thirdparty/jquery","sap/ui/comp/library","sap/ui/comp/variants/VariantItem","sap/ui/comp/odata/ODataModelUtil","sap/ui/comp/odata/MetadataAnalyser","./SmartVariantManagementAdapter","./SmartVariantManagementBase","sap/base/Log","sap/base/util/merge","sap/ui/base/SyncPromise"],function(jQuery,t,e,i,a,n,r,o,s,l){"use strict";var h;var f;var d;var p=r.extend("sap.ui.comp.smartvariants.SmartVariantManagement",{metadata:{library:"sap.ui.comp",designtime:"sap/ui/comp/designtime/smartvariants/SmartVariantManagement.designtime",interfaces:["sap.ui.core.IShrinkable"],properties:{persistencyKey:{type:"string",group:"Misc",defaultValue:null},entitySet:{type:"string",group:"Misc",defaultValue:null}},aggregations:{personalizableControls:{type:"sap.ui.comp.smartvariants.PersonalizableInfo",multiple:true,singularName:"personalizableControl"}},events:{initialise:{},save:{parameters:{tile:{type:"boolean"},name:{type:"string"}}},afterSave:{}}},renderer:{apiVersion:2}});p.prototype.init=function(){r.prototype.init.apply(this);this._bIsInitialized=false;this._bIsVariantAdaptationEnabled=false;this._oStandardVariant=null;this._fRegisteredApplyAutomaticallyOnStandardVariant=null;this._oControlPromise=null;this._oPersoControl=null;this._sAppStandardVariantKey=null;this._oSelectionVariantHandler={};this._oAppStdContent=null;this._aPersonalizableControls=[];this._oAdapter=null;this._bApplyingUIState=false;this._sDefaultVariantId=null;this._mVariants={};this._loadFlex()};p.prototype.setEntitySet=function(t){this.setProperty("entitySet",t,true);this.attachModelContextChange(this._initializeMetadata,this);this._createMetadataPromise();this._initializeMetadata();return this};p.prototype._createMetadataPromise=function(){this._oMetadataPromise=new Promise(function(t,e){this._fResolveMetadataPromise=t}.bind(this))};p.prototype._resolveMetadataPromise=function(){if(this._fResolveMetadataPromise){this._fResolveMetadataPromise()}};p.prototype._initializeMetadata=function(){if(!this.bIsInitialised){i.handleModelInit(this,this._onMetadataInitialised)}};p.prototype._onMetadataInitialised=function(){this._bMetaModelLoadAttached=false;if(!this.bIsInitialised){var t=new a(this.getModel());if(t){this._oAdapter=new n({selectionPresentationVariants:t.getSelectionPresentationVariantAnnotationList(this.getEntitySet())});this.detachModelContextChange(this._initializeMetadata,this);this.bIsInitialised=true;this._resolveMetadataPromise()}}};p.prototype.applySettings=function(t){if(!t||!t.hasOwnProperty("useFavorites")){this.setUseFavorites(true)}r.prototype.applySettings.apply(this,arguments)};p.prototype._createControlWrapper=function(t){var e=null;var i=sap.ui.getCore().byId(t.getControl());if(i){e={control:i,type:t.getType(),dataSource:t.getDataSource(),keyName:t.getKeyName(),loaded:jQuery.Deferred()}}return e};p.prototype._getControlWrapper=function(t){var e=this._getAllPersonalizableControls();if(e&&e.length){for(var i=0;i<e.length;i++){if(e[i].control===t){return e[i]}}}return null};p.prototype.addPersonalizableControl=function(t){var e,i=t.getControl();var a=sap.ui.getCore().byId(i);if(!a){o.error("couldn't obtain the control with the id="+i);return this}this.addAggregation("personalizableControls",t,true);e=this._createControlWrapper(t);if(e){this._aPersonalizableControls.push(e)}if(this.isPageVariant()){return this}this.setPersControler(a);return this};p.prototype._loadFlex=function(){var t=function(){return new Promise(function(t){sap.ui.require(["sap/ui/fl/apply/api/SmartVariantManagementApplyAPI","sap/ui/fl/write/api/SmartVariantManagementWriteAPI","sap/ui/fl/apply/api/FlexRuntimeInfoAPI"],function(e,i,a){h=e;f=i;d=a;t()})})};if(!this._oFlLibrary){if(!this._oPersistencyPromise){this._oPersistencyPromise=new Promise(function(t,e){this._fResolvePersistencyPromise=t;this._fRejectPersistencyPromise=e}.bind(this))}this._oFlLibrary=new Promise(function(e){sap.ui.getCore().loadLibrary("sap.ui.fl",{async:true}).then(function(){t().then(e)}).catch(function(t){o.error(t);if(this._fRejectPersistencyPromise){this._fRejectPersistencyPromise()}}.bind(this))}.bind(this))}return this._oFlLibrary};p.prototype.setPersControler=function(t){if(h&&f&&d){this._setPersControler(t)}else{this._loadFlex().then(function(){this._setPersControler(t)}.bind(this))}};p.prototype._setPersControler=function(t){if(!this._oPersoControl){if(this._isFlexSupported(t)){this._oPersoControl=t;this._handleGetChanges(t)}}};p.prototype._isFlexSupported=function(t){return d.isFlexSupported({element:t})};p.prototype.setPersistencyKey=function(t){this.setProperty("persistencyKey",t);this.setPersControler(this);return this};p.prototype.isPageVariant=function(){if(this.getPersistencyKey()){return true}return false};p.prototype._getAdapter=function(){return this._oAdapter};p.prototype._getFilterBarAdapter=function(){return this._oSelectionVariantHandler["#"]};p.prototype._handleGetChanges=function(t){if(t&&h){this._oControlPromise=new Promise(function(t,e){Promise.all([this._oMetadataPromise]).then(function(){if(this._bIsBeingDestroyed){return}var i={control:this._oPersoControl,standardVariant:{id:this.STANDARDVARIANTKEY,name:this._determineStandardVariantName(),executeOnSelection:this.bExecuteOnSelectForStandardViaXML}};if(this._getAdapter()){i.variants=this._getAdapter().getODataVariants()}else if(this._getFilterBarAdapter()){i.variants=this._getFilterBarAdapter().variants}h.loadVariants(i).then(function(e){this._fResolvePersistencyPromise();t(e)}.bind(this),function(t){this._fRejectPersistencyPromise(t);e(t)}.bind(this))}.bind(this))}.bind(this))}};p.prototype._getVariantById=function(t){if(this._mVariants&&this._mVariants[t]){return this._mVariants[t]}return null};p.prototype.getVariantContent=function(t,e){var i,a=this._getVariantContent(e);if(a&&this.isPageVariant()&&t){i=this._getControlPersKey(t);if(i){a=this._retrieveContent(a,i)}}return a};p.prototype._getContent=function(t){return t.getContent()};p.prototype._getVariantContent=function(t){var e=this._getVariantById(t);if(e){var i=this._getContent(e);if(i){if(t===this.STANDARDVARIANTKEY&&Object.keys(i).length<1){i=this.getStandardVariant()}return s({},i)}}return null};p.prototype._getAllPersonalizableControls=function(){return this._aPersonalizableControls};p.prototype.removeAllPersonalizableControls=function(){this.removeAllAggregation("personalizableControls");this._aPersonalizableControls=[]};p.prototype.removePersonalizableControl=function(t){var e=this.removeAggregation("personalizableControls",t);if(e){this._aPersonalizableControls.some(function(t,i){if(t.control.getId()===e.getControl()){this._aPersonalizableControls.splice(i,1);return true}return false}.bind(this))}return e};p.prototype.removePersonalizableControlById=function(t){var e=this.getAggregation("personalizableControls");if(e){e.some(function(e,i){if(e.getControl()===t.getId()){this.removePersonalizableControl(e);return true}return false}.bind(this))}};p.prototype._variantItemChange=function(t){var e,i,a;if(t&&t.oSource&&t.oSource.isA("sap.ui.comp.variants.VariantItem")){a=t.oSource;if(a.getKey()!==this.STANDARDVARIANTKEY){i=t.getParameter("propertyName");if(i==="text"){this.removeVariantItem(a);e=this._getIdxSorted(a.getText());this.insertVariantItem(a,e)}}}};p.prototype._createVariantItem=function(t){var i=0;try{var a=new e({key:t.getVariantId(),global:!t.isUserDependent(),lifecycleTransportId:t.getRequest(),lifecyclePackage:t.getPackage(),namespace:t.getNamespace(),labelReadOnly:!t.isRenameEnabled(),readOnly:!t.isEditEnabled(),executeOnSelection:t.getExecuteOnSelection(),text:t.getName(),title:t.getName(),author:t.getOwnerId(),sharing:t.isUserDependent()?"private":"public",remove:t.isDeleteEnabled(),favorite:t.getFavorite(),executeOnSelect:t.getExecuteOnSelection(),rename:t.isRenameEnabled(),contexts:t.getContexts(),changeable:t.isEditEnabled(),visible:true});this._mVariants[t.getVariantId()]=t;a.attachChange(this._variantItemChange.bind(this));if(t.getVariantId()===this.STANDARDVARIANTKEY){a.setAuthor(this.getStandardItemAuthor())}else{i=this._getIdxSorted(t.getName())}this.insertVariantItem(a,i)}catch(t){o.error(t.message)}};p.prototype._createVariantEntries=function(t){this.removeAllVariantItems();if(t){if(t.defaultVariantId){this._sDefaultVariantId=t.defaultVariantId}if(t.standardVariant){this._createVariantItem(t.standardVariant);var e=this._getVariantContent(t.standardVariant.getVariantId());if(Object.keys(e).length>0){this._sAppStandardVariantKey=t.standardVariant.getVariantId();if(this._sAppStandardVariantKey!==this.STANDARDVARIANTKEY){this.setStandardVariantKey(this._sAppStandardVariantKey)}}}if(t.variants){t.variants.forEach(function(t){this._createVariantItem(t)}.bind(this))}this._checkUpdate()}};p.prototype._addFavorites=function(t){t.forEach(function(t){if(t.key!==this.STANDARDVARIANTKEY){var e=this._getVariantById(t.key);if(e){this._flUpdateVariant(e,{favorite:t.visible})}}}.bind(this))};p.prototype._flUpdateVariant=function(t,e){var i;var a={control:this._oPersoControl,id:t.getVariantId()};if(e.hasOwnProperty("content")||e.hasOwnProperty("name")){var n=s({},a);n.layer=t.getLayer();if(e.hasOwnProperty("content")){n.content=e.content}if(e.hasOwnProperty("name")){n.name=e.name}if(e.hasOwnProperty("packageName")){n.packageName=e.packageName}if(e.hasOwnProperty("transportId")){n.transportId=e.transportId}i=this._flWriteUpdateVariant(n);if(i){this._mVariants[i.getVariantId()]=i}}a={control:this._oPersoControl,id:t.getVariantId()};if(e.hasOwnProperty("favorite")||e.hasOwnProperty("executeOnSelection")){a.isUserDependent=true;if(e.hasOwnProperty("favorite")){a.favorite=e.favorite}if(e.hasOwnProperty("executeOnSelection")){a.executeOnSelection=e.executeOnSelection}i=this._flWriteUpdateVariant(a);if(i){this._mVariants[i.getVariantId()]=i}}};p.prototype._flRemoveVariant=function(t){var e={control:this._oPersoControl,id:t.getVariantId(),layer:t.getLayer()};var i=this._flWriteRemoveVariant(e);if(i){delete this._mVariants[i.getVariantId()]}};p.prototype._flWriteUpdateVariant=function(t){if(f){return f.updateVariant(t)}return null};p.prototype._flWriteRemoveVariant=function(t){if(f){return f.removeVariant(t)}return null};p.prototype._flWriteAddVariant=function(t){if(f){return f.addVariant(t)}return null};p.prototype.flWriteOverrideStandardVariant=function(t){if(f){f.overrideStandardVariant({control:this._oPersoControl,executeOnSelection:t})}};p.prototype.getCurrentVariantId=function(){if(this._bDuringVariantCreation){return"SV1656651501366"}var t=this.getCurrentVariantKey();if(t===this.STANDARDVARIANTKEY){t=""}return t};p.prototype.clearVariantSelection=function(){this.setSelectionKey(this.getStandardVariantKey())};p.prototype.setCurrentVariantId=function(t,e){var i;if(this._oPersoControl){i=this._determineVariantId(t);this.setCurrentVariantKey(i);if(this._oStandardVariant){this.setModified(false);if(!e){this._triggerSelectVariant(i,"SET_VM_ID")}}}};p.prototype._determineVariantId=function(t){var e=t;if(!e||!this.getItemByKey(e)){e=this.getStandardVariantKey()}return e};p.prototype.initialise=function(t,e){var i,a;try{if(e&&t){i=this._getControlWrapper(e);if(!i){o.error("initialise on an unknown control.");return}if(i.bInitialized){o.error("initialise on "+e.getId()+" already executed");return}i.fInitCallback=t}else if(!this.isPageVariant()){i=this._getControlWrapper(this._oPersoControl)}if(this._oPersistencyPromise){this._oPersistencyPromise.then(function(){if(this._oControlPromise&&this._oPersoControl&&i){Promise.all([this._oMetadataPromise,this._oControlPromise,f.isVariantSharingEnabled(),f.isVariantPersonalizationEnabled(),f.isVariantAdaptationEnabled()]).then(function(t){this._dataReceived(t[1],t[2],t[3],t[4],i)}.bind(this),function(i){a="'loadVariants' failed:";if(i&&i.message){a+=" "+i.messages}this._errorHandling(a,t,e)}.bind(this),function(i){if(i&&i.message){a=i.message}else{a="accessing either flexibility functionality or odata metadata."}this._errorHandling("'initialise' failed: "+a,t,e)}.bind(this))}else{this._errorHandling("'initialise' no personalizable component available",t,e)}}.bind(this),function(i){if(i&&i.message){a=i.message}else{a="accessing the flexibility functionality."}this._errorHandling("'initialise' failed: "+a,t,e)}.bind(this))}else{this._errorHandling("'initialise' no '_oPersistencyPromise'  available",t,e)}}catch(i){this._errorHandling("exception occurs during 'initialise' processing",t,e)}};p.prototype._errorHandling=function(t,e,i){var a={variantKeys:[]};this._setErrorValueState(this.oResourceBundle.getText("VARIANT_MANAGEMENT_READ_FAILED"),t);if(e&&i){e.call(i)}else{this.fireEvent("initialise",a)}if(i.variantsInitialized){i.variantsInitialized()}this.setInErrorState(true)};p.prototype.isVariantAdaptationEnabled=function(){return this._bIsVariantAdaptationEnabled};p.prototype._dataReceived=function(t,e,i,a,n){var r,o,s={variantKeys:[]};if(this._bIsBeingDestroyed){return}if(!this._bIsInitialized){this._bIsVariantAdaptationEnabled=a;this.setVariantCreationByUserAllowed(i);this.setShowShare(e);this._bIsInitialized=true;this._createVariantEntries(t);o=this._getDefaultVariantKey();if(!o||!this._getVariantById(o)&&o.substring(0,1)!=="#"){o=this.getStandardVariantKey()}r=this._getVariantById(o);if(r){this.setDefaultVariantKey(o);this.setSelectionKey(o)}if(this._sAppStandardVariantKey){this._oAppStdContent=this._getVariantContent(this._sAppStandardVariantKey)}}this._initialize(s,n)};p.prototype._initialize=function(t,e){var i,a=null,n=this.isPageVariant();var r,s=false;if(this._oAppStdContent){if(e.type==="table"||e.type==="chart"){if(n){this._applyControlVariant(e.control,this._oAppStdContent,"STANDARD",true)}else{this._applyVariant(e.control,this._oAppStdContent,"STANDARD",true)}}}if(e.fInitCallback){e.fInitCallback.call(e.control);delete e.fInitCallback;e.bInitialized=true}else{t.variantKeys=Object.keys(this._mVariants);this.fireEvent("initialise",t)}i=this.getCurrentVariantKey();if(i&&i!==this.getStandardVariantKey()){a=this._getVariantContent(i);r=this._getVariantById(i);if(r){s=r.getExecuteOnSelection()}}else if(this._oAppStdContent){a=this._oAppStdContent;if(e.type==="table"||e.type==="chart"){a=null}}var h;if(this._sAppStandardVariantKey){h=this._updateStandardVariant(e,this._oAppStdContent)}else{h=this._setStandardVariant(e)}l.resolve(h).then(function(t){e.loaded.resolve();if(a){if(this._getAdapter()&&i.substring(0,1)==="#"&&Object.entries(a).length===0){this._applyUiState(i,"INIT",s)}else{if(n){this._applyControlVariant(e.control,a,"INIT",true,s)}else{this._applyVariant(e.control,a,"INIT",true,s)}}}if(this.bConsiderXml!==undefined){this._executeOnSelectForStandardVariantByXML(this.bConsiderXml)}if(e.control.variantsInitialized){e.control.variantsInitialized()}if(this.getCurrentVariantKey()===this.getStandardVariantKey()){if(this._getApplyAutomaticallyOnStandardVariant()&&e.control.search){e.control.search()}if(this.getExecuteOnSelectForStandardVariant()&&this._oAppStdContent){var r=this.getItemByKey(this.getCurrentVariantKey());if(r){r.setExecuteOnSelection(true)}}}if(!this.getEnabled()){this.setEnabled(true)}}.bind(this)).catch(function(t){o.error("'_initialize' throws an exception:"+t.message)}).unwrap()};p.prototype._updateVariant=function(t){return l.resolve(this._fetchContentAsync()).then(function(e){if(t.key!==this.getStandardVariantKey()){var i=this._getVariantById(t.key);if(i){if(e){var a=this.getItemByKey(t.key);var n={content:e};if(i.getPackage()){n.transportId=i.getPackage()}if(i.getRequest()){n.packageName=i.getRequest()}if(a){n.executeOnSelection=a.getExecuteOnSelect()}this._flUpdateVariant(i,n);if(t.def===true){this._setDefaultVariantKey(t.key)}}this._afterSave(t,false)}}}.bind(this)).catch(function(t){o.error("'_updateVariant' throws an exception:"+t.message)}).unwrap()};p.prototype._createChangeHeader=function(){if(this.isPageVariant()){return{type:"page",dataService:"n/a"}}var t=this._getAllPersonalizableControls();if(t&&t.length>0){return{type:t[0].type,dataService:t[0].dataSource}}};p.prototype._newVariant=function(t){this._bDuringVariantCreation=true;return l.resolve(this._fetchContentAsync()).then(function(e){var i=this._createChangeHeader();var a={type:i.type,ODataService:i.dataSource,texts:{variantName:t.name},content:e,isVariant:true,isUserDependent:!t.public,executeOnSelection:t.execute};var n=this._flWriteAddVariant({control:this._oPersoControl,changeSpecificData:a});if(n){var r=n.getVariantId();this._mVariants[r]=n;this._flUpdateVariant(n,{favorite:true});this._createVariantItem(n);this.setSelectionKey(r);this._bDuringVariantCreation=false;if(t.def===true){this._setDefaultVariantKey(r);this.setDefaultVariantKey(r)}this._afterSave(t,true)}}.bind(this)).catch(function(t){this._bDuringVariantCreation=false;o.error("'_newVariant' throws an exception:"+t.message)}.bind(this)).unwrap()};p.prototype._fetchContent=function(){var t,e,i,a={};var n=this._getAllPersonalizableControls();for(var r=0;r<n.length;r++){t=n[r];if(t&&t.control&&t.control.fetchVariant){i=t.control.fetchVariant();if(i){i=s({},i);if(this.isPageVariant()){e=this._getControlPersKey(t);if(e){a=this._assignContent(a,i,e)}else{o.error("no persistancy key retrieved")}}else{a=i;break}}}}return a};p.prototype._fetchContentAsync=function(){var t,e,i,a={},n=[],r=[];var l=this._getAllPersonalizableControls();for(var h=0;h<l.length;h++){t=l[h];if(t&&t.control&&t.control.fetchVariant){i=t.control.fetchVariant();if(i){if(i&&i instanceof Promise){this.setEnabled(false);n.push(i);r.push(t);continue}i=s({},i);if(this.isPageVariant()){e=this._getControlPersKey(t);if(e){a=this._assignContent(a,i,e)}else{o.error("no persistancy key retrieved")}}else{a=i;break}}}}if(n.length>0){var f=null;var d=new Promise(function(t,e){f=t});Promise.all(n).then(function(t){for(var n=0;n<t.length;n++){i=s({},t[n]);if(this.isPageVariant()){e=this._getControlPersKey(r[n]);if(e){a=this._assignContent(a,i,e)}else{o.error("no persistancy key retrieved")}}else{a=i;break}}f(a)}.bind(this));return d}else{return a}};p.prototype._getControlInfoPersKey=function(t){var e=null;if(t.keyName==="id"){e=t.control.getId()}else{e=t.control.getProperty(t.keyName)}return e};p.prototype._getControlPersKey=function(t){var e=t;if(!t.keyName){e=this._getControlWrapper(t)}return this._getControlInfoPersKey(e)};p.prototype._appendLifecycleInformation=function(t,e){var i;if(t){i=t.getRequest();if(i===null||i===undefined){i=""}}return i};p.prototype._renameVariant=function(t){if(t.key!==this.getStandardVariantKey()){if(t){var e=this._getVariantById(t.key);if(e){var i={name:t.name};var a=this._appendLifecycleInformation(e,t.key);if(a!=undefined){i.transportId=a}this._flUpdateVariant(e,i);this._reorderList(t.key)}}}};p.prototype._deleteVariants=function(t){var e;var i=this._getDefaultVariantKey();var a=this.getCurrentVariantKey();if(t&&t.length){for(var n=0;n<t.length;n++){var r=t[n];var o=this._getVariantById(r);if(o){e=this._appendLifecycleInformation(o,r);o.setRequest(e);this._flRemoveVariant(o);var s=this.getItemByKey(r);if(s){this.removeVariantItem(s)}if(i&&i===r){this._setDefaultVariantKey("")}if(r===a){this.setModified(false);this.setCurrentVariantKey(this.STANDARDVARIANTKEY);this._selectVariant(this.STANDARDVARIANTKEY)}}}}};p.prototype._getDefaultVariantKey=function(){return this._sDefaultVariantId||""};p.prototype._executeOnSelectForStandardVariantByXML=function(t){r.prototype._executeOnSelectForStandardVariantByXML.apply(this,arguments);this._reapplyExecuteOnSelectForStandardVariant(t)};p.prototype._reapplyExecuteOnSelectForStandardVariant=function(t){if(Object.keys(this._mVariants).length>0){this.bConsiderXml=undefined;this.flWriteOverrideStandardVariant(t);var e=this.getStandardVariantKey();var i=this._getVariantById(e);if(i){var a=this.getItemByKey(e);if(a){a.setExecuteOnSelect(i.getExecuteOnSelection());this._reapplyExecuteOnSelectForStandardVariantItem(i.getExecuteOnSelection())}}}else{this.bConsiderXml=t}};p.prototype.setExecuteOnStandard=function(t){this._reapplyExecuteOnSelectForStandardVariant(t)};p.prototype.getExecuteOnStandard=function(){var t=this.getStandardVariantKey();var e=this.getItemByKey(t);if(e){return e.getExecuteOnSelect()}return undefined};p.prototype.registerApplyAutomaticallyOnStandardVariant=function(t){this._fRegisteredApplyAutomaticallyOnStandardVariant=t;return this};p.prototype._getApplyAutomaticallyOnStandardVariant=function(){var t=this.getExecuteOnSelectForStandardVariant();if(this._fRegisteredApplyAutomaticallyOnStandardVariant&&this.getDisplayTextForExecuteOnSelectionForStandardVariant()){try{t=this._fRegisteredApplyAutomaticallyOnStandardVariant()}catch(t){o.error("callback for determination of apply automatically on standard variant failed")}}return t};p.prototype._setDefaultVariantKey=function(t){if(f){f.setDefaultVariantId({control:this._oPersoControl,defaultVariantId:t})}this._sDefaultVariantId=t};p.prototype._setExecuteOnSelections=function(t){if(t&&t.length){for(var e=0;e<t.length;e++){var i=this._getVariantById(t[e].key);if(i){this._flUpdateVariant(i,{executeOnSelection:t[e].exe})}}}};p.prototype._save=function(t,e){if(f){try{f.save({control:this._oPersoControl}).then(function(){if(!e){if(t){this._updateUser()}this.fireEvent("afterSave")}}.bind(this),function(t){var e="'_save' failed:";if(t&&t.message){e+=" "+t.message}this._setErrorValueState(this.oResourceBundle.getText("VARIANT_MANAGEMENT_SAVE_FAILED"),e)}.bind(this))}catch(t){this._setErrorValueState(this.oResourceBundle.getText("VARIANT_MANAGEMENT_SAVE_FAILED"),"'_save' throws an exception")}}};p.prototype._updateUser=function(){var t=this.getInitialSelectionKey();var e,i=this._getVariantById(t);if(i){e=i.getOwnerId();if(e){this._assignUser(t,e)}}};p.prototype.fireSave=function(t){var e={};if(t){if(t.hasOwnProperty("tile")){e.tile=t.tile}e.name=t.name;if(t.overwrite){if(t.key!==this.getStandardVariantKey()){this.fireEvent("save",e);if(t.key===this.STANDARDVARIANTKEY){this._newVariant(t)}else{this._updateVariant(t)}}}else{this.fireEvent("save",e);this._newVariant(t)}}};p.prototype._afterSave=function(t,e){this.setEnabled(true);this.setModified(false);this._save(e)};p.prototype.fireManage=function(t){var e,i=false;if(t){if(t.renamed){for(e=0;e<t.renamed.length;e++){this._renameVariant(t.renamed[e])}}if(t.deleted){this._deleteVariants(t.deleted)}if(t.exe){this._setExecuteOnSelections(t.exe)}if(t.def){var a=this._getDefaultVariantKey();if(a!==t.def){if(!(a===""&&t.def===this.STANDARDVARIANTKEY)){this._setDefaultVariantKey(t.def);i=true}}}if(t.fav&&t.fav.length>0){this._addFavorites(t.fav)}if(t.deleted&&t.deleted.length>0||t.renamed&&t.renamed.length>0||t.exe&&t.exe.length>0||i){this._save()}else if(t.fav&&t.fav.length>0){this._save(false,true)}this.fireEvent("manage",t)}};p.prototype.fireSelect=function(t,e){if(this._oPersoControl&&t&&t.key){this._triggerSelectVariant(t.key,e);this.fireEvent("select",t)}};p.prototype._selectVariant=function(t,e){this.setModified(false);this.fireSelect({key:t},e)};p.prototype._checkForSelectionHandler=function(t){var e=null,i=Object.keys(this._oSelectionVariantHandler);if(i.length>-1){i.some(function(i){if(t.indexOf(i)===0){e=this._oSelectionVariantHandler[i];return true}return false}.bind(this))}return e};p.prototype._triggerSelectVariant=function(t,e){var i,a,n=false,r=this._checkForSelectionHandler(t);var o=this._getVariantById(t);if(o){i=o.getExecuteOnSelection();if(t===this.getStandardVariantKey()){i=this._getApplyAutomaticallyOnStandardVariant()}n=Object.entries(this._getContent(o)).length===0?false:true}if(n){a=this._getGeneralSelectVariantContent(t,e)}else if(this._getAdapter()&&t.substring(0,1)==="#"){this._applyUiState(t,"SPV_VARIANT",i);return}else if(r){a=this._getSpecialSelectVariantContent(t,e,r)}else{a=this._getGeneralSelectVariantContent(t,e)}if(a){if(this.isPageVariant()){this._applyVariants(a,e,i)}else{this._applyVariant(this._oPersoControl,a,e,false,i)}}};p.prototype._getSpecialSelectVariantContent=function(t,e,i){return i.callback.call(i.handler,t,e)};p.prototype._getGeneralSelectVariantContent=function(t,e){var i=this._getVariantContent(t);if(i){i=s({},i)}return i};p.prototype.currentVariantSetModified=function(t){if(!this._bApplyingUIState){r.prototype.currentVariantSetModified.apply(this,arguments)}};p.prototype._applyControlUiState=function(t,e,i){if(t&&e){t.loaded.then(function(){if(t.control.setUiStateAsVariant){t.control.setUiStateAsVariant(e,i)}})}};p.prototype._applyUiState=function(t,e,i){var a,n=this._getAdapter(),r=null,o=this._getAllPersonalizableControls();var s=null;if(n){r=n.getUiState(t);this._bApplyingUIState=true;for(a=0;a<o.length;a++){if(o[a]&&o[a].control&&o[a].loaded){this._applyControlUiState(o[a],r,e);if(o[a].control.search){s=o[a].control}}}this._bApplyingUIState=false;if(i&&s){s.search()}}};p.prototype._applyControlWrapperVariants=function(t,e,i,a){if(t){t.loaded.then(function(){this._applyControlVariant(t.control,e,i,false,a)}.bind(this))}};p.prototype._applyVariants=function(t,e,i){var a,n=this._getAllPersonalizableControls();for(a=0;a<n.length;a++){if(n[a]&&n[a].control&&n[a].loaded){this._applyControlWrapperVariants(n[a],t,e,i)}}};p.prototype._setStandardVariant=function(e){var i=e.control;if(i){if(i.fireBeforeVariantSave){i.fireBeforeVariantSave(t.STANDARD_VARIANT_NAME)}return this._assignStandardVariantAsync(e)}};p.prototype._retrieveContent=function(t,e){var i=t;if(this.isPageVariant()&&t){i=t[e];if(!i&&e===this.getPersistencyKey()&&this._aPersonalizableControls&&this._aPersonalizableControls.length===1){i=t}}return i};p.prototype._assignContent=function(t,e,i){if(this.isPageVariant()){t[i]=e}else{t=e}return t};p.prototype._updateStandardVariant=function(t,e){if(t.control){var i=e;if(this.isPageVariant()){var a=this._getControlPersKey(t);if(a){i=this._retrieveContent(e,a)}}return this._assignStandardVariantForControl(t,i)}return e};p.prototype._assignStandardVariantAsync=function(t){var e=null;if(t.control){if(t.control.fetchVariant){e=t.control.fetchVariant()}if(e instanceof Promise){this.setEnabled(false)}return l.resolve(e).then(function(e){return this._assignStandardVariantForControl(t,e)}.bind(this)).catch(function(t){o.error("'_assignStandardVariant' throws an exception: "+t.message)}).unwrap()}return null};p.prototype._assignStandardVariantForControl=function(t,e){var i=e;if(t){if(this.isPageVariant()){var a=this._getControlPersKey(t.control);if(a){if(!this._oStandardVariant){this._oStandardVariant={}}this._oStandardVariant=this._assignContent(this._oStandardVariant,i,a)}}else{this._oStandardVariant=i}}return this._oStandardVariant};p.prototype.getStandardVariant=function(t){var e,i,a=null;if(this._oStandardVariant){if(!t){a=this._oStandardVariant}else{if(this.isPageVariant()){i=this._getControlWrapper(t);if(i){e=this._getControlPersKey(t);if(e){a=this._retrieveContent(this._oStandardVariant,e)}}}else{if(t===this._oPersoControl){a=this._oStandardVariant}}}}return a};p.prototype._applyVariant=function(t,e,i,a,n){if(t&&t.applyVariant){if(n!=undefined){e.executeOnSelection=n}t.applyVariant(e,i,a)}};p.prototype._applyVariantByPersistencyKey=function(t,e,i){var a=null;this.getAggregation("personalizableControls",[]).some(function(e){var i=sap.ui.getCore().byId(e.getControl());if(i){var n=e.getKeyName();if(i.getProperty(n)===t){a=i}return a!=null}});if(a){var n=this._retrieveContent(e,t);this._applyVariant(a,n,i)}};p.prototype._applyControlVariant=function(t,e,i,a,n){var r,o;o=this._getControlPersKey(t);if(o){r=this._retrieveContent(e,o);if(r){this._applyVariant(t,r,i,a,n)}}};p.prototype.registerSelectionVariantHandler=function(t,e){this._oSelectionVariantHandler[e]=t};p.prototype.unregisterSelectionVariantHandler=function(t){var e=null;if(!this._oSelectionVariantHandler){return}if(typeof t==="string"){e=t}else{Object.keys(this._oSelectionVariantHandler).some(function(i){if(this._oSelectionVariantHandler[i].handler===t){e=i;return true}return false}.bind(this))}if(e){delete this._oSelectionVariantHandler[e]}};p.prototype._setErrorValueState=function(t,e){this.setInErrorState(true);if(e){o.error(e)}};p.prototype.exit=function(){r.prototype.exit.apply(this,arguments);this._aPersonalizableControls=null;this._fRegisteredApplyAutomaticallyOnStandardVariant=null;this._fResolvePersistencyPromise=null;this._fRejectPersistencyPromise=null;this._fResolveMetadataPromise=null;this._oMetadataPromise=null;this._fResolveMetadataPromise=null;this._oControlPromise=null;this._oFlLibrary=null;this._oPersistencyPromise=null;this._oPersoControl=null;this._oAppStdContent=null;this._sAppStandardVariantKey=null;this._oSelectionVariantHandler=null;if(this._oAdapter){this._oAdapter.destroy();this._oAdapter=null}this._mVariants=null};return p});
/*!
 * SAPUI5
 * (c) Copyright 2009-2023 SAP SE. All rights reserved.
 */
sap.ui.predefine("sap/ui/comp/smartvariants/SmartVariantManagementAdapter", ["sap/ui/comp/state/UIState","sap/ui/core/Element"],function(t,e){"use strict";var n=e.extend("sap.ui.comp.smartvariants.SmartVariantManagementAdapter",{metadata:{library:"sap.ui.comp",properties:{selectionPresentationVariants:{type:"object",group:"Misc",defaultValue:false}}}});n.prototype.getUiState=function(e){var n,a=null,i=e.substring(1);this.getSelectionPresentationVariants().some(function(t){if(t.qualifier===i){a=t}return a!==null});if(a){if(a.uiStateContent){n=a.uiStateContent}else{n=t.createFromSelectionAndPresentationVariantAnnotation(a.text,a.selectionVariant?a.selectionVariant.annotation:null,a.presentationVariant?a.presentationVariant.annotation:null);a.uiStateContent=n}}return n};n.prototype.getODataVariants=function(){var t="#",e=[];var n=this.getSelectionPresentationVariants();if(n){n.forEach(function(n){if(n.qualifier){var a=t+n.qualifier;e.push({id:a,favorite:true,name:n.text})}})}return e};n.prototype.destroy=function(){e.prototype.destroy.apply(this,arguments)};return n});
/*!
 * SAPUI5
 * (c) Copyright 2009-2023 SAP SE. All rights reserved.
 */
sap.ui.predefine("sap/ui/comp/smartvariants/SmartVariantManagementBase", ["sap/m/VariantManagement","sap/ui/core/Control","sap/ui/core/library","sap/ui/model/base/ManagedObjectModel","sap/base/Log"],function(t,e,r,a,i){"use strict";var o=r.TitleLevel;var n=e.extend("sap.ui.comp.smartvariants.SmartVariantManagementBase",{metadata:{interfaces:["sap.m.IOverflowToolbarContent"],library:"sap.ui.comp",designtime:"sap/ui/comp/designtime/smartvariants/SmartVariantManagementBase.designtime",properties:{enabled:{type:"boolean",group:"Misc",defaultValue:true},defaultVariantKey:{type:"string",group:"Misc",defaultValue:null},selectionKey:{type:"string",group:"Misc",defaultValue:null},showCreateTile:{type:"boolean",group:"Misc",defaultValue:false},showExecuteOnSelection:{type:"boolean",group:"Misc",defaultValue:false},showShare:{type:"boolean",group:"Misc",defaultValue:false},showSetAsDefault:{type:"boolean",group:"Misc",defaultValue:true},standardItemText:{type:"string",group:"Misc",defaultValue:null},useFavorites:{type:"boolean",group:"Misc",defaultValue:false},inErrorState:{type:"boolean",group:"Misc",defaultValue:false},variantCreationByUserAllowed:{type:"boolean",group:"Misc",defaultValue:true},standardItemAuthor:{type:"string",group:"Misc",defaultValue:"SAP"},displayTextForExecuteOnSelectionForStandardVariant:{type:"string",group:"Misc",defaultValue:""},headerLevel:{type:"sap.ui.core.TitleLevel",group:"Appearance",defaultValue:o.Auto},titleStyle:{type:"sap.ui.core.TitleLevel",group:"Appearance",defaultValue:o.Auto},initialSelectionKey:{type:"string",group:"Misc",defaultValue:null},lifecycleSupport:{type:"boolean",group:"Misc",defaultValue:false},maxWidth:{type:"sap.ui.core.CSSSize",group:"Dimension",defaultValue:"100%"}},events:{save:{parameters:{name:{type:"string"},overwrite:{type:"boolean"},key:{type:"string"},exe:{type:"boolean"},def:{type:"boolean"},global:{type:"boolean"}}},manage:{parameters:{renamed:{type:"object[]"},deleted:{type:"string[]"},exe:{type:"object[]"},def:{type:"string"}}},select:{parameters:{key:{type:"string"}}}},defaultAggregation:"variantItems",aggregations:{_embeddedVM:{type:"sap.m.VariantManagement",multiple:false,visibility:"hidden"},variantItems:{type:"sap.ui.comp.variants.VariantItem",multiple:true,forwarding:{getter:"_getEmbeddedVM",aggregation:"items"}}}},renderer:{apiVersion:2,render:function(t,e){t.openStart("div",e);t.style("max-width",e.getMaxWidth());t.openEnd();t.renderControl(e._oVM);t.close("div")}}});n.prototype.init=function(){e.prototype.init.apply(this);this.STANDARDVARIANTKEY="*standard*";this.addStyleClass("sapUiCompVarMngmt");this.oResourceBundle=sap.ui.getCore().getLibraryResourceBundle("sap.ui.comp");this._oVM=new t(this.getId()+"-vm");this.setAggregation("_embeddedVM",this._oVM,true);this.setStandardVariantKey(this.STANDARDVARIANTKEY);this._oManagedObjectModel=new a(this);this.setModel(this._oManagedObjectModel,"$compSmartVariants");this._oVM.attachManage(this._fireManage,this);this._oVM.attachSave(this._fireSave,this);this._oVM.attachSelect(this._fireSelect,this);this._oVM.attachCancel(this._fireCancel,this);this._oVM.attachManageCancel(this._fireManageCancel,this);this.setDefaultVariantKey(this.getStandardVariantKey());this.setPopoverTitle(this.oResourceBundle.getText("VARIANT_MANAGEMENT_VARIANTS"));this._bindProperties()};n.prototype._bindProperties=function(t){this._oVM.bindProperty("defaultKey",{path:"/defaultVariantKey",model:"$compSmartVariants"});this._oVM.bindProperty("creationAllowed",{path:"/variantCreationByUserAllowed",model:"$compSmartVariants"});this._oVM.bindProperty("selectedKey",{path:"/selectionKey",model:"$compSmartVariants"});this._oVM.bindProperty("supportPublic",{path:"/showShare",model:"$compSmartVariants"});this._oVM.bindProperty("supportDefault",{path:"/showSetAsDefault",model:"$compSmartVariants"});this._oVM.bindProperty("supportApplyAutomatically",{path:"/showExecuteOnSelection",model:"$compSmartVariants"});this._oVM.bindProperty("supportFavorites",{path:"/useFavorites",model:"$compSmartVariants"});this._oVM.bindProperty("level",{path:"/headerLevel",model:"$compSmartVariants"});this._oVM.bindProperty("titleStyle",{path:"/titleStyle",model:"$compSmartVariants"})};n.prototype._getEmbeddedVM=function(){return this._oVM};n.prototype.setDisplayTextForExecuteOnSelectionForStandardVariant=function(t){this.setProperty("displayTextForExecuteOnSelectionForStandardVariant",t);this._oVM.setDisplayTextForExecuteOnSelectionForStandardVariant(t);return this};n.prototype.setShowAsText=function(t){this._oVM.setShowAsText(t);return this};n.prototype.getShowAsText=function(){return this._oVM.getShowAsText()};n.prototype.setShowCreateTile=function(t){this.setProperty("showCreateTile",t);this._oVM._setShowCreateTile(t);return this};n.prototype.getShowCreateTile=function(){return this._oVM._getShowCreateTile()};n.prototype._assignUser=function(t,e){var r=this._oVM.getItemByKey(t);if(r){r.setAuthor(e)}};n.prototype.setSelectionKey=function(t){this.setProperty("selectionKey",t);return this};n.prototype.setInitialSelectionKey=function(t){return this.setSelectionKey(t)};n.prototype.getInitialSelectionKey=function(){return this.getSelectionKey()};n.prototype.currentVariantGetModified=function(){return this.getModified()};n.prototype.currentVariantSetModified=function(t){this.setModified(t)};n.prototype._getIdxSorted=function(t){var e=this.getVariantItems();var r=t.toUpperCase();var a=e.findIndex(function(t,e){if(e>0){if(t.getTitle().toUpperCase()>r){return true}}return false});return a>-1?a:e.length};n.prototype._reorderList=function(t){var e=this.getItemByKey(t);if(e){this.removeVariantItem(e);var r=this._getIdxSorted(e.getTitle());this.insertVariantItem(e,r)}};n.prototype._getInternalVM=function(){return this.getAggregation("_embeddedVM")};n.prototype.getItemByKey=function(t){var e=this.getVariantItems();for(var r=0;r<e.length;r++){if(t==e[r].getKey()){return e[r]}}return null};n.prototype._determineStandardVariantName=function(){var t=this.oResourceBundle.getText("VARIANT_MANAGEMENT_STANDARD");if(this.getStandardVariantKey()===this.STANDARDVARIANTKEY&&this.getStandardItemText()){t=this.getStandardItemText()}return t};n.prototype.setStandardVariantKey=function(t){this._oVM.setStandardVariantKey(t)};n.prototype.getStandardVariantKey=function(){return this._oVM.getStandardVariantKey()};n.prototype.getOverflowToolbarConfig=function(){return{canOverflow:false,invalidationEvents:["save","manage","select"]}};n.prototype._prepareSaveAsKeyUserData=function(t){try{this._getContentAsync().then(function(e){var r={default:t.def,executeOnSelection:t.execute,type:this._getPersoControllerType(),text:t.name,contexts:t.contexts,content:e};this._fGetDataForKeyUser(r);this._cleanUpSaveForKeyUser()}.bind(this))}catch(t){i.error("'_prepareSaveAsKeyUserData' throws an exception:"+t.message);this._fGetDataForKeyUser();this._cleanUpSaveForKeyUser()}};n.prototype._fireCancel=function(t){if(this._fGetDataForKeyUser){this._fGetDataForKeyUser();this._cleanUpSaveForKeyUser()}};n.prototype._fireManageCancel=function(t){if(this._fGetDataForKeyUser){this._fGetDataForKeyUser();this._cleanUpManageViewsForKeyUser()}};n.prototype._fireSelect=function(t){if(!this._fGetDataForKeyUser){this.setModified(false)}this.fireSelect(t.getParameters())};n.prototype._fireSave=function(t){var e=t.getParameters();if(this._fGetDataForKeyUser){this._prepareSaveAsKeyUserData(e);return}if(e.hasOwnProperty("execute")){e.exe=e.execute}if(e.hasOwnProperty("public")){e.global=e.public}this.fireSave(e)};n.prototype._prepareManageKeyUserData=function(t){var e={};var r=false;if(t.hasOwnProperty("def")){var a=t.def;if(a!==this._oVM._sOriginalDefaultKey){e.default=a}}if(t.hasOwnProperty("deleted")){t.deleted.forEach(function(t){if(!e[t]){e[t]={}}e[t].deleted=true;if(this.getSelectionKey()===t){r=true}}.bind(this))}if(t.hasOwnProperty("exe")){t.exe.forEach(function(t){if(!e[t.key]){e[t.key]={}}e[t.key].executeOnSelection=t.exe})}if(t.hasOwnProperty("fav")){t.fav.forEach(function(t){if(!e[t.key]){e[t.key]={}}e[t.key].favorite=t.visible})}if(t.hasOwnProperty("renamed")){t.renamed.forEach(function(t){if(!e[t.key]){e[t.key]={}}e[t.key].name=t.name})}if(t.hasOwnProperty("contexts")){t.contexts.forEach(function(t){if(!e[t.key]){e[t.key]={}}e[t.key].contexts=t.contexts})}if(r){this.activateVariant(this.getStandardVariantKey())}this._fGetDataForKeyUser(e);this._cleanUpManageViewsForKeyUser()};n.prototype._fireManage=function(t){var e=t.getParameters();if(this._fGetDataForKeyUser){this._prepareManageKeyUserData(e)}else{this.fireManage(e)}};n.prototype.getFocusDomRef=function(){if(this._oVM){return this._oVM.oVariantPopoverTrigger.getFocusDomRef()}return null};n.prototype.getManageDialog=function(){if(this._oVM){return this._oVM.oManagementDialog}return null};n.prototype.getVariants=function(){return this._oVM.getItems()};n.prototype.getTitle=function(){return this._oVM.getTitle()};n.prototype.setPopoverTitle=function(t){return this._oVM.setPopoverTitle(t)};n.prototype.setEditable=function(t){this.setProperty("editable",t);return this._oVM.setShowFooter(t)};n.prototype.setShowExecuteOnSelection=function(t){this.setProperty("showExecuteOnSelection",t);this._oVM.setSupportApplyAutomatically(t);return this};n.prototype.setShowSetAsDefault=function(t){this.setProperty("showSetAsDefault",t);this._oVM.setSupportDefault(t);return this};n.prototype.setDisplayTextForExecuteOnSelectionForStandardVariant=function(t){this.setProperty("displayTextForExecuteOnSelectionForStandardVariant",t);this._oVM.setDisplayTextForExecuteOnSelectionForStandardVariant(t);return this};n.prototype.setInErrorState=function(t){var e=this._oVM.getTitle();if(t&&e&&!e.getText()){e.setText(this._determineStandardVariantName())}this.setProperty("inErrorState",t);this._oVM.setInErrorState(t);return this};n.prototype.getInErrorState=function(){return this._oVM.getInErrorState()};n.prototype._updateLayerSpecificInformations=function(){this.getVariants().forEach(function(t){var e=this._getVariantById(t.getKey());if(e){t.setRemove(e.isDeleteEnabled(this._sLayer));t.setRename(e.isRenameEnabled(this._sLayer))}}.bind(this))};n.prototype.setEditable=function(t){this._oVM.setProperty("showFooter",t);return this};n.prototype.setCurrentVariantKey=function(t){this._oVM.setSelectedKey(t)};n.prototype.getCurrentVariantKey=function(){return this._oVM.getSelectedKey()};n.prototype.getModified=function(){return this._oVM.getModified()};n.prototype.setModified=function(t){this._oVM.setModified(t)};n.prototype.refreshTitle=function(){this._oVM.refreshTitle()};n.prototype.registerApplyAutomaticallyOnStandardVariant=function(t){this._fRegisteredApplyAutomaticallyOnStandardVariant=t;return this};n.prototype.getApplyAutomaticallyOnVariant=function(t){var e=t.executeOnSelect;if(this._fRegisteredApplyAutomaticallyOnStandardVariant&&this.getDisplayTextForExecuteOnSelectionForStandardVariant()&&t.key===this._oVM.getStandardVariantKey()){try{e=this._fRegisteredApplyAutomaticallyOnStandardVariant(t)}catch(t){i.error("callback for determination of apply automatically on standard variant failed")}}return e};n.prototype.getPersonalizableControlPersistencyKey=function(){if(this.isPageVariant()){return this.getPersistencyKey()}var t=this._getAllPersonalizableControls();if(t&&t.length===1){return this._getControlPersKey(t[0])}return null};n.prototype.addVariant=function(t,e){this._createVariantItem(t);if(e){this.setDefaultVariantId(t.getVariantId())}};n.prototype.removeVariant=function(t){if(t.variantId){var e=this.getItemByKey(t.variantId);if(e){this.removeVariantItem(e);e.destroy()}delete this._mVariants[t.variantId]}if(t.previousVariantId){this.activateVariant(t.previousVariantId)}if(t.previousDefault){this.setDefaultVariantId(t.previousDefault)}};n.prototype.removeWeakVariant=function(t){if(t.variantId){var e=this.getItemByKey(t.variantId);if(e){this.removeVariantItem(e);e.destroy()}delete this._mVariants[t.variantId]}if(t.previousVariantId){this.setInitialSelectionKey(t.previousVariantId)}if(t.previousDirtyFlag){this.setModified(t.previousDirtyFlag)}if(t.previousDefault){this.setDefaultVariantId(t.previousDefault)}};n.prototype.updateVariant=function(t){var e;if(t){e=this.getItemByKey(t.getVariantId());if(e){e.setExecuteOnSelection(t.getExecuteOnSelection());e.setExecuteOnSelect(t.getExecuteOnSelection());e._setOriginalExecuteOnSelect(t.getExecuteOnSelection());e.setFavorite(t.getFavorite());e._setOriginalFavorite(t.getFavorite());e.setTitle(t.getText("variantName"));e._setOriginalTitle(t.getText("variantName"));e.setText(t.getText("variantName"));if(t.getContexts){e.setContexts(t.getContexts());e._setOriginalContexts(t.getContexts())}}}};n.prototype.activateVariant=function(t){this.setCurrentVariantKey(t);this.setModified(false);this.fireSelect({key:t})};n.prototype.getAllVariants=function(){var t=this._oVM.getItems();if(!t||t.length<1){return[]}var e=[];t.forEach(function(t){if(t.getVisible()){e.push(this._getVariantById(t.getKey()))}}.bind(this));return e};n.prototype.getDefaultVariantId=function(){return this.getDefaultVariantKey()};n.prototype.setDefaultVariantId=function(t){this.setDefaultVariantKey(t)};n.prototype.getPresentVariantId=function(){return this.getCurrentVariantId()?this.getCurrentVariantId():this.STANDARDVARIANTKEY};n.prototype.getPresentVariantText=function(){return this._oVM.getSelectedVariantText(this.getPresentVariantId())};n.prototype.getPresentVariantContent=function(){return this._getContentAsync()};n.prototype._getPersoController=function(){return this._oPersoControl};n.prototype._getPersoControllerType=function(){if(this.isPageVariant()){return"page"}var t=this._getAllPersonalizableControls();if(t&&t.length===1){return t[0].type}return null};n.prototype._getViewByName=function(t){var e,r=t.trim();var a=this.getVariants();for(var i=0;i<a.length;i++){e=a[i].getText().trim();if(e===r){return a[i]}}return null};n.prototype.getViewIdByName=function(t){var e=this._getViewByName(t);return e?e.getKey():null};n.prototype._isDuplicateSaveAs=function(t){var e=t.trim();if(!e){return true}var r=this._determineStandardVariantName();if(r===e){return true}return this._getViewByName(e)?true:false};n.prototype.isNameDuplicate=function(t){var e=t.trim();return this._isDuplicateSaveAs(e)};n.prototype.isNameTooLong=function(e){var r=e.trim();return r.length>t.MAX_NAME_LEN};n.prototype.setStandardItemText=function(t){this.setProperty("standardItemText",t);return this};n.prototype._executeOnSelectForStandardVariantByXML=function(t){this.bExecuteOnSelectForStandardViaXML=t};n.prototype.getExecuteOnSelectForStandardVariant=function(){var t=false;var e=this.getItemByKey(this.getStandardVariantKey());if(e){t=e.getExecuteOnSelect()}return t||this.bExecuteOnSelectForStandardViaXML};n.prototype._reapplyExecuteOnSelectForStandardVariantItem=function(t){var e=this.getStandardVariantKey();if(this._oVM){var r=this._oVM.getItemByKey(e);if(r){r.setExecuteOnSelect(t);r._setOriginalExecuteOnSelect(t)}}};n.prototype.openManageViewsDialogForKeyUser=function(t,e,r){this._sLayer=t.layer;this._fGetDataForKeyUser=e;this._updateLayerSpecificInformations();var a=true;if(r){a=false}this._oVM.openManagementDialog(a,t.rtaStyleClass,t.contextSharingComponentContainer)};n.prototype.openSaveAsDialogForKeyUser=function(t,e,r){this._fGetDataForKeyUser=e;this._oVM.openSaveAsDialog(t,r)};n.prototype._cleanUpSaveForKeyUser=function(){if(this._oRolesComponentContainer){this.oSaveDialog.removeContent(this._oRolesComponentContainer)}this._cleanUpKeyUser()};n.prototype._destroyManageDialog=function(){if(this._oVM){this._oVM.destroyManageDialog()}};n.prototype._cleanUpManageViewsForKeyUser=function(){this._destroyManageDialog();this._cleanUpKeyUser()};n.prototype._cleanUpKeyUser=function(){this.setShowShare(this._bShowShare);this._fGetDataForKeyUser=null;this._sLayer=null;this._oRolesComponentContainer=null};n.prototype._getContentAsync=function(){return Promise.resolve(this._fetchContentAsync())};n.prototype._checkUpdate=function(){this._oVM.getModel("$mVariants").checkUpdate(true)};n.prototype.enteringDesignMode=function(){this.setDesignTimeMode(true)};n.prototype.leavingDesignMode=function(){this.setDesignTimeMode(false)};n.prototype.setDesignTimeMode=function(t){this._oVM.setDesignMode(t);return this._oVM.setShowFooter(!t)};n.prototype.exit=function(){this._oVM.detachManage(this._fireManage,this);this._oVM.detachSelect(this._fireSelect,this);this._oVM.detachSave(this._fireSave,this);this._oVM.detachCancel(this._fireCancel,this);this._oVM.detachManageCancel(this._fireManageCancel,this);if(this._oManagedObjectModel){this._oManagedObjectModel.destroy();this._oManagedObjectModel=undefined}e.prototype.exit.apply(this,arguments);this._oVM=undefined;this._fRegisteredApplyAutomaticallyOnStandardVariant=null;this.oResourceBundle=undefined};return n});
/*!
 * SAPUI5
 * (c) Copyright 2009-2023 SAP SE. All rights reserved.
 */
sap.ui.predefine("sap/ui/comp/smartvariants/SmartVariantManagementUi2", ["sap/ui/core/Control","sap/ui/core/library","sap/ui/comp/library","sap/m/VariantManagement","sap/ui/comp/variants/VariantItem","sap/ui/model/base/ManagedObjectModel","sap/base/Log"],function(t,e,a,i,r,n,o){"use strict";var s=e.TitleLevel;var l=t.extend("sap.ui.comp.smartvariants.SmartVariantManagementUi2",{metadata:{library:"sap.ui.comp",properties:{enabled:{type:"boolean",group:"Misc",defaultValue:true},maxWidth:{type:"sap.ui.core.CSSSize",group:"Dimension",defaultValue:"100%"},standardItemText:{type:"string",group:"Misc",defaultValue:null},headerLevel:{type:"sap.ui.core.TitleLevel",group:"Appearance",defaultValue:s.Auto},titleStyle:{type:"sap.ui.core.TitleLevel",group:"Appearance",defaultValue:s.Auto}},aggregations:{personalizableControl:{type:"sap.ui.comp.smartvariants.PersonalizableInfo",multiple:false},_embeddedVM:{type:"sap.m.VariantManagement",multiple:false,visibility:"hidden"}},events:{initialise:{},afterSave:{},save:{parameters:{name:{type:"string"},overwrite:{type:"boolean"},key:{type:"string"},def:{type:"boolean"}}},manage:{parameters:{renamed:{type:"object[]"},deleted:{type:"string[]"},def:{type:"string"}}},select:{parameters:{key:{type:"string"}}}}},renderer:{apiVersion:2,render:function(t,e){t.openStart("div",e);t.style("max-width",e.getMaxWidth());t.openEnd();t.renderControl(e._oVM);t.close("div")}}});l.prototype.init=function(){t.prototype.init.apply(this);this.STANDARDVARIANTKEY="*standard*";this.addStyleClass("sapUiCompVarMngmt");this.oResourceBundle=sap.ui.getCore().getLibraryResourceBundle("sap.ui.comp");this._oVM=new i(this.getId()+"-vm",{supportFavorites:false,supportApplyAutomatically:false,supportPublic:false,supportContexts:false});this.setAggregation("_embeddedVM",this._oVM,true);this._oVM.setStandardVariantKey(this.STANDARDVARIANTKEY);this._oManagedObjectModel=new n(this);this.setModel(this._oManagedObjectModel,"$compSmartVariantsUi2");this._oVM.attachManage(this._fireManage,this);this._oVM.attachSave(this._fireSave,this);this._oVM.attachSelect(this._fireSelect,this);this._oStandardVariant=null;this._oPersController=null;this._sKeyName=null;this._oContainer=null;this._oVariantSet=null;this._bindProperties()};l.prototype._bindProperties=function(){this._oVM.bindProperty("level",{path:"/headerLevel",model:"$compSmartVariantsUi2"});this._oVM.bindProperty("titleStyle",{path:"/titleStyle",model:"$compSmartVariantsUi2"})};l.prototype.getVariantItems=function(){return this._oVM.getItems()};l.prototype.isPageVariant=function(){return false};l.prototype.getVariantContent=function(t,e){var a=null;if(e===this.getStandardVariantKey()){a=this._getStandardVariant()}else{if(this._oVariantSet){var i=this._oVariantSet.getVariant(e);if(i){a=this._getContent(i)}}}return a};l.prototype.getExecuteOnSelectForStandardVariant=function(){return false};l.prototype.currentVariantSetModified=function(t){this._oVM.setModified(t)};l.prototype.currentVariantGetModified=function(){return this._oVM.getModified()};l.prototype.getCurrentVariantId=function(){var t=this._oVM.getSelectedKey();if(t===this.getStandardVariantKey()){t=""}return t};l.prototype.setSelectionKey=function(t){this._oVM.setSelectedKey(t)};l.prototype.getItemByKey=function(t){return this._oVM._getItemByKey(t)};l.prototype.setDefaultVariantKey=function(t){this._oVM.setDefaultKey(t)};l.prototype.getDefaultVariantKey=function(){return this._oVM.getDefaultKey()};l.prototype.setInitialSelectionKey=function(t){this.setSelectionKey(t)};l.prototype.getInitialSelectionKey=function(){return this._oVM.getSelectedKey()};l.prototype.getSelectionKey=function(){return this._oVM.getSelectedKey()};l.prototype.addVariantItem=function(t){this._oVM.addItem(t)};l.prototype.insertVariantItem=function(t,e){this._oVM.insertItem(t,e)};l.prototype.removeVariantItem=function(t){this._oVM.removeItem(t)};l.prototype.setCurrentVariantKey=function(t){this.setSelectionKey(t)};l.prototype._fireSelect=function(t){this.fireSelect(t.getParameters())};l.prototype._fireSave=function(t){var e=t.getParameters();if(e.hasOwnProperty("execute")){e.exe=e.execute}this.fireSave(e)};l.prototype._fireManage=function(t){var e=t.getParameters();this.fireManage(e)};l.prototype.getStandardVariantKey=function(){return this.STANDARDVARIANTKEY};l.prototype._determineStandardVariantName=function(){var t=this.oResourceBundle.getText("VARIANT_MANAGEMENT_STANDARD");if(this.getStandardItemText()){t=this.getStandardItemText()}return t};l.prototype.removeAllVariantItems=function(){this._oVM.removeAllItems()};l.prototype._createStandardVariantItem=function(){this._createVariantItem(this.getStandardVariantKey(),this._determineStandardVariantName(),{rename:false,remove:false,changeable:false});this.setSelectionKey(this.getStandardVariantKey())};l.prototype._getIdxSorted=function(t){var e=this.getVariantItems();var a=t.toUpperCase();var i=e.findIndex(function(t,e){if(e>0){if(t.getTitle().toUpperCase()>a){return true}}return false});return i>-1?i:e.length};l.prototype._variantItemChange=function(t){var e,a,i;if(t&&t.oSource&&t.oSource.isA("sap.ui.comp.variants.VariantItem")){i=t.oSource;if(i.getKey()!==this.STANDARDVARIANTKEY){a=t.getParameter("propertyName");if(a==="text"){this.removeVariantItem(i);e=this._getIdxSorted(i.getText());this.insertVariantItem(i,e)}}}};l.prototype._createVariantItem=function(t,e,a){var i=t===this.getStandardVariantKey()?0:this._getIdxSorted(e);if(!a){a={rename:true,remove:true,changeable:true}}a.key=t;a.text=e;a.title=e;a.visible=true;var n=new r(a);n.attachChange(this._variantItemChange.bind(this));this.insertVariantItem(n,i)};l.prototype.getVariantItems=function(){return this._oVM.getItems()};l.prototype.getInErrorState=function(){return this._oVM.getInErrorState()};l.prototype.clearVariantSelection=function(){this.setSelectionKey(this.getStandardVariantKey())};l.prototype.setCurrentVariantId=function(t,e){var a;var i=t;if(!i){i=this.getStandardVariantKey()}else{if(!this.getItemByKey(i)){i=this.getStandardVariantKey()}}if(this._oVariantSet){a=this.getVariantContent(this._oPersController,i);if(a){this.setSelectionKey(i);if(e!==true){this._applyVariantContent(a)}}}};l.prototype.addPersonalizableControl=function(t){this.setAggregation("personalizableControl",t,true);if(t.getControl()){this._oPersController=sap.ui.getCore().byId(t.getControl())}this._sKeyName=t.getKeyName();return this};l.prototype._getUShellContainer=function(){return sap.ui.require("sap/ushell/Container")};l.prototype.initialise=function(){var t=this._getPersistencyKey();if(!t){o.warning("PersistencyKey not set");this.fireEvent("initialise");return}var e=this;var a=this._getUShellContainer();if(a){a.getServiceAsync("Personalization").then(function(a){a.getContainer(t,{validity:Infinity}).fail(function(){o.error("Loading personalization container failed");e._setErrorValueState(e.oResourceBundle.getText("VARIANT_MANAGEMENT_READ_FAILED"));e.fireEvent("initialise")}).done(function(t){e._readPersonalization(t)})},function(){o.error("Loading personalization service failed");e._setErrorValueState(e.oResourceBundle.getText("VARIANT_MANAGEMENT_READ_FAILED"));e.fireEvent("initialise")});return}o.error("Could not obtain the personalization container");this._setErrorValueState(this.oResourceBundle.getText("VARIANT_MANAGEMENT_READ_FAILED"));this.fireEvent("initialise")};l.prototype._setSelectedVariant=function(){var t=null;if(this._oVariantSet){var e=this.getSelectionKey();if(e){t=this._oVariantSet.getVariant(e);if(t){this._applyVariant(t)}}}};l.prototype._reCreateVariantEntries=function(){var t=null;var e=null;var a;if(this._oVariantSet){var i=this._oVariantSet.getVariantNamesAndKeys();if(i){for(t in i){if(t){this._createVariantItem(i[t],t)}}e=this._oVariantSet.getCurrentVariantKey();a=this._oVariantSet.getVariant(e);if(!a){e=this.getStandardVariantKey()}this.setDefaultVariantKey(e);this.setInitialSelectionKey(e)}}};l.prototype._getVariantSetAdapter=function(t){if(!t){return Promise.resolve(null)}return new Promise(function(e){sap.ui.require(["sap/ushell/services/personalization/VariantSetAdapter"],function(a){e(new a(t))})})};l.prototype._createVariantEntries=function(){this.removeAllVariantItems();this._createStandardVariantItem();return this._getVariantSetAdapter(this._oContainer).then(function(t){if(t){this._oVariantSet=t.getVariantSet("filterBarVariantSet");if(this._oVariantSet){this._reCreateVariantEntries()}else{this._oVariantSet=t.addVariantSet("filterBarVariantSet")}this._setStandardVariant();if(this.getDefaultVariantKey()!==this.getStandardVariantKey()){this._setSelectedVariant()}}this.fireEvent("initialise")}.bind(this))};l.prototype._readPersonalization=function(t){this._oContainer=t;if(this._oContainer){this._createVariantEntries()}};l.prototype._savePersonalizationContainer=function(){var t=this;if(this._oContainer){this._oContainer.save().fail(function(){o.error("Saving personalization data failed");t._setErrorValueState(t.oResourceBundle.getText("VARIANT_MANAGEMENT_SAVE_FAILED"))}).done(function(){o.info("Saving personalization data succeeded");t.fireEvent("afterSave")})}};l.prototype.fireSave=function(t){var e=null,a=null;var i;if(!this._oVariantSet){return}if(t){if(t.overwrite){if(t.key){e=this._oVariantSet.getVariant(t.key)}}else{if(t.name){e=this._oVariantSet.addVariant(t.name);a=e;i=a.getVariantKey();this._createVariantItem(i,t.name);this.setInitialSelectionKey(i)}}if(e){this.fireEvent("save",t);var r=this._fetchVariant();if(r){e.setItemValue("filterBarVariant",r.filterBarVariant);e.setItemValue("filterbar",r.filterbar);e.setItemValue("basicSearch","");if(r.basicSearch){e.setItemValue("basicSearch",r.basicSearch)}i=e.getVariantKey();if(t.def){if(i){this._oVariantSet.setCurrentVariantKey(i)}}else{var n=this._oVariantSet.getCurrentVariantKey();if(i===n){this._oVariantSet.setCurrentVariantKey(null)}}}this.currentVariantSetModified(false);this._savePersonalizationContainer()}}};l.prototype._setStandardVariant=function(){if(this._oPersController&&this._oPersController.fireBeforeVariantSave){this._oPersController.fireBeforeVariantSave(a.STANDARD_VARIANT_NAME)}this._oStandardVariant=this._fetchVariant()};l.prototype._getStandardVariant=function(){return this._oStandardVariant};l.prototype._getVariantNamesAndKeys=function(){return this._oVariantSet.getVariantNamesAndKeys()};l.prototype._reorderList=function(t){var e=this.getItemByKey(t);if(e){this.removeVariantItem(e);var a=this._getIdxSorted(e.getTitle());this.insertVariantItem(e,a)}};l.prototype.fireManage=function(t){var e;var a=null,i=null;var r;if(!this._oVariantSet){return}if(t){a=t.renamed;i=t.deleted;if(a){for(e=0;e<a.length;e++){r=this._oVariantSet.getVariant(a[e].key);if(r){r.setVariantName(a[e].name);this._reorderList(a[e].key)}}}if(i){var n=this._oVariantSet.getCurrentVariantKey();for(e=0;e<i.length;e++){r=this._oVariantSet.getVariant(i[e]);if(r){this._oVariantSet.delVariant(i[e]);if(n&&n===r.getVariantKey()){this._oVariantSet.setCurrentVariantKey(null);this.setSelectionKey(this.getStandardVariantKey());this.fireSelect({key:this.getStandardVariantKey()})}}}}if(t.def){r=this._oVariantSet.getVariant(t.def);if(r||t.def===this.getStandardVariantKey()){this._oVariantSet.setCurrentVariantKey(t.def)}}if(i&&i.length>0||a&&a.length>0||t.def){this._savePersonalizationContainer()}}};l.prototype.fireSelect=function(t){var e=null;if(t&&t.key){if(this._oVariantSet){if(t.key===this.getStandardVariantKey()){e=this._getStandardVariant()}else{e=this._oVariantSet.getVariant(t.key)}}}if(e){this.currentVariantSetModified(false);this._applyVariant(e)}};l.prototype._getContent=function(t){var e=null;if(t){if(t.getItemValue){e={filterbar:t.getItemValue("filterbar"),filterBarVariant:t.getItemValue("filterBarVariant")};var a=t.getItemValue("basicSearch");if(a){e.basicSearch=a}}else{e=t}}return e};l.prototype._applyVariant=function(t){var e=this._getContent(t);this._applyVariantContent(e)};l.prototype._applyVariantContent=function(t){if(t&&this._oPersController&&this._oPersController.applyVariant){this._oPersController.applyVariant(t)}};l.prototype._fetchVariant=function(){if(this._oPersController&&this._oPersController.fetchVariant){return this._oPersController.fetchVariant()}return null};l.prototype._getPersistencyKey=function(){if(this._oPersController&&this._sKeyName){return this._oPersController.getProperty(this._sKeyName)}return null};l.prototype._setErrorValueState=function(t){this.setEnabled(false)};l.prototype.exit=function(){t.prototype.exit.apply(this,arguments);if(this._oManagedObjectModel){this._oManagedObjectModel.destroy();this._oManagedObjectModel=undefined}this._oVM.detachManage(this._fireManage,this);this._oVM.detachSelect(this._fireSelect,this);this._oVM.detachSave(this._fireSave,this);this._oStandardVariant=null;this._oPersController=null;this._sKeyName=null;this._oContainer=null;this._oVariantSet=null};return l});
/*!
 * SAPUI5
 * (c) Copyright 2009-2023 SAP SE. All rights reserved.
 */
sap.ui.predefine("sap/ui/comp/state/UIState", ["sap/ui/comp/library","sap/ui/base/ManagedObject","sap/ui/comp/odata/MetadataAnalyser","sap/ui/model/odata/AnnotationHelper","sap/ui/model/Context","sap/ui/core/Configuration","sap/base/util/isEmptyObject"],function(e,t,r,a,n,i,o){"use strict";var s=t.extend("sap.ui.comp.state.UIState",{metadata:{library:"sap.ui.comp",properties:{presentationVariant:{type:"object"},selectionVariant:{type:"object"},variantName:{type:"string"},valueTexts:{type:"object"},semanticDates:{type:"object"}}}});s._getFilterNamesWithValuesForCurrentLanguage=function(e){var t=[],r=i.getFormatSettings().getFormatLocale().getLanguage();if(e&&e.Texts){e.Texts.some(function(e){if(e.Language===r){e.PropertyTexts.forEach(function(e){var r,a=false;for(var n=0;n<t.length;n++){if(t[n].filterName===e.PropertyName){r=t[n];a=true;break}}if(e.PropertyName&&e.ValueTexts&&Object.keys(e.ValueTexts).length>0){e.ValueTexts.forEach(function(t){if(!r){r={filterName:e.PropertyName,keys:[]}}r.keys.push(t.PropertyValue)})}if(!a&&r&&r.keys.length){t.push(r)}});return true}return false})}return t};s._getFilterNamesWithValuesFromSelectOption=function(e,t){var r=[];if(e&&e.SelectOptions){e.SelectOptions.forEach(function(e){var a=t?t.indexOf(e.PropertyName)<0:true;if(a){var n={filterName:e.PropertyName,keys:[]};e.Ranges.forEach(function(e){if(e.Option==="EQ"&&e.Sign==="I"){n.keys.push(e.Low)}});r.push(n)}})}return r};s._determineFiltersWithOnlyKeyValues=function(e,t){var r,a,n=[];e=e||[];t=t||[];t.forEach(function(t){var i={filterName:t.filterName,keys:[]};a=null;e.some(function(e){if(t.filterName===e.filterName){a=e}return a!==null});for(var o=0;o<t.keys.length;o++){r=false;if(a){for(var s=0;s<a.keys.length;s++){if(t.keys[o]===a.keys[s]){r=true;break}}}if(!r){i.keys.push(t.keys[o])}}if(i.keys.length){n.push(i)}});return n};s.determineFiltersWithOnlyKeyValues=function(e,t,r){var a=s._getFilterNamesWithValuesForCurrentLanguage(e);var n=s._getFilterNamesWithValuesFromSelectOption(t,r);return s._determineFiltersWithOnlyKeyValues(a,n)};s.calculateValueTexts=function(e,t){var r=null;var a=function(e,t){var a=null;if(!r){r={Texts:[{ContextUrl:"",Language:i.getFormatSettings().getFormatLocale().getLanguage(),PropertyTexts:[]}]}}for(var n=0;n<r.Texts[0].PropertyTexts.length;n++){if(r.Texts[0].PropertyTexts[n].PropertyName===e){a=r.Texts[0].PropertyTexts[n];break}}if(!a){a={PropertyName:e,ValueTexts:[]};r.Texts[0].PropertyTexts.push(a)}a.ValueTexts.push({PropertyValue:t.key,Text:t.text})};if(t&&e&&e.SelectOptions){e.SelectOptions.forEach(function(e){if(t[e.PropertyName]){if(t[e.PropertyName].ranges){t[e.PropertyName].ranges.forEach(function(t){if(t.hasOwnProperty("text")){a(e.PropertyName,t)}})}if(t[e.PropertyName].items){t[e.PropertyName].items.forEach(function(t){if(t.hasOwnProperty("text")){a(e.PropertyName,t)}})}}})}return r};s.enrichWithValueTexts=function(e,t){var r=false,a,n,o,s=e;n=i.getFormatSettings().getFormatLocale().getLanguage().toLowerCase();if(t&&t.Texts){t.Texts.some(function(e){if(e.Language&&e.Language.toLowerCase()===n){a=e}return a!==null});if(a&&a.PropertyTexts){if(!o){o=JSON.parse(e)}a.PropertyTexts.forEach(function(e){var t=o[e.PropertyName];if(t&&t.ranges&&e.ValueTexts){e.ValueTexts.forEach(function(a){var n=null,i=-1;if(a.Text){t.ranges.some(function(e,t){if(!e.exclude&&e.operation==="EQ"&&e.value1===a.PropertyValue){n=e;i=t}return n!=null})}if(n){r=true;if(!t.items){t.items=[]}t.items.push({key:a.PropertyValue,text:a.Text});o[e.PropertyName].ranges.splice(i,1)}})}});if(r){s=JSON.stringify(o)}}}return s};s.createFromSelectionAndPresentationVariantAnnotation=function(e,t,i){var u={};if(t&&t.SelectOptions&&t.SelectOptions.length){u.SelectOptions=t.SelectOptions.map(function(e){return{PropertyName:e.PropertyName.PropertyPath,Ranges:e.Ranges.map(function(e){var t=new n(null,"/");return{Sign:r.getSelectionRangeSignType([e.Sign.EnumMember]),Option:r.getSelectionRangeOptionType([e.Option.EnumMember]),Low:e.Low&&a.format(t,e.Low)||undefined,High:e.High&&a.format(t,e.High)||undefined}})}})}if(t&&t.Parameters&&t.Parameters.length){u.Parameters=t.Parameters.map(function(e){var t=new n(null,"/");return{PropertyName:e.PropertyName.PropertyPath,PropertyValue:e.PropertyValue&&a.format(t,e.PropertyValue)||undefined}})}var l={};if(i&&i.lineItemAnnotation){if(!l.Visualizations){l.Visualizations=[]}var f=[];if(i.lineItemAnnotation.fields){var p=i.lineItemAnnotation.labels;var m=i.lineItemAnnotation.urlInfo;var c=i.lineItemAnnotation.importance;var y=i.lineItemAnnotation.criticality;i.lineItemAnnotation.fields.forEach(function(e){var t={Value:e};t.Label=p[e]?p[e]:null;t.IconUrl=m[e]?m[e]:null;t.Importance=c[e]?c[e]:null;t.Criticality=y[e]?y[e]:null;f.push(t)})}l.Visualizations.push({Type:"LineItem",Content:f})}if(i&&i.chartAnnotation){if(!l.Visualizations){l.Visualizations=[]}l.Visualizations.push({Type:"Chart",Content:{ChartType:i.chartAnnotation.chartType,Measures:i.chartAnnotation.measureFields,MeasureAttributes:Object.keys(i.chartAnnotation.measureAttributes).map(function(e){return{Measure:e,Role:i.chartAnnotation.measureAttributes[e].role}}),Dimensions:i.chartAnnotation.dimensionFields,DimensionAttributes:Object.keys(i.chartAnnotation.dimensionAttributes).map(function(e){return{Dimension:e,Role:i.chartAnnotation.dimensionAttributes[e].role}})}})}if(i&&i.maxItems){l.MaxItems=parseInt(i.maxItems)}if(i&&i.sortOrderFields){l.SortOrder=i.sortOrderFields.map(function(e){return{Property:e.name,Descending:e.descending}})}if(i&&i.groupByFields){l.GroupBy=i.groupByFields}if(i&&i.requestAtLeastFields){l.RequestAtLeast=i.requestAtLeastFields}return new s({presentationVariant:!o(l)?l:undefined,selectionVariant:!o(u)?u:undefined,variantName:e?e:undefined})};s.calcSemanticDates=function(e,t){var r=null;var a=function(e,t){var a=null;if(!r){r={Dates:[]}}for(var n=0;n<r.Dates.length;n++){if(r.Dates[n].PropertyName===e){a=r.Dates[n];break}}if(!a){a={PropertyName:e,Data:t.conditionTypeInfo.data};r.Dates.push(a)}};if(t&&e&&e.SelectOptions){e.SelectOptions.forEach(function(e){if(t[e.PropertyName]){if(t[e.PropertyName].ranges){if(t[e.PropertyName].hasOwnProperty("conditionTypeInfo")){a(e.PropertyName,t[e.PropertyName])}}}})}return r};s.enrichWithSemanticDates=function(e,t){var r=false,a,n=e;if(t&&t.Dates){if(!a){a=JSON.parse(e)}t.Dates.forEach(function(e){var t=a[e.PropertyName];if(t&&t.ranges&&e.Data){r=true;if(!t.items){t.items=[]}t.ranges[0].semantic=e.Data}});if(r){n=JSON.stringify(a)}}return n};return s});
/*!
 * SAPUI5
 * (c) Copyright 2009-2023 SAP SE. All rights reserved.
 */
sap.ui.predefine("sap/ui/comp/transport/TransportDialog", ["sap/ui/fl/transport/TransportDialog"],function(r){"use strict";var a=r.extend("sap.ui.comp.transport.TransportDialog",{metadata:{library:"sap.ui.comp",deprecated:true},renderer:{apiVersion:2}});return a},true);
/*!
 * SAPUI5
 * (c) Copyright 2009-2023 SAP SE. All rights reserved.
 */
sap.ui.predefine("sap/ui/comp/type/Interval", ["sap/ui/comp/util/DateTimeUtil","sap/ui/model/CompositeType","sap/ui/model/FormatException","sap/ui/model/ParseException","sap/ui/model/ValidateException","sap/ui/core/LocaleData"],function(e,t,i,a,n,r){"use strict";var s=t.extend("sap.ui.comp.type.Interval",{constructor:function(){t.apply(this,arguments);this.sName="Interval";this.bUseInternalValues=true}});s.prototype.formatValue=function(e,t){if(e==undefined||e==null){return null}if(!Array.isArray(e)){throw new i("Cannot format interval: "+e+" is expected as an Array but given the wrong format")}if(e.length<1||e.length>2){throw new i("Cannot format interval: "+e+" is expected as an Array with 1 or 2 entries")}if(!t){t="string"}switch(this.getPrimitiveType(t)){case"string":case"any":if(e[0]===null&&(e.length===1||e[1]===null)){return""}var a=this.oFormatOptions.type;var n=l.call(this,a);var r;var s;var o;if(a){if(a.isA("sap.ui.model.odata.type.Time")){r=a.formatValue(u(e[0]),"string")}else{r=a.formatValue(e[0],"string")}}else{r=e[0]}if(e.length===1||e[1]===null){o=r}else{if(a){if(a.isA("sap.ui.model.odata.type.Time")){s=a.formatValue(u(e[1]),"string")}else{s=a.formatValue(e[1],"string")}}else{s=e[1]}o=n.replace(/\{0\}/g,r).replace(/\{1\}/g,s)}return o;default:throw new i("Don't know how to format Interval to "+t)}};s.prototype.parseValue=function(e,t,i){if((!t||t==="any")&&typeof e==="string"){t="string"}switch(this.getPrimitiveType(t)){case"string":if(!e){return[null,null]}var n=this.oFormatOptions.type;var r=l.call(this,n);var s=o.call(this,n);var u=[];var p=e.indexOf(s);var m=null;var h=null;if(p<0&&s.length>1){s=s.replace(/\s+/g,"");p=e.indexOf(s)}if(p<0&&s!==" - "&&s!=="-"){s=" - ";p=e.indexOf(s)}if(p<0&&s!=="-"){s="-";p=e.indexOf(s)}if(p===0&&s==="-"){p=e.slice(1).indexOf(s);if(p>=0){p++}}if(p<0){m=e;if(!m){throw new a(e+" is not a valid interval")}}else if(p===0){m="";h=e.slice(s.length);if(!h){throw new a(e+" is not a valid interval")}}else{m=e.slice(0,p);h=e.slice(p+s.length);if(!m||!h){throw new a(e+" is not a valid interval")}}if(n){m=n.parseValue(m,"string");if(n.isA("sap.ui.model.odata.type.Time")){m=f(m)}if(p>=0){h=n.parseValue(h,"string");if(n.isA("sap.ui.model.odata.type.Time")){h=f(h)}}}if(r.indexOf("{0}")<r.indexOf("{1}")){u.push(m);u.push(h)}else{u.push(h);u.push(m)}return u;default:throw new a("Don't know how to parse Interval from "+t)}};s.prototype.validateValue=function(e){if(e==undefined||e==null){return}if(!Array.isArray(e)){throw new n("An array is expected")}if(e.length<1||e.length>2){throw new n("There must be only one or two values in the array")}if(e.length===2&&e[1]!==null&&typeof e[0]!==typeof e[1]){throw new n("Low and high value must have the same type")}var t=this.oFormatOptions.type;if(t){if(t.isA("sap.ui.model.odata.type.Time")){t.validateValue(u(e[0]))}else{t.validateValue(e[0])}if(e.length===2&&e[1]!==null){if(t.isA("sap.ui.model.odata.type.Time")){t.validateValue(u(e[1]))}else{t.validateValue(e[1])}}}if(typeof e[0]==="number"){if(e.length===2&&e[1]!==null&&e[0]>e[1]){throw new n("Low value must be smaller than high value")}}else if(e[0]instanceof Date){if(e.length===2&&e[1]instanceof Date&&e[0]>e[1]){throw new n("Low value must be smaller than high value")}}};s.prototype._handleLocalizationChange=function(){delete this._sPattern;delete this._sDelimiter};function l(e){if(this.oFormatOptions.delimiter){return"{0} "+this.oFormatOptions.delimiter+" {1}"}else if(!this._sPattern){var t=sap.ui.getCore().getConfiguration().getFormatSettings().getFormatLocale();var i=r.getInstance(t);if(e&&(e.isA("sap.ui.model.type.Time")||e.isA("sap.ui.model.odata.type.Time")||e.isA("sap.ui.model.type.Date")||e.isA("sap.ui.model.odata.type.Date")||e.isA("sap.ui.model.type.DateTime")||e.isA("sap.ui.model.odata.type.DateTime")||e.isA("sap.ui.model.odata.type.DateTimeOffset")||e.isA("sap.ui.model.odata.type.TimeOfDay"))){this._sPattern=i.getIntervalPattern()}else{this._sPattern=i.getMiscPattern("range")}return this._sPattern}else{return this._sPattern}}function o(e){if(this.oFormatOptions.delimiter){return this.oFormatOptions.delimiter}else if(!this._sDelimiter){var t=l.call(this,e);this._sDelimiter=t.replace(/\{0\}/g,"").replace(/\{1\}/g,"");return this._sDelimiter}else{return this._sDelimiter}}function u(t){if(t instanceof Date){t=e.localToUtc(t);return e.dateToEdmTime(t)}else{return t}}function f(t){var i;if(t&&t.ms){i=e.edmTimeToDate(t);return e.utcToLocal(i)}else{return t}}return s});
/*!
 * SAPUI5
 * (c) Copyright 2009-2023 SAP SE. All rights reserved.
 */
sap.ui.predefine("sap/ui/comp/util/ComboBoxUtils", ["sap/ui/comp/util/FormatUtil"],function(i){"use strict";return{formatDisplayBehaviour:function(e,n){var r,t,a,u,s,o,g;if(e===null||e===undefined||!n){return}o=e.getKey();g=e&&e.getBinding("text");if(o!==""&&g&&Array.isArray(g.aBindings)){u=g.aBindings[0];s=g.aBindings[1];t=u&&u.getValue();a=s&&s.getValue();if(o!==t){return}r=i.getFormattedExpressionFromDisplayBehaviour(n,t,a)}return r}}});
/*!
 * SAPUI5
 * (c) Copyright 2009-2023 SAP SE. All rights reserved.
 */
sap.ui.predefine("sap/ui/comp/util/DateTimeUtil", ["sap/ui/core/date/UI5Date","sap/ui/core/format/TimezoneUtil","sap/ui/core/Configuration"],function(e,t,n){"use strict";var i=/^\/Date\((-?\d+)(\+|-)?(\d+)?\)\/$/,o=n.getTimezone();var r={localToUtc:function(t){var n,i="0",o=t.getFullYear().toString().padStart(4,i)+"-"+(t.getMonth()+1).toString().padStart(2,i)+"-"+t.getDate().toString().padStart(2,i)+"T00:00:00.000Z";n=e.getInstance(o);n.setUTCHours(t.getHours());n.setUTCMinutes(t.getMinutes());n.setUTCSeconds(t.getSeconds());n.setUTCMilliseconds(t.getMilliseconds());return n},utcToLocal:function(t){var n,i="0",o=t.getUTCFullYear().toString().padStart(4,i)+"-"+(t.getUTCMonth()+1).toString().padStart(2,i)+"-"+t.getUTCDate().toString().padStart(2,i)+"T00:00:00.000";n=e.getInstance(o);n.setHours(t.getUTCHours());n.setMinutes(t.getUTCMinutes());n.setSeconds(t.getUTCSeconds());n.setMilliseconds(t.getUTCMilliseconds());return n},dateToEdmTime:function(e){return{__edmType:"Edm.Time",ms:e.valueOf()}},edmTimeToDate:function(t){return e.getInstance(t.ms)},adaptPrecision:function(t,n){var i=t.getMilliseconds(),o;if(isNaN(n)||n>=3||i===0){return t}if(n===0){i=0}else if(n===1){i=Math.floor(i/100)*100}else if(n===2){i=Math.floor(i/10)*10}o=e.getInstance(t);o.setMilliseconds(i);return o},isDate:function(e,t){if(t){return e.getUTCHours()===0&&e.getUTCMinutes()===0&&e.getUTCSeconds()===0&&e.getUTCMilliseconds()===0}else{return e.getHours()===0&&e.getMinutes()===0&&e.getSeconds()===0&&e.getMilliseconds()===0}},normalizeDate:function(t,n){var i;if(this.isDate(t,n)){return t}i=e.getInstance(t);if(n){i.setUTCHours(0,0,0,0)}else{i.setHours(0,0,0,0)}return i},toTimezone:function(n,i){if(!(n instanceof Date)){n=e.getInstance(n)}if(t.isValidTimezone(i)){return t.convertToTimezone(n,i)}return n},localToUiTimezone:function(t){var n=e.getInstance(t.toLocaleString("en-US",{timeZone:o}));var i=t.getTime()-n.getTime();return e.getInstance(t.getTime()-i)},uiTimezoneToLocal:function(t){if(!(t instanceof Date)){t=e.getInstance(t)}var n=e.getInstance(t.toLocaleString("en-US",{timeZone:o}));var i=n.getTime()-t.getTime();return e.getInstance(t.getTime()-i)},uiTimezoneToUtc:function(t){var n=e.getInstance(t.toLocaleString("en-US",{timeZone:"UTC"}));var i=e.getInstance(t.toLocaleString("en-US",{timeZone:o}));var r=i.getTime()-n.getTime();return e.getInstance(t.getTime()-r)},localToTimezone:function(n,i){if(!t.isValidTimezone(i)){return n}var r=e.getInstance(n.toLocaleString("en-US",{timeZone:i}));var a=e.getInstance(n.toLocaleString("en-US",{timeZone:o}));var s=a.getTime()-r.getTime();return e.getInstance(n.getTime()-s)},_parseJsonDateString:function(t){var n=t&&i.exec(t);if(n){var o=e.getInstance(parseInt(n[1]));if(n[2]){var r=parseInt(n[3]);if(n[2]==="-"){r=-r}var a=o.getUTCMinutes();o.setUTCMinutes(a-r);o.__edmType="Edm.DateTimeOffset"}if(!isNaN(o.valueOf())){return o}}},_hasJsonDateString:function(e){return i.test(e)}};return r});
/*!
 * SAPUI5
 * (c) Copyright 2009-2023 SAP SE. All rights reserved.
 */
sap.ui.predefine("sap/ui/comp/util/FilterUtil", [],function(){"use strict";return{getTransformedExcludeOperation:function(t){var n={EQ:"NE",GE:"LT",LT:"GE",LE:"GT",GT:"LE",BT:"NB",Contains:"NotContains",StartsWith:"NotStartsWith",EndsWith:"NotEndsWith"}[t];return n?n:t}}});
/*!
 * SAPUI5
 * (c) Copyright 2009-2023 SAP SE. All rights reserved.
 */
sap.ui.predefine("sap/ui/comp/util/FormatUtil", ["sap/ui/core/format/NumberFormat","sap/ui/core/format/DateFormat","sap/m/P13nConditionPanel","sap/ui/comp/odata/ODataType","sap/ui/model/odata/type/Currency","sap/ui/model/odata/type/Unit","sap/base/strings/whitespaceReplacer"],function(e,t,r,n,i,a,o){"use strict";var u={CHAR_FIGURE_SPACE:"",CHAR_PUNCTUATION_SPACE:"",MAX_CURRENCY_DIGITS:3,getFormattedExpressionFromDisplayBehaviour:function(e,t,r){return u.getFormatterFunctionFromDisplayBehaviour(e)(t,r)},getFormatterFunctionFromDisplayBehaviour:function(e,t,r){var n=t?"Whitespace":"";var i=r?"OverrideNoData":"";if(i){switch(e){case"descriptionAndId":return u["_get"+i+"TextFormatterForDescriptionAndId"].bind(r);case"idAndDescription":return u["_get"+i+"TextFormatterForIdAndDescription"].bind(r);case"descriptionOnly":return u["_get"+i+"TextFormatterForDescriptionOnly"].bind(r);default:return u["_get"+i+"TextFormatterForIdOnly"].bind(r)}}switch(e){case"descriptionAndId":return u["_get"+n+i+"TextFormatterForDescriptionAndId"];case"idAndDescription":return u["_get"+n+i+"TextFormatterForIdAndDescription"];case"descriptionOnly":return u["_get"+n+i+"TextFormatterForDescriptionOnly"];default:return u["_get"+n+i+"TextFormatterForIdOnly"]}},_processText:function(e,t){if(t){return e}return e.secondText?e.firstText+" ("+e.secondText+")":e.firstText},_getTextFormatterForDescriptionAndId:function(e,t,r){return u._processText({firstText:t?t:e,secondText:t?e:undefined},r)},_getTextFormatterForIdAndDescription:function(e,t,r){return u._processText({firstText:e,secondText:t?t:undefined},r)},_getTextFormatterForDescriptionOnly:function(e,t,r){return u._processText({firstText:t,secondText:undefined},r)},_getTextFormatterForIdOnly:function(e,t,r){return u._processText({firstText:e,secondText:undefined},r)},_getWhitespaceTextFormatterForDescriptionAndId:function(e,t,r){return o(u._getTextFormatterForDescriptionAndId.apply(u,arguments))},_getWhitespaceTextFormatterForIdAndDescription:function(e,t,r){return o(u._getTextFormatterForIdAndDescription.apply(u,arguments))},_getWhitespaceTextFormatterForDescriptionOnly:function(e,t,r){return o(u._getTextFormatterForDescriptionOnly.apply(u,arguments))},_getWhitespaceTextFormatterForIdOnly:function(e,t,r){return o(u._getTextFormatterForIdOnly.apply(u,arguments))},_getOverrideNoDataTextFormatterForDescriptionAndId:function(e,t,r){if(e==""&&t==""){return this.getNotAssignedText()}return u._getTextFormatterForDescriptionAndId.apply(u,arguments)},_getOverrideNoDataTextFormatterForIdAndDescription:function(e,t,r){if(e==""&&t==""){return this.getNotAssignedText()}return u._getTextFormatterForIdAndDescription.apply(u,arguments)},_getOverrideNoDataTextFormatterForDescriptionOnly:function(e,t,r){if(t==""){return this.getNotAssignedText()}return u._getTextFormatterForDescriptionOnly.apply(u,arguments)},_getOverrideNoDataTextFormatterForIdOnly:function(e,t,r){if(e==""){return this.getNotAssignedText()}return u._getTextFormatterForIdOnly.apply(u,arguments)},getTextsFromDisplayBehaviour:function(e,t,r){return u.getFormatterFunctionFromDisplayBehaviour(e)(t,r,true)},getFormattedRangeText:function(e,t,n,i){return r.getFormatedConditionText(e,t,n,i)},_initialiseCurrencyFormatter:function(){if(!u._oCurrencyFormatter){u._oCurrencyFormatter=e.getCurrencyInstance({showMeasure:false})}if(!u._fAmountCurrencyFormatter){u._fAmountCurrencyFormatter=function(e,t){var r,n;r=u._oCurrencyFormatter.format(e,t);n=u._oCurrencyFormatter.oLocaleData.getCurrencyDigits(t);return u._applyPadding(r,n,u.MAX_CURRENCY_DIGITS)}}},_getUnitFormatter:function(t,r){const n={showMeasure:false,maxFractionDigits:3,minFractionDigits:0,preserveDecimals:t};if(!isNaN(r)){r=parseInt(r)}if(r>=0&&r<=3){n.maxFractionDigits=n.minFractionDigits=r}return e.getUnitInstance(n)},_applyPadding:function(e,t,r){var n;if(typeof e!=="string"){return""}if(t===0&&r>0){e+=u.CHAR_PUNCTUATION_SPACE}n=r-t;if(n){e=e.padEnd(e.length+n,u.CHAR_FIGURE_SPACE)}return e},_getFractionDigitDifference:function(e,t,r,n){if(!t){return 0}var i=t.indexOf(e.oOutputFormat.oFormatOptions.decimalSeparator);if(i<0){return 0}var a=t.substr(i+1).length;if(a<=n&&a>r){return a-r}if(a>n&&r<n){return n-r}return 0},getAmountCurrencyFormatter:function(e){var t=0,r,n;u._initialiseCurrencyFormatter();return function(i,a,o){var s,c;if(i===undefined||i===null||a==="*"){return""}if(!o){return u._fAmountCurrencyFormatter(i,a)}if(!n){n=o;t=u._getMaxCurrencyFractionDigits(n);if(!r){r=u._getCurrencyInstance(e)}}c=n&&n[a]?n[a].UnitSpecificScale:u._oCurrencyFormatter.oLocaleData.getCurrencyDigits(a);s=r.formatValue([i,a||null,n],"string");if(e){c+=u._getFractionDigitDifference(r,s,c,t)}return u._applyPadding(s,c,t)}},_getMaxCurrencyFractionDigits:function(e){var t=0;for(var r in e){if(e[r].UnitSpecificScale&&e[r].UnitSpecificScale>t){t=e[r].UnitSpecificScale}}return t},_getCurrencyInstance:function(e){return new i({showMeasure:false,preserveDecimals:e})},getCurrencySymbolFormatter:function(){u._initialiseCurrencyFormatter();if(!u._fCurrencySymbolFormatter){u._fCurrencySymbolFormatter=function(e){if(!e||e==="*"){return""}return u._oCurrencyFormatter.oLocaleData.getCurrencySymbol(e)}}return u._fCurrencySymbolFormatter},getMeasureUnitFormatter:function(e,t){const r=u._getUnitFormatter(e,t);var n=0,i,a;return function(t,o,s){if(t===undefined||t===null||o==="*"){return""}if(s){if(!a){a=s;n=u._getMaxMeasureUnitFractionDigit(a);if(!i){i=u._getUnitInstance(e,n)}}t=i.formatValue([t,o,a],"string");var c=a[o]&&a[o].UnitSpecificScale!=null?a[o].UnitSpecificScale:n;if(e){c+=u._getFractionDigitDifference(i,t,c,n)}return u._applyPadding(t,c,n)}return r.format(t,o)+u.CHAR_FIGURE_SPACE}},getInlineMeasureUnitFormatter:function(e){var t=0,r,n;if(!u._fInlineMeasureFormatter){u._fInlineMeasureFormatter=function(e,t){if(e===undefined||e===null||t==="*"){return""}if(!t){return e}return e+u.CHAR_FIGURE_SPACE+t}}return function(i,a,o){if(o){if(!n){n=o;t=u._getMaxMeasureUnitFractionDigit(n);if(!r){r=u._getUnitInstance(e,t)}}i=r.formatValue([i,a,n],"string");return i+u.CHAR_FIGURE_SPACE+a}return u._fInlineMeasureFormatter(i,a)}},_getUnitInstance:function(e,t){return new a({showMeasure:false,preserveDecimals:e,maxFractionDigits:t})},_getMaxMeasureUnitFractionDigit:function(e){var t=0;for(var r in e){var n=e[r].UnitSpecificScale;if(n>3){e[r].UnitSpecificScale=3;n=3}if(t<3&&n>t&&n<=3){t=n}}return t},getInlineAmountFormatter:function(e){var t,r;u._initialiseCurrencyFormatter();if(!u._fInlineAmountFormatter){u._fInlineAmountFormatter=function(e,t){var r;if(e===undefined||e===null||t==="*"){return""}r=u._oCurrencyFormatter.format(e,t);return r+u.CHAR_FIGURE_SPACE+t}}return function(n,i,a){if(n===undefined||n===null||i==="*"){return""}if(!a){return u._fInlineAmountFormatter(n,i)}if(!r){r=a;if(!t){t=u._getCurrencyInstance(e)}}var o=t.formatValue([n,i||null,r],"string");return o+u.CHAR_FIGURE_SPACE+i}},getInlineGroupFormatterFunction:function(e,t,r,i,a,o){var s=e.type==="Edm.String"&&!e.isCalendarDate&&!e.isDigitSequence;if(e.unit){return u.getRelevantUnitFormatterFunction(o,e,i)}else if(!t&&(s||e.displayBehaviour!=="idOnly")&&e.description){const t=u.getFormatterFunctionFromDisplayBehaviour(e.displayBehaviour,a);if(e.isDigitSequence&&e.modelType){return function(r,n){const i=e.modelType.formatValue(r,"string");return t(i,n)}}return t}else if(e.type==="Edm.DateTime"&&e.displayFormat==="Date"&&r&&r["UTC"]){var c={displayFormat:"Date"};var f={isCalendarDate:e.isCalendarDate};var m=n.getType(e.type,r,c,f);return function(e){return m.formatValue(e,"string")}}else if(e.modelType){return function(t){return e.modelType.formatValue(t,"string")}}},getWidth:function(e,t,r){var n=e.maxLength||e.precision,i,a;if(!t){t=30}if(!r){r=3;a=true}if(e.type==="Edm.DateTime"&&e.displayFormat==="Date"||e.isCalendarDate){n="9em"}else if(n){if(e.type==="Edm.String"&&e.description&&e.displayBehaviour&&(e.displayBehaviour==="descriptionAndId"||e.displayBehaviour==="descriptionOnly")){n="Max"}if(n==="Max"){n=t+""}i=parseInt(n);if(!isNaN(i)){i+=.75;if(i>t){i=t}else if(i<r){i=r}n=i+"em"}else{n=null}}if(!n){if(e.type==="Edm.Boolean"){if(a){r+=.25}n=r+"em"}else{n=t+"em"}}return n},getEdmTimeFromDate:function(e){if(!u._oTimeFormat){u._oTimeFormat=t.getTimeInstance({pattern:"'PT'HH'H'mm'M'ss'S'"})}return u._oTimeFormat.format(e)},parseFilterNumericIntervalData:function(e){var t=[],r=e.match(RegExp("^(-?[^-]*)-(-?[^-]*)$"));if(r&&r.length>=2){t.push(r[1]);t.push(r[2])}return t},parseDateTimeOffsetInterval:function(e){var t=e.split("-"),r=[e],n=0;if(t.length%2===0){r=[];for(var i=0;i<t.length/2;i++){n=e.indexOf("-",++n)}r.push(e.substr(0,n).replace(/\s+/g,""));r.push(e.substr(n+1).replace(/\s+/g,""))}return r},_getFilterType:function(e){if(e.isFiscalDate){return"date"}else if(e.isCalendarType&&e.calendarType){return"date"}else if(e.isDigitSequence){return"numc"}else if(n.isNumeric(e.type)){return"numeric"}else if(e.type==="Edm.DateTime"&&e.displayFormat==="Date"){return"date"}else if(e.type==="Edm.DateTimeOffset"){return"datetime"}else if(e.type==="Edm.String"){if(e.isCalendarDate){return"stringdate"}return"string"}else if(e.type==="Edm.Guid"){return"guid"}else if(e.type==="Edm.Boolean"){return"boolean"}else if(e.type==="Edm.Time"){return"time"}return undefined},getWhitespaceReplacer:function(e){return e?o:undefined},getDateTimeWithTimezoneFormatter:function(e){if(!e&&!u._oDateTimeWithTimezone){u._oDateTimeWithTimezone=t.getDateTimeWithTimezoneInstance()}return function(r,n){if(!r){return""}return e?t.getDateTimeWithTimezoneInstance(e).format(r,n):u._oDateTimeWithTimezone.format(r,n)}},getRelevantUnitFormatterFunction:function(e,t,r){var n,i=t.isCurrencyField,a=i?u.getInlineAmountFormatter(r):u.getInlineMeasureUnitFormatter(r);if(e){if(i){e.requestCurrencyCodes().then(function(e){n=e})}else{e.requestUnitsOfMeasure().then(function(e){n=e})}}return function(e,r){if(!n){if(i){return a(e,r)}if(t.modelType){e=t.modelType.formatValue(e,"string")}return a(e,r)}return a(e,r,n)}}};return u},true);
/*!
 * SAPUI5
 * (c) Copyright 2009-2023 SAP SE. All rights reserved.
 */
sap.ui.predefine("sap/ui/comp/util/FullScreenUtil", ["sap/ui/thirdparty/jquery","sap/m/Dialog","sap/ui/core/HTML"],function(jQuery,e,l){"use strict";var o={toggleFullScreen:function(o,a,n,i,r,t){var g;if(a){g=o.$();g.css("height","100%");if(g){if(!o._oHTML){o._oHTML=new l({preferDOM:false,afterRendering:function(){if(o&&o._oHTML){var e=o._oHTML.$(),l;if(e){l=e.children();l.remove();e.css("height","100%");e.append(o.getDomRef())}}}})}if(!o._oFullScreenDialog){o._oFullScreenDialog=new e({showHeader:false,stretch:true,horizontalScrolling:!t,verticalScrolling:!t,beforeClose:function(){if(o&&o._$placeHolder&&i){i.call(o,false)}},content:[o._oHTML]});if(r){o._oFullScreenDialog.addStyleClass(r)}if(n){o._oFullScreenDialog.attachAfterOpen(function(){n.focus();if(o._oGrowingDelegate&&o._oGrowingDelegate.onAfterRendering){o._oOldParent=o.oParent;o.oParent=o._oFullScreenDialog;o._oGrowingDelegate.onAfterRendering();o.oParent=o._oOldParent;delete o._oOldParent}});o._oFullScreenDialog.attachAfterClose(function(){n.focus()})}o._oFullScreenDialog.addStyleClass(g.closest(".sapUiSizeCompact").length?"sapUiSizeCompact":"");o._oFullScreenDialog.addStyleClass("sapUiCompSmartFullScreenDialog")}o._$placeHolder=jQuery(document.createElement("div"));g.before(o._$placeHolder);o._oHTML.setContent("<div></div>")}if(!o._oGrowingDelegate){o._oGrowingDelegate=o._oTable||o._oList;if(o._oGrowingDelegate&&o._oGrowingDelegate.getGrowingScrollToLoad&&o._oGrowingDelegate.getGrowingScrollToLoad()){o._oGrowingDelegate=o._oGrowingDelegate._oGrowingDelegate}else{o._oGrowingDelegate=null}}if(o._oTable&&o._oTable.isA("sap.ui.table.Table")){o._oFullScreenDialog.attachEventOnce("afterOpen",function(){o._oTable.invalidate()})}o._oFullScreenDialog.open()}else if(o._$placeHolder&&o._oHTML){var c=o.getHeight&&o.getHeight();var _=o.$();if(c&&c!==_.css("height")){_.css("height",c)}g=o._oHTML.$();o._$placeHolder.replaceWith(g.children());o._$placeHolder=null;g=null;if(o._oFullScreenDialog){o._oFullScreenDialog.close()}}},cleanUpFullScreen:function(e){if(e._oFullScreenDialog){e._oFullScreenDialog.destroy();e._oFullScreenDialog=null}e._$placeHolder=null;e._oHTML=null;e._oGrowingDelegate=null}};return o},true);
/*!
 * SAPUI5
 * (c) Copyright 2009-2023 SAP SE. All rights reserved.
 */
sap.ui.predefine("sap/ui/comp/util/IdentifierUtil", ["sap/ui/base/DataType"],function(e){"use strict";var a={replace:function(a){var i=e.getType("sap.ui.core.ID");if(!i.isValid(a)){a=a.replace(/[^A-Za-z0-9_.:]+/g,"_");if(!i.isValid(a)){a="A_"+a}}return a}};return a},true);
/*!
 * SAPUI5
 * (c) Copyright 2009-2023 SAP SE. All rights reserved.
 */
sap.ui.predefine("sap/ui/comp/util/MultiUnitUtil", ["sap/m/List","sap/m/ResponsivePopover","sap/m/CustomListItem","sap/ui/model/Filter","sap/ui/model/FilterOperator","sap/ui/core/syncStyleClass","sap/base/util/merge"],function(e,t,a,r,i,o,n){"use strict";var s={isMultiUnit:function(e){return e==="*"},isNotMultiUnit:function(e){return e!=="*"},openMultiUnitPopover:function(s,l){var p=sap.ui.getCore().byId(l.smartTableId);var u=p.getTable();var g=u.getBinding("rows");var d=l.value;var c=l.unit;var m=l.template;var T,f;if(!g||!d||!c){return}var v=s.getSource();var y=v.getParent();if(l.additionalParent){y=y.getParent()}var P=u.getAnalyticalInfoOfRow(y.getParent());if(!P){return}var b,L=[],I=[d,c],C=sap.ui.getCore().getLibraryResourceBundle("sap.ui.comp").getText("SMARTTABLE_MULTI_TOTAL_TITLE")||"Total";if(g.aApplicationFilter){L=[].concat(g.aApplicationFilter)}var U=u.getBindingInfo("rows");var A=U&&U.parameters&&U.parameters.custom?n({},U.parameters.custom):undefined;if(P.groupTotal||P.group){var B=P.groupedColumns;for(b=0;b<B.length;b++){f=sap.ui.getCore().byId(B[b]).getLeadingProperty();if(!f){continue}T=g.getAnalyticalInfoForColumn(f);if(T){f=T.dimensionPropertyName}if(f){L.push(new r(f,i.EQ,P.context.getProperty(f)))}}C=sap.ui.getCore().getLibraryResourceBundle("sap.ui.comp").getText("SMARTTABLE_MULTI_GROUP_TITLE")||"Subtotal"}else if(!P.grandTotal){var S=Object.getOwnPropertyNames(g.getDimensionDetails());for(b=0;b<S.length;b++){L.push(new r(S[b],i.EQ,P.context.getProperty(S[b])))}C=sap.ui.getCore().getLibraryResourceBundle("sap.ui.comp").getText("SMARTTABLE_MULTI_GROUP_TITLE")||"Subtotal"}var w=m.clone();w.unbindProperty("visible");var M=l.smartTableId+"-multiUnitPopover",R,_;R=sap.ui.getCore().byId(M);if(!R){_=new e(M+"-detailsList",{showSeparators:"None",ariaLabelledBy:M+"-title"});_.addStyleClass("sapUiContentPadding sapUiCompMultiCurrency");R=new t(M,{content:_});o("sapUiSizeCompact",u,R);u.addDependent(R)}if(!_){_=sap.ui.getCore().byId(M+"-detailsList")}R.setTitle(C);R.setPlacement(P.grandTotal?"VerticalPreferredTop":"VerticalPreferredBottom");_.bindItems({path:g.getPath(),filters:L,parameters:{select:I.join(","),custom:A},templateShareable:false,template:new a({content:[w]})});R.openBy(v)}};return s},true);
/*!
 * SAPUI5
 * (c) Copyright 2009-2023 SAP SE. All rights reserved.
 */
sap.ui.predefine("sap/ui/comp/valuehelpdialog/ItemsCollection", ["sap/ui/comp/util/FormatUtil","sap/ui/base/ManagedObject","sap/m/Token"],function(t,e,i){"use strict";var s=function(){this.items={}};s.prototype.add=function(t,e){this.items[t]=e};s.prototype.remove=function(t){delete this.items[t]};s.prototype.removeAll=function(){this.items={}};s.prototype.getItem=function(t){return this.items[t]};s.prototype.getItems=function(){var t=[];for(var e in this.items){t.push(e)}return t};s.prototype.getSelectedItemsTokenArray=function(s,r,o){var n=[];for(var a in this.items){var p=this.items[a];var u,f;if(typeof p==="string"){f=a;u=p}else{f=p[s];u=p[r];if(u===undefined){u=this.items[a];if(typeof u!=="string"){u=f}}else{if(!o){o="descriptionAndId"}u=t.getFormattedExpressionFromDisplayBehaviour(o,f,u)}}var m=new i({key:e.escapeSettingsValue(f)});m.setText(u);m.setTooltip(typeof u==="string"?u:"");if(typeof p!=="string"){m.data("row",p);m.data("longKey",e.escapeSettingsValue(a))}n.push(m)}return n};s.prototype.getModelData=function(){var t=[];for(var e in this.items){var i=this.items[e];if(typeof i==="string"){i={missing:e}}t.push(i)}return t};return s},true);
/*!
 * SAPUI5
 * (c) Copyright 2009-2023 SAP SE. All rights reserved.
 */
sap.ui.predefine("sap/ui/comp/valuehelpdialog/ValueHelpDialog", ["sap/ui/core/Core","sap/ui/core/date/UI5Date","sap/base/Log","sap/ui/comp/library","sap/m/Dialog","sap/m/MessageBox","sap/m/Token","./ItemsCollection","sap/ui/core/library","sap/m/VBox","sap/m/HBox","sap/m/FlexBox","sap/ui/comp/util/FormatUtil","sap/m/FlexItemData","sap/m/Title","sap/m/Text","sap/m/Label","sap/m/Button","sap/m/Bar","sap/m/OverflowToolbarLayoutData","sap/m/Tokenizer","sap/m/Panel","sap/m/StandardListItem","sap/m/IconTabBar","sap/m/IconTabFilter","sap/m/library","sap/ui/core/InvisibleText","sap/ui/core/InvisibleMessage","sap/ui/core/IconPool","sap/ui/table/library","sap/ui/table/Table","sap/ui/table/Column","sap/ui/table/rowmodes/Type","sap/ui/table/rowmodes/Auto","sap/m/Table","sap/m/Column","sap/m/table/columnmenu/Menu","sap/m/table/columnmenu/QuickSort","sap/m/table/columnmenu/QuickSortItem","sap/ui/layout/HorizontalLayout","sap/ui/layout/Grid","sap/ui/Device","sap/m/List","sap/m/Link","sap/ui/comp/p13n/P13nFilterPanel","sap/m/P13nConditionPanel","sap/m/P13nItem","sap/m/P13nAnyFilterItem","sap/m/CheckBox","sap/ui/comp/p13n/P13nOperationsHelper","sap/ui/core/format/NumberFormat","sap/ui/core/ResizeHandler","sap/base/strings/whitespaceReplacer","sap/ui/table/plugins/MultiSelectionPlugin","sap/ui/comp/rules/RulesLog","sap/m/Toolbar","sap/ui/core/util/ResponsivePaddingsEnablement","sap/m/plugins/CellSelector","sap/m/ToolbarSpacer","sap/m/OverflowToolbar","sap/m/plugins/CopyProvider"],function(e,t,i,s,a,o,n,l,r,h,_,d,u,c,g,p,f,T,b,S,y,I,m,v,C,B,R,k,E,P,L,V,F,x,O,A,D,w,M,N,H,K,z,G,W,U,j,q,$,Q,Z,Y,J,X,ee,te,ie,se,ae,oe,ne){"use strict";var le;var re=B.ButtonType;var he=B.OverflowToolbarPriority;var _e=B.ListMode;var de=B.ListType;var ue=r.HorizontalAlign;var ce=r.InvisibleMessageMode;var ge=r.TitleLevel;var pe=s.smartfilterbar.DisplayBehaviour;var fe={DESKTOP_LIST_VIEW:"DESKTOP_LIST_VIEW",DESKTOP_CONDITIONS_VIEW:"DESKTOP_CONDITIONS_VIEW",PHONE_MAIN_VIEW:"PHONE_MAIN_VIEW",PHONE_SEARCH_VIEW:"PHONE_SEARCH_VIEW",PHONE_LIST_VIEW:"PHONE_LIST_VIEW",PHONE_CONDITIONS_VIEW:"PHONE_CONDITIONS_VIEW"};var Te=a.extend("sap.ui.comp.valuehelpdialog.ValueHelpDialog",{metadata:{library:"sap.ui.comp",properties:{basicSearchText:{type:"string",group:"Misc",defaultValue:""},supportMultiselect:{type:"boolean",group:"Misc",defaultValue:true},supportRanges:{type:"boolean",group:"Misc",defaultValue:false},supportRangesOnly:{type:"boolean",group:"Misc",defaultValue:false},key:{type:"string",group:"Misc",defaultValue:""},keys:{type:"string[]",group:"Misc",defaultValue:null},descriptionKey:{type:"string",group:"Misc",defaultValue:""},maxIncludeRanges:{type:"string",group:"Misc",defaultValue:"-1",deprecated:true},maxExcludeRanges:{type:"string",group:"Misc",defaultValue:"-1",deprecated:true},maxConditions:{type:"string",group:"Misc",defaultValue:"-1"},displayFormat:{type:"string",group:"Misc",defaultValue:""},tokenDisplayBehaviour:{type:"string",group:"Misc",defaultValue:""},filterMode:{type:"boolean",group:"Misc",defaultValue:false},_enhancedExcludeOperations:{type:"boolean",group:"Misc",defaultValue:false,visibility:"hidden"},conditionPanelDefaultOperation:{type:"string",group:"Misc",defaultValue:null},enabledMultiSelectionPlugin:{type:"boolean",group:"Misc",defaultValue:false},_conditionPanelCalendarWeekSettings:{type:"string",group:"Misc",defaultValue:"",visibility:"hidden"}},aggregations:{filterBar:{type:"sap.ui.comp.filterbar.FilterBar",multiple:false}},events:{ok:{parameters:{tokens:{type:"sap.m.Token[]"}}},cancel:{},selectionChange:{parameters:{tableSelectionParams:{type:"object"},updateTokens:{type:"object[]"},useDefault:{type:"boolean"},table:{type:"object"}}},tokenRemove:{parameters:{tokenKeys:{type:"string[]"},useDefault:{type:"boolean"}}},updateSelection:{parameters:{tokenKeys:{type:"string[]"},useDefault:{type:"boolean"}}}}},renderer:{apiVersion:2}});ie.call(Te.prototype,{header:{suffix:"header"},subHeader:{selector:".compVHNavigationContainer .sapMITH"},content:{selector:".compVHContentContainer"},footer:{selector:".sapMDialogFooter .sapMIBar"}});Te.prototype.setSupportMultiselect=function(e){this.setProperty("supportMultiselect",e);this._updatePropertySupportMultiselect(e);this._oTokenizerGrid.setVisible(e);this._oButtonOk.setVisible(e);return this};Te.prototype._updatePropertySupportMultiselect=function(e){if(!this._oTable){return undefined}if(!this._isPhone()){if(this._oTable.setSelectionMode){this._oTable.setSelectionMode(e?P.SelectionMode.MultiToggle:P.SelectionMode.Single)}}else if(this._oTable.setMode){this._oTable.setMode(e?_e.MultiSelect:_e.SingleSelectLeft)}return this};Te.prototype.setSupportRanges=function(e){this.setProperty("supportRanges",e);this._updateNavigationControl();return this};Te.prototype.setSupportRangesOnly=function(e){this.setProperty("supportRangesOnly",e);this._updateNavigationControl();return this};Te.prototype.setTitle=function(e){this.setProperty("title",e);this._updateDlgTitle();return this};Te.prototype.setFilterBar=function(e){this.setAggregation("filterBar",e);if(this._oMainLayout&&e){if(this._isPhone()){if(this._oFilterBar){this._oContentContainer.removeItem(this._oFilterBar);this._oFilterBar.detachInitialise(this._handleFilterBarInitialize)}}else if(this._oFilterBar){this._oMainLayout.removeItem(this._oFilterBar);this._oFilterBar.detachInitialise(this._handleFilterBarInitialize)}this._oFilterBar=e;this._oFilterBar.attachInitialise(this._handleFilterBarInitialize,this);if(this._oFilterBar){this._oFilterBar.addStyleClass("compVHSearch");if(this._isPhone()){var t=sap.ui.getCore().byId(this._oFilterBar.getBasicSearch());if(t&&t.isA("sap.m.SearchField")){t.setShowSearchButton(true);t.attachSearch(function(e){if(e.mParameters.refreshButtonPressed!==undefined){this.getFilterBar().search()}}.bind(this))}this._oFilterBar.setShowGoOnFB(false);this._oColSearchBox.setLayoutData(new c({shrinkFactor:0}));this._oContentContainer.insertItem(this._oColSearchBox,0);this._oFilterBar.setLayoutData(new c({shrinkFactor:0}));this._oContentContainer.insertItem(this._oFilterBar,1);this._oFilterBar.attachSearch(function(e){this._updateView(fe.PHONE_LIST_VIEW)}.bind(this));if(this._currentViewMode===fe.PHONE_LIST_VIEW){this._oFilterBar.setVisible(true);this._oFilterBar.setFilterBarExpanded(false);this._handleFilterBarInitialize()}}else{this._oFilterBar._setCollectiveSearch(this._oColSearchBox);this._oMainLayout.insertItem(this._oFilterBar,0)}}if(ye(this._oTabBar)){this.setInitialFocus(this._oTabBar.getItems()[0])}else if(this._oFilterBar._oSearchButton){this.setInitialFocus(this._oFilterBar._oSearchButton)}if(this._oFilterBar._oBasicSearchField){var i=this._oFilterBar._oBasicSearchField;i.setValue(this.getBasicSearchText());if(!ye(this._oTabBar)){this.setInitialFocus(i)}}}return this};Te.prototype._handleFilterBarInitialize=function(){if(this._currentViewMode===fe.PHONE_LIST_VIEW){this._oFilterBar._handleVisibilityOfToolbar();var e=this._oFilterBar&&this._oFilterBar.getFilterGroupItems()&&this._oFilterBar.getFilterGroupItems().length>0;this._oAdvancedSearchLink.setVisible(e);this._oFilterBar.setShowGoOnFB(!(this._oFilterBar&&this._oFilterBar.getBasicSearch()))}this._setToolbarSpacerWidth();if(ye(this._oTabBar)){this.setInitialFocus(this._oTabBar.getItems()[0])}else if(this._oFilterBar&&this._oFilterBar._oBasicSearchField){this.setInitialFocus(this._oFilterBar._oBasicSearchField)}};Te.prototype.getFilterBar=function(){return this._oFilterBar};Te.prototype.setBasicSearchText=function(e){this.setProperty("basicSearchText",e);if(this._oFilterBar&&this._oFilterBar._oBasicSearchField){this._oFilterBar._oBasicSearchField.setValue(e)}return this};Te.prototype.setTokens=function(e){var t=true;if(e.length){var i=0,s;for(var a=0;a<e.length;a++){var o=e[a];if(o.data("range")){var l=Object.assign({},o.data("range"));s=o.getKey();if(!s){do{s="range_"+i;i++}while(this._oSelectedRanges[s])}var r=this._getFormatedRangeTokenText(l.operation,l.value1,l.value2,l.exclude,l.keyField);this._addToken2Tokenizer(s,r,this._getTokenizer(),l.keyField);this._oSelectedRanges[s]=l;t=false}else{s=o.getKey();var h=o.getText();var _=o.data("longKey");var d=o.data("row");if(!_){_=s}this._oSelectedItems.add(_,d?d:o.getText());var u=new n(Se.call(this,_));u.setKey(_);u.setText(h);u.setTooltip(h);this._getTokenizer().addToken(u)}}}else{this._oSelectedItems.removeAll();this._oSelectedRanges={};this._getTokenizer().destroyTokens()}if(t){this._updateTokenizer()}};Te.prototype.open=function(){var e,t,i,s,o;if(!this._oTable&&!(this._isPhone()&&(this.getSupportRangesOnly()||this.getFilterMode()))){return be.call(this).then(function(){return this.open()}.bind(this))}this._bIgnoreSelectionChange=false;if(this._oColSearchBox){this._bIsMdcCollectiveSearch=this._oColSearchBox.isA("sap.ui.mdc.filterbar.vh.CollectiveSearchSelect");if(this._bIsMdcCollectiveSearch){this.bCollectiveSearchActive=this._oColSearchBox.getVisible()}else{this.bCollectiveSearchActive=this.oSelectionTitle.getVisible()&&this.oSelectionButton.getVisible();this._oColSearchBox.setVisible(this.bCollectiveSearchActive)}}if(!this._isPhone()){if(this.getSupportRangesOnly()||this.getFilterMode()){this._updateView(fe.DESKTOP_CONDITIONS_VIEW)}if(this.isPropertyInitial("contentWidth")){this.setContentWidth(this._getDefaultContentWidth())}}else{this._updateView(fe.PHONE_MAIN_VIEW)}this.addStyleClass("sapUiResponsivePadding--header sapUiResponsivePadding--subHeader sapUiResponsivePadding--content sapUiResponsivePadding--footer");a.prototype.open.apply(this);if(ye(this._oTabBar)){this.setInitialFocus(this._oTabBar.getItems()[0])}else if(this._oFilterBar&&this._oFilterBar._oBasicSearchField){this.setInitialFocus(this._oFilterBar._oBasicSearchField)}else if(!this._oFilterBar&&this._currentViewMode==="DESKTOP_CONDITIONS_VIEW"){if(this._oFilterPanel){e=this._oFilterPanel&&this._oFilterPanel._oConditionPanel;t=e&&e._oConditionsGrid;i=t&&t.getAggregation("content")[0];s=t&&i.operation;if(s&&s.getEnabled()){this.setInitialFocus(s)}else{o=i.value1;this.setInitialFocus(o)}}}return this};Te.prototype.getTable=function(){i.warning("Please use getTableAsync to prevent synchronous calls.",this);if(!this._oTable){this._createDefaultTable()}return this._oTable};Te.prototype.getTableAsync=function(){if(this._oTablePromise){return this._oTablePromise}else if(!this._oTable){return be.call(this)}else{return new Promise(function(e){e(this._oTable)}.bind(this))}};Te.prototype._handleSmartTable=function(e){e.attachBeforeRebindTable(function(){var t=e.getTable();if(t&&t.isA("sap.ui.table.Table")){t.attachEventOnce("rowsUpdated",this._updateTableTitle.bind(this))}}.bind(this))};Te.prototype.setTable=function(e){if(this._oTable){this._oMainLayout.removeItem(this._oTable);if(this._bTableCreatedInternal){this._oTable.destroy();this._oTable=null}}this._bTableCreatedInternal=arguments.length>1&&arguments[1]==true;if(e&&e.isA("sap.ui.comp.smarttable.SmartTable")){this._oTable=e.getTable();this._handleSmartTable(e)}else{this._oTable=e}if(this._oTable&&this._oTable.isA("sap.ui.table.Table")){this._oTable.setEnableBusyIndicator(true);if(this._oTable.isA("sap.ui.table.AnalyticalTable")){le=sap.ui.require("sap/ui/table/AnalyticalColumn")}}this._oTable.setLayoutData(new c({shrinkFactor:0,growFactor:1}));this.theTable=this._oTable;this._initializeTable();this._oMainLayout.addItem(e)};Te.prototype._getDefaultContentWidth=function(){var e;if(K.system.desktop){e=1080}else if(K.system.tablet){if(K.orientation.landscape){e=920}else if(K.orientation.portrait){e=600}}return e+"px"};Te.prototype.resetTableState=function(){if(this._oTable){if(this._oTable.unbindRows){this._oTable.unbindRows()}this._updateNoDataText(this._oRb.getText("VALUEHELPDLG_TABLE_PRESSSEARCH"))}};Te.prototype.TableStateSearchData=function(){this._updateNoDataText(this._oRb.getText("VALUEHELPDLG_TABLE_PRESSSEARCH"))};Te.prototype._updateNoDataText=function(e){if(this._oTable){if(this._oTable.setNoData){this._oTable.setNoData(e)}else if(this._oTable.setNoDataText){this._oTable.setNoDataText(e)}}};Te.prototype.TableStateDataFilled=function(){this._updateNoDataText(this._oRb.getText("VALUEHELPDLG_TABLE_NODATA"))};Te.prototype.TableStateDataSearching=function(){this._updateNoDataText(this._oRb.getText("VALUEHELPDLG_TABLE_SEARCHING"))};Te.prototype.init=function(){a.prototype.init.apply(this);this._oTokenIdCount={};this._bTableCreatedInternal=false;this._aIncludeRangeOperations={};this._aExcludeRangeOperations={};this._bInitTokensHaveChanged;this.setStretch(this._isPhone());this.setResizable(!this._isPhone());this.setDraggable(!this._isPhone());this.bCollectiveSearchActive=false;this.addStyleClass("compValueHelpDialog");this._oRb=sap.ui.getCore().getLibraryResourceBundle("sap.ui.comp");this._sTableTitle1=this._oRb.getText("VALUEHELPDLG_TABLETITLE1");this._sTableTitle2=this._oRb.getText("VALUEHELPDLG_TABLETITLE2");this._sTableTitleNoCount=this._oRb.getText("VALUEHELPDLG_TABLETITLENOCOUNT");this._currentViewMode=null;this._oSelectedItems=new l;this._oSelectedRanges={};this._oOperationsHelper=new Q;this._fnRejectTablePromise;this._createHeaderBar();this._createCollectiveSearch();this._createTokenizer();this._updateTokenizer();this._oNavigationContainer=new h(this.getId()+"-navigationContainer",{width:"100%",layoutData:new c({growFactor:0,shrinkFactor:0})}).addStyleClass("compVHNavigationContainer");this._oContentContainer=new h(this.getId()+"-vbox",{width:"100%",height:"100%"}).addStyleClass("compVHContentContainer");this._oContainersWrapper=new d(this.getId()+"-containersWrapper",{alignItems:"Start",height:"100%",width:"100%",direction:"Column",justifyContent:"SpaceBetween",items:[this._oNavigationContainer,this._oContentContainer]});this.addContent(this._oContainersWrapper);this._oMainLayout=new h(this.getId()+"-mainLayout",{fitContainer:true,items:[this._oFilterBar],layoutData:new c({growFactor:1,shrinkFactor:0,styleClass:"mainLayout"})});this._createNavigationControl();this._updateNavigationControl();this._oContentContainer.addItem(this._oMainLayout);if(this.getMaxIncludeRanges()==="-1"&&this.getMaxExcludeRanges()!=="0"&&!this.getFilterMode()){this._oContentContainer.addItem(this._oTokenizerGrid)}this._createFooterControls();this.setVerticalScrolling(false);this.setHorizontalScrolling(false);if(!K.system.desktop){this._oContentContainer.attachBrowserEvent("touchmove",function(e){e.setMarked()})}if(!this._isPhone()){this._updateView(fe.DESKTOP_LIST_VIEW)}if(!this._oInvisibleMessage){this._oInvisibleMessage=k.getInstance()}this._oRulesLog=new ee;this._oCopyProvider=new ne({extractData:function(e,t){var s,a=t.data("fieldDisplayBehaviour"),o=t.data("fieldTemplate"),n=t.data("fieldName");if(!n&&!o){i.error("Unable to extract data for copy - neither fieldName nor fieldTemplate is available.");return}if(Array.isArray(o)&&o.length>1){if(a==="descriptionAndId"){s=e.getProperty(o[1])+" ("+e.getProperty(o[0])+")"}else{s=e.getProperty(o[0])+" ("+e.getProperty(o[1])+")"}}else{s=e.getProperty(n)}return t.__type?t.__type.formatValue(s,"string"):s},copy:function(e){}});this._initResponsivePaddingsEnablement()};Te.prototype._updateView=function(e){if(this._currentViewMode===e){return}switch(e){case fe.DESKTOP_LIST_VIEW:this._validateRanges(function(){this._oTokenizerGrid.setVisible(this.getSupportMultiselect());this._oMainLayout.removeAllItems();if(this._oTabBar&&this._oTabBar.getSelectedKey()!==fe.DESKTOP_LIST_VIEW){this._oTabBar.setSelectedKey(fe.DESKTOP_LIST_VIEW)}this._oMainLayout.addItem(this._oFilterBar);this._oMainLayout.addItem(this._oTable);this._updateDlgTitle()}.bind(this),function(){this._oTabBar.setSelectedKey(fe.DESKTOP_CONDITIONS_VIEW);this._updateView(fe.DESKTOP_CONDITIONS_VIEW)}.bind(this));break;case fe.DESKTOP_CONDITIONS_VIEW:if(this.getSupportRanges()){this._oMainLayout.removeAllItems();if(this._oTabBar&&this._oTabBar.getSelectedKey()!==fe.DESKTOP_CONDITIONS_VIEW){this._oTabBar.setSelectedKey(fe.DESKTOP_CONDITIONS_VIEW)}this._createAddRanges();this._oButtonOk.setVisible(this.getSupportRangesOnly()||this.getSupportMultiselect());this._oTokenizerGrid.setVisible(this.getSupportMultiselect());if(!(this.getMaxIncludeRanges()==="-1"&&this.getMaxExcludeRanges()!=="0"&&!this.getFilterMode())){this._oTokenizerGrid.setVisible(false)}}break;case fe.PHONE_MAIN_VIEW:this.setVerticalScrolling(false);this._oColSearchBox.setVisible(false);this._oMainListMenu.setVisible(true);this._updateNavigationControl();this._oAdvancedSearchLink.setVisible(false);if(this._oFilterBar){this._oFilterBar.setVisible(false);this._oFilterBar.setFilterBarExpanded(false)}if(this._oTable){this._oTable.setVisible(false)}this._oTokenizerGrid.setVisible(this.getSupportMultiselect());if(!(this.getMaxIncludeRanges()==="-1"&&this.getMaxExcludeRanges()!=="0"&&!this.getFilterMode())){this._oTokenizerGrid.setVisible(false)}if(this._oRanges){this._oRanges.setVisible(false)}this._oButtonGo.setVisible(false);this._oButtonClear.setVisible(false);this._oButtonOk.setVisible(true);this._oButtonCancel.setVisible(true);this._oBackButton.setVisible(false);this._bNoneMainView=false;if(!(this._oSelectItemLI.getVisible()&&this._oDefineConditionsLI.getVisible())){this._bNoneMainView=true;if(this._oSelectItemLI.getVisible()){this._updateView(fe.PHONE_LIST_VIEW)}if(this._oDefineConditionsLI.getVisible()){this._updateView(fe.PHONE_CONDITIONS_VIEW)}return}break;case fe.PHONE_LIST_VIEW:this.setVerticalScrolling(true);this._oColSearchBox.setVisible(this.bCollectiveSearchActive);if(this._bIsMdcCollectiveSearch){this._oColSearchBox.addStyleClass("sapUiTinyMarginBegin");this._oColSearchBox.oVariantText.removeStyleClass("sapUiMdcCollectiveSearchSelectTextPhoneMaxWidth")}this._oMainListMenu.setVisible(false);if(this._oFilterBar){var t=this._oFilterBar&&this._oFilterBar.getFilterGroupItems()&&this._oFilterBar.getFilterGroupItems().length>0;this._oAdvancedSearchLink.setVisible(t);this._oFilterBar.setShowGoOnFB(!(this._oFilterBar&&this._oFilterBar.getBasicSearch()));this._oFilterBar.setVisible(true);this._oFilterBar.setFilterBarExpanded(false)}if(this._oTable){this._oTable.setVisible(true)}this._oTokenizerGrid.setVisible(false);if(this._oRanges){this._oRanges.setVisible(false)}this._oButtonGo.setVisible(false);this._oButtonClear.setVisible(false);this._oButtonOk.setVisible(this.getSupportMultiselect());this._oButtonCancel.setVisible(true);this._oBackButton.setVisible(!this._bNoneMainView);break;case fe.PHONE_SEARCH_VIEW:this.setVerticalScrolling(true);this._oColSearchBox.setVisible(false);this._oMainListMenu.setVisible(false);if(this._oFilterBar){this._oFilterBar.setVisible(true);this._oFilterBar.setFilterBarExpanded(true)}this._oAdvancedSearchLink.setVisible(false);if(this._oTable){this._oTable.setVisible(false)}this._oTokenizerGrid.setVisible(false);if(this._oRanges){this._oRanges.setVisible(false)}this._oButtonGo.setVisible(true);this._oButtonClear.setVisible(this._oFilterBar&&this._oFilterBar.getShowClearOnFB());this._oButtonOk.setVisible(false);this._oButtonCancel.setVisible(true);this._oBackButton.setVisible(true);break;case fe.PHONE_CONDITIONS_VIEW:this.setVerticalScrolling(true);this._oColSearchBox.setVisible(false);this._oMainListMenu.setVisible(false);if(this._oFilterBar){this._oFilterBar.setVisible(false)}this._oAdvancedSearchLink.setVisible(false);if(this._oTable){this._oTable.setVisible(false)}this._oTokenizerGrid.setVisible(false);if(!this._oRanges){this._createAddRanges()}if(this._oRanges){this._oRanges.setVisible(true)}this._oButtonGo.setVisible(false);this._oButtonClear.setVisible(false);this._oButtonOk.setVisible(true);this._oButtonCancel.setVisible(true);this._oBackButton.setVisible(!this._bNoneMainView);break;default:break}if(this._oMainListMenu&&this._oContentContainer){if(this._oFilterBar){this._oFilterBar._handleVisibilityOfToolbar()}(function(){this._oContentContainer.rerender()}).bind(this)()}this._currentViewMode=e;this._updateDlgTitle()};Te.prototype._changeTableRowSelectionForKey=function(e,t){var i;var s=this._oTable;var a=s;if(this._isMultiSelectionPluginAvailable()){a=s._getSelectionPlugin()}this._bIgnoreSelectionChange=true;if(s&&s.isA("sap.ui.table.Table")){var o=s.getBinding("rows");if(o){if(o.aKeys){for(i=0;i<o.aKeys.length;i++){if(decodeURIComponent(o.aKeys[i])===e){if(t){a.addSelectionInterval(i,i)}else{a.removeSelectionInterval(i,i)}break}}}else{this.oRows=s.getBinding("rows");if(this.oRows.aIndices){for(i=0;i<this.oRows.aIndices.length;i++){var n=s.getContextByIndex(this.oRows.aIndices[i]);if(n){var l=n.getObject();if(l[this.getKey()]===e){if(t){a.addSelectionInterval(i,i)}else{a.removeSelectionInterval(i,i)}break}}}}}}}else{for(i=0;i<s.getItems().length;i++){var r=s.getItems()[i];var h=r.getBindingContext().getObject();if(h[this.getKey()]===e){s.setSelectedItem(r,t);break}}}this._bIgnoreSelectionChange=false};Te.prototype.update=function(){if(this._oRulesLog){this._oRulesLog.setInvokedMethod("update",true)}if(!this.getEnabledMultiSelectionPlugin()){return this._updateSync()}else{return this._updateAsync()}};Te.prototype._updateSync=function(){var e,t,i,s;var a;var o=this._oSelectedItems.getItems();var n={tokenKeys:o,useDefault:false};var l;if(this._oTable){l=this._oTable;if(this._isMultiSelectionPluginAvailable()){l=this._oTable._getSelectionPlugin()}}this._bIgnoreSelectionChange=true;if(this._hasListeners("updateSelection")){this.fireUpdateSelection(n)}else{n.useDefault=true}if(n.useDefault){if(this._oTable&&this._oTable.isA("sap.ui.table.Table")){this.oRows=this._oTable.getBinding("rows");l.clearSelection();if(this.oRows&&this.oRows.aKeys){var r=this.getKeys();var h=r&&r.length>1?this.getKey()+"=":"";for(t=0;t<o.length;t++){a=o[t];var _=h+"'"+a+"'";for(e=0;e<this.oRows.aKeys.length;e++){var d=this.oRows.aKeys[e];if(d===undefined){continue}d=decodeURIComponent(d);var u=d===a;if(u||d.indexOf(_)>=0){if(!u){this._oSelectedItems.remove(a);var c=this._getTokenByKey(a,this._getTokenizer());if(c){c.setKey(d)}}s=this._oTable.getContextByIndex(e);if(s){i=s.getObject();this._oSelectedItems.add(d,i)}l.addSelectionInterval(e,e);break}}}}else if(this.oRows&&this.oRows.aIndices){l.clearSelection();var g=this._oTable.getBinding("rows").getContexts();for(t=0;t<o.length;t++){var p=o[t];for(e=0;e<this.oRows.aIndices.length;e++){s=g[e];if(s){i=s.getObject();if(i[this.getKey()]===p){this._oSelectedItems.add(i[this.getKey()],i);l.addSelectionInterval(e,e);break}}}}}}else{var f=this._oTable;for(t=0;t<o.length;t++){a=o[t];for(e=0;e<f.getItems().length;e++){var T=f.getItems()[e];var b=T.getBindingContext().getObject();if(b[this.getKey()]===a){f.setSelectedItem(T,true);break}}}}}this._bIgnoreSelectionChange=false;if(this._bTriggerInvisibleTableCountMessageNotInitialLoad){this._bTriggerInvisibleTableCountMessage=true}this._updateTitles();this._bTriggerInvisibleTableCountMessageNotInitialLoad=true};Te.prototype._updateAsync=function(){var e,t,i,s;var a;var o=this._oSelectedItems.getItems();var n={tokenKeys:o,useDefault:false};var l=[],r;if(this._oTable){r=this._oTable;if(this._isMultiSelectionPluginAvailable()){r=this._oTable._getSelectionPlugin()}}this._bIgnoreSelectionChange=true;if(this._hasListeners("updateSelection")){this.fireUpdateSelection(n)}else{n.useDefault=true}if(n.useDefault){if(this._oTable&&this._oTable.isA("sap.ui.table.Table")){this.oRows=this._oTable.getBinding("rows");r.clearSelection();if(this.oRows&&this.oRows.aKeys){var h=this.getKeys();var _=h&&h.length>1?this.getKey()+"=":"";for(t=0;t<o.length;t++){a=o[t];var d=_+"'"+a+"'";for(e=0;e<this.oRows.aKeys.length;e++){var u=this.oRows.aKeys[e];if(u===undefined){continue}u=decodeURIComponent(u);var c=u===a;if(c||u.indexOf(d)>=0){if(!c){this._oSelectedItems.remove(a);var g=this._getTokenByKey(a,this._getTokenizer());if(g){g.setKey(u)}}s=this._oTable.getContextByIndex(e);if(s){i=s.getObject();this._oSelectedItems.add(u,i)}l.push(r.addSelectionInterval(e,e));break}}}}else if(this.oRows&&this.oRows.aIndices){r.clearSelection();var p=this._oTable.getBinding("rows").getContexts();for(t=0;t<o.length;t++){var f=o[t];for(e=0;e<this.oRows.aIndices.length;e++){s=p[e];if(s){i=s.getObject();if(i[this.getKey()]===f){this._oSelectedItems.add(i[this.getKey()],i);r.addSelectionInterval(e,e);break}}}}}}else{var T=this._oTable;for(t=0;t<o.length;t++){a=o[t];for(e=0;e<T.getItems().length;e++){var b=T.getItems()[e];var S=b.getBindingContext().getObject();if(S[this.getKey()]===a){T.setSelectedItem(b,true);break}}}}}this._bIgnoreSelectionChange=false;return Promise.all(l).then(function(){if(this._bTriggerInvisibleTableCountMessageNotInitialLoad){this._bTriggerInvisibleTableCountMessage=true}this._updateTitles();this._bTriggerInvisibleTableCountMessageNotInitialLoad=true}.bind(this))};Te.prototype._createHeaderBar=function(){this._oTitle=new g(this.getId()+"-title",{level:ge.H1});var e=null;if(this._isPhone()){e=new T(this.getId()+"-back",{visible:false,type:re.Back,press:function(e){if(this._currentViewMode===fe.PHONE_SEARCH_VIEW){this._updateView(fe.PHONE_LIST_VIEW)}else{this._updateView(fe.PHONE_MAIN_VIEW)}}.bind(this)});this._oBackButton=e}var t=new b(this.getId()+"-header",{contentLeft:e,contentMiddle:this._oTitle,design:"Header"});this.setCustomHeader(t);this.getCustomHeader().addStyleClass("sapContrastPlus")};Te.prototype._createCollectiveSearch=function(){this.oSelectionTitle=new p(this.getId()+"-selTitle",{visible:false,wrapping:false}).addStyleClass("compVHColSearchText");if(K.system.tablet&&!K.system.desktop){this.oSelectionTitle.addStyleClass("compVHColSearchTextTabletMaxWidth")}else{this.oSelectionTitle.addStyleClass("compVHColSearchTextMaxWidth")}this.oSelectionButton=new T(this.getId()+"-selButton",{icon:"sap-icon://slim-arrow-down",tooltip:this._oRb.getText("VALUEHELPVALDLG_SEARCHTEMPLATES_TOOLTIP"),type:re.Transparent,visible:false,ariaLabelledBy:this.oSelectionTitle}).addStyleClass("compVHColSearchBtn");this._oColSearchBox=new _(this.getId()+"-selBox",{fitContainer:true,visible:this.oSelectionButton.getVisible(),items:[this.oSelectionTitle,this.oSelectionButton]}).addStyleClass("compVHColSearchVBox")};Te.prototype._createFooterControls=function(){this._oButtonOk=new T(this.getId()+"-ok",{text:this._oRb.getText("VALUEHELPDLG_OK"),press:this._onCloseAndTakeOverValues.bind(this),visible:this.getSupportMultiselect(),type:re.Emphasized,layoutData:new S({priority:he.NeverOverflow})});this._oButtonCancel=new T(this.getId()+"-cancel",{text:this._oRb.getText("VALUEHELPDLG_CANCEL"),press:this._onCancel.bind(this),layoutData:new S({priority:he.NeverOverflow})});if(this._isPhone()){this._oButtonGo=new T(this.getId()+"-go",{text:this._oRb.getText("VALUEHELPDLG_GO"),type:re.Emphasized,press:this._onGo.bind(this),visible:false,layoutData:new S({priority:he.NeverOverflow})});this._oButtonClear=new T(this.getId()+"-clear",{text:this._oRb.getText("VALUEHELPDLG_CLEAR"),press:this._onClear.bind(this),visible:false,layoutData:new S({priority:he.NeverOverflow})});this.addButton(this._oButtonGo);this.addButton(this._oButtonClear)}this.addButton(this._oButtonOk);this.addButton(this._oButtonCancel)};Te.prototype._handleTokenUpdateOrDelete=function(e){var t,i=[],s=[],a,o,n,l,r;if(this._ignoreRemoveToken){return}if(e.getParameter("type")===y.TokenChangeType.Removed){t=e.getParameter("removedTokens")}else if(e.getParameter("tokens")){t=e.getParameter("tokens")}for(l=0;l<t.length;l++){a=t[l];o=a.getKey();if(this._oSelectedRanges&&this._oSelectedRanges[o]){s.push(o);this._removeToken(o)}else{i.push(o);this._oSelectedItems.remove(o);this._removeTokenFromTokenizer(o,this._getTokenizer())}}this._removeRangeByKey(s);r={tokenKeys:i,useDefault:false};if(this._hasListeners("tokenRemove")){this._bIgnoreSelectionChange=true;this.fireTokenRemove(r);this._bIgnoreSelectionChange=false}else{r.useDefault=true}if(r.useDefault){i.forEach(function(e){this._changeTableRowSelectionForKey(e,false)}.bind(this))}if(t.length===1){setTimeout(function(){var e=this._getTokenizer().getTokens();if(e){n=e.length-1;if(n>=0){e[n].focus()}else{this._manageFocusAfterRemoveTokens()}}}.bind(this))}this._updateTitles()};Te.prototype._createTokenizer=function(){if(this._oTokenizerGrid){return this._oTokenizerGrid}this._oSelectedTokenTitle=new R(this.getId()+"-selectedTokenTitle");this._oSelectedTokens=new y(this.getId()+"-selectedTokens",{ariaLabelledBy:this._oSelectedTokenTitle}).addStyleClass("compVHTokensDiv");(function(){this._oSelectedTokens.attachTokenUpdate(this._handleTokenUpdateOrDelete,this)}).bind(this)();this._oSelectedTokens.attachTokenDelete(this._handleTokenUpdateOrDelete,this);if(e.getConfiguration().getAccessibility()){this._oSelectedTokens.addAriaDescribedBy(this._oSelectedTokens.getTokensInfoId())}this._oRemoveAllSelectedItemsBtn=new T(this.getId()+"-removeSelItems",{type:re.Transparent,icon:E.getIconURI("decline"),tooltip:this._oRb.getText("VALUEHELPVALDLG_REMOVETOKENS_TOOLTIP"),press:function(){var e=[],t=[],i;this._getTokenizer().destroyTokens();e=Object.keys(this._oSelectedItems["items"]);t=Object.keys(this._oSelectedRanges);this._removeRangeByKey(Object.keys(this._oSelectedRanges));this._oSelectedItems.removeAll();this._bIgnoreSelectionChange=true;if(this._oTable&&this._oTable.clearSelection){if(this._oTable._getSelectionPlugin&&this._oTable.data("isInternal")){this._oTable._getSelectionPlugin().clearSelection()}else{this._oTable.clearSelection()}}if(this._oTable&&this._oTable.removeSelections){this._oTable.removeSelections()}this._bIgnoreSelectionChange=false;this._updateTitles();this._manageFocusAfterRemoveTokens();if(e.length>0||t.length>0){i={tokenKeys:e.concat(t),useDefault:false};this.fireTokenRemove(i)}}.bind(this),ariaDescribedBy:this._oSelectedTokenTitle}).addStyleClass("compVHRemoveAllBtn");var t=new N(this.getId()+"-selItemsBox",{content:[this._getTokenizer(),this._oRemoveAllSelectedItemsBtn]}).addStyleClass("compVHTokenizerHLayout");this._oIncludeTokenGrid=new H(this.getId()+"-selItemsGrid",{width:"100%",defaultSpan:"L12 M12 S12",hSpacing:0,vSpacing:0,content:[this._oSelectedTokenTitle,t]}).addStyleClass("sapUiRespGridOverflowHidden");this._oTokenizerPanel=new I(this.getId()+"-tokenPanel",{expanded:K.system.desktop,expandable:false,expandAnimation:true,headerText:"",width:"auto",content:[this._oIncludeTokenGrid],expand:function(e){this._updateTokenizer();if(e.mParameters.expand&&this._oTable&&!this._oTable.isA("sap.m.Table")){var t=window.document.getElementById(this.getId()+"-scrollCont");if(t&&t.scrollTop){t.stop().animate({scrollTop:"1000"},1e3)}}}.bind(this)}).addStyleClass("compVHBackgroundTransparent").addStyleClass("compVHTokensPanel").addStyleClass("compValueHelpDialogTokens");if(this._isPhone()){this._getTokenizer().addStyleClass("sapMTokenizerMultiLine")}this._oTokenizerGrid=new H(this.getId()+"-tokenizerGrid",{width:"100%",defaultSpan:"L12 M12 S12",hSpacing:0,vSpacing:0,content:this._oTokenizerPanel}).addStyleClass("compVHDBackground").addStyleClass("sapUiRespGridOverflowHidden");return this._oTokenizerGrid};Te.prototype._addToken2Tokenizer=function(e,t,i,s){var a=typeof t==="string"?t:"";var o=this._getTokenByKey(e,i);t=J(t);if(!o){o=new n(Se.call(this,e,s));o.setKey(e);i.addToken(o);this._updateTokenizer()}if(o){o.setText(t);o.setTooltip(a)}};Te.prototype._getTokenByKey=function(e,t){var i=t.getTokens();for(var s=0;s<i.length;s++){var a=i[s];if(a.getKey()===e){return a}}return null};Te.prototype._removeToken=function(e){this._removeTokenFromTokenizer(e,this._getTokenizer())};Te.prototype._removeTokenFromTokenizer=function(e,t){var i=this._getTokenByKey(e,t);if(i){this._ignoreRemoveToken=true;t.removeToken(i);i.destroy();this._ignoreRemoveToken=false;this._updateTokenizer();return true}return false};Te.prototype._updateTokenizer=function(){this._bInitTokensHaveChanged=true;var e=false;if(this._oTokenizerPanel){e=this._oTokenizerPanel.getExpanded()}var t=this._getTokenizer().getTokens().length;var i=this._oRb.getText("VALUEHELPDLG_SELECTEDITEMS_CONDITIONS");var s=this._oRb.getText("VALUEHELPDLG_NONESELECTEDITEMS_CONDITIONS");var a=i.replace("{0}",t.toString());var o=t===0?s:a;if(this._oTokenizerPanel){if(!e){o="";if(t!==0){o=a}if(o===""){o=s}}this._oTokenizerPanel.setHeaderText(o);this._oSelectedTokenTitle.setText(o)}else{this._oSelectedTokenTitle.setText(o)}this._oRemoveAllSelectedItemsBtn.setEnabled(t!==0);this._oIncludeTokenGrid.removeStyleClass("displayNone")};Te.prototype._createNavigationControl=function(){if(!this._isPhone()){this._oTabBar=new v(this.getId()+"-navigation",{expandable:false,items:[new C(this.getId()+"-itemstable",{visible:true,text:this._getTabSearchAndSelectText(),key:fe.DESKTOP_LIST_VIEW}),new C(this.getId()+"-ranges",{visible:true,text:this._getTabRangesText(),key:fe.DESKTOP_CONDITIONS_VIEW})],select:function(e){this._updateView(e.getParameters().key)}.bind(this)});this._oTabBar.setLayoutData(new c({shrinkFactor:0}));this._oNavigationContainer.addItem(this._oTabBar)}else{this._oSelectItemLI=new m(this.getId()+"-itemstable",{type:de.Navigation,title:this._getTabSearchAndSelectText()}).data("key",fe.PHONE_LIST_VIEW);this._oDefineConditionsLI=new m(this.getId()+"-ranges",{type:de.Navigation,title:this._getTabRangesText()}).data("key",fe.PHONE_CONDITIONS_VIEW);this._oMainListMenu=new z(this.getId()+"-navigation",{mode:_e.None,items:[this._oSelectItemLI,this._oDefineConditionsLI],itemPress:function(e){if(e){this._updateView(e.mParameters.listItem.data("key"))}}.bind(this)});this._oMainListMenu.setLayoutData(new c({shrinkFactor:0}));this._oContentContainer.addItem(this._oMainListMenu);this._oAdvancedSearchLink=new G(this.getId()+"-advancedSearchLink",{text:this._oRb.getText("FILTER_BAR_ADV_FILTERS_DIALOG"),press:function(){this._updateView(fe.PHONE_SEARCH_VIEW)}.bind(this)}).addStyleClass("compVHAdvancedSearchLink");this._oAdvancedSearchLink.setLayoutData(new c({shrinkFactor:0,alignSelf:"End"}));this._oContentContainer.addItem(this._oAdvancedSearchLink)}};Te.prototype._updateNavigationControl=function(){var e=!this.getSupportRangesOnly();var t=this.getSupportRangesOnly()||this.getSupportRanges();if(this._oTabBar){var i=this._oTabBar.getItems();i[0].setVisible(e);i[1].setVisible(t);this._oTabBar.setVisible(e&&t);this._updateDlgTitle()}if(this._oMainListMenu){this._oSelectItemLI.setVisible(e);this._oDefineConditionsLI.setVisible(t)}};Te.prototype._removeRangeByKey=function(e){var t=e;if(typeof t==="string"){t=[t]}t.forEach(function(e,t,i){var s=this._oSelectedRanges[e];if(!s._oGrid){delete this._oSelectedRanges[e];if(this._oFilterPanel){var a=this._oFilterPanel.getConditionPanel();if(i.length==1){a.removeCondition(e)}else{a._removeConditionFromMap(e)}}}},this);if(t.length>1&&this._oFilterPanel){var i=this._oFilterPanel.getConditionPanel();i._clearConditions();i._fillConditions()}};Te.prototype._createAddRanges=function(){if(!this._oRanges){if(!sap.ui.require("sap/m/P13nFilterPanel")){sap.ui.require(["sap/m/P13nFilterPanel"],function(){this._oRanges=this._createRanges();this._oMainLayout.addItem(this._oRanges)}.bind(this))}else{this._oRanges=this._createRanges();this._oMainLayout.addItem(this._oRanges)}}else{this._oMainLayout.addItem(this._oRanges)}};Te.prototype._createRanges=function(){var e,t;this._oFilterPanel=new W(this.getId()+"-filterPanel",{maxConditions:this.getMaxConditions(),maxIncludes:this.getMaxIncludeRanges(),maxExcludes:this.getMaxExcludeRanges(),containerQuery:true,enableEmptyOperations:true,defaultOperation:this.getConditionPanelDefaultOperation(),filterItemChanged:function(e){var t=e.getParameter("reason");var i=e.getParameter("key");var s=e.getParameter("itemData");if(s&&t==="added"){var a={exclude:s.exclude,keyField:s.columnKey,operation:s.operation,value1:s.value1,value2:s.value2};this._oSelectedRanges[i]=a;var o=new q({key:i,exclude:s.exclude,columnKey:s.columnKey,operation:s.operation});o.setValue1(s.value1);o.setValue2(s.value2);this._oFilterPanel.addFilterItem(o);var n=this._getFormatedRangeTokenText(a.operation,a.value1,a.value2,a.exclude,a.keyField);this._addToken2Tokenizer(i,n,this._getTokenizer(),a.keyField);this._updateTokenizer()}if(s&&t==="updated"){var a=this._oSelectedRanges[i];a.exclude=s.exclude;a.keyField=s.columnKey;a.operation=s.operation;a.value1=s.value1;a.value2=s.value2;var n=this._getFormatedRangeTokenText(a.operation,a.value1,a.value2,a.exclude,a.keyField);this._addToken2Tokenizer(i,n,this._getTokenizer(),a.keyField);this._updateTokenizer()}if(t==="removed"){delete this._oSelectedRanges[i];this._removeToken(i);this._updateTokenizer()}this._updateTabRangesTitle()}.bind(this)});this._oFilterPanel._oPanel.addAriaLabelledBy(this.getId()+"-title");this._oFilterPanel.bIsSingleIntervalRange=this.bIsSingleIntervalRange;if(this.getProperty("_enhancedExcludeOperations")){this._oFilterPanel._enableEnhancedExcludeOperations()}t=this._oFilterPanel.getConditionPanel();t.setDisplayFormat(this.getDisplayFormat());t.setProperty("_calendarWeekSettings",this.getProperty("_conditionPanelCalendarWeekSettings"));this._oFilterPanel.setSuggestCallback(this._fSuggestCallback);t._sAddRemoveIconTooltipKey="CONDITION";if(this._aIncludeRangeOperations){for(e in this._aIncludeRangeOperations){this._oFilterPanel.setIncludeOperations(this._aIncludeRangeOperations[e],e,true)}}if(this._aExcludeRangeOperations){for(e in this._aExcludeRangeOperations){this._oFilterPanel.setExcludeOperations(this._aExcludeRangeOperations[e],e,true)}}if(this._aRangeKeyFields){this._aRangeKeyFields.forEach(function(e){this._oFilterPanel.addItem(new j({columnKey:e.key,text:e.label,typeInstance:e.typeInstance,type:e.type,maxLength:e.maxLength,formatSettings:e.formatSettings,scale:e.scale,precision:e.precision,isDefault:e.isDefault,values:null,nullable:e.nullable!=="false"}))},this)}if(this._oSelectedRanges){for(var i in this._oSelectedRanges){var s=this._oSelectedRanges[i];var a=new q({key:i,exclude:s.exclude,columnKey:s.keyField,operation:s.operation});a.setValue1(s.value1);a.setValue2(s.value2);this._oFilterPanel.addFilterItem(a)}}var o=new H(this.getId()+"-rangeFieldsGrid",{width:"100%",defaultSpan:"L12 M12 S12",vSpacing:0,hSpacing:0,content:[this._oFilterPanel]}).addStyleClass("sapUiRespGridOverflowHidden");this._sValidationDialogTitle=this._oRb.getText("VALUEHELPVALDLG_TITLE");this._sValidationDialogMessage=this._oRb.getText("VALUEHELPVALDLG_MESSAGE");this._sValidationDialogFieldMessage=this._oRb.getText("VALUEHELPVALDLG_FIELDMESSAGE");return o};Te.prototype.suggest=function(e){this._fSuggestCallback=e;if(this._oFilterPanel){this._oFilterPanel.setSuggestCallback(this._fSuggestCallback)}};Te.prototype._getKeyFieldByKey=function(e){var t;if(this._aRangeKeyFields){this._aRangeKeyFields.some(function(i){if(typeof i!=="string"){if(i.key===e){t=i;return true}}return false})}return t};Te.prototype._validateRanges=function(e,t){if(this._oRanges){if(!this._oRanges.getParent()){e();return}var i=this._oFilterPanel.validateConditions();if(!i){o.show(this._sValidationDialogMessage,{icon:o.Icon.WARNING,title:this._sValidationDialogTitle,actions:[o.Action.OK,o.Action.CANCEL],emphasizedAction:o.Action.OK,styleClass:this.$().closest(".sapUiSizeCompact").length?"sapUiSizeCompact":"",onClose:function(i){if(i===o.Action.OK&&e){e()}if(i===o.Action.CANCEL&&t){t()}}});return}}e()};Te.prototype.setUpdateSingleRowCallback=function(e){this.fSingleRowCallback=e;this._updateNavigationControl()};Te.prototype._createDefaultTable=function(){if(!this._isPhone()){this.setTable(new L(this.getId()+"-table"),true)}else{this.setTable(new O(this.getId()+"-table"),true);this.TableStateSearchData()}};function be(){if(!(this._oTablePromise instanceof Promise)){this._oTablePromise=new Promise(function(e,t){this._fnRejectTablePromise=t;if(!this._isPhone()){var i;if(this.getEnabledMultiSelectionPlugin()){i=new L({id:this.getId()+"-table"});i.addDependent(new X({limit:1e3,enableNotification:true}));i.data("isInternal",true)}else{i=new L({id:this.getId()+"-table"})}this.setTable(i,true);e(i)}else{var i=new O({id:this.getId()+"-table"});i.setMultiSelectMode(B.MultiSelectMode.ClearAll);i.data("isInternal",true);this.setTable(i,true);this.TableStateSearchData();e(i)}}.bind(this))}return this._oTablePromise}Te.prototype._initializeTableToolbar=function(){var e=this._oTable.getExtension()[0],t=e?e.getContent()[0]:null,i=[],s=this._oTable.isA("sap.ui.table.Table"),a=s&&this._bTableCreatedInternal&&this.getSupportMultiselect();if(!t){t=new g({text:K.system.desktop?this._sTableTitleNoCount:null});i.push(t);if(a){try{this._oTable.addDependent(new se({rangeLimit:1e3}));this._oTable.addDependent(this._oCopyProvider);i.push(new ae);i.push(new T({icon:E.getIconURI("copy"),tooltip:this._oRb.getText("VALUEHELPVALDLG_COPY_TOOLTIP"),press:function(e){this._oCopyProvider.copySelectionData(true)}.bind(this)}))}catch(e){}}e=new oe({content:[i]});this._oTable.addExtension(e)}else if(!t.isA("sap.m.Title")){t=new g({text:K.system.desktop?this._sTableTitleNoCount:null});e.insertContent(t,0)}};Te.prototype._initializeTable=function(){var e,t=false;if(this._oTable){e=this._oTable;if(this._isMultiSelectionPluginAvailable()){e=this._oTable._getSelectionPlugin();t=true}}if(this._oTable&&this._oTable.isA("sap.ui.table.Table")){this._initializeTableToolbar();if(this._bTableCreatedInternal){this.getSupportMultiselect()?this._oTable.setSelectionBehavior(P.SelectionBehavior.RowSelector):this._oTable.setSelectionBehavior(P.SelectionBehavior.RowOnly)}e.setSelectionMode(this.getSupportMultiselect()?P.SelectionMode.MultiToggle:P.SelectionMode.Single);this._updateNoDataText(this._oRb.getText("VALUEHELPDLG_TABLE_PRESSSEARCH"));Ie(this._oTable,F.Fixed);var i=function(i){var s=i.getParameter("_internalTrigger")&&i.getParameter("_internalTrigger")===true,a=i.getParameter("userInteraction"),n=e.getSelectedIndex()!==-1;if(this._bIgnoreSelectionChange||!a&&!t||t&&!n&&s){return}var l={tableSelectionParams:i.mParameters,updateTokens:[],useDefault:false,table:this._oTable};if(this._hasListeners("selectionChange")){this._bIgnoreSelectionChange=true;this.fireSelectionChange(l);this._bIgnoreSelectionChange=false;l.updateTokens.forEach(function(e){this._addRemoveTokenByKey(e.sKey,e.oRow,e.bSelected)}.bind(this))}else{l.useDefault=true}if(l.useDefault){var r=t?i.getSource().getParent():i.getSource();var h=r.getBinding("rows");var _=t?i.getSource().getSelectedIndices():r.getSelectedIndices();var d=i.getParameter("rowIndices");var u=i.getParameter("selectAll");var c=h&&h.isLengthFinal?h.isLengthFinal():true;var g,p=_.length;var f;var T=0;if(c){if(h.aKeys){for(g=0;g<p;g++){f=_[g];if(!h.aKeys[f]){T++}}}}else if(u){T=99999999}if(T!==0){var b=function(){h.attachEventOnce("dataReceived",function(){if(u){r.selectAll();d=e.getSelectedIndices()}this._handleSelectionUpdateTokens(r,d)}.bind(this));if(u){if(c){h.getContexts(0,p)}else{h.getContexts(0,T)}}else{h.getContexts(d[0],d[d.length-1])}}.bind(this);if(T<=400){b();return}else{o.show(this._oRb.getText("VALUEHELPDLG_SELECTIONFAILEDLOAD"),{icon:o.Icon.WARNING,title:this._oRb.getText("VALUEHELPDLG_SELECTIONFAILEDLOADTITLE"),actions:[o.Action.OK,o.Action.CANCEL],emphasizedAction:o.Action.OK,initialFocus:o.Action.CANCEL,styleClass:this.$().closest(".sapUiSizeCompact").length?"sapUiSizeCompact":"",onClose:function(e){if(e===o.Action.OK){b()}else{this.update()}}.bind(this)});return}}this._handleSelectionUpdateTokens(r,d)}this._updateTitles();if(!this.getSupportMultiselect()){this._bIgnoreSelectionChange=true;this._onCloseAndTakeOverValues()}};if(t){e.attachSelectionChange(i.bind(this))}else{this._oTable.attachRowSelectionChange(i.bind(this))}this._oTable.addStyleClass("compVHMainTable");if(!this._oTable.getParent()||!this._oTable.getParent().isA("sap.ui.comp.smarttable.SmartTable")){this._oTable.bindAggregation("columns","columns>/cols",function(e,t){var i,s,a,o,n,l=t.getProperty("descriptionLabel"),h=t.getProperty("label"),_=t.getProperty("template"),d=Array.isArray(_);if(t.getProperty("type")==="boolean"){i=new $(e+"-control",{enabled:false,selected:{path:_}});o=new D}else{var c,g={path:_,type:t.getProperty("oType")};if(t.getProperty("isTimezone")){g.parts=[{value:null},{path:_}]}if(d){g={parts:[{path:_[0]},{path:_[1]}],formatter:function(e,i){var s=u.getFormattedExpressionFromDisplayBehaviour(t.getProperty("displayBehaviour"),e,i);return J(s)}};a=new w({change:function(e){var t=e.getParameter("item"),i=t.getKey(),s=t.getSortOrder();c.setSortProperty(i);c.setSortOrder(s);c.sort(s===r.SortOrder.Descending)},items:[]});o=new D({quickActions:[a],beforeOpen:function(e){c=e.getParameter("openBy");if(c){_.forEach(function(e,t){var i=new M({key:e,label:t===0?h:l,sortOrder:e===c.getSortProperty()?c.getSortOrder():r.SortOrder.None});a.addItem(i)});a.setVisible(true)}},afterClose:function(){a.removeAllItems()}})}else{o=new D}i=new p(e+"-control",{wrapping:false,renderWhitespace:true,text:g})}if(this._oTable.isA("sap.ui.table.AnalyticalTable")){s=new le(e,{label:new f({text:t.getProperty("label")}),template:i,width:"{columns>width}",hAlign:i instanceof $?ue.Center:ue.Begin,filterProperty:t.getProperty("filter")})}else{s=new V(e,{label:new f({text:t.getProperty("label")}),template:i,width:"{columns>width}",hAlign:i instanceof $?ue.Center:ue.Begin,sortProperty:t.getProperty("sort"),sorted:t.getProperty("sorted"),sortOrder:t.getProperty("sortOrder"),showSortMenuEntry:d?false:true,filterProperty:t.getProperty("filter")});n=s.getProperty("sortProperty");if(n){s.setAssociation("headerMenu",o)}s.data({fieldName:t.getProperty("fieldName"),fieldTemplate:t.getProperty("fieldTemplate"),fieldDisplayBehaviour:t.getProperty("displayBehaviour")})}return s}.bind(this))}}else{this._oTable.setMode(this.getSupportMultiselect()?_e.MultiSelect:_e.SingleSelectLeft);this._oTable.setGrowing(true);e.attachSelectionChange(function(e){if(this._bIgnoreSelectionChange){return}var t=e.mParameters;var i={tableSelectionParams:e.mParameters,updateTokens:[],useDefault:false,table:this._oTable};if(this._hasListeners("selectionChange")){this._bIgnoreSelectionChange=true;this.fireSelectionChange(i);this._bIgnoreSelectionChange=false;i.updateTokens.forEach(function(e){this._addRemoveTokenByKey(e.sKey,e.oRow,e.bSelected)}.bind(this))}else{i.useDefault=true}if(i.useDefault){var s=t.selected;var a,o=t.listItems.length;for(a=0;a<o;a++){var n=t.listItems[a];var l=n.getBindingContext();var r=l?l.getObject():null;if(r){var h=r[this.getKey()];if(!this.getSupportMultiselect()){this._oSelectedItems.removeAll()}this._addRemoveTokenByKey(h,r,s)}}}if(!this.getSupportMultiselect()){this._onCloseAndTakeOverValues()}}.bind(this));if(!this._oTable.getParent()||!this._oTable.getParent().isA("sap.ui.comp.smarttable.SmartTable")){var s=0;this._oTable.bindAggregation("columns","columns>/cols",function(e,t){var i=t.getProperty("label");var a=this._oTable.getColumns().length>=2;s++;return new A(this._oTable.getId()+"-column"+s,{header:new f(this._oTable.getId()+"-column"+s+"-label",{text:i}),demandPopin:a,minScreenWidth:a?(this._oTable.getColumns().length+1)*10+"rem":"1px"})}.bind(this))}}};Te.prototype._handleSelectionUpdateTokens=function(e,t){var i,s=t.length;var a;var o;var n;var l=false;var r=this.getEnabledMultiSelectionPlugin()&&e._getSelectionPlugin&&e._getSelectionPlugin().isA("sap.ui.table.plugins.MultiSelectionPlugin")&&e.data("isInternal")?e._getSelectionPlugin():e;if(e.getBinding("rows").aKeys){l=true}if(!this.getSupportMultiselect()){this._oSelectedItems.removeAll()}for(i=0;i<s;i++){a=t[i];o=e.getContextByIndex(a);n=o?o.getObject():null;if(n){var h;if(l){h=o.sPath.substring(1)}else{h=n[this.getKey()]}this._addRemoveTokenByKey(h,n,r.isIndexSelected(a))}}};Te.prototype._addRemoveTokenByKey=function(e,t,i){try{e=decodeURIComponent(e)}catch(e){}if(i){this._oSelectedItems.add(e,t);this._addToken2Tokenizer(e,this._getFormatedTokenText(e),this._getTokenizer())}else{this._oSelectedItems.remove(e);this._removeTokenFromTokenizer(e,this._getTokenizer())}};Te.prototype._onCloseAndTakeOverValues=function(){var e=this;var t=function(){var t;var i=e._oSelectedItems.getSelectedItemsTokenArray(e.getKey(),e.getDescriptionKey(),e.getTokenDisplayBehaviour());if(e._oSelectedRanges){var s=0;for(var a in e._oSelectedRanges){t=e._oSelectedRanges[a];var o=t.tokenValue;if(!o){o=e._getFormatedRangeTokenText(t.operation,t.value1,t.value2,t.exclude,t.keyField)}if(!t._oGrid||t._oGrid.select.getSelected()){var l=new n({key:"range_"+s}).data("range",{exclude:t.exclude,operation:t.operation,keyField:t.keyField,value1:t.value1,value2:t.value2});l.setText(o);l.setTooltip(typeof o==="string"?o:null);i.push(l);s++}}}e.fireOk({tokens:i,_tokensHaveChanged:e._bInitTokensHaveChanged})};this._validateRanges(t)};Te.prototype._isMultiSelectionPluginAvailable=function(){var e=false;if(this._oTable._getSelectionPlugin&&this._oTable._getSelectionPlugin().isA("sap.ui.table.plugins.MultiSelectionPlugin")&&this._oTable.data("isInternal")){e=true}return e};Te.prototype._onCancel=function(){this.fireCancel()};Te.prototype._onGo=function(){this._oFilterBar.search()};Te.prototype._onClear=function(){this._oFilterBar.clear()};Te.prototype._updateTitles=function(){this._updateTableTitle();this._updateTokenizer();this._updateTabSearchAndSelectTitle();this._updateTabRangesTitle();if(this._bTriggerInvisibleTableCountMessageNotInitialLoad&&this._bTriggerInvisibleTableCountMessage){this._addInvisibleMessageSearchAndTableCount()}};Te.prototype._addInvisibleMessageSearchAndTableCount=function(){var e=this._oRb.getText("VALUEHELPDLG_SEARCH_RESULT_COUNT",this.nRowCount);this._oInvisibleMessage.announce(e,ce.Polite);this._bTriggerInvisibleTableCountMessage=false};Te.prototype._updateDlgTitle=function(){var e="";var t;if(this._oTitle){if(this._oTabBar&&!this._oTabBar.getVisible()&&!this.getFilterMode()){if(this._oTabBar.getSelectedKey()===fe.DESKTOP_LIST_VIEW){e="VALUEHELPDLG_TITLE"}else if(this._oTabBar.getSelectedKey()===fe.DESKTOP_CONDITIONS_VIEW){if(this.getMaxIncludeRanges()==="1"&&this.getMaxExcludeRanges()==="0"){e="VALUEHELPDLG_SINGLECONDITION_TITLE"}else{e="VALUEHELPDLG_RANGESTITLE"}}}else if(this._isPhone()&&!this.getFilterMode()){switch(this._currentViewMode){case fe.PHONE_MAIN_VIEW:e="";break;case fe.PHONE_LIST_VIEW:t=this._getTabSearchAndSelectText();break;case fe.PHONE_SEARCH_VIEW:e="FILTER_BAR_ADV_FILTERS_DIALOG";break;case fe.PHONE_CONDITIONS_VIEW:if(this.getMaxIncludeRanges()==="1"&&this.getMaxExcludeRanges()==="0"){e="VALUEHELPDLG_SINGLECONDITION_TITLE"}else{t=this._getTabRangesText()}break;default:break}}if(!t){t=this.getTitle()}if(e){t=this._oRb.getText(e,[t])}if(t){this._oTitle.setText(t)}}};Te.prototype._updateTableTitle=function(){if(!this._oTable){return}var e=0;this.oRows=this._oTable.getBinding("rows");if(this.oRows){e=this.oRows.getLength()}if(!this._oNumberFormatInstance){this._oNumberFormatInstance=Z.getFloatInstance()}if(e>0&&this.oRows.isLengthFinal&&this.oRows.isLengthFinal()){this.nRowCount=this._oNumberFormatInstance.format(e);this._setTableTitle(this._sTableTitle1.replace("{0}",this.nRowCount))}else{this._setTableTitle(this._sTableTitleNoCount)}};Te.prototype._getTabSearchAndSelectText=function(){var e=this._oTable;if(e){if(e.isA("sap.ui.comp.smarttable.SmartTable")){e=e.getTable()}var t=0;if(this._oSelectedItems&&this._oSelectedItems.getItems){t=this._oSelectedItems.getItems().length}if(t>0){return this._oRb.getText("VALUEHELPDLG_ITEMSTABLE_SELECT",[t])}}return this._oRb.getText("VALUEHELPDLG_ITEMSTABLE_SELECT").replace("({0})","")};Te.prototype._getTabRangesText=function(){if(this._oSelectedRanges&&Object.keys(this._oSelectedRanges).length>0){var e=Object.keys(this._oSelectedRanges).length;return this._oRb.getText("VALUEHELPDLG_RANGES",[e])}return this._oRb.getText("VALUEHELPDLG_RANGES").replace("({0})","")};Te.prototype._updateTabSearchAndSelectTitle=function(){var e=!this.getSupportRangesOnly();if(e){if(this._oTabBar){this._oTabBar.getItems()[0].setText(this._getTabSearchAndSelectText())}if(this._oMainListMenu&&this._oSelectItemLI){this._oSelectItemLI.setTitle(this._getTabSearchAndSelectText())}}};Te.prototype._updateTabRangesTitle=function(){var e=this.getSupportRangesOnly()||this.getSupportRanges();if(e){if(this._oTabBar){this._oTabBar.getItems()[1].setText(this._getTabRangesText())}if(this._oMainListMenu&&this._oDefineConditionsLI){this._oDefineConditionsLI.setTitle(this._getTabRangesText())}}};Te.prototype._setTableTitle=function(e){var t=this._oTable&&this._oTable.getExtension&&this._oTable.getExtension()[0],i=t?t.getContent()[0]:null;if(i&&K.system.desktop&&this._oTable&&!this._oTable.isA("sap.m.Table")){if(this._oTable.getTitle&&this._oTable.getTitle()){this._oTable.getTitle().setText(e)}else{i.setText(e)}if(!this._oTable.getAriaLabelledBy().includes(i.getId())){this._oTable.addAriaLabelledBy(i)}}else{this._oTable.addStyleClass("compValueHelpSmallMarginTop")}};Te.prototype._equalizeButtonsWidth=function(){var e=this._oButtonOk.getDomRef(),t=this._oButtonCancel.getDomRef(),i,s;if(!e||!t){return}i=e.getBoundingClientRect().width;s=t.getBoundingClientRect().width;if(i===s){return}if(s>i){this._oButtonOk.setWidth(s+"px")}else{this._oButtonCancel.setWidth(i+"px")}};Te.prototype.onAfterRendering=function(){a.prototype.onAfterRendering.apply(this);this._equalizeButtonsWidth();if(this._oTable){this._updateTitles()}if(!this._isPhone()&&this.getContentHeight()===""){if(this.getSupportRangesOnly()&&(this.getMaxExcludeRanges()==="-1"||this.getMaxIncludeRanges()==="-1")){this.setContentHeight("70%")}else{var e=this.getDomRef("scroll");var t=e.clientHeight;this.setContentHeight(t+"px")}if(this._oTable&&this._oTable.isA("sap.ui.table.Table")){Ie(this._oTable,F.Auto)}}if(this._oTabBar&&this._oTabBar.getVisible()&&this.getCustomHeader()){this.getCustomHeader().addStyleClass("compValueHelpDialogHeaderNoBoxShadow")}this._bInitTokensHaveChanged=false;this._setToolbarSpacerWidth();this._registerVHResizeHandler()};Te.prototype.onsapbackspace=function(e){if(this._ignoreRemoveToken||!e.srcControl||!e.srcControl.isA("sap.m.Token")){return}var t=e.srcControl.getKey?e.srcControl.getKey():"",i=[];if((e.type==="sapbackspace"||e.type==="sapdelete")&&t){if(this._oSelectedRanges&&this._oSelectedRanges[t]){i.push(t);this._removeToken(t)}else{this._oSelectedItems.remove(t);this._removeTokenFromTokenizer(t,this._getTokenizer())}}this._removeRangeByKey(i);var s={tokenKeys:[t],useDefault:false};if(this._hasListeners("tokenRemove")){this._bIgnoreSelectionChange=true;this.fireTokenRemove(s);this._bIgnoreSelectionChange=false}else{s.useDefault=true}if(s.useDefault){this._changeTableRowSelectionForKey(t,false)}setTimeout(function(){var e=this._getTokenizer().getTokens();if(e){var t=e.length-1;if(t>=0){e[t].focus()}else{this._manageFocusAfterRemoveTokens()}}}.bind(this));this._updateTitles()};Te.prototype.onsapdelete=Te.prototype.onsapbackspace;Te.prototype._getDialogOffset=function(e){var t=e||this._$Window.width();var i={small:600,large:1024};var s=function(e){var t=parseInt(window.getComputedStyle(document.body).fontSize);return e*t*2};var a=1;if(t>i.small&&t<i.large){a=2}else if(t>=i.large){a=2}return{top:s(a),left:s(a)}};Te.prototype.exit=function(){var e=function(e){if(e&&e.destroy){e.destroy()}return null};if(this._oCopyProvider){this._oCopyProvider=e(this._oCopyProvider)}a.prototype.exit.apply(this);if(typeof this._fnRejectTablePromise==="function"){this._fnRejectTablePromise()}this.removeDelegate(this._onBeforeRenderingInputEventDelegate);this._oTokenizerGrid=e(this._oTokenizerGrid);this._oRanges=e(this._oRanges);this._oFilterPanel=e(this._oFilterPanel);if(this._bTableCreatedInternal){this._oTable=e(this._oTable)}this._oTable=null;this.theTable=null;this._oNumberFormatInstance=null;this._oTabBar=e(this._oTabBar);this._oMainListMenu=e(this._oMainListMenu);this._oContentContainer=e(this._oContentContainer);this._oVarManagment=e(this._oVarManagment);this._aRangeKeyFields=e(this._aRangeKeyFields);this._aIncludeRangeOperations=e(this._aIncludeRangeOperations);this._aExcludeRangeOperations=e(this._aExcludeRangeOperations);if(this._oFilterBar){this._oFilterBar.detachInitialise(this._handleFilterBarInitialize);this._oFilterBar=e(this._oFilterBar)}this._oRb=e(this._oRb);this._sTableTitle1=e(this._sTableTitle1);this._sTableTitle2=e(this._sTableTitle2);this._sTableTitleNoCount=e(this._sTableTitleNoCount);this._sValidationDialogTitle=e(this._sValidationDialogTitle);this._sValidationDialogMessage=e(this._sValidationDialogMessage);this._sValidationDialogFieldMessage=e(this._sValidationDialogFieldMessage);this._oSelectedItems=e(this._oSelectedItems);this._oSelectedRanges=e(this._oSelectedRanges);this._oButtonOk=e(this._oButtonOk);this._oButtonCancel=e(this._oButtonCancel);if(this._oButtonGo){this._oButtonGo=e(this._oButtonGo)}if(this._oButtonClear){this._oButtonClear=e(this._oButtonClear)}if(this._oColSearchBox){this._oColSearchBox=e(this._oColSearchBox)}this._oRulesLog.destroy()};Te.prototype.setRangeKeyFields=function(e){this._aRangeKeyFields=e;if(this._aRangeKeyFields){this._aRangeKeyFields.some(function(e){if(e.typeInstance&&e.typeInstance.isA("sap.ui.model.odata.type.DateTime")){var i=e.typeInstance;if(!i.oFormat){i.formatValue(t.getInstance(),"string")}if(i.oFormat){i.oFormat.oFormatOptions.UTC=false}}})}};Te.prototype.getRangeKeyFields=function(){return this._aRangeKeyFields};Te.prototype.setIncludeRangeOperations=function(e,t){t=t||"default";this._aIncludeRangeOperations[t]=e;if(this._oFilterPanel){this._oFilterPanel.setIncludeOperations(this._aIncludeRangeOperations[t],t)}};Te.prototype.setExcludeRangeOperations=function(e,t){t=t||"default";this._aExcludeRangeOperations[t]=e.map(function(e){return this._oOperationsHelper.getCorrespondingExcludeOperation(e)}.bind(this));if(this._oFilterPanel){this._oFilterPanel.setExcludeOperations(this._aExcludeRangeOperations[t],t)}};Te.prototype._getFormatedTokenText=function(e){var t=this._oSelectedItems.getItem(e);var i=t[this.getDescriptionKey()];var s=t[this.getKey()];if(i===undefined){if(typeof t==="string"){i=t}else{i=s}}else{i=u.getFormattedExpressionFromDisplayBehaviour(this.getTokenDisplayBehaviour()?this.getTokenDisplayBehaviour():pe.descriptionAndId,s,i)}return i};Te.prototype._getFormatedRangeTokenText=function(e,t,i,s,a){var o=this._getKeyFieldByKey(a);var n=t;var l=i;var r=true;if(o){if(!o.typeInstance&&U._createKeyFieldTypeInstance){U._createKeyFieldTypeInstance(o)}if(o.typeInstance){n=o.typeInstance.formatValue(t,"string",r);l=o.typeInstance.formatValue(i,"string",r)}}var h=u.getFormattedRangeText(e,n,l,s);if(this._aRangeKeyFields&&this._aRangeKeyFields.length>1&&o&&o.label&&h!==""){h=o.label+": "+h}return h};Te.prototype._isPhone=function(){return K.system.phone};Te.prototype._hasListeners=function(e){if(this._bTableCreatedInternal){return false}return this.hasListeners(e)};Te.prototype._rotateSelectionButtonIcon=function(e){if(!K.system.phone){var t=sap.ui.getCore().byId(this.oSelectionButton.$("img")[0].id);if(e){t.addStyleClass("sapUiVHImageExpand")}else{t.removeStyleClass("sapUiVHImageExpand")}}};Te.prototype._getTokenizer=function(){return this._oSelectedTokens};Te.prototype._getTabSearchAndSelect=function(){var e=!this.getSupportRangesOnly();if(e){if(this._oTabBar){return this._oTabBar.getItems()[0]}if(this._oMainListMenu&&this._oSelectItemLI){return this._oSelectItemLI}}return null};Te.prototype._getTabDefneConditions=function(){var e=this.getSupportRangesOnly()||this.getSupportRanges();if(e){if(this._oTabBar){return this._oTabBar.getItems()[1]}if(this._oMainListMenu&&this._oDefineConditionsLI){return this._oDefineConditionsLI}}return null};Te.prototype._registerVHResizeHandler=function(){Y.register(this,this._onVHResize.bind(this))};Te.prototype._onVHResize=function(){this._setToolbarSpacerWidth()};Te.prototype._setToolbarSpacerWidth=function(){var e,t,i,s,a,o;if(!this._oFilterBar){return}if(this._oFilterBar._oToolbar){i=this._oFilterBar._oToolbar.getContent();for(var n=0;n<i.length;n++){if(i[n].isA("sap.m.ToolbarSpacer")){t=i[n];break}}}if(t&&this._oFilterBar.getBasicSearch()){e=this.getDomRef();if(e){s=parseInt(e.style.width);a=parseInt(e.style.maxWidth);if(isNaN(s)&&isNaN(a)){return}if(isNaN(s)){o=a}else if(isNaN(a)){o=s}else{o=Math.min(s,a)}if(o>=1e3){t.setWidth("6rem")}else if(o<1e3&&o>700){t.setWidth("4rem")}else{t.setWidth("0.5rem")}}}};Te.prototype._manageFocusAfterRemoveTokens=function(){var e,t=this._oFilterPanel?this._oFilterPanel.getConditionPanel():undefined;if(this._currentViewMode.toLowerCase().indexOf("list")>-1){this._oButtonOk.focus()}else{this._onAfterRenderingInputDelegate={onAfterRendering:function(){e.focus()}};this._onBeforeRenderingInputEventDelegate={onBeforeRendering:function(){if(e.getDomRef()){e.removeDelegate(this._onAfterRenderingInputDelegate,this)}}};e=t._oConditionsGrid.getAggregation("content")[0].value1;e.addDelegate(this._onAfterRenderingInputDelegate,this);e.addDelegate(this._onBeforeRenderingInputEventDelegate,this);e.focus()}};function Se(e,t){if(!t){t=this.getKey()}e=e.replace(/[^a-zA-Z0-9]/g,"");t=t.replace(/[^a-zA-Z0-9]/g,"");var i=t?t+"-"+e:e;if(!this._oTokenIdCount[i]){this._oTokenIdCount[i]=0}this._oTokenIdCount[i]++;return this.getId()+"-token-"+i+"_"+this._oTokenIdCount[i]}function ye(e){if(e){var t=e.getItems();return t[0].getVisible()&&t[1].getVisible()}else{return false}}function Ie(e,t){if(e.setVisibleRowCountMode){e.setVisibleRowCountMode(t);if(t===F.Auto){e.setMinAutoRowCount(K.system.desktop?5:4)}return}if(t===F.Fixed){e.setRowMode(F.Fixed)}else if(t===F.Auto){e.setRowMode(new x({minRowCount:K.system.desktop?5:4}))}}return Te});
/*!
 * SAPUI5
 * (c) Copyright 2009-2023 SAP SE. All rights reserved.
 */
sap.ui.predefine("sap/ui/comp/variants/EditableVariantItem", ["sap/m/ColumnListItem"],function(e){"use strict";var t=e.extend("sap.ui.comp.variants.EditableVariantItem",{metadata:{library:"sap.ui.comp",properties:{key:{type:"string",group:"Misc",defaultValue:null},global:{type:"boolean",group:"Misc",defaultValue:null},lifecyclePackage:{type:"string",group:"Misc",defaultValue:null},lifecycleTransportId:{type:"string",group:"Misc",defaultValue:null},namespace:{type:"string",group:"Misc",defaultValue:null},readOnly:{type:"boolean",group:"Misc",defaultValue:false},accessOptions:{type:"string",group:"Misc",defaultValue:null,deprecated:true},labelReadOnly:{type:"boolean",group:"Misc",defaultValue:false},author:{type:"string",group:"Misc",defaultValue:null},favorite:{type:"boolean",group:"Misc",defaultValue:false},_contexts:{type:"object",group:"Misc",visibility:"hidden",defaultValue:{}}}},renderer:{apiVersion:2}});t.prototype.setContexts=function(e){this.setProperty("_contexts",e)};t.prototype.getContexts=function(){return this.getProperty("_contexts")};return t});
/*!
 * SAPUI5
 * (c) Copyright 2009-2023 SAP SE. All rights reserved.
 */
sap.ui.predefine("sap/ui/comp/variants/VariantItem", ["sap/ui/comp/library","sap/m/VariantItem"],function(e,t){"use strict";var a=t.extend("sap.ui.comp.variants.VariantItem",{metadata:{library:"sap.ui.comp",properties:{executeOnSelection:{type:"boolean",group:"Misc",defaultValue:false},readOnly:{type:"boolean",group:"Misc",defaultValue:false},lifecycleTransportId:{type:"string",group:"Misc",defaultValue:null},global:{type:"boolean",group:"Misc",defaultValue:null},lifecyclePackage:{type:"string",group:"Misc",defaultValue:null},namespace:{type:"string",group:"Misc",defaultValue:null},accessOptions:{type:"string",group:"Misc",defaultValue:null,deprecated:true},labelReadOnly:{type:"boolean",group:"Misc",defaultValue:false}},events:{change:{parameters:{propertyName:{type:"string"}}}}}});a.prototype.setText=function(e){this.setProperty("text",e);this.fireChange({propertyName:"text"});return this};return a});
/*!
 * SAPUI5
 * (c) Copyright 2009-2023 SAP SE. All rights reserved.
 */
sap.ui.predefine("sap/ui/comp/variants/VariantManagement", ["sap/ui/Device","sap/ui/model/json/JSONModel","sap/ui/core/library","sap/m/library","sap/m/VBox","sap/m/SearchField","sap/m/ToggleButton","sap/m/RadioButton","sap/m/Column","sap/m/Text","sap/m/Bar","sap/m/Table","sap/m/Page","sap/m/OverflowToolbar","sap/m/OverflowToolbarLayoutData","sap/m/Toolbar","sap/m/ToolbarSpacer","sap/m/Button","sap/m/CheckBox","sap/m/Dialog","sap/m/Input","sap/m/Title","sap/m/Label","sap/m/ResponsivePopover","sap/m/SelectList","sap/m/ObjectIdentifier","sap/ui/comp/library","./EditableVariantItem","./VariantItem","sap/ui/core/InvisibleText","sap/ui/core/Control","sap/ui/core/Icon","sap/ui/core/Item","sap/ui/layout/HorizontalLayout","sap/ui/layout/Grid","sap/ui/events/KeyCodes"],function(e,t,a,i,n,s,r,o,l,h,d,g,u,c,p,f,y,m,S,v,V,T,_,A,I,M,E,N,b,C,x,D,R,O,K,L){"use strict";var w=a.VerticalAlign;var P=a.ValueState;var F=i.ButtonType;var B=i.PlacementType;var U=i.PopinDisplay;var k=i.ScreenSize;var G=a.TextAlign;var H=a.TitleLevel;var W=i.OverflowToolbarPriority;var z=i.FlexAlignItems;var Y=x.extend("sap.ui.comp.variants.VariantManagement",{metadata:{interfaces:["sap.m.IOverflowToolbarContent"],library:"sap.ui.comp",designtime:"sap/ui/comp/designtime/variants/VariantManagement.designtime",properties:{initialSelectionKey:{type:"string",group:"Misc",defaultValue:null},enabled:{type:"boolean",group:"Misc",defaultValue:true},defaultVariantKey:{type:"string",group:"Misc",defaultValue:null},selectionKey:{type:"string",group:"Misc",defaultValue:null},showCreateTile:{type:"boolean",group:"Misc",defaultValue:false},showExecuteOnSelection:{type:"boolean",group:"Misc",defaultValue:false},showShare:{type:"boolean",group:"Misc",defaultValue:false},showSetAsDefault:{type:"boolean",group:"Misc",defaultValue:true},lifecycleSupport:{type:"boolean",group:"Misc",defaultValue:false},standardItemText:{type:"string",group:"Misc",defaultValue:null},useFavorites:{type:"boolean",group:"Misc",defaultValue:false},inErrorState:{type:"boolean",group:"Misc",defaultValue:false},variantCreationByUserAllowed:{type:"boolean",group:"Misc",defaultValue:true},standardItemAuthor:{type:"string",group:"Misc",defaultValue:"SAP"}},defaultAggregation:"items",aggregations:{items:{type:"sap.ui.core.Item",multiple:true,singularName:"item",deprecated:true},variantItems:{type:"sap.ui.comp.variants.VariantItem",multiple:true,singularName:"variantItem"}},events:{save:{parameters:{name:{type:"string"},overwrite:{type:"boolean"},key:{type:"string"},exe:{type:"boolean"},def:{type:"boolean"},global:{type:"boolean"},lifecyclePackage:{type:"string"},lifecycleTransportId:{type:"string"}}},manage:{parameters:{renamed:{type:"object[]"},deleted:{type:"string[]"},exe:{type:"object[]"},def:{type:"string"}}},select:{parameters:{key:{type:"string"}}}}},renderer:{apiVersion:2,render:function(e,t){e.openStart("div",t);e.class("sapUiCompVarMngmt");e.openEnd();e.renderControl(t.oVariantLayout);e.close("div")}}});Y.STANDARD_NAME=E.STANDARD_VARIANT_NAME;Y.MAX_NAME_LEN=100;Y.FAV_COLUMN=0;Y.NAME_COLUMN=1;Y.SHARE_COLUMN=2;Y.DEF_COLUMN=3;Y.EXEC_COLUMN=4;Y.RESTRICT_COLUMN=5;Y.AUTHOR_COLUMN=6;Y.prototype.init=function(){var a=this;this.STANDARDVARIANTKEY="*standard*";this.setStandardVariantKey(this.STANDARDVARIANTKEY);this.aRemovedVariants=[];this.aRenamedVariants=[];this.aRemovedVariantTransports=[];this.aExeVariants=[];this.oResourceBundle=sap.ui.getCore().getLibraryResourceBundle("sap.ui.comp");this.lastSelectedVariantKey=this._sStandardVariantKey;this.bVariantItemMode=false;this.oSelectedItem=null;this.sNewDefaultKey="";this.bManagementTableInitialized=false;this.sTransport=null;this.sPackage=null;this.aEvents=[];this.bEventRunning=false;this.oVariantSelectionPage=null;this.bManualVariantKey=false;this.bFireSelect=false;this.bExecuteOnSelectForStandardViaXML=false;this.bExecuteOnSelectForStandardByUser=null;this.bSupportExecuteOnSelectOnSandardVariant=false;this._bInnerControlsCreated=false;this._bIndustrialSolutionMode=false;this._bVendorLayer=false;this.oModel=new t({enabled:false,selectedVariant:"",creationAllowed:true,saveVariantVisible:true});this.setModel(this.oModel,"save_enablement");this.oVariantInvisbletext=new C({text:{parts:[{path:"save_enablement>/selectedVariant"},{path:"save_enablement>/enabled"}],formatter:function(e,t){if(t){e=a.oResourceBundle.getText("VARIANT_MANAGEMENT_SEL_VARIANT_MOD",[e])}else{e=a.oResourceBundle.getText("VARIANT_MANAGEMENT_SEL_VARIANT",[e])}return e}}});this.oVariantText=new T(this.getId()+"-text",{text:"{save_enablement>/selectedVariant}"});this._setStandardText();this.oVariantText.addStyleClass("sapUICompVarMngmtClickable");this.oVariantText.addStyleClass("sapUICompVarMngmtTitle");this.oVariantText.addStyleClass("sapMTitleStyleH4");if(e.system.phone){this.oVariantText.addStyleClass("sapUICompVarMngmtTextPhoneMaxWidth")}else{this.oVariantText.addStyleClass("sapUICompVarMngmtTextMaxWidth")}this.oVariantModifiedText=new h(this.getId()+"-modified",{visible:"{save_enablement>/enabled}"});this.oVariantModifiedText.setText("*");this.oVariantModifiedText.addStyleClass("sapUICompVarMngmtClickable");this.oVariantModifiedText.addStyleClass("sapUICompVarMngmtModified");this.oVariantPopoverTrigger=new r(this.getId()+"-trigger",{icon:"sap-icon://slim-arrow-down",type:F.Transparent,tooltip:this.oResourceBundle.getText("VARIANT_MANAGEMENT_TRIGGER_TT")});this.oVariantPopoverTrigger.addAriaLabelledBy(this.oVariantInvisbletext);this.oVariantPopoverTrigger.addStyleClass("sapUICompVarMngmtClickable");this.oVariantLayout=new O({content:[this.oVariantText,this.oVariantModifiedText,this.oVariantPopoverTrigger]});this.oVariantLayout.addStyleClass("sapUICompVarMngmtLayout");this.oVariantInvisbletext.setModel(this.oModel,"save_enablement");this.oVariantInvisbletext.toStatic();this.addDependent(this.oVariantLayout)};Y.prototype.getOverflowToolbarConfig=function(){var e={canOverflow:false,invalidationEvents:["save","manage","select"]};return e};Y.prototype._columnVisibilityManagementTable=function(e,t){if(!this.bManagementTableInitialized){return}if(this.oManagementTable){var a=this.oManagementTable.getColumns();if(a&&a.length>=e){a[e].setVisible(t)}}};Y.prototype.setVariantCreationByUserAllowed=function(e){this.setProperty("variantCreationByUserAllowed",e);this.oModel.setProperty("/creationAllowed",e);return this};Y.prototype.setUseFavorites=function(e){this.setProperty("useFavorites",e);this._columnVisibilityManagementTable(Y.FAV_COLUMN,e);return this};Y.prototype.setShowShare=function(e){this.setProperty("showShare",e);this._columnVisibilityManagementTable(Y.SHARE_COLUMN,e);return this};Y.prototype.setShowSetAsDefault=function(e){this.setProperty("showSetAsDefault",e);this._columnVisibilityManagementTable(Y.DEF_COLUMN,e);return this};Y.prototype.setShowExecuteOnSelection=function(e){this.setProperty("showExecuteOnSelection",e);this._columnVisibilityManagementTable(Y.EXEC_COLUMN,e);return this};Y.prototype.setStandardItemText=function(e){this.setProperty("standardItemText",e);var t=this._getSelectedItem();if(!t||t.getKey()===this.getStandardVariantKey()){this.oModel.setProperty("/selectedVariant",e)}return this};Y.prototype._triggerSave=function(){var e=this._createEvent("variantSaveAs",this._handleVariantSaveAs);this._addEvent(e)};Y.prototype._checkNameValidity=function(e,t){var a=false;if(t&&this._getVariantNamesAndKeys){var i=this._getVariantNamesAndKeys();var n=t.getItems();n.forEach(function(e){var t=e.getCells()[Y.NAME_COLUMN];var n=e.getKey();if(t.getValue&&i.hasOwnProperty(t.getValue())&&i[t.getValue()]!==n){t.setValueState(P.Error);t.setValueStateText(this.oResourceBundle.getText("VARIANT_MANAGEMENT_ERROR_DUPLICATE"));a=true}}.bind(this))}return a};Y.prototype._checkVariantNameConstraints=function(e,t){var a;if(!e){return}a=e.getValue().trim();if(!this._checkIsDuplicate(e,a,this.oManagementTable)){if(a===""){e.setValueState(P.Error);e.setValueStateText(this.oResourceBundle.getText("VARIANT_MANAGEMENT_ERROR_EMPTY"))}else if(a.indexOf("{")>-1){e.setValueState(P.Error);e.setValueStateText(this.oResourceBundle.getText("VARIANT_MANAGEMENT_NOT_ALLOWED_CHAR",["{"]))}else if(a.length>Y.MAX_NAME_LEN){e.setValueState(P.Error);e.setValueStateText(this.oResourceBundle.getText("VARIANT_MANAGEMENT_MAX_LEN",[Y.MAX_NAME_LEN]))}else{e.setValueState(P.None);e.setValueStateText(null)}}if(e.getValueState()!==P.Error){this._checkIsDuplicate(e,a,t)}if(t&&this._getVariantNamesAndKeys){this._checkNameValidity(a,t)}};Y.prototype._focusOnFirstFilterInError=function(e){e.getDomRef().scrollIntoView()};Y.prototype._anyItemInErrorState=function(){var e,t,a;if(this.oManagementTable){e=this.oManagementTable.getItems();if(e){for(a=0;a<e.length;a++){t=e[a].getCells()[Y.NAME_COLUMN];if(t&&t.getValueState&&t.getValueState()===P.Error){this._checkVariantNameConstraints(t,this.oManagementTable);if(t.getValueState()===P.Error){this._focusOnFirstFilterInError(t);return true}}}for(a=0;a<e.length;a++){t=e[a].getCells()[Y.NAME_COLUMN];if(t&&t.isA("sap.m.Input")){this._checkVariantNameConstraints(t,this.oManagementTable);if(t.getValueState()===P.Error){this._focusOnFirstFilterInError(t);return true}}}}}return false};Y.prototype._anyInErrorState=function(e,t){var a,i,n;if(e){a=e.getItems();if(a){for(n=0;n<a.length;n++){i=a[n].getCells()[Y.NAME_COLUMN];if(t&&t===i){continue}if(i&&i.getValueState&&i.getValueState()===P.Error){if(this._checkIsDuplicate(i,i.getValue(),e)){return true}}}}}return false};Y.prototype._checkIsDuplicate=function(e,t,a){var i=this._isDuplicate(e,t,a);if(i){e.setValueState(P.Error);e.setValueStateText(this.oResourceBundle.getText(t?"VARIANT_MANAGEMENT_ERROR_DUPLICATE":"VARIANT_MANAGEMENT_ERROR_EMPTY"))}else{e.setValueState(P.None);e.setValueStateText(null)}return i};Y.prototype._isDuplicate=function(e,t,a){if(a){return this._isDuplicateManaged(e,t,a)}else{return this._isDuplicateSaveAs(t)}};Y.prototype._isDuplicateManaged=function(e,t,a){var i,n,s;if(a){i=a.getItems();if(i&&i.length>0){for(s=0;s<i.length;s++){n=i[s].getCells()[Y.NAME_COLUMN];if(n===e){continue}if(n){if(n.getValue&&t===n.getValue().trim()){return true}else if(n.getText&&t===n.getText().trim()){return true}else if(n.getTitle&&t===n.getTitle().trim()){return true}}}}else{if(this._isIndustrySolutionModeAndVendorLayer()&&this.bManualVariantKey){return false}}}return false};Y.prototype._isDuplicateSaveAs=function(e){var t=e.trim();if(!t){return true}var a=this._determineStandardVariantName();if(a===t){if(this._isIndustrySolutionModeAndVendorLayer()&&this.bManualVariantKey){return false}return true}var i=this._getItems();for(var n=0;n<i.length;n++){a=i[n].getText().trim();if(a===t){return true}}return false};Y.prototype._createSaveDialog=function(){var t=this;if(!this.oSaveDialog){this.oSaveDialog=new v(this.getId()+"-savedialog",{title:this.oResourceBundle.getText("VARIANT_MANAGEMENT_SAVEDIALOG"),beginButton:this.oSaveSave,endButton:new m(this.getId()+"-variantcancel",{text:this.oResourceBundle.getText("VARIANT_MANAGEMENT_CANCEL"),press:function(){if(t._fGetDataForKeyUser){t._handleSaveAsCancelPressedForKeyUser()}else{t._bSaveCanceled=true;t.oSaveDialog.close()}}}),content:[this.oLabelName,this.oInputName,this.oLabelKey,this.oInputKey,this.oSaveDialogOptionsGrid],stretch:e.system.phone});this.oSaveDialog.setParent(this);this.oSaveDialog.addStyleClass("sapUiContentPadding");this.oSaveDialog.addStyleClass("sapUiCompVarMngmtSaveDialog")}};Y.prototype._createManagementDialog=function(){var t=this;if(!this.oManagementDialog){this.oManagementDialog=new v(this.getId()+"-managementdialog",{contentWidth:"64%",draggable:true,resizable:true,title:this.oResourceBundle.getText("VARIANT_MANAGEMENT_MANAGEDIALOG"),beginButton:this.oManagementSave,endButton:new m(this.getId()+"-managementcancel",{text:this.oResourceBundle.getText("VARIANT_MANAGEMENT_CANCEL"),press:function(){if(t._fGetDataForKeyUser){t._handleManageCancelPressedForKeyUser()}else{t.aRemovedVariants=[];t.oManagementDialog.close()}}}),content:[this.oManagementTable],stretch:e.system.phone,afterClose:function(){if(t.bFireSelect==true){t.bFireSelect=false;t._fireSelectAsync()}}});this.oManagementDialog.setParent(this);var a=new d;this.oManageDialogSearchField=new s;this.oManageDialogSearchField.attachLiveChange(function(e){this._triggerSearchInManageDialog(e)}.bind(this));a.addContentMiddle(this.oManageDialogSearchField);this.oManagementDialog.setSubHeader(a)}};Y.prototype._handleArrowUpDown=function(e,t){var a=null;var i=this;e.attachBrowserEvent("keydown",function(e){if(e.which===38){if(i.oVariantSelectionPage.getShowSubHeader()){a=document.activeElement.id}}});e.attachBrowserEvent("keyup",function(i){if(i.which===38){if(a&&a===document.activeElement.id){var n=e.getItems();if(n&&n.length>0){var s=sap.ui.getCore().byId(a);if(s===n[0]){t.focus()}}}a=null}});t.attachBrowserEvent("keyup",function(t){if(t.which===40){var a=e.getItems();if(a&&a.length>0){a[0].focus()}}})};Y.prototype._triggerSearch=function(e){if(!e){return}var t=e.getParameters();if(!t){return}this._restoreCompleteList();var a=t.newValue?t.newValue:"";this._triggerSearchByValue(a.toLowerCase())};Y.prototype._triggerSearchByValue=function(e){var t,a,i;this.oSelectedVariantItemKey=null;i=this.oVariantList.getItemByKey(this.getStandardVariantKey());if(i&&i.getText().toLowerCase().indexOf(e)<0){if(this.getSelectionKey()===a){this.oSelectedVariantItemKey=a}this.oVariantList.removeItem(i);i.destroy()}var n=this._getItems();for(var s=0;s<n.length;s++){t=n[s].getText();if(t.toLowerCase().indexOf(e)<0){a=n[s].getKey();i=this.oVariantList.getItemByKey(a);if(i){if(this.getSelectionKey()===a){this.oSelectedVariantItemKey=a}this.oVariantList.removeItem(i);i.destroy()}}}};Y.prototype._triggerSearchInManageDialog=function(e){var t,a,i="",n,s;if(!e){return}var r=e.getParameters();if(!r){return}t=r.newValue?r.newValue.toLowerCase():"";if(this.oManagementTable){var o=this.oManagementTable.getItems();o.forEach(function(e){a=true;i="";s=e.getCells();if(s&&s[Y.NAME_COLUMN]){n=s[Y.NAME_COLUMN];if(n.getTitle){i=n.getTitle()}else if(n.getValue){i=n.getValue()}if(i.toLowerCase().indexOf(t)>=0){a=false}}if(a&&s&&s[Y.AUTHOR_COLUMN]){n=s[Y.AUTHOR_COLUMN];if(n.getText){i=n.getText();if(i.toLowerCase().indexOf(t)>=0){a=false}}}e.setVisible(!a)})}};Y.prototype._considerItem=function(e,t){if(this.getUseFavorites()&&!e){if(this._isIndustrySolutionModeAndVendorLayer()){return true}if(t.getFavorite&&t.getFavorite()){return true}return false}return true};Y.prototype._restoreCompleteList=function(e){var t,a,i,n;this.oVariantList.destroyItems();n=this.oVariantList.getItemByKey(this.getStandardVariantKey());if(!n){n=this._createStandardVariantListItem();if(n){if(this._considerItem(e,n)){this.oVariantList.insertItem(n,0)}else{n.destroy()}}}if(n){if(this.oSelectedVariantItemKey){if(this.oSelectedVariantItemKey===n.getKey()){this.oVariantList.setSelectedItem(n);this.oSelectedVariantItemKey=null}}else{if(this.getSelectionKey()==n.getKey()||this.getSelectionKey()===null){this.oVariantList.setSelectedItem(n)}}}i=this._getItems();i.sort(this._compareItems);for(t=0;t<i.length;t++){a=i[t];if(!this._considerItem(e,a)){continue}if(a.getKey()===this.getStandardVariantKey()){continue}n=this.oVariantList.getItemByKey(a.getKey());if(!n){n=this._createVariantListItem(a,t);this.oVariantList.addItem(n)}if(this.oSelectedVariantItemKey){if(this.oSelectedVariantItemKey===n.getKey()){this.oVariantList.setSelectedItem(n);this.oSelectedVariantItemKey=null}}else{if(this.getSelectionKey()==n.getKey()){this.oVariantList.setSelectedItem(n)}}}};Y.prototype._determineStandardVariantName=function(){var e=this.oResourceBundle.getText("VARIANT_MANAGEMENT_STANDARD");if(this.bVariantItemMode===false){e=this.oResourceBundle.getText("VARIANT_MANAGEMENT_DEFAULT")}if(this.getStandardVariantKey()===this.STANDARDVARIANTKEY){if(this.getStandardItemText()!==null&&this.getStandardItemText()!=""){e=this.getStandardItemText()}}return e};Y.prototype._createStandardVariantListItem=function(){var e,t=null;var a=this._determineStandardVariantName();if(this.bVariantItemMode===true||this.bVariantItemMode===false&&(this.getSelectionKey()===this.getStandardVariantKey()||this.getSelectionKey()===null)){t=new b(this.oVariantPopoverTrigger.getId()+"-item-standard",{key:this.getStandardVariantKey(),readOnly:true,executeOnSelection:this.getExecuteOnSelectForStandardVariant()});t.setText(a);if(this._isIndustrySolutionModeAndVendorLayer()&&this.bVariantItemMode){t.setGlobal(true);t.setReadOnly(false)}if(this.getStandardVariantKey()!==this.STANDARDVARIANTKEY){e=this.getItemByKey(this.getStandardVariantKey());if(e){this._setVariantListItemProperties(e,t);if(e.getFavorite&&!e.getFavorite()&&this.getSelectionKey()===this.getStandardVariantKey()){t.setFavorite(true)}}}else{t.setAuthor(this.getStandardItemAuthor());t.setReadOnly(true);t.setFavorite(this.getStandardFavorite())}}return t};Y.prototype._createVariantListItem=function(e,t){var a=new b(this.oVariantPopoverTrigger.getId()+"-item-"+t,{key:e.getKey(),text:e.getText()});this._setVariantListItemProperties(e,a);return a};Y.prototype._setVariantListItemProperties=function(e,t){if(e.getReadOnly){t.setReadOnly(e.getReadOnly())}if(e.getExecuteOnSelection){t.setExecuteOnSelection(e.getExecuteOnSelection())}if(e.getGlobal){t.setGlobal(e.getGlobal())}if(e.getLifecyclePackage){t.setLifecyclePackage(e.getLifecyclePackage())}if(e.getLifecycleTransportId){t.setLifecycleTransportId(e.getLifecycleTransportId())}if(e.getNamespace){t.setNamespace(e.getNamespace())}if(e.getAccessOptions){t.setAccessOptions(e.getAccessOptions())}if(e.getLabelReadOnly){t.setLabelReadOnly(e.getLabelReadOnly())}if(e.getAuthor){t.setAuthor(e.getAuthor())}if(e.getFavorite){t.setFavorite(e.getFavorite())}if(e.getContexts){t.setContexts(e.getContexts())}};Y.prototype.exit=function(){if(this.oVariantInvisbletext){this.oVariantInvisbletext.destroy(true);this.oVariantInvisbletext=undefined}if(this.oSearchField){this.oSearchField.destroy();this.oSearchField=undefined}if(this.oManageDialogSearchField){this.oManageDialogSearchField.destroy();this.oManageDialogSearchField=undefined}if(this.oVariantManage){this.oVariantManage.destroy();this.oVariantManage=undefined}if(this.oVariantSave){this.oVariantSave.destroy();this.oVariantSave=undefined}if(this.oVariantList){this.oVariantList.destroy();this.oVariantList=undefined}if(this.oInputName){this.oInputName.destroy();this.oInputName=undefined}if(this.oLabelName){this.oLabelName.destroy();this.oLabelName=undefined}if(this.oDefault){this.oDefault.destroy();this.oDefault=undefined}if(this.oSaveSave){this.oSaveSave.destroy();this.oSaveSave=undefined}if(this.oSaveDialog){this.oSaveDialog.destroy();this.oSaveDialog=undefined}if(this.oManagementTable){this.oManagementTable.destroy();this.oManagementTable=undefined}if(this.oManagementSave){this.oManagementSave.destroy();this.oManagementSave=undefined}if(this.oManagementDialog){this.oManagementDialog.destroy();this.oManagementDialog=undefined}if(this.oVariantText){this.oVariantText.destroy();this.oVariantText=undefined}if(this.oVariantPopoverTrigger){this.oVariantPopoverTrigger.destroy();this.oVariantPopoverTrigger=undefined}if(this.oVariantLayout){this.oVariantLayout.destroy();this.oVariantLayout=undefined}if(this.oVariantPopOver){this.oVariantPopOver.destroy();this.oVariantPopOver=undefined}if(this.oVariantSaveAs){this.oVariantSaveAs.destroy();this.oVariantSaveAs=undefined}if(this.oShare){this.oShare.destroy();this.oShare=undefined}if(this.oExecuteOnSelect){this.oExecuteOnSelect.destroy();this.oExecuteOnSelect=undefined}if(this.oCreateTile){this.oCreateTile.destroy();this.oCreateTile=undefined}if(this.oSaveDialogOptionsGrid){this.oSaveDialogOptionsGrid.destroy();this.oSaveDialogOptionsGrid=undefined}if(this.oVariantSelectionPage){this.oVariantSelectionPage.destroy();this.oVariantSelectionPage=undefined}if(this.oErrorVariantPopOver){this.oErrorVariantPopOver.destroy();this.oErrorVariantPopOver=undefined}if(this.oInputKey){this.oInputKey.destroy();this.oInputKey=undefined}if(this.oLabelKey){this.oLabelKey.destroy();this.oLabelKey=undefined}if(this.oModel){this.oModel.destroy();this.oModel=undefined}};Y.prototype.addItem=function(e){e=this.validateAggregation("items",e,true);this.bVariantItemMode=false;this.addAggregation("items",e,false);var t=this.getInitialSelectionKey();this._setSelection(e,t);this._setStandardText();return this};Y.prototype.insertItem=function(e,t){var a=t;e=this.validateAggregation("items",e,true);this.bVariantItemMode=false;this.insertAggregation("items",e,a);var i=this.getInitialSelectionKey();this._setSelection(e,i);this._setStandardText();return this};Y.prototype.removeItem=function(e){e=this.removeAggregation("items",e);return e};Y.prototype.removeAllItems=function(){var e=this.removeAllAggregation("items");this._setSelectedItem(null);return e};Y.prototype.destroyItems=function(){this.destroyAggregation("items");this._setSelectedItem(null);return this};Y.prototype._getItems=function(){if(this.bVariantItemMode){return this.getVariantItems()}else{return this.getItems()}};Y.prototype._removeItem=function(e){if(this.bVariantItemMode){return this.removeVariantItem(e)}else{return this.removeItem(e)}};Y.prototype.getItemByKey=function(e){var t=this._getItems();for(var a=0;a<t.length;a++){if(e==t[a].getKey()){return t[a]}}return null};Y.prototype.addVariantItem=function(e){e=this.validateAggregation("variantItems",e,true);this.bVariantItemMode=true;this.addAggregation("variantItems",e,false);var t=this.getInitialSelectionKey();this._setSelection(e,t);this._setStandardText();e.attachChange(this._variantItemChange.bind(this,null));return this};Y.prototype.insertVariantItem=function(e,t){var a=t;e=this.validateAggregation("variantItems",e,true);this.bVariantItemMode=true;this.insertAggregation("variantItems",e,a);var i=this.getInitialSelectionKey();this._setSelection(e,i);this._setStandardText();e.attachChange(this._variantItemChange.bind(this,null));return this};Y.prototype._variantItemChange=function(e,t){var a;if(t&&t.oSource&&t.oSource.isA("sap.ui.comp.variants.VariantItem")){a=t.getParameter("propertyName");if(a==="text"){if(t.oSource===this._getSelectedItem()){this.oModel.setProperty("/selectedVariant",this._getSelectedItem().getText())}}}};Y.prototype._setSelectedItem=function(e){this.oSelectedItem=e;if(e!=null&&e.getKey()!=this.getStandardVariantKey()){this._setVariantText(e.getText())}else{this._setStandardText()}};Y.prototype._getSelectedItem=function(){return this.oSelectedItem};Y.prototype.setInitialSelectionKey=function(e){this.setProperty("initialSelectionKey",e,true);this._setSelectionByKey(e);return this};Y.prototype.setEnabled=function(e){this.setProperty("enabled",e,false);if(!e){this.oVariantText.removeStyleClass("sapUICompVarMngmtClickable");this.oVariantModifiedText.removeStyleClass("sapUICompVarMngmtClickable");this.oVariantPopoverTrigger.removeStyleClass("sapUICompVarMngmtClickable");this.oVariantText.addStyleClass("sapUICompVarMngmtDisabled");this.oVariantModifiedText.addStyleClass("sapUICompVarMngmtDisabled");this.oVariantPopoverTrigger.addStyleClass("sapUICompVarMngmtDisabled")}else{this.oVariantText.removeStyleClass("sapUICompVarMngmtDisabled");this.oVariantModifiedText.removeStyleClass("sapUICompVarMngmtDisabled");this.oVariantPopoverTrigger.removeStyleClass("sapUICompVarMngmtDisabled");this.oVariantText.addStyleClass("sapUICompVarMngmtClickable");this.oVariantModifiedText.addStyleClass("sapUICompVarMngmtClickable");this.oVariantPopoverTrigger.addStyleClass("sapUICompVarMngmtClickable")}return this};Y.prototype.getFocusDomRef=function(){if(this.oVariantPopoverTrigger&&this.getEnabled()){return this.oVariantPopoverTrigger.getFocusDomRef()}};Y.prototype._setSelection=function(e,t){if(e.getKey()===t){this._setSelectedItem(e);this.fireSelect({key:t})}};Y.prototype.addStyleClass=function(e){if(x.prototype.addStyleClass){x.prototype.addStyleClass.apply(this,arguments)}if(this.oVariantPopOver){this.oVariantPopOver.addStyleClass(e)}if(this.oSaveDialog){this.oSaveDialog.addStyleClass(e)}if(this.oManagementDialog){this.oManagementDialog.addStyleClass(e)}};Y.prototype.removeStyleClass=function(e){if(x.prototype.addStyleClass){x.prototype.removeStyleClass.apply(this,arguments)}if(this.oVariantPopOver){this.oVariantPopOver.removeStyleClass(e)}if(this.oSaveDialog){this.oSaveDialog.removeStyleClass(e)}if(this.oManagementDialog){this.oManagementDialog.removeStyleClass(e)}};Y.prototype.clearVariantSelection=function(){this.setInitialSelectionKey(this.getStandardVariantKey());this._setSelectedItem(null)};Y.prototype._setDialogCompactStyle=function(e,t){if(this._checkDialogCompactStyle(e)){t.addStyleClass("sapUiSizeCompact")}else{t.removeStyleClass("sapUiSizeCompact")}};Y.prototype._checkDialogCompactStyle=function(e){if(e.$().closest(".sapUiSizeCompact").length>0){return true}else{return false}};Y.prototype.getSelectionKey=function(){var e=null;var t=this._getSelectedItem();if(t!==null){e=t.getKey()}else if(this.bVariantItemMode){e=this.getStandardVariantKey()}else{e=null}return e};Y.prototype._setSelectionByKey=function(e){var t=this._getItems();var a=false;if(t.length>0){for(var i=0;i<t.length;i++){if(t[i].getKey()===e){this._setSelectedItem(t[i]);a=true;break}}}if(!a){this._setSelectedItem(null)}};Y.prototype.setCurrentVariantKey=function(e){this._setSelectionByKey(e)};Y.prototype.replaceKey=function(e,t){var a=this._getItems();if(a.length>0){for(var i=0;i<a.length;i++){if(a[i].getKey()===e){a[i].setKey(t);if(this.getDefaultVariantKey()==e){this.setDefaultVariantKey(t)}if(this._getSelectedItem()===a[i]){this._setSelectedItem(null)}break}}}};Y.prototype.verifyVariantKey=function(e){return this.getItemByKey(e)?true:false};Y.prototype.createVariantEntry=function(e){var t="SV"+(new Date).getTime();var a=new b({key:t,text:e.name,global:e.global});this.addAggregation("variantItems",a,false);return t};Y.prototype._assignUser=function(e,t){var a=this.getItemByKey(e);if(a&&a.isA("sap.ui.comp.variants.VariantItem")&&!a.getAuthor()){a.setAuthor(t)}};Y.prototype.currentVariantSetModified=function(e){if(this.oModel){this.oModel.setProperty("/enabled",e)}};Y.prototype.currentVariantGetModified=function(){return this.oModel.getProperty("/enabled")};Y.prototype._delayedControlCreation=function(){var e=this;if(this._bInnerControlsCreated){return}this._bInnerControlsCreated=true;this.oVariantManage=new m(this.getId()+"-manage",{text:this.oResourceBundle.getText("VARIANT_MANAGEMENT_MANAGE"),enabled:true,press:function(){e._openVariantManagementDialog()},layoutData:new p({priority:W.High})});this.oVariantSave=new m(this.getId()+"-mainsave",{text:this.oResourceBundle.getText("VARIANT_MANAGEMENT_SAVE"),press:function(){var t=e._createEvent("variantSavePressed",e._variantSavePressed);e._addEvent(t)},visible:{parts:[{path:"save_enablement>/creationAllowed"},{path:"save_enablement>/saveVariantVisible"}],formatter:function(e,t){return e&&t}},type:F.Emphasized,layoutData:new p({priority:W.Low})});this.oVariantSave.setModel(this.oModel);this.oVariantSaveAs=new m(this.getId()+"-saveas",{text:this.oResourceBundle.getText("VARIANT_MANAGEMENT_SAVEAS"),press:function(){e._openSaveAsDialog()},visible:"{save_enablement>/creationAllowed}",layoutData:new p({priority:W.Low})});this.oVariantList=new I(this.getId()+"-list",{itemPress:function(t){var a=null;if(t&&t.getParameters()){var i=t.getParameters().item;if(i){a=i.getKey()}}if(a){e.lastSelectedVariantKey=a;e._setSelectionByKey(a);e.oVariantPopOver.close();e.oModel.setProperty("/enabled",false);e.bFireSelect=true}}});this.oVariantList.setNoDataText(this.oResourceBundle.getText("VARIANT_MANAGEMENT_NODATA"));this.oSearchField=new s;this.oSearchField.attachLiveChange(function(t){e._triggerSearch(t)});this._handleArrowUpDown(this.oVariantList,this.oSearchField);this.oVariantSelectionPage=new u(this.getId()+"selpage",{subHeader:new f({content:[this.oSearchField]}),content:[this.oVariantList],footer:new c({content:[new y(this.getId()+"-spacer"),this.oVariantSave,this.oVariantSaveAs,this.oVariantManage]}),showSubHeader:false,showNavButton:false,showHeader:false});this.oVariantPopOver=new A(this.getId()+"-popover",{title:this.oResourceBundle.getText("VARIANT_MANAGEMENT_VARIANTS"),titleAlignment:"Auto",contentWidth:"400px",placement:B.VerticalPreferredBottom,content:[this.oVariantSelectionPage],afterOpen:function(){e.bPopoverOpen=true;e.oVariantPopoverTrigger.setPressed(true);e._markSharedVariants()},afterClose:function(){e.oVariantPopoverTrigger.setPressed(false);if(e.bPopoverOpen){if(e.bFireSelect==true){e.bFireSelect=false;e._fireSelectAsync()}setTimeout(function(){e.bPopoverOpen=false},200)}},contentHeight:"300px"});this.oVariantPopOver.setParent(this);this.oVariantPopOver.addStyleClass("sapUICompVarMngmtPopover");this.oInputName=new V(this.getId()+"-name",{liveChange:function(t){e._checkVariantNameConstraints(this)}});this.oLabelName=new _(this.getId()+"-namelabel",{text:this.oResourceBundle.getText("VARIANT_MANAGEMENT_NAME")});this.oLabelName.setLabelFor(this.oInputName);this.oLabelName.addStyleClass("sapUiCompVarMngmtSaveDialogLabel");this.oDefault=new S(this.getId()+"-default",{text:this.oResourceBundle.getText("VARIANT_MANAGEMENT_SETASDEFAULT"),enabled:true,visible:true,width:"100%"});this.oExecuteOnSelect=new S(this.getId()+"-execute",{text:this.oResourceBundle.getText("VARIANT_MANAGEMENT_EXECUTEONSELECT"),enabled:true,visible:false,width:"100%"});this.oCreateTile=new S(this.getId()+"-tile",{text:this.oResourceBundle.getText("VARIANT_MANAGEMENT_CREATETILE"),enabled:true,visible:false,width:"100%"});this.oShare=new S(this.getId()+"-share",{text:this.oResourceBundle.getText("VARIANT_MANAGEMENT_SHARE"),enabled:true,visible:false,select:function(t){var a=e._createEvent("inputfieldChange",e._handleShareSelected);a.args.push(t);e._addEvent(a)},width:"100%"});this.oInputKey=new V(this.getId()+"-key",{liveChange:function(t){e._checkVariantNameConstraints(this)}});this.oLabelKey=new _(this.getId()+"-keylabel",{text:this.oResourceBundle.getText("VARIANT_MANAGEMENT_KEY"),required:true});this.oLabelKey.setLabelFor(this.oInputKey);this.oSaveSave=new m(this.getId()+"-variantsave",{text:this.oResourceBundle.getText("VARIANT_MANAGEMENT_SAVE"),type:F.Emphasized,press:function(){e._checkVariantNameConstraints(e.oInputName);if(e.oInputName.getValueState()==="Error"){e.oInputName.focus();return}e._bSaveCanceled=false;if(e._fGetDataForKeyUser){e._handleSaveAsPressedForKeyUser()}else{e._triggerSave()}},enabled:true});this.oSaveDialogOptionsGrid=new K({defaultSpan:"L12 M12 S12"});this.oManagementTable=new g(this.getId()+"-managementTable",{contextualWidth:"Auto",fixedLayout:false});this.oManagementSave=new m(this.getId()+"-managementsave",{text:this.oResourceBundle.getText("VARIANT_MANAGEMENT_SAVE"),enabled:true,type:F.Emphasized,press:function(){this._saveFromManagementDialog()}.bind(this)})};Y.prototype._saveFromManagementDialog=function(){if(this._anyItemInErrorState()){return}if(!this._fGetDataForKeyUser){var e=this._createEvent("managementSave",this._handleManageSavePressed);this._addEvent(e)}else{this._handleManageSavePressedForKeyUser()}};Y.prototype._openInErrorState=function(){var e=this,t;if(!this.oErrorVariantPopOver){t=new n({fitContainer:true,alignItems:z.Center,items:[new D({size:"4rem",color:"lightgray",src:"sap-icon://message-error"}),new T({titleStyle:H.H2,text:this.oResourceBundle.getText("VARIANT_MANAGEMENT_ERROR_TEXT1")}),new h({textAlign:G.Center,text:this.oResourceBundle.getText("VARIANT_MANAGEMENT_ERROR_TEXT2")})]});t.addStyleClass("sapUICompVarMngmtErrorPopover");this.oErrorVariantPopOver=new A(this.getId()+"-errorpopover",{title:this.oResourceBundle.getText("VARIANT_MANAGEMENT_VARIANTS"),contentWidth:"400px",placement:B.VerticalPreferredBottom,content:[new u(this.getId()+"-errorselpage",{showSubHeader:false,showNavButton:false,showHeader:false,content:[t]})],afterOpen:function(){e.bPopoverOpen=true},afterClose:function(){if(e.bPopoverOpen){e.bPopoverOpen=false}},contentHeight:"300px"});this.oErrorVariantPopOver.attachBrowserEvent("keyup",function(e){if(e.which===32){this.oErrorVariantPopOver.close()}}.bind(this))}if(this.bPopoverOpen){return}this.oErrorVariantPopOver.openBy(this.oVariantLayout)};Y.prototype.showSaveButton=function(e){if(e){this.oVariantSaveAs.setType(F.Default)}else{this.oVariantSaveAs.setType(F.Emphasized)}this.oModel.setProperty("/saveVariantVisible",e)};Y.prototype._openVariantSelection=function(){var e=null,t;if(this.getInErrorState()){this._openInErrorState();return}this._delayedControlCreation();if(this.bPopoverOpen){return}if(this.bVariantItemMode===false&&this.getSelectionKey()!==null){this.showSaveButton(true)}else{this.showSaveButton(false)}e=this._getItems();if(e.length<9){this.oVariantSelectionPage.setShowSubHeader(false)}else{this.oVariantSelectionPage.setShowSubHeader(true);this.oSearchField.setValue("")}this._restoreCompleteList();if(this.currentVariantGetModified()){t=this.oVariantList.getItemByKey(this.getSelectionKey());if(t){if(!t.getReadOnly()||this._isIndustrySolutionModeAndVendorLayer()&&this.getStandardVariantKey()===t.getKey()){this.showSaveButton(true)}}}if(this._isIndustrySolutionModeAndVendorLayer()&&this.bManualVariantKey&&this.getStandardVariantKey()===this.STANDARDVARIANTKEY){this.showSaveButton(false)}this._setDialogCompactStyle(this,this.oVariantPopOver);t=this.oVariantList.getSelectedItem();if(t){this.oVariantPopOver.setInitialFocus(t.getId())}var a=this._oCtrlRef?this._oCtrlRef:this.oVariantLayout;this._oCtrlRef=null;this.oVariantPopOver.openBy(a)};Y.prototype._obtainControl=function(e){if(e&&e.target&&e.target.id){var t=e.target.id;var a=t.indexOf("-inner");if(a>0){t=t.substring(0,a)}return sap.ui.getCore().byId(t)}return null};Y.prototype.handleOpenCloseVariantPopover=function(e){if(this.oVariantPopOver&&this.oVariantPopOver.isOpen()){this.oVariantPopOver.close()}else if(!this.bPopoverOpen){this._oCtrlRef=this._obtainControl(e);this._openVariantSelection()}else if(this.getInErrorState()&&this.oErrorVariantPopOver&&this.oErrorVariantPopOver.isOpen()){this.oErrorVariantPopOver.close()}};Y.prototype._initalizeManagementTableColumns=function(){if(this.bManagementTableInitialized){return}this.oManagementTable.addColumn(new l({width:"3rem",visible:this.getUseFavorites()&&!this._isIndustrySolutionModeAndVendorLayer()}));this.oManagementTable.addColumn(new l({header:new h({text:this.oResourceBundle.getText("VARIANT_MANAGEMENT_NAME")}),width:"16rem"}));this.oManagementTable.addColumn(new l({header:new h({text:this.oResourceBundle.getText("VARIANT_MANAGEMENT_VARIANTTYPE"),wrappingType:"Hyphenated"}),demandPopin:true,popinDisplay:U.Inline,minScreenWidth:k.Tablet,visible:this.getShowShare()}));this.oManagementTable.addColumn(new l({header:new h({text:this.oResourceBundle.getText("VARIANT_MANAGEMENT_DEFAULT"),wrappingType:"Hyphenated"}),hAlign:G.Center,demandPopin:true,popinDisplay:U.Block,minScreenWidth:k.Tablet,visible:this.getShowSetAsDefault()}));this.oManagementTable.addColumn(new l({header:new h({text:this.oResourceBundle.getText("VARIANT_MANAGEMENT_EXECUTEONSELECT"),wrappingType:"Hyphenated"}),hAlign:this.getDisplayTextForExecuteOnSelectionForStandardVariant&&this.getDisplayTextForExecuteOnSelectionForStandardVariant()?G.Begin:G.Center,demandPopin:true,popinDisplay:U.Block,minScreenWidth:k.Tablet,visible:this.getShowExecuteOnSelection()}));this.oManagementTable.addColumn(new l({header:new h({text:this.oResourceBundle.getText("VARIANT_MANAGEMENT_VISIBILITY"),wrappingType:"Hyphenated"}),width:"8rem",demandPopin:true,popinDisplay:U.Inline,minScreenWidth:k.Tablet,visible:false}));this.oManagementTable.addColumn(new l({header:new h({text:this.oResourceBundle.getText("VARIANT_MANAGEMENT_AUTHOR")}),demandPopin:true,popinDisplay:U.Block,minScreenWidth:k.Tablet}));this.oManagementTable.addColumn(new l({header:new C({text:this.oResourceBundle.getText("VARIANT_MANAGEMENT_ACTION_COLUMN")}),hAlign:G.Center}));this.bManagementTableInitialized=true};Y.prototype._initalizeSaveAsDialog=function(){this.oSaveDialogOptionsGrid.removeAllContent();this.oDefault.setVisible(this.getShowSetAsDefault());this.oShare.setVisible(this.getShowShare());this.oExecuteOnSelect.setVisible(this.getShowExecuteOnSelection());this.oCreateTile.setVisible(this.getShowCreateTile());if(this.getShowSetAsDefault()){this.oSaveDialogOptionsGrid.addContent(this.oDefault)}if(this.getShowShare()){this.oSaveDialogOptionsGrid.addContent(this.oShare)}if(this.getShowExecuteOnSelection()){this.oSaveDialogOptionsGrid.addContent(this.oExecuteOnSelect)}if(this.getShowCreateTile()){this.oSaveDialogOptionsGrid.addContent(this.oCreateTile)}};Y.prototype.ontap=function(e){if(this.getEnabled()){if(this.oVariantPopoverTrigger&&!this.bPopoverOpen){this.oVariantPopoverTrigger.focus()}this.handleOpenCloseVariantPopover(e)}};Y.prototype.onkeyup=function(e){if(e.which===L.ENTER||e.which===L.F4||e.which===L.SPACE||e.altKey===true&&e.which===L.ARROW_UP||e.altKey===true&&e.which===L.ARROW_DOWN){if(this.getEnabled()){this._oCtrlRef=this._obtainControl(e);this._openVariantSelection()}}};Y.prototype.onAfterRendering=function(){this.oVariantText.$().off("mouseover").on("mouseover",function(){this.oVariantPopoverTrigger.addStyleClass("sapUICompVarMngmtTriggerBtnHover")}.bind(this));this.oVariantText.$().off("mouseout").on("mouseout",function(){this.oVariantPopoverTrigger.removeStyleClass("sapUICompVarMngmtTriggerBtnHover")}.bind(this))};Y.prototype.onBeforeRendering=function(){var e=function(e){var t,a=0;for(var i=0;i<e.length;i++){t=e[i].$().width();if(t>a){a=t}}return a};if(this.oSaveDialogOptionsGrid&&this.oSaveDialog&&this.oSaveDialog.getVisible()){var t=this.oSaveDialogOptionsGrid.getContent();if(t&&t.length>0){var a=this.oSaveDialogOptionsGrid.$().width();var i=e(t);var n=32;var s=12;if(!this._checkDialogCompactStyle(this.oSaveDialog)){n=48;s=18}if(n+i+s>a/2){this.oSaveDialogOptionsGrid.setDefaultSpan("L12 M12 S12")}}}};Y.prototype._markSharedVariants=function(){var e,t,a=this._getItems();for(var i=0;i<a.length;i++){t=a[i];if(t.getGlobal&&t.getGlobal()){e=this.oVariantList.getItemByKey(t.getKey());if(e){var n=e.$();if(n){n.addClass("sapUiCompVarMngmtSharedVariant")}}}}};Y.prototype._variantSavePressed=function(){var e=this._getSelectedItem();if(!e){if(this.getStandardVariantKey()===this.STANDARDVARIANTKEY){e=new b({key:this.STANDARDVARIANTKEY,global:this._isIndustrySolutionModeAndVendorLayer()});e.setText(this._determineStandardVariantName())}else{e=this.getItemByKey(this.getStandardVariantKey())}}var t=false;if(this.getDefaultVariantKey()===e.getKey()){t=true}if(e.getLifecyclePackage&&e.getGlobal()==true){var a=this;var i=function(i,n){a.oVariantPopOver.close();a.sPackage=i;a.sTransport=n;a.fireSave({name:e.getText(),overwrite:true,key:e.getKey(),def:t,global:a._isIndustrySolutionModeAndVendorLayer()&&a.getStandardVariantKey()===a.getStandardVariantKey(),lifecyclePackage:a.sPackage,lifecycleTransportId:a.sTransport});e.setLifecycleTransportId(a.sTransport);a.oModel.setProperty("/enabled",false);a._eventDone()};var n=function(e){a.sTransport=null;a.sPackage=null;a._cancelAllEvents()};this._assignTransport(e,i,n,this.oVariantText)}else{this.oVariantPopOver.close();this.fireSave({name:e.getText(),overwrite:true,key:e.getKey(),def:t});this.oModel.setProperty("/enabled",false);this._eventDone()}};Y.prototype._assignTransport=function(e,t,a,i){var n={type:"variant",name:"",namespace:""};n["package"]="";if(e!==null){n["package"]=e.getLifecyclePackage();n["name"]=e.getKey();n["namespace"]=e.getNamespace()}var s=function(e){var a;var i;i=e.getParameters().selectedTransport;a=e.getParameters().selectedPackage;t(a,i)};var r=function(e){a(e)};if(this.getLifecycleSupport()){var o=null;if(e){o=e.getLifecycleTransportId()}if(o!=null&&o.trim().length>0){t(n["package"],o)}else{this._getTransportSelection().then(function(e){e.selectTransport(n,s,r,this._checkDialogCompactStyle(i),i)}.bind(this))}}else{t(n["package"],"")}};Y.prototype._getTransportSelection=function(){if(this.getTransportSelection){return this.getTransportSelection()}else{return this._getFlTransportSelection()}};Y.prototype._getFlTransportSelection=function(){return sap.ui.getCore().loadLibrary("sap.ui.fl",{async:true}).then(function(){return new Promise(function(e){sap.ui.require(["sap/ui/fl/write/api/SmartVariantManagementWriteAPI"],function(t){e(t._getTransportSelection())})})})};Y.prototype.getDefaultVariantKey=function(){var e=this.getProperty("defaultVariantKey");if(e===""){if(this.bVariantItemMode){e=this.getStandardVariantKey()}}return e};Y.prototype._compareItems=function(e,t){var a=e.getText();var i=t.getText();var n=a.toUpperCase();var s=i.toUpperCase();if(n==s){if(a==i){return 0}if(a<i){return-1}if(a>i){return 1}}if(n<s){return-1}if(n>s){return 1}};Y.prototype._accessOptionsText=function(e){var t=null;switch(e){case"R":t=this.oResourceBundle.getText("VARIANT_MANAGEMENT_WRONG_LAYER");break;case"RD":t=this.oResourceBundle.getText("VARIANT_MANAGEMENT_WRONG_LANGUAGE");break;default:t=null}return t};Y.prototype._openSaveAsDialog=function(){this._initSaveAsDialog();this.oSaveDialog.open()};Y.prototype._initSaveAsDialog=function(){this._initalizeSaveAsDialog();this.oInputName.setValue(this.oModel.getProperty("/selectedVariant"));this.oInputName.setEnabled(true);this.oInputName.setValueState(P.None);this.oInputName.setValueStateText(null);this.oDefault.setSelected(false);this.oShare.setSelected(false);this.oCreateTile.setSelected(false);this.oExecuteOnSelect.setSelected(false);if(this._isIndustrySolutionModeAndVendorLayer()){this.oInputName.setValue(this.oResourceBundle.getText("VARIANT_MANAGEMENT_STANDARD"))}this._createSaveDialog();this._setDialogCompactStyle(this,this.oSaveDialog);this.oVariantPopOver.close();this.sTransport=null;this.sPackage=null;if(this.bManualVariantKey){this.oInputKey.setVisible(true);this.oInputKey.setEnabled(true);this.oInputKey.setValueState(P.None);this.oInputKey.setValueStateText(null);this.oLabelKey.setVisible(true)}else{this.oInputKey.setVisible(false);this.oLabelKey.setVisible(false)}};Y.prototype._checkManageItemNameChange=function(e){var t="";var a=null;var i=this;a=e.getCells()[Y.NAME_COLUMN];t=a.getValue();t=t.trim();var n=e;var s=n.getKey();this._checkVariantNameConstraints(a,this.oManagementTable);if(a.getValueState()===P.Error){this._eventDone();return}if(this.oVariantList.getItemByKey(s).getText().trim()===t){this._eventDone();return}if(n.getGlobal()){var r=function(e,t){n.setLifecyclePackage(e);n.setLifecycleTransportId(t);i._eventDone()};var o=function(e){if(i&&i.oVariantList){var t=i.oVariantList.getItemByKey(s);a.setValue(t.getText())}i._cancelAllEvents()};this._createManagementDialog();this._assignTransport(n,r,o,this.oManagementDialog)}else{this._eventDone()}};Y.prototype._handleManageSavePressed=function(){var e=this.oManagementTable.getItems();var t,a;var i=false;var n="";var s=null;var r=0;var o=[];for(var l=0;l<e.length;l++){t=this.oVariantList.getItemByKey(e[l].getKey());a=e[l].getCells()[Y.NAME_COLUMN];if(a&&a.getValue){n=a.getValue()}else if(a&&a.getTitle){n=a.getTitle()}else if(a&&a.getText){n=a.getText()}n=n.trim();if(t.getText()!==n){this.aRenamedVariants.push({key:t.getKey(),name:n});s=this.getItemByKey(e[l].getKey());s.setText(n);if(s.setLifecyclePackage){s.setLifecyclePackage(e[l].getLifecyclePackage());s.setLifecycleTransportId(e[l].getLifecycleTransportId())}if(this.lastSelectedVariantKey===t.getKey()){this._setVariantText(n)}}if(this.getUseFavorites()&&!this._isIndustrySolutionModeAndVendorLayer()){var h=e[l].getKey();if(this._mFavoriteChanges&&this._mFavoriteChanges[h]!==undefined){var d=this._mFavoriteChanges[h];if(h===this.STANDARDVARIANTKEY){if(this.getStandardFavorite()!==d){o.push({key:h,visible:d});this.setStandardFavorite(d)}}else{s=this.getItemByKey(e[l].getKey());if(s&&t.getFavorite&&t.getFavorite()!==d){o.push({key:h,visible:d});s.setFavorite(d)}}}}if(this.getShowExecuteOnSelection()&&t.getExecuteOnSelection&&e[l].getCells()[Y.EXEC_COLUMN].isA("sap.m.CheckBox")&&t.getExecuteOnSelection()!=e[l].getCells()[Y.EXEC_COLUMN].getSelected()){var g=e[l].getCells()[Y.EXEC_COLUMN].getSelected();var u=this.getItemByKey(e[l].getKey());if(!u&&this.getSupportExecuteOnSelectOnSandardVariant()&e[l].getKey()===this.getStandardVariantKey()){u=new b}if(u&&u.setExecuteOnSelection){u.setExecuteOnSelection(g);if(this.getSupportExecuteOnSelectOnSandardVariant()&e[l].getKey()===this.getStandardVariantKey()){this._executeOnSelectForStandardVariantByUser(g)}this.aExeVariants.push({key:t.getKey(),exe:g});if(u.setLifecyclePackage&&!u.getReadOnly()){u.setLifecyclePackage(e[l].getLifecyclePackage());u.setLifecycleTransportId(e[l].getLifecycleTransportId())}}}}if(this.oManagementDialog){this.oManagementDialog.close()}if(this.bVariantItemMode===false){if(this.getDefaultVariantKey()!=this.sNewDefaultKey){var c=null;if(this.sNewDefaultKey==this.getStandardVariantKey()){c=this.getItemByKey(this.getDefaultVariantKey());this.fireSave({name:c.getText(),overwrite:true,key:c.getKey(),def:false})}else{c=this.getItemByKey(this.sNewDefaultKey);this.fireSave({name:c.getText(),overwrite:true,key:c.getKey(),def:true})}}}if(this.sNewDefaultKey!=this.getDefaultVariantKey()){this.setDefaultVariantKey(this.sNewDefaultKey)}for(r=0;r<this.aRemovedVariants.length;r++){t=this.getItemByKey(this.aRemovedVariants[r]);for(var p=0;p<this.aRemovedVariantTransports.length;p++){if(this.aRemovedVariants[r]===this.aRemovedVariantTransports[p].key){var f=this.aRemovedVariantTransports[p];if(t.setLifecyclePackage){t.setLifecycleTransportId(f.transport)}break}}}this.fireManage({renamed:this.aRenamedVariants,deleted:this.aRemovedVariants,exe:this.aExeVariants,def:this.getDefaultVariantKey(),fav:o});for(r=0;r<this.aRemovedVariants.length;r++){t=this.getItemByKey(this.aRemovedVariants[r]);if(t){this._removeItem(t);t.destroy()}if(this.lastSelectedVariantKey===this.aRemovedVariants[r]){i=true;this._setSelectedItem(null);this.oModel.setProperty("/enabled",false)}}if(i){this.bFireSelect=true}this._eventDone()};Y.prototype._createEvent=function(e,t){var a={name:e,fFunc:t,args:[]};return a};Y.prototype._handleNextEvent=function(){if(this.aEvents.length>0){if(!this.bEventRunning){this.bEventRunning=true;var e=this.aEvents.pop();e.fFunc.apply(this,e.args)}}};Y.prototype._addEvent=function(e){this.aEvents.push(e);this._handleNextEvent()};Y.prototype._cancelAllEvents=function(){this.aEvents=[];this.bEventRunning=false};Y.prototype._eventDone=function(){this.bEventRunning=false;this._handleNextEvent()};Y.prototype._handleManageExecuteOnSelectionChanged=function(e){var t=this;var a=e.getParent();if(a&&a.getGlobal()&&!a.getReadOnly()){var i=function(e,i){a.setLifecyclePackage(e);a.setLifecycleTransportId(i);t._eventDone()};var n=function(a){e.setSelected(!e.getSelected());t._cancelAllEvents()};this._createManagementDialog();this._assignTransport(a,i,n,this.oManagementDialog)}else{this._eventDone()}};Y.prototype._handleManageDeletePressed=function(e){var t=this,a;var i=function(){var e=null,a=t.oManagementTable.getItems();a.some(function(a){if(a.getKey()===t.getStandardVariantKey()){e=a;return true}});return e};this._anyInErrorState(this.oManagementTable,e.getParent().getCells()[Y.NAME_COLUMN]);a=i();var n=e.getParent();if(n.getGlobal()){var s=function(e,i){var s=n.getKey();t.aRemovedVariants.push(s);t.oManagementTable.removeItem(n);if(t.getShowSetAsDefault()){if(n.getKey()===t.sNewDefaultKey){if(a){a.getCells()[Y.DEF_COLUMN].setSelected(true);a.getCells()[Y.DEF_COLUMN].fireSelect({selected:true})}else{t.setStandardVariantKey(t.STANDARDVARIANTKEY)}t.sNewDefaultKey=t.getStandardVariantKey()}}n.destroy();var r={key:s,transport:i};t.aRemovedVariantTransports.push(r);t._eventDone()};var r=function(e){t._cancelAllEvents()};this._createManagementDialog();this._assignTransport(n,s,r,this.oManagementDialog)}else{this.aRemovedVariants.push(n.getKey());this.oManagementTable.removeItem(n);if(this.getShowSetAsDefault()){if(n.getKey()===this.sNewDefaultKey){if(a){a.getCells()[Y.DEF_COLUMN].setSelected(true);a.getCells()[Y.DEF_COLUMN].fireSelect({selected:true})}this.sNewDefaultKey=this.getStandardVariantKey()}}n.destroy();this._eventDone()}var o=sap.ui.getCore().byId(this.getId()+"-managementcancel");if(o){o.focus()}};Y.prototype._handleShareSelected=function(e){var t=this;if(e.getParameters&&e.getParameters()&&e.getParameters().selected){var a=function(e,a){t.sTransport=a;t.sPackage=e;t._eventDone()};var i=function(e){t.oShare.setSelected(false);t.sTransport=null;t.sPackage=null;t._cancelAllEvents()};this._createSaveDialog();this._assignTransport(null,a,i,this.oSaveDialog)}else{this.sTransport=null;this.sPackage=null;this._eventDone()}};Y.prototype._handleVariantSaveAs=function(){var e="SV"+(new Date).getTime();var t=this.oInputName.getValue();var a=this.oInputKey.getValue();var i="";var n="";var s=false;var r=false;var o=null;t=t.trim();if(t==""){this.oInputName.setValueState(P.Error);this.oInputName.setValueStateText(this.oResourceBundle.getText("VARIANT_MANAGEMENT_ERROR_EMPTY"));this._cancelAllEvents();return}a=a.trim();if(this.bManualVariantKey&&a==""){this.oInputKey.setValueState(P.Error);this.oInputKey.setValueStateText(this.oResourceBundle.getText("VARIANT_MANAGEMENT_ERROR_EMPTY"));this._cancelAllEvents();return}if(this.bManualVariantKey){e=a}if(this.oSaveDialog){this.oSaveDialog.close()}if(this.oExecuteOnSelect!==null){s=this.oExecuteOnSelect.getSelected()}if(this.oCreateTile!==null){r=this.oCreateTile.getSelected()}if(this.bVariantItemMode){o=new b({key:e,readOnly:false,executeOnSelection:s,global:this.oShare.getSelected(),lifecycleTransportId:this.sTransport,lifecyclePackage:this.sPackage});o.setText(t);this.addVariantItem(o);this._setSelectedItem(o)}else{o=new R({key:e});o.setText(t);this.addItem(o);this._setSelectedItem(o)}if(this.oDefault.getSelected()){this.setDefaultVariantKey(e)}if(this.oShare.getSelected()){n=this.sPackage;i=this.sTransport}this.fireSave({name:t,overwrite:false,def:this.oDefault.getSelected(),key:e,exe:this.oExecuteOnSelect.getSelected(),tile:r,global:this.oShare.getSelected(),lifecyclePackage:n,lifecycleTransportId:i});this.oModel.setProperty("/enabled",false);this._eventDone()};Y.prototype.setBackwardCompatibility=function(e){this._setBackwardCompatibility(e)};Y.prototype._setBackwardCompatibility=function(e){if(this.getItems().length===0&&this.getVariantItems().length===0){this.bVariantItemMode=!e}this._setStandardText()};Y.prototype._setStandardText=function(){var e=this.getSelectionKey();if(e===null||e===this.getStandardVariantKey()){if(this.bVariantItemMode==false){this._setVariantText(this.oResourceBundle.getText("VARIANT_MANAGEMENT_DEFAULT"))}else{this._setVariantText(this.oResourceBundle.getText("VARIANT_MANAGEMENT_STANDARD"))}if(this.getStandardItemText()!==null&&this.getStandardItemText()!=""){this._setVariantText(this.getStandardItemText())}}};Y.prototype._setVariantText=function(e){var t,a=this.extractBindingInfo(e),i=e;if(typeof a==="object"&&a.model&&a.path){t=this.getModel(a.model);if(t){i=t.getProperty(a.path)}}this.oModel.setProperty("/selectedVariant",i)};Y.prototype._getVariantText=function(e){return this.oModel.getProperty("/selectedVariant")};Y.prototype._updateVariantInvisibletext=function(e,t){if(t){e=this.oResourceBundle.getText("VARIANT_MANAGEMENT_MODIFIED",[e])}return e};Y.prototype._setFavoriteIcon=function(e,t){e.setSrc(t?"sap-icon://favorite":"sap-icon://unfavorite");e.setTooltip(this.oResourceBundle.getText(t?"VARIANT_MANAGEMENT_FAV_DEL_TOOLTIP":"VARIANT_MANAGEMENT_FAV_ADD_TOOLTIP"));e.setAlt(this.oResourceBundle.getText(t?"VARIANT_MANAGEMENT_FAV_DEL_ACC":"VARIANT_MANAGEMENT_FAV_ADD_ACC"))};Y.prototype._isFavoriteSelected=function(e){return e.getSrc()==="sap-icon://unfavorite"};Y.prototype._openVariantManagementDialog=function(){var e;var t=null;var a=0;var i;var n;var s;var r;var l;var d;var g;var u;var c,p,f,y,v,T;var _=this;this._mFavoriteChanges={};this.oManagementSave.setEnabled(true);this.oManagementSave.setTooltip(null);this.oManagementTable.destroyItems();c=function(e){_._checkVariantNameConstraints(this,_.oManagementTable)};p=function(e){var t=_._createEvent("inputfieldChange",_._checkManageItemNameChange);t.args.push(this.getParent());_._addEvent(t)};v=function(e){var t=_._isFavoriteSelected(e.oSource),a=this.getParent();if(a&&_.sNewDefaultKey!==a.getKey()){_._mFavoriteChanges[a.getKey()]=t;_._setFavoriteIcon(e.oSource,t)}};f=function(e){var t=e.getParameters().selected===true,a=this.getParent();if(a){if(t){_.sNewDefaultKey=a.getKey();_._mFavoriteChanges[a.getKey()]=t}var i=a.getCells()[Y.FAV_COLUMN];if(i&&a.getFavorite){if(t){_._setFavoriteIcon(i,true)}else if(_._mFavoriteChanges[a.getKey()]!==undefined){_._setFavoriteIcon(i,_._mFavoriteChanges[a.getKey()])}else{_._setFavoriteIcon(i,a.getFavorite()===true)}}}};y=function(e){var t=_._createEvent("executeOnSelectionChange",_._handleManageExecuteOnSelectionChanged);t.args.push(this);_._addEvent(t)};T=function(e){var t=_._createEvent("manageDeletePressed",_._handleManageDeletePressed);t.args.push(this);_._addEvent(t)};if(this.oManageDialogSearchField){this.oManageDialogSearchField.setValue("")}this._initalizeManagementTableColumns();this.sNewDefaultKey=this.getDefaultVariantKey();this._restoreCompleteList(true);if(this.oVariantList.getItems()[0].getKey()!==this.getStandardVariantKey()&&this.bVariantItemMode==false){e=new b(this.oVariantManage.getId()+"-item-standard",{key:this.getStandardVariantKey(),text:this.oResourceBundle.getText("VARIANT_MANAGEMENT_DEFAULT"),readOnly:true,executeOnSelection:false});this.oVariantList.insertItem(e,0)}if(this.getUseFavorites()){e=this.oVariantList.getItemByKey(this.getStandardVariantKey());if(e){this.oVariantList.removeItem(e)}}t=this.oVariantList.getItems();if(this.getUseFavorites()){t.sort(this._compareItems);if(e){this.oVariantList.insertItem(e);t.splice(0,0,e)}}for(var A=0;A<t.length;A++){if(t[A].getReadOnly()||t[A].getLabelReadOnly()){var I=t[A].getAccessOptions();u=this._accessOptionsText(I)}else{u=null}if(t[A].getReadOnly()){u=this.oResourceBundle.getText("VARIANT_MANAGEMENT_WRONG_LAYER")}else if(t[A].getLabelReadOnly()===true){u=this.oResourceBundle.getText("VARIANT_MANAGEMENT_WRONG_LANGUAGE")}if(t[A].getKey()===this.getStandardVariantKey()){u=null}i=new N(this.oVariantManage.getId()+"-edit-"+a,{key:t[A].getKey(),global:t[A].getGlobal(),readOnly:t[A].getReadOnly(),lifecyclePackage:t[A].getLifecyclePackage(),lifecycleTransportId:t[A].getLifecycleTransportId(),namespace:t[A].getNamespace(),labelReadOnly:t[A].getLabelReadOnly(),author:t[A].getAuthor(),favorite:t[A].getFavorite(),vAlign:w.Middle});n=new D(this.oVariantManage.getId()+"-fav-"+a,{press:v});n.addStyleClass("sapUICompVarMngmtFavColor");if(t[A].getFavorite){this._setFavoriteIcon(n,t[A].getFavorite())}i.addCell(n);if(t[A].getKey()===this.getStandardVariantKey()||t[A].getReadOnly()===true||t[A].getLabelReadOnly()===true){n=new M(this.oVariantManage.getId()+"-text-"+a,{});n.setTitle(t[A].getText());if(u){n.setTooltip(u)}}else{n=new V(this.oVariantManage.getId()+"-input-"+a,{liveChange:c,change:p});n.setValue(t[A].getText())}i.addCell(n);if(t[A].getGlobal()){g=this.oResourceBundle.getText("VARIANT_MANAGEMENT_SHARED")}else{g=this.oResourceBundle.getText("VARIANT_MANAGEMENT_PRIVATE")}s=new h(this.oVariantManage.getId()+"-type-"+a,{text:g,wrapping:false});s.addStyleClass("sapUICompVarMngmtType");i.addCell(s);r=new o(this.oVariantManage.getId()+"-def-"+a,{groupName:this.oVariantManage.getId(),select:f});if(this.sNewDefaultKey===t[A].getKey()||t[A].getKey()===this.getStandardVariantKey()&&this.sNewDefaultKey===""){r.setSelected(true);if(t[A].getFavorite){this._setFavoriteIcon(i.getCells()[0],true)}}i.addCell(r);l=new S(this.oVariantManage.getId()+"-exe-"+a,{selected:false,enabled:false,select:y});if(t[A].getExecuteOnSelection){if(t[A].getKey()===this.getStandardVariantKey()&&this.getSupportExecuteOnSelectOnSandardVariant()){l.setEnabled(true);if(this.bExecuteOnSelectForStandardByUser!==null){l.setSelected(this.bExecuteOnSelectForStandardByUser)}else{l.setSelected(t[A].getExecuteOnSelection())}}else{l.setEnabled(!t[A].getReadOnly());l.setSelected(t[A].getExecuteOnSelection())}if(u){l.setTooltip(u)}}i.addCell(l);i.addCell(new h);s=new h(this.oVariantManage.getId()+"-author-"+a,{text:t[A].getAuthor(),textAlign:"Begin"});i.addCell(s);d=new m(this.oVariantManage.getId()+"-del-"+a,{icon:"sap-icon://decline",enabled:true,type:F.Transparent,press:T,tooltip:this.oResourceBundle.getText("VARIANT_MANAGEMENT_DELETE")});if(t[A].getReadOnly&&t[A].getReadOnly()){d.setEnabled(false);d.setVisible(false)}i.addCell(d);this.oManagementTable.addItem(i);a++}this.aRemovedVariants=[];this.aRemovedVariantTransports=[];this.aRenamedVariants=[];this.aExeVariants=[];this._createManagementDialog();this._setDialogCompactStyle(this,this.oManagementDialog);e=this.oVariantList.getSelectedItem();if(e){this.lastSelectedVariantKey=e.getKey()}this.oVariantPopOver.close();this.oManagementDialog.open()};Y.prototype._assignColumnInfoForDeleteButton=function(e){if(!this._oInvisibleDeleteColumnName){this._oInvisibleDeleteColumnName=new C({text:this.oResourceBundle.getText("VARIANT_MANAGEMENT_ACTION_COLUMN")});this._createManagementDialog();this.oManagementDialog.addContent(this._oInvisibleDeleteColumnName)}if(this._oInvisibleDeleteColumnName){e.addAriaLabelledBy(this._oInvisibleDeleteColumnName)}};Y.prototype._enableManualVariantKey=function(e){this.bManualVariantKey=e};Y.prototype._fireSelectAsync=function(e){var t;if(e===undefined||e===null){var a=this._getSelectedItem();if(a===null){t=this.getStandardVariantKey()}else{t=a.getKey()}}this.fireSelect({key:t})};Y.prototype.setSupportExecuteOnSelectOnSandardVariant=function(e){this.bSupportExecuteOnSelectOnSandardVariant=e};Y.prototype.getSupportExecuteOnSelectOnSandardVariant=function(){return this.bSupportExecuteOnSelectOnSandardVariant};Y.prototype._executeOnSelectForStandardVariantByXML=function(e){this.bExecuteOnSelectForStandardViaXML=e};Y.prototype._executeOnSelectForStandardVariantByUser=function(e){this.bExecuteOnSelectForStandardByUser=e};Y.prototype.getExecuteOnSelectForStandardVariant=function(){if(this.getSupportExecuteOnSelectOnSandardVariant()){if(this.bExecuteOnSelectForStandardByUser!==null){return this.bExecuteOnSelectForStandardByUser}}return this.bExecuteOnSelectForStandardViaXML};Y.prototype.getStandardVariantKey=function(){return this._sStandardVariantKey};Y.prototype.setStandardVariantKey=function(e){this._sStandardVariantKey=e};Y.prototype._setVendorLayer=function(e){this._bVendorLayer=e};Y.prototype.setStandardFavorite=function(e){this._isFavorite=e};Y.prototype.getStandardFavorite=function(){return this._isFavorite};Y.prototype._isIndustrySolutionModeAndVendorLayer=function(){if(this._getIndustrySolutionMode()&&this._bVendorLayer){return true}return false};Y.prototype._setIndustrySolutionMode=function(e){this._bIndustrialSolutionMode=e};Y.prototype._getIndustrySolutionMode=function(){return this._bIndustrialSolutionMode};return Y});
sap.ui.require.preload({
	"sap/ui/comp/manifest.json":'{"_version":"1.21.0","sap.app":{"id":"sap.ui.comp","type":"library","embeds":[],"applicationVersion":{"version":"1.120.3"},"title":"SAPUI5 library with smart controls.","description":"SAPUI5 library with smart controls.","ach":"CA-UI5-CMP\\n\\t\\t\\t","resources":"resources.json","offline":true},"sap.ui":{"technology":"UI5","supportedThemes":["base","sap_belize","sap_belize_hcb","sap_belize_hcw","sap_belize_plus","sap_bluecrystal","sap_fiori_3","sap_fiori_3_dark","sap_fiori_3_hcb","sap_fiori_3_hcw","sap_hcb","sap_horizon","sap_horizon_dark","sap_horizon_hcb","sap_horizon_hcw"]},"sap.ui5":{"dependencies":{"minUI5Version":"1.120","libs":{"sap.ui.core":{"minVersion":"1.120.3"},"sap.m":{"minVersion":"1.120.3"},"sap.ui.mdc":{"minVersion":"1.120.3"},"sap.ui.fl":{"minVersion":"1.120.3","lazy":true},"sap.ui.table":{"minVersion":"1.120.3","lazy":true},"sap.chart":{"minVersion":"1.120.3","lazy":true},"sap.ui.layout":{"minVersion":"1.120.3","lazy":true},"sap.suite.ui.microchart":{"minVersion":"1.120.3","lazy":true}}},"library":{"i18n":{"bundleUrl":"messagebundle.properties","supportedLocales":["","ar","bg","ca","cnr","cs","cy","da","de","el","en","en-GB","en-US-sappsd","en-US-saprigi","en-US-saptrc","es","es-MX","et","fi","fr","fr-CA","hi","hr","hu","id","it","iw","ja","kk","ko","lt","lv","mk","ms","nl","no","pl","pt","pt-PT","ro","ru","sh","sk","sl","sv","th","tr","uk","vi","zh-CN","zh-TW"]},"content":{"controls":["sap.ui.comp.filterbar.FilterBar","sap.ui.comp.navpopover.NavigationPopover","sap.ui.comp.navpopover.SmartLink","sap.ui.comp.smartchart.SmartChart","sap.ui.comp.smartfield.SmartField","sap.ui.comp.smartfield.SmartLabel","sap.ui.comp.smartfilterbar.SmartFilterBar","sap.ui.comp.smartform.SmartForm","sap.ui.comp.smartmultiedit.Field","sap.ui.comp.smartmultiedit.Container","sap.ui.comp.smartmicrochart.SmartAreaMicroChart","sap.ui.comp.smartmicrochart.SmartLineMicroChart","sap.ui.comp.smartmicrochart.SmartBulletMicroChart","sap.ui.comp.smartmicrochart.SmartDeltaMicroChart","sap.ui.comp.smartmicrochart.SmartRadialMicroChart","sap.ui.comp.smartmicrochart.SmartStackedBarMicroChart","sap.ui.comp.smartmicrochart.SmartComparisonMicroChart","sap.ui.comp.smartmicrochart.SmartColumnMicroChart","sap.ui.comp.smartmicrochart.SmartHarveyBallMicroChart","sap.ui.comp.smartmicrochart.SmartMicroChart","sap.ui.comp.smarttable.SmartTable","sap.ui.comp.smartlist.SmartList","sap.ui.comp.valuehelpdialog.ValueHelpDialog","sap.ui.comp.transport.TransportDialog","sap.ui.comp.variants.EditableVariantItem","sap.ui.comp.variants.VariantManagement","sap.ui.comp.smartvariants.SmartVariantManagement","sap.ui.comp.smartvariants.SmartVariantManagementUi2"],"elements":["sap.ui.comp.filterbar.FilterGroupItem","sap.ui.comp.filterbar.FilterItem","sap.ui.comp.navpopover.LinkData","sap.ui.comp.navpopover.SemanticObjectController","sap.ui.comp.smartfield.Configuration","sap.ui.comp.smartfield.ControlProposal","sap.ui.comp.smartfield.ObjectStatus","sap.ui.comp.smartfilterbar.ControlConfiguration","sap.ui.comp.smartfilterbar.GroupConfiguration","sap.ui.comp.smartfilterbar.SelectOption","sap.ui.comp.smartform.Group","sap.ui.comp.smartform.GroupElement","sap.ui.comp.smartform.SemanticGroupElement","sap.ui.comp.smartform.Layout","sap.ui.comp.smartvariants.PersonalizableInfo","sap.ui.comp.variants.VariantItem","sap.ui.comp.navpopover.NavigationContainer","sap.ui.comp.smartvariants.SmartVariantManagementAdapter"],"types":["sap.ui.comp.smartfield.ControlProposalType","sap.ui.comp.smartfield.ControlContextType","sap.ui.comp.smartfield.ControlType","sap.ui.comp.smartchart.SelectionMode","sap.ui.comp.smartfield.DisplayBehaviour","sap.ui.comp.smartfield.JSONType","sap.ui.comp.smartfield.CriticalityRepresentationType","sap.ui.comp.smartfield.TextInEditModeSource","sap.ui.comp.smartfield.Importance","sap.ui.comp.TextArrangementType","sap.ui.comp.smarttable.TableType","sap.ui.comp.smarttable.ExportType","sap.ui.comp.smartlist.ListType","sap.ui.comp.personalization.AggregationRole","sap.ui.comp.personalization.ResetType","sap.ui.comp.personalization.ChangeType","sap.ui.comp.valuehelpdialog.ValueHelpRangeOperation","sap.ui.comp.smartfilterbar.SelectOptionSign","sap.ui.comp.smartfilterbar.DisplayBehaviour","sap.ui.comp.smartform.SmartFormValidationMode"],"interfaces":["sap.ui.comp.smartform.SmartFormLayout","sap.ui.comp.IFormGroupElement","sap.ui.comp.IDropDownTextArrangement"]}}}}',
	"sap/ui/comp/smartchart/SmartChart.js":function(){
/*!
 * SAPUI5
 * (c) Copyright 2009-2023 SAP SE. All rights reserved.
 */
(function(){"use strict";var t=sap.ui.require("sap/ui/performance/Measurement");if(t&&t.getActive()){t.start("SmartChartInit","Measurement of SmartChart init time")}})();sap.ui.define(["sap/ui/thirdparty/jquery","sap/ui/comp/library","sap/ui/comp/util/DateTimeUtil","sap/m/Button","sap/m/Text","sap/m/FlexItemData","sap/m/OverflowToolbar","sap/m/OverflowToolbarButton","sap/m/OverflowToolbarToggleButton","sap/m/ToolbarSeparator","sap/m/ToolbarSpacer","sap/m/VBox","sap/ui/comp/providers/ChartProvider","sap/ui/comp/smartfilterbar/FilterProvider","sap/ui/comp/smartvariants/SmartVariantManagement","sap/ui/comp/smartvariants/PersonalizableInfo","sap/ui/model/json/JSONModel","sap/ui/model/Sorter","sap/ui/model/Filter","sap/ui/model/FilterOperator","sap/ui/comp/personalization/Util","sap/ui/Device","sap/ui/comp/odata/ODataModelUtil","sap/ui/comp/odata/MetadataAnalyser","sap/ui/comp/state/UIState","sap/m/SelectionDetails","sap/m/SelectionDetailsItem","sap/m/SelectionDetailsItemLine","sap/m/Title","sap/ui/comp/util/FormatUtil","sap/ui/comp/navpopover/NavigationPopoverHandler","sap/ui/core/InvisibleText","sap/m/OverflowToolbarLayoutData","sap/m/library","sap/ui/comp/personalization/Controller","sap/ui/comp/personalization/ChartWrapper","sap/ui/comp/navpopover/SemanticObjectController","sap/ui/performance/Measurement","sap/base/Log","sap/base/util/merge","sap/chart/TimeUnitType","sap/ui/core/CustomData","sap/ui/core/ResizeHandler","sap/ui/comp/util/FullScreenUtil","sap/ui/comp/util/FilterUtil","sap/ui/core/library","sap/ui/core/ShortcutHintsMixin","sap/ui/events/KeyCodes"],function(jQuery,t,e,i,a,r,o,s,n,l,h,u,c,p,d,_,f,m,g,b,C,y,v,T,S,D,B,P,V,w,M,I,O,A,L,F,x,R,N,H,E,U,j,z,q,k,Z,K){"use strict";var G=A.ToolbarDesign;var W=A.ListMode;var X=A.ListType;var $=A.PlacementType;var J=t.personalization.ChangeType;var Q=t.personalization.ResetType;var Y=t.smartchart.SelectionMode;var tt=k.aria.HasPopup;var et=k.TitleLevel;var it;var at;var rt;var ot;var st;var nt;var lt;var ht;var ut;var ct;var pt;var dt;var _t;var ft;var mt;var gt;var bt;var Ct;var yt=u.extend("sap.ui.comp.smartchart.SmartChart",{metadata:{library:"sap.ui.comp",designtime:"sap/ui/comp/designtime/smartchart/SmartChart.designtime",properties:{entitySet:{type:"string",group:"Misc",defaultValue:null},smartFilterId:{type:"string",group:"Misc",defaultValue:null},ignoredFields:{type:"string",group:"Misc",defaultValue:null},requestAtLeastFields:{type:"string",group:"Misc",defaultValue:null},ignoreFromPersonalisation:{type:"string",group:"Misc",defaultValue:null},chartType:{type:"string",group:"Misc",defaultValue:null},ignoredChartTypes:{type:"string",group:"Misc",defaultValue:null},useVariantManagement:{type:"boolean",group:"Misc",defaultValue:true},useChartPersonalisation:{type:"boolean",group:"Misc",defaultValue:true},header:{type:"string",group:"Misc",defaultValue:null},headerLevel:{type:"sap.ui.core.TitleLevel",group:"Appearance",defaultValue:et.Auto},headerStyle:{type:"sap.ui.core.TitleLevel",group:"Appearance",defaultValue:et.Auto},persistencyKey:{type:"string",group:"Misc",defaultValue:null},currentVariantId:{type:"string",group:"Misc",defaultValue:null},enableAutoBinding:{type:"boolean",group:"Misc",defaultValue:false},chartBindingPath:{type:"string",group:"Misc",defaultValue:null},showDrillButtons:{type:"boolean",group:"Misc",defaultValue:true},showZoomButtons:{type:"boolean",group:"Misc",defaultValue:true},showSemanticNavigationButton:{type:"boolean",group:"Misc",defaultValue:true},showVariantManagement:{type:"boolean",group:"Misc",defaultValue:true},showDownloadButton:{type:"boolean",group:"Misc",defaultValue:false},showDetailsButton:{type:"boolean",group:"Misc",defaultValue:false},showDrillBreadcrumbs:{type:"boolean",group:"Misc",defaultValue:false},showChartTooltip:{type:"boolean",group:"Misc",defaultValue:true},showLegendButton:{type:"boolean",group:"Misc",defaultValue:true},legendVisible:{type:"boolean",group:"Misc",defaultValue:true},selectionMode:{type:"sap.ui.comp.smartchart.SelectionMode",group:"Misc",defaultValue:Y.Multi},showFullScreenButton:{type:"boolean",group:"Misc",defaultValue:true},useTooltip:{type:"boolean",group:"Misc",defaultValue:true},useListForChartTypeSelection:{type:"boolean",group:"Misc",defaultValue:true},showChartTypeSelectionButton:{type:"boolean",group:"Misc",defaultValue:true},noData:{type:"string",group:"Misc",defaultValue:null},showToolbar:{type:"boolean",group:"Misc",defaultValue:true},toolbarStyle:{type:"sap.m.ToolbarStyle",group:"Appearance"},showDimensionsTitle:{type:"boolean",group:"Misc",defaultValue:true},showMeasuresTitle:{type:"boolean",group:"Misc",defaultValue:true},activateTimeSeries:{type:"boolean",group:"Misc",defaultValue:false},notAssignedText:{type:"string",group:"Misc",defaultValue:""}},associations:{smartVariant:{type:"sap.ui.core.Control",multiple:false}},aggregations:{toolbar:{type:"sap.m.Toolbar",multiple:false},semanticObjectController:{type:"sap.ui.comp.navpopover.SemanticObjectController",multiple:false},selectionDetailsItemActions:{type:"sap.ui.core.Item",multiple:true},selectionDetailsActions:{type:"sap.ui.core.Item",multiple:true},selectionDetailsActionGroups:{type:"sap.ui.core.Item",multiple:true}},events:{initialise:{},initialized:{},beforeRebindChart:{},dataReceived:{},afterVariantInitialise:{},afterVariantSave:{parameters:{currentVariantId:{type:"string"}}},afterVariantApply:{parameters:{currentVariantId:{type:"string"},variantContext:{type:"string"}}},showOverlay:{},fullScreenToggled:{parameters:{fullScreen:{type:"boolean"}}},selectionDetailsActionPress:{parameters:{action:{type:"sap.ui.core.Item"},itemContexts:{type:"sap.ui.model.Context"},level:{type:"sap.m.SelectionDetailsActionLevel"}}},chartDataChanged:{parameters:{changeTypes:{type:"object"}}},uiStateChange:{}}},renderer:{apiVersion:2}});yt.prototype.init=function(){u.prototype.init.call(this);this.addStyleClass("sapUiCompSmartChart");this.setFitContainer(true);this._bUpdateToolbar=true;this._oChartTypeModel=null;var t=new f({items:[]});this.setModel(t,"$smartChartTypes");this._oRb=sap.ui.getCore().getLibraryResourceBundle("sap.ui.comp");if(!this.getLayoutData()){this.setLayoutData(new r({growFactor:1,baseSize:"auto"}))}};yt.prototype._getVariantManagementControl=function(t){var e=null;if(t){if(typeof t==="string"){e=sap.ui.getCore().byId(t)}else{e=t}if(e){if(!(e instanceof d)){N.error("Control with the id="+typeof t.getId=="function"?t.getId():t+" not of expected type");return null}}}return e};yt.prototype._createVariantManagementControl=function(){if(this._oVariantManagement||!this.getUseVariantManagement()&&!this.getUseChartPersonalisation()||!this.getPersistencyKey()){return}var t=new _({type:"chart",keyName:"persistencyKey",dataSource:this.getEntitySet()});t.setControl(this);var e=this.getSmartVariant();if(e){this._oVariantManagement=this._getVariantManagementControl(e)}else if(this._oSmartFilter&&this._oSmartFilter.data("pageVariantPersistencyKey")){e=this._oSmartFilter.getSmartVariant();if(e){this._oVariantManagement=this._getVariantManagementControl(e)}}else{this._oVariantManagement=new d(this.getId()+"-variant",{showShare:true});if(this._headerText){this._oVariantManagement.setShowAsText(!!this._headerText.getText());this._oVariantManagement.setHeaderLevel(this.getHeaderLevel());this._oVariantManagement.setTitleStyle(this.getHeaderStyle())}}if(this._oVariantManagement){if(!this._oVariantManagement.isPageVariant()){this._oVariantManagement.setVisible(this.getShowVariantManagement())}this._oVariantManagement.addPersonalizableControl(t);this._oVariantManagement.attachSave(this._variantSaved,this);this._oVariantManagement.attachAfterSave(this._variantAfterSave,this);this._oVariantManagement.initialise(this._variantInitialised,this)}};yt.prototype._variantInitialised=function(){if(!this._oCurrentVariant){this._oCurrentVariant="STANDARD"}this.fireAfterVariantInitialise();if(this._oVariantManagement&&!this._oVariantManagement.getEnabled()){this._checkAndTriggerBinding()}};yt.prototype._variantSaved=function(){if(this._oPersController){this._oPersController.setPersonalizationData(this._oCurrentVariant,true)}};yt.prototype._variantAfterSave=function(){this.fireAfterVariantSave({currentVariantId:this.getCurrentVariantId()})};yt.prototype.setUseChartPersonalisation=function(t){this.setProperty("useChartPersonalisation",t,true);this._bUpdateToolbar=true;return this};yt.prototype.setUseTooltip=function(t){this.setProperty("useTooltip",t,true);this._createTooltipOrPopover();return this};yt.prototype._createTooltipOrPopover=function(){if(this.getUseTooltip()&&this.getShowChartTooltip()){this._toggleChartTooltipVisibility(true)}else{this._createPopover()}};yt.prototype._createPopover=function(){if(this._oChart){if(!ct&&!this._bVizPopoverRequested){ct=sap.ui.require("sap/viz/ui5/controls/Popover");if(!ct){sap.ui.require(["sap/viz/ui5/controls/Popover"],vt.bind(this));this._bVizPopoverRequested=true}}if(!this._oPopover&&ct&&!this._oChart._getVizFrame()._connectPopover){this._oPopover=new ct({})}if(this._oPopover){this._oPopover.connect(this._oChart.getVizUid())}}};function vt(t){ct=t;this._bVizPopoverRequested=false;if(!this._bIsBeingDestroyed){this._createPopover()}}yt.prototype._destroyPopover=function(){if(this._oPopover){this._oPopover.destroy();this._oPopover=null}};yt.prototype.setUseVariantManagement=function(t){this.setProperty("useVariantManagement",t,true);if(this._oPersController){this._oPersController.setResetToInitialTableState(!t)}this._bUpdateToolbar=true;return this};yt.prototype.setToolbar=function(t){if(this._oToolbar){this.removeItem(this._oToolbar)}this._oToolbar=t;this._bUpdateToolbar=true;this._oToolbar.setLayoutData(new r({shrinkFactor:0}));this.insertItem(this._oToolbar,0);this._oToolbar.setVisible(this.getShowToolbar());this._oToolbar.setStyle(this.getToolbarStyle());return this};yt.prototype.getToolbar=function(){return this._oToolbar};yt.prototype.setHeader=function(t){this.setProperty("header",t,true);this._refreshHeaderText();return this};yt.prototype.setHeaderLevel=function(t){this.setProperty("headerLevel",t,true);this._refreshHeaderText();return this};yt.prototype.setHeaderStyle=function(t){this.setProperty("headerStyle",t,true);this._refreshHeaderText();return this};yt.prototype._refreshHeaderText=function(){if(!this._headerText){this._bUpdateToolbar=true;return}var t=this.getHeader();this._headerText.setText(t);this._headerText.setVisible(!!t);this._headerText.setLevel(this.getHeaderLevel());this._headerText.setTitleStyle(this.getHeaderStyle());if(this._oVariantManagement&&!this._oVariantManagement.isPageVariant()){this._oVariantManagement.setShowAsText(!!t);this._oVariantManagement.setHeaderLevel(this.getHeaderLevel());this._oVariantManagement.setTitleStyle(this.getHeaderStyle())}this._oSeparator?.setVisible(!!t)};yt.prototype._createToolbar=function(){if(!this._oToolbar){this._oToolbar=new o({design:G.Transparent});this._oToolbar.addStyleClass("sapUiCompSmartChartToolbar");this._oToolbar.addStyleClass("sapMTBHeader-CTX");this._oToolbar.setLayoutData(new r({shrinkFactor:0}));this.insertItem(this._oToolbar,0);this._oToolbar.setVisible(this.getShowToolbar());this._oToolbar.setStyle(this.getToolbarStyle())}};yt.prototype._createToolbarContent=function(){this._addVariantManagementToToolbar();this._addSeparatorToToolbar();this._addHeaderToToolbar();this._addSpacerToToolbar();this._addSemanticNavigationButton();this._addDetailsButton();this._addDrillUpDownButtons();this._addLegendButton();this._addZoomInOutButtons();this._addDownloadButton();this._addPersonalisationToToolbar();this._addFullScreenButton();this._addChartTypeToToolbar();if(this._oToolbar&&(this._oToolbar.getContent().length===0||this._oToolbar.getContent().length===1&&this._oToolbar.getContent()[0]instanceof h)){this.removeItem(this._oToolbar);this._oToolbar.destroy();this._oToolbar=null}};yt.prototype.setShowVariantManagement=function(t){this.setProperty("showVariantManagement",t);if(this._oVariantManagement&&this._oVariantManagement.isPageVariant()){this._oVariantManagement.setVisible(t)}return this};yt.prototype.setShowDetailsButton=function(t){this.setProperty("showDetailsButton",t);if(this._oSelectionDetails){this._oSelectionDetails.setVisible(t);if(this._oDrillDownTextButton){this._oDrillDownTextButton.setVisible(t)}this._setBehaviorTypeForDataSelection()}if(this._oDrillDownButton){this._oDrillDownButton.setVisible(!t)}return this};yt.prototype.setShowChartTypeSelectionButton=function(t){this.setProperty("showChartTypeSelectionButton",t);if(this._oChartTypeButton){this._oChartTypeButton.setVisible(t)}return this};yt.prototype.setShowDownloadButton=function(t){this.setProperty("showDownloadButton",t);if(this._oDownloadButton){this._oDownloadButton.setVisible(t)}return this};yt.prototype.setShowDrillBreadcrumbs=function(t){this.setProperty("showDrillBreadcrumbs",t);if(this._oDrillBreadcrumbs){this._oDrillBreadcrumbs.setVisible(t)}if(this._oDrillUpButton){this._oDrillUpButton.setVisible(!t)}return this};yt.prototype.setShowChartTooltip=function(t){this.setProperty("showChartTooltip",t);this._toggleChartTooltipVisibility(t);return this};yt.prototype._setBehaviorTypeForDataSelection=function(){if(this.getShowDetailsButton()){this._oChart.setVizProperties({interaction:{behaviorType:"noHoverBehavior"}})}else if(this._oChart.getVizProperties().interaction.behaviorType){var t=this._oChart.getVizProperties().interaction;delete t.behaviorType;this._oChart.setVizProperties({interaction:t})}};yt.prototype._addDrillBreadcrumbs=function(){if(!this._oDrillBreadcrumbs&&this.getShowDrillBreadcrumbs()){if((!dt||!_t)&&!this._bBreadcrumbsRequested){dt=sap.ui.require("sap/m/Breadcrumbs");_t=sap.ui.require("sap/m/Link");if(!dt){sap.ui.require(["sap/m/Breadcrumbs","sap/m/Link"],Tt.bind(this));this._bBreadcrumbsRequested=true}}if(this._oChart&&dt&&_t){this._oDrillBreadcrumbs=new dt(this.getId()+"-drillBreadcrumbs",{visible:this.getShowDrillBreadcrumbs()}).addStyleClass("sapUiCompSmartChartBreadcrumbs");this.insertItem(this._oDrillBreadcrumbs,1);this._updateDrillBreadcrumbs();this._oChart.attachDrilledUp(function(t){this._updateDrillBreadcrumbs()}.bind(this));this._oChart.attachDrilledDown(function(t){this._updateDrillBreadcrumbs()}.bind(this))}}};function Tt(t,e){dt=t;_t=e;this._bBreadcrumbsRequested=false;if(!this._bIsBeingDestroyed){this._addDrillBreadcrumbs()}}yt.prototype.getDrillStackFilters=function(){var t=this._oChart.getDrillStack();var e=[];var i=function(t){if(!t){return}if(t&&t.sPath&&t.sOperator){e.push(t)}if(t.aFilters){t.aFilters.forEach(function(t){i(t)})}};t.forEach(function(t){i(t.filter)});return e};yt.prototype._getDrillStackDimensions=function(){var t=this._oChart.getDrillStack();var e=[];t.forEach(function(t){t.dimension.forEach(function(t){if(t!=null&&t!=""&&e.indexOf(t)==-1){e.push(t)}})});return e};yt.prototype._updateDrillBreadcrumbs=function(){if(!this._oDrillBreadcrumbs){return}var t=this._oChart.getDrillStack();var e=[];if(t){t.reverse();t.forEach(function(t,i,a){if(t.dimension.length>0&&typeof this._oChart.getDimensionByName(t.dimension[t.dimension.length-1])!="undefined"){if(this.getShowDrillBreadcrumbs()){this._oDrillBreadcrumbs.setVisible(true)}var r=this._oChart.getDimensionByName(t.dimension[t.dimension.length-1]).getLabel();if(i==0){this._oDrillBreadcrumbs.setCurrentLocationText(r)}else{var o=new _t({text:r,press:function(t){var e=this._oDrillBreadcrumbs.indexOfLink(t.getSource());this._oChart.drillUp(e+1);this._oChart.fireDeselectData(t);this._updateDrillBreadcrumbs()}.bind(this)});e.push(o)}}else{if(i==0){this._oDrillBreadcrumbs.setVisible(false)}}}.bind(this))}var i=this._oDrillBreadcrumbs.getLinks();e.reverse();var a=false;if(i.length!==e.length){a=true}else{for(var r=0;r<e.length;r++){if(e[r].getText()!=i[r].getText()){a=true;break}}}if(a){if(this._oDrillBreadcrumbs.getLinks()){this._oDrillBreadcrumbs.removeAllLinks()}for(var r=0;r<e.length;r++){this._oDrillBreadcrumbs.addLink(e[r])}}};yt.prototype._addDetailsButton=function(){this._oSelectionDetails=new D(this.getId()+"-selectionDetails",{visible:this.getShowDetailsButton(),customData:[new U({key:"sap-ui-custom-settings",value:{"sap.ui.dt":{designtime:"sap/ui/comp/designtime/smartchart/SmartChartDetails.designtime"}}})]});this._oSelectionDetails.registerSelectionDetailsItemFactory([],function(t,e,i,a){var r=[];var o=function(e){var e=t[s].value;if(e){return e instanceof Object?e:e.toString()}else{return e}};for(var s=0;s<t.length;s++){r.push(new P({label:t[s].label,value:o(t[s].value),unit:t[s].unit}))}return new B({enableNav:function(){if(this._determineSemanticObjectsforDetailsPopover(e,i).length>0){return true}else{return false}}.bind(this)(),lines:r}).setBindingContext(i)}.bind(this));this._oSelectionDetails.attachNavigate(function(t){if(t.getParameter("direction")==="back"){t.getParameter("content").destroy()}else{this._navigateToSemanticObjectDetails(t)}}.bind(this));this._oSelectionDetails.attachActionPress(function(t){var e=[];t.getParameter("items").forEach(function(t){e.push(t.getBindingContext())});this.fireSelectionDetailsActionPress({id:t.getParameter("id"),action:t.getParameter("action"),itemContexts:e,level:t.getParameter("level")})}.bind(this));this._oSelectionDetails.attachBeforeOpen(function(t){var e=this._oSelectionDetails.getItems();e.forEach(function(t){var e=this._getDetailsActionsClones();e.selectionDetailsItemActions.forEach(function(e){t.addAction(e)})}.bind(this));var i=this._getDetailsActionsClones().selectionDetailsActions;this._oSelectionDetails.removeAllActions();i.forEach(function(t){this._oSelectionDetails.addAction(t)}.bind(this));var a=this._getDetailsActionsClones().selectionDetailsActionGroups;this._oSelectionDetails.removeAllActionGroups();a.forEach(function(t){this._oSelectionDetails.addActionGroup(t)}.bind(this))}.bind(this));this._oSelectionDetails.attachBeforeClose(function(t){if(this._oNavigationContainer){this._oNavigationContainer.destroy()}}.bind(this));this._oToolbar.addContent(this._oSelectionDetails);this._addDrillDownTextButton()};yt.prototype._getDetailsActionsClones=function(){var t={selectionDetailsItemActions:[],selectionDetailsActions:[],selectionDetailsActionGroups:[]};this.getSelectionDetailsItemActions().forEach(function(e){t.selectionDetailsItemActions.push(e.clone())});this.getSelectionDetailsActions().forEach(function(e){t.selectionDetailsActions.push(e.clone())});this.getSelectionDetailsActionGroups().forEach(function(e){t.selectionDetailsActionGroups.push(e.clone())});return t};yt.prototype._addDownloadButton=function(){if(!this._oDownloadButton){this._oDownloadButton=new s(this.getId()+"btnDownload",{type:"Transparent",text:this._oRb.getText("CHART_DOWNLOADBTN_TEXT"),tooltip:this._oRb.getText("CHART_DOWNLOADBTN_TOOLTIP"),icon:"sap-icon://download",visible:this.getShowDownloadButton(),enabled:false,press:function(t){if(window.navigator&&window.navigator.msSaveOrOpenBlob){var e=new window.Blob([this._getVizFrame().exportToSVGString()],{type:"image/svg+xml"});window.navigator.msSaveOrOpenBlob(e)}else{this._downloadChartPNG()}}.bind(this)});this._oToolbar.addContent(this._oDownloadButton)}};yt.prototype._downloadChartSVG=function(){var t=this.getHeader();var e=document.createElement("a");e.setAttribute("href","data:image/svg+xml,"+encodeURIComponent(this._getVizFrame().exportToSVGString()));e.setAttribute("download",t?t:"Chart"+".svg");e.click()};yt.prototype._downloadChartPNG=function(){var t=this.getHeader();var e=this._getVizFrame().exportToSVGString();var i=document.createElement("canvas");var a=i.getContext("2d");var r=new Image;r.width=i.width=document.getElementById(this._oChart.getId()).offsetWidth;r.height=i.height=document.getElementById(this._oChart.getId()).offsetHeight;r.onload=function(){a.drawImage(r,0,0);var e=document.createElement("a");e.setAttribute("href",i.toDataURL());e.setAttribute("download",t?t:"Chart"+".png");e.click()};r.setAttribute("crossOrigin","anonymous");r.src="data:image/svg+xml,"+encodeURIComponent(e)};yt.prototype._addFullScreenButton=function(){var t;if(this.getShowFullScreenButton()){t=new s(this.getId()+"-btnFullScreen",{type:"Transparent",press:function(){this._toggleFullScreen(!this.bFullScreen)}.bind(this),enabled:false});this.oFullScreenButton=t;this._renderFullScreenButton();this._oToolbar.addContent(t)}};yt.prototype._addZoomInOutButtons=function(){var t=this;this._oZoomInButton=new s(this.getId()+"-btnZoomIn",{type:"Transparent",text:this._oRb.getText("CHART_ZOOMINBTN_TEXT"),tooltip:this._oRb.getText("CHART_ZOOMINBTN_TOOLTIP"),icon:"sap-icon://zoom-in",press:function(){if(t._oChart){t._oChart.zoom({direction:"in"});this._oZoomInPressed=true;this._toggleZoomButtonEnablement()}}.bind(this),visible:this.getShowZoomButtons(),enabled:false});this._oZoomOutButton=new s(this.getId()+"-btnZoomOut",{type:"Transparent",text:this._oRb.getText("CHART_ZOOMOUTBTN_TEXT"),tooltip:this._oRb.getText("CHART_ZOOMOUTBTN_TOOLTIP"),icon:"sap-icon://zoom-out",press:function(){if(t._oChart){t._oChart.zoom({direction:"out"});this._oZoomOutPressed=true;this._toggleZoomButtonEnablement()}}.bind(this),visible:this.getShowZoomButtons(),enabled:false});this._oToolbar.addContent(this._oZoomInButton);this._oToolbar.addContent(this._oZoomOutButton)};yt.prototype._toggleZoomButtonEnablement=function(){var t=this._oChart.getZoomInfo().currentZoomLevel;if(t===undefined){return}else if(t===null){this._oZoomOutButton.setEnabled(false);this._oZoomInButton.setEnabled(false)}else if(t===0){if(this._oZoomInPressed){this._oZoomInButton.focus();this._oZoomInPressed=false}this._oZoomOutButton.setEnabled(false);this._oZoomInButton.setEnabled(true)}else if(t===1){if(this._oZoomOutPressed){this._oZoomOutButton.focus();this._oZoomOutPressed=false}this._oZoomInButton.setEnabled(false);this._oZoomOutButton.setEnabled(true)}else{if(this._oZoomOutButton.getEnabled()==false){this._oZoomOutButton.setEnabled(true)}if(this._oZoomInButton.getEnabled()==false){this._oZoomInButton.setEnabled(true)}}};yt.prototype.setShowZoomButtons=function(t){this.setProperty("showZoomButtons",t);if(this._oZoomInButton){this._oZoomInButton.setVisible(t)}if(this._oZoomOutButton){this._oZoomOutButton.setVisible(t)}return this};yt.prototype.setShowFullScreenButton=function(t){this.setProperty("showFullScreenButton",t);if(this.oFullScreenButton){this.oFullScreenButton.setVisible(t)}return this};yt.prototype.setLegendVisible=function(t){this.setProperty("legendVisible",t);this._setLegendVisible(t);return this};yt.prototype._setLegendVisible=function(t){var e=this._getVizFrame();if(e){e.setLegendVisible(t)}};yt.prototype._getVizFrame=function(){var t=null;if(this._oChart){t=this._oChart.getAggregation("_vizFrame")}return t};yt.prototype._addLegendButton=function(){var t=this;this._oLegendButton=new n(this.getId()+"-btnLegend",{type:"Transparent",text:this._oRb.getText("CHART_LEGENDBTN_TEXT"),tooltip:this._oRb.getText("CHART_LEGENDBTN_TOOLTIP"),icon:"sap-icon://legend",press:function(){t.setLegendVisible(!t.getLegendVisible());this.setPressed(t.getLegendVisible())},pressed:this.getLegendVisible(),visible:this.getShowLegendButton(),enabled:false});this._oToolbar.addContent(this._oLegendButton)};yt.prototype.setShowLegendButton=function(t){this.setProperty("showLegendButton",t);if(this._oLegendButton){this._oLegendButton.setVisible(t)}return this};yt.prototype.setShowSemanticNavigationButton=function(t){this.setProperty("showSemanticNavigationButton",t);if(this._oSemanticalNavButton){this._oSemanticalNavButton.setVisible(t)}else{if(t){this._addSemanticNavigationButton()}}return this};yt.prototype._addSemanticNavigationButton=function(){var t=this;if(!this._oSemanticalNavButton&&this.getShowSemanticNavigationButton()&&this._oToolbar){this._oSemanticalNavButton=new i(this.getId()+"-btnNavigation",{type:"Transparent",text:this._oRb.getText("CHART_SEMNAVBTN"),tooltip:this._oRb.getText("CHART_SEMNAVBTN_TOOLTIP"),visible:this.getShowSemanticNavigationButton(),enabled:false});this._oNavHandler=new M({control:this._oSemanticalNavButton,navigationTargetsObtained:function(t){var e=t.getParameters().mainNavigation;if(e){var i=t.getSource().getBindingContext().getObject();var a=this._getField(t.getSource().getFieldName());var r=w.getTextsFromDisplayBehaviour(a.displayBehaviour,i[a.name],i[a.description]);e.setDescription(r.secondText);t.getParameters().show(r.firstText,e,undefined,undefined)}t.getParameters().show()}.bind(this)});var e=this.getSemanticObjectController();if(e){this._oNavHandler.setSemanticObjectController(e)}this._oSemanticalNavButton.attachPress(function(e){if(this._aSemanticObjects&&this._aSemanticObjects.length>0){if(this._aSemanticObjects.length===1){var i=T.getSemanticObjectsFromProperty(this._aSemanticObjects[0]);if(i){this._oNavHandler.setFieldName(this._aSemanticObjects[0].name);this._oNavHandler.setSemanticObject(i.defaultSemanticObject);this._oNavHandler.setAdditionalSemanticObjects(i.additionalSemanticObjects);this._oNavHandler.openPopover()}}else{t._semanticObjectList(this._aSemanticObjects,this._oNavHandler)}}}.bind(this));if(this._oChart){this._attachDataPointHandling()}else{this.attachInitialized(function(){this._attachDataPointHandling()}.bind(this))}var a=this._indexOfSpacerOnToolbar();this._oToolbar.insertContent(this._oSemanticalNavButton,a+1)}};yt.prototype._attachDataPointHandling=function(){if(this._oChart){this._oChart.attachDeselectData(function(){this._aSemanticObjects=this._setSelectionDataPointHandling(this._oNavHandler)}.bind(this));this._oChart.attachSelectData(function(){this._aSemanticObjects=this._setSelectionDataPointHandling(this._oNavHandler)}.bind(this))}};yt.prototype.setSelectionMode=function(t){this.setProperty("selectionMode",t);if(this._oChart){this._oChart.setSelectionMode(t)}return this};yt.prototype._setSelectionDataPointHandling=function(t){var e=this._setSelectionDataPoint(t);if(e&&e.length>0){this._oSemanticalNavButton.setEnabled(true)}else{this._oSemanticalNavButton.setEnabled(false)}return e};yt.prototype._setSemanticObjectsContext=function(t){var e,i,a=null;e=t.getParameter("item").getBindingContext();if(e){i=e.getObject();if(i){a=this._determineSemanticObjectsforDetailsPopover(i,e)}}return a};yt.prototype._setSelectionDataPoint=function(t){var e,i,a=null,r;var o=this._oChart.getSelectedDataPoints();if(!o||!o.dataPoints||o.dataPoints.length===0){return a}if(o.dataPoints.length===1){e=o.dataPoints[0].context;if(e){i=e.getObject();if(i){a=this._determineSemanticObjects(i,e);if(a&&a.length>0){t.setBindingContext(e)}}}return a}r=[];for(var s=0;s<o.dataPoints.length;s++){e=o.dataPoints[s].context;if(e){i=e.getObject();if(i){r.push(i)}}}if(r&&r.length>0){a=this._condensBasedOnSameValue(r);if(a&&a.length>0){t.setBindingContext(o.dataPoints[o.dataPoints.length-1].context)}}return a};yt.prototype._condensBasedOnSameValue=function(t){var e=null,i,a,r;e=this._determineSemanticObjects(t[0]);if(e&&e.length>0){for(var o=0;o<e.length;o++){a=e[o];r=a.name;if(this._bAllValuesAreEqual(t,r)){if(!i){i=[]}i.push(a)}}e=i}return e};yt.prototype._bAllValuesAreEqual=function(t,e){var i,a;for(var r=0;r<t.length;r++){i=t[r];if(r===0){a=i[e];continue}if(a!=i[e]){return false}}return true};yt.prototype._semanticObjectList=function(t,e){var i,a,r,o;if(this._oChart){if((!ft||!mt||!gt)&&!this._bSemanticObjectListRequested){ft=sap.ui.require("sap/m/ResponsivePopover");mt=sap.ui.require("sap/m/List");gt=sap.ui.require("sap/m/StandardListItem");if(!ft||!mt||!gt){sap.ui.require(["sap/m/ResponsivePopover","sap/m/List","sap/m/StandardListItem"],St.bind(this));this._bSemanticObjectListRequested=true;this._oSemanticObjectListAttr={object:t,nav:e}}}if(!ft||!mt||!gt){return}a=new mt({mode:W.SingleSelectMaster,selectionChange:function(t){if(t&&t.mParameters&&t.mParameters.listItem){var a=t.mParameters.listItem.data("semObj");if(a){e.setFieldName(t.mParameters.listItem.data("fieldName"));e.setSemanticObject(a.defaultSemanticObject);e.setAdditionalSemanticObjects(a.additionalSemanticObjects);e.openPopover()}}i.close()}});for(var s=0;s<t.length;s++){o=t[s];r=new gt({title:o.fieldLabel,type:X.Active});r.data("semObj",T.getSemanticObjectsFromProperty(o));r.data("fieldName",o.name);a.addItem(r)}i=new ft({title:this._oRb.getText("CHART_SEMNAVBTN"),showHeader:false,contentWidth:"12rem",placement:$.Left});i.addContent(a);i.openBy(this._oSemanticalNavButton)}};function St(t,e,i){ft=t;mt=e;gt=i;this._bSemanticObjectListRequested=false;if(!this._bIsBeingDestroyed){this._semanticObjectList(this._oSemanticObjectListAttr.object,this._oSemanticObjectListAttr.nav)}delete this._oSemanticObjectListAttr}yt.prototype._semanticObjectListForDetails=function(t,e){var i,a,r;if(!this._oChart){return undefined}i=new mt({mode:W.SingleSelectMaster,rememberSelections:false,itemPress:function(t){if(t&&t.mParameters&&t.mParameters.listItem){var i=t.mParameters.listItem.data("semObj");if(i){var a=new M({fieldName:t.mParameters.listItem.data("fieldName"),control:t.mParameters.listItem,semanticObject:i.defaultSemanticObject,additionalSemanticObjects:i.additionalSemanticObjects,navigationTargetsObtained:function(t){var i=t.getParameters().mainNavigation;if(i){var a=e.getObject();var r=this._getField(t.getSource().getFieldName());var o=w.getTextsFromDisplayBehaviour(r.displayBehaviour,a[r.name],a[r.description]);i.setDescription(o.secondText);t.getParameters().show(o.firstText,i,undefined,undefined)}t.getParameters().show()}.bind(this)});a._getNavigationContainer().then(function(t){this._oNavigationContainer=t;var e=t.getDirectLink();if(e){a._fireInnerNavigate({text:e.getText(),href:e.getHref()});window.location.href=e.getHref();t.destroy();return}t.attachBeforePopoverOpen(function(){this._oSelectionDetails.setPopoverModal(true)}.bind(this));t.attachAfterPopoverClose(function(){this._oSelectionDetails.setPopoverModal(false)}.bind(this));this._oSelectionDetails.navTo("",t)}.bind(this),function(t){N.error("NavigationContainer could not be determined: "+t)})}}}.bind(this)});x.getDistinctSemanticObjects().then(function(o){for(var s=0;s<t.length;s++){r=t[s];if(r["com.sap.vocabularies.Common.v1.SemanticObject"]&&r["com.sap.vocabularies.Common.v1.SemanticObject"].String&&x.hasDistinctSemanticObject([r["com.sap.vocabularies.Common.v1.SemanticObject"].String],o)){a=new gt({title:r.fieldLabel,type:X.Navigation});a.setBindingContext(e);a.data("semObj",T.getSemanticObjectsFromProperty(r));a.data("fieldName",r.name);i.addItem(a)}}});return i};yt.prototype._determineSemanticObjects=function(t,e){var i,a,r=[];if(t){for(i in t){if(i){a=this._getField(i);if(a&&a.isDimension&&a.isSemanticObject){r.push(a)}}}}if(r){r.sort(function(t,e){return t.fieldLabel.localeCompare(e.fieldLabel)})}return r};yt.prototype._determineSemanticObjectsforDetailsPopover=function(t,e){var i,a,r=[];if(t){for(i in t){if(i){a=this._getField(i);if(a&&a.isDimension&&a.isSemanticObject){r.push(a)}}}}if(r){r.sort(function(t,e){return t.fieldLabel.localeCompare(e.fieldLabel)})}return r};yt.prototype._addDrillUpDownButtons=function(){if(this.getShowDrillButtons()){var t=this;this._oDrillUpButton=new s(this.getId()+"-btnDrillUp",{type:"Transparent",tooltip:this._oRb.getText("CHART_DRILLUPBTN_TOOLTIP"),text:this._oRb.getText("CHART_DRILLUPBTN_TEXT"),icon:"sap-icon://drill-up",press:function(){if(t._oChart){t._oChart.drillUp()}},visible:!this.getShowDrillBreadcrumbs(),enabled:false});this._oDrillDownButton=new s(this.getId()+"-btnDrillDown",{type:"Transparent",text:this._oRb.getText("CHART_DRILLDOWNBTN_TEXT"),icon:"sap-icon://drill-down",layoutData:new O({closeOverflowOnInteraction:false}),press:function(t){if(this._oDrilldownPopover&&this._oDrilldownPopover.isOpen()){this._oDrilldownPopover.close()}else{this._drillDown(t)}}.bind(this),visible:!this.getShowDetailsButton(),enabled:false,ariaHasPopup:tt.ListBox});this._oToolbar.addContent(this._oDrillUpButton);this._oToolbar.addContent(this._oDrillDownButton)}};yt.prototype._addDrillDownTextButton=function(){this._oDrillDownTextButton=new i(this.getId()+"-btnDrillDownText",{type:"Transparent",text:this._oRb.getText("CHART_DRILLDOWNBTN_TEXT"),tooltip:this._oRb.getText("CHART_DRILLDOWNBTN_TOOLTIP"),enabled:false,visible:this.getShowDetailsButton(),layoutData:new O({closeOverflowOnInteraction:false}),press:function(t){this._drillDown(t)}.bind(this),ariaHasPopup:tt.ListBox});this._oToolbar.addContent(this._oDrillDownTextButton)};yt.prototype.setShowDrillButtons=function(t){this.setProperty("showDrillButtons",t);if(this._oDrillUpButton){this._oDrillUpButton.setVisible(t)}if(this._oDrillDownButton){this._oDrillDownButton.setVisible(t)}return this};yt.prototype._triggerSearchInPopover=function(t,e){if(!t||!e){return}var i=t.getParameter("newValue");var a=[];if(i){a=new g("text","Contains",i)}e.getBinding("items").filter(a)};yt.prototype._drillDown=function(t,e){var i,a,r,o,s,n,l,h;if(this._oChart){if((!ft||!mt||!bt||!gt)&&!this._bDrillDownRequested){ft=sap.ui.require("sap/m/ResponsivePopover");mt=sap.ui.require("sap/m/List");bt=sap.ui.require("sap/m/SearchField");gt=sap.ui.require("sap/m/StandardListItem");if(!ft||!mt||!bt||!gt){sap.ui.require(["sap/m/ResponsivePopover","sap/m/List","sap/m/SearchField","sap/m/StandardListItem"],Dt.bind(this));this._bDrillDownRequested=true;this._oDrillDownSource=t.getSource()}}if(!ft||!mt||!bt||!gt){return}var u=t?t.getSource():e;if(!this._oDrilldownPopover){var c=new gt({title:"{$smartChartDrilldown>text}"});s=new mt({mode:W.SingleSelectMaster,items:{path:"$smartChartDrilldown>/items",template:c},selectionChange:function(t){if(t&&t.mParameters&&t.mParameters.listItem){var e=t.mParameters.listItem.getTitle();var a=this._getSortedDimensions();var r=a.filter(function(t){return t.getLabel()===e});var o=r.length===1?r[0]:null;if(o){this._oChart.drillDown(o)}}i.close()}.bind(this)});n=new bt({placeholder:this._oRb.getText("CHART_DRILLDOWN_SEARCH"),liveChange:function(t){this._triggerSearchInPopover(t,s)}.bind(this)});i=new ft({id:this.getId()+"-btnChartDrilldownPopover",contentWidth:"25rem",contentHeight:"20rem",placement:$.VerticalPreferredBottom});i.addStyleClass("sapUiCompSmartChartDrillDownPopover");if(y.system.phone){i.addContent(n)}else{i.setSubHeader(n)}i.addContent(s);if(y.system.desktop){var p=new I({text:this._oRb.getText("CHART_DRILLDOWN_TITLE")});i.setShowHeader(false);i.addContent(p);i.addAriaLabelledBy(p);if(i.getSubHeader()&&i.getSubHeader().getVisible()&&n.getVisible()&&n.getEnabled()){var d=new I({text:this._oRb.getText("CHART_DRILLDOWN_SEARCH_AVAILABLE")});i.addContent(d);i.addAriaLabelledBy(d)}}else{i.setTitle(this._oRb.getText("CHART_DRILLDOWN_TITLE"))}this._oDrilldownPopover=i}else{i=this._oDrilldownPopover;n=i.getSubHeader()||i.getContent()[0]}a=this._getDrillStackDimensions();r=this._getSortedDimensions();var _={items:[]};for(l=0;l<r.length;l++){o=r[l];if(a.indexOf(o.getName())>-1){continue}h=this._oChartProvider.getViewField(o.getName());if(!h.filterable&&this._oChart.getSelectedDataPoints().count>0){continue}_.items.push({text:o.getLabel()})}i.setModel(new f(_),"$smartChartDrilldown");n.setValue("");n.setVisible(_.items.length>=7);i.openBy(u)}};function Dt(t,e,i,a){ft=t;mt=e;bt=i;gt=a;this._bDrillDownRequested=false;if(!this._bIsBeingDestroyed){this._drillDown(null,this._oDrillDownSource)}delete this._oDrillDownSource}yt.prototype._navigateToSemanticObjectDetails=function(t){var e=this._setSemanticObjectsContext(t);if(e&&e.length>0){if(e.length===1){var i=T.getSemanticObjectsFromProperty(e[0]);if(i){var a=t.getParameter("item");var r=new M({fieldName:e[0].name,control:a,semanticObject:i.defaultSemanticObject,additionalSemanticObjects:i.additionalSemanticObjects,navigationTargetsObtained:function(t){var e=t.getParameters().mainNavigation;if(e){var i=a.getBindingContext().getObject();var r=this._getField(t.getSource().getFieldName());var o=w.getTextsFromDisplayBehaviour(r.displayBehaviour,i[r.name],i[r.description]);e.setDescription(o.secondText);t.getParameters().show(o.firstText,e,undefined,undefined)}t.getParameters().show()}.bind(this)});r._getNavigationContainer().then(function(t){this._oNavigationContainer=t;this._oNavigationContainer.attachBeforePopoverOpen(function(){this._oSelectionDetails.setPopoverModal(true)}.bind(this));this._oNavigationContainer.attachAfterPopoverClose(function(){this._oSelectionDetails.setPopoverModal(false)}.bind(this));this._oSelectionDetails.navTo("",this._oNavigationContainer)}.bind(this),function(t){N.error("NavigationContainer could not be determined")})}}else{var o=t.getParameter("item").getBindingContext();if((!mt||!gt)&&!this._bObjectListRequested){mt=sap.ui.require("sap/m/List");gt=sap.ui.require("sap/m/StandardListItem");if(!mt||!gt){sap.ui.require(["sap/m/List","sap/m/StandardListItem"],Bt.bind(this));this._bObjectListRequested=true;this._oObjectListAttr={context:o,objects:e}}}if(mt&&gt){var s=this._semanticObjectListForDetails(e,o);this._oSelectionDetails.navTo(this._oRb.getText("CHART_SEMNAVBTN"),s)}}}};function Bt(t,e){mt=t;gt=e;this._bObjectListRequested=false;if(!this._bIsBeingDestroyed){var i=this._semanticObjectListForDetails(this._oObjectListAttr.objects,this._oObjectListAttr.context);this._oSelectionDetails.navTo(this._oRb.getText("CHART_SEMNAVBTN"),i)}delete this._oObjectListAttr}yt.prototype._addHeaderToToolbar=function(){if(this._oToolbar){if(!this._headerText){this._headerText=new V({})}this._refreshHeaderText();this._oToolbar.insertContent(this._headerText,0)}};yt.prototype._addSeparatorToToolbar=function(){if(this.getUseVariantManagement()&&this._oVariantManagement&&!this._oVariantManagement.isPageVariant()){this._oSeparator=new l;this._oToolbar.insertContent(this._oSeparator,0);if(!this._oToolbar.getHeight()){this._oToolbar.setHeight("auto")}}else if(this._oSeparator){this._oToolbar.removeContent(this._oSeparator)}};yt.prototype._addVariantManagementToToolbar=function(){if(this._oVariantManagement&&!this._oVariantManagement.isPageVariant()){if(this.getUseVariantManagement()){this._oToolbar.insertContent(this._oVariantManagement,0)}else if(this._oVariantManagement){this._oToolbar.removeContent(this._oVariantManagement)}}};yt.prototype._addSpacerToToolbar=function(){if(this._indexOfSpacerOnToolbar()===-1){this._oToolbar.addContent(new h)}};yt.prototype._indexOfSpacerOnToolbar=function(){var t=this._oToolbar.getContent(),e,i;if(t){i=t.length;e=0;for(e;e<i;e++){if(t[e]instanceof h){return e}}}return-1};yt.prototype._getP13NSettings=function(){return{dimeasure:{visible:true,payload:{availableChartTypes:this.getAvailableChartTypes()}},sort:{visible:true},filter:{visible:true},contentWidth:"48rem"}};yt.prototype._addPersonalisationToToolbar=function(){if(this.getUseChartPersonalisation()){if(!this._oChartPersonalisationButton){this._oChartPersonalisationButton=new s(this.getId()+"-btnPersonalisation",{type:"Transparent",icon:"sap-icon://action-settings",text:this._oRb.getText("CHART_PERSOBTN_TEXT"),tooltip:this._oRb.getText("CHART_PERSOBTN_TOOLTIP"),press:function(t){if(this._oPersController){this._oPersController.openDialog(this._getP13NSettings())}}.bind(this),enabled:false});Z.addConfig(this._oChartPersonalisationButton,{addAccessibilityLabel:true,messageBundleKey:y.os.macintosh?"SMARTTABLE_SHORTCUT_SHOW_SETTINGS_MAC":"SMARTTABLE_SHORTCUT_SHOW_SETTINGS"},this)}this._oToolbar.addContent(this._oChartPersonalisationButton)}else if(this._oChartPersonalisationButton){this._oToolbar.removeContent(this._oChartPersonalisationButton)}};yt.prototype.onkeydown=function(t){if(t.isMarked()){return}if((t.metaKey||t.ctrlKey)&&t.which===K.COMMA){var e=this._oChartPersonalisationButton;if(e&&e.getVisible()&&e.getEnabled()){e.firePress();t.setMarked();t.preventDefault()}}};yt.prototype.getVariantManagement=function(){return this._oVariantManagement};yt.prototype.openDialogForKeyUser=function(t,e){this._fGetDataForKeyUser=e;var i=this._getP13NSettings();i.styleClass=t;i.showReset=false;this._oPersController.openDialog(i)};yt.prototype._cleanUpKeyUser=function(){this._fGetDataForKeyUser=null};yt.prototype._createKeyUserChange=function(){return[{selectorControl:this._oVariantManagement._getPersoController(),changeSpecificData:{changeType:"variantContent",content:{key:this._oVariantManagement.getSelectionKey(),persistencyKey:this.getPersistencyKey(),content:this.fetchVariant()}}}]};yt.prototype._addChartTypeToToolbar=function(){this._oChartTypeButton=this._createChartTypeButton();this._oToolbar.addContent(this._oChartTypeButton)};yt.prototype._createChartTypeButton=function(){var t=new s(this.getId()+"-btnChartType",{visible:this.getShowChartTypeSelectionButton(),enabled:false,type:"Transparent",text:this._oRb.getText("CHART_TYPEBTN_TEXT"),ariaHasPopup:tt.ListBox,layoutData:new O({closeOverflowOnInteraction:false}),press:function(t){if(this._oChartTypePopover&&this._oChartTypePopover.isOpen()){this._oChartTypePopover.close()}else{this._displayChartTypes(t)}}.bind(this)});return t};yt.prototype._displayChartTypes=function(t,e){var i,a,r;if(this._oChart&&(t||e)){if((!ft||!mt||!bt||!gt)&&!this._bChartTypesRequested){ft=sap.ui.require("sap/m/ResponsivePopover");mt=sap.ui.require("sap/m/List");bt=sap.ui.require("sap/m/SearchField");gt=sap.ui.require("sap/m/StandardListItem");if(!ft||!mt||!bt||!gt){sap.ui.require(["sap/m/ResponsivePopover","sap/m/List","sap/m/SearchField","sap/m/StandardListItem"],Pt.bind(this));this._bChartTypesRequested=true;this._oChartTypesSource=t.getSource()}}if(!ft||!mt||!bt||!gt){return}var o=t?t.getSource():e;if(!this._oChartTypePopover){var s=new gt({title:"{$smartChartTypes>text}",icon:"{$smartChartTypes>icon}",selected:"{$smartChartTypes>selected}"});a=new mt({mode:W.SingleSelectMaster,items:{path:"$smartChartTypes>/items",template:s},selectionChange:function(t){if(t&&t.mParameters&&t.mParameters.listItem){var e=t.mParameters.listItem.getBinding("title");if(e){var a=e.getContext();if(a){var r=a.getObject();if(r&&r.key){this._setChartType(r.key);this._enrichPassedButton(this._oChartTypeButton,this._oChart.getChartType())}}}}this._rerenderControlInFullscreen();i.close()}.bind(this)});r=new bt({placeholder:this._oRb.getText("CHART_TYPE_SEARCH"),liveChange:function(t){this._triggerSearchInPopover(t,a)}.bind(this)});i=new ft({id:this.getId()+"-btnChartTypePopover",contentWidth:"25rem",contentHeight:"20rem",placement:$.VerticalPreferredBottom});i.addStyleClass("sapUiCompSmartChartTypePopover");if(y.system.phone){i.addContent(r)}else{i.setSubHeader(r)}i.addContent(a);if(y.system.desktop){var n=new I({text:this._oRb.getText("CHART_TYPELIST_TEXT")});i.setShowHeader(false);i.addContent(n);i.addAriaLabelledBy(n);if(i.getSubHeader()&&i.getSubHeader().getVisible()&&r.getVisible()&&r.getEnabled()){var l=new I({text:this._oRb.getText("CHART_DRILLDOWN_SEARCH_AVAILABLE")});i.addContent(l);i.addAriaLabelledBy(l)}}else{i.setTitle(this._oRb.getText("CHART_TYPELIST_TEXT"))}this._oChartTypePopover=i}else{i=this._oChartTypePopover;r=i.getSubHeader()||i.getContent()[0]}i.setModel(this.getModel("$smartChartTypes"),"$smartChartTypes");if(r.getValue()!==""){r.setValue("");a=i.getContent()[0];a.getBinding("items").filter([])}r.setVisible(i.getModel("$smartChartTypes").oData.items.length>=7);i.openBy(o)}};function Pt(t,e,i,a){ft=t;mt=e;bt=i;gt=a;this._bChartTypesRequested=false;if(!this._bIsBeingDestroyed){this._displayChartTypes(null,this._oChartTypesSource)}delete this._oChartTypesSource}var Vt={bar:"sap-icon://horizontal-bar-chart",bullet:"sap-icon://horizontal-bullet-chart",bubble:"sap-icon://bubble-chart",column:"sap-icon://vertical-bar-chart",combination:"sap-icon://business-objects-experience",dual_bar:"sap-icon://horizontal-bar-chart",dual_column:"sap-icon://vertical-bar-chart",dual_combination:"sap-icon://business-objects-experience",dual_horizontal_combination:"sap-icon://business-objects-experience",dual_horizontal_stacked_combination:"sap-icon://business-objects-experience",dual_line:"sap-icon://line-chart",dual_stacked_bar:"sap-icon://full-stacked-chart",dual_stacked_column:"sap-icon://vertical-stacked-chart",dual_stacked_combination:"sap-icon://business-objects-experience",donut:"sap-icon://donut-chart",heatmap:"sap-icon://heatmap-chart",horizontal_stacked_combination:"sap-icon://business-objects-experience",line:"sap-icon://line-chart",pie:"sap-icon://pie-chart",scatter:"sap-icon://scatter-chart",stacked_bar:"sap-icon://full-stacked-chart",stacked_column:"sap-icon://vertical-stacked-chart",stacked_combination:"sap-icon://business-objects-experience",treemap:"sap-icon://Chart-Tree-Map",vertical_bullet:"sap-icon://vertical-bullet-chart","100_dual_stacked_bar":"sap-icon://full-stacked-chart","100_dual_stacked_column":"sap-icon://vertical-stacked-chart","100_stacked_bar":"sap-icon://full-stacked-chart","100_stacked_column":"sap-icon://full-stacked-column-chart",waterfall:"sap-icon://vertical-waterfall-chart",horizontal_waterfall:"sap-icon://horizontal-waterfall-chart"};yt.prototype._rerenderControlInFullscreen=function(){if(this.bFullScreen){this._oChart.setLayoutData(new r({baseSize:"100%"}));this.invalidate(this._oChart)}};yt.prototype._getMatchingIcon=function(t){var e=Vt[t];if(!e){e=""}return e};yt.prototype._enrichPassedButton=function(t,e,i){if(!t){return}if(i===undefined){i=e;var a=this._retrieveChartTypeDescription(e);if(a&&a.text){i=a.text}}t.data("chartType",e);var r=this._getMatchingIcon(e);t.setIcon(r?r:"sap-icon://vertical-bar-chart");var o=this._oChart.getChartType()===e?"CHART_TYPE_TOOLTIP":"CHART_TYPE_UNSEL_TOOLTIP";t.setTooltip(this._oRb.getText(o,[i]))};yt.prototype._updateAvailableChartType=function(){var t=this,e,i,a=[];e=this.getModel("$smartChartTypes");if(!e){return}i={items:a};var r=this._oChart.getChartType();this.getAvailableChartTypes().forEach(function(e){var i={key:e.key,text:e.text,icon:t._getMatchingIcon(e.key),selected:r===e.key};a.push(i)});e.setData(i);if(this._oSegmentedButton){this._updateVisibilityOfChartTypes(this._oSegmentedButton)}this._updateVizTooltipFormatter()};yt.prototype._createPersonalizationController=function(){if(this._oPersController){return}var t=this.data("p13nDialogSettings");if(typeof t==="string"){try{t=JSON.parse(t)}catch(e){t=null}}t=this._setIgnoreFromPersonalisationToSettings(t);t=t||{};var e=F.createChartWrapper(this._oChart,this._oChart.data("p13nData"),this._aColumnKeysOrdered);if(this.$()&&this.$().closest(".sapUiSizeCompact").length>0){this._oChart.addStyleClass("sapUiSizeCompact")}var i=this._oChart.setVisibleMeasures;var a=function(t,e){this.setProperty("visibleMeasures",t,e);var i=this._drillStateStack||[];if(!this._bIsInitialized){this._createDrillStack()}else{i.forEach(function(t){t.measures=this.getProperty("visibleMeasures")}.bind(this))}if(!e){this._invalidateBy({source:this,keys:{binding:true,dataSet:true,vizFrame:true}})}return this}.bind(this._oChart);this._oPersController=new L(this.getId()+"-persoController",{table:e,setting:t,resetToInitialTableState:!this.getUseVariantManagement(),afterP13nModelDataChange:this._personalisationModelDataChange.bind(this),beforePotentialTableChange:function(t){this._oChart.setVisibleMeasures=a}.bind(this),afterPotentialTableChange:function(t){this._oChart.setVisibleMeasures=i}.bind(this)});this._oPersController.attachDialogConfirmedReset(function(){if(this._oDrillBreadcrumbs){this._updateDrillBreadcrumbs()}var t=sap.ui.getCore().byId(this.getId()+"-btnChartType");if(t){this._enrichPassedButton(t,this._oChart.getChartType())}}.bind(this));this._oPersController.attachDialogAfterClose(function(t){if(this._fGetDataForKeyUser){if(t.getParameter("cancel")){this._fGetDataForKeyUser([])}this._cleanUpKeyUser()}}.bind(this))};yt.prototype._setIgnoreFromPersonalisationToSettings=function(t){var e=C.createArrayFromString(this.getIgnoreFromPersonalisation());if(e.length){if(!t){t={}}var i=function(i){if(!t[i]){t[i]={}}t[i].ignoreColumnKeys=e};i("dimeasure");i("filter");i("sort")}return t};yt.prototype._personalisationModelDataChange=function(t){this._oCurrentVariant=t.getParameter("persistentData");if(this._fGetDataForKeyUser){this._fGetDataForKeyUser(this._createKeyUserChange())}var e=t.getParameter("runtimeDeltaDataChangeType");var i=this._getChangeStatus(e);if(i===J.Unchanged){return}this._fireChartDataChanged(e);if(!this._bApplyingVariant){if(!this.getUseVariantManagement()){this._persistPersonalisation()}else if(this._oVariantManagement){this._oVariantManagement.currentVariantSetModified(true)}}this._updateAvailableChartType();this._enrichPassedButton(this._oChartTypeButton,this._oChart.getChartType());this._checkDimensionColoring();if(!this._bDisableTimeseriesUTC&&!this._oChart.getVizProperties().general.showAsUTC){try{if(!this._oChart.getVizProperties().general.showAsUTC){this._oChart.setVizProperties({general:{showAsUTC:true}})}if(this._bWorkaroundVizFormatter){this._oChart.setVizProperties({timeAxis:{levelConfig:{day:{visible:true,formatString:"MediumDay"},month:{visible:true,formatString:"MediumMonth"}}}})}}catch(t){N.error("Couldn't set showAsUTC=true")}}if(i===J.TableChanged){if(this._oSemanticalNavButton){this._oSemanticalNavButton.setEnabled(false)}}else if(i===J.ModelChanged&&this._bIsChartBound){if(this._oSmartFilter){this._oSmartFilter.search()}else{this._reBindChart()}}if(this._oDrillBreadcrumbs){this._updateDrillBreadcrumbs()}this.fireUiStateChange()};yt.prototype._fireChartDataChanged=function(t){var e={dimeasure:false,filter:false,sort:false};for(var i in t){if(t[i]!=="Unchanged"){e[i]=true}}this.fireChartDataChanged({changeTypes:e})};yt.prototype._getChangeStatus=function(t){if(!t){return J.ModelChanged}if(t.sort===J.ModelChanged||t.filter===J.ModelChanged||t.dimeasure===J.ModelChanged||t.group===J.ModelChanged){return J.ModelChanged}if(t.sort===J.TableChanged||t.filter===J.TableChanged||t.dimeasure===J.TableChanged||t.group===J.TableChanged){return J.TableChanged}return J.Unchanged};yt.prototype.setEntitySet=function(t){this.setProperty("entitySet",t);this._initialiseMetadata();return this};yt.prototype.propagateProperties=function(){u.prototype.propagateProperties.apply(this,arguments);this._initialiseMetadata()};yt.prototype._initialiseMetadata=function(){if(!this._bMetadataIsInitialised){v.handleModelInit(this,this._onMetadataInitialised,true)}};yt.prototype._onMetadataInitialised=function(){this._bMetaModelLoadAttached=false;if(!this._bMetadataIsInitialised){this._listenToSmartFilter();this._createToolbar();this._createVariantManagementControl();this._createToolbarContent();this._bMetadataIsInitialised=true;if(Ct){this._initialiseInnerChart()}if(R.getActive()){R.end("SmartChartInit")}if(!this._oVariantManagement||this._oVariantManagement&&this._bVariantInitialised){this._checkAndTriggerBinding()}}};yt.prototype._checkAndTriggerBinding=function(){if(!this._bAutoBindingTriggered){this._bAutoBindingTriggered=true;if(this.getEnableAutoBinding()){if(this._oSmartFilter){this._oSmartFilter.search()}else{this._reBindChart()}}else if(!this._oChart){this._createTempNoData()}}};yt.prototype._createTempNoData=function(){var t=new a({text:this.getNoData()});this._oNoDataStruct=new u({items:[t],justifyContent:"Center",alignItems:"Center",height:"100%"});this.insertItem(this._oNoDataStruct,2)};yt.prototype._createChartProvider=function(){var t,e;e=this.getEntitySet();t=this.getModel();if(t&&!this._bChartCreated){this._aAlwaysSelect=[];this._aInitialSorters=[];this._addDrillBreadcrumbs();this._bChartCreated=true}if(t&&e){this._oChartProvider=new c({entitySet:e,ignoredFields:this.getIgnoredFields(),dateFormatSettings:this.data("dateFormatSettings"),defaultDropDownDisplayBehaviour:this.data("defaultDimensionDisplayBehaviour"),skipAnnotationParse:this.data("skipAnnotationParse"),chartQualifier:this.data("chartQualifier"),presentationVariantQualifier:this.data("presentationVariantQualifier"),model:t,chartLibrary:it,useTimeSeries:this.getActivateTimeSeries(),notAssignedText:this.getNotAssignedText()})}};yt.prototype._listenToSmartFilter=function(){this._fetchSmartFilter();if(this._oSmartFilter){this._oSmartFilter.attachSearch(this._reBindChart,this);this._oSmartFilter.attachFilterChange(this._filterChangeEvent,this)}};yt.prototype.setNoData=function(t){if(this._oChart){this._oChart.setCustomMessages({NO_DATA:t})}this.setProperty("noData",t);return this};yt.prototype.getNoData=function(){var t=this.getProperty("noData");if(!this.getProperty("noData")){if(!this._oChart){this._fetchSmartFilter();if(this._oSmartFilter){t=this._oRb.getText("CHART_NO_DATA")}else{t=this._oRb.getText("CHART_NO_DATA_WITHOUT_FILTERBAR")}}else{t=this._oRb.getText("CHART_NO_RESULTS")}}return t};yt.prototype._fetchSmartFilter=function(){var t=null;t=this.getSmartFilterId();this._oSmartFilter=this._findControl(t)};yt.prototype._filterChangeEvent=function(){if(this._bIsChartBound&&this._oSmartFilter&&!this._oSmartFilter.getLiveMode()&&!this._oSmartFilter.isDialogOpen()){this._showOverlay(true)}};yt.prototype._adjustOverlayHeight=function(){if(y.browser.safari||y.browser.chrome){var t=this._oChart.$(),e=t.find(".sapUiCompSmartChartOverlay");if(e.length===1){e.height(t.height())}}};yt.prototype._renderOverlay=function(t){if(this._oChart){var e=this._oChart.$(),i=e.find(".sapUiCompSmartChartOverlay");if(t&&i.length===0){i=jQuery("<div>").addClass("sapUiOverlay sapUiCompSmartChartOverlay").css("z-index","1");e.append(i);this._adjustOverlayHeight();this.sOverlayResizeListenerId=j.register(e,this._adjustOverlayHeight.bind(this))}else if(!t){i.remove();j.deregister(this.sOverlayResizeListenerId)}}};yt.prototype.showOverlay=function(t){this._showOverlay(t)};yt.prototype._showOverlay=function(t){if(t){var e={show:true};this.fireShowOverlay({overlay:e});t=e.show}this._hasOverlay=t;this._renderOverlay(t)};yt.prototype._findControl=function(t){var e,i;if(t){e=sap.ui.getCore().byId(t);if(!e){i=this._getView();if(i){e=i.byId(t)}}}return e};yt.prototype._getView=function(){if(!this._oView){var t=this.getParent();while(t){if(t.isA("sap.ui.core.mvc.View")){this._oView=t;break}t=t.getParent()}}return this._oView};yt.prototype._updateInResultDimensions=function(){var t=this._getInResultDimensionTotal();var e=function(t){var e=this._oChart.getInResultDimensions();if(e.length!=t.length){return false}for(var i=0,a=e.length;i<a;i++){if(e[i]!=t[i]){return false}}return true}.bind(this);if(t.length>0&&!e(t)){this._oChart.setInResultDimensions(t)}};yt.prototype._initialiseInnerChart=function(){this._createChart();this._createChartProvider();if(this._oChartProvider){this._oChartViewMetadata=this._oChartProvider.getChartViewMetadata();if(this._oChartViewMetadata){this._assignData();this._createContent();this._createPersonalizationController();this._oChart.attachRenderComplete(this._toggleZoomButtonEnablement,this);this._oSelectionDetails.attachSelectionHandler("_selectionDetails",this._oChart);this._enrichPassedButton(this._oChartTypeButton,this._oChart.getChartType());this._enableToolbarButtons();this._checkDimensionColoring();this._updateDrillBreadcrumbs();this.bIsInitialised=true;this.fireInitialise();this.fireInitialized();this.applyVariant(this.fetchVariant())}}};yt.prototype._enableToolbarButtons=function(){if(this._oDrillUpButton&&this._oDrillDownButton){this._oDrillUpButton.setEnabled(true);this._oDrillDownButton.setEnabled(true)}if(this._oDrillDownTextButton){this._oDrillDownTextButton.setEnabled(true)}if(this._oLegendButton){this._oLegendButton.setEnabled(true)}if(this._oZoomInButton&&this._oZoomOutButton){this._oZoomInButton.setEnabled(true);this._oZoomOutButton.setEnabled(true)}if(this._oDownloadButton){this._oDownloadButton.setEnabled(true)}if(this._oChartPersonalisationButton){this._oChartPersonalisationButton.setEnabled(true)}if(this.oFullScreenButton){this.oFullScreenButton.setEnabled(true)}if(this._oChartTypeButton){this._oChartTypeButton.setEnabled(true)}};function wt(t,e,i,a,r,o,s,n,l,h){it=t;at=e;rt=i;st=a;nt=r;lt=o;ht=s;ut=n;pt=l;ot=h;this._bChartRequested=false;if(!this._bIsBeingDestroyed){this._reBindChart()}}yt.prototype.rebindChart=function(){if(!this._bMetadataIsInitialised){N.error("rebindChart method called before the metadata is initialized. Please execute the UI5 Support Assistant 'SmartChart' rules to get more information",this.getId(),"sap.ui.comp.smartChart")}this._reBindChart()};yt.prototype._reBindChart=function(){var t,e,i=[],a,r,o,s={},n={preventChartBind:false};if(!this._oChart){if((!it||!at||!st||!nt||!lt||!ht||!pt)&&!this._bChartRequested){it=sap.ui.require("sap/chart/library");at=sap.ui.require("sap/chart/Chart");rt=sap.ui.require("sap/chart/ColoringType");st=sap.ui.require("sap/chart/data/Dimension");nt=sap.ui.require("sap/chart/data/HierarchyDimension");lt=sap.ui.require("sap/chart/data/TimeDimension");ht=sap.ui.require("sap/chart/data/Measure");ut=sap.ui.require("sap/chart/data/MeasureSemantics");pt=sap.ui.require("sap/viz/ui5/controls/VizTooltip");ot=sap.ui.require("sap/viz/ui5/format/ChartFormatter");if(!it||!at||!st||!nt||!lt||!ht||!pt){sap.ui.getCore().loadLibrary("sap.chart",{async:true}).then(function(){sap.ui.require(["sap/chart/library","sap/chart/Chart","sap/chart/ColoringType","sap/chart/data/Dimension","sap/chart/data/HierarchyDimension","sap/chart/data/TimeDimension","sap/chart/data/Measure","sap/chart/data/MeasureSemantics","sap/viz/ui5/controls/VizTooltip","sap/viz/ui5/format/ChartFormatter"],wt.bind(this));this._bChartRequested=true}.bind(this))}}if(!it||!at||!st||!nt||!lt||!ht||!pt){return}this._initialiseInnerChart()}t=this._getChartPersonalisationData()||{};a=t.filters;r=t.excludeFilters;o=t.sorters;if(this._oSmartFilter){e=this._oSmartFilter.getFilters();s=this._oSmartFilter.getParameters()||{}}if(e&&e.length){if(r){i=[new g([e[0],r],true)]}else{i=e}}else if(r){i=[r]}if(a){a=i.concat(a)}else{a=i}this._updateInResultDimensions();s["entitySet"]=this.getEntitySet();if(!o){o=[]}n.filters=a;n.sorter=o;n.parameters=s;n.events={};this.fireBeforeRebindChart({bindingParams:n});if(!n.preventChartBind&&this._oChartViewMetadata){o=n.sorter;a=n.filters;s=n.parameters;this._oChart.setBusy(true);this._bDataLoadPending=true;yt._addBindingListener(n,"change",this._onDataLoadComplete.bind(this));yt._addBindingListener(n,"dataReceived",this._onDataReceived.bind(this));var l={path:this.getChartBindingPath()||"/"+this.getEntitySet(),parameters:s,filters:a,events:n.events};if(!this._bIsChartBound){l.sorter=o}if(n.length){l.length=n.length}else{var h=this._oChartProvider.getMaxItems();if(h>0){l.length=h}}this._oChart.bindData(l);if(this._bIsChartBound){this._oChart.getBinding("data").sort(o)}this._showOverlay(false);this._bIsChartBound=true}};yt.prototype._validateSorters=function(t){var e=[];var i=this._oChart.getVisibleDimensions().concat(this._oChart.getVisibleMeasures());if(t){t.forEach(function(t){i.forEach(function(i){if(t.sPath===i){e.push(t)}})})}return e};yt.prototype._onDataReceived=function(t){if(t&&t.getParameter&&t.getParameter("__simulateAsyncAnalyticalBinding")){return}this._onDataLoadComplete(t,true);try{this.fireDataReceived(t)}catch(t){}};yt._addBindingListener=function(t,e,i){if(!t.events){t.events={}}if(!t.events[e]){t.events[e]=i}else{var a=t.events[e];t.events[e]=function(){i.apply(this,arguments);a.apply(this,arguments)}}};yt.prototype._onDataLoadComplete=function(t,e){if(this._oSemanticalNavButton){this._oSemanticalNavButton.setEnabled(false)}if(this._bDataLoadPending||e){this._bDataLoadPending=false;this._updateAvailableChartType();this._oChart.setBusy(false)}};yt.prototype._assignData=function(){if(this._oChartViewMetadata&&this._oChart){this._oChart.resetLayout();if(this._oChartViewMetadata.measureFields&&this._oChartViewMetadata.measureFields.length>0){this._oChart.setVisibleMeasures(this._oChartViewMetadata.measureFields)}if(this._oChartViewMetadata.dimensionFields&&this._oChartViewMetadata.dimensionFields.length>0){this._oChart.setVisibleDimensions(this._oChartViewMetadata.dimensionFields)}if(!this.getChartType()&&this._oChartViewMetadata.chartType){this._setChartType(this._oChartViewMetadata.chartType)}}};yt.prototype._createP13nObject=function(t){if(t.sortable&&t.sorted){var e={columnKey:t.name,operation:t.sortOrder};if(t.sortIndex!=null){this._aInitialSorters.splice(t.sortIndex,0,e)}else{this._aInitialSorters.push(e)}}return{columnKey:t.name,leadingProperty:t.name,additionalProperty:t.additionalProperty,sortProperty:t.sortable?t.name:undefined,filterProperty:t.filterable?t.name:undefined,fullName:t.hasValueListAnnotation?t.fullName:null,type:t.filterType,typeInstance:t.modelType,maxLength:t.maxLength,precision:t.precision,scale:t.scale,isMeasure:t.isMeasure,isDimension:t.isDimension,isHierarchyDimension:t.isHierarchyDimension,hierarchyLevel:t.hierarchyLevel,aggregationRole:t.aggregationRole,label:t.label,tooltip:t.quickInfo,sorted:t.sorted,sortOrder:t.sortOrder,criticality:t.valueCriticality}};yt.prototype._createContent=function(){var t,e=0,i,a,r,o=[],s;var n=[];this._aColumnKeysOrdered=[];Object.assign(this._aColumnKeysOrdered,this._oChartViewMetadata.dimensionFields);this._aColumnKeysOrdered=this._aColumnKeysOrdered.concat(this._oChartViewMetadata.measureFields);e=this._oChartViewMetadata.fields.length;var l=this._oChartViewMetadata.dimensionFields||[];var h=this._oChartViewMetadata.measureFields||[];for(t=0;t<e;t++){a=null;i=this._oChartViewMetadata.fields[t];i.label=i.fieldLabel||i.name;if(this._aColumnKeysOrdered.indexOf(i.name)===-1){this._aColumnKeysOrdered.push(i.name)}if(this._oChart.getDimensionByName(i.name)===undefined&&this._oChart.getMeasureByName(i.name)===undefined){s=this._createP13nObject(i);r={name:i.name,label:i.label,tooltip:i.quickInfo}}if(i.inResult){this._aAlwaysSelect.push(i.name)}if(i.isDimension||i.isHierarchyDimension||l.indexOf(i.name)!=-1){if(this._oChart.getDimensionByName(i.name)===undefined){if(i.isDimension){if(i.isTimeDimension&&this.getActivateTimeSeries()){a=new lt(r);var u=i.timeUnitType;if(E.hasOwnProperty(i.timeUnitType)){a.setTimeUnit(E[u])}if(!this._bDisableTimeseriesUTC){try{a._setIsUTC(true)}catch(t){N.error("Couldn't set UTC settings on TimeDimension")}}}else{a=new st(r)}}else{r.level=i.hierarchyLevel;a=new nt(r)}this._oChart.addDimension(a);if(i.description&&(!i.isTimeDimension||!this.getActivateTimeSeries())){a.setTextProperty(i.description);a.setTextFormatter(w.getFormatterFunctionFromDisplayBehaviour(i.displayBehaviour,false,this))}else if(i.dateFormatter&&(!i.isTimeDimension||!this.getActivateTimeSeries())){if(i.timezone){a.setTextProperty(i.timezone)}a.setTextFormatter(i.dateFormatter)}else if(i.isDimension&&(!i.isTimeDimension||!this.getActivateTimeSeries())){a.setTextFormatter(function(t,e){if(t===""){return this.getNotAssignedText()}else{return t}}.bind(this))}}else{var c=this._oChart.getDimensionByName(i.name).data("p13nData");if(c){this._oChart.getDimensionByName(i.name).data("p13nData",typeof c==="string"?JSON.parse(c):c)}}}else if(i.isMeasure||h.indexOf(i.name)!=-1){if(this._oChart.getMeasureByName(i.name)===undefined){a=new ht(r);this._oChart.addMeasure(a);if(i.dataPoint){n.push({dataPoint:i.dataPoint,measure:a})}if(i.unit){a.setUnitBinding(i.unit)}}else{var c=this._oChart.getMeasureByName(i.name).data("p13nData");if(c){this._oChart.getMeasureByName(i.name).data("p13nData",typeof c==="string"?JSON.parse(c):c)}}}else if(i.sortable||i.filterable){o.push(s)}if(a){if(i.role){a.setRole(i.role)}a.data("p13nData",s)}}if(this._oChart){this._oChart.data("p13nData",o)}if(n.length>0){this._enrichFromDataPoints(n)}};yt.prototype._getField=function(t){var e,i,a;if(t&&this._oChartViewMetadata&&this._oChartViewMetadata.fields){a=this._oChartViewMetadata.fields.length;for(i=0;i<a;i++){e=this._oChartViewMetadata.fields[i];if(e.name===t){return e}}}return null};yt.prototype.attachInitialise=function(t,e,i){this.attachEvent("initialise",t,e,i);Ct=true;sap.ui.getCore().loadLibrary("sap.chart");it=sap.ui.requireSync("sap/chart/library");at=sap.ui.requireSync("sap/chart/Chart");rt=sap.ui.requireSync("sap/chart/ColoringType");st=sap.ui.requireSync("sap/chart/data/Dimension");nt=sap.ui.requireSync("sap/chart/data/HierarchyDimension");lt=sap.ui.requireSync("sap/chart/data/TimeDimension");ht=sap.ui.requireSync("sap/chart/data/Measure");ut=sap.ui.requireSync("sap/chart/data/MeasureSemantics");pt=sap.ui.requireSync("sap/viz/ui5/controls/VizTooltip");ot=sap.ui.requireSync("sap/viz/ui5/format/ChartFormatter");if(this._bMetadataIsInitialised){this._initialiseInnerChart()}N.error("The event 'initialise' is deprecated, please use 'initialized' instead");return this};yt.prototype._createChart=function(){if(this._oNoDataStruct){this._oNoDataStruct.destroy()}var t=this.getItems(),e=t?t.length:0,i,a=this;var o;this._bDisableTimeseriesUTC=true;while(e--){i=t[e];if(i instanceof at){break}i=null}if(i){this._oChart=i;try{o=this.data("dateFormatSettings")?JSON.parse(this.data("dateFormatSettings")):{};if(o.hasOwnProperty("UTC")){this._bDisableTimeseriesUTC=!o["UTC"]}if(o.hasOwnProperty("style")&&o["style"].toLowerCase()=="medium"){this._bWorkaroundVizFormatter=true}}catch(t){}}else{var s={uiConfig:{applicationSet:"fiori"},busyIndicatorDelay:0,vizProperties:{title:{text:""},plotArea:{dataLabel:{hideWhenOverlap:false}},general:{groupData:false},valueAxis:{title:{visible:a.getShowMeasuresTitle()}},categoryAxis:{title:{visible:a.getShowDimensionsTitle()},layout:{autoHeight:true,autoWidth:true}}},selectionMode:this.getSelectionMode(),width:"100%"};try{o=this.data("dateFormatSettings")?JSON.parse(this.data("dateFormatSettings")):{};if(o.hasOwnProperty("UTC")){s.vizProperties.general.showAsUTC=!!o["UTC"];this._bDisableTimeseriesUTC=!o["UTC"];if(o.hasOwnProperty("style")&&o["style"].toLowerCase()=="medium"){s.timeAxis={levelConfig:{day:{visible:true,formatString:"MediumDay"},month:{visible:true,formatString:"MediumMonth"}}};this._bWorkaroundVizFormatter=true}}}catch(t){}this._oChart=new at(s);if(this.getHeight()){this._oChart.setHeight("100%")}this._toggleChartTooltipVisibility(this.getShowChartTooltip());this._setBehaviorTypeForDataSelection();this.insertItem(this._oChart,2)}if(y.browser.safari||y.browser.chrome||y.browser.firefox){this.addStyleClass("sapUiCompSmartChartInnerChartHeight")}this.setLegendVisible(this.getLegendVisible());if(!this._oChart.getLayoutData()){var n={growFactor:1};var l=this.getLayoutData();if(l&&l.getBaseSize){n.baseSize=l.getBaseSize()}else{n.baseSize="100%"}this._oChart.setLayoutData(new r(n))}if(this.getChartType()){this._setChartType(this.getChartType())}this._oChart.attachRenderComplete(function(){if(this._hasOverlay){setTimeout(function(){this._showOverlay(true)}.bind(this),0)}this._oChart.getLayoutData().setGrowFactor(1)}.bind(this));this._oChart.setCustomMessages({NO_DATA:this.getNoData()});this._createTooltipOrPopover()};yt.prototype._toggleChartTooltipVisibility=function(t){if(this._oChart){if(t){if(!this._vizTooltip){this._vizTooltip=new pt}this._vizTooltip.connect(this._oChart.getVizUid())}else{if(this._vizTooltip){this._vizTooltip.destroy()}}}};yt.prototype._updateVizTooltipFormatter=function(){if(this._vizTooltip){if(this._oChart.getChartType().match(/100/)!==null){this._vizTooltip.setFormatString(ot.DefaultPattern.STANDARDPERCENT_MFD2)}else{this._vizTooltip.setFormatString(ot.DefaultPattern.STANDARDFLOAT)}}};yt.prototype.getChart=function(){if(!this._oChart&&this._bMetadataIsInitialised){sap.ui.getCore().loadLibrary("sap.chart");it=sap.ui.requireSync("sap/chart/library");at=sap.ui.requireSync("sap/chart/Chart");rt=sap.ui.requireSync("sap/chart/ColoringType");st=sap.ui.requireSync("sap/chart/data/Dimension");nt=sap.ui.requireSync("sap/chart/data/HierarchyDimension");lt=sap.ui.requireSync("sap/chart/data/TimeDimension");ht=sap.ui.requireSync("sap/chart/data/Measure");ut=sap.ui.requireSync("sap/chart/data/MeasureSemantics");pt=sap.ui.requireSync("sap/viz/ui5/controls/VizTooltip");ot=sap.ui.requireSync("sap/viz/ui5/format/ChartFormatter");this._initialiseInnerChart()}else if(!this._bMetadataIsInitialised){N.error("Accesing the inner chart before the metadata is initialized will not work. Instead, wait for the initialized event!")}N.error("This function is deprecated, please use getChartAsync instead");return this._oChart};yt.prototype.getChartAsync=function(){if(!this._oChart&&this._bMetadataIsInitialised){return new Promise(function(t,e){sap.ui.require(["sap/chart/library","sap/chart/Chart","sap/chart/ColoringType","sap/chart/data/Dimension","sap/chart/data/HierarchyDimension","sap/chart/data/TimeDimension","sap/chart/data/Measure","sap/chart/data/MeasureSemantics","sap/viz/ui5/controls/VizTooltip","sap/viz/ui5/format/ChartFormatter"],function(i,a,r,o,s,n,l,h,u,c){it=i;at=a;rt=r;st=o;nt=s;lt=n;ht=l;ut=h;pt=u;ot=c;if(!this._oChart){this._initialiseInnerChart()}if(this._oChart){t(this._oChart)}else{e("The inner chart couldn't be created")}}.bind(this))}.bind(this))}else if(!this._bMetadataIsInitialised){N.error("Accessing the inner chart before the metadata is initialized will not work. Instead, wait for the initialized event!");return Promise.reject(new Error("Accessing the inner chart before the metadata is initialized will not work. Instead, wait for the initialized event!"))}else{return Promise.resolve(this._oChart)}};yt.prototype._getChartTypes=function(){var t;try{t=it.api.getChartTypes()}catch(e){t={};N.error("sap.chart.api.getChartTypes throws an exception.\n"+e.toString())}return t};yt.prototype.getAvailableChartTypes=function(){var t,e,i=[],a,r={},o,s;if(this._oChart){o=this.getIgnoredChartTypes();if(this.getActivateTimeSeries()){o=o.concat(this._oChartProvider.getIgnoredChartTypesForTimeSeries())}s=C.createArrayFromString(o);r=this._getChartTypes();a=this._oChart.getAvailableChartTypes().available;if(a){for(t=0;t<a.length;t++){e=a[t].chart;if(s.indexOf(e)<0){i.push({key:e,text:r[e]})}}}}return i};yt.prototype._retrieveChartTypeDescription=function(t){var e=this._getChartTypes();return{key:t,text:e[t]}};yt.prototype._setChartType=function(t){if(this._oChart){var e=this._oChart.getHeight();this._oChart.setChartType(t);this._aDetailsEntries=[];this._toggleMeasureUnitBinding(t,this._oChart.getMeasures());this._oChart.setHeight(e)}};yt.prototype._toggleMeasureUnitBinding=function(t,e){if(typeof e!="undefined"&&e instanceof Array){if(t.substring(0,4)==="100_"){e.forEach(function(t){t.setUnitBinding()})}else{if(this._oChartProvider){var i=this._oChartProvider._aODataFieldMetadata;e.forEach(function(t){for(var e=i.length-1;e>=0;e--){if(i[e].name==t.getName()){if(i[e]["Org.OData.Measures.V1.ISOCurrency"]&&i[e]["Org.OData.Measures.V1.ISOCurrency"].Path){t.setUnitBinding(i[e]["Org.OData.Measures.V1.ISOCurrency"].Path)}else if(i[e]["Org.OData.Measures.V1.Unit"]&&i[e]["Org.OData.Measures.V1.Unit"].Path){t.setUnitBinding(i[e]["Org.OData.Measures.V1.Unit"].Path)}break}}})}}}};yt.prototype._getDimensions=function(){var t=[];if(this._oChart){t=this._oChart.getDimensions()}return t};yt.prototype._getVisibleDimensions=function(){var t=[];if(this._oChart){t=this._oChart.getVisibleDimensions()}return t};yt.prototype._getMeasures=function(){var t=[];if(this._oChart){t=this._oChart.getMeasures()}return t};yt.prototype._getVisibleMeasures=function(){var t=[];if(this._oChart){t=this._oChart.getVisibleMeasures()}return t};yt.prototype._getSortedDimensions=function(){var t=[];if(this._oChart){t=this._oChart.getDimensions();if(t){t.sort(function(t,e){if(t.getLabel()&&e.getLabel()){return t.getLabel().localeCompare(e.getLabel())}})}}return t};yt.prototype.fetchVariant=function(){if(this._oCurrentVariant==="STANDARD"||this._oCurrentVariant===null){return{}}var t=this._processDateFiltersForVariant(this._oCurrentVariant);return t};yt.prototype.applyVariant=function(t,e){this._oCurrentVariant=t;if(this._oCurrentVariant==="STANDARD"){this._oCurrentVariant=null}this._bApplyingVariant=true;if(this._oPersController){if(this._oCurrentVariant===null||jQuery.isEmptyObject(this._oCurrentVariant)){this._oPersController.resetPersonalization(Q.ResetFull)}else{this._oPersController.setPersonalizationData(this._oCurrentVariant,true)}}this._bApplyingVariant=false;this.fireAfterVariantApply({currentVariantId:this.getCurrentVariantId(),variantContext:e})};yt.prototype._processDateFiltersForVariant=function(t){if(!this._oPersController){return t}var i=C.getColumnKeysOfType("date",this._oPersController._oColumnHelper.getColumnMap()),a=C.getColumnKeysOfType("time",this._oPersController._oColumnHelper.getColumnMap());if(i.length===0||!(t&&t.filter&&t.filter.filterItems)){return t}var r=t.filter.filterItems.map(function(t){if(i.concat(a).includes(t.columnKey)&&this._oChartProvider&&this._oChartProvider.getIsUTCDateHandlingEnabled()){t=Object.assign({},t);if(t.value1 instanceof Date){t.value1=e.localToUtc(t.value1).toISOString();t.value1=t.value1.slice(0,-1)}if(t.value2 instanceof Date){t.value2=e.localToUtc(t.value2).toISOString();t.value2=t.value2.slice(0,-1)}}return t},this);t=Object.assign({},t,{filter:Object.assign({},t.filter,{filterItems:r})});return t};yt.prototype.variantsInitialized=function(){this._bVariantInitialised=true;this._checkAndTriggerBinding()};yt.prototype.getUiState=function(){if(!this.isInitialised()){N.error("SmartChart: Called getUiState() before inner structure was initialized. This will force a synchronous load of dependencies.");this.getChart()}var t=this._oPersController?this._oPersController.getDataSuiteFormatSnapshot():null;return new S({presentationVariant:{ContextUrl:"",MaxItems:this._oChartProvider?this._oChartProvider.getMaxItems():undefined,SortOrder:t?t.SortOrder:[],GroupBy:t?t.GroupBy:[],Total:t?t.Total:[],RequestAtLeast:this._getInResultDimensionTotal(),Visualizations:t?t.Visualizations:[]},selectionVariant:{SelectOptions:t?t.SelectOptions:[]},variantName:this.getCurrentVariantId()})};yt.prototype.setUiState=function(t){if(this._oPersController){var e=this._oVariantManagement&&t.getVariantName()?this._oVariantManagement.getVariantContent(this,t.getVariantName()):{};this._oPersController.setDataSuiteFormatSnapshot(H({},t.getPresentationVariant(),t.getSelectionVariant()),e,true)}this._setInResultDimensionFromVariant(t)};yt.prototype.setUiStateAsVariant=function(t,e){if(this._oPersController){this._oPersController.setPersonalizationDataAsDataSuiteFormat(H({},t.getPresentationVariant(),t.getSelectionVariant()),true)}this._setInResultDimensionFromVariant(t);if(this._oVariantManagement){this.fireAfterVariantApply({currentVariantId:this.getCurrentVariantId(),variantContext:e})}};yt.prototype._setInResultDimensionFromVariant=function(t){if(t.getPresentationVariant()&&this._oChart){this._oChart.setInResultDimensions(t.getPresentationVariant().RequestAtLeast)}else{this._oUiStateRequestAtLeast=t.getPresentationVariant().RequestAtLeast}};yt.prototype.setRequestAtLeastFields=function(t){this.setProperty("requestAtLeastFields",t);if(this._oChart){this._updateInResultDimensions()}return this};yt.prototype._getInResultDimensionTotal=function(){var t=[];if(this.getRequestAtLeastFields()){t=this.getRequestAtLeastFields().split(",")}t=t.concat(this._aAlwaysSelect);if(this._oChart){t=t.concat(this._oChart.getInResultDimensions())}if(this._oUiStateRequestAtLeast){t.concat(this._oUiStateRequestAtLeast);this._oUiStateRequestAtLeast=null}return t.filter(function(t,e,i){return e==i.indexOf(t)})};yt.prototype._getFieldTooltip=function(t){var e=this._getFieldByKey(t);if(e){return e.quickInfo}return""};yt.prototype._getFieldByKey=function(t){var e,i=null;if(this._oChartViewMetadata&&this._oChartViewMetadata.fields){for(e=0;e<this._oChartViewMetadata.fields.length;e++){i=this._oChartViewMetadata.fields[e];if(t===i.name){return i}}return null}};yt.prototype._getByKey=function(t,e){var i,a,r,o;if(t){a=t.length;for(i=0;i<a;i++){r=t[i];o=r.data("p13nData");if(o&&o.columnKey===e){return r}}}return null};yt.prototype._getDimensionByKey=function(t){if(this._oChart){return this._getByKey(this._oChart.getDimensions(),t)}return null};yt.prototype._getMeasureByKey=function(t){if(this._oChart){return this._getByKey(this._oChart.getMeasures(),t)}return null};yt.prototype._getChartObjByKey=function(t){var e=this._getDimensionByKey(t);if(!e){e=this._getMeasureByKey(t)}return e};yt.prototype._getPathFromColumnKeyAndProperty=function(t,e){var i=null,a,r;a=this._getChartObjByKey(t);if(a){r=a.data("p13nData");if(r){i=r[e]}}return i};yt.prototype._getChartPersonalisationData=function(){if(!this._oCurrentVariant){return null}var t=[],i=[],a=[],r,o,s;if(this._oCurrentVariant.sort){o=this._oCurrentVariant.sort.sortItems}else{o=this._aInitialSorters}if(o){o.forEach(function(e){var i=e.operation==="Descending";s=e.columnKey;t.push(new m(s,i))},this)}if(this._oCurrentVariant.filter){this._oCurrentVariant.filter.filterItems.forEach(function(t){var r=t.value1,o=t.value2;s=t.columnKey;var n;if(this._oChartViewMetadata&&this._oChartViewMetadata.fields){n=this._oChartViewMetadata.fields.find(function(t){return t.name===s})}if(n&&n.filterType&&n.filterType==="time"){if(r instanceof Date){r=w.getEdmTimeFromDate(r)}if(o instanceof Date){o=w.getEdmTimeFromDate(o)}}else{var l=n&&n.filterType==="datetime";if(!l&&r instanceof Date&&this._oChartProvider&&this._oChartProvider.getIsUTCDateHandlingEnabled()){r=e.localToUtc(r);o=o?e.localToUtc(o):o}}if(t.exclude){if(t.operation==="Empty"){a.push(new g(s,"NE",""));if(n&&n.isNullable){a.push(new g(s,"NE",null))}}else{a.push(new g(s,q.getTransformedExcludeOperation(t.operation),t.operation==="Empty"?"":r,o))}}else if(t.operation==="Empty"){i.push(new g(s,"EQ",""));if(n&&n.isNullable){i.push(new g(s,"EQ",null))}}else{i.push(new g(s,t.operation,r,o))}},this);if(a.length){r=new g(a,true)}}return{filters:i,excludeFilters:r,sorters:t}};yt.prototype._persistPersonalisation=function(){var t="Personalisation";if(!sap.ui.getCore().getConfiguration().getDesignMode()&&this._oVariantManagement&&!this._oVariantManagement.isPageVariant()){var e=this._oVariantManagement.getViewIdByName(t);if(e===null){e=this.getCurrentVariantId()}if(!this._bSaving){this._bSaving=true;this._oVariantManagement.fireSave({name:t,implicit:true,global:false,overwrite:!!e,key:e,def:true});delete this._bSaving}}};yt.prototype.getCurrentVariantId=function(){var t="";if(this._oVariantManagement){t=this._oVariantManagement.getCurrentVariantId()}return t};yt.prototype.setCurrentVariantId=function(t){if(this._oVariantManagement&&!this._oVariantManagement.isPageVariant()){this._oVariantManagement.setCurrentVariantId(t)}else{N.error("sap.ui.comp.smartchart.SmartChart.prototype.setCurrentVariantId: VariantManagement does not exist or is a page variant")}return this};yt.prototype._adjustHeight=function(){if(this._oChart){var t=0,e=0;var i=this.getDomRef()?this.getDomRef().offsetHeight:0;if(i===0){return}if(this._oToolbar&&this._oToolbar.getDomRef()){t=this._oToolbar.getDomRef().offsetHeight}if(this._oDrillBreadcrumbs&&this._oDrillBreadcrumbs.getDomRef()){var a=this._oDrillBreadcrumbs.getDomRef().parentNode?this._oDrillBreadcrumbs.getDomRef().parentNode:this._oDrillBreadcrumbs.getDomRef();e=a.offsetHeight}var r=i-t-e;this._oChart.setHeight(r+"px");this._updateDrillBreadcrumbs();if(this._hasOverlay){setTimeout(function(){this._showOverlay(true)}.bind(this),0)}}};yt.prototype._toggleFullScreen=function(t,e){if(!this.oFullScreenButton||t===this.bFullScreen&&!e){return}if(t==true&&this._oChart){this._sChartHeight=this._oChart.getHeight();this._oChart.setHeight("100%")}this.bFullScreen=t;z.toggleFullScreen(this,this.bFullScreen,this.oFullScreenButton,this._toggleFullScreen,"sapContrastPlus",true);if(!t){this._adjustHeight()}this._renderFullScreenButton();this.fireFullScreenToggled({fullScreen:t});if(t==false&&this._oChart){this._oChart.setHeight(this._sChartHeight)}};yt.prototype._renderFullScreenButton=function(){this.oFullScreenButton.setTooltip(this.bFullScreen?this._oRb.getText("CHART_MINIMIZEBTN_TOOLTIP"):this._oRb.getText("CHART_MAXIMIZEBTN_TOOLTIP"));this.oFullScreenButton.setText(this.bFullScreen?this._oRb.getText("CHART_MINIMIZEBTN_TEXT"):this._oRb.getText("CHART_MAXIMIZEBTN_TEXT"));this.oFullScreenButton.setIcon(this.bFullScreen?"sap-icon://exit-full-screen":"sap-icon://full-screen")};yt.prototype._enrichFromDataPoints=function(t){var e=t.length;var i=[];var a={};for(var r=0;r<e;r++){this._interpretDataPoint(t[r].dataPoint,t[r].measure,a,i)}if(i.length>0){this._oChart.setActiveColoring({coloring:rt.Criticality,parameters:{measure:i}});this._oChart.setColorings({Criticality:{MeasureValues:a}})}};yt.prototype._interpretDataPoint=function(t,e,i,a){this._setSemanticPatterns(t,e);if(e.setBoundaryValues){this._setBoundaryValues(t,e)}if(t.Criticality||t.CriticalityCalculation){i[t.Value.Path]=this._oChartProvider.provideSemanticColoring(t);a.push(t.Value.Path)}};yt.prototype._setSemanticPatterns=function(t,e){var i=t.TargetValue?t.TargetValue.Path:null;var a=t.ForecastValue?t.ForecastValue.Path:null;e.setSemantics(ut.Actual);if(i!=null){var r=this._oChart.getMeasureByName(i);if(r){r.setSemantics(ut.Reference)}else{N.error("sap.ui.comp.SmartChart: "+t.TargetValue.Path+" is not a valid measure")}}if(a){var o=this._oChart.getMeasureByName(a);if(o){o.setSemantics(ut.Projected)}else{N.error("sap.ui.comp.SmartChart: "+t.ForecastValue.Path+" is not a valid measure")}}e.setSemanticallyRelatedMeasures({referenceValueMeasure:i,projectedValueMeasure:a})};yt.prototype._setBoundaryValues=function(t,e){var i={};if(t.MinimumValue){i.minimum=t.MinimumValue}if(t.MaximumValue){i.maximum=t.MaximumValue}if(i.minimum||i.maximum){e.setBoundaryValues(i)}};yt.prototype.isInitialised=function(){return!!this.bIsInitialised};yt.prototype.exit=function(){this._oRb=null;if(this._oChartTypePopover){this._oChartTypePopover.destroy();this._oChartTypePopover=null}if(this._oDrilldownPopover){this._oDrilldownPopover.destroy();this._oDrilldownPopover=null}if(this._oSmartFilter){this._oSmartFilter.detachSearch(this._reBindChart,this);this._oSmartFilter.detachFilterChange(this._filterChangeEvent,this)}if(this._oChartProvider&&this._oChartProvider.destroy){this._oChartProvider.destroy()}this._oChartProvider=null;if(this._oPersController&&this._oPersController.destroy){this._oPersController.destroy()}if(this._oSegmentedButton){this._oSegmentedButton.removeAllButtons();this._oButtonChart1.destroy();this._oButtonChart2.destroy();this._oButtonChart3.destroy();this._oButtonChart4.destroy();this._oButtonChart5.destroy();this._oButtonChart1=null;this._oButtonChart2=null;this._oButtonChart3=null;this._oButtonChart4=null;this._oButtonChart5=null}this._oPersController=null;if(this._oVariantManagement){this._oVariantManagement.detachSave(this._variantSaved,this);this._oVariantManagement.detachAfterSave(this._variantAfterSave,this);if(!this._oVariantManagement.isPageVariant()&&this._oVariantManagement.destroy){this._oVariantManagement.destroy()}}this._oVariantManagement=null;this._destroyPopover();z.cleanUpFullScreen(this);if(this._oDetailsPopover){this._oDetailsPopover.destroy();if(this._oRelatedAppsMasterList){this._oRelatedAppsMasterList.destroy()}}if(this._oChart){this._oChart.detachRenderComplete(this._toggleZoomButtonEnablement,this)}this._oCurrentVariant=null;this._oChartViewMetadata=null;this._aAlwaysSelect=null;this._aInitialSorters=null;this._oSmartFilter=null;this._oToolbar=null;this._oChartPersonalisationButton=null;this._oView=null;this._oChart=null;this._bDisableTimeseriesUTC=null;this._bWorkaroundVizFormatter=null;u.prototype.exit.apply(this,arguments)};yt.prototype._processResizeHandler=function(t){if(t){this.sResizeListenerId=null;if(y.system.desktop){this.sResizeListenerId=j.register(this,this._adjustHeight.bind(this))}else{y.orientation.attachHandler(this._adjustHeight,this);y.resize.attachHandler(this._adjustHeight,this)}}else{if(y.system.desktop&&this.sResizeListenerId){j.deregister(this.sResizeListenerId);this.sResizeListenerId=null}else{y.orientation.detachHandler(this._adjustHeight,this);y.resize.detachHandler(this._adjustHeight,this)}}};yt.prototype.setShowToolbar=function(t){if(this._oToolbar){this._oToolbar.setVisible(t)}return this.setProperty("showToolbar",t,true)};yt.prototype.setToolbarStyle=function(t){if(this._oToolbar){this._oToolbar.setStyle(t)}return this.setProperty("toolbarStyle",t,true)};yt.prototype.setShowDimensionsTitle=function(t){if(this._oChart){this._oChart.setVizProperties({categoryAxis:{title:{visible:t}}})}return this.setProperty("showDimensionsTitle",t,true)};yt.prototype.setShowMeasuresTitle=function(t){if(this._oChart){this._oChart.setVizProperties({valueAxis:{title:{visible:t}}})}return this.setProperty("showMeasuresTitle",t,true)};yt.prototype._checkDimensionColoring=function(){var t=this._getVisibleDimensions(),e,i={Criticality:{DimensionValues:{}}},a;for(var r=0;r<t.length;r++){e=this._getField(t[r]);a=this._oChartProvider.calculateDimensionColoring(e);if(a){if(this._sColoringDimension!=e.name){i.Criticality.DimensionValues[e.name]=a;this._oChart.setActiveColoring({coloring:rt.Criticality,parameters:{dimension:e.name}});this._oChart.setColorings(i);this._sColoringDimension=e.name}return}}};yt.prototype.getIdForLabel=function(){if(this._headerText){return this._headerText.getId()}return u.prototype.getIdForLabel.apply(this,[])};return yt});
}
});
//# sourceMappingURL=library-preload.js.map
