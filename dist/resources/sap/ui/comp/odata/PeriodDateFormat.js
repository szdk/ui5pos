/*!
 * SAPUI5
 * (c) Copyright 2009-2023 SAP SE. All rights reserved.
 */
sap.ui.define(["sap/ui/base/Object","sap/ui/core/LocaleData","sap/ui/core/Configuration"],function(t,e,o){"use strict";var r=t.extend("sap.ui.comp.odata.PeriodDateFormat",{metadata:{library:"sap.ui.comp"},constructor:function(r,s){t.call(this,r,s);var a,i,n,l,p=o.getFormatSettings().getFormatLocale(),f=e.getInstance(p),u=o.getFormatSettings().getCustomLocaleData(),m=/(m|y)(?:.*)(\W)(m|y)/i,h=u["dateFormats-short"];this.oFormatOptions=s;if(this.oFormatOptions.format.length>4){a="yM"}else if(this.oFormatOptions.format==="PPP"){a="M"}else{a=this.oFormatOptions.format}if(h&&a==="yM"){l=h.match(m).splice(1).join("");if(l){i=l}}else{i=f.getCustomDateTimePattern(a,this.oFormatOptions.calendarType)}i=i.replace(/([\u4e00-\u9faf\u3000-\u303f\u3040-\u309f\u30a0-\u30ff\uff00-\uffef])+/gi,"");if(this.oFormatOptions.format.length>4){i=i.replace(/y+/i,this.oFormatOptions.format.slice(0,this.oFormatOptions.format.lastIndexOf("Y")+1));i=i.replace(/m+/i,this.oFormatOptions.format.slice(this.oFormatOptions.format.lastIndexOf("Y")+1))}else if(this.oFormatOptions.format==="PPP"){i="PPP"}n=this.parseCldrDatePattern(i);this.oFormatOptions.pattern=n.length>1?i:"";this._setFormatRegex(n);this._setParseRegex(n);this._setValidationRegex(n)}});r.getDateInstance=function(t){return new r(null,t)};r.prototype.getPattern=function(){return this.oFormatOptions.pattern};r.prototype.getRegExPattern=function(){return this.sFormatRegExPattern};r.prototype.getTemplate=function(){return this.sFormatRegExGroups};r.prototype._setFormatRegex=function(t){var e=[],o=[],r,s,a,i,n;for(n=0;n<t.length;n++){r=t[n];s=r.symbol||"";a=this.oSymbols[s].format;if(s===""){o[n]=r.value}else if(s==="y"||s==="Y"){e.unshift("("+a.source+")");o[n]="$"+1}else{e.push("("+a.source+")");i=t.some(function(t){return t.symbol==="y"||t.symbol==="Y"});o[n]=i?"$"+2:"$"+1}}this.sFormatRegExPattern=new RegExp(e.join(""));this.sFormatRegExGroups=o.join("")};r.prototype._setParseRegex=function(t){var e,o,r,a,i,n=[],l={},p=0;for(a=0;a<t.length;a++){e=t[a];o=e.symbol||"";r=this.oSymbols[o].parse;if(o===""){n.push("\\D+?")}else{n.push("("+r.source+")");i=++p;l[i]=e}}this.sParseRegExPattern=new RegExp("^"+n.join("")+"$");this.fnParseRegExReplacer=function(){var t,e,o=[];for(var r in l){t=l[r];e=arguments[r];if(e.length<t.digits){if(t.symbol==="y"||t.symbol==="Y"){e=s(e)}else{e=e.padStart(t.digits,"0")}}if(t.symbol==="y"||t.symbol==="Y"){o.unshift(e)}else{o.push(e)}}return o.join("")}};r.prototype._setValidationRegex=function(t){var e,o,r,s,a=[];for(e=0;e<t.length;e++){o=t[e];r=o.symbol||"";s=this.oSymbols[r].format;if(r===""){continue}else if(r==="y"||r==="Y"){a.unshift(s.source)}else{a.push(s.source)}}this.sValidationRegExPattern=new RegExp("^("+a.join(")(")+")$")};r.prototype.parseCldrDatePattern=function(t){var e,o,r,s,a=[];for(e=0;e<t.length;e++){o=t[e];if(r!==o){s={}}else{s.digits+=1;continue}if(typeof this.oSymbols[o]==="undefined"){s.value=o;s.type="text"}else{s.symbol=o;s.digits=1}r=o;a.push(s)}return a};r.prototype.format=function(t){if(t==null||typeof t!=="string"){return""}return t.replace(this.sFormatRegExPattern,this.sFormatRegExGroups)};r.prototype.parse=function(t){if(t){return t.replace(this.sParseRegExPattern,this.fnParseRegExReplacer)}return null};r.prototype.validate=function(t){return this.sValidationRegExPattern.test(t)};r.oRegexFormatPatterns={};r.oRegexParsePatterns={};r.prototype.oSymbols={};r.prototype.destroy=function(){t.prototype.destroy.apply(this,arguments);this._oAnnotationValidationRegexPattern=null};function s(t){var e,o=Number.parseInt(t),r=(new Date).getUTCFullYear(),s=Math.floor(r/100);e=s*100+o-r;if(t.length===3){o+=Math.floor((s-1)/10)*1e3}else if(e<-70){o+=(s+1)*100}else if(e<30){o+=s*100}else{o+=(s-1)*100}return o}return r});
//# sourceMappingURL=PeriodDateFormat.js.map