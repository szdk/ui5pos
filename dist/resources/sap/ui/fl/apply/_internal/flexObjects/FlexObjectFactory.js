/* !
 * OpenUI5
 * (c) Copyright 2009-2024 SAP SE or an SAP affiliate company.
 * Licensed under the Apache License, Version 2.0 - see LICENSE.txt.
 */
sap.ui.define(["sap/base/util/restricted/_pick","sap/base/util/ObjectPath","sap/ui/core/Core","sap/ui/fl/apply/_internal/flexObjects/AppDescriptorChange","sap/ui/fl/apply/_internal/flexObjects/CompVariant","sap/ui/fl/apply/_internal/flexObjects/ControllerExtensionChange","sap/ui/fl/apply/_internal/flexObjects/FlexObject","sap/ui/fl/apply/_internal/flexObjects/FlVariant","sap/ui/fl/apply/_internal/flexObjects/States","sap/ui/fl/apply/_internal/flexObjects/UIChange","sap/ui/fl/registry/Settings","sap/ui/fl/Layer","sap/ui/fl/LayerUtils","sap/ui/fl/Utils"],function(e,t,n,a,r,i,c,o,s,l,p,u,f,O){"use strict";var g={BASE_FLEX_OBJECT:c,COMP_VARIANT_OBJECT:r,FL_VARIANT_OBJECT:o,CONTROLLER_EXTENSION:i,APP_DESCRIPTOR_CHANGE:a,UI_CHANGE:l};function y(e){if(e.fileType==="variant"){return g.COMP_VARIANT_OBJECT}else if(e.fileType==="ctrl_variant"){return g.FL_VARIANT_OBJECT}else if(e.changeType==="codeExt"){return g.CONTROLLER_EXTENSION}else if(e.appDescriptorChange){return g.APP_DESCRIPTOR_CHANGE}return g.UI_CHANGE}function C(e){const t=e.type||e.changeType;const n=e.fileName||e.id||O.createDefaultFileName(t);const a=e.user||(!f.isDeveloperLayer(e.layer)?p.getInstanceOrUndef()&&p.getInstanceOrUndef().getUserId():undefined);return{id:n,adaptationId:e.adaptationId,layer:e.layer,content:e.content,texts:e.texts,supportInformation:{service:e.ODataService,oDataInformation:e.oDataInformation,command:e.command,compositeCommand:e.compositeCommand,generator:e.generator,sourceChangeFileName:e.support&&e.support.sourceChangeFileName,sourceSystem:e.sourceSystem,sourceClient:e.sourceClient,originalLanguage:e.originalLanguage,user:a},flexObjectMetadata:{changeType:t,reference:e.reference,packageName:e.packageName,projectId:e.projectId}}}var m={};m.createFromFileContent=function(e,n,a){var r=Object.assign({},e);var i=n||y(r);if(!i){throw new Error("Unknown file type")}r.support=Object.assign({generator:"FlexObjectFactory.createFromFileContent"},r.support||{});var o=i.getMappingInfo();var l=c.mapFileContent(r,o);var p=Object.entries(l).reduce(function(e,n){t.set(n[0].split("."),n[1],e);return e},{});var u=new i(p);if(a){u.setProperty("state",s.LifecycleState.PERSISTED)}return u};m.createUIChange=function(e){e.packageName||="$TMP";var t=C(e);t.layer||=e.isUserDependent?u.USER:f.getCurrentLayer();t.selector=e.selector;t.jsOnly=e.jsOnly;t.variantReference=e.variantReference;t.isChangeOnStandardVariant=e.isChangeOnStandardVariant;t.fileType=e.fileType||"change";return new l(t)};m.createAppDescriptorChange=function(e){e.compositeCommand||=e.support&&e.support.compositeCommand;var t=C(e);return new a(t)};m.createControllerExtensionChange=function(e){e.generator||="FlexObjectFactory.createControllerExtensionChange";e.changeType="codeExt";e.content={codeRef:e.codeRef};var t=C(e);t.flexObjectMetadata.moduleName=e.moduleName;t.controllerName=e.controllerName;return new i(t)};m.createFlVariant=function(e){e.generator||="FlexObjectFactory.createFlVariant";var t=C(e);t.variantManagementReference=e.variantManagementReference;t.variantReference=e.variantReference;t.contexts=e.contexts;t.texts={variantName:{value:e.variantName,type:"XFLD"}};return new o(t)};m.createCompVariant=function(e){e.generator||="FlexObjectFactory.createCompVariant";e.user=t.get("support.user",e);var n=C(e);n.variantId=e.variantId||n.id;n.contexts=e.contexts;n.favorite=e.favorite;n.persisted=e.persisted;n.persistencyKey=e.persistencyKey||t.get("selector.persistencyKey",e);if(e.layer===u.VENDOR||e.layer===u.CUSTOMER_BASE){n.favorite=true}if(e.executeOnSelection!==undefined){n.executeOnSelection=e.executeOnSelection}else{n.executeOnSelection=n.content&&(n.content.executeOnSelect||n.content.executeOnSelection)}return new r(n)};return m});
//# sourceMappingURL=FlexObjectFactory.js.map