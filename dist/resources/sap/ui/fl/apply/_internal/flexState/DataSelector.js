/*!
 * OpenUI5
 * (c) Copyright 2009-2024 SAP SE or an SAP affiliate company.
 * Licensed under the Apache License, Version 2.0 - see LICENSE.txt.
 */
sap.ui.define(["sap/base/util/merge","sap/base/util/ObjectPath","sap/ui/base/ManagedObject"],function(t,e,a){"use strict";var i=a.extend("sap.ui.fl.apply._internal.flexState.DataSelector",{metadata:{properties:{parentDataSelector:{type:"object"},cachedResult:{type:"any"},parameterKey:{type:"string"},initFunction:{type:"function"},executeFunction:{type:"function"},updateListeners:{type:"function[]",defaultValue:[]},checkInvalidation:{type:"function",defaultValue(){return true}}}},constructor:function(...t){a.apply(this,t);this._mInitialized={};if(this.getParameterKey()){this.setCachedResult({})}var e=this.getParentDataSelector();if(e){this.onParentSelectorUpdate=this.checkUpdate.bind(this);e.addUpdateListener(this.onParentSelectorUpdate)}}});const r="DataSelector_no_parameter";function n(t,e){const a=[];let i=t;do{a.unshift(i.getParameterKey()?e[i.getParameterKey()]:r);i=i.getParentDataSelector()}while(i);return a}i.prototype.addUpdateListener=function(t){var e=this.getUpdateListeners();if(!e.includes(t)){this.setUpdateListeners([].concat(e,t))}};i.prototype.removeUpdateListener=function(t){var e=this.getUpdateListeners();this.setUpdateListeners(e.filter(function(e){return e!==t}))};i.prototype.exit=function(){var t=this.getParentDataSelector();if(t){t.removeUpdateListener(this.onParentSelectorUpdate)}};i.prototype._getParameterizedCachedResult=function(t){const a=n(this,t);return e.get(a,this.getCachedResult())};i.prototype._setParameterizedCachedResult=function(a,i){const r=n(this,a);const s={};e.set(r,i,s);return this.setCachedResult(t({},this.getCachedResult(),s))};i.prototype._clearCache=function(t){if(t){this._setParameterizedCachedResult(t,null)}else{var e=!!this.getParameterKey();this.setCachedResult(e?{}:null)}};i.prototype.clearCachedResult=function(t){this._clearCache(t);this.getUpdateListeners().forEach(function(t){t()})};i.prototype.get=function(t){var e=this.getParameterKey();if(e&&!(t||{})[e]){throw new Error(`Parameter '${e}' is missing`)}var a=this._getParameterizedCachedResult(t);if(a!==null&&a!==undefined){return a}var i=this.getParentDataSelector();var r=i&&i.get(t);var n=(t||{})[e];if(!this._mInitialized[n]&&this.getInitFunction()){this.getInitFunction()(r,n);this._mInitialized[n]=true}var s=this.getExecuteFunction()(r,n);this._setParameterizedCachedResult(t,s);return s};i.prototype.checkUpdate=function(t){if(this.getCheckInvalidation()(t)===true){this._clearCache(t);this.getUpdateListeners().forEach(function(t){t()})}};return i});
//# sourceMappingURL=DataSelector.js.map