{"version":3,"file":"ExportHandler.js","names":["sap","ui","define","library","ExportUtils","ExportDialog","PDFCapabilities","MessageToast","Core","EventProvider","ODataModel","openWindow","Destination","FileType","ExportHandler","extend","constructor","mCapabilities","that","this","call","_mCapabilities","Object","XLSX","PDF","oCapabilities","isA","isValid","_initialized","Promise","fnResolve","isGoogleSheetSupported","then","bSupported","GSHEET","_mDialogSettings","destination","REMOTE","fileType","finally","prototype","attachBeforeExport","oData","fnHandler","oListener","attachEvent","detachBeforeExport","detachEvent","initialized","destroy","apply","arguments","_oModel","_oFileShareBinding","_oExportDialog","_oFilePicker","_oDataSource","bIsDestroyed","getFileShareContexts","getFileShareModel","oModel","resolve","bindList","requestContexts","bind","getRemoteFileLocation","sFileName","fnReject","all","getResourceBundle","aResolve","oResourceBundle","require","CloudFilePicker","oFilePicker","sharedModel","suggestedFileName","enableDuplicateCheck","fileNameMandatory","confirmButtonText","getText","title","attachSelect","oEvent","aSelectedFiles","oSelectedFolder","bReplaceFile","mCloudFileInfo","getParameter","getFileShareId","getFileShareItemId","Array","isArray","length","oCloudFile","shift","open","getExportInstance","mExportSettings","mCustomSettings","oExportInstance","aFilters","oFilterConfig","includeFilterSettings","oContext","workbook","context","metainfo","name","items","getFilters","dataSource","metaSheetName","push","mEventExportSettings","fireEvent","exportSettings","userExportSettings","filterSettings","filter","oFilter","sort","firstElement","secondElement","sFirst","getLabel","toLowerCase","sSecond","forEach","key","value","getValue","attachBeforeSave","aArrayBuffer","oExportDialog","getMimeType","uInt8Array","Uint8Array","stringArray","i","String","fromCharCode","btoa","join","updateStatus","preventDefault","uploadFile","show","catch","showErrorMessage","finish","oBinding","sContentProperty","sTypeProperty","sPath","getKeepAliveContext","FileShare","FileShareItem","setProperty","getProperty","ParentFileShareItem","_createFile","sUrl","fnCreateCompleted","bSuccess","detachCreateCompleted","attachCreateCompleted","create","export","reject","build","exportAs","oSettings","fnResolveColumnLabel","mUserSettings","assign","aContexts","getExportSettingsViaDialog","oDialog","mDialogSettings","validateFileSettings","splitCells","columns","splitColumns","parseTechnicalConfiguration","oUserConfig","LOCAL","fileName","FileShareItemName","validateFileName","validateFileShare","oFileShareContext","find","isGoogleWorkspace","fetchDataSource","oDataSource","serviceUrl","uri","synchronizationMode","autoExpandSelect","some","sDescription","sVendorType","indexOf"],"sources":["ExportHandler-dbg.js"],"mappings":"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"}