//@ui5-bundle sap/ui/export/library-preload.js
/*!
 * SAPUI5
 * (c) Copyright 2009-2023 SAP SE. All rights reserved.
 */
sap.ui.predefine("sap/ui/export/ExportBase", ["sap/ui/core/Core","sap/ui/base/EventProvider","sap/base/Log","sap/ui/export/ExportUtils"],function(t,e,r,o){"use strict";var i=e.extend("sap.ui.export.ExportBase",{constructor:function(t,r){e.call(this,t);this._mCapabilities=r||{};this._mSettings={fileName:"Export"};["count","dataSource","fileName","fileType","workbook"].forEach(function(e){if(typeof t[e]!=="undefined"){this._mSettings[e]=e!=="dataSource"?t[e]:this.processDataSource(t[e])}}.bind(this));if(this._mSettings.workbook){this._mSettings.workbook.hierarchyLevel=o.getHierarchyLevelProperty(t.dataSource)||this._mSettings.workbook.hierarchyLevel;this._mSettings.workbook.drillState=o.getHierarchyDrillStateProperty(t.dataSource)||this._mSettings.workbook.drillState}}});i.prototype.attachBeforeExport=function(t,e,r){return this.attachEvent("beforeExport",t,e,r)};i.prototype.detachBeforeExport=function(t,e){return this.detachEvent("beforeExport",t,e)};i.prototype.destroy=function(){e.prototype.destroy.apply(this,arguments);this.cancel();this._mSettings=null;this._mCapabilities=null;this.bIsDestroyed=true};i.prototype.cancel=function(){throw new Error("Abstract function not implemented")};i.prototype.processDataSource=function(t){throw new Error("Abstract function not implemented")};i.prototype.setDefaultExportSettings=function(t){throw new Error("Abstract function not implemented")};i.prototype.createBuildPromise=function(t){throw new Error("Abstract function not implemented")};i.prototype.getMimeType=function(){throw new Error("Abstract function not implemented")};i.prototype.build=function(){var t=this._mSettings;if(this.bIsDestroyed){var e=this.getMetadata().getName()+": Cannot trigger build - the object has been destroyed";r.error(e);return Promise.reject(e)}return this.setDefaultExportSettings(t).then(function(){this.fireEvent("beforeExport",{exportSettings:t},false,false);o.validateSettings(t);return this.createBuildPromise(t)}.bind(this))};return i});
/*!
 * SAPUI5
 * (c) Copyright 2009-2023 SAP SE. All rights reserved.
 */
sap.ui.predefine("sap/ui/export/ExportDialog", ["sap/ui/core/library","sap/ui/core/format/NumberFormat","sap/ui/export/ExportUtils","sap/m/library","sap/m/Dialog","sap/m/Button","sap/m/ProgressIndicator","sap/m/Text","sap/m/MessageBox"],function(e,t,n,s,i,a,r,o,u){"use strict";var l=e.ValueState;var T=s.DialogType;var g=s.ButtonType;function f(){return new Promise(function(e,t){var s;n.getResourceBundle().then(function(t){var n=new a({text:t.getText("CANCEL_BUTTON"),press:function(){if(s&&s.oncancel){s.oncancel()}s.finish()}});var u=new r({displayAnimation:false,displayValue:"0 / 0",showValue:true,height:"0.75rem",state:l.Information});u.addStyleClass("sapUiMediumMarginTop");var g=new o({text:t.getText("PROGRESS_FETCHING_MSG")});s=new i({title:t.getText("PROGRESS_TITLE"),type:T.Message,contentWidth:"500px",content:[g,u],endButton:n,ariaLabelledBy:[g]});s.updateStatus=function(e,s,i){var a;if(typeof e==="string"&&e){i=e;g.setText(i)}if(!isNaN(e)&!isNaN(s)){a=e/s*100}if(a>=100){u.setState(l.Success);n.setEnabled(false);g.setText(i||t.getText("PROGRESS_BUNDLE_MSG"))}u.setPercentValue(a);if(isNaN(s)||s<=0||s>=1048575){s="âˆž"}if(!isNaN(e)){u.setDisplayValue(""+e+" / "+s)}};s.finish=function(){s.close();s.destroy()};e(s)})})}function c(e){return new Promise(function(s,r){n.getResourceBundle().then(function(n){var u,f,c,p,N,_,R,x,E,m;u=[];f=false;N=t.getIntegerInstance({groupingEnabled:true});m=n.getText(e.fileType+"_FILETYPE");E=N.format(e.rowLimit);if(e.rows){_=N.format(e.rows);if(e.columns){R=N.format(e.rows*e.columns);u.push(n.getText("MSG_WARNING_CELL_COUNT",[_,e.columns,R]))}else{u.push(n.getText("MSG_WARNING_ROW_COUNT",[_]))}if(e.rows>e.rowLimit){u.push(n.getText("MSG_WARNING_ROW_LIMIT",[E,m]))}if(e.rows*e.columns>e.cellLimit){x=N.format(e.cellLimit);u.push(n.getText("MSG_WARNING_CELL_LIMIT",[x]))}}else{u.push(n.getText("MSG_WARNING_COUNT_UNKNOWN"));u.push(n.getText("MSG_WARNING_ROW_LIMIT",[E,m]));u.push(n.getText("MSG_WARNING_ADVICE"))}u.push(n.getText("MSG_WARNING_EXPORT_ANYWAY"));p=new o({text:u.join("\n\n")});c=new i({title:n.getText("WARNING_TITLE"),type:T.Message,state:l.Warning,content:p,contentWidth:"550px",ariaLabelledBy:p,endButton:new a({type:g.Transparent,text:n.getText("CANCEL_BUTTON"),press:function(){c.close()}}),beginButton:new a({type:g.Emphasized,text:n.getText("EXPORT_BUTTON"),press:function(){f=true;c.close()}}),afterClose:function(){c.destroy();f?s():r()}});c.open()})})}function p(e){if(!e){return}if(e instanceof Error){e=e.message}n.getResourceBundle().then(function(t){var n=e||t.getText("PROGRESS_ERROR_DEFAULT");if(e.toLowerCase().indexOf("invalid string length")>-1){n=t.getText("MSG_ERROR_OUT_OF_MEMORY")}u.error(n,{title:t.getText("PROGRESS_ERROR_TITLE")})})}return{getProgressDialog:f,showErrorMessage:p,showWarningDialog:c}},true);
/*!
 * SAPUI5
 * (c) Copyright 2009-2023 SAP SE. All rights reserved.
 */
sap.ui.predefine("sap/ui/export/ExportHandler", ["./library","./ExportUtils","./ExportDialog","./util/PDFCapabilities","sap/m/MessageToast","sap/ui/core/Core","sap/ui/base/EventProvider","sap/ui/model/odata/v4/ODataModel","sap/ui/util/openWindow"],function(e,t,i,r,n,o,a,l,s){"use strict";var u=e.Destination;var h=e.FileType;var p=a.extend("sap.ui.export.ExportHandler",{constructor:function(e){var t=this;a.call(this);this._mCapabilities=e instanceof Object?e:{XLSX:{}};if(this._mCapabilities.PDF){var i=this._mCapabilities.PDF;if(typeof i.isA!=="function"||!i.isA("sap.ui.export.util.PDFCapabilities")){this._mCapabilities.PDF=new r(i)}if(!this._mCapabilities.PDF.isValid()){delete this._mCapabilities.PDF}}this._initialized=new Promise(function(e){t.isGoogleSheetSupported().then(function(e){if(e){t._mCapabilities[h.GSHEET]={};t._mDialogSettings={destination:u.REMOTE,fileType:h.GSHEET}}}).finally(e)})}});p.prototype.attachBeforeExport=function(e,t,i){return this.attachEvent("beforeExport",e,t,i)};p.prototype.detachBeforeExport=function(e,t){return this.detachEvent("beforeExport",e,t)};p.prototype.initialized=function(){return this._initialized};p.prototype.destroy=function(){a.prototype.destroy.apply(this,arguments);if(this._oModel){this._oModel.destroy()}if(this._oFileShareBinding){this._oFileShareBinding.destroy()}if(this._oExportDialog){this._oExportDialog.destroy()}if(this._oFilePicker){this._oFilePicker.destroy()}this._mCapabilities=null;this._oDataSource=null;this._mDialogSettings=null;this._oModel=null;this._oFileShareBinding=null;this.bIsDestroyed=true};p.prototype.getFileShareContexts=function(){return this.getFileShareModel().then(function(e){if(!e){return Promise.resolve([])}if(!this._oFileShareBinding){this._oFileShareBinding=e.bindList("/FileShares")}return this._oFileShareBinding.requestContexts(0)}.bind(this))};p.prototype.getRemoteFileLocation=function(e){var i=this;return new Promise(function(r,n){Promise.all([t.getResourceBundle(),i.getFileShareModel()]).then(function(t){var o=t[0];var a=t[1];sap.ui.require(["sap/suite/ui/commons/CloudFilePicker"],function(t){var l;i._oFilePicker=l=new t({sharedModel:a,suggestedFileName:e,enableDuplicateCheck:true,fileNameMandatory:true,confirmButtonText:o.getText("EXPORT_BUTTON"),title:o.getText("DESTINATION_DIALOG_TITLE")});l.attachSelect(function(e){var t,i,a,l={};t=e.getParameter("selectedFiles");i=e.getParameter("selectedFolder");a=e.getParameter("replaceExistingFile");l={};l["FileShare"]=i.getFileShareId();l["FileShareItemKind"]="document";l["FileShareItemName"]=e.getParameter("selectedFileName");l["ParentFileShareItem"]=i.getFileShareItemId();if(a&&Array.isArray(t)&&t.length>0){var s=t.shift();l["FileShareItem"]=s.getFileShareItemId()}if(!l["FileShare"]){n(o.getText("DESTINATION_SELECTION_INCOMPLETE"))}r(l)});l.open()})})})};p.prototype.getExportInstance=function(e,r,o){var a=this;return Promise.all([t.getResourceBundle(),t.getExportInstance(e,this._mCapabilities)]).then(function(l){var s=l[0];var u=l[1];var p=[];var c;if(r&&r.includeFilterSettings){var f=e.workbook.context;if(!f){f=e.workbook.context={metainfo:[]}}c={name:s.getText("FILTER_HEADER"),items:[]};p=r.includeFilterSettings?t.getFilters(e.dataSource):[];f.metaSheetName=c.name;f.metainfo.push(c)}u.attachBeforeExport(function(e){var t=e.getParameter("exportSettings");a.fireEvent("beforeExport",{exportSettings:t,userExportSettings:r||{},filterSettings:p},false,false);p.filter(function(e){return e&&typeof e.isA==="function"&&e.isA("sap.ui.export.util.Filter")}).sort(function(e,t){var i=e.getLabel().toLowerCase();var r=t.getLabel().toLowerCase();if(i>r){return 1}if(i<r){return-1}return 0}).forEach(function(e){c.items.push({key:e.getLabel(),value:e.getValue()})})});if(o&&typeof u.attachBeforeSave==="function"){u.attachBeforeSave(function(t){var r,l;r=t.getParameter("data");l=t.getParameter("exportDialog");o["FileShareItemContentType"]=u.getMimeType();o["FileShareItemConvertToMimeType"]=u.getMimeType();if(e.fileType===h.GSHEET){o["FileShareItemConvertToMimeType"]="application/vnd.google-apps.spreadsheet"}var p=new Uint8Array(r);var c=new Array(p.length);for(var f=0;f<p.length;f++){c[f]=String.fromCharCode(p[f])}o["FileShareItemContent"]=btoa(c.join(""));l.updateStatus(s.getText("DESTINATION_DIALOG_STATUS"));t.preventDefault();a.uploadFile(o).then(function(){n.show(s.getText("DESTINATION_TRANSFER_SUCCESS"))}).catch(function(){i.showErrorMessage(s.getText("DESTINATION_TRANSFER_ERROR"))}).finally(function(){l.finish()})})}return u})};p.prototype.uploadFile=function(e){return this.getFileShareModel().then(function(t){var i,r,n,o,a;n="FileShareItemContent";o="FileShareItemContentType";if(e["FileShareItem"]){r=t.getKeepAliveContext("/FileShareItems(FileShare='"+e.FileShare+"',FileShareItem='"+e.FileShareItem+"')");r.setProperty("FileShareItemContentLink","",null);r.setProperty(o,e[o]);return r.setProperty(n,e[n]).then(function(){return r.getProperty("FileShareItemContentLink")})}if(e.ParentFileShareItem){a="/FileShareItems(FileShare='"+e.FileShare+"',FileShareItem='"+e.ParentFileShareItem+"')/_Children"}else{a="/FileShares(FileShare='"+e.FileShare+"')/_Root/_Children"}i=t.bindList(a);return this._createFile(i,e)}.bind(this)).then(function(e){if(e){s(e)}})};p.prototype._createFile=function(e,t){return new Promise(function(i,r){function n(t){var o,a;o=t.getParameter("success");a=t.getParameter("context");if(o){e.detachCreateCompleted(n);i(a.getProperty("FileShareItemContentLink"))}else{a.destroy();r()}}e.attachCreateCompleted(n);e.create(t,true)})};p.prototype.export=function(e){if(this.bIsDestroyed){Promise.reject("ExportHandler must not be used after calling #destroy")}return this.getExportInstance(e).then(function(e){return e.build().finally(function(){e.destroy()})})};p.prototype.exportAs=function(e,r){var n=this;var o;var a={};if(this.bIsDestroyed){return Promise.reject("ExportHandler must not be used after calling #destroy")}return this.initialized().then(function(){o=Object.assign({},e,n._mDialogSettings);return n.getFileShareContexts()}).then(function(e){return t.getExportSettingsViaDialog(o,n._mCapabilities,e.length>0,function(e){n._oExportDialog=e})}).then(function(e){n._mDialogSettings=e;Object.assign(o,e);t.validateFileSettings(o);a.splitCells=e.splitCells;a.includeFilterSettings=e.includeFilterSettings;if(o.fileType===h.PDF||e.splitCells){o.workbook.columns=t.splitColumns(o.workbook.columns,r)}if(o.includeFilterSettings){return t.parseTechnicalConfiguration()}return Promise.resolve()}).then(function(e){if(e){var t=o.workbook.context;if(!t){t=o.workbook.context={}}t.metainfo=Array.isArray(t.metainfo)?t.metainfo.push(e):[e]}}).then(function(){if(o.destination===u.LOCAL){return Promise.resolve()}return n.getRemoteFileLocation(o.fileName)}).then(function(e){if(e&&!e["FileShareItem"]){e.FileShareItemName=t.validateFileName(e.FileShareItemName,o.fileType)}if(o.fileType===h.GSHEET){return n.validateFileShare(e)}return e}).then(function(e){return n.getExportInstance(o,a,e).then(function(e){return e.build().finally(function(){e.destroy()})})}).catch(i.showErrorMessage)};p.prototype.validateFileShare=function(e){return Promise.all([t.getResourceBundle(),this.getFileShareContexts()]).then(function(t){var i=t[0];var r=t[1];var n=r.find(function(t){return t.getProperty("FileShare")===e.FileShare});return this.isGoogleWorkspace(n)?e:Promise.reject(i.getText("DESTINATION_ERROR_NOT_GOOGLE"))}.bind(this))};p.prototype.getFileShareModel=function(){if(this._oModel){return Promise.resolve(this._oModel)}return t.fetchDataSource().then(function(e){if(e){this._oModel=new l({serviceUrl:e.uri,synchronizationMode:"None",autoExpandSelect:true})}return this._oModel}.bind(this))};p.prototype.isGoogleSheetSupported=function(){return this.getFileShareContexts().then(function(e){return e.some(this.isGoogleWorkspace)}.bind(this))};p.prototype.isGoogleWorkspace=function(e){var t,i;i=e.getProperty("FileShareVendorType");t=e.getProperty("FileShareDescription");return i==="GOOGLE"||typeof t==="string"&&t.indexOf("Google")>-1};return p},true);
/*!
 * SAPUI5
 * (c) Copyright 2009-2023 SAP SE. All rights reserved.
 */
sap.ui.predefine("sap/ui/export/ExportUtils", ["./library","./util/Filter","sap/base/config","sap/base/Log","sap/ui/core/Core","sap/ui/core/Fragment","sap/ui/core/format/DateFormat","sap/ui/core/library","sap/ui/core/syncStyleClass","sap/ui/core/LocaleData","sap/ui/model/json/JSONModel","sap/ui/model/resource/ResourceModel","sap/ui/performance/trace/FESRHelper","sap/ui/util/openWindow","sap/ui/VersionInfo"],function(e,t,r,a,n,i,o,l,s,u,f,p,c,d,g){"use strict";var y=l.ValueState;var m=l.CalendarType;var v=e.FileType;var h=e.EdmType;var S=e.Destination;var b=null;var T=null;var E;var P="sap.ui.export.ExportUtils";var w=/[\\\/\?\*:\[\]]/g;g.load().then(function(e){var t=/^[0-9]+\.[0-9]+/.exec(e.version);b=t?t[0]:null});n.attachLocalizationChanged(function(){T=null});function A(e,t,r,a){var n=Object.keys(r);var i={fileName:"Standard",fileTypeCollection:[],fileType:"XLSX",destinationCollection:[{key:S.LOCAL,text:t.getText("DESTINATION_LOCAL")}],destination:S.LOCAL,paperSize:"DIN_A4",orientation:"LANDSCAPE",splitCells:false,includeFilterSettings:false,addDateTime:false,doEnableAccessibility:false,pdfArchive:false,capabilities:r,fitToPage:false,paperSizeCollection:[{key:"DIN_A4",text:t.getText("PAPER_SIZE_A4")},{key:"US_LETTER",text:t.getText("PAPER_SIZE_US_LETTER")}],orientationCollection:[{key:"LANDSCAPE",text:t.getText("ORIENTATION_LAND")},{key:"PORTRAIT",text:t.getText("ORIENTATION_PORT")}],fontSize:10,signature:false,signatureReason:"",showPageNumber:true};n.forEach(function(e){var r,a;r=e.toUpperCase();a=r+"_FILETYPE";i.fileTypeCollection.push({key:r,text:t.getText(a)})});if(a){i.destinationCollection.push({key:"REMOTE",text:t.getText("DESTINATION_REMOTE")})}var o=Object.assign({},i,e||{});if(!o.fileTypeCollection.some(function(e){return e.key===o.fileType})){o.fileType=o.fileTypeCollection[0].key}return o}function _(e){var t={};["fileName","fileType","paperSize","orientation","splitCells","includeFilterSettings","addDateTime","doEnableAccessibility","fitToPage","fontSize","signature","signatureReason","pdfArchive","destination","showPageNumber"].forEach(function(r){t[r]=e[r]});return t}var C={_INTERCEPTSERVICE:"sap/ushell/cloudServices/interceptor/InterceptService",interceptUrl:function(e){var t=sap.ui.require(C._INTERCEPTSERVICE);if(t){var r=t.getInstance();if(r&&r.interceptUrl){e=r.interceptUrl(e)}}return e},fetchDataSource:function(){var e;if(C._oDataSource){return Promise.resolve(C._oDataSource)}e=r.get({name:"sapUiFileShareSupport",type:r.Type.String,defaultValue:undefined});if(!e){return Promise.resolve()}return new Promise(function(t){sap.ui.require([e],function(e){e.getDataSource().then(function(e){C._oDataSource=e;t(e)}).catch(function(){t()})})})},normalizeUrl:function(e){return e?new URL(e,document.baseURI).toString():e},getExportSettingsViaDialog:function(e,t,r,a,o){return new Promise(function(l,u){var d;if(typeof r==="object"){o=a;a=r;r=undefined}else if(typeof r==="function"){o=r;r=undefined}else if(typeof a==="function"){o=a;a=null}C.getResourceBundle().then(function(g){var m=new f;var h=function(e,t){var r="OI:EXP:";var a=e.getProperty("/destination");var n=e.getProperty("/fileType");r+=a===S.REMOTE?"CL:":"LOC:";switch(n){case v.PDF:r+="PDF";break;case v.XLSX:r+="XLS";break;case v.GSHEET:r+="GS";break;default:r="OI:EXP"}c.setSemanticStepname(t,"press",r)};m.setData(A(e,g,t,r));i.load({name:"sap.ui.export.fragments.SettingsDialog",type:"XML",controller:{isPDF:function(e,t){return e===v.PDF&&t!==false},isSpreadsheet:function(e){return e===v.XLSX||e===v.GSHEET},isDestinationEnabled:function(e){return e===v.XLSX},hasDestinations:function(e){return e.length>1},formatExportButton:function(e){return e===S.LOCAL?g.getText("EXPORT_BUTTON"):g.getText("DIALOG_BUTTON_CLOUD_DESTINATION")},onCancel:function(){d._bSuccess=false;d.close()},onExport:function(){d._bSuccess=true;d.close()},onFileNameChange:function(e){var t=e.getSource();var r=e.getParameter("value");var a=/[\\/:|?"*<>]/;var i=n.byId("exportSettingsDialog-exportButton");var o=a.test(r);if(o){t.setValueState(y.Error);t.setValueStateText(g.getText("FILENAME_ERROR"))}else if(r.length>100){t.setValueState(y.Warning);t.setValueStateText(g.getText("FILENAME_WARNING"))}else{t.setValueState(y.None);t.setValueStateText(null)}i.setEnabled(!o)},onFileTypeChange:function(e){var t=e.getParameter("selectedItem");if(!t){return}switch(t.getKey()){case v.PDF:m.setProperty("/includeFilterSettings",false);m.setProperty("/destination",S.LOCAL);h(m,d.getBeginButton());break;case v.GSHEET:m.setProperty("/destination",S.REMOTE);h(m,d.getBeginButton());break;default:n.byId("exportSettingsDialog-signatureReason").setVisible(false);n.byId("exportSettingsDialog-signatureReasonLabel").setVisible(false);h(m,d.getBeginButton())}},onDestinationChange:function(e){if(!e.getParameter("selectedItem")){return}h(m,d.getBeginButton())},onFontSizeChange:function(e){var t=e.getSource();var r=e.getParameter("value");var a=/[^\d]/g;var i=n.byId("exportSettingsDialog-exportButton");var o=a.test(r);if(o){t.setValueState(y.Error);t.setValueStateText(g.getText("NUMBER_ERROR"))}else{t.setValueState(y.None);t.setValueStateText(null)}i.setEnabled(!o)},onAfterClose:function(){if(d._bSuccess){l(_(m.getData()))}else{u(null)}d.destroy();d=null}}}).then(function(e){d=e;if(t.PDF&&!t.PDF["HeaderFooter"]){m.oData.showPageNumber=false}d.setModel(m);d.setModel(new p({bundle:g}),"i18n");if(a){s("sapUiSizeCompact",a,d)}h(m,d.getBeginButton());c.setSemanticStepname(d.getEndButton(),"press","OI:EXP:CANCEL");d.open();if(o){o(d)}})})})},_getReadableFilterValue:function(e){switch(e.op||e.name){case"==":case">":case"<":case"!=":case"<=":case">=":return{operator:e.op||e.name,value:e.right.value};case"between":return{operator:e.op||e.name,value:[e.args[1].value,e.args[2].value]};case"contains":case"endswith":case"startswith":return{operator:e.op||e.name,value:e.args[1].value};default:throw Error("getReadableFilter")}},_parseFilter:function(e){switch(e.type){case"Logical":return C._parseLogical(e);case"Binary":return C._parseBinary(e);case"Unary":return C._parseUnary(e);case"Call":return C._parseCall(e);default:throw Error("Filter type "+e.type+" not supported")}},_parseLogical:function(e){var t,r;try{if(e.op=="&&"&&e.left.type==="Binary"&&e.right.type==="Binary"&&e.left.op===">="&&e.right.op==="<="&&e.left.left.path===e.right.left.path){return C._parseCall({args:[{path:e.left.left.path,type:"Reference"},{type:"Literal",value:e.left.right.value},{type:"Literal",value:e.right.right.value}],name:"between",type:"Call"})}t=C._parseFilter(e.left).concat(C._parseFilter(e.right));if(e.op==="||"&&t.length){r=t[0].key;if(t.every(function(e){return e.key===r})){t=[{key:r,value:t.reduce(function(e,t){if(Array.isArray(t.value)){return e.concat(t.value)}e.push(t.value);return e},[])}]}}}catch(e){t=[]}return t},_parseBinary:function(e){if(!e.left||e.left.type!="Reference"||!e.right||e.right.type!="Literal"){return[]}return[{key:e.left.path,value:C._getReadableFilterValue(e)}]},_parseUnary:function(e){var t;if(!e.arg){return[]}t=C._parseFilter(e.arg);if(e.op==="!"&&t[0].value){t[0].value.exclude=true}return t},_parseCall:function(e){if(!e.args||e.args.length<2){return[]}return[{key:e.args[0].path,value:C._getReadableFilterValue(e)}]},parseFilterConfiguration:function(){a.error("Function is deprecated and must not be used anymore");return C.getResourceBundle().then(function(e){return{name:e.getText("FILTER_HEADER"),items:[]}})},getFilters:function(e){var r,n;r=[];if(!e||!e.isA(["sap.ui.model.ListBinding","sap.ui.model.TreeBinding"])){a.error("A ListBinding or TreeBinding is required for parsing the filter settings");return r}n=e.getFilterInfo();if(n){C._parseFilter(n).forEach(function(e){r.push(new t(e.key,e.value))})}return r},parseTechnicalConfiguration:function(){var e,t,r;e={};r=sap.ushell&&sap.ushell.Container;return C.getResourceBundle().then(function(r){t=r;e.name=t.getText("TECHNICAL_INFORMATION");e.items=[{key:t.getText("CREATED_TIME"),value:o.getDateTimeWithTimezoneInstance().format(new Date)}]}).then(function(){return r&&typeof r.getServiceAsync==="function"?r.getServiceAsync("UserInfo"):undefined}).then(function(r){if(r&&r.getFullName()){e.items.unshift({key:t.getText("USER_NAME"),value:r.getFullName()})}return e})},saveAsFile:function(e,t){var r,a,n;if(!(e instanceof Blob)){return}r=document.createElementNS("http://www.w3.org/1999/xhtml","a");a="download"in r;if(a){n=function(e,t){r.download=t;r.href=URL.createObjectURL(e);r.dispatchEvent(new MouseEvent("click"))}}if(typeof n==="undefined"){n=function(e){var t=new FileReader;t.onloadend=function(){var e,r;r=t.result.replace(/^data:[^;]*;/,"data:attachment/file;");e=d(r,"_blank");if(!e){window.location.href=r}};t.readAsDataURL(e)}}n(e,t)},validateSettings:function(e){C._validateDataSource(e.dataSource);C.validateFileSettings(e);if(typeof e.showProgress!=="boolean"){e.showProgress=true}C._validateWorkbook(e.workbook);if(typeof e.worker!=="boolean"){e.worker=true}C._validateScaleCustomizing(e.customizing,"currency");C._validateScaleCustomizing(e.customizing,"unit")},validateFileSettings:function(e){e.fileType=v[e.fileType]?e.fileType:v.XLSX;e.fileName=C.validateFileName(e.fileName,e.fileType)},validateFileName:function(e,t){var r;e=e||"export";r="."+t.toLowerCase();if(!e.endsWith(r)&&t!==v.GSHEET){e+=r;a.info(P+": fileName was missing the proper file extension - extension has been added")}return e},_validateDataSource:function(e){var t;if(!e||typeof e!=="object"){throw new Error(P+": dataSource has not been specified")}e.type=typeof e.type==="string"&&e.type.toLowerCase()||"odata";if(e.type==="array"&&!Array.isArray(e.data)){a.warning(P+": Defined type does not match the provided data")}if(Array.isArray(e.data)){e.count=e.data.length}if(e.type==="odata"){if(typeof e.dataUrl!=="string"||e.dataUrl.length===0){throw new Error(P+": Unable to export data. No dataUrl provided.")}if(e.dataUrl){e.dataUrl=C.normalizeUrl(e.dataUrl)}if(e.serviceUrl){e.serviceUrl=C.normalizeUrl(e.serviceUrl)}}if(typeof e.count!=="number"||e.count<0||isNaN(e.count)||e.count%1!==0){a.info(P+": Invalid value for dataSource.count - value will be ignored");e.count=null}if(typeof e.useBatch!=="boolean"){e.useBatch=false;a.info(P+': Parameter useBatch not provided. Applying default value "false"')}else if(e.useBatch===true){if(typeof e.serviceUrl!=="string"||e.serviceUrl.length===0){e.useBatch=false;a.warning(P+": serviceUrl is required for OData batch requests")}if(typeof e.headers!=="object"){e.useBatch=false;a.warning(P+": headers are required for OData batch requests.")}}t=e.sizeLimit;if(!t||isNaN(t)||t%1!==0){var r=5e3,n=200;t=e.count?Math.round(e.count/(n*5))*n:n;t=Math.min(r,Math.max(t,n));e.sizeLimit=t;a.info(P+": No valid sizeLimit provided. sizeLimit is set to "+t)}},_validateWorkbook:function(e){if(!(e instanceof Object)||!Array.isArray(e.columns)){throw new Error(P+"column configuration is not provided. Export is not possible")}e.columns=e.columns.filter(function(e,t){var r;if(!(e instanceof Object)){a.error(P+": Column "+t+" skipped due to invalid configuration");return false}if(Array.isArray(e.property)&&e.type!==h.String&&e.type!=null){a.warning(P+": Type "+e.type+" does not support an array of properties");e.property=e.property[0]}if(typeof e.property!=="string"&&!Array.isArray(e.property)){a.error(P+": Column "+t+" skipped due to missing mandatory property");return false}e.label=e.label||(e.property instanceof Array?e.property[0]:e.property);r=e.width;if(typeof r==="string"){var i;i=r.toLowerCase();r=parseFloat(i);if(i.indexOf("em")>0){r=Math.floor((r*16-5)/8*100+.5)/100}else if(i.indexOf("px")>0){r=Math.floor((r-5)/8*100+.5)/100}}if(isNaN(r)||r<1){r=10}e.width=Math.round(r);C._validateType(e,t);C._validateString(e,"textAlign");if(e.textAlign){var o=(e.textAlign+"").toLowerCase();if(["begin","end"].indexOf(o)>-1){var l=["left","right"];o=(n.getConfiguration().getRTL()?l.reverse():l)[["begin","end"].indexOf(o)]}if(o!==""&&["left","right","center"].indexOf(o)==-1){a.warning(P+": Incorrect column alignment value "+o+' on column "'+(e.label||e.property)+'". Default alignment is used.');o=""}e.textAlign=o}["autoScale","delimiter","displayTimezone","displayUnit","utc","wrap"].forEach(function(t){C._validateProperty(e,t,"boolean")});["inputFormat","unit","unitProperty","template","trueValue","falseValue","timezone","timezoneProperty"].forEach(function(t){C._validateString(e,t)});if(e.template&&!Array.isArray(e.property)&&typeof e.inputFormat!=="string"){a.warning(P+': Template is not applicable on a single property without inputFormat - value will be discarded on column "'+(e.label||e.property)+'".');delete e.template}if(typeof e.calendar==="string"&&[m.Gregorian,m.Islamic,m.Japanese].indexOf(e.calendar)<0){a.warning(P+': Unsupported calendar "'+e.calendar+'" on column "'+(e.label||e.property)+'". Value will be discarded.');delete e.calendar}if(e.type===h.Boolean&&(e.trueValue===null||e.falseValue===null)){a.warning(P+': The properties trueValue and falseValue have to be assigned correctly on column "'+(e.label||e.property)+'". Values will be discarded.');delete e.trueValue;delete e.falseValue}if(e.autoScale===true&&(e.type!==h.Number||!e.unit&&!e.unitProperty)){a.warning(P+": autoScale cannot be taken into account due to invalid configuration.");delete e.autoScale}if(e.type===h.DateTime){if(!e.timezone){e.timezone=e.utc===false?n.getConfiguration().getTimezone():"UTC"}if(e.property===e.timezoneProperty||typeof e.timezoneProperty==="string"&&e.timezoneProperty.split(",").length>1){a.warning(P+": Property timezoneProperty is invalid.");delete e.timezoneProperty}}else if(typeof e.utc==="boolean"){a.warning(P+": Property utc is only supported for type DateTime.");delete e.utc}var s=e.scale;if(e.type===h.Number&&isNaN(s)&&s!=="variable"){a.warning(P+": scale parameter for numerical column configuration is missing.")}if(typeof s==="string"){s=parseInt(s)}if(isNaN(s)){s=null}e.scale=s;if(e.valueMap&&typeof e.valueMap!=="object"){a.warning(P+': Invalid value for property "valueMap" on column "'+(e.label||e.property)+'". Value will be discarded.');delete e.valueMap}return true});C._validateWorkbookContext(e.context);C._validateString(e,"hierarchyLevel");C._validateString(e,"drillState")},_validateType:function(e){var t,r;if(typeof e.type!=="string"){e.type=h.String;return}if(!h[e.type]){r=h.String;for(t in h){if(t.toLowerCase()==e.type.toLowerCase()){r=t}}a.warning(P+": Unsupported column type "+e.type+' on column "'+(e.label||e.property)+'". EdmType.'+r+" is applied.");e.type=r}switch(e.type){case h.Date:if(!e.format&&!e.calendar){C._validateString(e,"format",C.getFormatSettings().datePattern);C._validateString(e,"calendar",C.getFormatSettings().calendar)}break;case h.DateTime:if(!e.format&&!e.calendar){C._validateString(e,"format",C.getFormatSettings().dateTimePattern);C._validateString(e,"calendar",C.getFormatSettings().calendar)}break;case h.Time:C._validateString(e,"format",C.getFormatSettings().timePattern);break;case h.Number:break;case h.Currency:if(!e.unitProperty){a.warning(P+': Missing unitProperty for type Currency on column "'+(e.label||e.property)+'". Type is reverted to "String".');e.type=h.String}break;case h.Enumeration:if(!e.valueMap||typeof e.valueMap!=="object"){a.warning(P+': Invalid valueMap for type Enumeration on column "'+(e.label||e.property)+'". Type is reverted to "String".');e.type=h.String}break;default:}},_validateWorkbookContext:function(e){if(!(e instanceof Object)){return}C._validateString(e,"application","SAP UI5");C._validateString(e,"version",b);C._validateString(e,"title");C._validateString(e,"modifiedBy");C._validateString(e,"sheetName","SAPUI5 Spreadsheet Export",31,w);C._validateString(e,"metaSheetName","Metadata",31,w);if(e.metainfo){if(!Array.isArray(e.metainfo)){a.warning(P+': Invalid value for property "metainfo". Value will be discarded.');e.metainfo=null}else{e.metainfo.filter(function(e,t){if(typeof e.name!=="string"||e.name.length===0){a.warning(P+": Invalid name for metainfo group at index "+t+". Entry will be discarded.");return false}return true})}}},_validateString:function(e,t,r,n,i){var o;C._validateProperty(e,t,"string",r);o=e[t];if(typeof o==="string"&&(typeof i==="string"||i instanceof RegExp)){o=o.replace(i,"")}if(typeof o==="string"&&n&&o.length>n){a.warning(P+": The value of "+t+" exceeds the max length of "+n+" and will be truncated.");o=o.slice(0,n)}e[t]=o},_validateProperty:function(e,t,r,n){var i=e[t];if(i!=null&&typeof i!==r){a.warning(P+': Invalid value for property "'+t+". Value will be discarded.");i=null}if(i==null&&typeof n!=="undefined"){i=n}if(i==null){delete e[t]}else{e[t]=i}},_validateScaleCustomizing:function(e,t){var r,n;if(!e){return}n=e[t];if(!(n instanceof Object)||Array.isArray(n)){a.warning(P+": Invalid scale customizing for "+t+".");e[t]={}}else{for(r in n){if(!(n[r]instanceof Object)){a.warning(P+": Key "+r+" has been removed from customizing.");delete n[r]}else if(typeof n[r].scale!=="number"||n[r].scale<0){a.warning(P+": Key "+r+" has been removed from customizing due to invalid scale.");delete n[r]}}}},getExportInstance:function(e,t){var r,a;t=t?t:{};a=typeof e.fileType==="string"?e.fileType.toUpperCase():e.fileType;switch(a){case v.PDF:r="sap/ui/export/PortableDocument";break;default:r="sap/ui/export/Spreadsheet"}return new Promise(function(n){sap.ui.require([r],function(r){n(new r(e,t[a]))})})},getCountFromBinding:function(e){var t;if(typeof e.getCount==="function"){t=e.getCount()}else if(!e.isA("sap.ui.model.TreeBinding")&&typeof e.isLengthFinal==="function"&&e.isLengthFinal()){t=e.getLength()}if(typeof t!=="number"||t<0||isNaN(t)){t=null}return t},getHierarchyLevelProperty:function(e){if(!e||typeof e.isA!=="function"){return undefined}if(e.isA("sap.ui.model.odata.v2.ODataTreeBinding")&&typeof e.getTreeAnnotation==="function"){return e.getTreeAnnotation("hierarchy-level-for")}if(e.isA("sap.ui.model.odata.v4.ODataListBinding")){var t=e.getAggregation(true);return t&&t.$DistanceFromRootProperty}return undefined},getHierarchyDrillStateProperty:function(e){if(!e||typeof e.isA!=="function"){return undefined}if(e.isA("sap.ui.model.odata.v2.ODataTreeBinding")&&typeof e.getTreeAnnotation==="function"){return e.getTreeAnnotation("hierarchy-drill-state-for")}if(e.isA("sap.ui.model.odata.v4.ODataListBinding")){var t=e.getAggregation(true);return t&&t.$DrillStateProperty}return undefined},splitColumns:function(e,t){var r=[];if(typeof t!=="function"){t=function(){}}e.forEach(function(e){var a,n,i,o;if(Array.isArray(e.property)&&e.property.length>1){n=Object.assign({},e);n.property=e.property[0];n.label=t(n.property)||e.label;delete n.template;a=[n];e.property.slice(1).forEach(function(r,n){o=t(r);i={property:r,label:o||e.label+" ("+(n+1)+")"};a.push(i)})}if(e.unitProperty&&e.displayUnit!==false){n=Object.assign({},e);o=t(e.unitProperty);a=[n,{property:e.unitProperty,label:o||e.label+" (1)"}];if(n.type===h.Currency){n.displayUnit=false}if(n.type===h.Number){delete n.unitProperty}}if(e.timezoneProperty&&e.displayTimezone!==false){n=Object.assign({},e);o=t(e.timezoneProperty);a=[n,{property:e.timezoneProperty,label:o||e.label+" (1)"}];n.displayTimezone=false}r.push(a||e)});return r.flat()},getResourceBundle:function(){if(!E){return n.getLibraryResourceBundle("sap.ui.export",true).then(function(e){E=e;return E})}return Promise.resolve(E)},getFormatSettings:function(){if(!T){var e,t;t={};e=n.getConfiguration().getFormatSettings();t.calendar=n.getConfiguration().getCalendarType();t.datePattern=e.getDatePattern("medium");t.timePattern=e.getTimePattern("medium");t.delimiter=!!e.getNumberSymbol("group");if(typeof t.datePattern==="string"){t.datePattern=t.datePattern.toLowerCase()}if(typeof t.timePattern==="string"){t.timePattern=t.timePattern.toLowerCase().replace(/ a+/," AM/PM")}if(t.datePattern&&t.timePattern){t.dateTimePattern=t.datePattern+" "+t.timePattern}T=t}return T},getTimezoneTranslations:function(){const e=n.getConfiguration().getLocale();const t=u.getInstance(e);return t.getTimezoneTranslations()}};return C},true);
/*!
 * SAPUI5
 * (c) Copyright 2009-2023 SAP SE. All rights reserved.
 */
sap.ui.predefine("sap/ui/export/PortableDocument", ["sap/base/Log","sap/ui/base/Object","sap/ui/core/Core","sap/ui/export/ExportBase","sap/ui/export/ExportUtils","sap/ui/export/library","sap/ui/export/util/PDFCapabilities","sap/ui/model/odata/v4/ODataModel","./ExportDialog","sap/m/BusyDialog"],function(e,t,i,r,o,n,a,s,u,p){"use strict";const c=n.FileType;const l=n.EdmType;var f=r.extend("sap.ui.export.PortableDocument",{constructor:function(e,i){r.call(this,e,i);if(!t.isA(this._mCapabilities,"sap.ui.export.util.PDFCapabilities")){this._mCapabilities=new a(this._mCapabilities)}["paperSize","orientation","font","fontSize","doEnableAccessibility","fitToPage","signature","signatureReason","pdfArchive","showPageNumber"].forEach(function(t){if(typeof e[t]!=="undefined"){this._mSettings[t]=e[t]}}.bind(this))}});f.prototype.processDataSource=function(t){var i=null;var r=typeof t;if(!t){return null}if(r!="object"){e.error("Spreadsheet#processDataSource: Unable to apply data source of type "+r);return null}if(t.dataUrl&&t.serviceUrl){i=t}if(t.isA&&t.isA(["sap.ui.model.ListBinding","sap.ui.model.TreeBinding"])){i=this.createDataSourceFromBinding(t)}return i};f.prototype.createDataSourceFromBinding=function(t){var i=null;if(t.isA(["sap.ui.model.ClientListBinding","sap.ui.model.ClientTreeBinding"])){e.error("Unable to create dataSource configuration due to not supported Binding: "+t.getMetadata().getName())}if(typeof t.getDownloadUrl==="function"){var r=t.getModel(),n=o.interceptUrl(t.getDownloadUrl("pdf")),a=o.interceptUrl(r.sServiceUrl),s=r.isA("sap.ui.model.odata.v4.ODataModel");var u=new URL(n,document.baseURI);u.hash="";this._oModel=r;u.search=u.search.split("&").filter(function(e){return e.indexOf("$format")==-1}).join("&");i={type:"odata",version:s?4:2,dataUrl:u.toString(),serviceUrl:this._resolveServiceUrl(a),headers:s?r.getHttpHeaders(true):r.getHeaders(),count:o.getCountFromBinding(t)}}return i};f.prototype._resolveServiceUrl=function(e){var t,i;e+=e.endsWith("/")?"":"/";t=/^[\./]/.test(e);i=this._mCapabilities.DocumentDescriptionReference;if(typeof i!=="string"||!i){return e.split("/").slice(0,-5).join("/")+"/default/iwbep/common/0001/"}i=i.endsWith("/")?i:i.split("/").slice(0,-1).join("/")+"/";var r=new URL(e,document.baseURI);r=new URL(i,r.href);return t?r.pathname:r.href};f.prototype._createDocumentDescription=function(e){const t=e.workbook;const i=e.dataSource.version;const r={Title:t.context.title,Format:{PaperSize:e.paperSize,Orientation:e.orientation},PDFStandard:{DoEnableAccessibility:e.doEnableAccessibility},TableColumns:[]};if(this._mCapabilities.ArchiveFormat){r.PDFStandard["UsePDFAConformance"]=e.pdfArchive}if(this._mCapabilities.CoverPage){const e=t.context.metainfo;r["CoverPage"]=[];if(e instanceof Array){e.forEach(function(e){if(i===2){e.items.forEach(function(t){const i={Title:e.name,Name:t.key,Value:t.value};r["CoverPage"].push(i)})}else{const t={Title:e.name,Content:[]};e.items.forEach(function(e){t["Content"].push({Name:e.key,Value:e.value})});r["CoverPage"].push(t)}})}}if(this._mCapabilities.FitToPage){r.Format["FitToPage"]={IsEnabled:e.fitToPage,MinimumFontSize:4}}if(this._mCapabilities.FontSize){r.Format["FontSize"]=Number(e.fontSize)}if(this._mCapabilities.HeaderFooter&&e.showPageNumber){r["Footer"]={Center:{Type:"PAGENUM"}}}if(this._mCapabilities.Signature){r["Signature"]={DoSign:e.signature,Reason:e.signatureReason}}if(this._mCapabilities.Treeview&&t.hierarchyLevel&&t.drillState){if(i===2){r["Hierarchy"]={DistanceFromRootElement:t.hierarchyLevel,DrillStateElement:t.drillState}}else{r.Format["TableFormat"]="TREE"}}t.columns.filter(function(e,t,i){var r=Array.isArray(e.property)?e.property[0]:e.property;if(!r){return false}return i.findIndex(function(e){var t=Array.isArray(e.property)?e.property[0]:e.property;return r===t})===t}).forEach(e=>{const t={Name:Array.isArray(e.property)?e.property[0]:e.property,Header:e.label};if(this._mCapabilities.IANATimezoneFormat&&e.type===l.DateTime){t.Format={DisplayFormat:i==2?"IANATIMEST":"IANA-Timestamp"};if(e.timezoneProperty){t.Format.IANATimezoneProperty=e.timezoneProperty}else if(e.timezone){t.Format.IANATimezone=e.timezone}}r.TableColumns.push(t)});return r};f.prototype._getEntitySetName=function(e){var t,i;i=e&&e.version||2;if(this._mCapabilities&&typeof this._mCapabilities.DocumentDescriptionCollection==="string"){t=this._mCapabilities.DocumentDescriptionCollection}return t||(i==4?"MyDocumentDescriptions":"SAP__MyDocumentDescriptions")};f.prototype._getModel=function(e){var t=e.version||2;return t===4?new s({serviceUrl:e.serviceUrl,synchronizationMode:"None"}):this._oModel};f.prototype._showWarning=function(e){var t,i;t={rows:e.dataSource.count,rowLimit:this._mCapabilities.ResultSizeMaximum,fileType:c.PDF};i=Promise.resolve();if(isNaN(t.rows)||t.rows>t.rowLimit){i=u.showWarningDialog(t)}return i};f.prototype._applyResultSize=function(e){var t,i;t=parseInt(this._mCapabilities.ResultSizeMaximum);if(!isNaN(t)&&t>0){i=new URL(e);i.search+="&$top="+t;e=i.toString()}return e};f.prototype.setDefaultExportSettings=function(e){var t=e&&e.workbook&&e.workbook.context;if(!(t instanceof Object)){t=e.workbook.context={}}if(typeof t.title==="string"&&t.title){return Promise.resolve()}return i.getLibraryResourceBundle("sap.ui.export",true).then(function(e){t.title=e.getText("XLSX_DEFAULT_TITLE")})};f.prototype.postDocumentDescription=function(e,t){var i,r,o;r=this._getModel(t);o="/"+this._getEntitySetName(t);if(!r||!r.isA(["sap.ui.model.odata.v4.ODataModel","sap.ui.model.odata.v2.ODataModel"])){return Promise.reject("Unsupported Model")}return new Promise(function(t,n){if(r.isA("sap.ui.model.odata.v4.ODataModel")){i=r.bindList(o);i.attachCreateCompleted(function(e){var i=e.getParameter("success");if(i){t(e.getParameter("context").getObject()["Id"])}else{n()}});i.create(e)}else{var a=r.bUseBatch;r.setUseBatch(false);r.create(o,e,{success:function(e){r.setUseBatch(a);t(e["Id"])},error:function(e){r.setUseBatch(a);n(e)}})}})};f.prototype.createBuildPromise=function(e){var t=this;var r;var n;var a=i.getLibraryResourceBundle("sap.ui.export");n=new p("PDFExportBusyDialog",{title:a.getText("PROGRESS_TITLE"),text:a.getText("PDF_GENERATION_IN_PROGRESS"),showCancelButton:true,close:function(e){if(e.getParameter("cancelPressed")){t.cancel()}n.destroy();n=null}});r=t._createDocumentDescription(e);n.open();return this._showWarning(e).then(function(){return t.postDocumentDescription(r,e.dataSource)}).then(function(i){return n&&t.sendRequest(e.dataSource.dataUrl,i)}).then(function(t){o.saveAsFile(t,e.fileName)}).catch(function(e){if(!e){return}e.text().then(function(e){u.showErrorMessage(e)}).catch(function(){u.showErrorMessage(a.getText("PDF_GENERIC_ERROR"))})}).finally(function(){n&&n.close()})};f.prototype.sendRequest=function(e,t){e=this._applyResultSize(e);return new Promise(function(i,r){var o=this.request=new XMLHttpRequest;o.open("GET",e);o.responseType="blob";o.setRequestHeader("Accept",this.getMimeType());o.setRequestHeader("SAP-Document-Description-Id",t);o.addEventListener("abort",function(){r(null)});o.addEventListener("error",function(){r("Error occured while requesting data")});o.addEventListener("load",function(){var e=o.status;if(e>=200&&e<400){i(o.response)}else{r(o.response)}});o.send()}.bind(this))};f.prototype.getMimeType=function(){return"application/pdf"};f.prototype.cancel=function(){if(this.request&&this.request.readyState!=XMLHttpRequest.DONE){this.request.abort();this.request=null}};f.prototype.destroy=function(){r.prototype.destroy.apply(this,arguments);this._oModel=null};return f});
/*!
 * SAPUI5
 * (c) Copyright 2009-2023 SAP SE. All rights reserved.
 */
sap.ui.predefine("sap/ui/export/Spreadsheet", ["./library","./ExportBase","./ExportDialog","./ExportUtils","./SpreadsheetExport","sap/base/Log","sap/ui/core/Core","sap/ui/Device"],function(e,t,r,o,i,s,n,a){"use strict";var c="sap.ui.export.Spreadsheet";var u=t.extend(c,{constructor:function(e){t.call(this,e);this._mSettings.customizing={};this._mSettings.showProgress=true;this._mSettings.worker=true;["showProgress","worker"].forEach(function(t){if(typeof e[t]!=="undefined"){this._mSettings[t]=e[t]}}.bind(this));this.codeListsPromise=this.codeListsPromise instanceof Promise?this.codeListsPromise:Promise.resolve([null,null])}});function l(e,t,r){if(!(r[e]instanceof Object)){r[e]={}}if(!isNaN(t.digits)){r[e].scale=t.digits}if(!isNaN(t.UnitSpecificScale)){r[e].scale=t.UnitSpecificScale}if(isNaN(r[e].scale)){delete r[e]}}u.prototype.setDefaultExportSettings=async function(e){var t,r,i,s;const a=await o.getResourceBundle();e.customizing.timezone=o.getTimezoneTranslations();i=e.workbook.context;if(!(i instanceof Object)){i=e.workbook.context={}}if(!i.title){i.title=a.getText("XLSX_DEFAULT_TITLE")}if(!i.sheetName){i.sheetName=a.getText("XLSX_DEFAULT_SHEETNAME")}t=e.customizing.currency={};r=e.customizing.unit={};var c=n.getConfiguration().getFormatSettings().getCustomCurrencies();if(c){for(s in c){l(s,c[s],t)}}let u;const[p,f]=await this.codeListsPromise;for(u in p){l(u,p[u],t)}for(u in f){l(u,f[u],r)}};u.requestCodeLists=function(e){if(!e.isA(["sap.ui.model.odata.ODataMetaModel","sap.ui.model.odata.v4.ODataMetaModel"])){return Promise.resolve([null,null])}return Promise.all([e.requestCurrencyCodes(),e.requestUnitsOfMeasure()]).catch(function(e){s.warning(c+": Code lists cannot be processed due to the following error - "+e);return Promise.resolve([null,null])})};u.prototype.attachBeforeSave=function(e,t,r){return this.attachEvent("beforeSave",e,t,r)};u.prototype.detachBeforeSave=function(e,t){return this.detachEvent("beforeSave",e,t)};u.prototype.cancel=function(){if(this.process){this.process.cancel();this.process=null}return this};u.prototype.getMimeType=function(){return"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"};u.prototype.onprogress=function(e,t){var r;if(isNaN(e)||isNaN(t)){return}r=Math.round(e/t*100);s.debug("Spreadsheet export: "+r+"% loaded.")};u.prototype.createDataSourceFromBinding=function(e){var t=[];if(e.isA("sap.ui.model.ClientListBinding")){var r=[];e.getAllCurrentContexts().forEach(function(e){r.push(e.getObject())});t={data:r,type:"array"}}if(e.isA("sap.ui.model.ClientTreeBinding")){s.error("Unable to create dataSource configuration due to not supported Binding: "+e.getMetadata().getName())}if(typeof e.getDownloadUrl==="function"){var i=e.getModel(),n=e.getDownloadUrl("json"),a=i.sServiceUrl,c=i.isA("sap.ui.model.odata.v4.ODataModel");n=o.interceptUrl(n);a=o.interceptUrl(a);t={type:"odata",dataUrl:n,serviceUrl:a,headers:c?i.getHttpHeaders(true):i.getHeaders(),count:n.includes("$apply")?undefined:o.getCountFromBinding(e),useBatch:c||i.bUseBatch};if(i.getMetaModel()&&typeof i.getMetaModel().requestCurrencyCodes==="function"&&typeof i.getMetaModel().requestUnitsOfMeasure==="function"){this.codeListsPromise=u.requestCodeLists(i.getMetaModel(),this._mSettings)}}return t};u.prototype.processDataSource=function(e){var t=null;var r=typeof e;if(!e){return null}if(r=="string"){return{count:this._mSettings.count,dataUrl:e,type:"odata",useBatch:false}}if(r!="object"){s.error("Spreadsheet#processDataSource: Unable to apply data source of type "+r);return null}if(e instanceof Array){t={data:e,type:"array"}}if(e.dataUrl){t=e}if(e.isA&&e.isA(["sap.ui.model.ListBinding","sap.ui.model.TreeBinding"])){t=this.createDataSourceFromBinding(e)}return t};u.prototype.createBuildPromise=function(t){var s=this;return new Promise(function(n,c){var u;var l=1048576;var p=a.system.desktop?2e6:1e5;var f=t.dataSource.type=="array"?t.dataSource.data.length:t.dataSource.count;var d=t.workbook.columns.length;function g(e){if(e.progress){if(u){u.updateStatus(e.fetched,e.total)}s.onprogress(e.fetched,e.total)}if(e.finished&&s.process!==null){s.process=null;if(!e.spreadsheet){c();return}var i=s.fireEvent("beforeSave",{data:e.spreadsheet,exportDialog:u},true,true);if(i){if(u){window.setTimeout(u.finish,1e3)}o.saveAsFile(new Blob([e.spreadsheet],{type:s.getMimeType()}),t.fileName)}n()}if(typeof e.error!="undefined"){var a=e.error.message||e.error;s.process=null;if(u){u.finish()}c(a);r.showErrorMessage(a)}}function h(){if(!t.showProgress){if(s.process){c("Cannot start export: the process is already running");return}s.process=i.execute(t,g);return}r.getProgressDialog().then(function(e){u=e;if(s.process){c("Cannot start export: the process is already running");return}u.oncancel=function(){return s.process&&s.process.cancel()};u.open();u.updateStatus(0,t.dataSource.count);s.process=i.execute(t,g)})}if(d<=0){c("No columns to export.")}else if(f*d>p||!f||f>=l){var m={rows:f,columns:d,cellLimit:p,rowLimit:l,fileType:e.FileType.XLSX};r.showWarningDialog(m).then(h).catch(c)}else{h()}})};return u});
/*!
 * SAPUI5
 * (c) Copyright 2009-2023 SAP SE. All rights reserved.
 */
sap.ui.predefine("sap/ui/export/SpreadsheetExport", ["sap/base/Log","sap/ui/export/ExportUtils"],function(e,r){"use strict";var t="sap/ui/export/provider/DataProviderBase",n="sap/ui/export/js/XLSXBuilder",o="sap/ui/export/js/libs/JSZip3";var i={execute:function(i,a){function s(e){if(e instanceof MessageEvent&&e.data){e=e.data}if(typeof a==="function"){a(e)}}function u(e,r){s({progress:true,fetched:e||0,total:r||0})}function c(e){s({error:e.message||e})}function f(e){s({finished:true,spreadsheet:e})}function l(){var e;var r;function a(t,n){r=t.getDataConverter(i);e=new n(i.workbook.columns,i.workbook.context,i.workbook.hierarchyLevel,i.customizing);var o=i.dataSource.data||[];var a=o.length;var s=r(o.slice());e.append(s);u(a,a);e.build().then(f)}sap.ui.require([t,n,o],a);return{cancel:f}}function p(){var e,r;function a(t,n){var o=new t(i);e=new n(i.workbook.columns,i.workbook.context,i.workbook.hierarchyLevel,i.customizing);r=o.requestData(s)}function s(r){if(r.error||typeof r.error==="string"){c(r.error);return}e.append(r.rows);u(r.fetched,r.total);if(r.finished){e.build().then(f)}}function l(){r.cancel();f()}sap.ui.require([t,n,o],a);return{cancel:l}}function d(){var t;var n={};var o=function(){t.postMessage({cancel:true});f()};function a(e){var r=new Worker(e);r.onmessage=s;if(navigator.userAgent.indexOf("Firefox")===-1||u(e)){r.onerror=c}r.postMessage(i);return r}function u(e){return e.indexOf(window.location.host)>0||/^[^/]+\/[^/].*$|^\/[^/].*$/i.test(e)}function l(){var r,t;e.warning("Direct worker is not allowed. Load the worker via blob.");r='self.origin = "'+n.base+'"; '+'importScripts("'+n.src+'")';t=window.URL.createObjectURL(new Blob([r]));return a(t)}function d(){e.warning("Blob worker is not allowed. Use in-process export.");o=p(i).cancel}function v(){try{t=a(n.src);t.addEventListener("error",function(e){t=l();t.addEventListener("error",function(e){d();e.preventDefault()});e.preventDefault()})}catch(e){try{t=l()}catch(e){d()}}}n.base=r.normalizeUrl(sap.ui.require.toUrl("sap/ui/export/js/"));n.src=n.base+"SpreadsheetWorker.js";v();return{cancel:function(){o()}}}if(i.dataSource.type==="array"){return l()}else if(i.worker===false){return p()}else{return d()}}};return i},true);
/*!
 * SAPUI5
 * (c) Copyright 2009-2023 SAP SE. All rights reserved.
 */
sap.ui.predefine("sap/ui/export/library", ["sap/ui/core/library"],function(e){"use strict";var i=sap.ui.getCore().initLibrary({name:"sap.ui.export",dependencies:["sap.ui.core"],types:["sap.ui.export.EdmType","sap.ui.export.FileType"],interfaces:[],controls:[],elements:[],version:"1.120.3"});i.EdmType={BigNumber:"BigNumber",Boolean:"Boolean",Currency:"Currency",Date:"Date",DateTime:"DateTime",Enumeration:"Enumeration",Number:"Number",Percentage:"Percentage",String:"String",Time:"Time",Timezone:"Timezone"};i.FileType={CSV:"CSV",GSHEET:"GSHEET",PDF:"PDF",XLSX:"XLSX"};i.Destination={LOCAL:"LOCAL",REMOTE:"REMOTE"};sap.ui.loader.config({shim:{"sap/ui/export/js/XLSXBuilder":{amd:true,exports:"XLSXBuilder"},"sap/ui/export/js/XLSXExportUtils":{amd:true,exports:"XLSXExportUtils"}}});return i});
/*!
 * SAPUI5
 * (c) Copyright 2009-2023 SAP SE. All rights reserved.
 */
sap.ui.predefine("sap/ui/export/util/Filter", ["sap/ui/base/Object"],function(t){"use strict";var e=t.extend("sap.ui.export.util.Filter",{constructor:function(t,e,r){this.property=t;this.rawValues=Array.isArray(e)?e:[e];this.label=typeof r==="string"?r:undefined}});e.prototype.getProperty=function(){return this.property};e.prototype.getLabel=function(){return this.label||this.property};e.prototype.getValue=function(){var t,e;t=[];e=this.type?this.format||this.type.formatValue.bind(this.type):this.format;if(this.type?.isA(["sap.ui.model.odata.type.Boolean","sap.ui.model.type.Boolean"])){const t=e;e=e=>{if(typeof e==="string"){e=e.toLowerCase()!=="false"}return t(e,"string")}}this.getRawValues().forEach(function(r){var i=r.value;if(typeof e==="function"){if(Array.isArray(r.value)){i=[];r.value.forEach(function(t){try{i.push(e(t,"string"))}catch(e){i.push(t)}})}else{try{i=e(r.value,"string")}catch(t){}}}switch(r.operator){case"==":i="="+i;break;case"between":i=i[0]+"..."+i[1];break;case"contains":i="*"+i+"*";break;case"endswith":i="*"+i;break;case"startswith":i+="*";break;default:i=r.operator+i}if(r.exclude){i="!"+i}t.push(i)});return t.join("; ")};e.prototype.getRawValues=function(){return this.rawValues};e.prototype.setFormat=function(t){if(typeof t!=="function"&&t!==null){return}this.format=t};e.prototype.setLabel=function(t){if(typeof t!=="string"||!t){return}this.label=t};e.prototype.setType=function(t){if(!t||typeof t.isA!=="function"||!t.isA("sap.ui.model.SimpleType")){return}this.type=t};return e},true);
/*!
 * SAPUI5
 * (c) Copyright 2009-2023 SAP SE. All rights reserved.
 */
sap.ui.predefine("sap/ui/export/util/PDFCapabilities", ["sap/ui/base/Object"],function(e){"use strict";const t={ArchiveFormat:false,Border:false,CoverPage:false,DocumentDescriptionCollection:"",DocumentDescriptionReference:"",FitToPage:false,FontName:false,FontSize:false,HeaderFooter:false,IANATimezoneFormat:false,Margin:false,Padding:false,ResultSizeDefault:2e4,ResultSizeMaximum:2e4,Signature:false,Treeview:false};var i=e.extend("sap.ui.export.util.PDFCapabilities",{constructor:function(e){e=e||{};for(const[i,o]of Object.entries(t)){this[i]=typeof e[i]===typeof o?e[i]:o}if(window.location.search.includes("sap-ui-xx-pdf-tree")){this.Treeview=true}}});i.prototype.isValid=function(){return this["DocumentDescriptionReference"]&&this["DocumentDescriptionCollection"]&&this["ResultSizeMaximum"]>0};return i});
sap.ui.require.preload({
	"sap/ui/export/fragments/SettingsDialog.fragment.xml":'<Dialog xmlns="sap.m" xmlns:core="sap.ui.core" id="exportSettingsDialog" title="{i18n>EXPORT_SETTINGS_TITLE}" horizontalScrolling="false" verticalScrolling="true" afterClose=".onAfterClose" class="sapUiContentPadding sapUiExportSettings"><content><VBox renderType="Bare" width="100%" class="sapUiExportSettingsLabel"><Label text="{i18n>FILE_NAME}" labelFor="exportSettingsDialog-fileName"/><Input id="exportSettingsDialog-fileName" value="{/fileName}" liveChange=".onFileNameChange" class="sapUiTinyMarginBottom"/><Label text="{i18n>SELECT_FORMAT}" labelFor="exportSettingsDialog-fileType"/><Select id="exportSettingsDialog-fileType" selectedKey="{/fileType}" items="{/fileTypeCollection}" change=".onFileTypeChange" width="100%" class="sapUiTinyMarginBottom"><items><core:Item key="{key}" text="{text}"/></items></Select><Label text="{i18n>SELECT_DESTINATION}" labelFor="exportSettingsDialog-destination" visible="{path: \'/destinationCollection\', formatter: \'.hasDestinations\'}"/><Select id="exportSettingsDialog-destination" selectedKey="{/destination}" items="{/destinationCollection}" change=".onDestinationChange" visible="{path: \'/destinationCollection\', formatter: \'.hasDestinations\'}" enabled="{path: \'/fileType\', formatter: \'.isDestinationEnabled\'}" width="100%" class="sapUiTinyMarginBottom"><items><core:Item key="{key}" text="{text}"/></items></Select><CheckBox id="exportSettingsDialog-includeFilterSettings" selected="{/includeFilterSettings}" text="{i18n>INCLUDE_FILTER_SETTINGS}"  visible="{path:\'/fileType\', formatter: \'.isSpreadsheet\'}"/><CheckBox id="exportSettingsDialog-includeFilterSettings-PDF" selected="{/includeFilterSettings}" text="{i18n>INCLUDE_FILTER_SETTINGS}"  visible="{parts:[\'/fileType\', \'/capabilities/PDF/CoverPage\'], formatter: \'.isPDF\'}" tooltip="{i18n>TOOLTIP_FILTER_SETTINGS}"/><CheckBox id="exportSettingsDialog-pdfArchive" selected="{/pdfArchive}" text="{i18n>ARCHIVE_FORMAT}"  visible="{parts:[\'/fileType\', \'/capabilities/PDF/ArchiveFormat\'], formatter: \'.isPDF\'}" tooltip="{i18n>TOOLTIP_ARCHIVE_FORMAT}"/><CheckBox id="exportSettingsDialog-splitCells" selected="{/splitCells}" text="{i18n>SPLIT_CELLS}" visible="{path:\'/fileType\', formatter: \'.isSpreadsheet\'}"/><CheckBox id="exportSettingsDialog-addDateTime" selected="{/addDateTime}" text="{i18n>ADD_DATE_TIME}" visible="false"/><Label text="{i18n>PAPER_SIZE}" labelFor="exportSettingsDialog-papersize" visible="{path:\'/fileType\', formatter: \'.isPDF\'}"/><Select id="exportSettingsDialog-papersize" selectedKey="{/paperSize}" items="{/paperSizeCollection}" width="100%" visible="{path:\'/fileType\', formatter: \'.isPDF\'}" class="sapUiTinyMarginBottom"><items><core:Item key="{key}" text="{text}"/></items></Select><Label text="{i18n>ORIENTATION}" labelFor="exportSettingsDialog-orientation" visible="{path:\'/fileType\', formatter: \'.isPDF\'}"/><Select id="exportSettingsDialog-orientation" selectedKey="{/orientation}" items="{/orientationCollection}" width="100%" visible="{path:\'/fileType\', formatter: \'.isPDF\'}" class="sapUiTinyMarginBottom"><items><core:Item key="{key}" text="{text}"/></items></Select><Label text="{i18n>FONT_SIZE}" labelFor="exportSettingsDialog-fontSize" visible="{parts:[\'/fileType\', \'/capabilities/PDF/FontSize\'], formatter: \'.isPDF\'}"/><Input id="exportSettingsDialog-fontSize" value="{/fontSize}" liveChange=".onFontSizeChange" class="sapUiTinyMarginBottom" visible="{parts:[\'/fileType\', \'/capabilities/PDF/FontSize\'], formatter: \'.isPDF\'}" tooltip="{i18n>TOOLTIP_FONT_SIZE}"/><CheckBox id="exportSettingsDialog-accessibility" selected="{/doEnableAccessibility}" text="{i18n>ENABLE_ACCESSIBILITY}" tooltip="{i18n>TOOLTIP_PDF_ACCESSIBILITY}" visible="{path:\'/fileType\', formatter: \'.isPDF\'}"/><CheckBox id="exportSettingsDialog-fitToPage" selected="{/fitToPage}" text="{i18n>FITTOPAGE}" tooltip="{i18n>TOOLTIP_FITTOPAGE}" visible="{parts:[\'/fileType\', \'/capabilities/PDF/FitToPage\'], formatter: \'.isPDF\'}"/><CheckBox id="exportSettingsDialog-signature" selected="{/signature}" text="{i18n>ENABLE_SIGNATURE}" tooltip="{i18n>TOOLTIP_PDF_SIGNATURE}" visible="{parts:[\'/fileType\', \'/capabilities/PDF/Signature\'], formatter: \'.isPDF\'}"/><Label id="exportSettingsDialog-signatureReasonLabel" text="{i18n>SIGNATURE_REASON}" labelFor="exportSettingsDialog-signatureReason" visible="{/signature}"/><Input id="exportSettingsDialog-signatureReason" value="{/signatureReason}" class="sapUiTinyMarginBottom" visible="{/signature}"/><CheckBox id="exportSettingsDialog-showPageNumber" selected="{/showPageNumber}" text="{i18n>SHOW_PAGENUM}" tooltip="{i18n>TOOLTIP_PDF_PAGENUMBER}" visible="{parts:[\'/fileType\', \'/capabilities/PDF/HeaderFooter\'], formatter: \'.isPDF\'}"/></VBox></content><beginButton><Button id="exportSettingsDialog-exportButton" press=".onExport" text="{path:\'/destination\', formatter:\'.formatExportButton\'}" type="Emphasized"/></beginButton><endButton><Button id="exportSettingsDialog-cancelButton" press=".onCancel" text="{i18n>CANCEL_BUTTON}" type="Transparent"/></endButton></Dialog>\n',
	"sap/ui/export/manifest.json":'{"_version":"1.21.0","sap.app":{"id":"sap.ui.export","type":"library","embeds":[],"applicationVersion":{"version":"1.120.3"},"title":"UI5 library: sap.ui.export","description":"UI5 library: sap.ui.export","ach":"CA-UI5-TBL","resources":"resources.json","offline":true,"openSourceComponents":[{"name":"JSZip3","packagedWithMySelf":true,"version":"3.10.1"}]},"sap.ui":{"technology":"UI5","supportedThemes":["base","sap_belize","sap_belize_hcb","sap_belize_hcw","sap_belize_plus","sap_bluecrystal","sap_fiori_3","sap_fiori_3_dark","sap_fiori_3_hcb","sap_fiori_3_hcw","sap_hcb","sap_horizon","sap_horizon_dark","sap_horizon_hcb","sap_horizon_hcw"]},"sap.ui5":{"dependencies":{"minUI5Version":"1.120","libs":{"sap.ui.core":{"minVersion":"1.120.3"}}},"library":{"i18n":{"bundleUrl":"messagebundle.properties","supportedLocales":["","ar","bg","ca","cnr","cs","cy","da","de","el","en","en-GB","en-US-sappsd","en-US-saprigi","en-US-saptrc","es","es-MX","et","fi","fr","fr-CA","hi","hr","hu","id","it","iw","ja","kk","ko","lt","lv","mk","ms","nl","no","pl","pt","pt-PT","ro","ru","sh","sk","sl","sv","th","tr","uk","vi","zh-CN","zh-TW"]},"content":{"controls":[],"elements":[],"types":["sap.ui.export.EdmType","sap.ui.export.FileType"],"interfaces":[]}}}}',
	"sap/ui/export/provider/DataProviderBase.js":function(){
/*!
 * SAPUI5
 * (c) Copyright 2009-2023 SAP SE. All rights reserved.
 */
(function(e){"use strict";if(typeof sap!=="undefined"&&typeof sap.ui.define==="function"){sap.ui.define([],e,true)}else{var t;if(typeof window!=="undefined"){t=window}else if(typeof self!=="undefined"){t=self}else{t=this}t.DataProviderBase=e()}})(function(){"use strict";var e=function(t){this.mSettings=t;this.bCanceled=false;this.iAvailableRows=0;this.mRequest=null;this.iTotalRows=Math.min(t.dataSource.count||e.MAX_ROWS,e.MAX_ROWS);this.iBatchSize=Math.min(t.dataSource.sizeLimit||e.MAX_ROWS,this.iTotalRows);this._prepareDataUrl()};e.MAX_ROWS=1048575;e.HTTP_ERROR_MSG="HTTP connection error";e.HTTP_WRONG_RESPONSE_MSG="Unexpected server response:\n";e._createGuid=function(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(e){var t=Math.random()*16|0,r=e==="x"?t:t&3|8;return r.toString(16)})};e.getColumnsToConvert=function(e){return e.reduce(function(e,t){var r;r=t.property instanceof Array?t.property:[t.property];if(t.unitProperty){r.push(t.unitProperty)}r.forEach(function(t){var r=t.split("/");if(r.length>1){e.push({property:t,keys:r})}});return e},[])};e.getDataConverter=function(t){var r,n;r=t.workbook.columns;if(t.workbook.hierarchyLevel){r=r.concat([{property:t.workbook.hierarchyLevel}])}n=this.getColumnsToConvert(r);return function(t){return e._convertData(t,n)}};e._convertData=function(t,r){r.forEach(function(r){t.forEach(function(t){t[r.property]=e._getValue(t,r)})});return t};e._getValue=function(e,t){var r=t.keys.reduce(function(e,t){return e&&e[t]},e);return r};e.prototype.requestData=function(t){var r=this.mSettings.dataSource;this.fnConvertData=e.getDataConverter(this.mSettings);this.fnProcessCallback=t;this.mRequest={serviceUrl:this._cleanUrl(r.serviceUrl),dataUrl:this._getUrl(0,this.iBatchSize),method:r.useBatch?"BATCH":"GET",headers:r.headers};this.sendRequest(this.mRequest).then(this.fnOnDataReceived.bind(this)).catch(this.fnOnError.bind(this));return{cancel:function(){this.bCanceled=true;if(this.oPendingXHR instanceof XMLHttpRequest){this.oPendingXHR.abort()}}.bind(this)}};e.prototype.fnOnDataReceived=function(e){var t,r,n,i;var s={};this.oPendingXHR=null;if(this.bCanceled){return}t=e&&e.value||e.d&&(e.d.results||e.d)||e;t=Array.isArray(t)?t:[];n=t.length;this.iAvailableRows+=n;i=this.iTotalRows-this.iAvailableRows;s.finished=n===0||i<=0;s.progress=this.iTotalRows;s.total=this.iTotalRows;s.fetched=this.iAvailableRows;r=e&&e["@odata.nextLink"]||e.d&&e.d.__next||null;if(!s.finished){this.mRequest.dataUrl=this._getUrl(this.iAvailableRows,Math.min(this.iBatchSize,i),r);this.sendRequest(this.mRequest).then(this.fnOnDataReceived.bind(this)).catch(this.fnOnError.bind(this))}s.rows=this.fnConvertData(t);this.fnProcessCallback(s)};e.prototype.fnOnError=function(e){this.fnProcessCallback({error:e})};e.prototype._cleanUrl=function(e){var t;if(!e){return""}t=new URL(e);t.hash=t.search="";t.pathname+=t.pathname.endsWith("/")?"":"/";return t.toString()};e.prototype._prepareDataUrl=function(){var e=this.mSettings.dataSource;var t,r=/\$skip\=[0-9]+/,n=/\$top\=[0-9]+/;if(!e.dataUrl){throw"Unable to load data - no URL provided."}t=new URL(e.dataUrl);t.search=t.search||"";if(!r.test(t.search)){t.search+=(t.search.length?"&$skip=":"$skip=")+0}if(!n.test(t.search)){t.search+="&$top="+0}this.mSettings.dataSource.dataUrl=t.toString()};e.prototype._getUrl=function(e,t,r){var n,i;n=new URL(this.mSettings.dataSource.dataUrl);if(r){i=new URL(r,n.origin);n.search=i.search}else{n.search=(n.search||"").replace(/\$skip\=[0-9]+/g,"$skip="+e).replace(/\$top\=[0-9]+/g,"$top="+t)}return n.toString()};e.prototype.sendRequest=function(e){var t;if(typeof e!=="object"||e===null||typeof e.dataUrl!=="string"){throw new Error("Unable to send request - Mandatory parameters missing.")}t=(e.method==="BATCH"&&e.serviceUrl?this.sendBatchRequest:this.sendGetRequest).bind(this);return t(e)};e.prototype.sendBatchRequest=function(t){return new Promise(function(r,n){var i=new XMLHttpRequest;var s="batch_"+e._createGuid();var a=t.dataUrl.split(t.serviceUrl)[1];var o=[];var h,c;i.onload=function(){var t,i,s,a,o,h,c;i=this.responseText.split("\r\n");o=0;a=i.length;s=a-1;i.forEach(function(e){c=e.match(/^HTTP\/1\.[0|1] ([1-9][0-9]{2})/);if(Array.isArray(c)&&c[1]){h=c[1]}});while(o<a&&i[o].slice(0,1)!=="{"){o++}while(s>0&&i[s].slice(-1)!=="}"){s--}i=i.slice(o,s+1);t=i.join("\r\n");if(h&&parseInt(h)>=400){n(e.HTTP_WRONG_RESPONSE_MSG+t);return}try{r(JSON.parse(t))}catch(r){n(e.HTTP_WRONG_RESPONSE_MSG+t)}};i.onerror=function(){n(this.responseText||e.HTTP_ERROR_MSG)};i.open("POST",t.serviceUrl+"$batch",true);i.setRequestHeader("Accept","multipart/mixed");i.setRequestHeader("Content-Type","multipart/mixed;boundary="+s);o.push("--"+s);o.push("Content-Type: application/http");o.push("Content-Transfer-Encoding: binary");o.push("");o.push("GET "+a+" HTTP/1.1");o.push("Accept:application/json");for(h in t.headers){c=t.headers[h];if(h.toLowerCase()!="accept"){i.setRequestHeader(h,c);o.push(h+":"+c)}}o.push("");o.push("");o.push("--"+s+"--");o.push("");o=o.join("\r\n");i.send(o);this.oPendingXHR=i}.bind(this))};e.prototype.sendGetRequest=function(t){return new Promise(function(r,n){var i;var s=new XMLHttpRequest;s.onload=function(){if(this.status>=400){n(this.responseText||this.statusText||e.HTTP_ERROR_MSG);return}try{r(JSON.parse(this.responseText))}catch(t){n(e.HTTP_WRONG_RESPONSE_MSG+this.responseText)}};s.onerror=function(){n(this.responseText||e.HTTP_ERROR_MSG)};s.open("GET",t.dataUrl,true);s.setRequestHeader("accept","application/json");for(i in t.headers){if(i.toLowerCase()!=="accept"){s.setRequestHeader(i,t.headers[i])}}s.send();this.oPendingXHR=s}.bind(this))};return e});
}
});
//# sourceMappingURL=library-preload.js.map
