{"version":3,"file":"Spreadsheet.js","names":["sap","ui","define","Library","ExportBase","ExportDialog","ExportUtils","SpreadsheetExport","Log","Core","Device","CLASS_NAME","Spreadsheet","extend","constructor","mSettings","call","this","_mSettings","customizing","showProgress","worker","forEach","sProperty","bind","codeListsPromise","Promise","resolve","addUnit","sCurrencyCode","oCurrency","mCurrencies","Object","isNaN","digits","scale","UnitSpecificScale","prototype","setDefaultExportSettings","async","mParameters","mCurrencySettings","mUnitSettings","oWorkbookContext","oResourceBundle","getResourceBundle","timezone","getTimezoneTranslations","workbook","context","title","getText","sheetName","currency","unit","oCustomCurrencies","getConfiguration","getFormatSettings","getCustomCurrencies","sUnitCode","mCurrencyCodes","mUnitsOfMeasure","requestCodeLists","oMetaModel","isA","all","requestCurrencyCodes","requestUnitsOfMeasure","catch","oError","warning","attachBeforeSave","oData","fnHandler","oListener","attachEvent","detachBeforeSave","detachEvent","cancel","process","getMimeType","onprogress","iFetched","iTotal","iProgress","Math","round","debug","createDataSourceFromBinding","oBinding","oDataSource","aData","getAllCurrentContexts","oContext","push","getObject","data","type","error","getMetadata","getName","getDownloadUrl","oModel","getModel","sDataUrl","sServiceUrl","bV4ODataModel","interceptUrl","dataUrl","serviceUrl","headers","getHttpHeaders","getHeaders","count","includes","undefined","getCountFromBinding","useBatch","bUseBatch","getMetaModel","processDataSource","mDataSource","sDataSourceType","Array","createBuildPromise","that","fnResolve","fnReject","progressDialog","MAX_ROWS","nSizeLimit","system","desktop","nRows","dataSource","length","nColumns","columns","onmessage","oMessage","progress","updateStatus","fetched","total","finished","spreadsheet","executeDefaultAction","fireEvent","exportDialog","window","setTimeout","finish","saveAsFile","Blob","fileName","sError","message","showErrorMessage","startExport","execute","getProgressDialog","then","oDialogResolve","oncancel","open","oDialogSettings","rows","cellLimit","rowLimit","fileType","FileType","XLSX","showWarningDialog"],"sources":["Spreadsheet-dbg.js"],"mappings":"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"}