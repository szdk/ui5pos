/*!
 * OpenUI5
 * (c) Copyright 2009-2024 SAP SE or an SAP affiliate company.
 * Licensed under the Apache License, Version 2.0 - see LICENSE.txt.
 */
sap.ui.define(["sap/m/p13n/Engine","sap/ui/mdc/flexibility/Util","sap/ui/fl/changeHandler/Base","sap/ui/fl/changeHandler/condenser/Classification"],function(e,t,n,o){"use strict";const r=function(e,t,n,o){if(o){e.resetRevertData()}else{e.setRevertData(n)}};const i=function(e,n,o,i){return new Promise(function(a,s){const c=i===t.REVERT;const g=o.modifier;const u=c?e.getRevertData():e.getContent();Promise.resolve().then(g.getProperty.bind(g,n,"groupConditions")).then(function(t){const o=t?t.groupLevels:[];const i={name:u.name};o.splice(u.index,0,i);t={groupLevels:o};g.setProperty(n,"groupConditions",t);r(e,n,i,c);a()}).catch(function(e){s(e)})})};const a=function(e,o,i,a){return new Promise(function(s,c){const g=a===t.REVERT;const u=i.modifier;const d=g?e.getRevertData():e.getContent();Promise.resolve().then(u.getProperty.bind(u,o,"groupConditions")).then(function(t){const i=t?t.groupLevels:[];if(!i){c()}const a=i.filter(function(e){return e.name===d.name});const p=i.indexOf(a[0]);if(p>-1){i.splice(p,1)}else{return n.markAsNotApplicable("The specified change is already existing - change appliance ignored",true)}t={groupLevels:i};u.setProperty(o,"groupConditions",t);r(e,o,d,g);s()}).catch(function(e){c(e)})})};const s=function(e,n,o,i){return new Promise(function(a,s){const c=i===t.REVERT;const g=o.modifier;const u=c?e.getRevertData():e.getContent();Promise.resolve().then(g.getProperty.bind(g,n,"groupConditions")).then(function(t){const o=t?t.groupLevels:[];const i=o.filter(function(e){return e.name===u.name});const s=o.indexOf(i[0]);o.splice(u.index,0,o.splice(s,1)[0]);t={groupLevels:o};g.setProperty(n,"groupConditions",t);r(e,n,u,c);a()}).catch(function(e){s(e)})})};const c={};c.addGroup=t.createChangeHandler({apply:i,revert:a,getCondenserInfo:function(e,t){return{affectedControl:{id:e.getContent().name},affectedControlIdProperty:"name",targetContainer:e.getSelector(),targetAggregation:"groupLevels",customAggregation:t.modifier.bySelector(e.getSelector(),t.appComponent).getGroupConditions().groupLevels,classification:o.Create,setTargetIndex:function(e,t){e.getContent().index=t},getTargetIndex:function(e){return e.getContent().index}}}});c.removeGroup=t.createChangeHandler({apply:a,revert:i,getCondenserInfo:function(e,t){return{affectedControl:{id:e.getContent().name},affectedControlIdProperty:"name",targetContainer:e.getSelector(),targetAggregation:"groupLevels",customAggregation:t.modifier.bySelector(e.getSelector(),t.appComponent).getGroupConditions().groupLevels,classification:o.Destroy,sourceIndex:e.getRevertData().index,setIndexInRevertData:function(e,t){const n=e.getRevertData();n.index=t;e.setRevertData(n)}}}});c.moveGroup=t.createChangeHandler({apply:s,revert:s,getCondenserInfo:function(e,t){return{affectedControl:{id:e.getContent().name},affectedControlIdProperty:"name",targetContainer:e.getSelector(),targetAggregation:"groupLevels",classification:o.Move,sourceIndex:e.getRevertData().index,customAggregation:t.modifier.bySelector(e.getSelector(),t.appComponent).getGroupConditions().groupLevels,sourceContainer:e.getSelector(),sourceAggregation:"groupLevels",setTargetIndex:function(e,t){e.getContent().index=t},getTargetIndex:function(e){return e.getContent().index},setIndexInRevertData:function(e,t){const n=e.getRevertData();n.index=t;e.setRevertData(n)}}}});return c});
//# sourceMappingURL=GroupFlex.js.map