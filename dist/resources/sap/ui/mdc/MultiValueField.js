/*!
 * OpenUI5
 * (c) Copyright 2009-2024 SAP SE or an SAP affiliate company.
 * Licensed under the Apache License, Version 2.0 - see LICENSE.txt.
 */
sap.ui.define(["sap/ui/mdc/library","sap/ui/mdc/field/FieldBase","sap/ui/mdc/field/FieldBaseRenderer","sap/ui/mdc/condition/Condition","sap/ui/mdc/enums/ConditionValidated","sap/ui/mdc/enums/OperatorName"],function(t,e,i,n,o,a){"use strict";const s=e.extend("sap.ui.mdc.MultiValueField",{metadata:{library:"sap.ui.mdc",designtime:"sap/ui/mdc/designtime/field/MultiValueField.designtime",properties:{delegate:{type:"object",defaultValue:{name:"sap/ui/mdc/field/MultiValueFieldDelegate",payload:{}}}},aggregations:{items:{type:"sap.ui.mdc.field.MultiValueFieldItem",multiple:true,singularName:"item",bindable:"bindable"}},defaultAggregation:"items",events:{change:{parameters:{items:{type:"sap.ui.mdc.field.MultiValueFieldItem[]"},valid:{type:"boolean"},promise:{type:"Promise"}}}}},renderer:i});s.prototype.init=function(){e.prototype.init.apply(this,arguments);this.setProperty("_operators",[a.EQ],true);this._oObserver.observe(this,{aggregations:["items"]})};s.prototype.exit=function(){e.prototype.exit.apply(this,arguments);if(this._iConditionUpdateTimer){clearTimeout(this._iConditionUpdateTimer);delete this._iConditionUpdateTimer}};s.prototype.bindAggregation=function(t,i){if(t==="items"&&!i.formatter){r.call(this,i)}e.prototype.bindAggregation.apply(this,arguments)};function r(t){if(t.template){let e;if(t.template.mBindingInfos.key){const i=t.template.mBindingInfos.key;e=this.getContentFactory().getDataType();if(i.type&&(!e||e.getMetadata().getName()!==i.type.getMetadata().getName())){this._oContentFactory.setDataType(i.type);this.invalidate()}}if(t.template.mBindingInfos.description){const i=t.template.mBindingInfos.description;e=this.getContentFactory().getAdditionalDataType();if(i.type&&(!e||e.getMetadata().getName()!==i.type.getMetadata().getName())){this._oContentFactory.setAdditionalDataType(i.type);this.invalidate()}}}}s.prototype.handleModelContextChange=function(t){e.prototype.handleModelContextChange.apply(this,arguments);if(!this._oDataType){const t=this.getBinding("items");if(t){r.call(this,t)}}};s.prototype.initDataType=function(){e.prototype.initDataType.apply(this,arguments);const t=this.getBindingInfo("items");if(t){r.call(this,t)}};s.prototype.setMaxConditions=function(t){if(t===1){throw new Error("Multiple Conditions needed on MultiValueField "+this)}return this.setProperty("maxConditions",t,true)};s.prototype.observeChanges=function(t){e.prototype.observeChanges.apply(this,arguments);if(t.name==="items"){p.call(this,t.child,t.mutation)}if(t.name==="key"){l.call(this)}if(t.name==="description"){l.call(this)}if(t.name==="conditions"){d.call(this,t.current)}};function p(t,e){if(e==="insert"){this._oObserver.observe(t,{properties:true})}else{this._oObserver.unobserve(t)}if(!this._bMyItemUpdate){l.call(this)}}function d(t){if(this._bConditionsUpdateFromItems){return}if(!this.bDelegateInitialized){this.awaitControlDelegate().then(function(){if(!this.bIsDestroyed){d.call(this.getConditions())}}.bind(this));return}this.getControlDelegate().updateItems(this.getPayload(),t,this)}function l(){if(!this.bDelegateInitialized){this.awaitControlDelegate().then(function(){if(!this.bIsDestroyed){l.call(this)}}.bind(this));return}if(!this._iConditionUpdateTimer){this._iConditionUpdateTimer=setTimeout(function(){h.call(this);this._iConditionUpdateTimer=undefined}.bind(this),0)}}function h(){const t=this.getItems();const e=[];for(let i=0;i<t.length;i++){const a=t[i];const s=n.createItemCondition(u(a,"key"),u(a,"description"));s.validated=o.Validated;e.push(s)}this._bConditionsUpdateFromItems=true;this.setConditions(e);this._bConditionsUpdateFromItems=false}function u(t,e){const i=t.getBinding(e);if(i){return i.getInternalValue()}else{return t.getProperty(e)}}s.prototype.fireChangeEvent=function(t,e,i,n){this.fireChange({items:this.getItems(),valid:e,promise:n})};s.prototype.getResultForChangePromise=function(t){return this.getItems()};s.prototype.getSupportedOperators=function(){return this.getProperty("_operators",[])};s.prototype.checkCreateInternalContent=function(){if(!this.bIsDestroyed&&this._oContentFactory.getDataType()&&!this.isFieldPropertyInitial("editMode")){e.prototype.checkCreateInternalContent.apply(this,arguments)}};s.prototype.isSearchField=function(){return false};return s});
//# sourceMappingURL=MultiValueField.js.map