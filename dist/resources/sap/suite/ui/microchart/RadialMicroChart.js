/*!
 * SAPUI5
 * (c) Copyright 2009-2023 SAP SE. All rights reserved.
 */
sap.ui.define(["./library","sap/m/library","sap/ui/core/Control","sap/suite/ui/microchart/RadialMicroChartRenderer","sap/ui/core/ResizeHandler","sap/base/Log","sap/ui/events/KeyCodes","sap/suite/ui/microchart/MicroChartUtils","./RadialMicroChartRenderer","sap/ui/core/Core","sap/ui/core/Theming"],function(e,t,i,s,r,a,o,n,l,p,u){"use strict";var h=t.ValueColor;var d=i.extend("sap.suite.ui.microchart.RadialMicroChart",{constructor:function(e,t){var s;if(t&&typeof t.percentage==="number"){s=true}else if(e&&typeof e.percentage==="number"){s=true}else{s=false}try{i.apply(this,arguments);this._bPercentageMode=s}catch(e){this.destroy();throw e}},metadata:{library:"sap.suite.ui.microchart",properties:{total:{group:"Data",type:"float"},fraction:{group:"Data",type:"float",defaultValue:null},percentage:{group:"Data",type:"float",defaultValue:null},valueColor:{group:"Appearance",type:"sap.m.ValueCSSColor",defaultValue:"Neutral"},size:{group:"Misc",type:"sap.m.Size",defaultValue:"Auto"},width:{group:"Misc",type:"sap.ui.core.CSSSize"},height:{group:"Misc",type:"sap.ui.core.CSSSize"},alignContent:{group:"Misc",type:"sap.suite.ui.microchart.HorizontalAlignmentType",defaultValue:"Left"},hideOnNoData:{type:"boolean",group:"Appearance",defaultValue:false}},associations:{ariaLabelledBy:{type:"sap.ui.core.Control",multiple:true,singularName:"ariaLabelledBy"}},events:{press:{}}},renderer:l});d.THRESHOLD_LOOK_XS=1.125;d.THRESHOLD_LOOK_S=3.5;d.THRESHOLD_LOOK_M=4.5;d.THRESHOLD_LOOK_L=5.875;d.THRESHOLD_WIDTH_NO_LABEL=6;d.prototype.init=function(){this._oRb=p.getLibraryResourceBundle("sap.suite.ui.microchart");this.setAggregation("tooltip","((AltText))",true);this._bThemeApplied=false;p.ready(this._handleCoreInitialized.bind(this))};d.prototype._handleCoreInitialized=function(){u.attachApplied(this._handleThemeApplied.bind(this))};d.prototype._handleThemeApplied=function(){this._bThemeApplied=true;this.invalidate();u.detachApplied(this._handleThemeApplied.bind(this))};d.prototype.onBeforeRendering=function(){if(!this._getPercentageMode()){if(this.getTotal()===0){a.info("Total cannot be 0. Please add a valid total value.")}else{this.setProperty("percentage",Math.round(this.getFraction()*100/this.getTotal()*10)/10,true)}}this._unbindMouseEnterLeaveHandler()};d.prototype.onAfterRendering=function(){this._bindMouseEnterLeaveHandler();this._sResizeHandlerId=r.register(this,this._onResize.bind(this));this._onResize()};d.prototype.ontouchstart=function(e){if(this.hasListeners("press")===true){e.setMarked()}};d.prototype.ontap=function(e){if(this.hasListeners("press")===true){e.setMarked()}this.firePress()};d.prototype.onkeydown=function(e){if(e.which===o.SPACE){if(this.hasListeners("press")===true){e.setMarked()}e.preventDefault()}};d.prototype.onkeyup=function(e){if(e.which===o.ENTER||e.which===o.SPACE){if(this.hasListeners("press")===true){e.setMarked()}this.firePress();e.preventDefault()}};d.prototype.attachEvent=function(e,t,s,r){i.prototype.attachEvent.call(this,e,t,s,r);if(e==="press"){this.invalidate()}return this};d.prototype.detachEvent=function(e,t,s){i.prototype.detachEvent.call(this,e,t,s);if(e==="press"){this.invalidate()}return this};d.prototype.exit=function(){this._deregisterResizeHandler()};d.prototype._getPercentageMode=function(){return this._bPercentageMode};d.prototype.setPercentage=function(e){if(typeof e==="number"){var t=Math.floor(e*10)/10;this._bPercentageMode=true;if(t!==this.getPercentage()){this.setProperty("percentage",t)}}else{this._bPercentageMode=false;this.setProperty("percentage",null)}return this};d.prototype._onResize=function(){var e=this.$(),t=e.height(),i=e.width(),s=e.find(".sapSuiteRMCOutsideLabel"),r=e.find(".sapSuiteRMCInsideLabel"),a=e.find(".sapSuiteRMCInnerContainer");e.removeClass("sapSuiteRMCLookL sapSuiteRMCLookM sapSuiteRMCLookS sapSuiteRMCLookXS");s.removeClass("sapSuiteRMCLabelHide");r.removeClass("sapSuiteRMCLabelHide");a.css("width",a.height());if(t<this.convertRemToPixels(d.THRESHOLD_LOOK_S)){e.addClass("sapSuiteRMCLookXS");r.addClass("sapSuiteRMCLabelHide")}else if(t<this.convertRemToPixels(d.THRESHOLD_LOOK_M)||i<this.convertRemToPixels(d.THRESHOLD_LOOK_M)){e.addClass("sapSuiteRMCLookS");s.addClass("sapSuiteRMCLabelHide")}else if(t<this.convertRemToPixels(d.THRESHOLD_LOOK_L)||i<this.convertRemToPixels(d.THRESHOLD_LOOK_L)){e.addClass("sapSuiteRMCLookM");s.addClass("sapSuiteRMCLabelHide")}else{e.addClass("sapSuiteRMCLookL");s.addClass("sapSuiteRMCLabelHide")}if(this._isAnyLabelTruncated(s)){s.addClass("sapSuiteRMCLabelHide")}if(this._isAnyLabelTruncated(r)){r.addClass("sapSuiteRMCLabelHide")}};d.prototype._getAccessibilityControlType=function(){return this._oRb.getText("ACC_CTR_TYPE_RADIALMICROCHART")};d.prototype._isValueColorValid=function(){return h.hasOwnProperty(this.getValueColor())};d.prototype._isTooltipSuppressed=function(){var e=this.getTooltip_Text();if(e&&e.trim().length===0){return true}else{return false}};d.prototype._getAltHeaderText=function(e){var t=this._oRb.getText("RADIALMICROCHART");if(e){t+=" "+this._oRb.getText("IS_ACTIVE")}t+="\n";if(!this._hasData()){t+=this._oRb.getText("NO_DATA");return t}var i=this.getPercentage();if(i>100){i=100}else if(i<0){i=0}if(this._isValueColorValid()){t+=this._oRb.getText("RADIALMICROCHART_ARIA_LABEL",[this.getPercentage(),this._getStatusText()])}else{t+=this._oRb.getText("RADIALMICROCHART_PERCENTAGE_TEXT",i)}return t};d.prototype._getStatusText=function(){var e=this.getValueColor();switch(e){case h.Error:return this._oRb.getText("SEMANTIC_COLOR_ERROR");case h.Critical:return this._oRb.getText("SEMANTIC_COLOR_CRITICAL");case h.Good:return this._oRb.getText("SEMANTIC_COLOR_GOOD");case h.Neutral:return this._oRb.getText("SEMANTIC_COLOR_NEUTRAL");default:return""}};d.prototype._addTitleAttribute=function(){if(!this.$().attr("title")&&this._hasData()){this.$().attr("title",this.getTooltip_AsString())}};d.prototype._removeTitleAttribute=function(){if(this.$().attr("title")){this.$().removeAttr("title")}};d.prototype._bindMouseEnterLeaveHandler=function(){this.$().on("mouseenter.tooltip",this._addTitleAttribute.bind(this));this.$().on("mouseleave.tooltip",this._removeTitleAttribute.bind(this))};d.prototype._unbindMouseEnterLeaveHandler=function(){this.$().off("mouseenter.tooltip");this.$().off("mouseleave.tooltip")};d.prototype._isActuallyANumber=function(e){return!isNaN(e)&&e!==null&&(e!=="Infinity"&&e!=="-Infinity")};d.prototype._hasData=function(){return this._getPercentageMode()||this._isActuallyANumber(this.getTotal())};d.prototype.firePress=function(){if(this._hasData()){i.prototype.fireEvent.call(this,"press",arguments)}};d.prototype._deregisterResizeHandler=function(){if(this._sResizeHandlerId){r.deregister(this._sResizeHandlerId);this._sResizeHandlerId=null}};n.extendMicroChart(d);return d});
//# sourceMappingURL=RadialMicroChart.js.map