<mvc:XMLView controllerName="ui5pos.szdk.controller.Setup"
    xmlns:form="sap.ui.layout.form"
    xmlns:mvc="sap.ui.core.mvc" 
    xmlns="sap.m"
    xmlns:l="sap.ui.layout"
    xmlns:core="sap.ui.core"
    
    height="100%"
>
    <!-- <App> -->
        <Page title="{lang>setup_title}">
            <content>
                <l:BlockLayout background="Default">
                    <l:BlockLayoutRow>
                        <l:BlockLayoutCell class="m-2 bg-w brad-m">
                            <Text class="disp-block" text="{lang>setup_pleaseSelect}"></Text>
                            <List>
                                <StandardListItem icon="sap-icon://broken-link"
                                    title="{lang>setup_typeMock}"
                                    description="{lang>setup_desMock}"
                                ></StandardListItem>
                                <StandardListItem icon="sap-icon://chain-link"
                                    title="{lang>setup_typeOdata}"
                                    description="{lang>setup_desOdata}"
                                ></StandardListItem>
                            </List>
                            <HBox class="disp-block m-t-5">
                                <Select 
                                    id="odataType"
                                    selectedKey="{local>/odataType}"
                                    enabled="{local>/inputEnabled}"
                                >
                                    <core:ListItem key="1" icon="sap-icon://broken-link" text="{lang>setup_typeMock}"></core:ListItem>
                                    <core:ListItem key="2" icon="sap-icon://chain-link" text="{lang>setup_typeOdata}"></core:ListItem>
                                </Select>
                            </HBox>
                            <!-- Input Delay -->
                            <VBox visible="{= ${local>/odataType} === '1' }" class="m-t-3 m-b-2">
                                <Text text="{lang>setup_delayDescription}" class="m-t-2 m-b-3 font-style-i"></Text>
                                <HBox alignContent="Center" justifyContent="Start" wrap="Wrap">
                                    <HBox alignContent="Center" wrap="Wrap" class="m-r-2"><Label labelFor="setup_odataDelay" text="{lang>setup_odataDelay}"></Label></HBox>
                                    <HBox alignContent="Center">
                                        <Input
                                            enabled="{local>/inputEnabled}" valueLiveUpdate="true" required="true" id="setup_odataDelay" value="{local>/odataDelay}" type="Number"
                                        ></Input>
                                    </HBox>
                                </HBox>
                            </VBox>
                            <!-- Input URL -->
                            <VBox visible="{= ${local>/odataType} === '2' }" class="m-t-3 m-b-2">
                                <Label labelFor="setup_odataUrl" text="{lang>setup_odataUrl}"></Label>
                                <Input enabled="{local>/inputEnabled}" valueLiveUpdate="true" required="true" id="setup_odataUrl" value="{local>/odataUrl}" type="Url" placeholder="https://services.odata.org/V3/Northwind/Northwind.svc/"></Input>
                            </VBox>
                            <!-- Message Strip -->
                            <MessageStrip
                                class="m-t-2"
                                text="{= ${local>/odataType} === '1' ? ${lang>setup_strip1} : ${lang>setup_strip2} }"
                                type="Information"
                                showIcon="true"
                                enableFormattedText="true"
                            />
                        </l:BlockLayoutCell>
                    </l:BlockLayoutRow>
                </l:BlockLayout>

                <!-- Service created Success message -->
                <HBox visible="{local>/ServiceCreated}" class="bg-w brad-m m-2 p-lr-6 p-tb-3 m-p-lr-4 s-p-lr-3 xs-p-lr-2" alignItems="Center" justifyContent="Start">
                    <VBox alignContent="Center" justifyContent="Center">
                        <core:Icon src="sap-icon://accept" size="3em" color="#4CAF50" width="1em" height="1em"></core:Icon>
                    </VBox>
                    <VBox alignContent="Center" class="m-l-4 s-m-l-2">
                        <Title text="{lang>setup_serviceCreated}" titleStyle="H4"></Title>
                        <Text text="{lang>setup_navigateToHome}"></Text>
                    </VBox>
                </HBox>
                
                <!-- loading block -->
                <HBox id="setup-loading" visible="false" justifyContent="Center" alignItems="Center" class="m-lr-2 m-tb-5">
                    <BusyIndicator text="{= ${local>/odataType} === '1' ? ${lang>setup_loadingMock} : ${lang>setup_loadingOdata} }" />
                </HBox>

                <!-- dialog for Error initializing odata -->
                <Dialog visible="false" id="setup-error-dialog" title="{lang>error}" type="Message" state="Error">
                    <Text id="setup-error-dialog-text" text="{lang>setup_loadingError}"/>
                    <beginButton><Button id="setup-error-dialog-close" text="{lang>close}" type="Ghost"></Button></beginButton>
                </Dialog>
            </content>

            <footer>
                <OverflowToolbar>
                    <!-- <ToolbarSpacer/> -->
                    <Button id="setup-continue" press=".onCreateService" type="Emphasized"
                        icon="{= ${local>/ServiceCreated} ? 'sap-icon://accept' : 'sap-icon://lab' }"
                        enabled="{=
                            ${local>/ServiceCreated} || ${local>/inputEnabled} &amp;&amp; (
                                ${local>/odataType} === '1' &amp;&amp; ${local>/odataDelay} >= 0
                                ||
                                ${local>/odataType} === '2' &amp;&amp; ${local>/odataUrl}.length > 0
                            )
                        }"
                        text="{lang>continue}"/>
                </OverflowToolbar>
            </footer>
        </Page>
    <!-- </App> -->
</mvc:XMLView>