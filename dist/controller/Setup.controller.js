sap.ui.define(["ui5pos/szdk/controller/BaseController","sap/ui/model/json/JSONModel","ui5pos/szdk/models/models"],function(e,t,o){"use strict";return e.extend("ui5pos.szdk.controller.Setup",{onInit:function(){e.prototype.onInit.apply(this,arguments);let o=new t({odataType:"1",odataUrl:"",odataDelay:100,inputEnabled:true,ServiceCreated:false,generateID:false,updateMethod:"MERGE"});this.getView().setModel(o,"local")},onCreateService:function(e){let t=this.getView();let s=t.getModel("local");let r=this.byId("setup-loading");if(s.getProperty("/ServiceCreated")&&this.comp.getModel("service")){this.goBack("home");return}s.setProperty("/inputEnabled",false);r.setVisible(true);let a=this.comp.getModel("settings").getData();a.odata.useMock=s.getProperty("/odataType")==="1";a.odata.serviceUrl=a.odata.useMock?"/ui5pos/szdk/mockService.svc/":s.getProperty("/odataUrl");let i=parseInt(s.getProperty("/odataDelay"));if(!i)i=0;s.setProperty("/odataDelay",i);a.odata.delay=i;a.odata.generateID=a.odata.useMock?true:s.getProperty("/generateID");a.odata.updateMethod=s.getProperty("/updateMethod");this.comp.getModel("settings").setData(a);let l=null;setTimeout(()=>o.createService({...a}).then(e=>{l=e;return e.metadataLoaded(true)}).then(()=>{this.comp.setModel(l,"service");this.comp.szdk_resolve_serviceCreated(l);s.setProperty("/ServiceCreated",true);r.setVisible(false)}).catch(e=>{r.setVisible(false);let t=this.byId("setup-error-dialog").setVisible(true).open();this.byId("setup-error-dialog-text").setText(this.i18n.getText("setup_loadingError",[e.message]));this.byId("setup-error-dialog-close").attachPress(()=>{t.close().setVisible(false)});o.deleteService(a.odata.serviceUrl);s.setProperty("/inputEnabled",true)}),100)}})});
//# sourceMappingURL=Setup.controller.js.map